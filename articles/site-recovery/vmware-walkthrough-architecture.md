---
title: Architektura hello aaaReview tooAzure replikace VMware | Microsoft Docs
description: "Tento článek obsahuje přehled součásti a architektura použít při replikaci tooAzure místní virtuální počítače VMware s hello služba Azure Site Recovery"
services: site-recovery
documentationcenter: 
author: rayne-wiselman
manager: carmonm
editor: 
ms.assetid: c413efcd-d750-4b22-b34b-15bcaa03934a
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/27.017
ms.author: raynew
ms.openlocfilehash: 7acb1d8e83a846dca79e175fd1af9324f2c31e65
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="step-1-review-hello-architecture-for-vmware-replication-tooazure"></a><span data-ttu-id="8e2a3-103">Krok 1: Posouzení hello architektura pro tooAzure replikace VMware</span><span class="sxs-lookup"><span data-stu-id="8e2a3-103">Step 1: Review hello architecture for VMware replication tooAzure</span></span>

<span data-ttu-id="8e2a3-104">Tento článek popisuje hello součástech a procesech používá při replikaci místní tooAzure virtuální počítače VMware pomocí hello [Azure Site Recovery](site-recovery-overview.md) služby.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-104">This article describes hello components and processes used when replicating on-premises VMware virtual machines tooAzure using hello [Azure Site Recovery](site-recovery-overview.md) service.</span></span>

<span data-ttu-id="8e2a3-105">Odeslat všechny komentáře v dolní části hello tohoto článku nebo pokládání dotazů v hello [fóru Azure Recovery Services](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span><span class="sxs-lookup"><span data-stu-id="8e2a3-105">Post any comments at hello bottom of this article, or ask questions in hello [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>


## <a name="architectural-components"></a><span data-ttu-id="8e2a3-106">Komponenty architektury</span><span class="sxs-lookup"><span data-stu-id="8e2a3-106">Architectural components</span></span>

<span data-ttu-id="8e2a3-107">Hello tabulka shrnuje hello součásti, které potřebujete.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-107">hello table summarizes hello components you need.</span></span>

<span data-ttu-id="8e2a3-108">**Komponenta**</span><span class="sxs-lookup"><span data-stu-id="8e2a3-108">**Component**</span></span> | <span data-ttu-id="8e2a3-109">**Požadavek**</span><span class="sxs-lookup"><span data-stu-id="8e2a3-109">**Requirement**</span></span> | <span data-ttu-id="8e2a3-110">**Podrobnosti**</span><span class="sxs-lookup"><span data-stu-id="8e2a3-110">**Details**</span></span>
--- | --- | ---
<span data-ttu-id="8e2a3-111">**Azure**</span><span class="sxs-lookup"><span data-stu-id="8e2a3-111">**Azure**</span></span> | <span data-ttu-id="8e2a3-112">Potřebujete předplatné Azure, účet úložiště Azure a sítě Azure.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-112">You need an Azure subscription, an Azure storage account, and an Azure network.</span></span> | <span data-ttu-id="8e2a3-113">Replikovaná data je uložený v účtu úložiště hello.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-113">Replicated data is stored in hello storage account.</span></span> <span data-ttu-id="8e2a3-114">Virtuální počítače Azure vytvořené mají hello replikovat data, když dojde k převzetí služeb při selhání z vaší místní lokalitě.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-114">Azure VMs are created with hello replicated data when failover from your on-premises site occurs.</span></span> <span data-ttu-id="8e2a3-115">Hello virtuálních počítačích Azure připojit toohello virtuální síť Azure, když vytváří.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-115">hello Azure VMs connect toohello Azure virtual network when they're created.</span></span>
<span data-ttu-id="8e2a3-116">**Konfigurační server**</span><span class="sxs-lookup"><span data-stu-id="8e2a3-116">**Configuration server**</span></span> | <span data-ttu-id="8e2a3-117">Jeden místní server pro správu (virtuální počítač VMware) používající všech hello místních součásti Site Recovery pro nasazení hello.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-117">A single on-premises management server (VMware VM) that runs all hello on-premises Site Recovery components for hello deployment.</span></span> <span data-ttu-id="8e2a3-118">Mezi ně patří, a konfigurační server, procesový server, hlavní cílový server.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-118">These include a configuration server, process server, master target server.</span></span> | <span data-ttu-id="8e2a3-119">součásti serveru configuration Hello koordinuje komunikaci mezi místními a Azure a spravuje replikaci dat.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-119">hello configuration server component coordinates communications between on-premises and Azure, and manages data replication.</span></span>
 <span data-ttu-id="8e2a3-120">**Procesový server:**</span><span class="sxs-lookup"><span data-stu-id="8e2a3-120">**Process server**:</span></span>  | <span data-ttu-id="8e2a3-121">Ve výchozím nastavení na konfiguračním serveru hello nainstalovaná.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-121">Installed by default on hello configuration server.</span></span> | <span data-ttu-id="8e2a3-122">Funguje jako replikační brána.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-122">Acts as a replication gateway.</span></span> <span data-ttu-id="8e2a3-123">Přijímá data replikace, optimalizuje je pomocí ukládání do mezipaměti, komprese a šifrování a odešle ji tooAzure úložiště.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-123">Receives replication data, optimizes it with caching, compression, and encryption, and sends it tooAzure storage.</span></span><br/><br/> <span data-ttu-id="8e2a3-124">procesový server Hello také obstará nabízenou instalaci počítače tooprotected služby Mobility hello a provádí automatického zjišťování virtuálních počítačů VMware.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-124">hello process server also handles push installation of hello Mobility service tooprotected machines, and performs automatic discovery of VMware VMs.</span></span><br/><br/> <span data-ttu-id="8e2a3-125">S růstem nasazení můžete přidat další samostatný proces vyhrazené servery toohandle zvýšení svazky provoz replikace.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-125">As your deployment grows you can add additional separate dedicated process servers toohandle increasing volumes of replication traffic.</span></span>
 <span data-ttu-id="8e2a3-126">**Hlavní cílový server**</span><span class="sxs-lookup"><span data-stu-id="8e2a3-126">**Master target server**</span></span> | <span data-ttu-id="8e2a3-127">Ve výchozím nastavení na konfiguračním serveru hello místně nainstalován.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-127">Installed by default on hello on-premises configuration server.</span></span> | <span data-ttu-id="8e2a3-128">Zpracovává replikační data během navracení služeb z Azure po obnovení.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-128">Handles replication data during failback from Azure.</span></span><br/><br/> <span data-ttu-id="8e2a3-129">Pokud je objem přenosů při navracení služeb po obnovení příliš vysoký, můžete nasadit samostatný hlavní cílový server pro účely navrácení služeb po obnovení.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-129">If volumes of failback traffic are high, you can deploy a separate master target server for failback.</span></span>
<span data-ttu-id="8e2a3-130">**Servery VMware**</span><span class="sxs-lookup"><span data-stu-id="8e2a3-130">**VMware servers**</span></span> | <span data-ttu-id="8e2a3-131">Hostované virtuální počítače VMware na serverech vSphere ESXi a doporučujeme systému vCenter server toomanage hello hostitele.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-131">VMware VMs are hosted on vSphere ESXi servers, and we recommend a vCenter server toomanage hello hosts.</span></span> | <span data-ttu-id="8e2a3-132">Můžete přidat servery VMware, tooyour trezor služeb zotavení.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-132">You add VMware servers tooyour Recovery Services vault.</span></span>
<span data-ttu-id="8e2a3-133">**Replikované počítače**</span><span class="sxs-lookup"><span data-stu-id="8e2a3-133">**Replicated machines**</span></span> | <span data-ttu-id="8e2a3-134">Hello služba Mobility se nainstalují na jednotlivé virtuální počítače VMware můžete replikovat.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-134">hello Mobility service will be installed on each VMware VM you replicate.</span></span> <span data-ttu-id="8e2a3-135">Ho může být nainstalován ručně na každém počítači, nebo pomocí nabízené instalace z hello procesový server.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-135">It can be installed manually on each machine, or with a push installation from hello process server.</span></span>

<span data-ttu-id="8e2a3-136">**Obrázek 1: VMware tooAzure součásti**</span><span class="sxs-lookup"><span data-stu-id="8e2a3-136">**Figure 1: VMware tooAzure components**</span></span>

![Komponenty](./media/vmware-walkthrough-architecture/arch-enhanced.png)

## <a name="replication-process"></a><span data-ttu-id="8e2a3-138">Proces replikace</span><span class="sxs-lookup"><span data-stu-id="8e2a3-138">Replication process</span></span>

1. <span data-ttu-id="8e2a3-139">Nastavit hello nasazení, včetně místní a Azure součásti.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-139">You set up hello deployment, including on-premises and Azure components.</span></span> <span data-ttu-id="8e2a3-140">V trezoru služeb zotavení hello zadejte hello replikace zdroj a cíl, nastavení konfigurace serveru hello, vytvořte zásadu replikace, nasazení hello služby Mobility, povolit replikaci a spustit testovací převzetí služeb.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-140">In hello Recovery Services vault, you specify hello replication source and target, set up hello configuration server, create a replication policy, deploy hello Mobility service, enable replication, and run a test failover.</span></span>
2. <span data-ttu-id="8e2a3-141">Replikovat počítače v souladu s hello zásady replikace a počáteční kopii dat hello je tooAzure replikované úložiště.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-141">Machines replicate in accordance with hello replication policy, and an initial copy of hello data is replicated tooAzure storage.</span></span>
3. <span data-ttu-id="8e2a3-142">Po dokončení počáteční replikace začne replikace tooAzure rozdílové změny.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-142">After initial replication finishes, replication of delta changes tooAzure begins.</span></span> <span data-ttu-id="8e2a3-143">Sledované změny se pro jednotlivé počítače ukládají do souboru .hrl.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-143">Tracked changes for a machine are held in a .hrl file.</span></span>
    - <span data-ttu-id="8e2a3-144">Replikaci počítačů komunikovat s hello konfigurační server na portu 443 protokolu HTTPS příchozí pro správu replikace.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-144">Replicating machines communicate with hello configuration server on port HTTPS 443 inbound, for replication management.</span></span>
    - <span data-ttu-id="8e2a3-145">Replikaci počítače odesílají replikace dat toohello procesový server na portu HTTPS 9443 příchozí (lze upravit).</span><span class="sxs-lookup"><span data-stu-id="8e2a3-145">Replicating machines send replication data toohello process server on port HTTPS 9443 inbound (can be modified).</span></span>
    - <span data-ttu-id="8e2a3-146">konfigurační server Hello orchestruje replikaci správy s Azure přes port HTTPS 443 odchozí.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-146">hello configuration server orchestrates replication management with Azure over port HTTPS 443 outbound.</span></span>
    - <span data-ttu-id="8e2a3-147">Hello procesový server přijímá data ze zdrojového počítače, optimalizuje je zašifruje a odešle ji tooAzure úložiště přes port 443 odchozí.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-147">hello process server receives data from source machines, optimizes and encrypts it, and sends it tooAzure storage over port 443 outbound.</span></span>
    - <span data-ttu-id="8e2a3-148">Pokud povolíte více virtuálních počítačů konzistence, pak počítače v replikační skupině hello vzájemně komunikovat přes port 20004.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-148">If you enable multi-VM consistency, then machines in hello replication group communicate with each other over port 20004.</span></span> <span data-ttu-id="8e2a3-149">Konzistence více virtuálních počítačů znamená, že seskupíte víc virtuálních počítačů do replikační skupiny, v rámci které se sdílí body obnovení konzistentní vzhledem k selháním a konzistentní vzhledem k aplikacím, když dojde k převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-149">Multi-VM is used if you group multiple machines into replication groups that share crash-consistent and app-consistent recovery points when they fail over.</span></span> <span data-ttu-id="8e2a3-150">To je užitečné, pokud počítače běží stejné zatížení hello a je třeba toobe konzistentní.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-150">This is useful if machines are running hello same workload and need toobe consistent.</span></span>
4. <span data-ttu-id="8e2a3-151">Přenosy jsou replikované tooAzure úložiště veřejné koncové body, přes hello internet.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-151">Traffic is replicated tooAzure storage public endpoints, over hello internet.</span></span> <span data-ttu-id="8e2a3-152">Alternativně můžete použít [veřejný partnerský vztah](../expressroute/expressroute-circuit-peerings.md#public-peering) Azure ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-152">Alternately, you can use Azure ExpressRoute [public peering](../expressroute/expressroute-circuit-peerings.md#public-peering).</span></span> <span data-ttu-id="8e2a3-153">Provoz replikace prostřednictvím VPN site-to-site místní lokalitě tooAzure není podporována.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-153">Replicating traffic over a site-to-site VPN from an on-premises site tooAzure isn't supported.</span></span>


<span data-ttu-id="8e2a3-154">**Obrázek 2: VMware tooAzure replikace**</span><span class="sxs-lookup"><span data-stu-id="8e2a3-154">**Figure 2: VMware tooAzure replication**</span></span>

![Rozšířené](./media/vmware-walkthrough-architecture/v2a-architecture-henry.png)

## <a name="failover-and-failback-process"></a><span data-ttu-id="8e2a3-156">Proces převzetí služeb při selhání a navrácení služeb po obnovení</span><span class="sxs-lookup"><span data-stu-id="8e2a3-156">Failover and failback process</span></span>

1. <span data-ttu-id="8e2a3-157">Po ověření, že převzetí služeb při selhání funguje podle očekávání, můžete spustit neplánované převzetí služeb při selhání tooAzure podle potřeby.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-157">After you verify that test failover is working as expected, you can run unplanned failovers tooAzure as required.</span></span> <span data-ttu-id="8e2a3-158">Plánované převzetí služeb není podporované.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-158">Planned failover isn't supported.</span></span>
2. <span data-ttu-id="8e2a3-159">Můžete převzít jeden počítač nebo vytvořit [plány obnovení](site-recovery-create-recovery-plans.md), toofail přes víc virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-159">You can fail over a single machine, or create [recovery plans](site-recovery-create-recovery-plans.md), toofail over multiple VMs.</span></span>
3. <span data-ttu-id="8e2a3-160">V průběhu převzetí služeb při selhání se v Azure vytvoří replika virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-160">When you run a failover, replica VMs are created in Azure.</span></span> <span data-ttu-id="8e2a3-161">Potvrzení převzetí služeb při selhání toostart přístupem hello zatížení z hello repliky virtuálního počítače Azure.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-161">You commit a failover toostart accessing hello workload from hello replica Azure VM.</span></span>
4. <span data-ttu-id="8e2a3-162">Až bude vaše místní lokalita opět dostupná, můžete službu navrátit.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-162">When your primary on-premises site is available again, you can fail back.</span></span> <span data-ttu-id="8e2a3-163">Nastavení infrastruktury navrácení služeb po obnovení, zahájení replikace z primární toohello sekundární lokality hello hello počítač a spustit neplánované převzetí služeb při selhání z hello sekundární lokality.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-163">You set up a failback infrastructure, start replicating hello machine from hello secondary site toohello primary, and run an unplanned failover from hello secondary site.</span></span> <span data-ttu-id="8e2a3-164">Po potvrzení toto převzetí služeb při selhání, data budou zpět na místní a budete potřebovat tooAzure tooenable replikace.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-164">After you commit this failover, data will be back on-premises, and you need tooenable replication tooAzure again.</span></span> [<span data-ttu-id="8e2a3-165">Další informace</span><span class="sxs-lookup"><span data-stu-id="8e2a3-165">Learn more</span></span>](site-recovery-failback-azure-to-vmware.md)

<span data-ttu-id="8e2a3-166">Pro navrácení služby po obnovení existuje několik požadavků:</span><span class="sxs-lookup"><span data-stu-id="8e2a3-166">There are a few failback requirements:</span></span>


- <span data-ttu-id="8e2a3-167">**Dočasný procesní server v Azure**: Pokud chcete, aby toofail zpět z Azure po převzetí služeb při selhání, budete potřebovat tooset si virtuální počítač Azure nakonfigurovaný jako procesní server, toohandle replikace z Azure.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-167">**Temporary process server in Azure**: If you want toofail back from Azure after failover you'll need tooset up an Azure VM configured as a process server, toohandle replication from Azure.</span></span> <span data-ttu-id="8e2a3-168">Tento virtuální počítač je možné po navrácení služeb po obnovení odstranit.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-168">You can delete this VM after failback finishes.</span></span>
- <span data-ttu-id="8e2a3-169">**Připojení k síti VPN**: pro navrácení služeb po obnovení budete potřebovat připojení VPN (nebo Azure ExpressRoute) nastavit z hello Azure toohello místní síť.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-169">**VPN connection**: For failback you'll need a VPN connection (or Azure ExpressRoute) set up from hello Azure network toohello on-premises site.</span></span>
- <span data-ttu-id="8e2a3-170">**Samostatný místní hlavní cílový server**: hello místní hlavní cílový server zpracovává navrácení služeb po obnovení.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-170">**Separate on-premises master target server**: hello on-premises master target server handles failback.</span></span> <span data-ttu-id="8e2a3-171">Hello hlavní cílový server je nainstalován na serveru pro správu hello ve výchozím nastavení, ale pokud se obnovení vracíte větší objemy přenosů měli nastavit samostatný místní hlavní cílový server pro tento účel.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-171">hello master target server is installed by default on hello management server, but if you're failing back larger volumes of traffic you should set up a separate on-premises master target server for this purpose.</span></span>
- <span data-ttu-id="8e2a3-172">**Navrácení služeb po obnovení zásad**: tooreplicate back tooyour místní lokality, musíte zásadu navrácení služeb po obnovení.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-172">**Failback policy**: tooreplicate back tooyour on-premises site, you need a failback policy.</span></span> <span data-ttu-id="8e2a3-173">Ty se vytvoří automaticky při vytvoření zásad replikace.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-173">This is automatically created when you created your replication policy.</span></span>
- <span data-ttu-id="8e2a3-174">**Infrastruktury VMware**: musí selhat zpět tooan místní virtuální počítač VMware.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-174">**VMware infrastructure**: You must fail back tooan on-premises VMware VM.</span></span> <span data-ttu-id="8e2a3-175">To znamená, že se vyžaduje místní infrastruktury VMware, i když replikujete tooAzure místní fyzických serverů.</span><span class="sxs-lookup"><span data-stu-id="8e2a3-175">This means you need an on-premises VMware infrastructure, even if you're replicating on-premises physical servers tooAzure.</span></span>

<span data-ttu-id="8e2a3-176">**Obr. 3: Navrácení služeb po obnovení – VMware nebo fyzický server**</span><span class="sxs-lookup"><span data-stu-id="8e2a3-176">**Figure 3: VMware/physical failback**</span></span>

![Navrácení služeb po obnovení](./media/vmware-walkthrough-architecture/enhanced-failback.png)


## <a name="next-steps"></a><span data-ttu-id="8e2a3-178">Další kroky</span><span class="sxs-lookup"><span data-stu-id="8e2a3-178">Next steps</span></span>

<span data-ttu-id="8e2a3-179">Přejděte příliš[krok 2: ověření předpoklady a omezení](vmware-walkthrough-prerequisites.md)</span><span class="sxs-lookup"><span data-stu-id="8e2a3-179">Go too[Step 2: Verify prerequisites and limitations](vmware-walkthrough-prerequisites.md)</span></span>
