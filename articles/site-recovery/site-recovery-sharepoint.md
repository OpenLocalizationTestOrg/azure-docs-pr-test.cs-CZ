---
title: "Vícevrstvé aplikace služby SharePoint pomocí Azure Site Recovery replikovat | Microsoft Docs"
description: "Tento článek popisuje, jak replikovat vícevrstvé aplikace služby SharePoint pomocí funkcí Azure Site Recovery."
services: site-recovery
documentationcenter: 
author: sujayt
manager: rochakm
editor: 
ms.assetid: 
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/10/2017
ms.author: sutalasi
ms.openlocfilehash: 9c0570b9da661a8ffb0041e5c24905480f55f6e2
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 07/11/2017
---
# <a name="replicate-a-multi-tier-sharepoint-application-for-disaster-recovery-using-azure-site-recovery"></a><span data-ttu-id="17848-103">Replikovat vícevrstvé aplikace služby SharePoint pro zotavení po havárii pomocí Azure Site Recovery</span><span class="sxs-lookup"><span data-stu-id="17848-103">Replicate a multi-tier SharePoint application for disaster recovery using Azure Site Recovery</span></span>

<span data-ttu-id="17848-104">Tento článek popisuje podrobný postup k ochraně aplikací služby SharePoint pomocí [Azure Site Recovery](site-recovery-overview.md).</span><span class="sxs-lookup"><span data-stu-id="17848-104">This article describes in detail how to protect a SharePoint application using  [Azure Site Recovery](site-recovery-overview.md).</span></span>


## <a name="overview"></a><span data-ttu-id="17848-105">Přehled</span><span class="sxs-lookup"><span data-stu-id="17848-105">Overview</span></span>

<span data-ttu-id="17848-106">Microsoft SharePoint je výkonné aplikace, která může pomoci skupinu nebo oddělení organizace, spolupracovat a sdílet informace.</span><span class="sxs-lookup"><span data-stu-id="17848-106">Microsoft SharePoint is a powerful application that can help a group or department organize, collaborate, and share information.</span></span> <span data-ttu-id="17848-107">SharePoint může poskytnout intranetu portálů, dokument a správa souborů, spolupráce, sociálních sítí, extranetu, weby, hledání enterprise a business intelligence.</span><span class="sxs-lookup"><span data-stu-id="17848-107">SharePoint can provide intranet portals, document and file management, collaboration, social networks, extranets, websites, enterprise search, and business intelligence.</span></span> <span data-ttu-id="17848-108">Je také integrace systému, proces integrace a možnosti automatizace pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="17848-108">It also has system integration, process integration, and workflow automation capabilities.</span></span> <span data-ttu-id="17848-109">Obvykle organizace považuje za jako aplikace úrovně 1 citlivé ztrátu výpadky a data.</span><span class="sxs-lookup"><span data-stu-id="17848-109">Typically, organizations consider it as a Tier-1 application sensitive to downtime and data loss.</span></span>

<span data-ttu-id="17848-110">Dnes Microsoft SharePoint neposkytuje žádné možnosti obnovení po havárii se na pole.</span><span class="sxs-lookup"><span data-stu-id="17848-110">Today, Microsoft SharePoint  does not provide any out-of-the-box disaster recovery capabilities.</span></span> <span data-ttu-id="17848-111">Bez ohledu na typ a škále havárie obnovení zahrnuje použití pohotovostní datového centra, kterou můžete obnovit do farmy.</span><span class="sxs-lookup"><span data-stu-id="17848-111">Regardless of the type and scale of a disaster, recovery involves the use of a standby data center that you can recover the farm to.</span></span> <span data-ttu-id="17848-112">Pohotovostní datových centrech jsou požadovány pro scénáře, kde místní redundantní systémy a zálohování nelze obnovit z výpadku v primárním datovém centru.</span><span class="sxs-lookup"><span data-stu-id="17848-112">Standby data centers are required for scenarios where local redundant systems and backups cannot recover from the outage at the primary data center.</span></span>

<span data-ttu-id="17848-113">Řešení pro zotavení po havárii dobrý musí umožňovat modelování plány obnovení kolem architektury komplexní aplikace, například SharePoint.</span><span class="sxs-lookup"><span data-stu-id="17848-113">A good disaster recovery solution should allow modeling of recovery plans around the  complex application architectures such as SharePoint.</span></span> <span data-ttu-id="17848-114">Musí být také možnost přidat vlastní postup zpracování aplikace mapování mezi různé úrovně a proto nabízí selhání jedním kliknutím nižší RTO v případě havárie.</span><span class="sxs-lookup"><span data-stu-id="17848-114">It should also have the ability to add customized steps to handle application mappings between various tiers and hence providing a single-click failover with a lower RTO in the event of a disaster.</span></span>

<span data-ttu-id="17848-115">Tento článek popisuje podrobný postup k ochraně aplikací služby SharePoint pomocí [Azure Site Recovery](site-recovery-overview.md).</span><span class="sxs-lookup"><span data-stu-id="17848-115">This article describes in detail how to protect a SharePoint application using [Azure Site Recovery](site-recovery-overview.md).</span></span> <span data-ttu-id="17848-116">Tento článek se zabývá osvědčené postupy pro replikaci tři vrstvy aplikace služby SharePoint do Azure, jak můžete provést postupu zotavení po havárii, a jak můžete převzetí služeb při selhání aplikaci do Azure.</span><span class="sxs-lookup"><span data-stu-id="17848-116">This article will cover best practices for replicating a three tier SharePoint application to Azure, how you can do a disaster recovery drill, and how you can failover the application to Azure.</span></span>

<span data-ttu-id="17848-117">Můžete sledovat níže uvedené video o obnovení k více vrstvy aplikaci do Azure.</span><span class="sxs-lookup"><span data-stu-id="17848-117">You can watch the below video about recovering a multi tier application to Azure.</span></span>

> [!VIDEO https://channel9.msdn.com/Series/Azure-Site-Recovery/Disaster-Recovery-of-load-balanced-multi-tier-applications-using-Azure-Site-Recovery/player]


## <a name="prerequisites"></a><span data-ttu-id="17848-118">Požadavky</span><span class="sxs-lookup"><span data-stu-id="17848-118">Prerequisites</span></span>

<span data-ttu-id="17848-119">Než začnete, ujistěte se, že rozumíte následující:</span><span class="sxs-lookup"><span data-stu-id="17848-119">Before you start, make sure you understand the following:</span></span>

1. [<span data-ttu-id="17848-120">Replikaci virtuálního počítače do Azure</span><span class="sxs-lookup"><span data-stu-id="17848-120">Replicating a virtual machine to Azure</span></span>](site-recovery-vmware-to-azure.md)
2. <span data-ttu-id="17848-121">Postup [návrh k síti pro obnovení](site-recovery-network-design.md)</span><span class="sxs-lookup"><span data-stu-id="17848-121">How to [design a recovery network](site-recovery-network-design.md)</span></span>
3. [<span data-ttu-id="17848-122">Provádění převzetí služeb při selhání do Azure</span><span class="sxs-lookup"><span data-stu-id="17848-122">Doing a test failover to Azure</span></span>](site-recovery-test-failover-to-azure.md)
4. [<span data-ttu-id="17848-123">Provádění převzetí služeb při selhání do Azure</span><span class="sxs-lookup"><span data-stu-id="17848-123">Doing a failover to Azure</span></span>](site-recovery-failover.md)
5. <span data-ttu-id="17848-124">Postup [replikace řadiče domény](site-recovery-active-directory.md)</span><span class="sxs-lookup"><span data-stu-id="17848-124">How to [replicate a domain controller](site-recovery-active-directory.md)</span></span>
6. <span data-ttu-id="17848-125">Postup [replikaci systému SQL Server](site-recovery-sql.md)</span><span class="sxs-lookup"><span data-stu-id="17848-125">How to [replicate SQL Server](site-recovery-sql.md)</span></span>

## <a name="sharepoint-architecture"></a><span data-ttu-id="17848-126">Architektura služby SharePoint</span><span class="sxs-lookup"><span data-stu-id="17848-126">SharePoint architecture</span></span>

<span data-ttu-id="17848-127">Služby SharePoint můžete nasadit na jeden nebo více serverů pomocí vrstvené topologie a role serveru k implementaci návrhu farmy, který splňuje specifické cíle a cílů.</span><span class="sxs-lookup"><span data-stu-id="17848-127">SharePoint can be deployed on one or more servers using tiered topologies and server roles to implement a farm design that meets specific goals and objectives.</span></span> <span data-ttu-id="17848-128">Typické velkých, vysoce vyžádání farmy služby SharePoint server podporující velký počet souběžných uživatelů a velký počet položek obsahu pomocí služby seskupování v rámci své strategie škálovatelnost.</span><span class="sxs-lookup"><span data-stu-id="17848-128">A typical large, high-demand SharePoint server farm that supports a high number of concurrent users and a large number of content items use service grouping as part of their scalability strategy.</span></span> <span data-ttu-id="17848-129">Tento postup zahrnuje službami na vyhrazené servery, seskupování tyto služby a škálování servery jako skupina.</span><span class="sxs-lookup"><span data-stu-id="17848-129">This approach involves running services on dedicated servers, grouping these services together, and then scaling out the servers as a group.</span></span> <span data-ttu-id="17848-130">Následující topologie znázorňuje služby a serveru seskupení pro vrstvu tři serverové farmy služby SharePoint.</span><span class="sxs-lookup"><span data-stu-id="17848-130">The following topology illustrates the service and server grouping for a three tier SharePoint server farm.</span></span> <span data-ttu-id="17848-131">Naleznete v dokumentaci k nástroji služby SharePoint a architektury řádku produktu podrobné informace o různé topologie služby SharePoint.</span><span class="sxs-lookup"><span data-stu-id="17848-131">Please refer to SharePoint documentation and product line architectures for detailed guidance on different SharePoint topologies.</span></span> <span data-ttu-id="17848-132">Můžete najít další podrobnosti o nasazení služby SharePoint 2013 v [tento dokument](https://technet.microsoft.com/en-us/library/cc303422.aspx).</span><span class="sxs-lookup"><span data-stu-id="17848-132">You can find more details about SharePoint 2013 deployment in [this document](https://technet.microsoft.com/en-us/library/cc303422.aspx).</span></span>



![Vzor nasazení 1](./media/site-recovery-sharepoint/sharepointarch.png)


## <a name="site-recovery-support"></a><span data-ttu-id="17848-134">Podpora pro obnovení lokality</span><span class="sxs-lookup"><span data-stu-id="17848-134">Site Recovery support</span></span>

<span data-ttu-id="17848-135">Pro vytvoření tohoto článku, používaly virtuální počítače VMware s Windows Server 2012 R2 Enterprise.</span><span class="sxs-lookup"><span data-stu-id="17848-135">For creating this article, VMware virtual machines with Windows Server 2012 R2 Enterprise were used.</span></span> <span data-ttu-id="17848-136">Byly použity SharePoint 2013 Enterprise edition a SQL server 2014 Enterprise edition.</span><span class="sxs-lookup"><span data-stu-id="17848-136">SharePoint 2013 Enterprise edition and SQL server 2014 Enterprise edition were used.</span></span> <span data-ttu-id="17848-137">Site Recovery replikace je nezávislá na aplikace, doporučení uvedená tady se očekává přidržte také následující scénáře.</span><span class="sxs-lookup"><span data-stu-id="17848-137">As Site Recovery replication is application agnostic, the recommendations provided here are expected to hold on for following scenarios as well.</span></span>

### <a name="source-and-target"></a><span data-ttu-id="17848-138">Zdroj a cíl</span><span class="sxs-lookup"><span data-stu-id="17848-138">Source and target</span></span>

<span data-ttu-id="17848-139">**Scénář**</span><span class="sxs-lookup"><span data-stu-id="17848-139">**Scenario**</span></span> | <span data-ttu-id="17848-140">**Sekundární lokality**</span><span class="sxs-lookup"><span data-stu-id="17848-140">**To a secondary site**</span></span> | <span data-ttu-id="17848-141">**Do Azure**</span><span class="sxs-lookup"><span data-stu-id="17848-141">**To Azure**</span></span>
--- | --- | ---
<span data-ttu-id="17848-142">**Hyper-V**</span><span class="sxs-lookup"><span data-stu-id="17848-142">**Hyper-V**</span></span> | <span data-ttu-id="17848-143">Ano</span><span class="sxs-lookup"><span data-stu-id="17848-143">Yes</span></span> | <span data-ttu-id="17848-144">Ano</span><span class="sxs-lookup"><span data-stu-id="17848-144">Yes</span></span>
<span data-ttu-id="17848-145">**VMware**</span><span class="sxs-lookup"><span data-stu-id="17848-145">**VMware**</span></span> | <span data-ttu-id="17848-146">Ano</span><span class="sxs-lookup"><span data-stu-id="17848-146">Yes</span></span> | <span data-ttu-id="17848-147">Ano</span><span class="sxs-lookup"><span data-stu-id="17848-147">Yes</span></span>
<span data-ttu-id="17848-148">**Fyzický server**</span><span class="sxs-lookup"><span data-stu-id="17848-148">**Physical server**</span></span> | <span data-ttu-id="17848-149">Ano</span><span class="sxs-lookup"><span data-stu-id="17848-149">Yes</span></span> | <span data-ttu-id="17848-150">Ano</span><span class="sxs-lookup"><span data-stu-id="17848-150">Yes</span></span>

### <a name="sharepoint-versions"></a><span data-ttu-id="17848-151">Verze služby SharePoint</span><span class="sxs-lookup"><span data-stu-id="17848-151">SharePoint Versions</span></span>
<span data-ttu-id="17848-152">Podporovány jsou následující verze serveru SharePoint.</span><span class="sxs-lookup"><span data-stu-id="17848-152">The following SharePoint server versions are supported.</span></span>

* <span data-ttu-id="17848-153">SharePoint server 2013 standardní</span><span class="sxs-lookup"><span data-stu-id="17848-153">SharePoint server 2013 Standard</span></span>
* <span data-ttu-id="17848-154">SharePoint server 2013 Enterprise</span><span class="sxs-lookup"><span data-stu-id="17848-154">SharePoint server 2013 Enterprise</span></span>
* <span data-ttu-id="17848-155">SharePoint server 2016 standardní</span><span class="sxs-lookup"><span data-stu-id="17848-155">SharePoint server 2016 Standard</span></span>
* <span data-ttu-id="17848-156">SharePoint server 2016 Enterprise</span><span class="sxs-lookup"><span data-stu-id="17848-156">SharePoint server 2016 Enterprise</span></span>

### <a name="things-to-keep-in-mind"></a><span data-ttu-id="17848-157">Co je potřeba mějte na paměti</span><span class="sxs-lookup"><span data-stu-id="17848-157">Things to keep in mind</span></span>

<span data-ttu-id="17848-158">Pokud používáte sdíleného disku clusteru jako libovolné úrovně ve vaší aplikaci pak nebude možné použít replikace Site Recovery k replikaci těchto virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="17848-158">If you are using a shared disk-based cluster as any tier in your application then you will not be able to use Site Recovery replication to replicate those virtual machines.</span></span> <span data-ttu-id="17848-159">Můžete použít nativní replikaci poskytuje aplikace a pak použít [plán obnovení](site-recovery-create-recovery-plans.md) převzetí služeb při selhání, všechny úrovně.</span><span class="sxs-lookup"><span data-stu-id="17848-159">You can use native replication provided by the application and then use a [recovery plan](site-recovery-create-recovery-plans.md) to failover all tiers.</span></span>

## <a name="replicating-virtual-machines"></a><span data-ttu-id="17848-160">Replikace virtuálních počítačů</span><span class="sxs-lookup"><span data-stu-id="17848-160">Replicating virtual machines</span></span>

<span data-ttu-id="17848-161">Postupujte podle [v tomto návodu](site-recovery-vmware-to-azure.md) k zahájení replikace virtuálního počítače do Azure.</span><span class="sxs-lookup"><span data-stu-id="17848-161">Follow [this guidance](site-recovery-vmware-to-azure.md) to start replicating the virtual machine to Azure.</span></span>

* <span data-ttu-id="17848-162">Po dokončení replikace Ujistěte se, přejděte na každý virtuální počítač každý vrstvy a vyberte stejné skupině dostupnosti, replikované položky > Nastavení > Vlastnosti > výpočty a síť ".</span><span class="sxs-lookup"><span data-stu-id="17848-162">Once the replication is complete, make sure you go to each virtual machine of each tier and select same availability set in 'Replicated item > Settings > Properties > Compute and Network'.</span></span> <span data-ttu-id="17848-163">Například pokud vaše webová vrstva 3 virtuální počítače, ujistěte se, že jsou 3 virtuální počítače nakonfigurované jako součást stejné dostupnosti v Azure.</span><span class="sxs-lookup"><span data-stu-id="17848-163">For example, if your web tier has 3 VMs, ensure all the 3 VMs are configured to be part of same availability set in Azure.</span></span>

    ![Sada sady dostupnosti.](./media/site-recovery-sharepoint/select-av-set.png)

* <span data-ttu-id="17848-165">Pokyny o ochraně Active Directory a DNS, najdete v tématu [chránit Active Directory a DNS](site-recovery-active-directory.md) dokumentu.</span><span class="sxs-lookup"><span data-stu-id="17848-165">For guidance on protecting Active Directory and DNS, refer to [Protect Active Directory and DNS](site-recovery-active-directory.md) document.</span></span>

* <span data-ttu-id="17848-166">Pokyny k ochraně databázové vrstvy systémem SQL server, najdete v části [chránit SQL Server](site-recovery-active-directory.md) dokumentu.</span><span class="sxs-lookup"><span data-stu-id="17848-166">For guidance on protecting database tier running on SQL server, refer to [Protect SQL Server](site-recovery-active-directory.md) document.</span></span>

## <a name="networking-configuration"></a><span data-ttu-id="17848-167">Konfigurace sítě</span><span class="sxs-lookup"><span data-stu-id="17848-167">Networking configuration</span></span>

### <a name="network-properties"></a><span data-ttu-id="17848-168">Vlastnosti sítě</span><span class="sxs-lookup"><span data-stu-id="17848-168">Network properties</span></span>

* <span data-ttu-id="17848-169">Pro aplikaci a webovou vrstvu virtuálních počítačů nakonfigurujte nastavení sítě na portálu Azure tak, aby získat virtuální počítače připojené k správného síťového zotavení po Havárii po převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="17848-169">For the App and Web tier VMs, configure network settings in Azure portal so that the VMs get attached to the right DR network after failover.</span></span>

    ![Vyberte síť](./media/site-recovery-sharepoint/select-network.png)


* <span data-ttu-id="17848-171">Pokud používáte statickou IP adresu, zadejte IP adresa, která má virtuální počítač přijmout **cílová IP adresa** pole</span><span class="sxs-lookup"><span data-stu-id="17848-171">If you are using a static IP, then specify the IP that you want the virtual machine to take in the **Target IP** field</span></span>

    ![Nastavit statickou IP adresu](./media/site-recovery-sharepoint/set-static-ip.png)

### <a name="dns-and-traffic-routing"></a><span data-ttu-id="17848-173">DNS a směrování provozu</span><span class="sxs-lookup"><span data-stu-id="17848-173">DNS and Traffic Routing</span></span>

<span data-ttu-id="17848-174">Pro internetové weby [vytvořit profil Traffic Manageru typu "Priority"](../traffic-manager/traffic-manager-create-profile.md) v rámci předplatného Azure.</span><span class="sxs-lookup"><span data-stu-id="17848-174">For internet facing sites, [create a Traffic Manager profile of 'Priority' type](../traffic-manager/traffic-manager-create-profile.md) in the Azure subscription.</span></span> <span data-ttu-id="17848-175">A pak nakonfigurujte DNS a Traffic Manager profilu následujícím způsobem.</span><span class="sxs-lookup"><span data-stu-id="17848-175">And then configure your DNS and Traffic Manager profile in the following manner.</span></span>


| <span data-ttu-id="17848-176">**Kde**</span><span class="sxs-lookup"><span data-stu-id="17848-176">**Where**</span></span> | <span data-ttu-id="17848-177">**Zdroj**</span><span class="sxs-lookup"><span data-stu-id="17848-177">**Source**</span></span> | <span data-ttu-id="17848-178">**Cíl**</span><span class="sxs-lookup"><span data-stu-id="17848-178">**Target**</span></span>|
| --- | --- | --- |
| <span data-ttu-id="17848-179">Veřejné služby DNS</span><span class="sxs-lookup"><span data-stu-id="17848-179">Public DNS</span></span> | <span data-ttu-id="17848-180">Veřejné služby DNS pro weby služby SharePoint</span><span class="sxs-lookup"><span data-stu-id="17848-180">Public DNS for SharePoint sites</span></span> <br/><br/> <span data-ttu-id="17848-181">Například: sharepoint.contoso.com</span><span class="sxs-lookup"><span data-stu-id="17848-181">Ex: sharepoint.contoso.com</span></span> | <span data-ttu-id="17848-182">Traffic Manager</span><span class="sxs-lookup"><span data-stu-id="17848-182">Traffic Manager</span></span> <br/><br/> <span data-ttu-id="17848-183">contososharepoint.trafficmanager.NET</span><span class="sxs-lookup"><span data-stu-id="17848-183">contososharepoint.trafficmanager.net</span></span> |
| <span data-ttu-id="17848-184">Místní DNS</span><span class="sxs-lookup"><span data-stu-id="17848-184">On-premises DNS</span></span> | <span data-ttu-id="17848-185">sharepointonprem.contoso.com</span><span class="sxs-lookup"><span data-stu-id="17848-185">sharepointonprem.contoso.com</span></span> | <span data-ttu-id="17848-186">Veřejná IP adresa na místní farmě</span><span class="sxs-lookup"><span data-stu-id="17848-186">Public IP on the on-premises farm</span></span> |


<span data-ttu-id="17848-187">V profilu Traffic Manageru [vytvoření koncových bodů primárními a obnovovacími](../traffic-manager/traffic-manager-configure-priority-routing-method.md).</span><span class="sxs-lookup"><span data-stu-id="17848-187">In the Traffic Manager profile, [create the primary and recovery endpoints](../traffic-manager/traffic-manager-configure-priority-routing-method.md).</span></span> <span data-ttu-id="17848-188">Použijte externí koncový bod pro místní koncový bod a veřejnou IP adresu pro koncový bod Azure.</span><span class="sxs-lookup"><span data-stu-id="17848-188">Use the external endpoint for on-premises endpoint and public IP for Azure endpoint.</span></span> <span data-ttu-id="17848-189">Ujistěte se, že je priorita nastavena tak, aby místní koncový bod.</span><span class="sxs-lookup"><span data-stu-id="17848-189">Ensure that the priority is set higher to on-premises endpoint.</span></span>

<span data-ttu-id="17848-190">Zkušební stránku na určitém portu (například 800) hostitele ve vrstvě web služby SharePoint v pořadí pro správce provozu automaticky zjišťovat dostupnost post převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="17848-190">Host a test page on a specific port (for example, 800) in the SharePoint web tier in order for Traffic Manager to automatically detect availability post failover.</span></span> <span data-ttu-id="17848-191">Toto je alternativní řešení, v případě, že na všech webů služby SharePoint nelze povolit anonymní ověřování.</span><span class="sxs-lookup"><span data-stu-id="17848-191">This is a workaround in case you cannot enable anonymous authentication on any of your SharePoint sites.</span></span>

<span data-ttu-id="17848-192">[Nakonfigurujte profil služby Traffic Manager](../traffic-manager/traffic-manager-configure-priority-routing-method.md) se následující nastavení.</span><span class="sxs-lookup"><span data-stu-id="17848-192">[Configure the Traffic Manager profile](../traffic-manager/traffic-manager-configure-priority-routing-method.md) with the below settings.</span></span>

* <span data-ttu-id="17848-193">Metody směrování - 'Priority.</span><span class="sxs-lookup"><span data-stu-id="17848-193">Routing method - 'Priority'</span></span>
* <span data-ttu-id="17848-194">DNS hodnota time to live (TTL) – 30 sekund.</span><span class="sxs-lookup"><span data-stu-id="17848-194">DNS time to live (TTL) - '30 seconds'</span></span>
* <span data-ttu-id="17848-195">Nastavení monitorování koncového bodu – Pokud povolíte anonymní ověřování, můžete udělit koncový bod konkrétní web.</span><span class="sxs-lookup"><span data-stu-id="17848-195">Endpoint monitor settings - If you can enable anonymous authentication, you can give a specific website endpoint.</span></span> <span data-ttu-id="17848-196">Nebo můžete použít zkušební stránku na určitém portu (například 800).</span><span class="sxs-lookup"><span data-stu-id="17848-196">Or, you can use a test page on a specific port (for example, 800).</span></span>

## <a name="creating-a-recovery-plan"></a><span data-ttu-id="17848-197">Vytvoření plánu obnovení</span><span class="sxs-lookup"><span data-stu-id="17848-197">Creating a recovery plan</span></span>

<span data-ttu-id="17848-198">Plán obnovení umožňuje pořadí převzetí služeb při selhání v různých vrstvách vícevrstvé aplikace, proto zachování konzistence aplikace.</span><span class="sxs-lookup"><span data-stu-id="17848-198">A recovery plan allows sequencing the failover of various tiers in a multi-tier application, hence, maintaining application consistency.</span></span> <span data-ttu-id="17848-199">Použijte následujících kroků při vytváření plánu obnovení vícevrstvých webových aplikací.</span><span class="sxs-lookup"><span data-stu-id="17848-199">Follow the below steps while creating a recovery plan for a multi-tier web application.</span></span> <span data-ttu-id="17848-200">[Další informace o vytváření plánu obnovení](site-recovery-runbook-automation.md#customize-the-recovery-plan).</span><span class="sxs-lookup"><span data-stu-id="17848-200">[Learn more about creating a recovery plan](site-recovery-runbook-automation.md#customize-the-recovery-plan).</span></span>

### <a name="adding-virtual-machines-to-failover-groups"></a><span data-ttu-id="17848-201">Probíhá přidávání virtuálních počítačů do skupin převzetí služeb při selhání</span><span class="sxs-lookup"><span data-stu-id="17848-201">Adding virtual machines to failover groups</span></span>

1. <span data-ttu-id="17848-202">Vytvoření plánu obnovení přidáním aplikace a webové vrstvy virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="17848-202">Create a recovery plan by adding the App and Web tier VMs.</span></span>
2. <span data-ttu-id="17848-203">Klikněte na "Upravit" skupiny virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="17848-203">Click on 'Customize' to group the VMs.</span></span> <span data-ttu-id="17848-204">Ve výchozím nastavení všechny virtuální počítače jsou součástí skupiny 1, který.</span><span class="sxs-lookup"><span data-stu-id="17848-204">By default, all VMs are part of 'Group 1'.</span></span>

    ![Přizpůsobení RP](./media/site-recovery-sharepoint/rp-groups.png)

3. <span data-ttu-id="17848-206">Vytvořte další skupinu (skupiny 2) a přesuňte webovou vrstvu virtuálních počítačů do nové skupiny.</span><span class="sxs-lookup"><span data-stu-id="17848-206">Create another Group (Group 2) and move the Web tier VMs into the new group.</span></span> <span data-ttu-id="17848-207">Vaše aplikace vrstvy virtuální počítače by měly být součástí skupiny 1, a webovou vrstvu virtuálních počítačů musí být součástí 'Skupiny 2'.</span><span class="sxs-lookup"><span data-stu-id="17848-207">Your App tier VMs should be part of 'Group 1' and Web tier VMs should be part of 'Group 2'.</span></span> <span data-ttu-id="17848-208">Toto je zajistit, aby spouštěcí virtuální počítače vrstvy aplikace si nejprve následuje webovou vrstvu virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="17848-208">This is to ensure that the App tier VMs boot up first followed by Web tier VMs.</span></span>


### <a name="adding-scripts-to-the-recovery-plan"></a><span data-ttu-id="17848-209">Probíhá přidávání skriptů do plánu obnovení</span><span class="sxs-lookup"><span data-stu-id="17848-209">Adding scripts to the recovery plan</span></span>

<span data-ttu-id="17848-210">Nejčastěji používané skripty Azure Site Recovery můžete nasadit do vašeho účtu Automation klepnutím na tlačítko 'nasadit do Azure, níže.</span><span class="sxs-lookup"><span data-stu-id="17848-210">You can deploy the most commonly used Azure Site Recovery scripts into your Automation account clicking the 'Deploy to Azure' button below.</span></span> <span data-ttu-id="17848-211">Při použití všech publikovaných skriptů, zajistěte, aby že podle pokynů uvedených ve skriptu.</span><span class="sxs-lookup"><span data-stu-id="17848-211">When you are using any published script, ensure you follow the guidance in the script.</span></span>

<span data-ttu-id="17848-212">[![Nasazení do Azure](https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/c4803408-340e-49e3-9a1f-0ed3f689813d.png)](https://aka.ms/asr-automationrunbooks-deploy)</span><span class="sxs-lookup"><span data-stu-id="17848-212">[![Deploy to Azure](https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/c4803408-340e-49e3-9a1f-0ed3f689813d.png)](https://aka.ms/asr-automationrunbooks-deploy)</span></span>

1. <span data-ttu-id="17848-213">Přidáte skript předběžné akce na '1 skupiny' převzetí služeb při selhání skupiny dostupnosti SQL.</span><span class="sxs-lookup"><span data-stu-id="17848-213">Add a pre-action script to 'Group 1' to failover SQL Availability group.</span></span> <span data-ttu-id="17848-214">Použít skript, automatické obnovení systému SQL FailoverAG' publikován v ukázkové skripty.</span><span class="sxs-lookup"><span data-stu-id="17848-214">Use the 'ASR-SQL-FailoverAG' script published in the sample scripts.</span></span> <span data-ttu-id="17848-215">Ujistěte se, postupujte podle pokynů ve skriptu a proveďte požadované změny ve skriptu správně.</span><span class="sxs-lookup"><span data-stu-id="17848-215">Ensure you follow the guidance in the script and make the required changes in the script appropriately.</span></span>

    ![Přidat AG-skriptu krok-1](./media/site-recovery-sharepoint/add-ag-script-step1.png)

    ![Přidat AG-skriptu krok-2](./media/site-recovery-sharepoint/add-ag-script-step2.png)

2. <span data-ttu-id="17848-218">Přidat skript akce post připojit nástroj pro vyrovnávání zatížení na neúspěšný přes virtuální počítače webová vrstva (2. skupina).</span><span class="sxs-lookup"><span data-stu-id="17848-218">Add a post action script to attach a load balancer on the failed over virtual machines of Web tier (Group 2).</span></span> <span data-ttu-id="17848-219">Použít skript, automatické obnovení systému-AddSingleLoadBalancer' publikován v ukázkové skripty.</span><span class="sxs-lookup"><span data-stu-id="17848-219">Use the 'ASR-AddSingleLoadBalancer' script published in the sample scripts.</span></span> <span data-ttu-id="17848-220">Ujistěte se, postupujte podle pokynů ve skriptu a proveďte požadované změny ve skriptu správně.</span><span class="sxs-lookup"><span data-stu-id="17848-220">Ensure you follow the guidance in the script and make the required changes in the script appropriately.</span></span>

    ![Přidat LB-skriptu krok-1](./media/site-recovery-sharepoint/add-lb-script-step1.png)

    ![Přidat LB-skriptu krok-2](./media/site-recovery-sharepoint/add-lb-script-step2.png)

3. <span data-ttu-id="17848-223">Přidejte ruční krok k aktualizaci záznamů DNS tak, aby odkazoval na nové farmě v Azure.</span><span class="sxs-lookup"><span data-stu-id="17848-223">Add a manual step to update the DNS records to point to the new farm in Azure.</span></span>

    * <span data-ttu-id="17848-224">Pro internetové weby nejsou žádné aktualizace DNS požadované post převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="17848-224">For internet facing sites, no DNS updates are required post failover.</span></span> <span data-ttu-id="17848-225">Postupujte podle kroků popsaných v části "pokyny sítě, ke konfiguraci Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="17848-225">Follow the steps described in the 'Networking guidance' section to configure Traffic Manager.</span></span> <span data-ttu-id="17848-226">Pokud se profil služby Traffic Manager nastavena tak jak je popsáno v předchozí části, přidejte skript pro otevření portu fiktivní (800 v příkladu) ve virtuálním počítači Azure.</span><span class="sxs-lookup"><span data-stu-id="17848-226">If the Traffic Manager profile has been set up as described in the previous section, add a script to open dummy port (800 in the example) on the Azure VM.</span></span>

    * <span data-ttu-id="17848-227">Pro interní weby přidejte ruční krok k aktualizaci záznamu DNS tak, aby odkazoval na IP adresu služby Vyrovnávání zatížení nové webové vrstvy Virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="17848-227">For internal facing sites, add a manual step to update the DNS record to point to the new Web tier VM’s load balancer IP.</span></span>

4. <span data-ttu-id="17848-228">Přidejte ruční krok vyhledávací aplikaci obnovit ze zálohy nebo spuštění nové služby vyhledávání.</span><span class="sxs-lookup"><span data-stu-id="17848-228">Add a manual step to restore search application from a backup or start a new search service.</span></span>

5. <span data-ttu-id="17848-229">Pro aplikaci služby vyhledávání obnovení ze zálohy, postupujte podle následujících kroků.</span><span class="sxs-lookup"><span data-stu-id="17848-229">For restoring Search service application from a backup, follow below steps.</span></span>

    * <span data-ttu-id="17848-230">Tato metoda předpokládá, že zálohy aplikace Vyhledávací služby byla provedena před závažné události a zda je záloha dostupná v lokalitě zotavení po Havárii.</span><span class="sxs-lookup"><span data-stu-id="17848-230">This method assumes that a backup of the Search Service Application was performed before the catastrophic event and that the backup is available at the DR site.</span></span>
    * <span data-ttu-id="17848-231">To lze snadno dosáhnout plánování zálohování (například, jednou denně) a postupem kopie umístit zálohování v lokalitě zotavení po Havárii.</span><span class="sxs-lookup"><span data-stu-id="17848-231">This can easily be achieved by scheduling the backup (for example, once daily) and using a copy procedure to place the backup at the DR site.</span></span> <span data-ttu-id="17848-232">Kopírování postupů může obsahovat skriptované programy jako AzCopy (kopie Azure) nebo nastavení služby DFSR (distribuované služby replikace souborů).</span><span class="sxs-lookup"><span data-stu-id="17848-232">Copy procedures could include scripted programs such as AzCopy (Azure Copy) or setting up DFSR (Distributed File Services Replication).</span></span>
    * <span data-ttu-id="17848-233">Teď, když běží farmy služby SharePoint, přejděte centrální správy, zálohování a obnovení' a vyberte možnost obnovit.</span><span class="sxs-lookup"><span data-stu-id="17848-233">Now that the SharePoint farm is running, navigate the Central Administration, 'Backup and Restore' and select Restore.</span></span> <span data-ttu-id="17848-234">Obnovení interrogates zadané umístění zálohy (budete muset aktualizovat hodnotu).</span><span class="sxs-lookup"><span data-stu-id="17848-234">The restore interrogates the backup location specified (you may need to update the value).</span></span> <span data-ttu-id="17848-235">Vyberte zálohu aplikace Vyhledávací služby, které chcete obnovit.</span><span class="sxs-lookup"><span data-stu-id="17848-235">Select the Search Service Application backup you would like to restore.</span></span>
    * <span data-ttu-id="17848-236">Hledání je obnoven.</span><span class="sxs-lookup"><span data-stu-id="17848-236">Search is restored.</span></span> <span data-ttu-id="17848-237">Mějte na paměti, která očekává obnovení najít stejné topologie (stejný počet serverů) a stejná pevný disk písmena přiřazené k těmto serverům.</span><span class="sxs-lookup"><span data-stu-id="17848-237">Keep in mind that the restore expects to find the same topology (same number of servers) and same hard drive letters assigned to those servers.</span></span> <span data-ttu-id="17848-238">Další informace najdete v tématu [obnovit vyhledávání služby aplikace v SharePoint 2013](https://technet.microsoft.com/library/ee748654.aspx) dokumentu.</span><span class="sxs-lookup"><span data-stu-id="17848-238">For more information, see ['Restore Search service application in SharePoint 2013'](https://technet.microsoft.com/library/ee748654.aspx) document.</span></span>


6. <span data-ttu-id="17848-239">Pro spuštění s novou aplikaci Vyhledávací služby, postupujte podle následujících kroků.</span><span class="sxs-lookup"><span data-stu-id="17848-239">For starting with a new Search service application, follow below steps.</span></span>

    * <span data-ttu-id="17848-240">Tato metoda předpokládá, že zálohy databáze "Správa vyhledávání" je k dispozici v lokalitě zotavení po Havárii.</span><span class="sxs-lookup"><span data-stu-id="17848-240">This method assumes that a backup of the “Search Administration” database is available at the DR site.</span></span>
    * <span data-ttu-id="17848-241">Vzhledem k tomu, že ostatní databáze aplikace služby vyhledávání nejsou replikovány, musí být vytvořeny znovu.</span><span class="sxs-lookup"><span data-stu-id="17848-241">Since the other Search Service Application databases are not replicated, they need to be re-created.</span></span> <span data-ttu-id="17848-242">Uděláte to tak, přejděte do centrální správy a delete pro aplikaci služby vyhledávání.</span><span class="sxs-lookup"><span data-stu-id="17848-242">To do so, navigate to Central Administration and delete the Search Service Application.</span></span> <span data-ttu-id="17848-243">Na všechny servery, které jsou hostiteli indexu vyhledávání odstraňte soubory indexu.</span><span class="sxs-lookup"><span data-stu-id="17848-243">On any servers which host the Search Index, delete the index files.</span></span>
    * <span data-ttu-id="17848-244">Znovu vytvořte aplikaci Vyhledávací služby a tím se znovu vytvoří databáze.</span><span class="sxs-lookup"><span data-stu-id="17848-244">Re-create the Search Service Application and this re-creates the databases.</span></span> <span data-ttu-id="17848-245">Doporučuje se mít připravené skript, který znovu vytvoří tuto aplikaci služby, protože to není možné provést všechny akce prostřednictvím grafického uživatelského rozhraní.</span><span class="sxs-lookup"><span data-stu-id="17848-245">It is recommended to have a prepared script that re-creates this service application since it is not possible to perform all actions via the GUI.</span></span> <span data-ttu-id="17848-246">Například umístění jednotky index nastavení a konfiguraci topologie vyhledávání jsou možná jenom pomocí rutin prostředí PowerShell služby SharePoint.</span><span class="sxs-lookup"><span data-stu-id="17848-246">For example, setting the index drive location and configuring the search topology are only possible by using SharePoint PowerShell cmdlets.</span></span> <span data-ttu-id="17848-247">Použijte rutinu prostředí Windows PowerShell obnovení SPEnterpriseSearchServiceApplication a zadejte zasílání protokolů a replikované vyhledávání databázi správy, Search_Service__DB.</span><span class="sxs-lookup"><span data-stu-id="17848-247">Use the Windows PowerShell cmdlet Restore-SPEnterpriseSearchServiceApplication and specify the log-shipped and replicated Search Administration database, Search_Service__DB.</span></span> <span data-ttu-id="17848-248">Tato rutina poskytuje konfiguraci hledání, schéma, spravované vlastnosti, pravidla a zdroje a vytvoří výchozí sadu ostatní součásti.</span><span class="sxs-lookup"><span data-stu-id="17848-248">This cmdlet gives the search configuration, schema, managed properties, rules, and sources and creates a default set of the other components.</span></span>
    * <span data-ttu-id="17848-249">Jakmile aplikaci Vyhledávací služby je potřeba znovu vytvořit, je nutné spustit úplné procházení pro každý zdroj obsahu obnovit službu vyhledávání.</span><span class="sxs-lookup"><span data-stu-id="17848-249">Once the Search Service Application has be re-created, you must start a full crawl for each content source to restore the Search Service.</span></span> <span data-ttu-id="17848-250">Přijdete o některé informace analytics z farmy místního, jako je například vyhledávání doporučení.</span><span class="sxs-lookup"><span data-stu-id="17848-250">You lose some analytics information from the on-premises farm, such as search recommendations.</span></span>

7. <span data-ttu-id="17848-251">Po dokončení všech kroků, uložení plánu obnovení a plán konečné obnovení bude vypadat podobně jako následující.</span><span class="sxs-lookup"><span data-stu-id="17848-251">Once all the steps are completed, save the recovery plan and the final recovery plan will look like following.</span></span>

    ![Uložené RP](./media/site-recovery-sharepoint/saved-rp.png)

## <a name="doing-a-test-failover"></a><span data-ttu-id="17848-253">Provádění testovací převzetí služeb</span><span class="sxs-lookup"><span data-stu-id="17848-253">Doing a test failover</span></span>
<span data-ttu-id="17848-254">Postupujte podle [v tomto návodu](site-recovery-test-failover-to-azure.md) provedete testovací převzetí služeb.</span><span class="sxs-lookup"><span data-stu-id="17848-254">Follow [this guidance](site-recovery-test-failover-to-azure.md) to do a test failover.</span></span>

1.  <span data-ttu-id="17848-255">Přejděte na portál Azure a vyberte trezoru služby zotavení.</span><span class="sxs-lookup"><span data-stu-id="17848-255">Go to Azure portal and select your Recovery Service vault.</span></span>
2.  <span data-ttu-id="17848-256">Kliknutím na vytvořit pro aplikaci SharePoint plánu obnovení.</span><span class="sxs-lookup"><span data-stu-id="17848-256">Click on the recovery plan created for SharePoint application.</span></span>
3.  <span data-ttu-id="17848-257">Klikněte na "Testovací převzetí služeb".</span><span class="sxs-lookup"><span data-stu-id="17848-257">Click on 'Test Failover'.</span></span>
4.  <span data-ttu-id="17848-258">Vyberte bod obnovení a virtuální síť Azure ke spuštění procesu testovací převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="17848-258">Select recovery point and Azure virtual network to start the test failover process.</span></span>
5.  <span data-ttu-id="17848-259">Jakmile sekundární prostředí zapnutý, můžete provést vaše ověření.</span><span class="sxs-lookup"><span data-stu-id="17848-259">Once the secondary environment is up, you can perform your validations.</span></span>
6.  <span data-ttu-id="17848-260">Po dokončení k ověření se 'vyčistit testovací převzetí služeb při selhání, můžete kliknutím na plánu obnovení a vyčištění prostředí testovacího převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="17848-260">Once the validations are complete, you can click 'Cleanup test failover' on the recovery plan and the test failover environment is cleaned.</span></span>

<span data-ttu-id="17848-261">Pokyny k provádění převzetí služeb při selhání pro AD a DNS, odkazovat na [testovací převzetí služeb při selhání aspekty AD a DNS](site-recovery-active-directory.md#test-failover-considerations) dokumentu.</span><span class="sxs-lookup"><span data-stu-id="17848-261">For guidance on doing test failover for AD and DNS, refer to [Test failover considerations for AD and DNS](site-recovery-active-directory.md#test-failover-considerations) document.</span></span>

<span data-ttu-id="17848-262">Pokyny k provádění převzetí služeb při selhání pro SQL vždy na skupiny dostupnosti, najdete v části [provádění testovací převzetí služeb při selhání pro SQL serveru Always On](site-recovery-sql.md#steps-to-do-a-test-failover) dokumentu.</span><span class="sxs-lookup"><span data-stu-id="17848-262">For guidance on doing test failover for SQL Always ON availability groups, refer to [Doing Test failover for SQL Server Always On](site-recovery-sql.md#steps-to-do-a-test-failover) document.</span></span>

## <a name="doing-a-failover"></a><span data-ttu-id="17848-263">Převzetím služeb</span><span class="sxs-lookup"><span data-stu-id="17848-263">Doing a failover</span></span>
<span data-ttu-id="17848-264">Postupujte podle [v tomto návodu](site-recovery-failover.md) pro převzetím služeb.</span><span class="sxs-lookup"><span data-stu-id="17848-264">Follow [this guidance](site-recovery-failover.md) for doing a failover.</span></span>

1.  <span data-ttu-id="17848-265">Přejděte na portál Azure a vyberte svůj trezor služeb zotavení.</span><span class="sxs-lookup"><span data-stu-id="17848-265">Go to Azure portal and select your Recovery Services vault.</span></span>
2.  <span data-ttu-id="17848-266">Kliknutím na vytvořit pro aplikaci SharePoint plánu obnovení.</span><span class="sxs-lookup"><span data-stu-id="17848-266">Click on the recovery plan created for SharePoint application.</span></span>
3.  <span data-ttu-id="17848-267">Klikněte na 'Převzetí služeb při selhání'.</span><span class="sxs-lookup"><span data-stu-id="17848-267">Click on 'Failover'.</span></span>
4.  <span data-ttu-id="17848-268">Vyberte bod obnovení se spustit proces převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="17848-268">Select recovery point to start the failover process.</span></span>

## <a name="next-steps"></a><span data-ttu-id="17848-269">Další kroky</span><span class="sxs-lookup"><span data-stu-id="17848-269">Next steps</span></span>
<span data-ttu-id="17848-270">Další informace o [replikace jiné aplikace](site-recovery-workload.md) pomocí Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="17848-270">You can learn more about [replicating other applications](site-recovery-workload.md) using Site Recovery.</span></span>
