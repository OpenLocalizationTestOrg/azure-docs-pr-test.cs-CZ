---
title: "ladění pokyny aaaAzure Data Lake Store Storm výkonu | Microsoft Docs"
description: "Ladění pravidla výkonu Storm Azure Data Lake Store"
services: data-lake-store
documentationcenter: 
author: stewu
manager: amitkul
editor: stewu
ms.assetid: ebde7b9f-2e51-4d43-b7ab-566417221335
ms.service: data-lake-store
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 12/19/2016
ms.author: stewu
ms.openlocfilehash: 5412fd46cf2373f5877030913df4fe1fc6f5473a
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="performance-tuning-guidance-for-storm-on-hdinsight-and-azure-data-lake-store"></a><span data-ttu-id="7068f-103">Pokyny pro Storm v HDInsight a Azure Data Lake Store optimalizace výkonu</span><span class="sxs-lookup"><span data-stu-id="7068f-103">Performance tuning guidance for Storm on HDInsight and Azure Data Lake Store</span></span>

<span data-ttu-id="7068f-104">Pochopení hello faktory, které je potřeba zvážit při optimalizaci výkonu hello topologie Azure Storm.</span><span class="sxs-lookup"><span data-stu-id="7068f-104">Understand hello factors that should be considered when you tune hello performance of an Azure Storm topology.</span></span> <span data-ttu-id="7068f-105">Například je důležité toounderstand hello charakteristika hello práci ve funkcích spouts hello a hello funkce bolts (zda pracovní hello je vstupně-výstupních operací nebo náročná na paměť).</span><span class="sxs-lookup"><span data-stu-id="7068f-105">For example, it's important toounderstand hello characteristics of hello work done by hello spouts and hello bolts (whether hello work is I/O or memory intensive).</span></span> <span data-ttu-id="7068f-106">Tento článek se zabývá řadu pokyny, včetně řešení běžných potíží optimalizace výkonu.</span><span class="sxs-lookup"><span data-stu-id="7068f-106">This article covers a range of performance tuning guidelines, including troubleshooting common issues.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="7068f-107">Požadavky</span><span class="sxs-lookup"><span data-stu-id="7068f-107">Prerequisites</span></span>

* <span data-ttu-id="7068f-108">**Předplatné Azure**.</span><span class="sxs-lookup"><span data-stu-id="7068f-108">**An Azure subscription**.</span></span> <span data-ttu-id="7068f-109">Viz [Získání bezplatné zkušební verze Azure](https://azure.microsoft.com/pricing/free-trial/).</span><span class="sxs-lookup"><span data-stu-id="7068f-109">See [Get Azure free trial](https://azure.microsoft.com/pricing/free-trial/).</span></span>
* <span data-ttu-id="7068f-110">**Účet Azure Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="7068f-110">**An Azure Data Lake Store account**.</span></span> <span data-ttu-id="7068f-111">Návod, jak jeden, viz toocreate [Začínáme s Azure Data Lake Store](data-lake-store-get-started-portal.md).</span><span class="sxs-lookup"><span data-stu-id="7068f-111">For instructions on how toocreate one, see [Get started with Azure Data Lake Store](data-lake-store-get-started-portal.md).</span></span>
* <span data-ttu-id="7068f-112">**Cluster Azure HDInsight** s tooa přístup k účtu Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="7068f-112">**An Azure HDInsight cluster** with access tooa Data Lake Store account.</span></span> <span data-ttu-id="7068f-113">V tématu [vytvoření clusteru HDInsight s Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span><span class="sxs-lookup"><span data-stu-id="7068f-113">See [Create an HDInsight cluster with Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span></span> <span data-ttu-id="7068f-114">Ujistěte se, že povolení vzdálené plochy pro hello clusteru.</span><span class="sxs-lookup"><span data-stu-id="7068f-114">Make sure you enable Remote Desktop for hello cluster.</span></span>
* <span data-ttu-id="7068f-115">**Spuštění clusteru Storm v Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="7068f-115">**Running a Storm cluster on Data Lake Store**.</span></span> <span data-ttu-id="7068f-116">Další informace najdete v tématu [Storm v HDInsight](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-storm-overview).</span><span class="sxs-lookup"><span data-stu-id="7068f-116">For more information, see [Storm on HDInsight](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-storm-overview).</span></span>
* <span data-ttu-id="7068f-117">**Pokyny v Data Lake Store ladění výkonu**.</span><span class="sxs-lookup"><span data-stu-id="7068f-117">**Performance tuning guidelines on Data Lake Store**.</span></span>  <span data-ttu-id="7068f-118">Obecný výkon koncepty, najdete v části [Data Lake Store výkonu ladění pokyny](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance).</span><span class="sxs-lookup"><span data-stu-id="7068f-118">For general performance concepts, see [Data Lake Store Performance Tuning Guidance](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance).</span></span>  

## <a name="tune-hello-parallelism-of-hello-topology"></a><span data-ttu-id="7068f-119">Vyladění hello paralelismu topologie hello</span><span class="sxs-lookup"><span data-stu-id="7068f-119">Tune hello parallelism of hello topology</span></span>

<span data-ttu-id="7068f-120">Je možné tooimprove výkonu roste souběžnosti hello z hello vstupně-výstupních operací tooand z Data Lake Store.</span><span class="sxs-lookup"><span data-stu-id="7068f-120">You might be able tooimprove performance by increasing hello concurrency of hello I/O tooand from Data Lake Store.</span></span> <span data-ttu-id="7068f-121">Topologie Storm má nastavení konfigurace, které určení stupně paralelního zpracování hello:</span><span class="sxs-lookup"><span data-stu-id="7068f-121">A Storm topology has a set of configurations that determine hello parallelism:</span></span>
* <span data-ttu-id="7068f-122">Počet pracovních procesů (hello pracovníci jsou rovnoměrně rozdělené mezi hello virtuálních počítačů).</span><span class="sxs-lookup"><span data-stu-id="7068f-122">Number of worker processes (hello workers are evenly distributed across hello VMs).</span></span>
* <span data-ttu-id="7068f-123">Počet instancí vykonavatele funkcí spout.</span><span class="sxs-lookup"><span data-stu-id="7068f-123">Number of spout executor instances.</span></span>
* <span data-ttu-id="7068f-124">Počet instancí vykonavatele funkcí bolt.</span><span class="sxs-lookup"><span data-stu-id="7068f-124">Number of bolt executor instances.</span></span>
* <span data-ttu-id="7068f-125">Počet funkcí spout úlohy.</span><span class="sxs-lookup"><span data-stu-id="7068f-125">Number of spout tasks.</span></span>
* <span data-ttu-id="7068f-126">Počet úloh funkcí bolt.</span><span class="sxs-lookup"><span data-stu-id="7068f-126">Number of bolt tasks.</span></span>

<span data-ttu-id="7068f-127">Například v clusteru s 4 virtuální počítače a 4 pracovních procesů, vykonavatelů 32 spout a 32 funkcí spout úkoly a 256 vykonavatelů bolt a 512 bolt úlohy, zvažte následující hello:</span><span class="sxs-lookup"><span data-stu-id="7068f-127">For example, on a cluster with 4 VMs and 4 worker processes, 32 spout executors and 32 spout tasks, and 256 bolt executors and 512 bolt tasks, consider hello following:</span></span>

<span data-ttu-id="7068f-128">Každý nadřízeného, což je pracovního uzlu, má jednoho pracovního procesu Java virtual machine (JVM).</span><span class="sxs-lookup"><span data-stu-id="7068f-128">Each supervisor, which is a worker node, has a single worker Java virtual machine (JVM) process.</span></span> <span data-ttu-id="7068f-129">Tento proces JVM spravuje 4 spout vláken a 64 bolt vláken.</span><span class="sxs-lookup"><span data-stu-id="7068f-129">This JVM process manages 4 spout threads and 64 bolt threads.</span></span> <span data-ttu-id="7068f-130">V rámci každé vlákno se úkoly spouštějí postupně.</span><span class="sxs-lookup"><span data-stu-id="7068f-130">Within each thread, tasks are run sequentially.</span></span> <span data-ttu-id="7068f-131">Hello předcházející konfigurace každou funkcí spout vlákno je 1 úkol a každé vlákno bolt má 2 úlohy.</span><span class="sxs-lookup"><span data-stu-id="7068f-131">With hello preceding configuration, each spout thread has 1 task, and each bolt thread has 2 tasks.</span></span>

<span data-ttu-id="7068f-132">Tady jsou hello různé součásti související se situací Storm, a jejich vliv na úrovni hello paralelního zpracování, které máte:</span><span class="sxs-lookup"><span data-stu-id="7068f-132">In Storm, here are hello various components involved, and how they affect hello level of parallelism you have:</span></span>
* <span data-ttu-id="7068f-133">Hello hlavního uzlu (volané Nimbus v Storm) je použité toosubmit a spravovat úlohy.</span><span class="sxs-lookup"><span data-stu-id="7068f-133">hello head node (called Nimbus in Storm) is used toosubmit and manage jobs.</span></span> <span data-ttu-id="7068f-134">Tyto uzly nemají žádný vliv na hello stupně paralelního zpracování.</span><span class="sxs-lookup"><span data-stu-id="7068f-134">These nodes have no impact on hello degree of parallelism.</span></span>
* <span data-ttu-id="7068f-135">uzly nadřízeného Hello.</span><span class="sxs-lookup"><span data-stu-id="7068f-135">hello supervisor nodes.</span></span> <span data-ttu-id="7068f-136">V prostředí HDInsight odpovídá tooa pracovního uzlu virtuálního počítače Azure.</span><span class="sxs-lookup"><span data-stu-id="7068f-136">In HDInsight, this corresponds tooa worker node Azure VM.</span></span>
* <span data-ttu-id="7068f-137">Hello pracovní úkoly jsou Storm procesů spuštěných ve hello virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="7068f-137">hello worker tasks are Storm processes running in hello VMs.</span></span> <span data-ttu-id="7068f-138">Každý úkol pracovní odpovídá tooa JVM instance.</span><span class="sxs-lookup"><span data-stu-id="7068f-138">Each worker task corresponds tooa JVM instance.</span></span> <span data-ttu-id="7068f-139">Storm distribuuje hello počet pracovních procesů zadáte uzlů pracovního procesu toohello jako rovnoměrně.</span><span class="sxs-lookup"><span data-stu-id="7068f-139">Storm distributes hello number of worker processes you specify toohello worker nodes as evenly as possible.</span></span>
* <span data-ttu-id="7068f-140">Spout a funkce bolt vykonavatele instancí.</span><span class="sxs-lookup"><span data-stu-id="7068f-140">Spout and bolt executor instances.</span></span> <span data-ttu-id="7068f-141">Každá instance vykonavatele odpovídá tooa vlákno běžící v rámci pracovních procesů hello (JVMs).</span><span class="sxs-lookup"><span data-stu-id="7068f-141">Each executor instance corresponds tooa thread running within hello workers (JVMs).</span></span>
* <span data-ttu-id="7068f-142">Storm úlohy.</span><span class="sxs-lookup"><span data-stu-id="7068f-142">Storm tasks.</span></span> <span data-ttu-id="7068f-143">Toto jsou logické úlohy, aby každá z těchto vláken spustit.</span><span class="sxs-lookup"><span data-stu-id="7068f-143">These are logical tasks that each of these threads run.</span></span> <span data-ttu-id="7068f-144">Nezmění se hello úroveň paralelismu, takže byste měli zvážit, pokud potřebujete více úkolů na prováděcího modulu, nebo ne.</span><span class="sxs-lookup"><span data-stu-id="7068f-144">This does not change hello level of parallelism, so you should evaluate if you need multiple tasks per executor or not.</span></span>

### <a name="get-hello-best-performance-from-data-lake-store"></a><span data-ttu-id="7068f-145">Získání hello nejlepší výkon z Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="7068f-145">Get hello best performance from Data Lake Store</span></span>

<span data-ttu-id="7068f-146">Při práci se službou Data Lake Store, získáte nejlepší výkon hello, pokud hello následující:</span><span class="sxs-lookup"><span data-stu-id="7068f-146">When working with Data Lake Store, you get hello best performance if you do hello following:</span></span>
* <span data-ttu-id="7068f-147">Sloučení malou připojí do větší velikosti (v ideálním případě 4 MB).</span><span class="sxs-lookup"><span data-stu-id="7068f-147">Coalesce your small appends into larger sizes (ideally 4 MB).</span></span>
* <span data-ttu-id="7068f-148">Počet souběžných požadavků, jak můžete proveďte.</span><span class="sxs-lookup"><span data-stu-id="7068f-148">Do as many concurrent requests as you can.</span></span> <span data-ttu-id="7068f-149">Protože každý podproces bolt provádí blokování čtení, budete chtít toohave někde v rozsahu hello 8 12 vláken na jádra.</span><span class="sxs-lookup"><span data-stu-id="7068f-149">Because each bolt thread is doing blocking reads, you want toohave somewhere in hello range of 8-12 threads per core.</span></span> <span data-ttu-id="7068f-150">Díky tomu hello síťových Adaptérů a hello procesoru dobře využito.</span><span class="sxs-lookup"><span data-stu-id="7068f-150">This keeps hello NIC and hello CPU well utilized.</span></span> <span data-ttu-id="7068f-151">Větší virtuální počítač umožňuje více souběžných požadavků.</span><span class="sxs-lookup"><span data-stu-id="7068f-151">A larger VM enables more concurrent requests.</span></span>  

### <a name="example-topology"></a><span data-ttu-id="7068f-152">Příklad topologie</span><span class="sxs-lookup"><span data-stu-id="7068f-152">Example topology</span></span>

<span data-ttu-id="7068f-153">Předpokládejme, že máte cluster 8 pracovní uzel s D13v2 virtuální počítač Azure.</span><span class="sxs-lookup"><span data-stu-id="7068f-153">Let’s assume you have an 8 worker node cluster with a D13v2 Azure VM.</span></span> <span data-ttu-id="7068f-154">Má tento virtuální počítač s 8 jádry, takže mezi hello 8 uzlů pracovního procesu, máte 64 celkový počet jader.</span><span class="sxs-lookup"><span data-stu-id="7068f-154">This VM has 8 cores, so among hello 8 worker nodes, you have 64 total cores.</span></span>

<span data-ttu-id="7068f-155">Řekněme, že provedeme 8 vláken bolt na jádra.</span><span class="sxs-lookup"><span data-stu-id="7068f-155">Let’s say we do 8 bolt threads per core.</span></span> <span data-ttu-id="7068f-156">Zadaný 64 jader, která znamená, že chceme 512 celkový bolt vykonavatele instancí (vlákna).</span><span class="sxs-lookup"><span data-stu-id="7068f-156">Given 64 cores, that means we want 512 total bolt executor instances (that is, threads).</span></span> <span data-ttu-id="7068f-157">V takovém případě Řekněme, že jsme začínat jeden JVM na virtuální počítač a používají převážně hello souběžnosti vláken v rámci hello JVM tooachieve souběžnosti.</span><span class="sxs-lookup"><span data-stu-id="7068f-157">In this case, let’s say we start with one JVM per VM, and mainly use hello thread concurrency within hello JVM tooachieve concurrency.</span></span> <span data-ttu-id="7068f-158">To znamená, že potřebujeme 8 úlohy pracovního procesu (jeden na každý virtuální počítač Azure) a 512 vykonavatelů funkcí bolt.</span><span class="sxs-lookup"><span data-stu-id="7068f-158">That means we need 8 worker tasks (one per Azure VM), and 512 bolt executors.</span></span> <span data-ttu-id="7068f-159">V této konfiguraci Storm pokusí toodistribute hello pracovníci rovnoměrně mezi uzly pracovního procesu (také označované jako nadřízeného uzlů), která poskytuje každý pracovní uzel 1 JVM.</span><span class="sxs-lookup"><span data-stu-id="7068f-159">Given this configuration, Storm tries toodistribute hello workers evenly across worker nodes (also known as supervisor nodes), giving each worker node 1 JVM.</span></span> <span data-ttu-id="7068f-160">Teď v rámci hello vedoucí pokusí Storm toodistribute hello vykonavatelů rovnoměrně mezi vedoucí, udělíte každý nadřízeného (JVM) 8 vláken každý.</span><span class="sxs-lookup"><span data-stu-id="7068f-160">Now within hello supervisors, Storm tries toodistribute hello executors evenly between supervisors, giving each supervisor (that is, JVM) 8 threads each.</span></span>

## <a name="tune-additional-parameters"></a><span data-ttu-id="7068f-161">Vyladění dalších parametrů</span><span class="sxs-lookup"><span data-stu-id="7068f-161">Tune additional parameters</span></span>
<span data-ttu-id="7068f-162">Až budete mít hello základní topologie, můžete zvážit, jestli chcete tootweak některý z parametrů hello:</span><span class="sxs-lookup"><span data-stu-id="7068f-162">After you have hello basic topology, you can consider whether you want tootweak any of hello parameters:</span></span>
* <span data-ttu-id="7068f-163">**Počet JVMs za pracovního uzlu.**</span><span class="sxs-lookup"><span data-stu-id="7068f-163">**Number of JVMs per worker node.**</span></span> <span data-ttu-id="7068f-164">Pokud máte velké datové struktury (například vyhledávací tabulky) vyžaduje, aby je hostitel v paměti, každý JVM samostatná kopie.</span><span class="sxs-lookup"><span data-stu-id="7068f-164">If you have a large data structure (for example, a lookup table) that you host in memory, each JVM requires a separate copy.</span></span> <span data-ttu-id="7068f-165">Alternativně můžete použít hello datová struktura napříč velký počet vláken, pokud máte méně JVMs.</span><span class="sxs-lookup"><span data-stu-id="7068f-165">Alternatively, you can use hello data structure across many threads if you have fewer JVMs.</span></span> <span data-ttu-id="7068f-166">Pro vstupně-výstupních operací hello bolt hello počet JVMs neprovede tolik rozdíl jako hello počet vláken přidat mezi tyto JVMs.</span><span class="sxs-lookup"><span data-stu-id="7068f-166">For hello bolt’s I/O, hello number of JVMs does not make as much of a difference as hello number of threads added across those JVMs.</span></span> <span data-ttu-id="7068f-167">Pro jednoduchost, je vhodné toohave, jeden JVM za pracovního procesu.</span><span class="sxs-lookup"><span data-stu-id="7068f-167">For simplicity, it's a good idea toohave one JVM per worker.</span></span> <span data-ttu-id="7068f-168">V závislosti na akci vaše bolt, nebo jaké aplikace zpracování můžete vyžadovat, i když může být nutné toochange toto číslo.</span><span class="sxs-lookup"><span data-stu-id="7068f-168">Depending on what your bolt is doing or what application processing you require, though, you may need toochange this number.</span></span>
* <span data-ttu-id="7068f-169">**Počet vykonavatelů funkcí spout.**</span><span class="sxs-lookup"><span data-stu-id="7068f-169">**Number of spout executors.**</span></span> <span data-ttu-id="7068f-170">Protože hello předchozí příklad používá funkce bolts pro zápis tooData Lake Store, hello počet funkcích spouts není přímo relevantní toohello bolt výkonu.</span><span class="sxs-lookup"><span data-stu-id="7068f-170">Because hello preceding example uses bolts for writing tooData Lake Store, hello number of spouts is not directly relevant toohello bolt performance.</span></span> <span data-ttu-id="7068f-171">V závislosti na množství hello zpracování nebo vstupně-výstupních operací děje v hello spout, je vhodné se však tootune hello spouts pro nejlepší výkon.</span><span class="sxs-lookup"><span data-stu-id="7068f-171">However, depending on hello amount of processing or I/O happening in hello spout, it's a good idea tootune hello spouts for best performance.</span></span> <span data-ttu-id="7068f-172">Ujistěte se, že máte dostatek funkcích spouts toobe možné tookeep hello funkce bolts zaneprázdněný.</span><span class="sxs-lookup"><span data-stu-id="7068f-172">Ensure that you have enough spouts toobe able tookeep hello bolts busy.</span></span> <span data-ttu-id="7068f-173">míry výstup Hello funkcích spouts hello by měl odpovídat hello propustnost funkce bolts hello.</span><span class="sxs-lookup"><span data-stu-id="7068f-173">hello output rates of hello spouts should match hello throughput of hello bolts.</span></span> <span data-ttu-id="7068f-174">skutečné konfigurace Hello závisí na funkcích spout hello.</span><span class="sxs-lookup"><span data-stu-id="7068f-174">hello actual configuration depends on hello spout.</span></span>
* <span data-ttu-id="7068f-175">**Počet úloh.**</span><span class="sxs-lookup"><span data-stu-id="7068f-175">**Number of tasks.**</span></span> <span data-ttu-id="7068f-176">Každý bolt spouští jako jedno vlákno.</span><span class="sxs-lookup"><span data-stu-id="7068f-176">Each bolt runs as a single thread.</span></span> <span data-ttu-id="7068f-177">Další úlohy za bolt neposkytují žádné další souběžnosti.</span><span class="sxs-lookup"><span data-stu-id="7068f-177">Additional tasks per bolt don't provide any additional concurrency.</span></span> <span data-ttu-id="7068f-178">Dobrý den, které jsou benefitu je pouze pokud má váš proces to v úvahu řazené kolekce členů hello velká část doby provádění funkcí bolt.</span><span class="sxs-lookup"><span data-stu-id="7068f-178">hello only time they are of benefit is if your process of acknowledging hello tuple takes a large proportion of your bolt execution time.</span></span> <span data-ttu-id="7068f-179">Je vhodné toogroup, které mnoho řazených kolekcí členů do větší připojit před odesláním potvrzení z hello bolt.</span><span class="sxs-lookup"><span data-stu-id="7068f-179">It's a good idea toogroup many tuples into a larger append before you send an acknowledgement from hello bolt.</span></span> <span data-ttu-id="7068f-180">Ano ve většině případů poskytují více úkolů žádné další výhody.</span><span class="sxs-lookup"><span data-stu-id="7068f-180">So, in most cases, multiple tasks provide no additional benefit.</span></span>
* <span data-ttu-id="7068f-181">**Místní nebo náhodně seskupení.**</span><span class="sxs-lookup"><span data-stu-id="7068f-181">**Local or shuffle grouping.**</span></span> <span data-ttu-id="7068f-182">Pokud je toto nastavení povoleno, řazené kolekce členů jsou odesílány toobolts v rámci hello stejný pracovní proces.</span><span class="sxs-lookup"><span data-stu-id="7068f-182">When this setting is enabled, tuples are sent toobolts within hello same worker process.</span></span> <span data-ttu-id="7068f-183">Tím se snižuje volání mezi procesy komunikace a sítě.</span><span class="sxs-lookup"><span data-stu-id="7068f-183">This reduces inter-process communication and network calls.</span></span> <span data-ttu-id="7068f-184">Toto nastavení se doporučuje pro většinu topologií.</span><span class="sxs-lookup"><span data-stu-id="7068f-184">This is recommended for most topologies.</span></span>

<span data-ttu-id="7068f-185">Tento základní scénář je to dobrý výchozí bod.</span><span class="sxs-lookup"><span data-stu-id="7068f-185">This basic scenario is a good starting point.</span></span> <span data-ttu-id="7068f-186">Testování s vlastními hello tootweak data předcházející parametry tooachieve optimální výkon.</span><span class="sxs-lookup"><span data-stu-id="7068f-186">Test with your own data tootweak hello preceding parameters tooachieve optimal performance.</span></span>

## <a name="tune-hello-spout"></a><span data-ttu-id="7068f-187">Vyladění hello spout</span><span class="sxs-lookup"><span data-stu-id="7068f-187">Tune hello spout</span></span>

<span data-ttu-id="7068f-188">Můžete upravit následující nastavení tootune hello spout hello.</span><span class="sxs-lookup"><span data-stu-id="7068f-188">You can modify hello following settings tootune hello spout.</span></span>

- <span data-ttu-id="7068f-189">**Časový limit řazené kolekce členů: topology.message.timeout.secs**.</span><span class="sxs-lookup"><span data-stu-id="7068f-189">**Tuple timeout: topology.message.timeout.secs**.</span></span> <span data-ttu-id="7068f-190">Toto nastavení určuje hello množství času zprávu trvá toocomplete a přijímat potvrzení, než je považována za se nezdařilo.</span><span class="sxs-lookup"><span data-stu-id="7068f-190">This setting determines hello amount of time a message takes toocomplete, and receive acknowledgement, before it is considered failed.</span></span>

- <span data-ttu-id="7068f-191">**Maximální paměť na pracovní proces: worker.childopts**.</span><span class="sxs-lookup"><span data-stu-id="7068f-191">**Max memory per worker process: worker.childopts**.</span></span> <span data-ttu-id="7068f-192">Toto nastavení umožňuje určit další parametry příkazového řádku toohello Java pracovních procesů.</span><span class="sxs-lookup"><span data-stu-id="7068f-192">This setting lets you specify additional command-line parameters toohello Java workers.</span></span> <span data-ttu-id="7068f-193">Hello nejčastěji používaná nastavení tady je XmX, určující haldy hello maximální paměť přidělená tooa JVM společnosti.</span><span class="sxs-lookup"><span data-stu-id="7068f-193">hello most commonly used setting here is XmX, which determines hello maximum memory allocated tooa JVM’s heap.</span></span>

- <span data-ttu-id="7068f-194">**Maximální počet funkcí spout čekající na vyřízení: topology.max.spout.pending**.</span><span class="sxs-lookup"><span data-stu-id="7068f-194">**Max spout pending: topology.max.spout.pending**.</span></span> <span data-ttu-id="7068f-195">Toto nastavení určuje hello počet řazených kolekcí členů, která může být v cestě (ještě nebyla potvrzena na všechny uzly v topologii hello) na vlákno spout kdykoli.</span><span class="sxs-lookup"><span data-stu-id="7068f-195">This setting determines hello number of tuples that can in be flight (not yet acknowledged at all nodes in hello topology) per spout thread at any time.</span></span>

 <span data-ttu-id="7068f-196">Toodo dobrý výpočtu je tooestimate hello velikost jednotlivých vaší řazené kolekce členů.</span><span class="sxs-lookup"><span data-stu-id="7068f-196">A good calculation toodo is tooestimate hello size of each of your tuples.</span></span> <span data-ttu-id="7068f-197">Potom rozmyslete si, kolik paměti jeden spout vlákno má.</span><span class="sxs-lookup"><span data-stu-id="7068f-197">Then figure out how much memory one spout thread has.</span></span> <span data-ttu-id="7068f-198">Hello celkové paměti přidělené tooa vlákno, dělený tato hodnota by měla získáte hello horní mez pro maximální počet funkcí spout hello čekající na vyřízení parametr.</span><span class="sxs-lookup"><span data-stu-id="7068f-198">hello total memory allocated tooa thread, divided by this value, should give you hello upper bound for hello max spout pending parameter.</span></span>

## <a name="tune-hello-bolt"></a><span data-ttu-id="7068f-199">Vyladění hello bolt</span><span class="sxs-lookup"><span data-stu-id="7068f-199">Tune hello bolt</span></span>
<span data-ttu-id="7068f-200">Když píšete tooData Lake Store, nastavit zásady synchronizace velikost (vyrovnávací paměti na straně klienta hello) too4 MB.</span><span class="sxs-lookup"><span data-stu-id="7068f-200">When you're writing tooData Lake Store, set a size sync policy (buffer on hello client side) too4 MB.</span></span> <span data-ttu-id="7068f-201">Abyste vyprázdnili nebo hsync() pak se provádí jenom v případě, že velikost vyrovnávací paměti hello je hello v této hodnotě.</span><span class="sxs-lookup"><span data-stu-id="7068f-201">A flushing or hsync() is then performed only when hello buffer size is hello at this value.</span></span> <span data-ttu-id="7068f-202">Hello Data Lake Store je ovladač na pracovní hello virtuálního počítače automaticky nemá tato ukládání do vyrovnávací paměti, pokud provádíte explicitně hsync().</span><span class="sxs-lookup"><span data-stu-id="7068f-202">hello Data Lake Store driver on hello worker VM automatically does this buffering, unless you explicitly perform an hsync().</span></span>

<span data-ttu-id="7068f-203">Hello výchozí Data Lake Store Storm bolt obsahuje parametr zásady synchronizace velikost (fileBufferSize), může být použité tootune tento parametr.</span><span class="sxs-lookup"><span data-stu-id="7068f-203">hello default Data Lake Store Storm bolt has a size sync policy parameter (fileBufferSize) that can be used tootune this parameter.</span></span>

<span data-ttu-id="7068f-204">V I náročnými topologie, je vhodné toohave každé vlákno bolt zápisu vlastní soubor tooits a tooset zásadu otočení souboru (fileRotationSize).</span><span class="sxs-lookup"><span data-stu-id="7068f-204">In I/O-intensive topologies, it's a good idea toohave each bolt thread write tooits own file, and tooset a file rotation policy (fileRotationSize).</span></span> <span data-ttu-id="7068f-205">Když hello soubor dosáhne určité velikosti, automaticky vyprázdní hello datového proudu a je zapsaný nový soubor.</span><span class="sxs-lookup"><span data-stu-id="7068f-205">When hello file reaches a certain size, hello stream is automatically flushed and a new file is written to.</span></span> <span data-ttu-id="7068f-206">Doporučená velikost souboru pro otočení Hello je 1 GB.</span><span class="sxs-lookup"><span data-stu-id="7068f-206">hello recommended file size for rotation is 1 GB.</span></span>

### <a name="handle-tuple-data"></a><span data-ttu-id="7068f-207">Zpracování dat řazené kolekce členů</span><span class="sxs-lookup"><span data-stu-id="7068f-207">Handle tuple data</span></span>

<span data-ttu-id="7068f-208">V Storm obsahuje spout na tooa řazené kolekce členů, dokud je explicitně potvrzen hello bolt.</span><span class="sxs-lookup"><span data-stu-id="7068f-208">In Storm, a spout holds on tooa tuple until it is explicitly acknowledged by hello bolt.</span></span> <span data-ttu-id="7068f-209">Pokud řazené kolekce členů byl načten pomocí hello bolt, ale nebyla ještě potvrzeny, nemusí mít hello spout jako trvalý, do Data Lake Store back-end.</span><span class="sxs-lookup"><span data-stu-id="7068f-209">If a tuple has been read by hello bolt but has not been acknowledged yet, hello spout might not have persisted into Data Lake Store back end.</span></span> <span data-ttu-id="7068f-210">Po řazené kolekce členů potvrzen, hello spout můžete záruku stálosti podle hello bolt a můžete pak odstraňte hello zdrojová data z jakéhokoli zdroje je čtení z.</span><span class="sxs-lookup"><span data-stu-id="7068f-210">After a tuple is acknowledged, hello spout can be guaranteed persistence by hello bolt, and can then delete hello source data from whatever source it is reading from.</span></span>  

<span data-ttu-id="7068f-211">Chcete-li dosáhnout optimálního výkonu v Data Lake Store, máte hello bolt vyrovnávací paměti 4 MB dat řazené kolekce členů.</span><span class="sxs-lookup"><span data-stu-id="7068f-211">For best performance on Data Lake Store, have hello bolt buffer 4 MB of tuple data.</span></span> <span data-ttu-id="7068f-212">Zapište toohello Data Lake Store zpět ukončit jeden zápis 4 MB.</span><span class="sxs-lookup"><span data-stu-id="7068f-212">Then write toohello Data Lake Store back end as one 4-MB write.</span></span> <span data-ttu-id="7068f-213">Po hello data byla úspěšně napsané toohello úložiště (ve volání hflush()) hello bolt můžete na vědomí hello data zpět toohello spout.</span><span class="sxs-lookup"><span data-stu-id="7068f-213">After hello data has been successfully written toohello store (by calling hflush()), hello bolt can acknowledge hello data back toohello spout.</span></span> <span data-ttu-id="7068f-214">Toto je příklad jaké hello funkce bolt zadaný sem nepodporuje.</span><span class="sxs-lookup"><span data-stu-id="7068f-214">This is what hello example bolt supplied here does.</span></span> <span data-ttu-id="7068f-215">Je také přijatelné toohold větší počet řazených kolekcí členů, než Přišla žádost hflush() hello a hello potvrzené řazené kolekce členů.</span><span class="sxs-lookup"><span data-stu-id="7068f-215">It is also acceptable toohold a larger number of tuples before hello hflush() call is made and hello tuples acknowledged.</span></span> <span data-ttu-id="7068f-216">Nicméně tím se zvyšuje hello počet řazených kolekcí členů v cestě hello spout musí toohold, a proto zvyšuje hello na JVM požadované množství paměti.</span><span class="sxs-lookup"><span data-stu-id="7068f-216">However, this increases hello number of tuples in flight that hello spout needs toohold, and therefore increases hello amount of memory required per JVM.</span></span>

> [!NOTE]
<span data-ttu-id="7068f-217">Aplikace může mít řazených kolekcí členů tooacknowledge požadavek častěji (na velikosti dat menší než 4 MB) z jiných důvodů bez výkonu.</span><span class="sxs-lookup"><span data-stu-id="7068f-217">Applications might have a requirement tooacknowledge tuples more frequently (at data sizes less than 4 MB) for other non-performance reasons.</span></span> <span data-ttu-id="7068f-218">Nicméně, který může ovlivnit hello vstupně-výstupních operací propustnost toohello úložiště back-end.</span><span class="sxs-lookup"><span data-stu-id="7068f-218">However, that might affect hello I/O throughput toohello storage back end.</span></span> <span data-ttu-id="7068f-219">Pečlivě zvažte tato kompromis proti hello bolt vstupně-výstupní výkon.</span><span class="sxs-lookup"><span data-stu-id="7068f-219">Carefully weigh this tradeoff against hello bolt’s I/O performance.</span></span>

<span data-ttu-id="7068f-220">Pokud počet příchozích hello řazené kolekce členů není vysoké, takže vyrovnávací paměti 4 MB hello trvá dlouho toofill, vezměte v úvahu zmírnění tím, že:</span><span class="sxs-lookup"><span data-stu-id="7068f-220">If hello incoming rate of tuples is not high, so hello 4-MB buffer takes a long time toofill, consider mitigating this by:</span></span>
* <span data-ttu-id="7068f-221">Snižuje počet hello funkce bolts, takže jsou méně toofill vyrovnávací paměti.</span><span class="sxs-lookup"><span data-stu-id="7068f-221">Reducing hello number of bolts, so there are fewer buffers toofill.</span></span>
* <span data-ttu-id="7068f-222">S založené na čase nebo na základě počtu zásad, kde je hflush() spustí každých x vyprázdnění nebo každých milisekundách y a hello řazených kolekcí členů nashromáždila, pokud jsou potvrzené zpět.</span><span class="sxs-lookup"><span data-stu-id="7068f-222">Having a time-based or count-based policy, where an hflush() is triggered every x flushes or every y milliseconds, and hello tuples accumulated so far are acknowledged back.</span></span>

<span data-ttu-id="7068f-223">Všimněte si, že hello propustnost v tomto případě je nižší, ale s pomalým rychlost událostí, maximální propustnost není hello největších cíl přesto.</span><span class="sxs-lookup"><span data-stu-id="7068f-223">Note that hello throughput in this case is lower, but with a slow rate of events, maximum throughput is not hello biggest objective anyway.</span></span> <span data-ttu-id="7068f-224">Tyto způsoby zmírnění vám pomůže zmenšit hello celkový čas, která je potřebná pro řazené kolekce členů tooflow prostřednictvím toohello úložiště.</span><span class="sxs-lookup"><span data-stu-id="7068f-224">These mitigations help you reduce hello total time that it takes for a tuple tooflow through toohello store.</span></span> <span data-ttu-id="7068f-225">To může být důležité, zda chcete, aby kanál v reálném čase i pomocí rychlost nízkou událostí.</span><span class="sxs-lookup"><span data-stu-id="7068f-225">This might matter if you want a real-time pipeline even with a low event rate.</span></span> <span data-ttu-id="7068f-226">Všimněte si také, zda vaše míra příchozích řazené kolekce členů je nízká, je třeba upravit parametr topology.message.timeout_secs hello, takže hello řazených kolekcí členů není vypršení časového limitu při jejich získávání uložená do vyrovnávací paměti nebo zpracovat.</span><span class="sxs-lookup"><span data-stu-id="7068f-226">Also note that if your incoming tuple rate is low, you should adjust hello topology.message.timeout_secs parameter, so hello tuples don’t time out while they are getting buffered or processed.</span></span>

## <a name="monitor-your-topology-in-storm"></a><span data-ttu-id="7068f-227">Monitorování topologie v Storm</span><span class="sxs-lookup"><span data-stu-id="7068f-227">Monitor your topology in Storm</span></span>  
<span data-ttu-id="7068f-228">Když topologie běží, je možné jej monitorovat v uživatelském rozhraní Storm hello.</span><span class="sxs-lookup"><span data-stu-id="7068f-228">While your topology is running, you can monitor it in hello Storm user interface.</span></span> <span data-ttu-id="7068f-229">Zde jsou hlavní parametry toolook hello na:</span><span class="sxs-lookup"><span data-stu-id="7068f-229">Here are hello main parameters toolook at:</span></span>

* <span data-ttu-id="7068f-230">**Celkový proces spuštění latence.**</span><span class="sxs-lookup"><span data-stu-id="7068f-230">**Total process execution latency.**</span></span> <span data-ttu-id="7068f-231">Toto je průměrný čas hello, jeden záznam trvá toobe vysílaných hello spout, zpracovává hello bolt a potvrzené.</span><span class="sxs-lookup"><span data-stu-id="7068f-231">This is hello average time one tuple takes toobe emitted by hello spout, processed by hello bolt, and acknowledged.</span></span>

* <span data-ttu-id="7068f-232">**Celkový počet bolt proces latence.**</span><span class="sxs-lookup"><span data-stu-id="7068f-232">**Total bolt process latency.**</span></span> <span data-ttu-id="7068f-233">Toto je průměrný čas hello spotřebovaného hello řazené kolekce členů v hello bolt, dokud neobdrží potvrzení.</span><span class="sxs-lookup"><span data-stu-id="7068f-233">This is hello average time spent by hello tuple at hello bolt until it receives an acknowledgement.</span></span>

* <span data-ttu-id="7068f-234">**Celkový počet bolt spustit latence.**</span><span class="sxs-lookup"><span data-stu-id="7068f-234">**Total bolt execute latency.**</span></span> <span data-ttu-id="7068f-235">Toto je průměrná hello času stráveného hello bolt v hello spuštění metody.</span><span class="sxs-lookup"><span data-stu-id="7068f-235">This is hello average time spent by hello bolt in hello execute method.</span></span>

* <span data-ttu-id="7068f-236">**Počet chyb.**</span><span class="sxs-lookup"><span data-stu-id="7068f-236">**Number of failures.**</span></span> <span data-ttu-id="7068f-237">Vztahuje se toohello počet řazených kolekcí členů, která se nezdařila toobe plně zpracovány před vypršením časového limitu.</span><span class="sxs-lookup"><span data-stu-id="7068f-237">This refers toohello number of tuples that failed toobe fully processed before they timed out.</span></span>

* <span data-ttu-id="7068f-238">**Kapacity.**</span><span class="sxs-lookup"><span data-stu-id="7068f-238">**Capacity.**</span></span> <span data-ttu-id="7068f-239">Toto je míra je zatížení systému.</span><span class="sxs-lookup"><span data-stu-id="7068f-239">This is a measure of how busy your system is.</span></span> <span data-ttu-id="7068f-240">Pokud tento počet je 1, fungují tak rychle, jak mohou vaše funkce bolts.</span><span class="sxs-lookup"><span data-stu-id="7068f-240">If this number is 1, your bolts are working as fast as they can.</span></span> <span data-ttu-id="7068f-241">Pokud je menší než 1, zvýšit paralelismus hello.</span><span class="sxs-lookup"><span data-stu-id="7068f-241">If it is less than 1, increase hello parallelism.</span></span> <span data-ttu-id="7068f-242">Pokud je větší než 1, snížit paralelismus hello.</span><span class="sxs-lookup"><span data-stu-id="7068f-242">If it is greater than 1, reduce hello parallelism.</span></span>

## <a name="troubleshoot-common-problems"></a><span data-ttu-id="7068f-243">Řešení běžných potíží</span><span class="sxs-lookup"><span data-stu-id="7068f-243">Troubleshoot common problems</span></span>
<span data-ttu-id="7068f-244">Tady jsou několik běžných scénářů řešení potíží.</span><span class="sxs-lookup"><span data-stu-id="7068f-244">Here are a few common troubleshooting scenarios.</span></span>
* <span data-ttu-id="7068f-245">**Mnoho řazených kolekcí členů jsou vypršení časového limitu.** Podívejte se na každém uzlu v hello topologie toodetermine kde hello problémovým místem je.</span><span class="sxs-lookup"><span data-stu-id="7068f-245">**Many tuples are timing out.** Look at each node in hello topology toodetermine where hello bottleneck is.</span></span> <span data-ttu-id="7068f-246">Hello nejběžnější důvodem je, že funkce bolts hello nejsou možné tookeep až s funkcích spouts hello.</span><span class="sxs-lookup"><span data-stu-id="7068f-246">hello most common reason for this is that hello bolts are not able tookeep up with hello spouts.</span></span> <span data-ttu-id="7068f-247">To vede tootuples zdokonaleným hello vnitřní vyrovnávací paměti při zpracování toobe čekání.</span><span class="sxs-lookup"><span data-stu-id="7068f-247">This leads tootuples clogging hello internal buffers while waiting toobe processed.</span></span> <span data-ttu-id="7068f-248">Zvažte možnost zvýšení hodnoty časového limitu hello nebo snížení hello maximální spout čekající na vyřízení.</span><span class="sxs-lookup"><span data-stu-id="7068f-248">Consider increasing hello timeout value or decreasing hello max spout pending.</span></span>

* <span data-ttu-id="7068f-249">**Je latence vysoké celkový proces spouštění, ale proces latence nízkou bolt.**</span><span class="sxs-lookup"><span data-stu-id="7068f-249">**There is a high total process execution latency, but a low bolt process latency.**</span></span> <span data-ttu-id="7068f-250">V takovém případě je možné, že hello řazené kolekce členů nejsou potvrzování dostatečně fast.</span><span class="sxs-lookup"><span data-stu-id="7068f-250">In this case, it is possible that hello tuples are not being acknowledged fast enough.</span></span> <span data-ttu-id="7068f-251">Zkontrolujte, zda jsou k dispozici dostatečný počet acknowledgers.</span><span class="sxs-lookup"><span data-stu-id="7068f-251">Check that there are a sufficient number of acknowledgers.</span></span> <span data-ttu-id="7068f-252">Další možností je, že při před hello bolts zahájení zpracování je čekají ve frontě hello příliš dlouho.</span><span class="sxs-lookup"><span data-stu-id="7068f-252">Another possibility is that they are waiting in hello queue for too long before hello bolts start processing them.</span></span> <span data-ttu-id="7068f-253">Snížit maximální spout hello čekající na vyřízení.</span><span class="sxs-lookup"><span data-stu-id="7068f-253">Decrease hello max spout pending.</span></span>

* <span data-ttu-id="7068f-254">**Je vysoká bolt provést latence.**</span><span class="sxs-lookup"><span data-stu-id="7068f-254">**There is a high bolt execute latency.**</span></span> <span data-ttu-id="7068f-255">To znamená, že metoda execute() hello vaší bolt trvá příliš dlouho.</span><span class="sxs-lookup"><span data-stu-id="7068f-255">This means that hello execute() method of your bolt is taking too long.</span></span> <span data-ttu-id="7068f-256">Optimalizace kódu hello nebo podívejte se na velikosti zápisu a vyprázdnit chování.</span><span class="sxs-lookup"><span data-stu-id="7068f-256">Optimize hello code, or look at write sizes and flush behavior.</span></span>

### <a name="data-lake-store-throttling"></a><span data-ttu-id="7068f-257">Omezení data Lake Store</span><span class="sxs-lookup"><span data-stu-id="7068f-257">Data Lake Store throttling</span></span>
<span data-ttu-id="7068f-258">Jestli jste nedosáhli hello omezení šířky pásma poskytuje Data Lake Store, může se zobrazit selhání úkolů.</span><span class="sxs-lookup"><span data-stu-id="7068f-258">If you hit hello limits of bandwidth provided by Data Lake Store, you might see task failures.</span></span> <span data-ttu-id="7068f-259">Omezení chyby v protokolech úloh.</span><span class="sxs-lookup"><span data-stu-id="7068f-259">Check task logs for throttling errors.</span></span> <span data-ttu-id="7068f-260">Paralelismus hello může snížit zvýšením velikosti kontejneru.</span><span class="sxs-lookup"><span data-stu-id="7068f-260">You can decrease hello parallelism by increasing container size.</span></span>    

<span data-ttu-id="7068f-261">Pokud jste jsou získávání omezené, toocheck povolení protokolování na straně klienta hello ladění hello:</span><span class="sxs-lookup"><span data-stu-id="7068f-261">toocheck if you are getting throttled, enable hello debug logging on hello client side:</span></span>

1. <span data-ttu-id="7068f-262">V **Ambari** > **Storm** > **konfigurace** > **Advanced storm-worker-log4j**, změnit  **&lt;kořenový úroveň = "informace"&gt;**  příliš**&lt;kořenový úroveň = "ladění"&gt;**.</span><span class="sxs-lookup"><span data-stu-id="7068f-262">In **Ambari** > **Storm** > **Config** > **Advanced storm-worker-log4j**, change **&lt;root level="info"&gt;** too**&lt;root level=”debug”&gt;**.</span></span> <span data-ttu-id="7068f-263">Restartujte všechny hello uzly nebo službu pro hello konfigurace tootake vliv.</span><span class="sxs-lookup"><span data-stu-id="7068f-263">Restart all hello nodes/service for hello configuration tootake effect.</span></span>
2. <span data-ttu-id="7068f-264">Topologie Storm hello monitorování protokolů na uzly pracovního procesu (v části /var/log/storm/worker-artifacts /&lt;TopologyName&gt;/&lt;port&gt;/worker.log) pro Data Lake Store omezení výjimky.</span><span class="sxs-lookup"><span data-stu-id="7068f-264">Monitor hello Storm topology logs on worker nodes (under /var/log/storm/worker-artifacts/&lt;TopologyName&gt;/&lt;port&gt;/worker.log) for Data Lake Store throttling exceptions.</span></span>

## <a name="next-steps"></a><span data-ttu-id="7068f-265">Další kroky</span><span class="sxs-lookup"><span data-stu-id="7068f-265">Next steps</span></span>
<span data-ttu-id="7068f-266">Optimalizace další výkonu pro Storm může být odkazováno v [tomto blogu](https://blogs.msdn.microsoft.com/shanyu/2015/05/14/performance-tuning-for-hdinsight-storm-and-microsoft-azure-eventhubs/).</span><span class="sxs-lookup"><span data-stu-id="7068f-266">Additional performance tuning for Storm can be referenced in [this blog](https://blogs.msdn.microsoft.com/shanyu/2015/05/14/performance-tuning-for-hdinsight-storm-and-microsoft-azure-eventhubs/).</span></span>

<span data-ttu-id="7068f-267">Toorun Další příklady najdete v části [následujícímu na Githubu](https://github.com/hdinsight/storm-performance-automation).</span><span class="sxs-lookup"><span data-stu-id="7068f-267">For an additional example toorun, see [this one on GitHub](https://github.com/hdinsight/storm-performance-automation).</span></span>
