---
title: "aaaBest postupy pro škálování | Microsoft Docs"
description: "Vzory škálování v Azure Web Apps, sady škálování virtuálního počítače a cloudové služby"
author: anirudhcavale
manager: orenr
editor: 
services: monitoring-and-diagnostics
documentationcenter: monitoring-and-diagnostics
ms.assetid: 9fa2b94b-dfa5-4106-96ff-74fd1fba4657
ms.service: monitoring-and-diagnostics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/07/2017
ms.author: ancav
ms.openlocfilehash: eb731c15e440af93a2675210583878814d0d8818
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="best-practices-for-autoscale"></a><span data-ttu-id="f0402-103">Osvědčené postupy pro automatické škálování</span><span class="sxs-lookup"><span data-stu-id="f0402-103">Best practices for Autoscale</span></span>
<span data-ttu-id="f0402-104">V tomto článku se dozvíte, jaké osvědčené postupy tooautoscale v Azure.</span><span class="sxs-lookup"><span data-stu-id="f0402-104">This article teaches best practices tooautoscale in Azure.</span></span> <span data-ttu-id="f0402-105">Škálování Azure monitorování platí pouze příliš[sady škálování virtuálního počítače](https://azure.microsoft.com/services/virtual-machine-scale-sets/), [cloudové služby](https://azure.microsoft.com/services/cloud-services/), a [služby App Service – webové aplikace](https://azure.microsoft.com/services/app-service/web/).</span><span class="sxs-lookup"><span data-stu-id="f0402-105">Azure Monitor autoscale applies only too[Virtual Machine Scale Sets](https://azure.microsoft.com/services/virtual-machine-scale-sets/), [Cloud Services](https://azure.microsoft.com/services/cloud-services/), and [App Service - Web Apps](https://azure.microsoft.com/services/app-service/web/).</span></span> <span data-ttu-id="f0402-106">Jinými službami Azure použít různé metody škálování.</span><span class="sxs-lookup"><span data-stu-id="f0402-106">Other Azure services use different scaling methods.</span></span>

## <a name="autoscale-concepts"></a><span data-ttu-id="f0402-107">Koncepty škálování</span><span class="sxs-lookup"><span data-stu-id="f0402-107">Autoscale concepts</span></span>
* <span data-ttu-id="f0402-108">Prostředek může mít pouze *jeden* nastavení automatického škálování</span><span class="sxs-lookup"><span data-stu-id="f0402-108">A resource can have only *one* autoscale setting</span></span>
* <span data-ttu-id="f0402-109">Nastavení automatického škálování může mít jeden nebo více profilů a každý profil může mít jeden nebo více pravidel škálování.</span><span class="sxs-lookup"><span data-stu-id="f0402-109">An autoscale setting can have one or more profiles and each profile can have one or more autoscale rules.</span></span>
* <span data-ttu-id="f0402-110">Nastavení automatického škálování škáluje instance vodorovně, což je *out* zvýšením hello instancí a *v* snížením hello počet instancí.</span><span class="sxs-lookup"><span data-stu-id="f0402-110">An autoscale setting scales instances horizontally, which is *out* by increasing hello instances and *in* by decreasing hello number of instances.</span></span>
  <span data-ttu-id="f0402-111">Nastavení automatického škálování má maximální, minimální a výchozí hodnota instancí.</span><span class="sxs-lookup"><span data-stu-id="f0402-111">An autoscale setting has a maximum, minimum, and default value of instances.</span></span>
* <span data-ttu-id="f0402-112">Úloha automatického škálování vždy přečte hello spojené metriky tooscale kontrolou, pokud překročila nakonfigurovanou prahovou hodnotu hello Škálováním na více systémů nebo škálování.</span><span class="sxs-lookup"><span data-stu-id="f0402-112">An autoscale job always reads hello associated metric tooscale by, checking if it has crossed hello configured threshold for scale-out or scale-in.</span></span> <span data-ttu-id="f0402-113">Můžete zobrazit seznam metrik této škálování můžete škálovat podle na [běžné metriky automatického škálování Azure monitorování](insights-autoscale-common-metrics.md).</span><span class="sxs-lookup"><span data-stu-id="f0402-113">You can view a list of metrics that autoscale can scale by at [Azure Monitor autoscaling common metrics](insights-autoscale-common-metrics.md).</span></span>
* <span data-ttu-id="f0402-114">Všechny prahové hodnoty jsou vypočítávány na úrovni instance.</span><span class="sxs-lookup"><span data-stu-id="f0402-114">All thresholds are calculated at an instance level.</span></span> <span data-ttu-id="f0402-115">Například "škálování odhlašování 1 instancí při průměrná procesoru > 80 %, pokud je počet instancí 2", znamená Škálováním na více systémů, když je větší než 80 % CPU průměrné hello napříč všemi instancemi.</span><span class="sxs-lookup"><span data-stu-id="f0402-115">For example, "scale out by 1 instance when average CPU > 80% when instance count is 2", means scale-out when hello average CPU across all instances is greater than 80%.</span></span>
* <span data-ttu-id="f0402-116">Vždycky dostat oznámení selhání e-mailem.</span><span class="sxs-lookup"><span data-stu-id="f0402-116">You always receive failure notifications via email.</span></span> <span data-ttu-id="f0402-117">Konkrétně hello vlastník, Přispěvatel a čtečky hello cílový prostředek dostávat e-maily.</span><span class="sxs-lookup"><span data-stu-id="f0402-117">Specifically, hello owner, contributor, and readers of hello target resource receive email.</span></span> <span data-ttu-id="f0402-118">Také vždy zobrazí *obnovení* e-mail, když se obnoví v případě selhání škálování a začne fungovat normálně.</span><span class="sxs-lookup"><span data-stu-id="f0402-118">You also always receive a *recovery* email when autoscale recovers from a failure and starts functioning normally.</span></span>
* <span data-ttu-id="f0402-119">Vám může výslovný souhlas tooreceive úspěšné škálování akci oznámení prostřednictvím e-mailu a pomocí webhooků.</span><span class="sxs-lookup"><span data-stu-id="f0402-119">You can opt-in tooreceive a successful scale action notification via email and webhooks.</span></span>

## <a name="autoscale-best-practices"></a><span data-ttu-id="f0402-120">Osvědčené postupy škálování</span><span class="sxs-lookup"><span data-stu-id="f0402-120">Autoscale best practices</span></span>
<span data-ttu-id="f0402-121">Použijte následující osvědčené postupy při používání automatického škálování hello.</span><span class="sxs-lookup"><span data-stu-id="f0402-121">Use hello following best practices as you use autoscale.</span></span>

### <a name="ensure-hello-maximum-and-minimum-values-are-different-and-have-an-adequate-margin-between-them"></a><span data-ttu-id="f0402-122">Ujistěte se, maximální a minimální hodnoty hello se liší a mít odpovídající okraje mezi nimi</span><span class="sxs-lookup"><span data-stu-id="f0402-122">Ensure hello maximum and minimum values are different and have an adequate margin between them</span></span>
<span data-ttu-id="f0402-123">Pokud máte nastavení, která má minimální = 2, maximální = 2 a aktuální počet instancí hello je 2, můžete dojít k žádné akci škálování.</span><span class="sxs-lookup"><span data-stu-id="f0402-123">If you have a setting that has minimum=2, maximum=2 and hello current instance count is 2, no scale action can occur.</span></span> <span data-ttu-id="f0402-124">Zachovat odpovídající okraje mezi počty hello maximální a minimální instance, které jsou inkluzivní.</span><span class="sxs-lookup"><span data-stu-id="f0402-124">Keep an adequate margin between hello maximum and minimum instance counts, which are inclusive.</span></span> <span data-ttu-id="f0402-125">Škálování vždy škáluje mezi tyto limity.</span><span class="sxs-lookup"><span data-stu-id="f0402-125">Autoscale always scales between these limits.</span></span>

### <a name="manual-scaling-is-reset-by-autoscale-min-and-max"></a><span data-ttu-id="f0402-126">Ruční škálování při obnovení škálování min a max</span><span class="sxs-lookup"><span data-stu-id="f0402-126">Manual scaling is reset by autoscale min and max</span></span>
<span data-ttu-id="f0402-127">Pokud ručně aktualizovat hello instance počet tooa hodnota výše nebo nižší než maximální hello hello škálování modul automaticky přizpůsobí back toohello minimální (Pokud se níže) nebo hello maximální (Pokud je vyšší než).</span><span class="sxs-lookup"><span data-stu-id="f0402-127">If you manually update hello instance count tooa value above or below hello maximum, hello autoscale engine automatically scales back toohello minimum (if below) or hello maximum (if above).</span></span> <span data-ttu-id="f0402-128">Například můžete nastavit hello rozsahu 3 až 6.</span><span class="sxs-lookup"><span data-stu-id="f0402-128">For example, you set hello range between 3 and 6.</span></span> <span data-ttu-id="f0402-129">Pokud máte jeden spuštěnou instanci, modul škálování hello škáluje instance too3 při příštím spuštění.</span><span class="sxs-lookup"><span data-stu-id="f0402-129">If you have one running instance, hello autoscale engine scales too3 instances on its next run.</span></span> <span data-ttu-id="f0402-130">Podobně se by škálování in 8 instancí zpět too6 při příštím spuštění.</span><span class="sxs-lookup"><span data-stu-id="f0402-130">Likewise, it would scale-in 8 instances back too6 on its next run.</span></span>  <span data-ttu-id="f0402-131">Ruční škálování je velmi dočasný, pokud resetujete hello škálování také pravidla.</span><span class="sxs-lookup"><span data-stu-id="f0402-131">Manual scaling is very temporary unless you reset hello autoscale rules as well.</span></span>

### <a name="always-use-a-scale-out-and-scale-in-rule-combination-that-performs-an-increase-and-decrease"></a><span data-ttu-id="f0402-132">Vždy používejte kombinaci Škálováním na více systémů a škálování pravidla, která provádí zvýšení a snížení</span><span class="sxs-lookup"><span data-stu-id="f0402-132">Always use a scale-out and scale-in rule combination that performs an increase and decrease</span></span>
<span data-ttu-id="f0402-133">Pokud používáte pouze jednou ze součástí sady hello kombinaci, automatické škálování škálování in, který jednotné nebo ve, dokud neodstraníte hello maximální nebo minimální, je dosaženo.</span><span class="sxs-lookup"><span data-stu-id="f0402-133">If you use only one part of hello combination, autoscale scale-in that single out, or in, until hello maximum, or minimum, is reached.</span></span>

### <a name="do-not-switch-between-hello-azure-portal-and-hello-azure-classic-portal-when-managing-autoscale"></a><span data-ttu-id="f0402-134">Při správě škálování není přepínat mezi hello portál Azure a hello portál Azure classic</span><span class="sxs-lookup"><span data-stu-id="f0402-134">Do not switch between hello Azure portal and hello Azure classic portal when managing Autoscale</span></span>
<span data-ttu-id="f0402-135">Pro cloudové služby a aplikace služeb (webové aplikace) použijte portál Azure (portal.azure.com) toocreate hello a spravovat nastavení automatického škálování.</span><span class="sxs-lookup"><span data-stu-id="f0402-135">For Cloud Services and App Services (Web Apps), use hello Azure portal (portal.azure.com) toocreate and manage autoscale settings.</span></span> <span data-ttu-id="f0402-136">Pro sady škálování virtuálního počítače pomocí prostředí PowerShell, rozhraní příkazového řádku nebo REST API toocreate a spravovat nastavení automatického škálování.</span><span class="sxs-lookup"><span data-stu-id="f0402-136">For Virtual Machine Scale Sets use PowerShell, CLI or REST API toocreate and manage autoscale setting.</span></span> <span data-ttu-id="f0402-137">Není přepínat mezi hello portál Azure classic (adresu manage.windowsazure.com) a hello portálu Azure (portal.azure.com) při správě konfigurace automatického škálování.</span><span class="sxs-lookup"><span data-stu-id="f0402-137">Do not switch between hello Azure classic portal (manage.windowsazure.com) and hello Azure portal (portal.azure.com) when managing autoscale configurations.</span></span> <span data-ttu-id="f0402-138">Hello portál Azure classic a jeho základní back-end má omezení.</span><span class="sxs-lookup"><span data-stu-id="f0402-138">hello Azure classic portal and its underlying backend has limitations.</span></span> <span data-ttu-id="f0402-139">Přesuňte škálování Azure portálu toomanage toohello pomocí grafického uživatelského rozhraní.</span><span class="sxs-lookup"><span data-stu-id="f0402-139">Move toohello Azure portal toomanage autoscale using a graphical user interface.</span></span> <span data-ttu-id="f0402-140">Možnosti Hello jsou toouse hello škálování prostředí PowerShell, rozhraní příkazového řádku nebo REST API (pomocí Průzkumníka prostředků Azure).</span><span class="sxs-lookup"><span data-stu-id="f0402-140">hello options are toouse hello autoscale PowerShell, CLI or REST API (via Azure Resource Explorer).</span></span>

### <a name="choose-hello-appropriate-statistic-for-your-diagnostics-metric"></a><span data-ttu-id="f0402-141">Zvolte hello příslušné statistiky pro vaše metrika diagnostiky</span><span class="sxs-lookup"><span data-stu-id="f0402-141">Choose hello appropriate statistic for your diagnostics metric</span></span>
<span data-ttu-id="f0402-142">Diagnostika metriky, můžete vybrat mezi *průměrná*, *minimální*, *maximální* a *celkový* jako metriky tooscale podle.</span><span class="sxs-lookup"><span data-stu-id="f0402-142">For diagnostics metrics, you can choose among *Average*, *Minimum*, *Maximum* and *Total* as a metric tooscale by.</span></span> <span data-ttu-id="f0402-143">Nejběžnější Statistika Hello je *průměrná*.</span><span class="sxs-lookup"><span data-stu-id="f0402-143">hello most common statistic is *Average*.</span></span>

### <a name="choose-hello-thresholds-carefully-for-all-metric-types"></a><span data-ttu-id="f0402-144">Zvolte prahové hodnoty hello pečlivě pro všechny typy metriky</span><span class="sxs-lookup"><span data-stu-id="f0402-144">Choose hello thresholds carefully for all metric types</span></span>
<span data-ttu-id="f0402-145">Doporučujeme pečlivě výběr různé prahové hodnoty pro Škálováním na více systémů a škálování in podle praktické situacích.</span><span class="sxs-lookup"><span data-stu-id="f0402-145">We recommend carefully choosing different thresholds for scale-out and scale-in based on practical situations.</span></span>

<span data-ttu-id="f0402-146">Jsme *nedoporučujeme* nastavení automatického škálování, jako příklady hello níže s hello stejné nebo velmi podobné prahové hodnoty pro odhlásit a v podmínkách:</span><span class="sxs-lookup"><span data-stu-id="f0402-146">We *do not recommend* autoscale settings like hello examples below with hello same or very similar threshold values for out and in conditions:</span></span>

* <span data-ttu-id="f0402-147">Zvýšit instancí 1 počet při počtu vláken < = 600</span><span class="sxs-lookup"><span data-stu-id="f0402-147">Increase instances by 1 count when Thread Count <= 600</span></span>
* <span data-ttu-id="f0402-148">Snižte instancí 1 počet při počtu vláken > = 600</span><span class="sxs-lookup"><span data-stu-id="f0402-148">Decrease instances by 1 count when Thread Count >= 600</span></span>

<span data-ttu-id="f0402-149">Podívejme se na příklad co může způsobit tooa chování, které se může zdát matoucí.</span><span class="sxs-lookup"><span data-stu-id="f0402-149">Let's look at an example of what can lead tooa behavior that may seem confusing.</span></span> <span data-ttu-id="f0402-150">Vezměte v úvahu následující pořadí hello.</span><span class="sxs-lookup"><span data-stu-id="f0402-150">Consider hello following sequence.</span></span>

1. <span data-ttu-id="f0402-151">Předpokládejme, existují 2 instance toobegin s a pak hello průměrný počet vláken na instanci zvětšování too625.</span><span class="sxs-lookup"><span data-stu-id="f0402-151">Assume there are 2 instances toobegin with and then hello average number of threads per instance grows too625.</span></span>
2. <span data-ttu-id="f0402-152">Škálování horizontálně navýší kapacitu, přidání 3. instance.</span><span class="sxs-lookup"><span data-stu-id="f0402-152">Autoscale scales out adding a 3rd instance.</span></span>
3. <span data-ttu-id="f0402-153">V dalším kroku předpokládá, že počet hello průměrná vláken v instanci spadá too575.</span><span class="sxs-lookup"><span data-stu-id="f0402-153">Next, assume that hello average thread count across instance falls too575.</span></span>
4. <span data-ttu-id="f0402-154">Před škálování směrem dolů, automatické škálování pokusí tooestimate, jaké hello konečného stavu bude-li škálovat v.</span><span class="sxs-lookup"><span data-stu-id="f0402-154">Before scaling down, autoscale tries tooestimate what hello final state will be if it scaled in.</span></span> <span data-ttu-id="f0402-155">Například 575 x 3 (aktuální počet instancí) = 1,725 nebo 2 (konečný počet instancí při zmenšování) = 862.5 vláken.</span><span class="sxs-lookup"><span data-stu-id="f0402-155">For example, 575 x  3 (current instance count) = 1,725 / 2 (final number of instances when scaled down) = 862.5 threads.</span></span> <span data-ttu-id="f0402-156">To znamená, že škálování by měla tooimmediately škálování znovu i po jeho škálovat, pokud hello vlákno průměrný počet zůstane hello stejný nebo i spadá pouze malé množství.</span><span class="sxs-lookup"><span data-stu-id="f0402-156">This means autoscale would have tooimmediately scale-out again even after it scaled in, if hello average thread count remains hello same or even falls only a small amount.</span></span> <span data-ttu-id="f0402-157">Pokud ji škálovat znovu hello celý proces by opakovat, ale úvodní tooan nekonečná smyčka.</span><span class="sxs-lookup"><span data-stu-id="f0402-157">However, if it scaled up again, hello whole process would repeat, leading tooan infinite loop.</span></span>
5. <span data-ttu-id="f0402-158">tooavoid této situaci (dále jen "flapping"), škálování není snižovat vůbec.</span><span class="sxs-lookup"><span data-stu-id="f0402-158">tooavoid this situation (termed "flapping"), autoscale does not scale down at all.</span></span> <span data-ttu-id="f0402-159">Místo toho přeskočí a reevaluates hello podmínku znovu spustí úlohy hello další čas hello služby.</span><span class="sxs-lookup"><span data-stu-id="f0402-159">Instead, it skips and reevaluates hello condition again hello next time hello service's job executes.</span></span> <span data-ttu-id="f0402-160">To může matou Spousta lidí, protože škálování by se toowork, když byl 575 hello vlákno průměrný počet.</span><span class="sxs-lookup"><span data-stu-id="f0402-160">This could confuse many people because autoscale wouldn't appear toowork when hello average thread count was 575.</span></span>

<span data-ttu-id="f0402-161">Odhad během škálování v je určený tooavoid "netřepotá" situace, kdy akce škálování in a škálování průběžně přejděte a zpět.</span><span class="sxs-lookup"><span data-stu-id="f0402-161">Estimation during a scale-in is intended tooavoid "flapping" situations, where scale-in and scale-out actions continually go back and forth.</span></span> <span data-ttu-id="f0402-162">Toto chování mít na paměti, když zvolíte hello stejné prahové hodnoty pro Škálováním na více systémů a na.</span><span class="sxs-lookup"><span data-stu-id="f0402-162">Keep this behavior in mind when you choose hello same thresholds for scale-out and in.</span></span>

<span data-ttu-id="f0402-163">Doporučujeme vybrat odpovídající okraje mezi hello Škálováním na více systémů a prahové hodnoty.</span><span class="sxs-lookup"><span data-stu-id="f0402-163">We recommend choosing an adequate margin between hello scale-out and in thresholds.</span></span> <span data-ttu-id="f0402-164">Jako příklad zvažte následující kombinace lepší pravidlo hello.</span><span class="sxs-lookup"><span data-stu-id="f0402-164">As an example, consider hello following better rule combination.</span></span>

* <span data-ttu-id="f0402-165">Zvýšit instancí 1 počet při využití procesoru % > = 80</span><span class="sxs-lookup"><span data-stu-id="f0402-165">Increase instances by 1 count when CPU%  >= 80</span></span>
* <span data-ttu-id="f0402-166">Snižte instancí 1 počet při % využití procesoru < = 60</span><span class="sxs-lookup"><span data-stu-id="f0402-166">Decrease instances by 1 count when CPU% <= 60</span></span>

<span data-ttu-id="f0402-167">V takovém případě</span><span class="sxs-lookup"><span data-stu-id="f0402-167">In this case</span></span>  

1. <span data-ttu-id="f0402-168">Předpokládejme, že se 2 instance toostart s.</span><span class="sxs-lookup"><span data-stu-id="f0402-168">Assume there are 2 instances toostart with.</span></span>
2. <span data-ttu-id="f0402-169">Pokud hello průměrné využití procesoru % napříč instancemi přestane too80, automatické škálování horizontálně navýší kapacitu, přidání třetí instance.</span><span class="sxs-lookup"><span data-stu-id="f0402-169">If hello average CPU% across instances goes too80, autoscale scales out adding a third instance.</span></span>
3. <span data-ttu-id="f0402-170">Nyní předpokládá, že přes čas procesoru hello spadá % too60.</span><span class="sxs-lookup"><span data-stu-id="f0402-170">Now assume that over time hello CPU% falls too60.</span></span>
4. <span data-ttu-id="f0402-171">Škálování na škálování v pravidlo odhadne hello konečného stavu by měla tooscale v.</span><span class="sxs-lookup"><span data-stu-id="f0402-171">Autoscale's scale-in rule estimates hello final state if it were tooscale-in.</span></span> <span data-ttu-id="f0402-172">Například 60 x 3 (aktuální počet instancí) = 180 nebo 2 (konečný počet instancí při zmenšování) = 90.</span><span class="sxs-lookup"><span data-stu-id="f0402-172">For example, 60 x 3 (current instance count) = 180 / 2 (final number of instances when scaled down) = 90.</span></span> <span data-ttu-id="f0402-173">Proto škálování není škálování – v protože by mohlo mít ihned tooscale na více systémů.</span><span class="sxs-lookup"><span data-stu-id="f0402-173">So autoscale does not scale-in because it would have tooscale-out again immediately.</span></span> <span data-ttu-id="f0402-174">Místo toho přeskočí škálování směrem dolů.</span><span class="sxs-lookup"><span data-stu-id="f0402-174">Instead, it skips scaling down.</span></span>
5. <span data-ttu-id="f0402-175">kontroluje, Hello další čas škálování hello procesoru pokračuje toofall too50.</span><span class="sxs-lookup"><span data-stu-id="f0402-175">hello next time autoscale checks, hello CPU continues toofall too50.</span></span> <span data-ttu-id="f0402-176">Odhadne znovu - instance 50 x 3 = 150 / 2 instance = 75, což je pod prahovou hodnotou škálování hello 80, takže ho škáluje úspěšně too2 instancí.</span><span class="sxs-lookup"><span data-stu-id="f0402-176">It estimates again -  50 x 3 instance = 150 / 2 instances = 75, which is below hello scale-out threshold of 80, so it scales in successfully too2 instances.</span></span>

### <a name="considerations-for-scaling-threshold-values-for-special-metrics"></a><span data-ttu-id="f0402-177">Důležité informace pro škálování prahové hodnoty pro speciální metriky</span><span class="sxs-lookup"><span data-stu-id="f0402-177">Considerations for scaling threshold values for special metrics</span></span>
 <span data-ttu-id="f0402-178">Speciální metrik, jako je délka metrika úložiště nebo frontou Service Bus je prahová hodnota hello hello průměrný počet zpráv, které jsou k dispozici na aktuální počet instancí.</span><span class="sxs-lookup"><span data-stu-id="f0402-178">For special metrics such as Storage or Service Bus Queue length metric, hello threshold is hello average number of messages available per current number of instances.</span></span> <span data-ttu-id="f0402-179">Pečlivě zvolte hello zvolte hello prahová hodnota pro tuto metriku.</span><span class="sxs-lookup"><span data-stu-id="f0402-179">Carefully choose hello choose hello threshold value for this metric.</span></span>

<span data-ttu-id="f0402-180">Umožňuje znázornění ho s tooensure příklad porozumíte hello chování lepší.</span><span class="sxs-lookup"><span data-stu-id="f0402-180">Let's illustrate it with an example tooensure you understand hello behavior better.</span></span>

* <span data-ttu-id="f0402-181">Zvýšit instancí podle počtu 1, když počet zprávy fronty úložiště > = 50</span><span class="sxs-lookup"><span data-stu-id="f0402-181">Increase instances by 1 count when Storage Queue message count >= 50</span></span>
* <span data-ttu-id="f0402-182">Snižte instancí 1 počet při fronty úložiště zpráv počet < = 10</span><span class="sxs-lookup"><span data-stu-id="f0402-182">Decrease instances by 1 count when Storage Queue message count <= 10</span></span>

<span data-ttu-id="f0402-183">Vezměte v úvahu následující pořadí hello:</span><span class="sxs-lookup"><span data-stu-id="f0402-183">Consider hello following sequence:</span></span>

1. <span data-ttu-id="f0402-184">Existují 2 instance fronty úložiště.</span><span class="sxs-lookup"><span data-stu-id="f0402-184">There are 2 storage queue instances.</span></span>
2. <span data-ttu-id="f0402-185">Zachovat zprávy přicházející a při kontrole fronty úložiště hello celkový počet hello přečte 50.</span><span class="sxs-lookup"><span data-stu-id="f0402-185">Messages keep coming and when you review hello storage queue, hello total count reads 50.</span></span> <span data-ttu-id="f0402-186">Může předpokládat, že tento škálování by se měl spustit akci škálování.</span><span class="sxs-lookup"><span data-stu-id="f0402-186">You might assume that autoscale should start a scale-out action.</span></span> <span data-ttu-id="f0402-187">Ale Všimněte si, že je stále 50/2 = 25 zprávy na jednu instanci.</span><span class="sxs-lookup"><span data-stu-id="f0402-187">However, note that it is still 50/2 = 25 messages per instance.</span></span> <span data-ttu-id="f0402-188">Škálováním na více systémů, takže nedojde.</span><span class="sxs-lookup"><span data-stu-id="f0402-188">So, scale-out does not occur.</span></span> <span data-ttu-id="f0402-189">Pro škálování toohappen první hello hello celkový počet zpráv ve frontě hello úložiště by měl být 100.</span><span class="sxs-lookup"><span data-stu-id="f0402-189">For hello first scale-out toohappen, hello total message count in hello storage queue should be 100.</span></span>
3. <span data-ttu-id="f0402-190">V dalším kroku předpokládá, že hello celkový počet zpráv dosáhne 100.</span><span class="sxs-lookup"><span data-stu-id="f0402-190">Next, assume that hello total message count reaches 100.</span></span>
4. <span data-ttu-id="f0402-191">3. instance fronty úložiště je přidat z důvodu akce tooa Škálováním na více systémů.</span><span class="sxs-lookup"><span data-stu-id="f0402-191">A 3rd storage queue instance is added due tooa scale-out action.</span></span>  <span data-ttu-id="f0402-192">Hello další akce Škálováním na více systémů se neprovede dokud hello celkový počet zpráv ve frontě hello dosáhne 150, protože 150/3 = 50.</span><span class="sxs-lookup"><span data-stu-id="f0402-192">hello next scale-out action will not happen until hello total message count in hello queue reaches 150 because 150/3 = 50.</span></span>
5. <span data-ttu-id="f0402-193">Nyní hello počet zpráv ve frontě hello získá menší.</span><span class="sxs-lookup"><span data-stu-id="f0402-193">Now hello number of messages in hello queue gets smaller.</span></span> <span data-ttu-id="f0402-194">3 instancemi hello první škálování v akce se stane, když hello celkový počet zpráv ve všech frontách dohromady too30 protože 30/3 = 10 zprávy každou instanci, která je hello škálování v prahovou hodnotu.</span><span class="sxs-lookup"><span data-stu-id="f0402-194">With 3 instances, hello first scale-in action happens when hello total messages in all queues add up too30 because 30/3 = 10 messages per instance, which is hello scale-in threshold.</span></span>

### <a name="considerations-for-scaling-when-multiple-profiles-are-configured-in-an-autoscale-setting"></a><span data-ttu-id="f0402-195">Důležité informace pro škálování při více profilů konfigurované v nastavení automatického škálování</span><span class="sxs-lookup"><span data-stu-id="f0402-195">Considerations for scaling when multiple profiles are configured in an autoscale setting</span></span>
<span data-ttu-id="f0402-196">V nastavení automatického škálování, můžete výchozí profil, který se použije vždy bez závislost na plán nebo čas, nebo můžete opakovaně profil nebo po stanovenou dobu s rozsahem datum a čas.</span><span class="sxs-lookup"><span data-stu-id="f0402-196">In an autoscale setting, you can choose a default profile, which is always applied without any dependency on schedule or time, or you can choose a recurring profile or a profile for a fixed period with a date and time range.</span></span>

<span data-ttu-id="f0402-197">Při škálování služby je zpracuje, vždy kontroluje v hello následující pořadí:</span><span class="sxs-lookup"><span data-stu-id="f0402-197">When autoscale service processes them, it always checks in hello following order:</span></span>

1. <span data-ttu-id="f0402-198">Opravené datum profilu</span><span class="sxs-lookup"><span data-stu-id="f0402-198">Fixed Date profile</span></span>
2. <span data-ttu-id="f0402-199">Opakované profilu</span><span class="sxs-lookup"><span data-stu-id="f0402-199">Recurring profile</span></span>
3. <span data-ttu-id="f0402-200">Výchozí profil ("vždy")</span><span class="sxs-lookup"><span data-stu-id="f0402-200">Default ("Always") profile</span></span>

<span data-ttu-id="f0402-201">Pokud je splněna podmínka profilu, nekontroluje škálování hello další podmínky profil pod ním.</span><span class="sxs-lookup"><span data-stu-id="f0402-201">If a profile condition is met, autoscale does not check hello next profile condition below it.</span></span> <span data-ttu-id="f0402-202">Škálování zpracovává jenom jeden profil najednou.</span><span class="sxs-lookup"><span data-stu-id="f0402-202">Autoscale only processes one profile at a time.</span></span> <span data-ttu-id="f0402-203">To znamená, pokud chcete, aby tooalso zahrnují podmínku zpracování z profilu nižší úrovně, tato pravidla musí obsahovat také v aktuální profil hello.</span><span class="sxs-lookup"><span data-stu-id="f0402-203">This means if you want tooalso include a processing condition from a lower-tier profile, you must include those rules as well in hello current profile.</span></span>

<span data-ttu-id="f0402-204">Pojďme si to pomocí příklad:</span><span class="sxs-lookup"><span data-stu-id="f0402-204">Let's review this using an example:</span></span>

<span data-ttu-id="f0402-205">Následující obrázek Hello ukazuje na nastavení automatického škálování s minimální instancí výchozí profil = 2 a maximální instancí = 10.</span><span class="sxs-lookup"><span data-stu-id="f0402-205">hello image below shows an autoscale setting with a default profile of minimum instances = 2 and maximum instances = 10.</span></span> <span data-ttu-id="f0402-206">V tomto příkladu jsou pravidla nakonfigurované tooscale na více systémů, v případě hello počet zpráv ve frontě hello je větší než 10 a škálování hello počet zpráv ve frontě hello je menší než 3.</span><span class="sxs-lookup"><span data-stu-id="f0402-206">In this example, rules are configured tooscale-out when hello message count in hello queue is greater than 10 and scale-in when hello message count in hello queue is less than 3.</span></span> <span data-ttu-id="f0402-207">Hello prostředků, takže teď můžete škálovat mezi instancemi 2 až 10.</span><span class="sxs-lookup"><span data-stu-id="f0402-207">So now hello resource can scale between 2 and 10 instances.</span></span>

<span data-ttu-id="f0402-208">Kromě toho je profil opakovaně nastavit pro pondělí.</span><span class="sxs-lookup"><span data-stu-id="f0402-208">In addition, there is a recurring profile set for Monday.</span></span> <span data-ttu-id="f0402-209">Nastavení pro minimální instance = 2 a maximální instancí = 12.</span><span class="sxs-lookup"><span data-stu-id="f0402-209">It is set for minimum instances = 2 and maximum instances = 12.</span></span> <span data-ttu-id="f0402-210">To znamená v pondělí, zkontroluje hello první čas škálování pro tuto podmínku, pokud je počet instancí hello 2, se škáluje toohello nové minimálně 3.</span><span class="sxs-lookup"><span data-stu-id="f0402-210">This means on Monday, hello first time autoscale checks for this condition, if hello instance count is 2, it scales toohello new minimum of 3.</span></span> <span data-ttu-id="f0402-211">Tak dlouho, dokud škálování pokračuje toofind tuto podmínku profil shodná (pondělí), zpracovává jenom hello bázi procesoru Škálováním na více systémů nebo v nakonfigurovaná pravidla pro tento profil.</span><span class="sxs-lookup"><span data-stu-id="f0402-211">As long as autoscale continues toofind this profile condition matched (Monday), it only processes hello CPU-based scale-out/in rules configured for this profile.</span></span> <span data-ttu-id="f0402-212">V tomto okamžiku nekontroluje se pro délka fronty hello.</span><span class="sxs-lookup"><span data-stu-id="f0402-212">At this time, it does not check for hello queue length.</span></span> <span data-ttu-id="f0402-213">Ale pokud také chcete hello fronty délka podmínky toobe zaškrtnuto, by měla obsahovat tato pravidla z hello výchozí profil také váš profil pondělí.</span><span class="sxs-lookup"><span data-stu-id="f0402-213">However, if you also want hello queue length condition toobe checked, you should include those rules from hello default profile as well in your Monday profile.</span></span>

<span data-ttu-id="f0402-214">Podobně když škálování přepne back toohello výchozí profil, nejdřív zkontroluje, pokud jsou splněny podmínky minimální a maximální hello.</span><span class="sxs-lookup"><span data-stu-id="f0402-214">Similarly, when autoscale switches back toohello default profile, it first checks if hello minimum and maximum conditions are met.</span></span> <span data-ttu-id="f0402-215">Pokud hello počet instancí v době hello 12, se škáluje v too10, hello maximální povolené pro hello výchozí profil.</span><span class="sxs-lookup"><span data-stu-id="f0402-215">If hello number of instances at hello time is 12, it scales in too10, hello maximum allowed for hello default profile.</span></span>

![nastavení automatického škálování](./media/insights-autoscale-best-practices/insights-autoscale-best-practices-2.png)

### <a name="considerations-for-scaling-when-multiple-rules-are-configured-in-a-profile"></a><span data-ttu-id="f0402-217">Důležité informace pro škálování při nastavení víc pravidel v profilu</span><span class="sxs-lookup"><span data-stu-id="f0402-217">Considerations for scaling when multiple rules are configured in a profile</span></span>
<span data-ttu-id="f0402-218">Existují případy, kdy můžete mít tooset více pravidel v profilu.</span><span class="sxs-lookup"><span data-stu-id="f0402-218">There are cases where you may have tooset multiple rules in a profile.</span></span> <span data-ttu-id="f0402-219">služby používají používá Hello následující sadu pravidel škálování více pravidel jsou nastavena.</span><span class="sxs-lookup"><span data-stu-id="f0402-219">hello following set of autoscale rules are used by services use when multiple rules are set.</span></span>

<span data-ttu-id="f0402-220">Na *škálovat*, škálování spustí, pokud je splněna žádné pravidlo.</span><span class="sxs-lookup"><span data-stu-id="f0402-220">On *scale out*, autoscale runs if any rule is met.</span></span>
<span data-ttu-id="f0402-221">Na *škálování v*, automatické škálování vyžadují toobe splněná všechna pravidla.</span><span class="sxs-lookup"><span data-stu-id="f0402-221">On *scale-in*, autoscale require all rules toobe met.</span></span>

<span data-ttu-id="f0402-222">tooillustrate, předpokládají, že byl hello následující 4 škálování pravidla:</span><span class="sxs-lookup"><span data-stu-id="f0402-222">tooillustrate, assume that you have hello following 4 autoscale rules:</span></span>

* <span data-ttu-id="f0402-223">Pokud procesoru < 30 % škálování v 1</span><span class="sxs-lookup"><span data-stu-id="f0402-223">If CPU < 30 %, scale-in by 1</span></span>
* <span data-ttu-id="f0402-224">Pokud škálování v 1 paměti < 50 %</span><span class="sxs-lookup"><span data-stu-id="f0402-224">If Memory < 50%, scale-in by 1</span></span>
* <span data-ttu-id="f0402-225">Pokud > 75 % využití procesoru, horizontální o 1</span><span class="sxs-lookup"><span data-stu-id="f0402-225">If CPU > 75%, scale-out by 1</span></span>
* <span data-ttu-id="f0402-226">Pokud paměti > 75 %, horizontální o 1</span><span class="sxs-lookup"><span data-stu-id="f0402-226">If Memory > 75%, scale-out by 1</span></span>

<span data-ttu-id="f0402-227">Potom se provede hello postupujte podle kroků:</span><span class="sxs-lookup"><span data-stu-id="f0402-227">Then hello follow occurs:</span></span>

* <span data-ttu-id="f0402-228">Pokud je 76 % procesoru a paměti je 50 %, jsme Škálováním na více systémů.</span><span class="sxs-lookup"><span data-stu-id="f0402-228">If CPU is 76% and Memory is 50%, we scale-out.</span></span>
* <span data-ttu-id="f0402-229">Pokud je 50 % využití procesoru a paměti je % 76 jsme Škálováním na více systémů.</span><span class="sxs-lookup"><span data-stu-id="f0402-229">If CPU is 50% and Memory is 76% we scale-out.</span></span>

<span data-ttu-id="f0402-230">Na druhé straně, hello, pokud využití procesoru činí 25 % a paměti je 51 % automatického škálování nemá **není** škálování v.</span><span class="sxs-lookup"><span data-stu-id="f0402-230">On hello other hand, if CPU is 25% and memory is 51% autoscale does **not** scale-in.</span></span> <span data-ttu-id="f0402-231">V pořadí tooscale v procesoru musí být 29 % a paměť 49 %.</span><span class="sxs-lookup"><span data-stu-id="f0402-231">In order tooscale-in, CPU must be 29% and Memory 49%.</span></span>

### <a name="always-select-a-safe-default-instance-count"></a><span data-ttu-id="f0402-232">Vždy vybrat bezpečné výchozí počet instancí</span><span class="sxs-lookup"><span data-stu-id="f0402-232">Always select a safe default instance count</span></span>
<span data-ttu-id="f0402-233">Výchozí počet instancí Hello je důležité automatické škálování škáluje spočítat toothat služby metriky nejsou k dispozici.</span><span class="sxs-lookup"><span data-stu-id="f0402-233">hello default instance count is important autoscale scales your service toothat count when metrics are not available.</span></span> <span data-ttu-id="f0402-234">Proto vyberte výchozí počet instancí, který je bezpečný pro úlohy.</span><span class="sxs-lookup"><span data-stu-id="f0402-234">Therefore, select a default instance count that's safe for your workloads.</span></span>

### <a name="configure-autoscale-notifications"></a><span data-ttu-id="f0402-235">Konfigurace automatického škálování oznámení</span><span class="sxs-lookup"><span data-stu-id="f0402-235">Configure autoscale notifications</span></span>
<span data-ttu-id="f0402-236">Škálování oznámí správci hello a přispěvatelé hello prostředku e-mailem, pokud dojde k některé z hello následující podmínky:</span><span class="sxs-lookup"><span data-stu-id="f0402-236">Autoscale notifies hello administrators and contributors of hello resource by email if any of hello following conditions occur:</span></span>

* <span data-ttu-id="f0402-237">škálování služby nezdaří tootake akce.</span><span class="sxs-lookup"><span data-stu-id="f0402-237">autoscale service fails tootake an action.</span></span>
* <span data-ttu-id="f0402-238">Metriky nejsou k dispozici pro škálování služby toomake škálování rozhodnutí.</span><span class="sxs-lookup"><span data-stu-id="f0402-238">Metrics are not available for autoscale service toomake a scale decision.</span></span>
* <span data-ttu-id="f0402-239">Metriky jsou k dispozici (obnovení) znovu toomake škálování rozhodnutí.</span><span class="sxs-lookup"><span data-stu-id="f0402-239">Metrics are available (recovery) again toomake a scale decision.</span></span>
  <span data-ttu-id="f0402-240">Kromě výše uvedené podmínky toohello, můžete nakonfigurovat e-mailu nebo webhooku tooget oznámení, oznámení pro akce úspěšné škálování.</span><span class="sxs-lookup"><span data-stu-id="f0402-240">In addition toohello conditions above, you can configure email or webhook notifications tooget notified for successful scale actions.</span></span>
  
<span data-ttu-id="f0402-241">Můžete použít také protokolu aktivit výstrahy toomonitor hello stavu hello škálování stroje.</span><span class="sxs-lookup"><span data-stu-id="f0402-241">You can also use an Activity Log alert toomonitor hello health of hello autoscale engine.</span></span> <span data-ttu-id="f0402-242">Zde jsou příklady příliš[vytvořit aktivity protokolu výstrahy toomonitor všechny operace škálování modul vaše předplatné](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-alert) nebo příliš[vytvořit aktivity protokolu výstrahy toomonitor všechny nemohl škálování měřítka ve / škálovat operací na Vaše předplatné](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-failed-alert).</span><span class="sxs-lookup"><span data-stu-id="f0402-242">Here are examples too[create an Activity Log Alert toomonitor all autoscale engine operations on your subscription](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-alert) or too[create an Activity Log Alert toomonitor all failed autoscale scale in/scale out operations on your subscription](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-failed-alert).</span></span>

## <a name="next-steps"></a><span data-ttu-id="f0402-243">Další kroky</span><span class="sxs-lookup"><span data-stu-id="f0402-243">Next Steps</span></span>
- [<span data-ttu-id="f0402-244">Vytvoření aktivity protokolu výstrahy toomonitor všechny operace škálování modul vaše předplatné.</span><span class="sxs-lookup"><span data-stu-id="f0402-244">Create an Activity Log Alert toomonitor all autoscale engine operations on your subscription.</span></span>](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-alert)
- [<span data-ttu-id="f0402-245">Vytvoření aktivity protokolu výstrahy toomonitor všechny nemohl škálování měřítka ve / škálovat operací na vaše předplatné</span><span class="sxs-lookup"><span data-stu-id="f0402-245">Create an Activity Log Alert toomonitor all failed autoscale scale in/scale out operations on your subscription</span></span>](https://github.com/Azure/azure-quickstart-templates/tree/master/monitor-autoscale-failed-alert)
