---
title: "aaaConfigure hello rozšíření Azure MFA serveru NPS | Microsoft Docs"
description: "Po instalaci rozšíření NPS hello tyto kroky použijte pro pokročilou konfiguraci, jako je vytvoření seznamu povolených IP a nahrazení UPN."
services: multi-factor-authentication
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: 
ms.service: multi-factor-authentication
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/14/2017
ms.author: kgremban
ms.reviewer: yossib
ms.custom: it-pro
ms.openlocfilehash: c3aed077b23c95f874861eb00c8e6dca668329c1
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="advanced-configuration-options-for-hello-nps-extension-for-multi-factor-authentication"></a><span data-ttu-id="35f12-103">Upřesnit možnosti konfigurace pro hello NPS rozšíření pro službu Multi-Factor Authentication</span><span class="sxs-lookup"><span data-stu-id="35f12-103">Advanced configuration options for hello NPS extension for Multi-Factor Authentication</span></span>

<span data-ttu-id="35f12-104">Hello rozšíření serveru NPS (Network Policy Server) rozšiřuje vaše cloudové funkce Azure Multi-Factor Authentication do místní infrastruktury.</span><span class="sxs-lookup"><span data-stu-id="35f12-104">hello Network Policy Server (NPS) extension extends your cloud-based Azure Multi-Factor Authentication features into your on-premises infrastructure.</span></span> <span data-ttu-id="35f12-105">Tento článek předpokládá už máte hello rozšíření nainstalovat a teď chcete tooknow jak musí toocustomize hello rozšíření pro vás.</span><span class="sxs-lookup"><span data-stu-id="35f12-105">This article assumes that you already have hello extension installed, and now want tooknow how toocustomize hello extension for you needs.</span></span> 

## <a name="alternate-login-id"></a><span data-ttu-id="35f12-106">Alternativním přihlašovacím ID</span><span class="sxs-lookup"><span data-stu-id="35f12-106">Alternate login ID</span></span>

<span data-ttu-id="35f12-107">Vzhledem k tomu, že hello NPS rozšíření připojí tooboth místní a cloudové adresáře, můžete setkat s problémem, kdy hlavní názvy vaše místní uživatele (UPN) se neshodují hello názvy v cloudu hello.</span><span class="sxs-lookup"><span data-stu-id="35f12-107">Since hello NPS extension connects tooboth your on-premises and cloud directories, you might encounter an issue where your on-premises user principal names (UPNs) don't match hello names in hello cloud.</span></span> <span data-ttu-id="35f12-108">toosolve tento problém, pomocí alternativního přihlašovacího ID.</span><span class="sxs-lookup"><span data-stu-id="35f12-108">toosolve this problem, use alternate login IDs.</span></span> 

<span data-ttu-id="35f12-109">V rámci hello rozšíření serveru NPS můžete určit toobe atribut Active Directory použít místo hello UPN pro Azure Multi-Factor Authentication.</span><span class="sxs-lookup"><span data-stu-id="35f12-109">Within hello NPS extension, you can designate an Active Directory attribute toobe used in place of hello UPN for Azure Multi-Factor Authentication.</span></span> <span data-ttu-id="35f12-110">Díky tomu můžete tooprotect vaše místní prostředky s dvoustupňové ověření beze změny vaší místní UPN.</span><span class="sxs-lookup"><span data-stu-id="35f12-110">This enables you tooprotect your on-premises resources with two-step verification without modifying your on-premises UPNs.</span></span> 

<span data-ttu-id="35f12-111">tooconfigure alternativního přihlašovacího ID, přejděte příliš`HKLM\SOFTWARE\Microsoft\AzureMfa` a upravit hello následující hodnoty registru:</span><span class="sxs-lookup"><span data-stu-id="35f12-111">tooconfigure alternate login IDs, go too`HKLM\SOFTWARE\Microsoft\AzureMfa` and edit hello following registry values:</span></span>

| <span data-ttu-id="35f12-112">Name (Název)</span><span class="sxs-lookup"><span data-stu-id="35f12-112">Name</span></span> | <span data-ttu-id="35f12-113">Typ</span><span class="sxs-lookup"><span data-stu-id="35f12-113">Type</span></span> | <span data-ttu-id="35f12-114">Výchozí hodnota</span><span class="sxs-lookup"><span data-stu-id="35f12-114">Default value</span></span> | <span data-ttu-id="35f12-115">Popis</span><span class="sxs-lookup"><span data-stu-id="35f12-115">Description</span></span> |
| ---- | ---- | ------------- | ----------- |
| <span data-ttu-id="35f12-116">LDAP_ALTERNATE_LOGINID_ATTRIBUTE</span><span class="sxs-lookup"><span data-stu-id="35f12-116">LDAP_ALTERNATE_LOGINID_ATTRIBUTE</span></span> | <span data-ttu-id="35f12-117">Řetězec</span><span class="sxs-lookup"><span data-stu-id="35f12-117">string</span></span> | <span data-ttu-id="35f12-118">prázdný</span><span class="sxs-lookup"><span data-stu-id="35f12-118">Empty</span></span> | <span data-ttu-id="35f12-119">Určete název hello atributu služby Active Directory, které chcete toouse místo hello UPN.</span><span class="sxs-lookup"><span data-stu-id="35f12-119">Designate hello name of Active Directory attribute that you want toouse instead of hello UPN.</span></span> <span data-ttu-id="35f12-120">Tento atribut slouží jako atribut AlternateLoginId hello.</span><span class="sxs-lookup"><span data-stu-id="35f12-120">This attribute is used as hello AlternateLoginId attribute.</span></span> <span data-ttu-id="35f12-121">Pokud je tato hodnota registru nastavená tooa [platný atribut služby Active Directory](https://msdn.microsoft.com/library/ms675090.aspx) (například e-mailu nebo displayName), pak hodnota atributu hello je použít místo hello uživatele (UPN) pro ověřování.</span><span class="sxs-lookup"><span data-stu-id="35f12-121">If this registry value is set tooa [valid Active Directory attribute](https://msdn.microsoft.com/library/ms675090.aspx) (for example, mail or displayName), then hello attribute's value is used in place of hello user's UPN for authentication.</span></span> <span data-ttu-id="35f12-122">Pokud tato hodnota registru není prázdný, nebo není nakonfigurováno, pak je zakázána AlternateLoginId a hello uživatele (UPN) se používá k ověřování.</span><span class="sxs-lookup"><span data-stu-id="35f12-122">If this registry value is empty or not configured, then AlternateLoginId is disabled and hello user's UPN is used for authentication.</span></span> |
| <span data-ttu-id="35f12-123">LDAP_FORCE_GLOBAL_CATALOG</span><span class="sxs-lookup"><span data-stu-id="35f12-123">LDAP_FORCE_GLOBAL_CATALOG</span></span> | <span data-ttu-id="35f12-124">Logická hodnota</span><span class="sxs-lookup"><span data-stu-id="35f12-124">boolean</span></span> | <span data-ttu-id="35f12-125">False</span><span class="sxs-lookup"><span data-stu-id="35f12-125">False</span></span> | <span data-ttu-id="35f12-126">Při vyhledávání AlternateLoginId, použijte tento příznak tooforce hello použití globálního katalogu pro hledání LDAP.</span><span class="sxs-lookup"><span data-stu-id="35f12-126">Use this flag tooforce hello use of Global Catalog for LDAP searches when looking up AlternateLoginId.</span></span> <span data-ttu-id="35f12-127">Konfigurace řadiče domény jako globální katalog, přidejte hello AlternateLoginId atribut toohello globálního katalogu a pak povolte tento příznak.</span><span class="sxs-lookup"><span data-stu-id="35f12-127">Configure a domain controller as a Global Catalog, add hello AlternateLoginId attribute toohello Global Catalog, and then enable this flag.</span></span> <br><br> <span data-ttu-id="35f12-128">Pokud je nakonfigurovaný (není prázdná), LDAP_LOOKUP_FORESTS **tento příznak se vynucuje jako true**, bez ohledu na to hello hodnota nastavení registru hello.</span><span class="sxs-lookup"><span data-stu-id="35f12-128">If LDAP_LOOKUP_FORESTS is configured (not empty), **this flag is enforced as true**, regardless of hello value of hello registry setting.</span></span> <span data-ttu-id="35f12-129">V takovém případě hello NPS rozšíření vyžaduje toobe globálního katalogu hello nakonfigurované hello AlternateLoginId atribut pro jednotlivé doménové struktury.</span><span class="sxs-lookup"><span data-stu-id="35f12-129">In this case, hello NPS extension requires hello Global Catalog toobe configured with hello AlternateLoginId attribute for each forest.</span></span> |
| <span data-ttu-id="35f12-130">LDAP_LOOKUP_FORESTS</span><span class="sxs-lookup"><span data-stu-id="35f12-130">LDAP_LOOKUP_FORESTS</span></span> | <span data-ttu-id="35f12-131">Řetězec</span><span class="sxs-lookup"><span data-stu-id="35f12-131">string</span></span> | <span data-ttu-id="35f12-132">prázdný</span><span class="sxs-lookup"><span data-stu-id="35f12-132">Empty</span></span> | <span data-ttu-id="35f12-133">Zadejte středníky oddělený seznam toosearch doménové struktury.</span><span class="sxs-lookup"><span data-stu-id="35f12-133">Provide a semi-colon separated list of forests toosearch.</span></span> <span data-ttu-id="35f12-134">Například *contoso.com;foobar.com*. Pokud je tato hodnota registru nakonfigurovaný, vyhledá hello NPS rozšíření interaktivně všech doménových struktur hello v hello pořadí, ve kterém byly uvedeny a vrátí hodnotu AlternateLoginId první úspěšné hello.</span><span class="sxs-lookup"><span data-stu-id="35f12-134">For example, *contoso.com;foobar.com*. If this registry value is configured, hello NPS extension iteratively searches all hello forests in hello order in which they were listed, and returns hello first successful AlternateLoginId value.</span></span> <span data-ttu-id="35f12-135">Pokud tato hodnota registru není nakonfigurováno, je vyhledávání AlternateLoginId hello uzavřeného toohello aktuální domény.</span><span class="sxs-lookup"><span data-stu-id="35f12-135">If this registry value is not configured, hello AlternateLoginId lookup is confined toohello current domain.</span></span>|

<span data-ttu-id="35f12-136">tootroubleshoot problémy s alternativním přihlašovacím ID, použijte hello doporučené kroky pro [alternativní přihlašovací ID chyby](multi-factor-authentication-nps-errors.md#alternate-login-id-errors).</span><span class="sxs-lookup"><span data-stu-id="35f12-136">tootroubleshoot problems with alternate login IDs, use hello recommended steps for [Alternate login ID errors](multi-factor-authentication-nps-errors.md#alternate-login-id-errors).</span></span>

## <a name="ip-exceptions"></a><span data-ttu-id="35f12-137">Výjimky IP</span><span class="sxs-lookup"><span data-stu-id="35f12-137">IP exceptions</span></span>

<span data-ttu-id="35f12-138">Pokud potřebujete toomonitor dostupnost serveru, například pokud ověřte nástroje pro vyrovnávání zatížení serverů, které jsou spuštěny před odesláním úloh, nechcete, aby tyto kontroly toobe blokována žádosti o ověření.</span><span class="sxs-lookup"><span data-stu-id="35f12-138">If you need toomonitor server availability, like if load balancers verify which servers are running before sending workloads, you don't want these checks toobe blocked by verification requests.</span></span> <span data-ttu-id="35f12-139">Místo toho vytvořte seznam IP adres, které znáte používají účty služeb a zakázání služby Multi-Factor Authentication požadavky pro tento seznam.</span><span class="sxs-lookup"><span data-stu-id="35f12-139">Instead, create a list of IP addresses that you know are used by service accounts, and disable Multi-Factor Authentication requirements for that list.</span></span> 

<span data-ttu-id="35f12-140">přejděte seznam povolených IP adres tooconfigure příliš`HKLM\SOFTWARE\Microsoft\AzureMfa` a nakonfigurujte hello následující hodnotu registru:</span><span class="sxs-lookup"><span data-stu-id="35f12-140">tooconfigure an IP whitelist, go too`HKLM\SOFTWARE\Microsoft\AzureMfa` and configure hello following registry value:</span></span> 

| <span data-ttu-id="35f12-141">Name (Název)</span><span class="sxs-lookup"><span data-stu-id="35f12-141">Name</span></span> | <span data-ttu-id="35f12-142">Typ</span><span class="sxs-lookup"><span data-stu-id="35f12-142">Type</span></span> | <span data-ttu-id="35f12-143">Výchozí hodnota</span><span class="sxs-lookup"><span data-stu-id="35f12-143">Default value</span></span> | <span data-ttu-id="35f12-144">Popis</span><span class="sxs-lookup"><span data-stu-id="35f12-144">Description</span></span> |
| ---- | ---- | ------------- | ----------- |
| <span data-ttu-id="35f12-145">IP_WHITELIST</span><span class="sxs-lookup"><span data-stu-id="35f12-145">IP_WHITELIST</span></span> | <span data-ttu-id="35f12-146">Řetězec</span><span class="sxs-lookup"><span data-stu-id="35f12-146">string</span></span> | <span data-ttu-id="35f12-147">prázdný</span><span class="sxs-lookup"><span data-stu-id="35f12-147">Empty</span></span> | <span data-ttu-id="35f12-148">Zadejte středníky oddělený seznam IP adres.</span><span class="sxs-lookup"><span data-stu-id="35f12-148">Provide a semi-colon separated list of IP addresses.</span></span> <span data-ttu-id="35f12-149">Zahrnout hello IP adresy počítačů, kde žádosti o služby mají původ, jako hello server NAS a VPN.</span><span class="sxs-lookup"><span data-stu-id="35f12-149">Include hello IP addresses of machines where service requests originate, like hello NAS/VPN server.</span></span> <span data-ttu-id="35f12-150">Rozsahy IP jsou podsítě nejsou podporovány.</span><span class="sxs-lookup"><span data-stu-id="35f12-150">IP ranges are subnets are not supported.</span></span> <br><br> <span data-ttu-id="35f12-151">Například *10.0.0.1;10.0.0.2;10.0.0.3*.</span><span class="sxs-lookup"><span data-stu-id="35f12-151">For example, *10.0.0.1;10.0.0.2;10.0.0.3*.</span></span>

<span data-ttu-id="35f12-152">Když přijde žádost z IP adresy, která existuje v seznamu povolených IP adres hello, bylo přeskočeno dvoustupňové ověřování.</span><span class="sxs-lookup"><span data-stu-id="35f12-152">When a request comes in from an IP address that exists in hello whitelist, two-step verification is skipped.</span></span> <span data-ttu-id="35f12-153">Hello seznam povolených IP adres se porovná s toohello IP adresu, která je součástí hello *ratNASIPAddress* atribut hello požadavku protokolu RADIUS.</span><span class="sxs-lookup"><span data-stu-id="35f12-153">hello IP whitelist is compared toohello IP address that is provided in hello *ratNASIPAddress* attribute of hello RADIUS request.</span></span> <span data-ttu-id="35f12-154">Pokud požadavku protokolu RADIUS dodává bez hello ratNASIPAddress atribut, zaznamená se hello následující upozornění: "P_WHITE_LIST_WARNING::IP povolených je ignorován jako zdrojové IP adresy chybí v požadavku protokolu RADIUS v atributu NasIpAddress."</span><span class="sxs-lookup"><span data-stu-id="35f12-154">If a RADIUS request comes in without hello ratNASIPAddress attribute, hello following warning is logged: "P_WHITE_LIST_WARNING::IP Whitelist is being ignored as source IP is missing in RADIUS request in NasIpAddress attribute."</span></span>

## <a name="next-steps"></a><span data-ttu-id="35f12-155">Další kroky</span><span class="sxs-lookup"><span data-stu-id="35f12-155">Next steps</span></span>

[<span data-ttu-id="35f12-156">Vyřešte chybové zprávy z hello NPS rozšíření pro Azure Multi-Factor Authentication</span><span class="sxs-lookup"><span data-stu-id="35f12-156">Resolve error messages from hello NPS extension for Azure Multi-Factor Authentication</span></span>](multi-factor-authentication-nps-errors.md)
