---
title: "aaaCreate a nahrání virtuálního pevného disku Linux v Azure"
description: "Další informace toocreate a nahrajte Azure virtuálního pevného disku (VHD) obsahující operační systém Linux."
services: virtual-machines-linux
documentationcenter: 
author: szarkos
manager: timlt
editor: tysonn
tags: azure-resource-manager,azure-service-management
ms.assetid: d351396c-95a0-4092-b7bf-c6aae0bbd112
ms.service: virtual-machines-linux
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-linux
ms.devlang: na
ms.topic: article
ms.date: 02/02/2017
ms.author: szark
ms.openlocfilehash: 208e15c035edb5520fc29ba8e4e71c42b041864d
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="information-for-non-endorsed-distributions"></a><span data-ttu-id="344b7-103">Informace pro neschválené distribuce</span><span class="sxs-lookup"><span data-stu-id="344b7-103">Information for Non-Endorsed Distributions</span></span>
[!INCLUDE [learn-about-deployment-models](../../../includes/learn-about-deployment-models-both-include.md)]

<span data-ttu-id="344b7-104">Hello platformy Azure SLA se vztahuje toovirtual počítačů spuštěných hello operační systém Linux jenom v případě, že je jeden z hello [distribuce schválené](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) se používá.</span><span class="sxs-lookup"><span data-stu-id="344b7-104">hello Azure platform SLA applies toovirtual machines running hello Linux OS only when one of hello [endorsed distributions](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) is used.</span></span> <span data-ttu-id="344b7-105">Distribuce s požadovanou konfigurací hello schválené pro všechny distribuce systému Linux, které jsou k dispozici v hello Azure jsou Galerie obrázků.</span><span class="sxs-lookup"><span data-stu-id="344b7-105">All Linux distributions that are provided in hello Azure image gallery are endorsed distributions with hello required configuration.</span></span>

* [<span data-ttu-id="344b7-106">Distribuce schválené pro Linux ve službě Azure-</span><span class="sxs-lookup"><span data-stu-id="344b7-106">Linux on Azure - Endorsed Distributions</span></span>](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)
* [<span data-ttu-id="344b7-107">Podpora pro Linux obrázků v Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="344b7-107">Support for Linux images in Microsoft Azure</span></span>](https://support.microsoft.com/kb/2941892)

<span data-ttu-id="344b7-108">Všechny distribuce spuštěné v Azure, bude nutné toomeet počet požadavků toohave prvního tooproperly, spusťte na platformě hello.</span><span class="sxs-lookup"><span data-stu-id="344b7-108">All distributions running on Azure will need toomeet a number of prerequisites toohave a chance tooproperly run on hello platform.</span></span>  <span data-ttu-id="344b7-109">Tento článek je komplexní rozhodně není, protože každý distribuční se liší. a je dost možné, že i v případě, že splňujete všechny hello následujících kritérií je stále nutné upravit toosignificantly vaše tooensure systému Linux, který v něm běží správně na platformě hello.</span><span class="sxs-lookup"><span data-stu-id="344b7-109">This article is by no means comprehensive as every distribution is different; and it is quite possible that even if you meet all hello criteria below you will still need toosignificantly tweak your Linux system tooensure that it properly runs on hello platform.</span></span>

<span data-ttu-id="344b7-110">Je z tohoto důvodu, který doporučujeme spouštět některý z našich [Linux na distribuce schválené pro Azure](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) Pokud je to možné.</span><span class="sxs-lookup"><span data-stu-id="344b7-110">It is for this reason that we recommend that you start with one of our [Linux on Azure Endorsed Distributions](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) when possible.</span></span> <span data-ttu-id="344b7-111">Hello následující články vás provede jak tooprepare hello různé schválené distribucí Linux, které jsou podporovány v Azure:</span><span class="sxs-lookup"><span data-stu-id="344b7-111">hello following articles will guide you through how tooprepare hello various endorsed Linux distributions that are supported on Azure:</span></span>

* <span data-ttu-id="344b7-112">**[Na základě centOS distribuce](create-upload-centos.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span><span class="sxs-lookup"><span data-stu-id="344b7-112">**[CentOS-based Distributions](create-upload-centos.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span></span>
* <span data-ttu-id="344b7-113">**[Debian Linux](debian-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span><span class="sxs-lookup"><span data-stu-id="344b7-113">**[Debian Linux](debian-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span></span>
* <span data-ttu-id="344b7-114">**[Oracle Linux](oracle-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span><span class="sxs-lookup"><span data-stu-id="344b7-114">**[Oracle Linux](oracle-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span></span>
* <span data-ttu-id="344b7-115">**[Red Hat Enterprise Linux](redhat-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span><span class="sxs-lookup"><span data-stu-id="344b7-115">**[Red Hat Enterprise Linux](redhat-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span></span>
* <span data-ttu-id="344b7-116">**[SLES & openSUSE](suse-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span><span class="sxs-lookup"><span data-stu-id="344b7-116">**[SLES & openSUSE](suse-create-upload-vhd.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span></span>
* <span data-ttu-id="344b7-117">**[Ubuntu](create-upload-ubuntu.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span><span class="sxs-lookup"><span data-stu-id="344b7-117">**[Ubuntu](create-upload-ubuntu.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)**</span></span>

<span data-ttu-id="344b7-118">Hello zbývající části tohoto článku se soustředí na obecných pokynů pro spuštění distribuční Linux v Azure.</span><span class="sxs-lookup"><span data-stu-id="344b7-118">hello rest of this article will focus on general guidance for running your Linux distribution on Azure.</span></span>

## <a name="general-linux-installation-notes"></a><span data-ttu-id="344b7-119">Poznámky k instalaci obecné Linux</span><span class="sxs-lookup"><span data-stu-id="344b7-119">General Linux Installation Notes</span></span>
* <span data-ttu-id="344b7-120">Formát VHDX Hello není podporován v Azure, pouze **pevný virtuální pevný disk**.</span><span class="sxs-lookup"><span data-stu-id="344b7-120">hello VHDX format is not supported in Azure, only **fixed VHD**.</span></span>  <span data-ttu-id="344b7-121">Můžete převést formát tooVHD hello disku pomocí Správce technologie Hyper-V nebo hello rutiny convert-VHD prostředí.</span><span class="sxs-lookup"><span data-stu-id="344b7-121">You can convert hello disk tooVHD format using Hyper-V Manager or hello convert-vhd cmdlet.</span></span> <span data-ttu-id="344b7-122">Pokud používáte VirtualBox to znamená výběr **pevnou velikost** jako byl proti toohello výchozí přidělí dynamicky při vytváření disku hello.</span><span class="sxs-lookup"><span data-stu-id="344b7-122">If you are using VirtualBox this means selecting **Fixed size** as opposed toohello default dynamically allocated when creating hello disk.</span></span>
* <span data-ttu-id="344b7-123">Azure podporuje pouze virtuální počítače generace 1.</span><span class="sxs-lookup"><span data-stu-id="344b7-123">Azure only supports generation 1 virtual machines.</span></span> <span data-ttu-id="344b7-124">Můžete převést generace 1 virtuálního počítače z formátu souboru virtuálního pevného disku VHDX toohello a dynamicky se zvětšující tooa pevné velikosti disku.</span><span class="sxs-lookup"><span data-stu-id="344b7-124">You can convert a generation 1 virtual machine from VHDX toohello VHD file format and from dynamically expanding tooa fixed sized disk.</span></span> <span data-ttu-id="344b7-125">Ale nemůžete změnit generaci virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="344b7-125">But you can't change a virtual machine's generation.</span></span> <span data-ttu-id="344b7-126">Další informace najdete v tématu [by měl vytvořit virtuální počítač generace 1 nebo 2 v Hyper-V?](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/plan/should-i-create-a-generation-1-or-2-virtual-machine-in-hyper-v)</span><span class="sxs-lookup"><span data-stu-id="344b7-126">For more information, see [Should I create a generation 1 or 2 virtual machine in Hyper-V?](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/plan/should-i-create-a-generation-1-or-2-virtual-machine-in-hyper-v)</span></span>
* <span data-ttu-id="344b7-127">virtuální pevný disk je 1,023 GB Hello maximální velikost povolená pro hello.</span><span class="sxs-lookup"><span data-stu-id="344b7-127">hello maximum size allowed for hello VHD is 1,023 GB.</span></span>
* <span data-ttu-id="344b7-128">Při instalaci systému Linux hello je *doporučená* použít standardní oddíly spíše než LVM (často hello výchozí pro mnoho instalace).</span><span class="sxs-lookup"><span data-stu-id="344b7-128">When installing hello Linux system it is *recommended* that you use standard partitions rather than LVM (often hello default for many installations).</span></span> <span data-ttu-id="344b7-129">Tím se vyhnete LVM název je v konfliktu s klonovaný virtuální počítače, zvlášť pokud disk s operačním systémem někdy potřebuje toobe připojené tooanother identické virtuálního počítače pro řešení potíží.</span><span class="sxs-lookup"><span data-stu-id="344b7-129">This will avoid LVM name conflicts with cloned VMs, particularly if an OS disk ever needs toobe attached tooanother identical VM for troubleshooting.</span></span> <span data-ttu-id="344b7-130">[LVM](configure-lvm.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) nebo [RAID](configure-raid.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) mohou být použity na datové disky.</span><span class="sxs-lookup"><span data-stu-id="344b7-130">[LVM](configure-lvm.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) or [RAID](configure-raid.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) may be used on data disks.</span></span>
* <span data-ttu-id="344b7-131">Vyžaduje se podpora jádra pro připojení systémy souborů UDF.</span><span class="sxs-lookup"><span data-stu-id="344b7-131">Kernel support for mounting UDF file systems is required.</span></span> <span data-ttu-id="344b7-132">Při prvním spuštění v Azure hello je předána zřizování konfigurace toohello virtuálního počítače s Linuxem pomocí formátu UDF média, který je připojený toohello hosta.</span><span class="sxs-lookup"><span data-stu-id="344b7-132">At first boot on Azure hello provisioning configuration is passed toohello Linux VM via UDF-formatted media that is attached toohello guest.</span></span> <span data-ttu-id="344b7-133">Hello Azure Linux agent musí být schopný toomount hello UDF soubor systému tooread své konfiguraci a zřídit hello virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="344b7-133">hello Azure Linux agent must be able toomount hello UDF file system tooread its configuration and provision hello VM.</span></span>
* <span data-ttu-id="344b7-134">Verze jádra Linux pod 2.6.37 nepodporují NUMA v technologii Hyper-V s větší velikostí virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="344b7-134">Linux kernel versions below 2.6.37 do not support NUMA on Hyper-V with larger VM sizes.</span></span> <span data-ttu-id="344b7-135">-Li tento problém ovlivňuje především starší distribuce pomocí hello proti proudu Red Hat 2.6.32 jádra která byla opravena v RHEL 6.6 (jádra 2.6.32 504).</span><span class="sxs-lookup"><span data-stu-id="344b7-135">This issue primarily impacts older distributions using hello upstream Red Hat 2.6.32 kernel, and was fixed in RHEL 6.6 (kernel-2.6.32-504).</span></span> <span data-ttu-id="344b7-136">Systémy s operačním systémem vlastní jádra starší než 2.6.37 nebo na základě RHEL jádra starší, než se musí nastavit 2.6.32-504 hello parametr spouštěcího `numa=off` na příkazového řádku v grub.conf hello jádra.</span><span class="sxs-lookup"><span data-stu-id="344b7-136">Systems running custom kernels older than 2.6.37, or RHEL-based kernels older than 2.6.32-504 must set hello boot parameter `numa=off` on hello kernel command-line in grub.conf.</span></span> <span data-ttu-id="344b7-137">Další informace najdete v části Red Hat [KB 436883](https://access.redhat.com/solutions/436883).</span><span class="sxs-lookup"><span data-stu-id="344b7-137">For more information see Red Hat [KB 436883](https://access.redhat.com/solutions/436883).</span></span>
* <span data-ttu-id="344b7-138">Nekonfigurujte přepnutí oddílu na disku operačního systému hello.</span><span class="sxs-lookup"><span data-stu-id="344b7-138">Do not configure a swap partition on hello OS disk.</span></span> <span data-ttu-id="344b7-139">Hello Linux agent může být nakonfigurované toocreate odkládací soubor na disku hello dočasných prostředků.</span><span class="sxs-lookup"><span data-stu-id="344b7-139">hello Linux agent can be configured toocreate a swap file on hello temporary resource disk.</span></span>  <span data-ttu-id="344b7-140">Další informace o této naleznete v následujících kroků hello.</span><span class="sxs-lookup"><span data-stu-id="344b7-140">More information about this can be found in hello steps below.</span></span>
* <span data-ttu-id="344b7-141">Všechny virtuální pevné disky hello musí mít velikostí, které jsou násobky 1 MB.</span><span class="sxs-lookup"><span data-stu-id="344b7-141">All of hello VHDs must have sizes that are multiples of 1 MB.</span></span>

### <a name="installing-kernel-modules-without-hyper-v"></a><span data-ttu-id="344b7-142">Instalace modulů jádra bez technologie Hyper-V</span><span class="sxs-lookup"><span data-stu-id="344b7-142">Installing kernel modules without Hyper-V</span></span>
<span data-ttu-id="344b7-143">Azure je spuštěná na hypervisoru hello technologie Hyper-V, takže Linux vyžaduje, aby určité jádra moduly jsou nainstalovány v pořadí toorun v Azure.</span><span class="sxs-lookup"><span data-stu-id="344b7-143">Azure runs on hello Hyper-V hypervisor, so Linux requires that certain kernel modules are installed in order toorun in Azure.</span></span> <span data-ttu-id="344b7-144">Pokud máte virtuální počítač, který se vytvořil mimo technologie Hyper-V, instalačních programů Linux hello nesmí obsahovat hello ovladače pro Hyper-V v hello počáteční disku paměti RAM (initrd nebo initramfs) Pokud zjistí, zda je spuštěna prostředí Hyper-V.</span><span class="sxs-lookup"><span data-stu-id="344b7-144">If you have a VM that was created outside of Hyper-V, hello Linux installers may not include hello drivers for Hyper-V in hello initial ramdisk (initrd or initramfs) unless it detects that it is running an a Hyper-V environment.</span></span> <span data-ttu-id="344b7-145">Při použití tooprepare systému (tj. Virtualbox, KVM atd.) jiným virtualizačním bitové kopie systému Linux, musíte toorebuild hello initrd tooensure, který alespoň hello `hv_vmbus` a `hv_storvsc` jádra moduly jsou k dispozici na počáteční disku paměti RAM hello.</span><span class="sxs-lookup"><span data-stu-id="344b7-145">When using a different virtualization system (i.e. Virtualbox, KVM, etc.) tooprepare your Linux image, you may need toorebuild hello initrd tooensure that at least hello `hv_vmbus` and `hv_storvsc` kernel modules are available on hello initial ramdisk.</span></span>  <span data-ttu-id="344b7-146">Jde o známý problém alespoň na systémy založené na nadřazený distribuční Red Hat hello.</span><span class="sxs-lookup"><span data-stu-id="344b7-146">This is a known issue at least on systems based on hello upstream Red Hat distribution.</span></span>

<span data-ttu-id="344b7-147">Hello mechanismus pro nové sestavení hello initrd nebo initramfs image může lišit v závislosti na distribuční hello.</span><span class="sxs-lookup"><span data-stu-id="344b7-147">hello mechanism for rebuilding hello initrd or initramfs image may vary depending on hello distribution.</span></span> <span data-ttu-id="344b7-148">Projděte si dokumentaci k vaší distribuční nebo podporu pro správné postup hello.</span><span class="sxs-lookup"><span data-stu-id="344b7-148">Please consult your distribution's documentation or support for hello proper procedure.</span></span>  <span data-ttu-id="344b7-149">Tady je jeden příklad, jak toorebuild hello initrd pomocí hello `mkinitrd` nástroj:</span><span class="sxs-lookup"><span data-stu-id="344b7-149">Here is one example for how toorebuild hello initrd using hello `mkinitrd` utility:</span></span>

<span data-ttu-id="344b7-150">Nejprve Zálohujte stávající image initrd hello:</span><span class="sxs-lookup"><span data-stu-id="344b7-150">First, back up hello existing initrd image:</span></span>

    # cd /boot
    # sudo cp initrd-`uname -r`.img  initrd-`uname -r`.img.bak

<span data-ttu-id="344b7-151">V dalším kroku znovu sestavit hello initrd s hello `hv_vmbus` a `hv_storvsc` moduly jádra:</span><span class="sxs-lookup"><span data-stu-id="344b7-151">Next, rebuild hello initrd with hello `hv_vmbus` and `hv_storvsc` kernel modules:</span></span>

    # sudo mkinitrd --preload=hv_storvsc --preload=hv_vmbus -v -f initrd-`uname -r`.img `uname -r`


### <a name="resizing-vhds"></a><span data-ttu-id="344b7-152">Změna velikosti virtuálních pevných disků</span><span class="sxs-lookup"><span data-stu-id="344b7-152">Resizing VHDs</span></span>
<span data-ttu-id="344b7-153">Image virtuálního pevného disku na Azure musí mít virtuální velikost zarovnán too1MB.</span><span class="sxs-lookup"><span data-stu-id="344b7-153">VHD images on Azure must have a virtual size aligned too1MB.</span></span>  <span data-ttu-id="344b7-154">Obvykle virtuální pevné disky vytvořené pomocí technologie Hyper-V už zarovnání správně.</span><span class="sxs-lookup"><span data-stu-id="344b7-154">Typically, VHDs created using Hyper-V should already be aligned correctly.</span></span>  <span data-ttu-id="344b7-155">Pokud hello virtuálního pevného disku není zarovnána správně, může dostat k chybě zprávy podobné toohello následující pokusíte-li toocreate *image* z vaší virtuálního pevného disku:</span><span class="sxs-lookup"><span data-stu-id="344b7-155">If hello VHD is not aligned correctly then you may receive an error message similar toohello following when you attempt toocreate an *image* from your VHD:</span></span>

    "hello VHD http://<mystorageaccount>.blob.core.windows.net/vhds/MyLinuxVM.vhd has an unsupported virtual size of 21475270656 bytes. hello size must be a whole number (in MBs).”

<span data-ttu-id="344b7-156">tooremedy toto můžete změnit velikost virtuálního počítače pomocí konzoly Správce technologie Hyper-V hello nebo hello hello [změny velikosti virtuálního pevného disku](http://technet.microsoft.com/library/hh848535.aspx) rutiny prostředí Powershell.</span><span class="sxs-lookup"><span data-stu-id="344b7-156">tooremedy this you can resize hello VM using either hello Hyper-V Manager console or hello [Resize-VHD](http://technet.microsoft.com/library/hh848535.aspx) Powershell cmdlet.</span></span>  <span data-ttu-id="344b7-157">Pokud používáte v prostředí systému Windows se doporučuje toouse qemu img tooconvert (v případě potřeby) a změňte velikost hello virtuálního pevného disku.</span><span class="sxs-lookup"><span data-stu-id="344b7-157">If you are not running in a Windows environment then it is recommended toouse qemu-img tooconvert (if needed) and resize hello VHD.</span></span>

> [!NOTE]
> <span data-ttu-id="344b7-158">Je známého problému v qemu img verze > = 2.2.1, jejímž výsledkem nesprávně naformátovaný VHD.</span><span class="sxs-lookup"><span data-stu-id="344b7-158">There is a known bug in qemu-img versions >=2.2.1 that results in an improperly formatted VHD.</span></span> <span data-ttu-id="344b7-159">ve verzi 2.6 QEMU byl opraven problém Hello.</span><span class="sxs-lookup"><span data-stu-id="344b7-159">hello issue has been fixed in QEMU 2.6.</span></span> <span data-ttu-id="344b7-160">Je doporučeno toouse qemu-img 2.2.0 nebo nižší nebo aktualizace too2.6 nebo vyšší.</span><span class="sxs-lookup"><span data-stu-id="344b7-160">It is recommended toouse either qemu-img 2.2.0 or lower, or update too2.6 or higher.</span></span> <span data-ttu-id="344b7-161">Referenční dokumentace: https://bugs.launchpad.net/qemu/+bug/1490611.</span><span class="sxs-lookup"><span data-stu-id="344b7-161">Reference: https://bugs.launchpad.net/qemu/+bug/1490611.</span></span>
> 
> 

1. <span data-ttu-id="344b7-162">Změna velikosti virtuálního pevného disku přímo pomocí nástrojů, jako hello `qemu-img` nebo `vbox-manage` může mít za následek nelze spustit VHD.</span><span class="sxs-lookup"><span data-stu-id="344b7-162">Resizing hello VHD directly using tools such as `qemu-img` or `vbox-manage` may result in an unbootable VHD.</span></span>  <span data-ttu-id="344b7-163">Proto se doporučuje toofirst převést hello image NEZPRACOVANÁ disku tooa virtuálního pevného disku.</span><span class="sxs-lookup"><span data-stu-id="344b7-163">So it is recommended toofirst convert hello VHD tooa RAW disk image.</span></span>  <span data-ttu-id="344b7-164">Pokud hello image virtuálního počítače byla již vytvořena jako image NEZPRACOVANÁ disku (hello výchozí nastavení pro některé hypervisory například KVM) může tento krok přeskočit:</span><span class="sxs-lookup"><span data-stu-id="344b7-164">If hello VM image was already created as RAW disk image (hello default for some Hypervisors such as KVM) then you may skip this step:</span></span>
   
       # qemu-img convert -f vpc -O raw MyLinuxVM.vhd MyLinuxVM.raw

2. <span data-ttu-id="344b7-165">Vypočítejte velikost hello tooensure bitové kopie disku, který hello virtuální velikost je zarovnaný too1MB požadované hello.</span><span class="sxs-lookup"><span data-stu-id="344b7-165">Calculate hello required size of hello disk image tooensure that hello virtual size is aligned too1MB.</span></span>  <span data-ttu-id="344b7-166">s tím pomůže Hello následující skript prostředí bash.</span><span class="sxs-lookup"><span data-stu-id="344b7-166">hello following bash shell script can assist with this.</span></span>  <span data-ttu-id="344b7-167">skript Hello používá "`qemu-img info`" toodetermine hello virtuální velikost bitové kopie disku hello a pak vypočítá velikost toohello hello další 1 MB:</span><span class="sxs-lookup"><span data-stu-id="344b7-167">hello script uses "`qemu-img info`" toodetermine hello virtual size of hello disk image and then calculates hello size toohello next 1MB:</span></span>
   
       rawdisk="MyLinuxVM.raw"
       vhddisk="MyLinuxVM.vhd"
   
       MB=$((1024*1024))
       size=$(qemu-img info -f raw --output json "$rawdisk" | \
              gawk 'match($0, /"virtual-size": ([0-9]+),/, val) {print val[1]}')
   
       rounded_size=$((($size/$MB + 1)*$MB))
       echo "Rounded Size = $rounded_size"

3. <span data-ttu-id="344b7-168">Změna velikosti hello nezpracovaná disku pomocí $rounded_size jako sada v hello výše skriptu:</span><span class="sxs-lookup"><span data-stu-id="344b7-168">Resize hello raw disk using $rounded_size as set in hello above script:</span></span>
   
       # qemu-img resize MyLinuxVM.raw $rounded_size

4. <span data-ttu-id="344b7-169">Nyní, převést zpět tooa hello NEZPRACOVANÁ disku pevné velikosti virtuálního pevného disku:</span><span class="sxs-lookup"><span data-stu-id="344b7-169">Now, convert hello RAW disk back tooa fixed-size VHD:</span></span>
   
       # qemu-img convert -f raw -o subformat=fixed -O vpc MyLinuxVM.raw MyLinuxVM.vhd

   <span data-ttu-id="344b7-170">Nebo s verzí qemu **2.6 +** zahrnují hello `force_size` možnost:</span><span class="sxs-lookup"><span data-stu-id="344b7-170">Or, with qemu version **2.6+** include hello `force_size` option:</span></span>

       # qemu-img convert -f raw -o subformat=fixed,force_size -O vpc MyLinuxVM.raw MyLinuxVM.vhd

## <a name="linux-kernel-requirements"></a><span data-ttu-id="344b7-171">Požadavky na Linux jádra</span><span class="sxs-lookup"><span data-stu-id="344b7-171">Linux Kernel Requirements</span></span>
<span data-ttu-id="344b7-172">Hello Linux integrační služby (LIS) ovladače pro Hyper-V a Azure jsou podílí přímo toohello nadřazeného Linux jádra.</span><span class="sxs-lookup"><span data-stu-id="344b7-172">hello Linux Integration Services (LIS) drivers for Hyper-V and Azure are contributed directly toohello upstream Linux kernel.</span></span> <span data-ttu-id="344b7-173">Velkém množství distribucí, které obsahují nejnovější verzi jádra Linux (tj. 3.x) bude již je k dispozici tyto ovladače, nebo v opačném případě zadejte přeneseny zpět verze těchto ovladačů s jejich jádra.</span><span class="sxs-lookup"><span data-stu-id="344b7-173">Many distributions that include a recent Linux kernel version (i.e. 3.x) will have these drivers available already, or otherwise provide backported versions of these drivers with their kernels.</span></span>  <span data-ttu-id="344b7-174">Tyto ovladače jsou neustále aktualizován v hello nadřazeného jádra s nové opravy a funkce, takže pokud je to možné, doporučujeme toorun [schválené distribuční](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) který bude obsahovat tyto opravy a aktualizace.</span><span class="sxs-lookup"><span data-stu-id="344b7-174">These drivers are constantly being updated in hello upstream kernel with new fixes and features, so when possible it is recommended toorun an [endorsed distribution](endorsed-distros.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) that will include these fixes and updates.</span></span>

<span data-ttu-id="344b7-175">Pokud používáte hodnotu typu variant Red Hat Enterprise Linux verze **6.0 6.3**, bude nutné tooinstall hello nejnovější ovladače LIS pro Hyper-V.</span><span class="sxs-lookup"><span data-stu-id="344b7-175">If you are running a variant of Red Hat Enterprise Linux versions **6.0-6.3**, then you will need tooinstall hello latest LIS drivers for Hyper-V.</span></span> <span data-ttu-id="344b7-176">Hello ovladače lze nalézt [v tomto umístění](http://go.microsoft.com/fwlink/p/?LinkID=254263&clcid=0x409).</span><span class="sxs-lookup"><span data-stu-id="344b7-176">hello drivers can be found [at this location](http://go.microsoft.com/fwlink/p/?LinkID=254263&clcid=0x409).</span></span> <span data-ttu-id="344b7-177">Od systému RHEL **6.4 +** (a odvozené konfigurace) ovladače hello LIS jsou již součástí hello jádra a proto žádné další instalační balíčky jsou potřebné toorun tyto systémy v Azure.</span><span class="sxs-lookup"><span data-stu-id="344b7-177">As of RHEL **6.4+** (and derivatives) hello LIS drivers are already included with hello kernel and so no additional installation packages are needed toorun those systems on Azure.</span></span>

<span data-ttu-id="344b7-178">Pokud se vyžaduje vlastní jádra, je doporučeno toouse novější verzi jádra (tj. **3.8 +**).</span><span class="sxs-lookup"><span data-stu-id="344b7-178">If a custom kernel is required, it is recommended toouse a more recent kernel version (i.e. **3.8+**).</span></span> <span data-ttu-id="344b7-179">Pro tyto distribuce nebo dodavatelů, kteří spravují své vlastní jádra budou některé úsilí požadované tooregularly backport hello LIS ovladače z hello nadřazeného jádra tooyour vlastní jádra.</span><span class="sxs-lookup"><span data-stu-id="344b7-179">For those distributions or vendors who maintain their own kernel, some effort will be required tooregularly backport hello LIS drivers from hello upstream kernel tooyour custom kernel.</span></span>  <span data-ttu-id="344b7-180">I když už používáte relativně nejnovější verzi jádra, doporučujeme, že tookeep sledování všech proti proudu opravy v hello LIS ovladače a backport ty podle potřeby.</span><span class="sxs-lookup"><span data-stu-id="344b7-180">Even if you are already running a relatively recent kernel version, it is highly recommended tookeep track of any upstream fixes in hello LIS drivers and backport those as needed.</span></span> <span data-ttu-id="344b7-181">Hello umístění zdrojových souborů ovladačů LIS hello je k dispozici v hello [údržby programu](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/tree/MAINTAINERS) soubor ve stromu zdroje jádra Linux hello:</span><span class="sxs-lookup"><span data-stu-id="344b7-181">hello location of hello LIS driver source files is available in hello [MAINTAINERS](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/tree/MAINTAINERS) file in hello Linux kernel source tree:</span></span>

    F:    arch/x86/include/asm/mshyperv.h
    F:    arch/x86/include/uapi/asm/hyperv.h
    F:    arch/x86/kernel/cpu/mshyperv.c
    F:    drivers/hid/hid-hyperv.c
    F:    drivers/hv/
    F:    drivers/input/serio/hyperv-keyboard.c
    F:    drivers/net/hyperv/
    F:    drivers/scsi/storvsc_drv.c
    F:    drivers/video/fbdev/hyperv_fb.c
    F:    include/linux/hyperv.h
    F:    tools/hv/

<span data-ttu-id="344b7-182">Na velmi minimální hello absenci hello následující opravy měla být známa toocause problémy v Azure a tak tyto musí být součástí hello jádra.</span><span class="sxs-lookup"><span data-stu-id="344b7-182">At a very minimum, hello absence of hello following patches have been known toocause problems on Azure and so these must be included in hello kernel.</span></span> <span data-ttu-id="344b7-183">Tento seznam je rozhodně není vyčerpávající nebo úplný pro všechny distribuce:</span><span class="sxs-lookup"><span data-stu-id="344b7-183">This list is by no means exhaustive or complete for all distributions:</span></span>

* [<span data-ttu-id="344b7-184">ata_piix: ve výchozím nastavení odložené ovladače disky toohello technologie Hyper-V</span><span class="sxs-lookup"><span data-stu-id="344b7-184">ata_piix: defer disks toohello Hyper-V drivers by default</span></span>](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/drivers/ata/ata_piix.c?id=cd006086fa5d91414d8ff9ff2b78fbb593878e3c)
* [<span data-ttu-id="344b7-185">miniport storvsc: účet pro pakety na cestě v cestě RESETOVÁNÍ hello</span><span class="sxs-lookup"><span data-stu-id="344b7-185">storvsc: Account for in-transit packets in hello RESET path</span></span>](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/drivers/scsi/storvsc_drv.c?id=5c1b10ab7f93d24f29b5630286e323d1c5802d5c)
* [<span data-ttu-id="344b7-186">miniport storvsc: Vyhněte se použití WRITE_SAME</span><span class="sxs-lookup"><span data-stu-id="344b7-186">storvsc: avoid usage of WRITE_SAME</span></span>](https://git.kernel.org/cgit/linux/kernel/git/next/linux-next.git/commit/drivers/scsi/storvsc_drv.c?id=3e8f4f4065901c8dfc51407e1984495e1748c090)
* [<span data-ttu-id="344b7-187">miniport storvsc: zakázat zápis stejné diskového pole RAID a ovladače adaptéru virtuální hostitel</span><span class="sxs-lookup"><span data-stu-id="344b7-187">storvsc: Disable WRITE SAME for RAID and virtual host adapter drivers</span></span>](https://git.kernel.org/cgit/linux/kernel/git/next/linux-next.git/commit/drivers/scsi/storvsc_drv.c?id=54b2b50c20a61b51199bedb6e5d2f8ec2568fb43)
* [<span data-ttu-id="344b7-188">miniport storvsc: oprava zrušení ukazatele NULL.</span><span class="sxs-lookup"><span data-stu-id="344b7-188">storvsc: NULL pointer dereference fix</span></span>](https://git.kernel.org/cgit/linux/kernel/git/next/linux-next.git/commit/drivers/scsi/storvsc_drv.c?id=b12bb60d6c350b348a4e1460cd68f97ccae9822e)
* [<span data-ttu-id="344b7-189">miniport storvsc: selhání prstenec vyrovnávací paměti může vést k zablokování vstupně-výstupních operací</span><span class="sxs-lookup"><span data-stu-id="344b7-189">storvsc: ring buffer failures may result in I/O freeze</span></span>](https://git.kernel.org/cgit/linux/kernel/git/next/linux-next.git/commit/drivers/scsi/storvsc_drv.c?id=e86fb5e8ab95f10ec5f2e9430119d5d35020c951)
* [<span data-ttu-id="344b7-190">scsi_sysfs: ochranu proti dvojité provádění __scsi_remove_device</span><span class="sxs-lookup"><span data-stu-id="344b7-190">scsi_sysfs: protect against double execution of __scsi_remove_device</span></span>](https://git.kernel.org/cgit/linux/kernel/git/next/linux-next.git/commit/drivers/scsi/scsi_sysfs.c?id=be821fd8e62765de43cc4f0e2db363d0e30a7e9b)

## <a name="hello-azure-linux-agent"></a><span data-ttu-id="344b7-191">Hello Azure Linux Agent</span><span class="sxs-lookup"><span data-stu-id="344b7-191">hello Azure Linux Agent</span></span>
<span data-ttu-id="344b7-192">Hello [Azure Linux Agent](../windows/agent-user-guide.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) (příkaz waagent) se vyžaduje tooproperly zřídit virtuální počítač s Linuxem v Azure.</span><span class="sxs-lookup"><span data-stu-id="344b7-192">hello [Azure Linux Agent](../windows/agent-user-guide.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json) (waagent) is required tooproperly provision a Linux virtual machine in Azure.</span></span> <span data-ttu-id="344b7-193">Můžete získat nejnovější verzi hello, soubor problémy nebo odeslání žádosti o přijetí změn v hello [úložiště GitHub agenta Linux](https://github.com/Azure/WALinuxAgent).</span><span class="sxs-lookup"><span data-stu-id="344b7-193">You can get hello latest version, file issues or submit pull requests at hello [Linux Agent GitHub repo](https://github.com/Azure/WALinuxAgent).</span></span>

* <span data-ttu-id="344b7-194">v rámci Apache 2.0 hello licence vydání Hello Linux agent.</span><span class="sxs-lookup"><span data-stu-id="344b7-194">hello Linux agent is released under hello Apache 2.0 license.</span></span> <span data-ttu-id="344b7-195">Velkém množství distribucí již zadejte ot. / min nebo bázi deb balíčky pro hello agenta, a proto v některých případech to lze nainstalovat a aktualizovat s malým množstvím úsilí.</span><span class="sxs-lookup"><span data-stu-id="344b7-195">Many distributions already provide RPM or deb packages for hello agent, and so in some cases this can be installed and updated with little effort.</span></span>
* <span data-ttu-id="344b7-196">Hello Azure Linux Agent vyžaduje Python v2.6 +.</span><span class="sxs-lookup"><span data-stu-id="344b7-196">hello Azure Linux Agent requires Python v2.6+.</span></span>
* <span data-ttu-id="344b7-197">Hello agent také vyžaduje modul python pyasn1 hello.</span><span class="sxs-lookup"><span data-stu-id="344b7-197">hello agent also requires hello python-pyasn1 module.</span></span> <span data-ttu-id="344b7-198">Většina distribuce to zadejte jako samostatný balíček, který může být instalován.</span><span class="sxs-lookup"><span data-stu-id="344b7-198">Most distributions provide this as a separate package that can be installed.</span></span>
* <span data-ttu-id="344b7-199">V některých případech nemusí být kompatibilní s NetworkManager hello Azure Linux Agent.</span><span class="sxs-lookup"><span data-stu-id="344b7-199">In some cases hello Azure Linux Agent may not be compatible with NetworkManager.</span></span> <span data-ttu-id="344b7-200">Mnoho balíčků RPM/bázi Deb hello poskytované distribuce nakonfigurujte NetworkManager jako balíček příkaz waagent toohello konflikt a proto odinstaluje NetworkManager při instalaci balíčku agenta Linux hello.</span><span class="sxs-lookup"><span data-stu-id="344b7-200">Many of hello RPM/Deb packages provided by distributions configure NetworkManager as a conflict toohello waagent package, and thus will uninstall NetworkManager when you install hello Linux agent package.</span></span>

## <a name="general-linux-system-requirements"></a><span data-ttu-id="344b7-201">Požadavky na systém Linux obecné</span><span class="sxs-lookup"><span data-stu-id="344b7-201">General Linux System Requirements</span></span>

* <span data-ttu-id="344b7-202">Upravte hello jádra spouštěcí řádku GRUB nebo GRUB2 tooinclude hello následující parametry.</span><span class="sxs-lookup"><span data-stu-id="344b7-202">Modify hello kernel boot line in GRUB or GRUB2 tooinclude hello following parameters.</span></span> <span data-ttu-id="344b7-203">To také zajistí, všechny zprávy konzoly jsou odesílány toohello první sériového portu, který může být užitečné Azure podporu pro ladění problémů:</span><span class="sxs-lookup"><span data-stu-id="344b7-203">This will also ensure all console messages are sent toohello first serial port, which can assist Azure support with debugging issues:</span></span>
  
        console=ttyS0,115200n8 earlyprintk=ttyS0,115200 rootdelay=300
  
    <span data-ttu-id="344b7-204">To také zajistí, všechny zprávy konzoly jsou odesílány toohello první sériového portu, který může být užitečné Azure podporu pro ladění problémů.</span><span class="sxs-lookup"><span data-stu-id="344b7-204">This will also ensure all console messages are sent toohello first serial port, which can assist Azure support with debugging issues.</span></span>
  
    <span data-ttu-id="344b7-205">Kromě výše uvedených toohello, se doporučuje příliš*odebrat* hello následující parametry, pokud existují:</span><span class="sxs-lookup"><span data-stu-id="344b7-205">In addition toohello above, it is recommended too*remove* hello following parameters if they exist:</span></span>
  
        rhgb quiet crashkernel=auto
  
    <span data-ttu-id="344b7-206">Grafické a quiet spouštěcí nejsou užitečné při cloudovém prostředí, kde chceme, aby všechny protokoly toobe hello odeslané toohello sériového portu.</span><span class="sxs-lookup"><span data-stu-id="344b7-206">Graphical and quiet boot are not useful in a cloud environment where we want all hello logs toobe sent toohello serial port.</span></span> <span data-ttu-id="344b7-207">Hello `crashkernel` možnost může být vlevo nakonfigurované v případě potřeby, ale Všimněte si, že tento parametr se sníží hello množství dostupné paměti v hello virtuální počítač podle 128 MB nebo víc, což může být problematické hello menší velikostí virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="344b7-207">hello `crashkernel` option may be left configured if desired, but note that this parameter will reduce hello amount of available memory in hello VM by 128MB or more, which may be problematic on hello smaller VM sizes.</span></span>

* <span data-ttu-id="344b7-208">Instalace hello Azure Linux Agent</span><span class="sxs-lookup"><span data-stu-id="344b7-208">Installing hello Azure Linux Agent</span></span>
  
    <span data-ttu-id="344b7-209">Hello Azure Linux Agent je požadované pro zřizování Linux image na platformě Azure.</span><span class="sxs-lookup"><span data-stu-id="344b7-209">hello Azure Linux Agent is required for provisioning a Linux image on Azure.</span></span>  <span data-ttu-id="344b7-210">Velkém množství distribucí zadejte hello agenta jako balíček RPM nebo bázi Deb (hello balíčku se obvykle označuje jako 'WALinuxAgent' nebo 'walinuxagent').</span><span class="sxs-lookup"><span data-stu-id="344b7-210">Many distributions provide hello agent as an RPM or Deb package (hello package is typically called 'WALinuxAgent' or 'walinuxagent').</span></span>  <span data-ttu-id="344b7-211">Hello lze také nainstalovat agenta ručně pomocí následujících kroků hello v hello [Linux Agent průvodce](../windows/agent-user-guide.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="344b7-211">hello agent can also be installed manually by following hello steps in hello [Linux Agent Guide](../windows/agent-user-guide.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span></span>

* <span data-ttu-id="344b7-212">Ujistěte se, že server SSH hello je nainstalován a nakonfigurován toostart při spuštění.</span><span class="sxs-lookup"><span data-stu-id="344b7-212">Ensure that hello SSH server is installed and configured toostart at boot time.</span></span>  <span data-ttu-id="344b7-213">Je to obvykle výchozí hello.</span><span class="sxs-lookup"><span data-stu-id="344b7-213">This is usually hello default.</span></span>

* <span data-ttu-id="344b7-214">Nevytvářejte odkládacího prostoru na disku operačního systému hello</span><span class="sxs-lookup"><span data-stu-id="344b7-214">Do not create swap space on hello OS disk</span></span>
  
    <span data-ttu-id="344b7-215">Hello Azure Linux Agent mohou automaticky konfigurovat odkládacího souboru pomocí disku hello místní prostředek, který je připojený toohello virtuálních počítačů po zřízení v Azure.</span><span class="sxs-lookup"><span data-stu-id="344b7-215">hello Azure Linux Agent can automatically configure swap space using hello local resource disk that is attached toohello VM after provisioning on Azure.</span></span> <span data-ttu-id="344b7-216">Všimněte si, je tento disk hello místní prostředek *dočasné* na disku a může být vyprázdnit po deprovisioned hello virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="344b7-216">Note that hello local resource disk is a *temporary* disk, and might be emptied when hello VM is deprovisioned.</span></span> <span data-ttu-id="344b7-217">Po instalaci hello Azure Linux Agent (viz předchozí krok), upravte hello následující parametry v /etc/waagent.conf odpovídajícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="344b7-217">After installing hello Azure Linux Agent (see previous step), modify hello following parameters in /etc/waagent.conf appropriately:</span></span>
  
        ResourceDisk.Format=y
        ResourceDisk.Filesystem=ext4
        ResourceDisk.MountPoint=/mnt/resource
        ResourceDisk.EnableSwap=y
        ResourceDisk.SwapSizeMB=2048    ## NOTE: set this toowhatever you need it toobe.

* <span data-ttu-id="344b7-218">V posledním kroku spusťte následující příkazy toodeprovision hello virtuálního počítače hello:</span><span class="sxs-lookup"><span data-stu-id="344b7-218">As a final step, run hello following commands toodeprovision hello virtual machine:</span></span>
  
        # sudo waagent -force -deprovision
        # export HISTSIZE=0
        # logout
  
  > [!NOTE]
  > <span data-ttu-id="344b7-219">Na Virtualbox mohou se zobrazit následující chyba po spuštění hello se příkaz waagent-force - deprovision.: `[Errno 5] Input/output error`.</span><span class="sxs-lookup"><span data-stu-id="344b7-219">On Virtualbox you may see hello following error after running 'waagent -force -deprovision': `[Errno 5] Input/output error`.</span></span> <span data-ttu-id="344b7-220">Tato chybová zpráva není příliš důležitý a můžete ignorovat.</span><span class="sxs-lookup"><span data-stu-id="344b7-220">This error message is not critical and can be ignored.</span></span>
  > 
  > 

* <span data-ttu-id="344b7-221">Pak bude nutné tooshut dolů hello virtuálního počítače a nahrajte tooAzure hello virtuálního pevného disku.</span><span class="sxs-lookup"><span data-stu-id="344b7-221">You will then need tooshut down hello virtual machine and upload hello VHD tooAzure.</span></span>

