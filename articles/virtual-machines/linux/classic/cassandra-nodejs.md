---
title: aaaRun Cassandra s Linuxem v Azure | Microsoft Docs
description: "Jak toorun Cassandra clusteru v systému Linux v Azure Virtual Machines z aplikace Node.js"
services: virtual-machines-linux
documentationcenter: nodejs
author: tomarcher
manager: routlaw
editor: 
tags: azure-service-management
ms.assetid: 30de1f29-e97d-492f-ae34-41ec83488de0
ms.service: virtual-machines-linux
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-linux
ms.devlang: na
ms.topic: article
ms.date: 08/17/2017
ms.author: tarcher
ms.openlocfilehash: 381ca301bbe88d3740cf182f9c44fada5b9ba7cc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="running-cassandra-with-linux-on-azure-and-accessing-it-from-nodejs"></a><span data-ttu-id="5510f-103">Spuštění Cassandry s Linuxem v Azure a přístup pomocí Node.js</span><span class="sxs-lookup"><span data-stu-id="5510f-103">Running Cassandra with Linux on Azure and Accessing it from Node.js</span></span>
> [!IMPORTANT] 
> <span data-ttu-id="5510f-104">Azure má dva různé modely nasazení pro vytváření a práci s prostředky: [Resource Manager a klasický](../../../resource-manager-deployment-model.md).</span><span class="sxs-lookup"><span data-stu-id="5510f-104">Azure has two different deployment models for creating and working with resources: [Resource Manager and Classic](../../../resource-manager-deployment-model.md).</span></span> <span data-ttu-id="5510f-105">Tento článek se zabývá pomocí modelu nasazení Classic hello.</span><span class="sxs-lookup"><span data-stu-id="5510f-105">This article covers using hello Classic deployment model.</span></span> <span data-ttu-id="5510f-106">Společnost Microsoft doporučuje, aby většina nových nasazení používala model Resource Manager hello.</span><span class="sxs-lookup"><span data-stu-id="5510f-106">Microsoft recommends that most new deployments use hello Resource Manager model.</span></span> <span data-ttu-id="5510f-107">Zobrazit šablony Resource Manageru pro [Datastax Enterprise](https://azure.microsoft.com/documentation/templates/datastax) a [Spark clusteru a Cassandra na CentOS](https://azure.microsoft.com/documentation/templates/spark-and-cassandra-on-centos/).</span><span class="sxs-lookup"><span data-stu-id="5510f-107">See Resource Manager templates for [Datastax Enterprise](https://azure.microsoft.com/documentation/templates/datastax) and [Spark cluster and Cassandra on CentOS](https://azure.microsoft.com/documentation/templates/spark-and-cassandra-on-centos/).</span></span>

## <a name="overview"></a><span data-ttu-id="5510f-108">Přehled</span><span class="sxs-lookup"><span data-stu-id="5510f-108">Overview</span></span>
<span data-ttu-id="5510f-109">Microsoft Azure je platforma otevřete cloudu, která spouští obou Microsoft jako i v jiných společností než Microsoft software, který zahrnuje operační systémy, aplikační servery, zasílání zpráv middleware, jakož i databází SQL a NoSQL z obou modelů komerční s otevřeným zdrojem.</span><span class="sxs-lookup"><span data-stu-id="5510f-109">Microsoft Azure is an open cloud platform that runs both Microsoft as well as non-Microsoft software which  includes operating systems, application servers, messaging middleware as well as SQL and NoSQL databases from both commercial and open source models.</span></span> <span data-ttu-id="5510f-110">Vytváření odolné služeb na veřejných cloudů, včetně Azure vyžaduje pečlivé plánování a architektura záměrné pro oba servery aplikace jako dobře úložiště vrstvy.</span><span class="sxs-lookup"><span data-stu-id="5510f-110">Building resilient services on public clouds including Azure requires careful planning and deliberate architecture for both applications servers as well storage layers.</span></span> <span data-ttu-id="5510f-111">Architektura distribuovaného úložiště pro Cassandra přirozeně pomáhá při vytváření vysoce dostupných systémy, které jsou odolné proti chybám pro selhání clusteru.</span><span class="sxs-lookup"><span data-stu-id="5510f-111">Cassandra’s distributed storage architecture naturally helps in building highly available systems that are fault tolerant for cluster failures.</span></span> <span data-ttu-id="5510f-112">Cassandra je cloudové škálování databáze NoSQL udržovat Apache Software Foundation cassandra.apache.org; Cassandra je napsán v jazyce Java a proto běží na obou v systému Windows a Linux platformy.</span><span class="sxs-lookup"><span data-stu-id="5510f-112">Cassandra is a cloud scale NoSQL database maintained by Apache Software Foundation at cassandra.apache.org; Cassandra is written in Java and hence runs on both on Windows as well as Linux platforms.</span></span>

<span data-ttu-id="5510f-113">Hello cílem tohoto článku je tooshow Cassandra nasazení na Ubuntu jako cluster s podporou jeden a více data center využívat virtuální počítače Microsoft Azure a virtuální sítě.</span><span class="sxs-lookup"><span data-stu-id="5510f-113">hello focus of this article is tooshow Cassandra deployment on Ubuntu as a single and multi-data center cluster leveraging Microsoft Azure Virtual Machines and Virtual Networks.</span></span> <span data-ttu-id="5510f-114">Hello nasazení clusteru pro úlohy v produkčním prostředí optimalizované je mimo rámec tohoto článku jak to vyžaduje konfigurace uzlu více disku, potřeba odpovídající kruhová topologie návrh a modelování toosupport hello dat replikace, konzistenci dat, propustnost a požadavky na vysokou dostupnost.</span><span class="sxs-lookup"><span data-stu-id="5510f-114">hello cluster deployment for production optimized workloads is out of scope of this article as it requires multi-disk node configuration, appropriate ring topology design and data modeling toosupport hello needed replication, data consistency, throughput and high availability requirements.</span></span>

<span data-ttu-id="5510f-115">Tento článek trvá základní přístup tooshow, co je součástí hello vytváření clusteru Cassandra porovnání Docker, Chef nebo Puppet, které můžete provést hello nasazení infrastruktury mnoho jednodušší.</span><span class="sxs-lookup"><span data-stu-id="5510f-115">This article takes a fundamental approach tooshow what is involved in building hello Cassandra cluster compared Docker, Chef or Puppet which can make hello infrastructure deployment a lot easier.</span></span>  

## <a name="hello-deployment-models"></a><span data-ttu-id="5510f-116">Hello modely nasazení</span><span class="sxs-lookup"><span data-stu-id="5510f-116">hello Deployment Models</span></span>
<span data-ttu-id="5510f-117">Microsoft Azure sítě umožňuje nasazení hello izolované privátní clusterů hello přístupu, které může být zabezpečení s omezeným přístupem tooattain jemné možnosti sítě.</span><span class="sxs-lookup"><span data-stu-id="5510f-117">Microsoft Azure networking allows hello deployment of isolated private clusters, hello access of which can be restricted tooattain fine grained network security.</span></span>  <span data-ttu-id="5510f-118">Vzhledem k tomu, že tento článek se týká zobrazující hello Cassandra nasazení na základní úrovni, zaměříme nebude na úroveň konzistence hello a návrh optimální úložiště hello propustnost.</span><span class="sxs-lookup"><span data-stu-id="5510f-118">Since this article is about showing hello Cassandra deployment at a fundamental level, we will not focus on hello consistency level and hello optimal storage design for throughput.</span></span> <span data-ttu-id="5510f-119">Tady je seznam hello síťové požadavky pro naše hypotetický clusteru:</span><span class="sxs-lookup"><span data-stu-id="5510f-119">Here is hello list of networking requirements for our hypothetical cluster:</span></span>

* <span data-ttu-id="5510f-120">Externí systémy nelze získat přístup k Cassandra databáze z uvnitř nebo vně Azure</span><span class="sxs-lookup"><span data-stu-id="5510f-120">External systems can’t access Cassandra database from within or outside Azure</span></span>
* <span data-ttu-id="5510f-121">Cassandra cluster má toobe za službou Vyrovnávání zatížení pro provoz thrift</span><span class="sxs-lookup"><span data-stu-id="5510f-121">Cassandra cluster has toobe behind a load balancer for thrift traffic</span></span>
* <span data-ttu-id="5510f-122">Nasazení Cassandra uzly ve dvou skupinách v každé datové centrum pro rozšířené clusteru dostupnosti</span><span class="sxs-lookup"><span data-stu-id="5510f-122">Deploy Cassandra nodes in two groups in each data center for an enhanced cluster availability</span></span>
* <span data-ttu-id="5510f-123">Zamknout hello clusteru, který pouze serverové farmy aplikace má databáze access toohello přímo</span><span class="sxs-lookup"><span data-stu-id="5510f-123">Lock down hello cluster so that only application server farm has access toohello database directly</span></span>
* <span data-ttu-id="5510f-124">Žádné veřejné sítě koncové body než SSH</span><span class="sxs-lookup"><span data-stu-id="5510f-124">No public networking endpoints other than SSH</span></span>
* <span data-ttu-id="5510f-125">Každý uzel Cassandra musí pevnou interní IP adresu</span><span class="sxs-lookup"><span data-stu-id="5510f-125">Each Cassandra node needs a fixed internal IP address</span></span>

<span data-ttu-id="5510f-126">Cassandra můžou být nasazené tooa jedné oblasti Azure nebo toomultiple oblasti závislosti na povaze distribuovaných hello hello zatížení.</span><span class="sxs-lookup"><span data-stu-id="5510f-126">Cassandra can be deployed tooa single Azure region or toomultiple regions based on hello distributed nature of hello workload.</span></span> <span data-ttu-id="5510f-127">Model nasazení s více oblasti lze využít tooserve koncoví uživatelé blíže tooa konkrétní geografický prostřednictvím hello stejnou Cassandra infrastrukturu.</span><span class="sxs-lookup"><span data-stu-id="5510f-127">Multi-region deployment model can be leveraged tooserve end users closer tooa particular geography through hello same Cassandra infrastructure.</span></span> <span data-ttu-id="5510f-128">Cassandra pro předdefinovaný uzel replikace trvá pozor hello synchronizace více hlavního serveru zapíše pocházející z několika datových centrech a uvede konzistentní zobrazení dat tooapplications hello.</span><span class="sxs-lookup"><span data-stu-id="5510f-128">Cassandra’s built-in node replication takes care of hello synchronization of multi-master writes originating from multiple data centers and presents a consistent view of hello data tooapplications.</span></span> <span data-ttu-id="5510f-129">Nasazení s více oblast může také pomoci s zmírnění rizik hello hello širší výpadků služby Azure.</span><span class="sxs-lookup"><span data-stu-id="5510f-129">Multi-region deployment can also help with hello risk mitigation of hello broader Azure service outages.</span></span> <span data-ttu-id="5510f-130">Přizpůsobitelné konzistence na Cassandra a replikační topologie usnadní pokrývat různých plánovaný bod obnovení z aplikace.</span><span class="sxs-lookup"><span data-stu-id="5510f-130">Cassandra’s tunable consistency and replication topology will help in meeting diverse RPO needs of applications.</span></span>

### <a name="single-region-deployment"></a><span data-ttu-id="5510f-131">Nasazení jedné oblasti</span><span class="sxs-lookup"><span data-stu-id="5510f-131">Single Region Deployment</span></span>
<span data-ttu-id="5510f-132">Jsme se spustí s nasazení jedné oblasti a sklizně hello learnings při vytváření více oblast modelu.</span><span class="sxs-lookup"><span data-stu-id="5510f-132">We will start with a single region deployment and harvest hello learnings in creating a multi-region model.</span></span> <span data-ttu-id="5510f-133">Virtuální síť Azure bude podsítě používané toocreate izolované tak, aby výše uvedené požadavky na zabezpečení hello sítě lze splnit.</span><span class="sxs-lookup"><span data-stu-id="5510f-133">Azure virtual networking will be used toocreate isolated subnets so that hello network security requirements mentioned above can be met.</span></span>  <span data-ttu-id="5510f-134">Hello proces popsaný při vytváření nasazení jedné oblasti hello používá Ubuntu 14.04 LTS a Cassandra 2.08; ale hello procesu můžete snadno být přijatých toohello ostatní varianty Linux.</span><span class="sxs-lookup"><span data-stu-id="5510f-134">hello process described in creating hello single region deployment uses Ubuntu 14.04 LTS and Cassandra 2.08; however, hello process can easily be adopted toohello other Linux variants.</span></span> <span data-ttu-id="5510f-135">Hello Toto jsou některé systémové charakteristiky hello hello nasazení jedné oblasti.</span><span class="sxs-lookup"><span data-stu-id="5510f-135">hello following are some of hello systemic characteristics of hello single region deployment.</span></span>  

<span data-ttu-id="5510f-136">**Vysoká dostupnost:** hello Cassandra uzly ze hello obrázek 1 nasazených tootwo dostupnosti nastaví tak, aby uzly hello se šíří mezi více domén selhání pro zajištění vysoké dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="5510f-136">**High Availability:** hello Cassandra nodes shown in hello Figure 1 are deployed tootwo availability sets so that hello nodes are spread between multiple fault domains for high availability.</span></span> <span data-ttu-id="5510f-137">Poznámky s každou skupinu dostupnosti virtuálních počítačů je namapované too2 domén selhání.</span><span class="sxs-lookup"><span data-stu-id="5510f-137">VMs annotated with each availability set is mapped too2 fault domains.</span></span>  <span data-ttu-id="5510f-138">Microsoft Azure používá hello koncept toomanage domény selhání neplánované výpadek (např. selhání hardwaru nebo softwaru) při hello konceptu upgradu domény (např. hostitele nebo hosta OS opravy a upgrady, upgrady aplikací) se používá pro správu naplánované výpadek.</span><span class="sxs-lookup"><span data-stu-id="5510f-138">Microsoft Azure uses hello concept of fault domain toomanage unplanned down time (e.g. hardware or software failures) while hello concept of upgrade domain (e.g. host or guest OS patching/upgrades, application upgrades) is used for managing scheduled down time.</span></span> <span data-ttu-id="5510f-139">Najdete v tématu [zotavení po havárii a vysoká dostupnost pro aplikací Azure](http://msdn.microsoft.com/library/dn251004.aspx) pro roli hello selhání a upgradu domén v dosažení vysoké dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="5510f-139">Please see [Disaster Recovery and High Availability for Azure Applications](http://msdn.microsoft.com/library/dn251004.aspx) for hello role of fault and upgrade domains in attaining high availability.</span></span>

![Nasazení jedné oblasti](./media/cassandra-nodejs/cassandra-linux1.png)

<span data-ttu-id="5510f-141">Obrázek 1: Nasazení jedné oblasti</span><span class="sxs-lookup"><span data-stu-id="5510f-141">Figure 1: Single region deployment</span></span>

<span data-ttu-id="5510f-142">Všimněte si, že v době psaní tohoto textu hello Azure neumožňuje hello explicitní mapování skupiny virtuálních počítačů domény konkrétní selhání tooa; v důsledku toho i s modelem nasazení hello na obrázku 1, je statisticky pravděpodobné, že všechny virtuální počítače hello může být namapované tootwo domén selhání místo čtyři.</span><span class="sxs-lookup"><span data-stu-id="5510f-142">Note that at hello time of this writing, Azure doesn’t allow hello explicit mapping of a group of VMs tooa specific fault domain; consequently, even with hello deployment model shown in Figure 1, it is statistically probable that all hello virtual machines may be mapped tootwo fault domains instead of four.</span></span>

<span data-ttu-id="5510f-143">**Přenosy Thrift Vyrovnávání zatížení:** Thrift klientské knihovny uvnitř hello webový server připojení clusteru toohello přes interní nástroj.</span><span class="sxs-lookup"><span data-stu-id="5510f-143">**Load Balancing Thrift Traffic:** Thrift client libraries inside hello web server connect toohello cluster through an internal load balancer.</span></span> <span data-ttu-id="5510f-144">To vyžaduje hello proces přidávání podsíť hello interní služby load vyrovnávání toohello "data" (viz obrázek 1) v kontextu hello hello cloudové služby hostování hello Cassandra clusteru.</span><span class="sxs-lookup"><span data-stu-id="5510f-144">This requires hello process of adding hello internal load balancer toohello “data” subnet (refer Figure 1) in hello context of hello cloud service hosting hello Cassandra cluster.</span></span> <span data-ttu-id="5510f-145">Po definování Vyrovnávání zatížení interní hello každý uzel vyžaduje hello skupinu s vyrovnáváním zatížení koncového bodu toobe přidána s hello poznámky skupiny vyrovnáváním zatížení s dříve název nástroje pro vyrovnávání zatížení definované.</span><span class="sxs-lookup"><span data-stu-id="5510f-145">Once hello internal load balancer is defined, each node requires hello load balanced endpoint toobe added with hello annotations of a load balanced set with previously defined load balancer name.</span></span> <span data-ttu-id="5510f-146">V tématu [interní Vyrovnávání zatížení Azure ](../../../load-balancer/load-balancer-internal-overview.md)další podrobnosti.</span><span class="sxs-lookup"><span data-stu-id="5510f-146">See [Azure Internal Load Balancing ](../../../load-balancer/load-balancer-internal-overview.md)for more details.</span></span>

<span data-ttu-id="5510f-147">**Cluster semen:** je důležité tooselect hello většina vysoce dostupných uzlů pro semena jako hello nové uzly budou komunikovat s uzly počáteční hodnoty toodiscover hello topologii hello clusteru.</span><span class="sxs-lookup"><span data-stu-id="5510f-147">**Cluster Seeds:** It is important tooselect hello most highly available nodes for seeds as hello new nodes will communicate with seed nodes toodiscover hello topology of hello cluster.</span></span> <span data-ttu-id="5510f-148">Jeden uzel z každé skupiny dostupnosti je určený jako počáteční hodnoty uzly tooavoid jediný bod selhání.</span><span class="sxs-lookup"><span data-stu-id="5510f-148">One node from each availability set is designated as seed nodes tooavoid single point of failure.</span></span>

<span data-ttu-id="5510f-149">**Zařízení a úroveň konzistence replikace:** Cassandra na sestavení v vysokou dostupnost a data odolnost je charakterizovaná hello replikace faktor RF - počet kopií každého řádku uložené v clusteru hello a úroveň konzistence (počet repliky toobe číst nebo zapisovat před vrácením hello výsledek toohello volající).</span><span class="sxs-lookup"><span data-stu-id="5510f-149">**Replication Factor and Consistency Level:** Cassandra’s build-in high-availability and data durability is characterized by hello Replication Factor (RF - number of copies of each row stored on hello cluster) and Consistency Level (number of replicas toobe read/written before returning hello result toohello caller).</span></span> <span data-ttu-id="5510f-150">Faktor replikace je zadán během hello vytvoření KEYSPACE (podobně jako relační databáze tooa), zatímco úroveň konzistence hello je zadána při vydání dotazů CRUD hello.</span><span class="sxs-lookup"><span data-stu-id="5510f-150">Replication factor is specified during hello KEYSPACE (similar tooa relational database) creation whereas hello consistency level is specified while issuing hello CRUD query.</span></span> <span data-ttu-id="5510f-151">Naleznete v dokumentaci k Cassandra v [konfigurace pro konzistence](http://www.datastax.com/documentation/cassandra/2.0/cassandra/dml/dml_config_consistency_c.html) konzistence podrobnosti a hello vzorec pro výpočty kvora.</span><span class="sxs-lookup"><span data-stu-id="5510f-151">See Cassandra documentation at [Configuring for Consistency](http://www.datastax.com/documentation/cassandra/2.0/cassandra/dml/dml_config_consistency_c.html) for consistency details and hello formula for quorum computation.</span></span>

<span data-ttu-id="5510f-152">Cassandra podporuje dva typy modelů integrity dat – konzistence a konzistence typu případné; Hello Multi-Factor replikace a úroveň konzistence společně určí Pokud hello data budou konzistentní při dokončení operace zápisu nebo bude nakonec byl konzistentní.</span><span class="sxs-lookup"><span data-stu-id="5510f-152">Cassandra supports two types of data integrity models – Consistency and Eventual Consistency; hello Replication Factor and Consistency Level will together determine if hello data will be consistent as soon as a write operation is complete or it will be eventually consistent.</span></span> <span data-ttu-id="5510f-153">Například zadání KVORA jako hello úroveň konzistence bude vždy zajišťuje data konzistence při jakékoli úroveň konzistence, pod hello počet replik toobe zapisují jako potřebné tooattain výsledkem KVORA (například jeden) a data se nakonec byl konzistentní.</span><span class="sxs-lookup"><span data-stu-id="5510f-153">For example, specifying QUORUM as hello Consistency Level will always ensures data Consistency while any consistency level, below hello number of replicas toobe written as needed tooattain QUORUM (e.g. ONE) results in data being eventually consistent.</span></span>

<span data-ttu-id="5510f-154">Hello 8 uzlů clusteru s faktorem replikace 3 a KVORA zobrazeno výše, (2 uzly jsou číst nebo zapisovat konzistenci) pro čtení a zápis úroveň konzistence, přežijí hello teoretické ztrátě v hello většina 1 uzel za replikační skupiny před spuštěním aplikace hello vašeho povšimnutí hello selhání.</span><span class="sxs-lookup"><span data-stu-id="5510f-154">hello 8-node cluster shown above, with a replication factor of 3 and QUORUM (2 nodes are read or written for consistency) read/write consistency level, can survive hello theoretical loss of at hello most 1 node per replication group before hello application start noticing hello failure.</span></span> <span data-ttu-id="5510f-155">Předpokladem je, všechny klíče mezery hello mít vyrovnáváním i požadavky na čtení a zápis.</span><span class="sxs-lookup"><span data-stu-id="5510f-155">This assumes that all hello key spaces have well balanced read/write requests.</span></span>  <span data-ttu-id="5510f-156">Hello následují hello parametry, které budeme používat pro cluster hello nasazení:</span><span class="sxs-lookup"><span data-stu-id="5510f-156">hello following are hello parameters we will use for hello deployed cluster:</span></span>

<span data-ttu-id="5510f-157">Konfigurace clusteru Cassandra jedné oblasti:</span><span class="sxs-lookup"><span data-stu-id="5510f-157">Single region Cassandra cluster configuration:</span></span>

| <span data-ttu-id="5510f-158">Parametr clusteru</span><span class="sxs-lookup"><span data-stu-id="5510f-158">Cluster Parameter</span></span> | <span data-ttu-id="5510f-159">Hodnota</span><span class="sxs-lookup"><span data-stu-id="5510f-159">Value</span></span> | <span data-ttu-id="5510f-160">Poznámky</span><span class="sxs-lookup"><span data-stu-id="5510f-160">Remarks</span></span> |
| --- | --- | --- |
| <span data-ttu-id="5510f-161">Počet uzlů (ne)</span><span class="sxs-lookup"><span data-stu-id="5510f-161">Number of Nodes (N)</span></span> |<span data-ttu-id="5510f-162">8</span><span class="sxs-lookup"><span data-stu-id="5510f-162">8</span></span> |<span data-ttu-id="5510f-163">Celkový počet uzlů v clusteru hello</span><span class="sxs-lookup"><span data-stu-id="5510f-163">Total number of nodes in hello cluster</span></span> |
| <span data-ttu-id="5510f-164">Replikace faktor (RF)</span><span class="sxs-lookup"><span data-stu-id="5510f-164">Replication Factor (RF)</span></span> |<span data-ttu-id="5510f-165">3</span><span class="sxs-lookup"><span data-stu-id="5510f-165">3</span></span> |<span data-ttu-id="5510f-166">Počet replik daného řádku</span><span class="sxs-lookup"><span data-stu-id="5510f-166">Number of replicas of a given row</span></span> |
| <span data-ttu-id="5510f-167">Úroveň konzistence (zápisu)</span><span class="sxs-lookup"><span data-stu-id="5510f-167">Consistency Level (Write)</span></span> |<span data-ttu-id="5510f-168">QUORUM[(RF/2) +1) = 2] hello výsledek z hello vzorec se zaokrouhlí směrem dolů</span><span class="sxs-lookup"><span data-stu-id="5510f-168">QUORUM[(RF/2) +1) = 2] hello result of hello formula is rounded down</span></span> |<span data-ttu-id="5510f-169">Zapíše na hello většina 2 repliky před odesláním odpovědi hello toohello volající; 3. replika se zapíše nakonec byl konzistentní způsobem.</span><span class="sxs-lookup"><span data-stu-id="5510f-169">Writes at hello most 2 replicas before hello response is sent toohello caller; 3rd replica is written in an eventually consistent manner.</span></span> |
| <span data-ttu-id="5510f-170">Úroveň konzistence (čtení)</span><span class="sxs-lookup"><span data-stu-id="5510f-170">Consistency Level (Read)</span></span> |<span data-ttu-id="5510f-171">KVORA [(RF/2) + 1 = 2] hello výsledek vzorec hello se zaokrouhlí směrem dolů</span><span class="sxs-lookup"><span data-stu-id="5510f-171">QUORUM [(RF/2) +1= 2] hello result of hello formula is rounded down</span></span> |<span data-ttu-id="5510f-172">Přečte 2 repliky před odesláním odpovědi toohello volajícího.</span><span class="sxs-lookup"><span data-stu-id="5510f-172">Reads 2 replicas before sending response toohello caller.</span></span> |
| <span data-ttu-id="5510f-173">Strategie replikace</span><span class="sxs-lookup"><span data-stu-id="5510f-173">Replication Strategy</span></span> |<span data-ttu-id="5510f-174">Viz NetworkTopologyStrategy [replikaci dat](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) v dokumentaci k Cassandra pro další informace</span><span class="sxs-lookup"><span data-stu-id="5510f-174">NetworkTopologyStrategy see [Data Replication](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="5510f-175">Jste srozuměni s tím topologie nasazení hello a umístí repliky na uzlech, aby všechny repliky hello nemáte skončili na hello stejné rack</span><span class="sxs-lookup"><span data-stu-id="5510f-175">Understands hello deployment topology and places replicas on nodes so that all hello replicas don’t end up on hello same rack</span></span> |
| <span data-ttu-id="5510f-176">Snitch</span><span class="sxs-lookup"><span data-stu-id="5510f-176">Snitch</span></span> |<span data-ttu-id="5510f-177">Viz GossipingPropertyFileSnitch [Snitches](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) v dokumentaci k Cassandra pro další informace</span><span class="sxs-lookup"><span data-stu-id="5510f-177">GossipingPropertyFileSnitch see [Snitches](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="5510f-178">NetworkTopologyStrategy používá koncept snitch toounderstand hello topologie.</span><span class="sxs-lookup"><span data-stu-id="5510f-178">NetworkTopologyStrategy uses a concept of snitch toounderstand hello topology.</span></span> <span data-ttu-id="5510f-179">GossipingPropertyFileSnitch poskytuje lepší kontrolu mapování každý uzel toodata center a racku.</span><span class="sxs-lookup"><span data-stu-id="5510f-179">GossipingPropertyFileSnitch gives better control in mapping each node toodata center and rack.</span></span> <span data-ttu-id="5510f-180">povídání toopropagate Hello clusteru pak použije tyto informace.</span><span class="sxs-lookup"><span data-stu-id="5510f-180">hello cluster then uses gossip toopropagate this information.</span></span> <span data-ttu-id="5510f-181">To je mnohem jednodušší dynamické IP nastavení relativní tooPropertyFileSnitch</span><span class="sxs-lookup"><span data-stu-id="5510f-181">This is much simpler in dynamic IP setting relative tooPropertyFileSnitch</span></span> |

<span data-ttu-id="5510f-182">**Azure aspekty pro Cassandra Cluster:** funkce Microsoft Azure Virtual Machines používá úložiště objektů Blob v Azure disku trvalosti; Úložiště Azure uloží 3 repliky každého disku pro vysokou odolnost.</span><span class="sxs-lookup"><span data-stu-id="5510f-182">**Azure Considerations for Cassandra Cluster:** Microsoft Azure Virtual Machines capability uses Azure Blob storage for disk persistence; Azure Storage saves 3 replicas of each disk for high durability.</span></span> <span data-ttu-id="5510f-183">To znamená, že každý řádek dat vloženy do tabulky Cassandra je již uložen v 3 repliky, a proto konzistenci dat je již postaráno i v případě hello replikace faktor (RF) je 1.</span><span class="sxs-lookup"><span data-stu-id="5510f-183">That means each row of data inserted into a Cassandra table is already stored in 3 replicas and hence data consistency is already taken care of even if hello Replication Factor (RF) is 1.</span></span> <span data-ttu-id="5510f-184">Hello hlavní problém s Multi-Factor replikace se 1 je aplikace hello všimnete výpadek i v případě selhání jednoho uzlu Cassandra.</span><span class="sxs-lookup"><span data-stu-id="5510f-184">hello main problem with Replication Factor being 1 is that hello application will experience downtime even if a single Cassandra node fails.</span></span> <span data-ttu-id="5510f-185">Ale pokud uzel je vypnutý hello problémy (např. hardwaru, softwaru selhání systému) rozpoznáno Kontroleru prostředků infrastruktury Azure, zřídí nový uzel v jeho místní pomocí hello stejné jednotky úložiště.</span><span class="sxs-lookup"><span data-stu-id="5510f-185">However, if a node is down for hello problems (e.g. hardware, system software failures) recognized by Azure Fabric Controller, it will provision a new node in its place using hello same storage drives.</span></span> <span data-ttu-id="5510f-186">Zřizování nový uzel tooreplace hello staré jeden může trvat několik minut.</span><span class="sxs-lookup"><span data-stu-id="5510f-186">Provisioning a new node tooreplace hello old one may take a few minutes.</span></span>  <span data-ttu-id="5510f-187">Pro plánované údržby činnosti, jako například změny hostovaný operační systém, podobně jako Cassandra upgraduje a změny aplikace Kontroleru prostředků infrastruktury Azure provádí vrácení upgrady hello uzlů v clusteru hello.</span><span class="sxs-lookup"><span data-stu-id="5510f-187">Similarly for planned maintenance activities like guest OS changes, Cassandra upgrades and application changes Azure Fabric Controller performs rolling upgrades of hello nodes in hello cluster.</span></span>  <span data-ttu-id="5510f-188">Vrácení upgradu také může trvat dolů několika uzlů najednou a proto hello clusteru setkat s krátkou prodlevou mezi migrací pro několik oddílů.</span><span class="sxs-lookup"><span data-stu-id="5510f-188">Rolling upgrades also may take down a few nodes at a time and hence hello cluster may experience brief downtime for a few partitions.</span></span> <span data-ttu-id="5510f-189">Ale hello nedojde ke ztrátě kvůli toohello vestavěná redundance úložiště Azure.</span><span class="sxs-lookup"><span data-stu-id="5510f-189">However, hello data will not be lost due toohello built-in Azure Storage redundancy.</span></span>  

<span data-ttu-id="5510f-190">Pro systémy nasazené tooAzure, která nevyžaduje vysokou dostupnost (například přibližně 99,9 který je ekvivalentní too8.76 hodin nebo rok; viz [vysokou dostupnost](http://en.wikipedia.org/wiki/High_availability) podrobnosti) může být schopný toorun s RF = 1 a úroveň konzistence = jeden.</span><span class="sxs-lookup"><span data-stu-id="5510f-190">For systems deployed tooAzure that doesn’t require high availability (e.g. around 99.9 which is equivalent too8.76 hrs/year; see [High Availability](http://en.wikipedia.org/wiki/High_availability) for details) you may be able toorun with RF=1 and Consistency Level=ONE.</span></span>  <span data-ttu-id="5510f-191">Pro aplikace s požadavky na vysokou dostupnost, RF = 3 a úroveň konzistence = KVORA budou tolerovat hello výpadek jednoho z uzlů hello jeden hello replik.</span><span class="sxs-lookup"><span data-stu-id="5510f-191">For applications with high availability requirements, RF=3 and Consistency Level=QUORUM will tolerate hello down time of one of hello nodes one of hello replicas.</span></span> <span data-ttu-id="5510f-192">RF = 1 v tradiční nasazení (například místní) nelze použít kvůli ztrátě dat. toohello vyplývající z problémů, jako je selhání disku.</span><span class="sxs-lookup"><span data-stu-id="5510f-192">RF=1 in traditional deployments (e.g. on-premises) can’t be used due toohello possible data loss resulting from problems like disk failures.</span></span>   

## <a name="multi-region-deployment"></a><span data-ttu-id="5510f-193">Nasazení s více oblast</span><span class="sxs-lookup"><span data-stu-id="5510f-193">Multi-region Deployment</span></span>
<span data-ttu-id="5510f-194">Datové centrum s deklaracemi replikace a konzistence model popsané výše pomáhá s nasazení s více oblast hello předinstalované hello bez hello na Cassandra nutnost žádné externí nástroje.</span><span class="sxs-lookup"><span data-stu-id="5510f-194">Cassandra’s data-center-aware replication and consistency model described above helps with hello multi-region deployment out of hello box without hello need for any external tooling.</span></span> <span data-ttu-id="5510f-195">Toto je výrazně lišit od tradičních relačních databází hello, kde může být poměrně složité hello nastavení pro zrcadlení databáze pro více hlavních zápisy.</span><span class="sxs-lookup"><span data-stu-id="5510f-195">This is quite different from hello traditional relational databases where hello setup for database mirroring for multi-master writes can be quite complex.</span></span> <span data-ttu-id="5510f-196">Cassandra v několika oblasti nastavit můžou pomoct s scénáře použití hello včetně hello následující:</span><span class="sxs-lookup"><span data-stu-id="5510f-196">Cassandra in a multi-region set up can help with hello usage scenarios including hello following:</span></span>

<span data-ttu-id="5510f-197">**Bezkontaktní komunikace na základě nasazení:** víceklientským aplikacím s zrušte mapování uživatelů klienta-na-oblast, můžete prospěch podle clusteru více oblast hello nízkou latenci.</span><span class="sxs-lookup"><span data-stu-id="5510f-197">**Proximity based deployment:** Multi-tenant applications, with clear mapping of tenant users -to-region, can be benefited by hello multi-region cluster’s low latencies.</span></span> <span data-ttu-id="5510f-198">Například správy učení systémy pro vzdělávací instituce můžete nasadit cluster distribuované ve východní USA a západní USA oblasti tooserve hello příslušných univerzity pro transakční i analytics.</span><span class="sxs-lookup"><span data-stu-id="5510f-198">For example a learning management systems for educational institutions can deploy a distributed cluster in East US and West US regions tooserve hello respective campuses for transactional as well as analytics.</span></span> <span data-ttu-id="5510f-199">Hello data můžou být místně konzistentní v hello čas čtení a zápisu a může být v obou oblastech hello nakonec byl konzistentní.</span><span class="sxs-lookup"><span data-stu-id="5510f-199">hello data can be locally consistent at hello time reads and writes and can be eventually consistent across both hello regions.</span></span> <span data-ttu-id="5510f-200">Existují další příklady jako distribuční média, elektronické obchodování a nic a všechno, co se uživatel geograficky soustředí slouží základní je případ vhodné využít pro tento model nasazení.</span><span class="sxs-lookup"><span data-stu-id="5510f-200">There are other examples like media distribution, e-commerce and anything and everything that serves geo concentrated user base is a good use case for this deployment model.</span></span>

<span data-ttu-id="5510f-201">**Vysoká dostupnost:** redundance je klíčovým faktorem k dosažení vysoké dostupnosti softwaru a hardwaru; podrobnosti najdete v části vytváření spolehlivé cloudové systémy v Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="5510f-201">**High Availability:** Redundancy is a key factor in attaining high availability of software and hardware; see Building Reliable Cloud Systems on Microsoft Azure for details.</span></span> <span data-ttu-id="5510f-202">V Microsoft Azure je nasazení clusteru s podporou více oblast hello pouze spolehlivý způsob dosažení true redundance.</span><span class="sxs-lookup"><span data-stu-id="5510f-202">On Microsoft Azure, hello only reliable way of achieving true redundancy is by deploying a multi-region cluster.</span></span> <span data-ttu-id="5510f-203">Mohou být aplikace nasazeny v režimu aktivní aktivní nebo aktivní – pasivní, a pokud jeden z oblasti hello je vypnutý, Azure Traffic Manageru můžete přesměrovat provoz toohello aktivní oblasti.</span><span class="sxs-lookup"><span data-stu-id="5510f-203">Applications can be deployed in an active-active or active-passive mode and if one of hello regions is down, Azure Traffic Manager can redirect traffic toohello active region.</span></span>  <span data-ttu-id="5510f-204">Při nasazení jedné oblasti hello, pokud je dostupnost hello 99,9, oblast dvě nasazení můžete zajistit s dostupností 99.9999 vypočítávají podle vzorce hello: (1-(1-0.999) * (1-0,999)) * 100); v tématu hello výše dokumentu podrobnosti.</span><span class="sxs-lookup"><span data-stu-id="5510f-204">With hello single region deployment, if hello availability is 99.9, a two-region deployment can attain an availability of 99.9999 computed by hello formula: (1-(1-0.999) * (1-0.999))*100); see hello above paper for details.</span></span>

<span data-ttu-id="5510f-205">**Zotavení po havárii:** Cassandra více oblast clusteru, pokud správně navržená tak, odolat závažné data center výpadků.</span><span class="sxs-lookup"><span data-stu-id="5510f-205">**Disaster Recovery:** Multi-region Cassandra cluster, if properly designed, can withstand catastrophic data center outages.</span></span> <span data-ttu-id="5510f-206">Pokud jedné oblasti je vypnutý, můžete začít hello aplikace nasazena tooother oblasti obsluhující hello koncovým uživatelům.</span><span class="sxs-lookup"><span data-stu-id="5510f-206">If one region is down, hello application deployed tooother regions can start serving hello end users.</span></span> <span data-ttu-id="5510f-207">Stejně jako jakékoli jiné firmy kontinuity implementace má aplikace hello toobe odolný vůči chybám pro ztrátu dat, která je výsledkem dat hello v kanálu asynchronní hello.</span><span class="sxs-lookup"><span data-stu-id="5510f-207">Like any other business continuity implementations, hello application has toobe tolerant for some data loss resulting from hello data in hello asynchronous pipeline.</span></span> <span data-ttu-id="5510f-208">Ale Cassandra umožňuje obnovení hello mnohem rychlejší, než doba hello procesy tradiční databáze obnovení.</span><span class="sxs-lookup"><span data-stu-id="5510f-208">However, Cassandra makes hello recovery much swifter than hello time taken by traditional database recovery processes.</span></span> <span data-ttu-id="5510f-209">Obrázek 2 ukazuje hello model typické nasazení s více oblasti s osmi uzlů v každé oblasti.</span><span class="sxs-lookup"><span data-stu-id="5510f-209">Figure 2 shows hello typical multi-region deployment model with eight nodes in each region.</span></span> <span data-ttu-id="5510f-210">Obě oblasti jsou Image zrcadlení vzájemně pro hello stejné symetrie; návrhy skutečných závisí na typu úloh hello (např. transakční či analytical), plánovaný bod obnovení, RTO, konzistenci dat a požadavky dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="5510f-210">Both regions are mirror images of each other for hello same of symmetry; real world designs depend on hello workload type (e.g. transactional or analytical), RPO, RTO, data consistency and availability requirements.</span></span>

![Nasazení více oblast](./media/cassandra-nodejs/cassandra-linux2.png)

<span data-ttu-id="5510f-212">Obrázek 2: Nasazení s více oblast Cassandra</span><span class="sxs-lookup"><span data-stu-id="5510f-212">Figure 2: Multi-region Cassandra deployment</span></span>

### <a name="network-integration"></a><span data-ttu-id="5510f-213">Integrace sítě</span><span class="sxs-lookup"><span data-stu-id="5510f-213">Network Integration</span></span>
<span data-ttu-id="5510f-214">Nastaví virtuálních počítačů nasazených tooprivate sítě nachází na dvou oblastí komunikuje se navzájem pomocí tunelového připojení sítě VPN.</span><span class="sxs-lookup"><span data-stu-id="5510f-214">Sets of virtual machines deployed tooprivate networks located on two regions communicates with each other using a VPN tunnel.</span></span> <span data-ttu-id="5510f-215">tunelové propojení VPN Hello připojí dvě brány softwaru zřízenou během procesu nasazení sítě hello.</span><span class="sxs-lookup"><span data-stu-id="5510f-215">hello VPN tunnel connects two software gateways provisioned during hello network deployment process.</span></span> <span data-ttu-id="5510f-216">Obě oblasti mají podobné síťovou architekturu z hlediska podsítě "web" a "data"; Azure sítě umožňuje vytváření hello tolik podsítí podle potřeby a použít seznamy řízení přístupu podle potřeb zabezpečení sítě.</span><span class="sxs-lookup"><span data-stu-id="5510f-216">Both regions have similar network architecture in terms of “web” and “data” subnets; Azure networking allows hello creation of as many subnets as needed and apply ACLs as needed by network security.</span></span> <span data-ttu-id="5510f-217">Při navrhování topologie clusteru hello mimo data center komunikace latenci a hello hospodářského dopad hello síťový provoz nutné toobe považována za.</span><span class="sxs-lookup"><span data-stu-id="5510f-217">While designing hello cluster topology inter data center communication latency and hello economic impact of hello network traffic need toobe considered.</span></span>

### <a name="data-consistency-for-multi-data-center-deployment"></a><span data-ttu-id="5510f-218">Konzistence dat pro nasazení s více datového centra</span><span class="sxs-lookup"><span data-stu-id="5510f-218">Data Consistency for Multi-Data Center Deployment</span></span>
<span data-ttu-id="5510f-219">Distribuované nasazení nutné toobe vědět hello clusteru topologie dopad na propustnost a vysokou dostupnost.</span><span class="sxs-lookup"><span data-stu-id="5510f-219">Distributed deployments need toobe aware of hello cluster topology impact on throughput and high availability.</span></span> <span data-ttu-id="5510f-220">Hello RF a úroveň konzistence toobe nutné vybrané takovým způsobem, který hello kvora nezávisí na dostupnost hello všechny hello datových centrech.</span><span class="sxs-lookup"><span data-stu-id="5510f-220">hello RF and Consistency Level need toobe selected in such way that hello quorum doesn’t depend on hello availability of all hello data centers.</span></span>
<span data-ttu-id="5510f-221">Pro systém, který potřebuje vysokou konzistence, LOCAL_QUORUM pro úroveň konzistence (pro čtení a zápisy) se ujistěte se, že hello místní čtení a zápisů jsou splněny z hello místní uzly data replikují asynchronně toohello vzdálené datových centrech.</span><span class="sxs-lookup"><span data-stu-id="5510f-221">For a system that needs high consistency, a LOCAL_QUORUM for consistency level (for reads and writes) will make sure that hello local reads and writes are satisfied from hello local nodes while data is replicated asynchronously toohello remote data centers.</span></span>  <span data-ttu-id="5510f-222">Tabulka 2 shrnuje konfigurace hello podrobnosti o clusteru více oblast hello popsané dál v hello zápisu nahoru.</span><span class="sxs-lookup"><span data-stu-id="5510f-222">Table 2 summarizes hello configuration details for hello multi-region cluster outlined later in hello write up.</span></span>

<span data-ttu-id="5510f-223">**Konfigurace clusteru Cassandra dva oblast**</span><span class="sxs-lookup"><span data-stu-id="5510f-223">**Two-region Cassandra cluster configuration**</span></span>

| <span data-ttu-id="5510f-224">Parametr clusteru</span><span class="sxs-lookup"><span data-stu-id="5510f-224">Cluster Parameter</span></span> | <span data-ttu-id="5510f-225">Hodnota</span><span class="sxs-lookup"><span data-stu-id="5510f-225">Value</span></span> | <span data-ttu-id="5510f-226">Poznámky</span><span class="sxs-lookup"><span data-stu-id="5510f-226">Remarks</span></span> |
| --- | --- | --- |
| <span data-ttu-id="5510f-227">Počet uzlů (ne)</span><span class="sxs-lookup"><span data-stu-id="5510f-227">Number of Nodes (N)</span></span> |<span data-ttu-id="5510f-228">8 + 8</span><span class="sxs-lookup"><span data-stu-id="5510f-228">8 + 8</span></span> |<span data-ttu-id="5510f-229">Celkový počet uzlů v clusteru hello</span><span class="sxs-lookup"><span data-stu-id="5510f-229">Total number of nodes in hello cluster</span></span> |
| <span data-ttu-id="5510f-230">Replikace faktor (RF)</span><span class="sxs-lookup"><span data-stu-id="5510f-230">Replication Factor (RF)</span></span> |<span data-ttu-id="5510f-231">3</span><span class="sxs-lookup"><span data-stu-id="5510f-231">3</span></span> |<span data-ttu-id="5510f-232">Počet replik daného řádku</span><span class="sxs-lookup"><span data-stu-id="5510f-232">Number of replicas of a given row</span></span> |
| <span data-ttu-id="5510f-233">Úroveň konzistence (zápisu)</span><span class="sxs-lookup"><span data-stu-id="5510f-233">Consistency Level (Write)</span></span> |<span data-ttu-id="5510f-234">LOCAL_QUORUM [(sum(RF)/2) +1) = 4] hello výsledek vzorec hello se zaokrouhlí směrem dolů</span><span class="sxs-lookup"><span data-stu-id="5510f-234">LOCAL_QUORUM [(sum(RF)/2) +1) = 4] hello result of hello formula is rounded down</span></span> |<span data-ttu-id="5510f-235">2 uzly se zapíšou toohello první datového centra synchronně; Další 2 uzly Hello potřebné pro kvorum, bude napsán asynchronně toohello 2. datové centrum.</span><span class="sxs-lookup"><span data-stu-id="5510f-235">2 nodes will be written toohello first data center synchronously; hello additional 2 nodes needed for quorum will be written asynchronously toohello 2nd data center.</span></span> |
| <span data-ttu-id="5510f-236">Úroveň konzistence (čtení)</span><span class="sxs-lookup"><span data-stu-id="5510f-236">Consistency Level (Read)</span></span> |<span data-ttu-id="5510f-237">LOCAL_QUORUM ((RF/2) + 1) = 2 hello výsledek vzorec hello se zaokrouhlí směrem dolů</span><span class="sxs-lookup"><span data-stu-id="5510f-237">LOCAL_QUORUM ((RF/2) +1) = 2 hello result of hello formula is rounded down</span></span> |<span data-ttu-id="5510f-238">Požadavky pro čtení jsou splnit v pouze jedna oblast; 2 uzly jsou přečtěte si před hello odpověď je odeslána zpět toohello klienta.</span><span class="sxs-lookup"><span data-stu-id="5510f-238">Read requests are satisfied from only one region; 2 nodes are read before hello response is sent back toohello client.</span></span> |
| <span data-ttu-id="5510f-239">Strategie replikace</span><span class="sxs-lookup"><span data-stu-id="5510f-239">Replication Strategy</span></span> |<span data-ttu-id="5510f-240">Viz NetworkTopologyStrategy [replikaci dat](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) v dokumentaci k Cassandra pro další informace</span><span class="sxs-lookup"><span data-stu-id="5510f-240">NetworkTopologyStrategy see [Data Replication](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="5510f-241">Jste srozuměni s tím topologie nasazení hello a umístí repliky na uzlech, aby všechny repliky hello nemáte skončili na hello stejné rack</span><span class="sxs-lookup"><span data-stu-id="5510f-241">Understands hello deployment topology and places replicas on nodes so that all hello replicas don’t end up on hello same rack</span></span> |
| <span data-ttu-id="5510f-242">Snitch</span><span class="sxs-lookup"><span data-stu-id="5510f-242">Snitch</span></span> |<span data-ttu-id="5510f-243">Viz GossipingPropertyFileSnitch [Snitches](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) v dokumentaci k Cassandra pro další informace</span><span class="sxs-lookup"><span data-stu-id="5510f-243">GossipingPropertyFileSnitch see [Snitches](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="5510f-244">NetworkTopologyStrategy používá koncept snitch toounderstand hello topologie.</span><span class="sxs-lookup"><span data-stu-id="5510f-244">NetworkTopologyStrategy uses a concept of snitch toounderstand hello topology.</span></span> <span data-ttu-id="5510f-245">GossipingPropertyFileSnitch poskytuje lepší kontrolu mapování každý uzel toodata center a racku.</span><span class="sxs-lookup"><span data-stu-id="5510f-245">GossipingPropertyFileSnitch gives better control in mapping each node toodata center and rack.</span></span> <span data-ttu-id="5510f-246">povídání toopropagate Hello clusteru pak použije tyto informace.</span><span class="sxs-lookup"><span data-stu-id="5510f-246">hello cluster then uses gossip toopropagate this information.</span></span> <span data-ttu-id="5510f-247">To je mnohem jednodušší dynamické IP nastavení relativní tooPropertyFileSnitch</span><span class="sxs-lookup"><span data-stu-id="5510f-247">This is much simpler in dynamic IP setting relative tooPropertyFileSnitch</span></span> |

## <a name="hello-software-configuration"></a><span data-ttu-id="5510f-248">Hello konfigurace softwaru</span><span class="sxs-lookup"><span data-stu-id="5510f-248">hello SOFTWARE CONFIGURATION</span></span>
<span data-ttu-id="5510f-249">Hello následující verze softwaru použitá při nasazení hello:</span><span class="sxs-lookup"><span data-stu-id="5510f-249">hello following software versions are used during hello deployment:</span></span>

<table>
<tr><th><span data-ttu-id="5510f-250">Software</span><span class="sxs-lookup"><span data-stu-id="5510f-250">Software</span></span></th><th><span data-ttu-id="5510f-251">Zdroj</span><span class="sxs-lookup"><span data-stu-id="5510f-251">Source</span></span></th><th><span data-ttu-id="5510f-252">Verze</span><span class="sxs-lookup"><span data-stu-id="5510f-252">Version</span></span></th></tr>
<tr><td><span data-ttu-id="5510f-253">PROSTŘEDÍ JRE</span><span class="sxs-lookup"><span data-stu-id="5510f-253">JRE</span></span>    </td><td><span data-ttu-id="5510f-254">[PROSTŘEDÍ JRE 8](http://www.oracle.com/technetwork/java/javase/downloads/server-jre8-downloads-2133154.html) </span><span class="sxs-lookup"><span data-stu-id="5510f-254">[JRE 8](http://www.oracle.com/technetwork/java/javase/downloads/server-jre8-downloads-2133154.html) </span></span></td><td><span data-ttu-id="5510f-255">8U5</span><span class="sxs-lookup"><span data-stu-id="5510f-255">8U5</span></span></td></tr>
<tr><td><span data-ttu-id="5510f-256">JNA</span><span class="sxs-lookup"><span data-stu-id="5510f-256">JNA</span></span>    </td><td><span data-ttu-id="5510f-257">[JNA](https://github.com/twall/jna) </span><span class="sxs-lookup"><span data-stu-id="5510f-257">[JNA](https://github.com/twall/jna) </span></span></td><td> <span data-ttu-id="5510f-258">3.2.7</span><span class="sxs-lookup"><span data-stu-id="5510f-258">3.2.7</span></span></td></tr>
<tr><td><span data-ttu-id="5510f-259">Cassandra</span><span class="sxs-lookup"><span data-stu-id="5510f-259">Cassandra</span></span></td><td>[<span data-ttu-id="5510f-260">Apache Cassandra 2.0.8</span><span class="sxs-lookup"><span data-stu-id="5510f-260">Apache Cassandra 2.0.8</span></span>](http://www.apache.org/dist/cassandra/2.0.8/apache-cassandra-2.0.8-bin.tar.gz)</td><td> <span data-ttu-id="5510f-261">2.0.8</span><span class="sxs-lookup"><span data-stu-id="5510f-261">2.0.8</span></span></td></tr>
<tr><td><span data-ttu-id="5510f-262">Ubuntu</span><span class="sxs-lookup"><span data-stu-id="5510f-262">Ubuntu</span></span>    </td><td><span data-ttu-id="5510f-263">[Microsoft Azure](https://azure.microsoft.com/) </span><span class="sxs-lookup"><span data-stu-id="5510f-263">[Microsoft Azure](https://azure.microsoft.com/) </span></span></td><td><span data-ttu-id="5510f-264">14.04 LTS</span><span class="sxs-lookup"><span data-stu-id="5510f-264">14.04 LTS</span></span></td></tr>
</table>

<span data-ttu-id="5510f-265">Vzhledem k tomu, že stahování prostředí JRE vyžaduje ruční přijetí Oracle licence, nasazení hello toosimplify, stažení všechny požadované softwarové toohello plochy později nahrát do image hello Ubuntu šablony, které budeme vytvářet jako cluster toohello prekurzorů hello nasazení.</span><span class="sxs-lookup"><span data-stu-id="5510f-265">Since downloading of JRE requires manual acceptance of Oracle license, toosimplify hello deployment, download all hello required software toohello desktop for later uploading into hello Ubuntu template image we will be creating as a precursor toohello cluster deployment.</span></span>

<span data-ttu-id="5510f-266">Stáhněte si hello výše softwaru do adresáře dobře známé stahování (např. %TEMP%/downloads v systému Windows nebo ~/Downloads na Linuxových distribucích většiny Mac) na místním počítači hello.</span><span class="sxs-lookup"><span data-stu-id="5510f-266">Download hello above software into a well-known download directory (e.g. %TEMP%/downloads on Windows or ~/Downloads on most Linux distributions or Mac) on hello local computer.</span></span>

### <a name="create-ubuntu-vm"></a><span data-ttu-id="5510f-267">VYTVOŘENÍ VIRTUÁLNÍHO POČÍTAČE S UBUNTU</span><span class="sxs-lookup"><span data-stu-id="5510f-267">CREATE UBUNTU VM</span></span>
<span data-ttu-id="5510f-268">V tomto kroku procesu hello Ubuntu image pomocí vytvoříme hello požadovaného softwaru tak, aby hello bitovou kopii můžete znovu použít pro několik uzlů Cassandra zřizování.</span><span class="sxs-lookup"><span data-stu-id="5510f-268">In this step of hello process we will create Ubuntu image with hello pre-requisite software so that hello image can be reused for provisioning several Cassandra nodes.</span></span>  

#### <a name="step-1-generate-ssh-key-pair"></a><span data-ttu-id="5510f-269">Krok 1: Vygenerovat pár klíčů SSH</span><span class="sxs-lookup"><span data-stu-id="5510f-269">STEP 1: Generate SSH key pair</span></span>
<span data-ttu-id="5510f-270">Azure potřebuje X509 veřejný klíč, který je PEM nebo DER kódovaný v hello zřizování čas.</span><span class="sxs-lookup"><span data-stu-id="5510f-270">Azure needs an X509 public key that is either PEM or DER encoded at hello provisioning time.</span></span> <span data-ttu-id="5510f-271">Generovat pár veřejného a privátního klíče pomocí pokynů hello umístěný na to, jak tooUse SSH s Linuxem v Azure.</span><span class="sxs-lookup"><span data-stu-id="5510f-271">Generate a public/private key pair using hello instructions located at How tooUse SSH with Linux on Azure.</span></span> <span data-ttu-id="5510f-272">Pokud máte v plánu toouse putty.exe jako klient SSH buď na systému Windows nebo Linux, máte tooconvert hello PEM kódovaný formátu tooPPK privátního klíče RSA s využitím puttygen.exe; pokyny Hello naleznete v hello výše webové stránky.</span><span class="sxs-lookup"><span data-stu-id="5510f-272">If you plan toouse putty.exe as an SSH client either on Windows or Linux, you have tooconvert hello PEM encoded RSA private key tooPPK format using puttygen.exe; hello instructions for this can be found in hello above web page.</span></span>

#### <a name="step-2-create-ubuntu-template-vm"></a><span data-ttu-id="5510f-273">Krok 2: Vytvoření Ubuntu šablony virtuálních počítačů</span><span class="sxs-lookup"><span data-stu-id="5510f-273">STEP 2: Create Ubuntu template VM</span></span>
<span data-ttu-id="5510f-274">toocreate hello šablony virtuálních počítačů, přihlaste se k hello Azure classic portal a používání hello následující pořadí: klikněte na tlačítko Nový, výpočetní, virtuální počítač, FROM GALERIE, UBUNTU a Ubuntu Server 14.04 LTS a pak klikněte na šipku vpravo hello.</span><span class="sxs-lookup"><span data-stu-id="5510f-274">toocreate hello template VM, log into hello Azure classic portal and use hello following sequence: Click NEW, COMPUTE, VIRTUAL MACHINE, FROM GALLERY, UBUNTU, Ubuntu Server 14.04 LTS, and then click hello right arrow.</span></span> <span data-ttu-id="5510f-275">Kurz, který popisuje, jak toocreate virtuálního počítače s Linuxem, najdete v části vytvořit virtuální počítač systémem Linux.</span><span class="sxs-lookup"><span data-stu-id="5510f-275">For a tutorial that describes how toocreate a Linux VM, see Create a Virtual Machine Running Linux.</span></span>

<span data-ttu-id="5510f-276">Zadejte následující informace na obrazovce hello "Konfigurace virtuálního počítače" #1 hello:</span><span class="sxs-lookup"><span data-stu-id="5510f-276">Enter hello following information on hello “Virtual machine configuration” screen #1:</span></span>

<table>
<tr><th><span data-ttu-id="5510f-277">NÁZEV POLE</span><span class="sxs-lookup"><span data-stu-id="5510f-277">FIELD NAME</span></span>              </td><td>       <span data-ttu-id="5510f-278">HODNOTA POLE</span><span class="sxs-lookup"><span data-stu-id="5510f-278">FIELD VALUE</span></span>               </td><td>         <span data-ttu-id="5510f-279">POZNÁMKY</span><span class="sxs-lookup"><span data-stu-id="5510f-279">REMARKS</span></span>                </td><tr>
<tr><td><span data-ttu-id="5510f-280">DATUM VYDÁNÍ VERZE</span><span class="sxs-lookup"><span data-stu-id="5510f-280">VERSION RELEASE DATE</span></span>    </td><td> <span data-ttu-id="5510f-281">Vyberte datum z hello rozevíracího seznamu</span><span class="sxs-lookup"><span data-stu-id="5510f-281">Select a date from hello drop down</span></span></td><td></td><tr>
<tr><td><span data-ttu-id="5510f-282">NÁZEV VIRTUÁLNÍHO POČÍTAČE</span><span class="sxs-lookup"><span data-stu-id="5510f-282">VIRTUAL MACHINE NAME</span></span>    </td><td> <span data-ttu-id="5510f-283">Cass šablony.</span><span class="sxs-lookup"><span data-stu-id="5510f-283">cass-template</span></span>                   </td><td> <span data-ttu-id="5510f-284">Toto je název hostitele hello hello virtuálních počítačů</span><span class="sxs-lookup"><span data-stu-id="5510f-284">This is hello hostname of hello VM</span></span> </td><tr>
<tr><td><span data-ttu-id="5510f-285">VRSTVY</span><span class="sxs-lookup"><span data-stu-id="5510f-285">TIER</span></span>                     </td><td> <span data-ttu-id="5510f-286">STANDARD</span><span class="sxs-lookup"><span data-stu-id="5510f-286">STANDARD</span></span>                           </td><td> <span data-ttu-id="5510f-287">Ponechte výchozí hello</span><span class="sxs-lookup"><span data-stu-id="5510f-287">Leave hello default</span></span>              </td><tr>
<tr><td><span data-ttu-id="5510f-288">VELIKOST</span><span class="sxs-lookup"><span data-stu-id="5510f-288">SIZE</span></span>                     </td><td> <span data-ttu-id="5510f-289">A1</span><span class="sxs-lookup"><span data-stu-id="5510f-289">A1</span></span>                              </td><td><span data-ttu-id="5510f-290">Vyberte hello virtuálních počítačů v závislosti na hello vstupně-výstupní operace musí; pro tento účel ponechte výchozí hello</span><span class="sxs-lookup"><span data-stu-id="5510f-290">Select hello VM based on hello IO needs; for this purpose leave hello default</span></span> </td><tr>
<tr><td> <span data-ttu-id="5510f-291">NOVÉ UŽIVATELSKÉ JMÉNO</span><span class="sxs-lookup"><span data-stu-id="5510f-291">NEW USER NAME</span></span>             </td><td> <span data-ttu-id="5510f-292">localadmin</span><span class="sxs-lookup"><span data-stu-id="5510f-292">localadmin</span></span>                       </td><td> <span data-ttu-id="5510f-293">"admin" je vyhrazené uživatelské jméno ve 12. xx Ubuntu a</span><span class="sxs-lookup"><span data-stu-id="5510f-293">"admin" is a reserved user name in Ubuntu 12.xx and after</span></span></td><tr>
<tr><td> <span data-ttu-id="5510f-294">OVĚŘOVÁNÍ</span><span class="sxs-lookup"><span data-stu-id="5510f-294">AUTHENTICATION</span></span>         </td><td> <span data-ttu-id="5510f-295">Klikněte na zaškrtávací políčko</span><span class="sxs-lookup"><span data-stu-id="5510f-295">Click check box</span></span>                 </td><td><span data-ttu-id="5510f-296">Zkontrolujte, pokud chcete toosecure s klíčem SSH</span><span class="sxs-lookup"><span data-stu-id="5510f-296">Check if you want toosecure with an SSH key</span></span> </td><tr>
<tr><td> <span data-ttu-id="5510f-297">CERTIFIKÁT</span><span class="sxs-lookup"><span data-stu-id="5510f-297">CERTIFICATE</span></span>             </td><td> <span data-ttu-id="5510f-298">Název souboru certifikátu veřejného klíče hello</span><span class="sxs-lookup"><span data-stu-id="5510f-298">file name of hello public key certificate</span></span> </td><td> <span data-ttu-id="5510f-299">Použití hello veřejný klíč vygenerovaný dříve</span><span class="sxs-lookup"><span data-stu-id="5510f-299">Use hello public key generated previously</span></span></td><tr>
<tr><td> <span data-ttu-id="5510f-300">Nové heslo</span><span class="sxs-lookup"><span data-stu-id="5510f-300">New Password</span></span>    </td><td> <span data-ttu-id="5510f-301">silné heslo</span><span class="sxs-lookup"><span data-stu-id="5510f-301">strong password</span></span> </td><td> </td><tr>
<tr><td> <span data-ttu-id="5510f-302">Potvrzení hesla</span><span class="sxs-lookup"><span data-stu-id="5510f-302">Confirm Password</span></span>    </td><td> <span data-ttu-id="5510f-303">silné heslo</span><span class="sxs-lookup"><span data-stu-id="5510f-303">strong password</span></span> </td><td></td><tr>
</table>

<span data-ttu-id="5510f-304">Zadejte následující informace na obrazovce hello "Konfigurace virtuálního počítače" #2 hello:</span><span class="sxs-lookup"><span data-stu-id="5510f-304">Enter hello following information on hello “Virtual machine configuration” screen #2:</span></span>

<table>
<tr><th><span data-ttu-id="5510f-305">NÁZEV POLE</span><span class="sxs-lookup"><span data-stu-id="5510f-305">FIELD NAME</span></span>             </th><th> <span data-ttu-id="5510f-306">HODNOTA POLE</span><span class="sxs-lookup"><span data-stu-id="5510f-306">FIELD VALUE</span></span>                       </th><th> <span data-ttu-id="5510f-307">POZNÁMKY</span><span class="sxs-lookup"><span data-stu-id="5510f-307">REMARKS</span></span>                                 </th></tr>
<tr><td> <span data-ttu-id="5510f-308">CLOUDOVÉ SLUŽBY</span><span class="sxs-lookup"><span data-stu-id="5510f-308">CLOUD SERVICE</span></span>    </td><td> <span data-ttu-id="5510f-309">Vytvořte novou cloudovou službu</span><span class="sxs-lookup"><span data-stu-id="5510f-309">Create a new cloud service</span></span>    </td><td><span data-ttu-id="5510f-310">Cloudová služba je kontejner výpočetní prostředky, a to jako virtuální počítače</span><span class="sxs-lookup"><span data-stu-id="5510f-310">Cloud service is a container compute resources like virtual machines</span></span></td></tr>
<tr><td> <span data-ttu-id="5510f-311">NÁZEV CLOUDOVÉ SLUŽBY DNS</span><span class="sxs-lookup"><span data-stu-id="5510f-311">CLOUD SERVICE DNS NAME</span></span>    </td><td><span data-ttu-id="5510f-312">Ubuntu template.cloudapp.net</span><span class="sxs-lookup"><span data-stu-id="5510f-312">ubuntu-template.cloudapp.net</span></span>    </td><td><span data-ttu-id="5510f-313">Pojmenujte nástroje pro vyrovnávání zatížení lhostejné počítače</span><span class="sxs-lookup"><span data-stu-id="5510f-313">Give a machine agnostic load balancer name</span></span></td></tr>
<tr><td> <span data-ttu-id="5510f-314">OBLASTI NEBO SKUPINY VZTAHŮ NEBO VIRTUÁLNÍ SÍTĚ</span><span class="sxs-lookup"><span data-stu-id="5510f-314">REGION/AFFINITY GROUP/VIRTUAL NETWORK</span></span> </td><td>    <span data-ttu-id="5510f-315">Západní USA</span><span class="sxs-lookup"><span data-stu-id="5510f-315">West US</span></span>    </td><td> <span data-ttu-id="5510f-316">Vyberte oblast, ve kterém webových aplikací, přístup ke clusteru Cassandra hello</span><span class="sxs-lookup"><span data-stu-id="5510f-316">Select a region from which your web applications access hello Cassandra cluster</span></span></td></tr>
<tr><td><span data-ttu-id="5510f-317">ÚČET ÚLOŽIŠTĚ</span><span class="sxs-lookup"><span data-stu-id="5510f-317">STORAGE ACCOUNT</span></span> </td><td>    <span data-ttu-id="5510f-318">Použít výchozí</span><span class="sxs-lookup"><span data-stu-id="5510f-318">Use default</span></span>    </td><td><span data-ttu-id="5510f-319">Použití hello výchozí účet úložiště nebo předem vytvořený účet úložiště v určité oblasti.</span><span class="sxs-lookup"><span data-stu-id="5510f-319">Use hello default storage account  or a pre-created storage account in a particular region</span></span></td></tr>
<tr><td><span data-ttu-id="5510f-320">SADY DOSTUPNOSTI.</span><span class="sxs-lookup"><span data-stu-id="5510f-320">AVAILABILITY SET</span></span> </td><td>    <span data-ttu-id="5510f-321">Žádný</span><span class="sxs-lookup"><span data-stu-id="5510f-321">None</span></span> </td><td>    <span data-ttu-id="5510f-322">Ponechat prázdné</span><span class="sxs-lookup"><span data-stu-id="5510f-322">Leave it blank</span></span></td></tr>
<tr><td><span data-ttu-id="5510f-323">KONCOVÉ BODY</span><span class="sxs-lookup"><span data-stu-id="5510f-323">ENDPOINTS</span></span>    </td><td><span data-ttu-id="5510f-324">Použít výchozí</span><span class="sxs-lookup"><span data-stu-id="5510f-324">Use default</span></span> </td><td>    <span data-ttu-id="5510f-325">Použít konfiguraci SSH výchozí hello</span><span class="sxs-lookup"><span data-stu-id="5510f-325">Use hello default SSH configuration</span></span> </td></tr>
</table>

<span data-ttu-id="5510f-326">Klikněte na šipku vpravo, nechte výchozí hodnoty hello na úvodní obrazovka #3 a klikněte na hello "kontrola" tlačítko toocomplete hello virtuálních počítačů zřizování procesu.</span><span class="sxs-lookup"><span data-stu-id="5510f-326">Click right arrow, leave hello defaults on hello screen #3 and click hello “check” button toocomplete hello VM provisioning process.</span></span> <span data-ttu-id="5510f-327">Po několika minutách by měly mít hello virtuálních počítačů s hello název "ubuntu šablona" stav "spuštění".</span><span class="sxs-lookup"><span data-stu-id="5510f-327">After a few minutes, hello VM with hello name “ubuntu-template” should be in a “running” status.</span></span>

### <a name="install-hello-necessary-software"></a><span data-ttu-id="5510f-328">NAINSTALUJTE hello nezbytný SOFTWARE</span><span class="sxs-lookup"><span data-stu-id="5510f-328">INSTALL hello NECESSARY SOFTWARE</span></span>
#### <a name="step-1-upload-tarballs"></a><span data-ttu-id="5510f-329">Krok 1: Nahrávání tarballs</span><span class="sxs-lookup"><span data-stu-id="5510f-329">STEP 1: Upload tarballs</span></span>
<span data-ttu-id="5510f-330">Spojovací bod služby nebo pscp používáte, kopie hello dříve stažené softwaru příliš ~ / directory stahování pomocí hello příkaz formátu:</span><span class="sxs-lookup"><span data-stu-id="5510f-330">Using scp or pscp, copy hello previously downloaded software too~/downloads directory using hello following command format:</span></span>

##### <a name="pscp-server-jre-8u5-linux-x64targz-localadminhk-cas-templatecloudappnethomelocaladmindownloadsserver-jre-8u5-linux-x64targz"></a><span data-ttu-id="5510f-331">pscp server-prostředí jre-8u5-linux-x64.tar.gzlocaladmin@hk-cas-template.cloudapp.net:/home/localadmin/downloads/server-jre-8u5-linux-x64.tar.gz</span><span class="sxs-lookup"><span data-stu-id="5510f-331">pscp server-jre-8u5-linux-x64.tar.gz localadmin@hk-cas-template.cloudapp.net:/home/localadmin/downloads/server-jre-8u5-linux-x64.tar.gz</span></span>
<span data-ttu-id="5510f-332">Opakujte hello výše příkaz pro prostředí JRE také jako hello Cassandra bits.</span><span class="sxs-lookup"><span data-stu-id="5510f-332">Repeat hello above command for JRE as well as for hello Cassandra bits.</span></span>

#### <a name="step-2-prepare-hello-directory-structure-and-extract-hello-archives"></a><span data-ttu-id="5510f-333">Krok 2: Příprava hello adresářovou strukturu a extrahovat hello archivy</span><span class="sxs-lookup"><span data-stu-id="5510f-333">STEP 2: Prepare hello directory structure and extract hello archives</span></span>
<span data-ttu-id="5510f-334">Přihlaste se k hello virtuálních počítačů a vytvořit hello adresářovou strukturu a extrahovat softwaru jako superuživatele pomocí skriptu bash hello níže:</span><span class="sxs-lookup"><span data-stu-id="5510f-334">Log into hello VM and create hello directory structure and extract software as a super user using hello bash script below:</span></span>

    #!/bin/bash
    CASS_INSTALL_DIR="/opt/cassandra"
    JRE_INSTALL_DIR="/opt/java"
    CASS_DATA_DIR="/var/lib/cassandra"
    CASS_LOG_DIR="/var/log/cassandra"
    DOWNLOADS_DIR="~/downloads"
    JRE_TARBALL="server-jre-8u5-linux-x64.tar.gz"
    CASS_TARBALL="apache-cassandra-2.0.8-bin.tar.gz"
    SVC_USER="localadmin"

    RESET_ERROR=1
    MKDIR_ERROR=2

    reset_installation ()
    {
       rm -rf $CASS_INSTALL_DIR 2> /dev/null
       rm -rf $JRE_INSTALL_DIR 2> /dev/null
       rm -rf $CASS_DATA_DIR 2> /dev/null
       rm -rf $CASS_LOG_DIR 2> /dev/null
    }
    make_dir ()
    {
       if [ -z "$1" ]
       then
          echo "make_dir: invalid directory name"
          exit $MKDIR_ERROR
       fi

       if [ -d "$1" ]
       then
          echo "make_dir: directory already exists"
          exit $MKDIR_ERROR
       fi

       mkdir $1 2>/dev/null
       if [ $? != 0 ]
       then
          echo "directory creation failed"
          exit $MKDIR_ERROR
       fi
    }

    unzip()
    {
       if [ $# == 2 ]
       then
          tar xzf $1 -C $2
       else
          echo "archive error"
       fi

    }

    if [ -n "$1" ]
    then
       SVC_USER=$1
    fi

    reset_installation
    make_dir $CASS_INSTALL_DIR
    make_dir $JRE_INSTALL_DIR
    make_dir $CASS_DATA_DIR
    make_dir $CASS_LOG_DIR

    #unzip JRE and Cassandra
    unzip $HOME/downloads/$JRE_TARBALL $JRE_INSTALL_DIR
    unzip $HOME/downloads/$CASS_TARBALL $CASS_INSTALL_DIR

    #Change hello ownership toohello service credentials

    chown -R $SVC_USER:$GROUP $CASS_DATA_DIR
    chown -R $SVC_USER:$GROUP $CASS_LOG_DIR
    echo "edit /etc/profile tooadd JRE toohello PATH"
    echo "installation is complete"


<span data-ttu-id="5510f-335">Pokud tento skript můžete vložit do okna vim, ujistěte se, že tooremove hello znaků CR návratový ('\r ") pomocí hello následující příkaz:</span><span class="sxs-lookup"><span data-stu-id="5510f-335">If you paste this script into vim window, make sure tooremove hello carriage return (‘\r”) using hello following command:</span></span>

    tr -d '\r' <infile.sh >outfile.sh

#### <a name="step-3-edit-etcprofile"></a><span data-ttu-id="5510f-336">Krok 3: Úprava atd nebo profil</span><span class="sxs-lookup"><span data-stu-id="5510f-336">Step 3: Edit etc/profile</span></span>
<span data-ttu-id="5510f-337">Připojte následující hello na konci hello:</span><span class="sxs-lookup"><span data-stu-id="5510f-337">Append hello following at hello end:</span></span>

    JAVA_HOME=/opt/java/jdk1.8.0_05
    CASS_HOME= /opt/cassandra/apache-cassandra-2.0.8
    PATH=$PATH:$HOME/bin:$JAVA_HOME/bin:$CASS_HOME/bin
    export JAVA_HOME
    export CASS_HOME
    export PATH

#### <a name="step-4-install-jna-for-production-systems"></a><span data-ttu-id="5510f-338">Krok 4: Instalace JNA pro produkční systémy.</span><span class="sxs-lookup"><span data-stu-id="5510f-338">Step 4: Install JNA for production systems</span></span>
<span data-ttu-id="5510f-339">Použití hello následující příkaz pořadí: hello následující příkaz, bude instalace jna-3.2.7.jar a jna. Platforma 3.2.7.jar too/usr/share.java directory sudo výstižný get nainstalovat libjna java</span><span class="sxs-lookup"><span data-stu-id="5510f-339">Use hello following command sequence: hello following command will install jna-3.2.7.jar and jna-platform-3.2.7.jar too/usr/share.java directory sudo apt-get install libjna-java</span></span>

<span data-ttu-id="5510f-340">Vytvořte symbolické odkazy v adresáři CASS_HOME/lib $, aby tyto JAR najít Cassandra spouštěcí skript:</span><span class="sxs-lookup"><span data-stu-id="5510f-340">Create symbolic links in $CASS_HOME/lib directory so that Cassandra startup script can find these jars:</span></span>

    ln -s /usr/share/java/jna-3.2.7.jar $CASS_HOME/lib/jna.jar

    ln -s /usr/share/java/jna-platform-3.2.7.jar $CASS_HOME/lib/jna-platform.jar

#### <a name="step-5-configure-cassandrayaml"></a><span data-ttu-id="5510f-341">Krok 5: Konfigurace cassandra.yaml</span><span class="sxs-lookup"><span data-stu-id="5510f-341">Step 5: Configure cassandra.yaml</span></span>
<span data-ttu-id="5510f-342">Upravte cassandra.yaml na každý tooreflect konfigurace virtuálního počítače potřebné pro všechny virtuální počítače hello [jsme se vylepšení to při zřizování skutečné hello]:</span><span class="sxs-lookup"><span data-stu-id="5510f-342">Edit cassandra.yaml on each VM tooreflect configuration needed by all hello virtual machines [we will tweak this during hello actual provisioning]:</span></span>

<table>
<tr><th><span data-ttu-id="5510f-343">Název pole</span><span class="sxs-lookup"><span data-stu-id="5510f-343">Field Name</span></span>   </th><th> <span data-ttu-id="5510f-344">Hodnota</span><span class="sxs-lookup"><span data-stu-id="5510f-344">Value</span></span>  </th><th>    <span data-ttu-id="5510f-345">Poznámky</span><span class="sxs-lookup"><span data-stu-id="5510f-345">Remarks</span></span> </th></tr>
<tr><td><span data-ttu-id="5510f-346">název_clusteru</span><span class="sxs-lookup"><span data-stu-id="5510f-346">cluster_name</span></span> </td><td>    <span data-ttu-id="5510f-347">"CustomerService"</span><span class="sxs-lookup"><span data-stu-id="5510f-347">“CustomerService”</span></span>    </td><td> <span data-ttu-id="5510f-348">Použít hello název, který se vztahuje k nasazení</span><span class="sxs-lookup"><span data-stu-id="5510f-348">Use hello name that reflects your deployment</span></span></td></tr>
<tr><td><span data-ttu-id="5510f-349">listen_address</span><span class="sxs-lookup"><span data-stu-id="5510f-349">listen_address</span></span>    </td><td><span data-ttu-id="5510f-350">[necháte prázdné]</span><span class="sxs-lookup"><span data-stu-id="5510f-350">[leave it blank]</span></span>    </td><td> <span data-ttu-id="5510f-351">Odstranit "localhost"</span><span class="sxs-lookup"><span data-stu-id="5510f-351">Delete “localhost”</span></span> </td></tr>
<tr><td><span data-ttu-id="5510f-352">rpc_addres</span><span class="sxs-lookup"><span data-stu-id="5510f-352">rpc_addres</span></span>   </td><td><span data-ttu-id="5510f-353">[necháte prázdné]</span><span class="sxs-lookup"><span data-stu-id="5510f-353">[leave it blank]</span></span>    </td><td> <span data-ttu-id="5510f-354">Odstranit "localhost"</span><span class="sxs-lookup"><span data-stu-id="5510f-354">Delete “localhost”</span></span> </td></tr>
<tr><td><span data-ttu-id="5510f-355">semen</span><span class="sxs-lookup"><span data-stu-id="5510f-355">seeds</span></span>    </td><td><span data-ttu-id="5510f-356">"10.1.2.4, 10.1.2.6, 10.1.2.8"</span><span class="sxs-lookup"><span data-stu-id="5510f-356">"10.1.2.4, 10.1.2.6, 10.1.2.8"</span></span>    </td><td><span data-ttu-id="5510f-357">Seznam všech hello IP adres, které jsou určené jako vstupní.</span><span class="sxs-lookup"><span data-stu-id="5510f-357">List of  all hello IP addresses which are designated as seeds.</span></span></td></tr>
<tr><td><span data-ttu-id="5510f-358">endpoint_snitch</span><span class="sxs-lookup"><span data-stu-id="5510f-358">endpoint_snitch</span></span> </td><td> <span data-ttu-id="5510f-359">org.apache.cassandra.locator.GossipingPropertyFileSnitch</span><span class="sxs-lookup"><span data-stu-id="5510f-359">org.apache.cassandra.locator.GossipingPropertyFileSnitch</span></span> </td><td> <span data-ttu-id="5510f-360">Toto je používáno hello NetworkTopologyStrateg pro odvození hello datového centra a hello stojany hello virtuálních počítačů</span><span class="sxs-lookup"><span data-stu-id="5510f-360">This is used by hello NetworkTopologyStrateg for inferring hello data center and hello rack of hello VM</span></span></td></tr>
</table>

#### <a name="step-6-capture-hello-vm-image"></a><span data-ttu-id="5510f-361">Krok 6: Zachycení image virtuálního počítače hello</span><span class="sxs-lookup"><span data-stu-id="5510f-361">Step 6: Capture hello VM image</span></span>
<span data-ttu-id="5510f-362">Přihlaste se k hello virtuálního počítače pomocí názvu hostitele hello (hk template.cloudapp.net certifikační autority) a hello SSH privátní klíč dříve vytvořili.</span><span class="sxs-lookup"><span data-stu-id="5510f-362">Log into hello virtual machine using hello hostname (hk-cas-template.cloudapp.net) and hello SSH private key previously created.</span></span> <span data-ttu-id="5510f-363">V tématu Jak tooUse SSH s Linuxem v Azure pro podrobnosti na tom, jak toolog pomocí hello příkazu ssh nebo putty.exe.</span><span class="sxs-lookup"><span data-stu-id="5510f-363">See How tooUse SSH with Linux on Azure for details on how toolog in using hello command ssh or putty.exe.</span></span>

<span data-ttu-id="5510f-364">Spusťte následující posloupnost akcí toocapture hello image hello:</span><span class="sxs-lookup"><span data-stu-id="5510f-364">Execute hello following sequence of actions toocapture hello image:</span></span>

##### <a name="1-deprovision"></a><span data-ttu-id="5510f-365">1. Deprovision</span><span class="sxs-lookup"><span data-stu-id="5510f-365">1. Deprovision</span></span>
<span data-ttu-id="5510f-366">Použijte hello příkaz "sudo příkaz waagent – deprovision + uživatele" tooremove konkrétní informace o instanci virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="5510f-366">Use hello command “sudo waagent –deprovision+user” tooremove Virtual Machine instance specific information.</span></span> <span data-ttu-id="5510f-367">Zobrazit [jak tooCapture virtuální počítač s Linuxem](capture-image.md) tooUse jako šablona více podrobností na proces zachycení image hello.</span><span class="sxs-lookup"><span data-stu-id="5510f-367">See for [How tooCapture a Linux Virtual Machine](capture-image.md) tooUse as a Template more details on hello image capture process.</span></span>

##### <a name="2-shutdown-hello-vm"></a><span data-ttu-id="5510f-368">2: hello vypnutí virtuálního počítače</span><span class="sxs-lookup"><span data-stu-id="5510f-368">2: Shutdown hello VM</span></span>
<span data-ttu-id="5510f-369">Ujistěte se, že je označený hello virtuálního počítače a klikněte na odkaz vypnutí hello z hello dolní příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="5510f-369">Make sure that hello virtual machine is highlighted and click hello SHUTDOWN link from hello bottom command bar.</span></span>

##### <a name="3-capture-hello-image"></a><span data-ttu-id="5510f-370">3: hello přípravné bitové kopie</span><span class="sxs-lookup"><span data-stu-id="5510f-370">3: Capture hello image</span></span>
<span data-ttu-id="5510f-371">Ujistěte se, že je označený hello virtuálního počítače a klikněte na odkaz zachycení hello z hello dolní příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="5510f-371">Make sure that hello virtual machine is highlighted and click hello CAPTURE link from hello bottom command bar.</span></span> <span data-ttu-id="5510f-372">Na další obrazovce hello zadejte název bitové kopie (například hk-cas-2-08-ub-14-04-2014071), příslušné popis bitové kopie a klikněte na označit "kontrola" hello, toofinish proces zachycení hello.</span><span class="sxs-lookup"><span data-stu-id="5510f-372">In hello next screen, give an IMAGE NAME (e.g. hk-cas-2-08-ub-14-04-2014071), appropriate IMAGE DESCRIPTION, and click hello “check” mark toofinish hello CAPTURE process.</span></span>

<span data-ttu-id="5510f-373">Bude to trvat několik sekund a hello obrázku musí být k dispozici v části Moje Image z Galerie obrázků hello.</span><span class="sxs-lookup"><span data-stu-id="5510f-373">This will take a few seconds and hello image should be available in MY IMAGES section of hello image gallery.</span></span> <span data-ttu-id="5510f-374">Hello zdrojového virtuálního počítače se automaticky odstraní po úspěšně zachycení bitové kopie hello.</span><span class="sxs-lookup"><span data-stu-id="5510f-374">hello source VM will be automatically deleted after hello image is successfully captured.</span></span> 

## <a name="single-region-deployment-process"></a><span data-ttu-id="5510f-375">Proces nasazení jedné oblasti</span><span class="sxs-lookup"><span data-stu-id="5510f-375">Single Region Deployment Process</span></span>
<span data-ttu-id="5510f-376">**Krok 1: Vytvoření virtuální sítě hello** Přihlaste se k hello portál Azure a vytvoření virtuální sítě (klasické) s atributy hello uvedené v následující tabulce hello.</span><span class="sxs-lookup"><span data-stu-id="5510f-376">**Step 1: Create hello Virtual Network** Log into hello Azure portal and create a virtual network (classic) with hello attributes shown in hello following table.</span></span> <span data-ttu-id="5510f-377">V tématu [vytvoření virtuální sítě (klasické) pomocí portálu Azure hello](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) podrobné kroky procesu hello.</span><span class="sxs-lookup"><span data-stu-id="5510f-377">See [Create a virtual network (classic) using hello Azure portal](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) for detailed steps of hello process.</span></span>      

<table>
<tr><th><span data-ttu-id="5510f-378">Atribut název virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="5510f-378">VM Attribute Name</span></span></th><th><span data-ttu-id="5510f-379">Hodnota</span><span class="sxs-lookup"><span data-stu-id="5510f-379">Value</span></span></th><th><span data-ttu-id="5510f-380">Poznámky</span><span class="sxs-lookup"><span data-stu-id="5510f-380">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="5510f-381">Name (Název)</span><span class="sxs-lookup"><span data-stu-id="5510f-381">Name</span></span></td><td><span data-ttu-id="5510f-382">vnet-cass západní USA</span><span class="sxs-lookup"><span data-stu-id="5510f-382">vnet-cass-west-us</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="5510f-383">Oblast</span><span class="sxs-lookup"><span data-stu-id="5510f-383">Region</span></span></td><td><span data-ttu-id="5510f-384">Západní USA</span><span class="sxs-lookup"><span data-stu-id="5510f-384">West US</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="5510f-385">Servery DNS</span><span class="sxs-lookup"><span data-stu-id="5510f-385">DNS Servers</span></span></td><td><span data-ttu-id="5510f-386">Žádný</span><span class="sxs-lookup"><span data-stu-id="5510f-386">None</span></span></td><td><span data-ttu-id="5510f-387">Toto ignorovat, protože jsme nejsou pomocí serveru DNS</span><span class="sxs-lookup"><span data-stu-id="5510f-387">Ignore this as we are not using a DNS Server</span></span></td></tr>
<tr><td><span data-ttu-id="5510f-388">Adresní prostor</span><span class="sxs-lookup"><span data-stu-id="5510f-388">Address Space</span></span></td><td><span data-ttu-id="5510f-389">10.1.0.0/16</span><span class="sxs-lookup"><span data-stu-id="5510f-389">10.1.0.0/16</span></span></td><td></td></tr>    
<tr><td><span data-ttu-id="5510f-390">Počáteční IP adresu</span><span class="sxs-lookup"><span data-stu-id="5510f-390">Starting IP</span></span></td><td><span data-ttu-id="5510f-391">10.1.0.0</span><span class="sxs-lookup"><span data-stu-id="5510f-391">10.1.0.0</span></span></td><td></td></tr>    
<tr><td><span data-ttu-id="5510f-392">CIDR</span><span class="sxs-lookup"><span data-stu-id="5510f-392">CIDR</span></span> </td><td><span data-ttu-id="5510f-393">/16 (65531)</span><span class="sxs-lookup"><span data-stu-id="5510f-393">/16 (65531)</span></span></td><td></td></tr>
</table>

<span data-ttu-id="5510f-394">Přidejte hello následující podsítě:</span><span class="sxs-lookup"><span data-stu-id="5510f-394">Add hello following subnets:</span></span>

<table>
<tr><th><span data-ttu-id="5510f-395">Name (Název)</span><span class="sxs-lookup"><span data-stu-id="5510f-395">Name</span></span></th><th><span data-ttu-id="5510f-396">Počáteční IP adresu</span><span class="sxs-lookup"><span data-stu-id="5510f-396">Starting IP</span></span></th><th><span data-ttu-id="5510f-397">CIDR</span><span class="sxs-lookup"><span data-stu-id="5510f-397">CIDR</span></span></th><th><span data-ttu-id="5510f-398">Poznámky</span><span class="sxs-lookup"><span data-stu-id="5510f-398">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="5510f-399">webové</span><span class="sxs-lookup"><span data-stu-id="5510f-399">web</span></span></td><td><span data-ttu-id="5510f-400">10.1.1.0</span><span class="sxs-lookup"><span data-stu-id="5510f-400">10.1.1.0</span></span></td><td><span data-ttu-id="5510f-401">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="5510f-401">/24 (251)</span></span></td><td><span data-ttu-id="5510f-402">Podsíť pro hello webové farmy</span><span class="sxs-lookup"><span data-stu-id="5510f-402">Subnet for hello web farm</span></span></td></tr>
<tr><td><span data-ttu-id="5510f-403">data</span><span class="sxs-lookup"><span data-stu-id="5510f-403">data</span></span></td><td><span data-ttu-id="5510f-404">10.1.2.0</span><span class="sxs-lookup"><span data-stu-id="5510f-404">10.1.2.0</span></span></td><td><span data-ttu-id="5510f-405">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="5510f-405">/24 (251)</span></span></td><td><span data-ttu-id="5510f-406">Podsíť pro uzly databáze hello</span><span class="sxs-lookup"><span data-stu-id="5510f-406">Subnet for hello database nodes</span></span></td></tr>
</table>

<span data-ttu-id="5510f-407">Data a webové podsítě se dají chránit pomocí skupin zabezpečení sítě hello pokrytí se sahá nad rámec tohoto článku.</span><span class="sxs-lookup"><span data-stu-id="5510f-407">Data and Web subnets can be protected through network security groups hello coverage of which is out of scope for this article.</span></span>  

<span data-ttu-id="5510f-408">**Krok 2: Zřizování virtuálních počítačů** pomocí bitové kopie hello vytvořili dříve, bude vytvoření hello následující virtuální počítače v cloudu hello serveru "hk c-svc západ" a navázat je toohello příslušných podsítí, jak je uvedeno níže:</span><span class="sxs-lookup"><span data-stu-id="5510f-408">**Step 2: Provision Virtual Machines** Using hello image created previously, we will create hello following virtual machines in hello cloud server “hk-c-svc-west” and bind them toohello respective subnets as shown below:</span></span>

<table>
<tr><th><span data-ttu-id="5510f-409">Název počítače</span><span class="sxs-lookup"><span data-stu-id="5510f-409">Machine Name</span></span>    </th><th><span data-ttu-id="5510f-410">Podsíť</span><span class="sxs-lookup"><span data-stu-id="5510f-410">Subnet</span></span>    </th><th><span data-ttu-id="5510f-411">IP adresa</span><span class="sxs-lookup"><span data-stu-id="5510f-411">IP Address</span></span>    </th><th><span data-ttu-id="5510f-412">Skupina dostupnosti</span><span class="sxs-lookup"><span data-stu-id="5510f-412">Availability set</span></span></th><th><span data-ttu-id="5510f-413">DC/Rack</span><span class="sxs-lookup"><span data-stu-id="5510f-413">DC/Rack</span></span></th><th><span data-ttu-id="5510f-414">Počáteční hodnoty?</span><span class="sxs-lookup"><span data-stu-id="5510f-414">Seed?</span></span></th></tr>
<tr><td><span data-ttu-id="5510f-415">(Hong Kong) c1-západní USA</span><span class="sxs-lookup"><span data-stu-id="5510f-415">hk-c1-west-us</span></span>    </td><td><span data-ttu-id="5510f-416">data</span><span class="sxs-lookup"><span data-stu-id="5510f-416">data</span></span>    </td><td><span data-ttu-id="5510f-417">10.1.2.4</span><span class="sxs-lookup"><span data-stu-id="5510f-417">10.1.2.4</span></span>    </td><td><span data-ttu-id="5510f-418">(Hong Kong) c sada-1</span><span class="sxs-lookup"><span data-stu-id="5510f-418">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="5510f-419">DC = WESTUS rack = rack1</span><span class="sxs-lookup"><span data-stu-id="5510f-419">dc =WESTUS rack =rack1</span></span> </td><td><span data-ttu-id="5510f-420">Ano</span><span class="sxs-lookup"><span data-stu-id="5510f-420">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="5510f-421">(Hong Kong) c2-západní USA</span><span class="sxs-lookup"><span data-stu-id="5510f-421">hk-c2-west-us</span></span>    </td><td><span data-ttu-id="5510f-422">data</span><span class="sxs-lookup"><span data-stu-id="5510f-422">data</span></span>    </td><td><span data-ttu-id="5510f-423">10.1.2.5</span><span class="sxs-lookup"><span data-stu-id="5510f-423">10.1.2.5</span></span>    </td><td><span data-ttu-id="5510f-424">(Hong Kong) c sada-1</span><span class="sxs-lookup"><span data-stu-id="5510f-424">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="5510f-425">DC = WESTUS rack = rack1</span><span class="sxs-lookup"><span data-stu-id="5510f-425">dc =WESTUS rack =rack1</span></span>    </td><td><span data-ttu-id="5510f-426">Ne</span><span class="sxs-lookup"><span data-stu-id="5510f-426">No</span></span> </td></tr>
<tr><td><span data-ttu-id="5510f-427">(Hong Kong) c3-západní USA</span><span class="sxs-lookup"><span data-stu-id="5510f-427">hk-c3-west-us</span></span>    </td><td><span data-ttu-id="5510f-428">data</span><span class="sxs-lookup"><span data-stu-id="5510f-428">data</span></span>    </td><td><span data-ttu-id="5510f-429">10.1.2.6</span><span class="sxs-lookup"><span data-stu-id="5510f-429">10.1.2.6</span></span>    </td><td><span data-ttu-id="5510f-430">(Hong Kong) c sada-1</span><span class="sxs-lookup"><span data-stu-id="5510f-430">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="5510f-431">DC = WESTUS rack = rack2</span><span class="sxs-lookup"><span data-stu-id="5510f-431">dc =WESTUS rack =rack2</span></span>    </td><td><span data-ttu-id="5510f-432">Ano</span><span class="sxs-lookup"><span data-stu-id="5510f-432">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="5510f-433">(Hong Kong) c4-západní USA</span><span class="sxs-lookup"><span data-stu-id="5510f-433">hk-c4-west-us</span></span>    </td><td><span data-ttu-id="5510f-434">data</span><span class="sxs-lookup"><span data-stu-id="5510f-434">data</span></span>    </td><td><span data-ttu-id="5510f-435">10.1.2.7</span><span class="sxs-lookup"><span data-stu-id="5510f-435">10.1.2.7</span></span>    </td><td><span data-ttu-id="5510f-436">(Hong Kong) c sada-1</span><span class="sxs-lookup"><span data-stu-id="5510f-436">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="5510f-437">DC = WESTUS rack = rack2</span><span class="sxs-lookup"><span data-stu-id="5510f-437">dc =WESTUS rack =rack2</span></span>    </td><td><span data-ttu-id="5510f-438">Ne</span><span class="sxs-lookup"><span data-stu-id="5510f-438">No</span></span> </td></tr>
<tr><td><span data-ttu-id="5510f-439">(Hong Kong) c5-západní USA</span><span class="sxs-lookup"><span data-stu-id="5510f-439">hk-c5-west-us</span></span>    </td><td><span data-ttu-id="5510f-440">data</span><span class="sxs-lookup"><span data-stu-id="5510f-440">data</span></span>    </td><td><span data-ttu-id="5510f-441">10.1.2.8</span><span class="sxs-lookup"><span data-stu-id="5510f-441">10.1.2.8</span></span>    </td><td><span data-ttu-id="5510f-442">(Hong Kong) c sada-2</span><span class="sxs-lookup"><span data-stu-id="5510f-442">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="5510f-443">DC = WESTUS rack = rack3</span><span class="sxs-lookup"><span data-stu-id="5510f-443">dc =WESTUS rack =rack3</span></span>    </td><td><span data-ttu-id="5510f-444">Ano</span><span class="sxs-lookup"><span data-stu-id="5510f-444">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="5510f-445">(Hong Kong) c6-západní USA</span><span class="sxs-lookup"><span data-stu-id="5510f-445">hk-c6-west-us</span></span>    </td><td><span data-ttu-id="5510f-446">data</span><span class="sxs-lookup"><span data-stu-id="5510f-446">data</span></span>    </td><td><span data-ttu-id="5510f-447">10.1.2.9</span><span class="sxs-lookup"><span data-stu-id="5510f-447">10.1.2.9</span></span>    </td><td><span data-ttu-id="5510f-448">(Hong Kong) c sada-2</span><span class="sxs-lookup"><span data-stu-id="5510f-448">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="5510f-449">DC = WESTUS rack = rack3</span><span class="sxs-lookup"><span data-stu-id="5510f-449">dc =WESTUS rack =rack3</span></span>    </td><td><span data-ttu-id="5510f-450">Ne</span><span class="sxs-lookup"><span data-stu-id="5510f-450">No</span></span> </td></tr>
<tr><td><span data-ttu-id="5510f-451">(Hong Kong)-s c7 – západní USA</span><span class="sxs-lookup"><span data-stu-id="5510f-451">hk-c7-west-us</span></span>    </td><td><span data-ttu-id="5510f-452">data</span><span class="sxs-lookup"><span data-stu-id="5510f-452">data</span></span>    </td><td><span data-ttu-id="5510f-453">10.1.2.10</span><span class="sxs-lookup"><span data-stu-id="5510f-453">10.1.2.10</span></span>    </td><td><span data-ttu-id="5510f-454">(Hong Kong) c sada-2</span><span class="sxs-lookup"><span data-stu-id="5510f-454">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="5510f-455">DC = WESTUS rack = rack4</span><span class="sxs-lookup"><span data-stu-id="5510f-455">dc =WESTUS rack =rack4</span></span>    </td><td><span data-ttu-id="5510f-456">Ano</span><span class="sxs-lookup"><span data-stu-id="5510f-456">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="5510f-457">(Hong Kong) c8-západní USA</span><span class="sxs-lookup"><span data-stu-id="5510f-457">hk-c8-west-us</span></span>    </td><td><span data-ttu-id="5510f-458">data</span><span class="sxs-lookup"><span data-stu-id="5510f-458">data</span></span>    </td><td><span data-ttu-id="5510f-459">10.1.2.11</span><span class="sxs-lookup"><span data-stu-id="5510f-459">10.1.2.11</span></span>    </td><td><span data-ttu-id="5510f-460">(Hong Kong) c sada-2</span><span class="sxs-lookup"><span data-stu-id="5510f-460">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="5510f-461">DC = WESTUS rack = rack4</span><span class="sxs-lookup"><span data-stu-id="5510f-461">dc =WESTUS rack =rack4</span></span>    </td><td><span data-ttu-id="5510f-462">Ne</span><span class="sxs-lookup"><span data-stu-id="5510f-462">No</span></span> </td></tr>
<tr><td><span data-ttu-id="5510f-463">(Hong Kong) w1 – západní USA</span><span class="sxs-lookup"><span data-stu-id="5510f-463">hk-w1-west-us</span></span>    </td><td><span data-ttu-id="5510f-464">webové</span><span class="sxs-lookup"><span data-stu-id="5510f-464">web</span></span>    </td><td><span data-ttu-id="5510f-465">10.1.1.4</span><span class="sxs-lookup"><span data-stu-id="5510f-465">10.1.1.4</span></span>    </td><td><span data-ttu-id="5510f-466">(Hong Kong) w sada-1</span><span class="sxs-lookup"><span data-stu-id="5510f-466">hk-w-aset-1</span></span>    </td><td>                       </td><td><span data-ttu-id="5510f-467">Není k dispozici</span><span class="sxs-lookup"><span data-stu-id="5510f-467">N/A</span></span></td></tr>
<tr><td><span data-ttu-id="5510f-468">(Hong Kong) w2 – západní USA</span><span class="sxs-lookup"><span data-stu-id="5510f-468">hk-w2-west-us</span></span>    </td><td><span data-ttu-id="5510f-469">webové</span><span class="sxs-lookup"><span data-stu-id="5510f-469">web</span></span>    </td><td><span data-ttu-id="5510f-470">10.1.1.5</span><span class="sxs-lookup"><span data-stu-id="5510f-470">10.1.1.5</span></span>    </td><td><span data-ttu-id="5510f-471">(Hong Kong) w sada-1</span><span class="sxs-lookup"><span data-stu-id="5510f-471">hk-w-aset-1</span></span>    </td><td>                       </td><td><span data-ttu-id="5510f-472">Není k dispozici</span><span class="sxs-lookup"><span data-stu-id="5510f-472">N/A</span></span></td></tr>
</table>

<span data-ttu-id="5510f-473">Vytvoření hello výše seznam virtuálních počítačů vyžaduje hello následující proces:</span><span class="sxs-lookup"><span data-stu-id="5510f-473">Creation of hello above list of VMs requires hello following process:</span></span>

1. <span data-ttu-id="5510f-474">Vytvoření prázdné cloudové služby v určité oblasti.</span><span class="sxs-lookup"><span data-stu-id="5510f-474">Create an empty cloud service in a particular region</span></span>
2. <span data-ttu-id="5510f-475">Vytvoření virtuálního počítače z hello dříve zaznamenané bitové kopie a připojte ji toohello virtuální sítě vytvořené dříve; Tento postup opakujte pro všechny virtuální počítače hello</span><span class="sxs-lookup"><span data-stu-id="5510f-475">Create a VM from hello previously captured image and attach it toohello virtual network created previously; repeat this for all hello VMs</span></span>
3. <span data-ttu-id="5510f-476">Přidejte cloudové služby interní služby load vyrovnávání toohello a připojte ji podsíť toohello "data.</span><span class="sxs-lookup"><span data-stu-id="5510f-476">Add an internal load balancer toohello cloud service and attach it toohello “data” subnet</span></span>
4. <span data-ttu-id="5510f-477">Pro každý virtuální počítač předtím vytvořili přidáte koncový bod Vyrovnávání zatížení pro provoz thrift prostřednictvím Vyrovnávání zatížení interní skupinu s vyrovnáváním zatížení připojený sadu toohello vytvořili</span><span class="sxs-lookup"><span data-stu-id="5510f-477">For each VM created previously, add a load balanced endpoint for thrift traffic through a load balanced set connected toohello previously created internal load balancer</span></span>

<span data-ttu-id="5510f-478">Hello výše proces lze provést pomocí portálu Azure classic; počítače s Windows (použití a virtuálních počítačů v Azure, pokud nemáte počítač Windows tooa přístup), použijte všechny virtuální počítače 8 automaticky používat hello následující tooprovision skript prostředí PowerShell.</span><span class="sxs-lookup"><span data-stu-id="5510f-478">hello above process can be executed using Azure classic portal; use a Windows machine (use a VM on Azure if you don't have access tooa Windows machine), use hello following PowerShell script tooprovision all 8 VMs automatically.</span></span>

<span data-ttu-id="5510f-479">**Seznam 1: Skript prostředí PowerShell pro zřizování virtuálních počítačů**</span><span class="sxs-lookup"><span data-stu-id="5510f-479">**List 1: PowerShell script for provisioning virtual machines**</span></span>

        #Tested with Azure Powershell - November 2014
        #This powershell script deployes a number of VMs from an existing image inside an Azure region
        #Import your Azure subscription into hello current Powershell session before proceeding
        #hello process: 1. create Azure Storage account, 2. create virtual network, 3.create hello VM template, 2. crate a list of VMs from hello template

        #fundamental variables - change these tooreflect your subscription
        $country="us"; $region="west"; $vnetName = "your_vnet_name";$storageAccount="your_storage_account"
        $numVMs=8;$prefix = "hk-cass";$ilbIP="your_ilb_ip"
        $subscriptionName = "Azure_subscription_name";
        $vmSize="ExtraSmall"; $imageName="your_linux_image_name"
        $ilbName="ThriftInternalLB"; $thriftEndPoint="ThriftEndPoint"

        #generated variables
        $serviceName = "$prefix-svc-$region-$country"; $azureRegion = "$region $country"

        $vmNames = @()
        for ($i=0; $i -lt $numVMs; $i++)
        {
           $vmNames+=("$prefix-vm"+($i+1) + "-$region-$country" );
        }

        #select an Azure subscription already imported into Powershell session
        Select-AzureSubscription -SubscriptionName $subscriptionName -Current
        Set-AzureSubscription -SubscriptionName $subscriptionName -CurrentStorageAccountName $storageAccount

        #create an empty cloud service
        New-AzureService -ServiceName $serviceName -Label "hkcass$region" -Location $azureRegion
        Write-Host "Created $serviceName"

        $VMList= @()   # stores hello list of azure vm configuration objects
        #create hello list of VMs
        foreach($vmName in $vmNames)
        {
           $VMList += New-AzureVMConfig -Name $vmName -InstanceSize ExtraSmall -ImageName $imageName |
           Add-AzureProvisioningConfig -Linux -LinuxUser "localadmin" -Password "Local123" |
           Set-AzureSubnet "data"
        }

        New-AzureVM -ServiceName $serviceName -VNetName $vnetName -VMs $VMList

        #Create internal load balancer
        Add-AzureInternalLoadBalancer -ServiceName $serviceName -InternalLoadBalancerName $ilbName -SubnetName "data" -StaticVNetIPAddress "$ilbIP"
        Write-Host "Created $ilbName"
        #Add add hello thrift endpoint toohello internal load balancer for all hello VMs
        foreach($vmName in $vmNames)
        {
            Get-AzureVM -ServiceName $serviceName -Name $vmName |
                Add-AzureEndpoint -Name $thriftEndPoint -LBSetName "ThriftLBSet" -Protocol tcp -LocalPort 9160 -PublicPort 9160 -ProbePort 9160 -ProbeProtocol tcp -ProbeIntervalInSeconds 10 -InternalLoadBalancerName $ilbName |
                Update-AzureVM

            Write-Host "created $vmName"     
        }

<span data-ttu-id="5510f-480">**Krok 3: Konfigurace Cassandra na jednotlivé virtuální počítače**</span><span class="sxs-lookup"><span data-stu-id="5510f-480">**Step 3: Configure Cassandra on each VM**</span></span>

<span data-ttu-id="5510f-481">Přihlaste se k hello virtuálního počítače a provádět hello následující:</span><span class="sxs-lookup"><span data-stu-id="5510f-481">Log into hello VM and perform hello following:</span></span>

* <span data-ttu-id="5510f-482">Upravte $CASS_HOME/conf/cassandra-rackdc.properties toospecify hello datového centra a rack vlastnosti:</span><span class="sxs-lookup"><span data-stu-id="5510f-482">Edit $CASS_HOME/conf/cassandra-rackdc.properties toospecify hello data center and rack properties:</span></span>
  
       dc =EASTUS, rack =rack1
* <span data-ttu-id="5510f-483">Upravte uzly počáteční hodnoty tooconfigure cassandra.yaml jak je uvedeno níže:</span><span class="sxs-lookup"><span data-stu-id="5510f-483">Edit cassandra.yaml tooconfigure seed nodes as below:</span></span>
  
       Seeds: "10.1.2.4,10.1.2.6,10.1.2.8,10.1.2.10"

<span data-ttu-id="5510f-484">**Krok 4: Spuštění hello virtuální počítače a otestovat hello clusteru**</span><span class="sxs-lookup"><span data-stu-id="5510f-484">**Step 4: Start hello VMs and test hello cluster**</span></span>

<span data-ttu-id="5510f-485">Přihlášení do jednoho z uzlů hello, (například (Hong Kong) c1-západní us) a hello spusťte následující příkaz toosee hello stav hello clusteru:</span><span class="sxs-lookup"><span data-stu-id="5510f-485">Log into one of hello nodes (e.g. hk-c1-west-us) and run hello following command toosee hello status of hello cluster:</span></span>

       nodetool –h 10.1.2.4 –p 7199 status

<span data-ttu-id="5510f-486">Měli byste vidět hello zobrazení podobné toohello jeden níže 8 uzlů clusteru:</span><span class="sxs-lookup"><span data-stu-id="5510f-486">You should see hello display similar toohello one below for an 8-node cluster:</span></span>

<table>
<tr><th><span data-ttu-id="5510f-487">Status</span><span class="sxs-lookup"><span data-stu-id="5510f-487">Status</span></span></th><th><span data-ttu-id="5510f-488">Adresa</span><span class="sxs-lookup"><span data-stu-id="5510f-488">Address</span></span>    </th><th><span data-ttu-id="5510f-489">Načtení</span><span class="sxs-lookup"><span data-stu-id="5510f-489">Load</span></span>    </th><th><span data-ttu-id="5510f-490">Tokeny</span><span class="sxs-lookup"><span data-stu-id="5510f-490">Tokens</span></span>    </th><th><span data-ttu-id="5510f-491">Vlastní</span><span class="sxs-lookup"><span data-stu-id="5510f-491">Owns</span></span> </th><th><span data-ttu-id="5510f-492">ID hostitele</span><span class="sxs-lookup"><span data-stu-id="5510f-492">Host ID</span></span>    </th><th><span data-ttu-id="5510f-493">Rack</span><span class="sxs-lookup"><span data-stu-id="5510f-493">Rack</span></span></th></tr>
<tr><th><span data-ttu-id="5510f-494">ZRUŠENÍ</span><span class="sxs-lookup"><span data-stu-id="5510f-494">UN</span></span>    </td><td><span data-ttu-id="5510f-495">10.1.2.4</span><span class="sxs-lookup"><span data-stu-id="5510f-495">10.1.2.4</span></span>     </td><td><span data-ttu-id="5510f-496">87.81 KB</span><span class="sxs-lookup"><span data-stu-id="5510f-496">87.81 KB</span></span>    </td><td><span data-ttu-id="5510f-497">256</span><span class="sxs-lookup"><span data-stu-id="5510f-497">256</span></span>    </td><td><span data-ttu-id="5510f-498">38.0%</span><span class="sxs-lookup"><span data-stu-id="5510f-498">38.0%</span></span>    </td><td><span data-ttu-id="5510f-499">Identifikátor GUID (odebrat)</span><span class="sxs-lookup"><span data-stu-id="5510f-499">Guid (removed)</span></span></td><td><span data-ttu-id="5510f-500">rack1</span><span class="sxs-lookup"><span data-stu-id="5510f-500">rack1</span></span></td></tr>
<tr><th><span data-ttu-id="5510f-501">ZRUŠENÍ</span><span class="sxs-lookup"><span data-stu-id="5510f-501">UN</span></span>    </td><td><span data-ttu-id="5510f-502">10.1.2.5</span><span class="sxs-lookup"><span data-stu-id="5510f-502">10.1.2.5</span></span>     </td><td><span data-ttu-id="5510f-503">41.08 KB</span><span class="sxs-lookup"><span data-stu-id="5510f-503">41.08 KB</span></span>    </td><td><span data-ttu-id="5510f-504">256</span><span class="sxs-lookup"><span data-stu-id="5510f-504">256</span></span>    </td><td><span data-ttu-id="5510f-505">68.9%</span><span class="sxs-lookup"><span data-stu-id="5510f-505">68.9%</span></span>    </td><td><span data-ttu-id="5510f-506">Identifikátor GUID (odebrat)</span><span class="sxs-lookup"><span data-stu-id="5510f-506">Guid (removed)</span></span></td><td><span data-ttu-id="5510f-507">rack1</span><span class="sxs-lookup"><span data-stu-id="5510f-507">rack1</span></span></td></tr>
<tr><th><span data-ttu-id="5510f-508">ZRUŠENÍ</span><span class="sxs-lookup"><span data-stu-id="5510f-508">UN</span></span>    </td><td><span data-ttu-id="5510f-509">10.1.2.6</span><span class="sxs-lookup"><span data-stu-id="5510f-509">10.1.2.6</span></span>     </td><td><span data-ttu-id="5510f-510">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="5510f-510">55.29 KB</span></span>    </td><td><span data-ttu-id="5510f-511">256</span><span class="sxs-lookup"><span data-stu-id="5510f-511">256</span></span>    </td><td><span data-ttu-id="5510f-512">68.8%</span><span class="sxs-lookup"><span data-stu-id="5510f-512">68.8%</span></span>    </td><td><span data-ttu-id="5510f-513">Identifikátor GUID (odebrat)</span><span class="sxs-lookup"><span data-stu-id="5510f-513">Guid (removed)</span></span></td><td><span data-ttu-id="5510f-514">rack2</span><span class="sxs-lookup"><span data-stu-id="5510f-514">rack2</span></span></td></tr>
<tr><th><span data-ttu-id="5510f-515">ZRUŠENÍ</span><span class="sxs-lookup"><span data-stu-id="5510f-515">UN</span></span>    </td><td><span data-ttu-id="5510f-516">10.1.2.7</span><span class="sxs-lookup"><span data-stu-id="5510f-516">10.1.2.7</span></span>     </td><td><span data-ttu-id="5510f-517">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="5510f-517">55.29 KB</span></span>    </td><td><span data-ttu-id="5510f-518">256</span><span class="sxs-lookup"><span data-stu-id="5510f-518">256</span></span>    </td><td><span data-ttu-id="5510f-519">68.8%</span><span class="sxs-lookup"><span data-stu-id="5510f-519">68.8%</span></span>    </td><td><span data-ttu-id="5510f-520">Identifikátor GUID (odebrat)</span><span class="sxs-lookup"><span data-stu-id="5510f-520">Guid (removed)</span></span></td><td><span data-ttu-id="5510f-521">rack2</span><span class="sxs-lookup"><span data-stu-id="5510f-521">rack2</span></span></td></tr>
<tr><th><span data-ttu-id="5510f-522">ZRUŠENÍ</span><span class="sxs-lookup"><span data-stu-id="5510f-522">UN</span></span>    </td><td><span data-ttu-id="5510f-523">10.1.2.8</span><span class="sxs-lookup"><span data-stu-id="5510f-523">10.1.2.8</span></span>     </td><td><span data-ttu-id="5510f-524">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="5510f-524">55.29 KB</span></span>    </td><td><span data-ttu-id="5510f-525">256</span><span class="sxs-lookup"><span data-stu-id="5510f-525">256</span></span>    </td><td><span data-ttu-id="5510f-526">68.8%</span><span class="sxs-lookup"><span data-stu-id="5510f-526">68.8%</span></span>    </td><td><span data-ttu-id="5510f-527">Identifikátor GUID (odebrat)</span><span class="sxs-lookup"><span data-stu-id="5510f-527">Guid (removed)</span></span></td><td><span data-ttu-id="5510f-528">rack3</span><span class="sxs-lookup"><span data-stu-id="5510f-528">rack3</span></span></td></tr>
<tr><th><span data-ttu-id="5510f-529">ZRUŠENÍ</span><span class="sxs-lookup"><span data-stu-id="5510f-529">UN</span></span>    </td><td><span data-ttu-id="5510f-530">10.1.2.9</span><span class="sxs-lookup"><span data-stu-id="5510f-530">10.1.2.9</span></span>     </td><td><span data-ttu-id="5510f-531">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="5510f-531">55.29 KB</span></span>    </td><td><span data-ttu-id="5510f-532">256</span><span class="sxs-lookup"><span data-stu-id="5510f-532">256</span></span>    </td><td><span data-ttu-id="5510f-533">68.8%</span><span class="sxs-lookup"><span data-stu-id="5510f-533">68.8%</span></span>    </td><td><span data-ttu-id="5510f-534">Identifikátor GUID (odebrat)</span><span class="sxs-lookup"><span data-stu-id="5510f-534">Guid (removed)</span></span></td><td><span data-ttu-id="5510f-535">rack3</span><span class="sxs-lookup"><span data-stu-id="5510f-535">rack3</span></span></td></tr>
<tr><th><span data-ttu-id="5510f-536">ZRUŠENÍ</span><span class="sxs-lookup"><span data-stu-id="5510f-536">UN</span></span>    </td><td><span data-ttu-id="5510f-537">10.1.2.10</span><span class="sxs-lookup"><span data-stu-id="5510f-537">10.1.2.10</span></span>     </td><td><span data-ttu-id="5510f-538">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="5510f-538">55.29 KB</span></span>    </td><td><span data-ttu-id="5510f-539">256</span><span class="sxs-lookup"><span data-stu-id="5510f-539">256</span></span>    </td><td><span data-ttu-id="5510f-540">68.8%</span><span class="sxs-lookup"><span data-stu-id="5510f-540">68.8%</span></span>    </td><td><span data-ttu-id="5510f-541">Identifikátor GUID (odebrat)</span><span class="sxs-lookup"><span data-stu-id="5510f-541">Guid (removed)</span></span></td><td><span data-ttu-id="5510f-542">rack4</span><span class="sxs-lookup"><span data-stu-id="5510f-542">rack4</span></span></td></tr>
<tr><th><span data-ttu-id="5510f-543">ZRUŠENÍ</span><span class="sxs-lookup"><span data-stu-id="5510f-543">UN</span></span>    </td><td><span data-ttu-id="5510f-544">10.1.2.11</span><span class="sxs-lookup"><span data-stu-id="5510f-544">10.1.2.11</span></span>     </td><td><span data-ttu-id="5510f-545">55.29 KB</span><span class="sxs-lookup"><span data-stu-id="5510f-545">55.29 KB</span></span>    </td><td><span data-ttu-id="5510f-546">256</span><span class="sxs-lookup"><span data-stu-id="5510f-546">256</span></span>    </td><td><span data-ttu-id="5510f-547">68.8%</span><span class="sxs-lookup"><span data-stu-id="5510f-547">68.8%</span></span>    </td><td><span data-ttu-id="5510f-548">Identifikátor GUID (odebrat)</span><span class="sxs-lookup"><span data-stu-id="5510f-548">Guid (removed)</span></span></td><td><span data-ttu-id="5510f-549">rack4</span><span class="sxs-lookup"><span data-stu-id="5510f-549">rack4</span></span></td></tr>
</table>

## <a name="test-hello-single-region-cluster"></a><span data-ttu-id="5510f-550">Test hello jeden Cluster oblast</span><span class="sxs-lookup"><span data-stu-id="5510f-550">Test hello Single Region Cluster</span></span>
<span data-ttu-id="5510f-551">Použijte následující postup tootest hello clusteru hello:</span><span class="sxs-lookup"><span data-stu-id="5510f-551">Use hello following steps tootest hello cluster:</span></span>

1. <span data-ttu-id="5510f-552">Pomocí příkaz Get-AzureInternalLoadbalancer příkaz prostředí Powershell text hello, získejte IP adresu hello služby Vyrovnávání zatížení interní hello (např.)  10.1.2.101).</span><span class="sxs-lookup"><span data-stu-id="5510f-552">Using hello Powershell command Get-AzureInternalLoadbalancer commandlet, obtain hello IP address of hello internal load balancer (e.g.  10.1.2.101).</span></span> <span data-ttu-id="5510f-553">Hello syntaxe příkazu hello je zobrazena níže: Get-AzureLoadbalancer – ServiceName "(Hong Kong) c-svc západní USA" [zobrazí podrobnosti o hello nástroje pro vyrovnávání zatížení interní hello společně s jeho IP adresy]</span><span class="sxs-lookup"><span data-stu-id="5510f-553">hello syntax of hello command is shown below: Get-AzureLoadbalancer –ServiceName "hk-c-svc-west-us” [displays hello details of hello internal load balancer along with its IP address]</span></span>
2. <span data-ttu-id="5510f-554">Přihlaste se k hello webové farmy virtuálního počítače (například hk-w1 – – západ us) pomocí klienta Putty ssh nebo</span><span class="sxs-lookup"><span data-stu-id="5510f-554">Log into hello web farm VM (e.g. hk-w1-west-us) using Putty or ssh</span></span>
3. <span data-ttu-id="5510f-555">Spuštění $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span><span class="sxs-lookup"><span data-stu-id="5510f-555">Execute $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span></span>
4. <span data-ttu-id="5510f-556">Použijte následující příkazy tooverify CQL Pokud funguje hello clusteru hello:</span><span class="sxs-lookup"><span data-stu-id="5510f-556">Use hello following CQL commands tooverify if hello cluster is working:</span></span>
   
     <span data-ttu-id="5510f-557">Vytvoření KEYSPACE customers_ks REPLIKACE s = {'class': 'SimpleStrategy', 'replication_factor': 3};   POUŽITÍ customers_ks;   Vytvoření tabulky Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   Vložit do VALUES(1, 'John', 'Doe') Customers(customer_id, firstname, lastname);   Vložit do Customers(customer_id, firstname, lastname) hodnoty (2, 'Jana', 'Doe');</span><span class="sxs-lookup"><span data-stu-id="5510f-557">CREATE KEYSPACE customers_ks WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor' : 3 };   USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');</span></span>
   
     <span data-ttu-id="5510f-558">Vyberte * od zákazníků;</span><span class="sxs-lookup"><span data-stu-id="5510f-558">SELECT * FROM Customers;</span></span>

<span data-ttu-id="5510f-559">Měli byste vidět zobrazení jako hello jeden níže:</span><span class="sxs-lookup"><span data-stu-id="5510f-559">You should see a display like hello one below:</span></span>

<table>
  <tr><th> <span data-ttu-id="5510f-560">customer_id</span><span class="sxs-lookup"><span data-stu-id="5510f-560">customer_id</span></span> </th><th> <span data-ttu-id="5510f-561">FirstName</span><span class="sxs-lookup"><span data-stu-id="5510f-561">firstname</span></span> </th><th> <span data-ttu-id="5510f-562">Příjmení</span><span class="sxs-lookup"><span data-stu-id="5510f-562">lastname</span></span> </th></tr>
  <tr><td> <span data-ttu-id="5510f-563">1</span><span class="sxs-lookup"><span data-stu-id="5510f-563">1</span></span> </td><td> <span data-ttu-id="5510f-564">Jan</span><span class="sxs-lookup"><span data-stu-id="5510f-564">John</span></span> </td><td> <span data-ttu-id="5510f-565">Doe</span><span class="sxs-lookup"><span data-stu-id="5510f-565">Doe</span></span> </td></tr>
  <tr><td> <span data-ttu-id="5510f-566">2</span><span class="sxs-lookup"><span data-stu-id="5510f-566">2</span></span> </td><td> <span data-ttu-id="5510f-567">Jana</span><span class="sxs-lookup"><span data-stu-id="5510f-567">Jane</span></span> </td><td> <span data-ttu-id="5510f-568">Doe</span><span class="sxs-lookup"><span data-stu-id="5510f-568">Doe</span></span> </td></tr>
</table>

<span data-ttu-id="5510f-569">Upozorňujeme, že tento hello keyspace vytvořili v kroku 4 používá SimpleStrategy s replication_factor 3.</span><span class="sxs-lookup"><span data-stu-id="5510f-569">Please note that hello keyspace created in step 4 uses SimpleStrategy with a  replication_factor of 3.</span></span> <span data-ttu-id="5510f-570">SimpleStrategy se doporučuje pro jednoho datového centra nasazení zatímco NetworkTopologyStrategy pro více data center nasazení.</span><span class="sxs-lookup"><span data-stu-id="5510f-570">SimpleStrategy is recommended for single data center deployments whereas NetworkTopologyStrategy for multi-data center deployments.</span></span> <span data-ttu-id="5510f-571">Replication_factor 3 získáte odolnost proti selhání uzlu.</span><span class="sxs-lookup"><span data-stu-id="5510f-571">A replication_factor of 3 will give tolerance for node failures.</span></span>

## <span data-ttu-id="5510f-572"><a id="tworegion"></a>Procesu nasazení s více oblast</span><span class="sxs-lookup"><span data-stu-id="5510f-572"><a id="tworegion"> </a>Multi-Region Deployment Process</span></span>
<span data-ttu-id="5510f-573">Bude využívat hello jedné oblasti nasazení bylo úspěšně dokončeno a opakujte hello stejný proces pro instalaci druhé oblast hello.</span><span class="sxs-lookup"><span data-stu-id="5510f-573">Will leverage hello single region deployment completed and repeat hello same process for installing hello second region.</span></span> <span data-ttu-id="5510f-574">Hello klíče rozdíl mezi hello jeden a více nasazení oblast je hello nastavení tunelové propojení VPN pro komunikaci mezi oblast; jsme bude začínat hello síťovou instalaci, zřídíte hello virtuální počítače a nakonfigurujete Cassandra.</span><span class="sxs-lookup"><span data-stu-id="5510f-574">hello key difference between hello single and multiple region deployment is hello VPN tunnel setup for inter-region communication; we will start with hello network installation, provision hello VMs and configure Cassandra.</span></span>

### <a name="step-1-create-hello-virtual-network-at-hello-2nd-region"></a><span data-ttu-id="5510f-575">Krok 1: Vytvoření hello virtuální sítě na hello oblast 2.</span><span class="sxs-lookup"><span data-stu-id="5510f-575">Step 1: Create hello Virtual Network at hello 2nd Region</span></span>
<span data-ttu-id="5510f-576">Přihlaste se k hello portál Azure classic a vytvoření virtuální sítě s hello atributy zobrazit v tabulce hello.</span><span class="sxs-lookup"><span data-stu-id="5510f-576">Log into hello Azure classic portal and create a Virtual Network with hello attributes show in hello table.</span></span> <span data-ttu-id="5510f-577">V tématu [konfigurace virtuální sítě Cloud-Only v hello portál Azure classic](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) podrobné kroky procesu hello.</span><span class="sxs-lookup"><span data-stu-id="5510f-577">See [Configure a Cloud-Only Virtual Network in hello Azure classic portal](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) for detailed steps of hello process.</span></span>      

<table>
<tr><th><span data-ttu-id="5510f-578">Název atributu</span><span class="sxs-lookup"><span data-stu-id="5510f-578">Attribute Name</span></span>    </th><th><span data-ttu-id="5510f-579">Hodnota</span><span class="sxs-lookup"><span data-stu-id="5510f-579">Value</span></span>    </th><th><span data-ttu-id="5510f-580">Poznámky</span><span class="sxs-lookup"><span data-stu-id="5510f-580">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="5510f-581">Name (Název)</span><span class="sxs-lookup"><span data-stu-id="5510f-581">Name</span></span>    </td><td><span data-ttu-id="5510f-582">vnet-cass východ nám</span><span class="sxs-lookup"><span data-stu-id="5510f-582">vnet-cass-east-us</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="5510f-583">Oblast</span><span class="sxs-lookup"><span data-stu-id="5510f-583">Region</span></span>    </td><td><span data-ttu-id="5510f-584">Východ USA</span><span class="sxs-lookup"><span data-stu-id="5510f-584">East US</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="5510f-585">Servery DNS</span><span class="sxs-lookup"><span data-stu-id="5510f-585">DNS Servers</span></span>        </td><td></td><td><span data-ttu-id="5510f-586">Toto ignorovat, protože jsme nejsou pomocí serveru DNS</span><span class="sxs-lookup"><span data-stu-id="5510f-586">Ignore this as we are not using a DNS Server</span></span></td></tr>
<tr><td><span data-ttu-id="5510f-587">Konfigurace VPN typu point-to-site</span><span class="sxs-lookup"><span data-stu-id="5510f-587">Configure a point-to-site VPN</span></span></td><td></td><td>        <span data-ttu-id="5510f-588">Můžete tuto zprávu ignorovat</span><span class="sxs-lookup"><span data-stu-id="5510f-588">Ignore this</span></span></td></tr>
<tr><td><span data-ttu-id="5510f-589">Konfigurace sítě Site-to-Site VPN</span><span class="sxs-lookup"><span data-stu-id="5510f-589">Configure a site-to-site VPN</span></span></td><td></td><td>        <span data-ttu-id="5510f-590">Můžete tuto zprávu ignorovat</span><span class="sxs-lookup"><span data-stu-id="5510f-590">Ignore this</span></span></td></tr>
<tr><td><span data-ttu-id="5510f-591">Adresní prostor</span><span class="sxs-lookup"><span data-stu-id="5510f-591">Address Space</span></span>    </td><td><span data-ttu-id="5510f-592">10.2.0.0/16</span><span class="sxs-lookup"><span data-stu-id="5510f-592">10.2.0.0/16</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="5510f-593">Počáteční IP adresu</span><span class="sxs-lookup"><span data-stu-id="5510f-593">Starting IP</span></span>    </td><td><span data-ttu-id="5510f-594">10.2.0.0</span><span class="sxs-lookup"><span data-stu-id="5510f-594">10.2.0.0</span></span>    </td><td></td></tr>
<tr><td><span data-ttu-id="5510f-595">CIDR</span><span class="sxs-lookup"><span data-stu-id="5510f-595">CIDR</span></span>    </td><td><span data-ttu-id="5510f-596">/16 (65531)</span><span class="sxs-lookup"><span data-stu-id="5510f-596">/16 (65531)</span></span></td><td></td></tr>
</table>

<span data-ttu-id="5510f-597">Přidejte hello následující podsítě:</span><span class="sxs-lookup"><span data-stu-id="5510f-597">Add hello following subnets:</span></span>

<table>
<tr><th><span data-ttu-id="5510f-598">Name (Název)</span><span class="sxs-lookup"><span data-stu-id="5510f-598">Name</span></span>    </th><th><span data-ttu-id="5510f-599">Počáteční IP adresu</span><span class="sxs-lookup"><span data-stu-id="5510f-599">Starting IP</span></span>    </th><th><span data-ttu-id="5510f-600">CIDR</span><span class="sxs-lookup"><span data-stu-id="5510f-600">CIDR</span></span>    </th><th><span data-ttu-id="5510f-601">Poznámky</span><span class="sxs-lookup"><span data-stu-id="5510f-601">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="5510f-602">webové</span><span class="sxs-lookup"><span data-stu-id="5510f-602">web</span></span>    </td><td><span data-ttu-id="5510f-603">10.2.1.0</span><span class="sxs-lookup"><span data-stu-id="5510f-603">10.2.1.0</span></span>    </td><td><span data-ttu-id="5510f-604">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="5510f-604">/24 (251)</span></span>    </td><td><span data-ttu-id="5510f-605">Podsíť pro hello webové farmy</span><span class="sxs-lookup"><span data-stu-id="5510f-605">Subnet for hello web farm</span></span></td></tr>
<tr><td><span data-ttu-id="5510f-606">data</span><span class="sxs-lookup"><span data-stu-id="5510f-606">data</span></span>    </td><td><span data-ttu-id="5510f-607">10.2.2.0</span><span class="sxs-lookup"><span data-stu-id="5510f-607">10.2.2.0</span></span>    </td><td><span data-ttu-id="5510f-608">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="5510f-608">/24 (251)</span></span>    </td><td><span data-ttu-id="5510f-609">Podsíť pro uzly databáze hello</span><span class="sxs-lookup"><span data-stu-id="5510f-609">Subnet for hello database nodes</span></span></td></tr>
</table>


### <a name="step-2-create-local-networks"></a><span data-ttu-id="5510f-610">Krok 2: Vytvoření místní sítě</span><span class="sxs-lookup"><span data-stu-id="5510f-610">Step 2: Create Local Networks</span></span>
<span data-ttu-id="5510f-611">Do místní sítě v Azure virtuální sítě je prostor adres proxy serveru, který mapuje tooa vzdálené lokality, včetně privátního cloudu nebo jiné oblasti Azure.</span><span class="sxs-lookup"><span data-stu-id="5510f-611">A Local Network in Azure virtual networking is a proxy address space that maps tooa remote site including a private cloud or another Azure region.</span></span> <span data-ttu-id="5510f-612">Tento adresní prostor proxy je Brána vzdálené vázané tooa pro směrování sítě toohello právo sítě cíle.</span><span class="sxs-lookup"><span data-stu-id="5510f-612">This proxy address space is bound tooa remote gateway for routing network toohello right networking destinations.</span></span> <span data-ttu-id="5510f-613">V tématu [konfigurace virtuální sítě tooVNet připojení](../../../vpn-gateway/virtual-networks-configure-vnet-to-vnet-connection.md) pokyny hello navazování připojení VNET-to-VNET.</span><span class="sxs-lookup"><span data-stu-id="5510f-613">See [Configure a VNet tooVNet Connection](../../../vpn-gateway/virtual-networks-configure-vnet-to-vnet-connection.md) for hello instructions on establishing VNET-to-VNET connection.</span></span>

<span data-ttu-id="5510f-614">Vytvořte dvě místní sítě za hello následující podrobnosti:</span><span class="sxs-lookup"><span data-stu-id="5510f-614">Create two local networks per hello following details:</span></span>

| <span data-ttu-id="5510f-615">Název sítě</span><span class="sxs-lookup"><span data-stu-id="5510f-615">Network Name</span></span> | <span data-ttu-id="5510f-616">Adresa brány sítě VPN</span><span class="sxs-lookup"><span data-stu-id="5510f-616">VPN Gateway Address</span></span> | <span data-ttu-id="5510f-617">Adresní prostor</span><span class="sxs-lookup"><span data-stu-id="5510f-617">Address Space</span></span> | <span data-ttu-id="5510f-618">Poznámky</span><span class="sxs-lookup"><span data-stu-id="5510f-618">Remarks</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="5510f-619">HK-lnet-map-to-East-us</span><span class="sxs-lookup"><span data-stu-id="5510f-619">hk-lnet-map-to-east-us</span></span> |<span data-ttu-id="5510f-620">23.1.1.1</span><span class="sxs-lookup"><span data-stu-id="5510f-620">23.1.1.1</span></span> |<span data-ttu-id="5510f-621">10.2.0.0/16</span><span class="sxs-lookup"><span data-stu-id="5510f-621">10.2.0.0/16</span></span> |<span data-ttu-id="5510f-622">Při vytváření hello místní sítě poskytněte zástupný symbol adresu brány.</span><span class="sxs-lookup"><span data-stu-id="5510f-622">While creating hello Local Network give a placeholder gateway address.</span></span> <span data-ttu-id="5510f-623">Adresa brány skutečné Hello vyplněno po vytvoření brány hello.</span><span class="sxs-lookup"><span data-stu-id="5510f-623">hello real gateway address is filled once hello gateway is created.</span></span> <span data-ttu-id="5510f-624">Ujistěte se, zda text hello adresní prostor přesně odpovídá hello příslušné virtuální sítě vzdálené; v takovém případě hello síť VNET vytvořena v hello oblast východní USA.</span><span class="sxs-lookup"><span data-stu-id="5510f-624">Make sure hello address space exactly matches hello respective remote VNET; in this case hello VNET created in hello East US region.</span></span> |
| <span data-ttu-id="5510f-625">HK-lnet-map-to-West-us</span><span class="sxs-lookup"><span data-stu-id="5510f-625">hk-lnet-map-to-west-us</span></span> |<span data-ttu-id="5510f-626">23.2.2.2</span><span class="sxs-lookup"><span data-stu-id="5510f-626">23.2.2.2</span></span> |<span data-ttu-id="5510f-627">10.1.0.0/16</span><span class="sxs-lookup"><span data-stu-id="5510f-627">10.1.0.0/16</span></span> |<span data-ttu-id="5510f-628">Při vytváření hello místní sítě poskytněte zástupný symbol adresu brány.</span><span class="sxs-lookup"><span data-stu-id="5510f-628">While creating hello Local Network give a placeholder gateway address.</span></span> <span data-ttu-id="5510f-629">Adresa brány skutečné Hello vyplněno po vytvoření brány hello.</span><span class="sxs-lookup"><span data-stu-id="5510f-629">hello real gateway address is filled once hello gateway is created.</span></span> <span data-ttu-id="5510f-630">Ujistěte se, zda text hello adresní prostor přesně odpovídá hello příslušné virtuální sítě vzdálené; v takovém případě hello síť VNET vytvořena v hello oblast západní USA.</span><span class="sxs-lookup"><span data-stu-id="5510f-630">Make sure hello address space exactly matches hello respective remote VNET; in this case hello VNET created in hello West US region.</span></span> |

### <a name="step-3-map-local-network-toohello-respective-vnets"></a><span data-ttu-id="5510f-631">Krok 3: Mapy "Local" sítě toohello příslušné virtuální sítě</span><span class="sxs-lookup"><span data-stu-id="5510f-631">Step 3: Map “Local” network toohello respective VNETs</span></span>
<span data-ttu-id="5510f-632">Z hello portál Azure classic vyberte každý virtuální síť, klikněte na tlačítko "Konfigurace", "Connect toohello místní sítě" a vyberte hello místní sítě za hello následující podrobnosti:</span><span class="sxs-lookup"><span data-stu-id="5510f-632">From hello Azure classic portal, select each vnet, click “Configure”, check “Connect toohello local network”, and select hello Local Networks per hello following details:</span></span>

| <span data-ttu-id="5510f-633">Virtual Network</span><span class="sxs-lookup"><span data-stu-id="5510f-633">Virtual Network</span></span> | <span data-ttu-id="5510f-634">Místní sítě</span><span class="sxs-lookup"><span data-stu-id="5510f-634">Local Network</span></span> |
| --- | --- |
| <span data-ttu-id="5510f-635">(Hong Kong) vnet západní USA</span><span class="sxs-lookup"><span data-stu-id="5510f-635">hk-vnet-west-us</span></span> |<span data-ttu-id="5510f-636">HK-lnet-map-to-East-us</span><span class="sxs-lookup"><span data-stu-id="5510f-636">hk-lnet-map-to-east-us</span></span> |
| <span data-ttu-id="5510f-637">(Hong Kong) vnet-– východ nám</span><span class="sxs-lookup"><span data-stu-id="5510f-637">hk-vnet-east-us</span></span> |<span data-ttu-id="5510f-638">HK-lnet-map-to-West-us</span><span class="sxs-lookup"><span data-stu-id="5510f-638">hk-lnet-map-to-west-us</span></span> |

### <a name="step-4-create-gateways-on-vnet1-and-vnet2"></a><span data-ttu-id="5510f-639">Krok 4: Vytvoření brány na VNET1 a VNET2</span><span class="sxs-lookup"><span data-stu-id="5510f-639">Step 4: Create Gateways on VNET1 and VNET2</span></span>
<span data-ttu-id="5510f-640">Z řídicího panelu hello obou hello virtuálních sítí klikněte na možnost vytvořit BRÁNU, která aktivuje bránu VPN hello procesu zřizování.</span><span class="sxs-lookup"><span data-stu-id="5510f-640">From hello dashboard of both hello virtual networks, click CREATE GATEWAY which will trigger hello VPN gateway provisioning process.</span></span> <span data-ttu-id="5510f-641">Po pár minut hello řídicí panel každý virtuální sítě by měl zobrazit adresu hello skutečné brány.</span><span class="sxs-lookup"><span data-stu-id="5510f-641">After a few minutes hello dashboard of each virtual network should display hello actual gateway address.</span></span>

### <a name="step-5-update-local-networks-with-hello-respective-gateway-addresses"></a><span data-ttu-id="5510f-642">Krok 5: Aktualizace "Local" sítě s adresami příslušných "brány" hello</span><span class="sxs-lookup"><span data-stu-id="5510f-642">Step 5: Update “Local” networks with hello respective “Gateway” addresses</span></span>
<span data-ttu-id="5510f-643">Upravte obě hello místní sítě tooreplace hello zástupný symbol brány IP adresu s hello skutečné IP adresu hello jenom zřídit brány.</span><span class="sxs-lookup"><span data-stu-id="5510f-643">Edit both hello local networks tooreplace hello placeholder gateway IP address with hello real IP address of hello just provisioned gateways.</span></span> <span data-ttu-id="5510f-644">Použijte následující mapování hello:</span><span class="sxs-lookup"><span data-stu-id="5510f-644">Use hello following mapping:</span></span>

<table>
<tr><th><span data-ttu-id="5510f-645">Místní sítě</span><span class="sxs-lookup"><span data-stu-id="5510f-645">Local Network</span></span>    </th><th><span data-ttu-id="5510f-646">Brána virtuální sítě</span><span class="sxs-lookup"><span data-stu-id="5510f-646">Virtual Network Gateway</span></span></th></tr>
<tr><td><span data-ttu-id="5510f-647">HK-lnet-map-to-East-us</span><span class="sxs-lookup"><span data-stu-id="5510f-647">hk-lnet-map-to-east-us</span></span> </td><td><span data-ttu-id="5510f-648">Brána (Hong Kong) vnet západní USA</span><span class="sxs-lookup"><span data-stu-id="5510f-648">Gateway of hk-vnet-west-us</span></span></td></tr>
<tr><td><span data-ttu-id="5510f-649">HK-lnet-map-to-West-us</span><span class="sxs-lookup"><span data-stu-id="5510f-649">hk-lnet-map-to-west-us</span></span> </td><td><span data-ttu-id="5510f-650">Brána (Hong Kong) vnet-– východ nám</span><span class="sxs-lookup"><span data-stu-id="5510f-650">Gateway of hk-vnet-east-us</span></span></td></tr>
</table>

### <a name="step-6-update-hello-shared-key"></a><span data-ttu-id="5510f-651">Krok 6: Aktualizace sdílený klíč hello</span><span class="sxs-lookup"><span data-stu-id="5510f-651">Step 6: Update hello shared key</span></span>
<span data-ttu-id="5510f-652">Použití hello následující klíč protokolu IPSec prostředí Powershell skriptu tooupdate hello každý brány VPN [použití hello saké klíč pro obě brány hello]: hk-lnet-map-to-west-us - LocalNetworkSiteName v Set AzureVNetGatewayKey - VNetName (Hong Kong) vnet-– východ us - SharedKey D9E76BKK Set-AzureVNetGatewayKey - VNetName (Hong Kong) vnet západní USA - LocalNetworkSiteName hk-lnet-map-to-east-us - SharedKey D9E76BKK</span><span class="sxs-lookup"><span data-stu-id="5510f-652">Use hello following Powershell script tooupdate hello IPSec key of each VPN gateway [use hello sake key for both hello gateways]: Set-AzureVNetGatewayKey -VNetName hk-vnet-east-us -LocalNetworkSiteName hk-lnet-map-to-west-us -SharedKey D9E76BKK Set-AzureVNetGatewayKey -VNetName hk-vnet-west-us -LocalNetworkSiteName hk-lnet-map-to-east-us -SharedKey D9E76BKK</span></span>

### <a name="step-7-establish-hello-vnet-to-vnet-connection"></a><span data-ttu-id="5510f-653">Krok 7: Připojení hello VNET-to-VNET</span><span class="sxs-lookup"><span data-stu-id="5510f-653">Step 7: Establish hello VNET-to-VNET connection</span></span>
<span data-ttu-id="5510f-654">Z hello portál Azure classic použijte nabídku "Řídicího PANELU" hello připojení brány brány tooestablish virtuální sítě i hello.</span><span class="sxs-lookup"><span data-stu-id="5510f-654">From hello Azure classic portal, use hello “DASHBOARD” menu of both hello virtual networks tooestablish gateway-to-gateway connection.</span></span> <span data-ttu-id="5510f-655">Pomocí položky nabídky "Připojit" hello v hello dolním panelu nástrojů.</span><span class="sxs-lookup"><span data-stu-id="5510f-655">Use hello “CONNECT” menu items in hello bottom toolbar.</span></span> <span data-ttu-id="5510f-656">Po několika minutách by měl hello řídicí panel zobrazit podrobnosti připojení hello graficky.</span><span class="sxs-lookup"><span data-stu-id="5510f-656">After a few minutes hello dashboard should display hello connection details graphically.</span></span>

### <a name="step-8-create-hello-virtual-machines-in-region-2"></a><span data-ttu-id="5510f-657">Krok 8: Vytvoření hello virtuálních počítačů v oblasti #2</span><span class="sxs-lookup"><span data-stu-id="5510f-657">Step 8: Create hello virtual machines in region #2</span></span>
<span data-ttu-id="5510f-658">Vytvoření bitové kopie Ubuntu hello, jak je popsáno v oblasti #1 nasazení podle následující hello stejné kroky nebo zkopírujte hello bitové kopie virtuálního pevného disku soubor toohello účtu úložiště Azure umístěný v oblasti #2 a vytvoření bitové kopie hello.</span><span class="sxs-lookup"><span data-stu-id="5510f-658">Create hello Ubuntu image as described in region #1 deployment by following hello same steps or copy hello image VHD file toohello Azure storage account located in region #2 and create hello image.</span></span> <span data-ttu-id="5510f-659">Použijte tuto bitovou kopii a vytvoření hello následující seznam virtuálních počítačů do novou cloudovou službu, hk-c-svc východ nám:</span><span class="sxs-lookup"><span data-stu-id="5510f-659">Use this image and create hello following list of virtual machines into a new cloud service hk-c-svc-east-us:</span></span>

| <span data-ttu-id="5510f-660">Název počítače</span><span class="sxs-lookup"><span data-stu-id="5510f-660">Machine Name</span></span> | <span data-ttu-id="5510f-661">Podsíť</span><span class="sxs-lookup"><span data-stu-id="5510f-661">Subnet</span></span> | <span data-ttu-id="5510f-662">IP adresa</span><span class="sxs-lookup"><span data-stu-id="5510f-662">IP Address</span></span> | <span data-ttu-id="5510f-663">Skupina dostupnosti</span><span class="sxs-lookup"><span data-stu-id="5510f-663">Availability set</span></span> | <span data-ttu-id="5510f-664">DC/Rack</span><span class="sxs-lookup"><span data-stu-id="5510f-664">DC/Rack</span></span> | <span data-ttu-id="5510f-665">Počáteční hodnoty?</span><span class="sxs-lookup"><span data-stu-id="5510f-665">Seed?</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="5510f-666">(Hong Kong) c1-východ nám</span><span class="sxs-lookup"><span data-stu-id="5510f-666">hk-c1-east-us</span></span> |<span data-ttu-id="5510f-667">data</span><span class="sxs-lookup"><span data-stu-id="5510f-667">data</span></span> |<span data-ttu-id="5510f-668">10.2.2.4</span><span class="sxs-lookup"><span data-stu-id="5510f-668">10.2.2.4</span></span> |<span data-ttu-id="5510f-669">(Hong Kong) c sada-1</span><span class="sxs-lookup"><span data-stu-id="5510f-669">hk-c-aset-1</span></span> |<span data-ttu-id="5510f-670">DC = EASTUS rack = rack1</span><span class="sxs-lookup"><span data-stu-id="5510f-670">dc =EASTUS rack =rack1</span></span> |<span data-ttu-id="5510f-671">Ano</span><span class="sxs-lookup"><span data-stu-id="5510f-671">Yes</span></span> |
| <span data-ttu-id="5510f-672">(Hong Kong) c2-východ nám</span><span class="sxs-lookup"><span data-stu-id="5510f-672">hk-c2-east-us</span></span> |<span data-ttu-id="5510f-673">data</span><span class="sxs-lookup"><span data-stu-id="5510f-673">data</span></span> |<span data-ttu-id="5510f-674">10.2.2.5</span><span class="sxs-lookup"><span data-stu-id="5510f-674">10.2.2.5</span></span> |<span data-ttu-id="5510f-675">(Hong Kong) c sada-1</span><span class="sxs-lookup"><span data-stu-id="5510f-675">hk-c-aset-1</span></span> |<span data-ttu-id="5510f-676">DC = EASTUS rack = rack1</span><span class="sxs-lookup"><span data-stu-id="5510f-676">dc =EASTUS rack =rack1</span></span> |<span data-ttu-id="5510f-677">Ne</span><span class="sxs-lookup"><span data-stu-id="5510f-677">No</span></span> |
| <span data-ttu-id="5510f-678">(Hong Kong) c3-východ nám</span><span class="sxs-lookup"><span data-stu-id="5510f-678">hk-c3-east-us</span></span> |<span data-ttu-id="5510f-679">data</span><span class="sxs-lookup"><span data-stu-id="5510f-679">data</span></span> |<span data-ttu-id="5510f-680">10.2.2.6</span><span class="sxs-lookup"><span data-stu-id="5510f-680">10.2.2.6</span></span> |<span data-ttu-id="5510f-681">(Hong Kong) c sada-1</span><span class="sxs-lookup"><span data-stu-id="5510f-681">hk-c-aset-1</span></span> |<span data-ttu-id="5510f-682">DC = EASTUS rack = rack2</span><span class="sxs-lookup"><span data-stu-id="5510f-682">dc =EASTUS rack =rack2</span></span> |<span data-ttu-id="5510f-683">Ano</span><span class="sxs-lookup"><span data-stu-id="5510f-683">Yes</span></span> |
| <span data-ttu-id="5510f-684">(Hong Kong) c5-východ nám</span><span class="sxs-lookup"><span data-stu-id="5510f-684">hk-c5-east-us</span></span> |<span data-ttu-id="5510f-685">data</span><span class="sxs-lookup"><span data-stu-id="5510f-685">data</span></span> |<span data-ttu-id="5510f-686">10.2.2.8</span><span class="sxs-lookup"><span data-stu-id="5510f-686">10.2.2.8</span></span> |<span data-ttu-id="5510f-687">(Hong Kong) c sada-2</span><span class="sxs-lookup"><span data-stu-id="5510f-687">hk-c-aset-2</span></span> |<span data-ttu-id="5510f-688">DC = EASTUS rack = rack3</span><span class="sxs-lookup"><span data-stu-id="5510f-688">dc =EASTUS rack =rack3</span></span> |<span data-ttu-id="5510f-689">Ano</span><span class="sxs-lookup"><span data-stu-id="5510f-689">Yes</span></span> |
| <span data-ttu-id="5510f-690">(Hong Kong) c6-východ nám</span><span class="sxs-lookup"><span data-stu-id="5510f-690">hk-c6-east-us</span></span> |<span data-ttu-id="5510f-691">data</span><span class="sxs-lookup"><span data-stu-id="5510f-691">data</span></span> |<span data-ttu-id="5510f-692">10.2.2.9</span><span class="sxs-lookup"><span data-stu-id="5510f-692">10.2.2.9</span></span> |<span data-ttu-id="5510f-693">(Hong Kong) c sada-2</span><span class="sxs-lookup"><span data-stu-id="5510f-693">hk-c-aset-2</span></span> |<span data-ttu-id="5510f-694">DC = EASTUS rack = rack3</span><span class="sxs-lookup"><span data-stu-id="5510f-694">dc =EASTUS rack =rack3</span></span> |<span data-ttu-id="5510f-695">Ne</span><span class="sxs-lookup"><span data-stu-id="5510f-695">No</span></span> |
| <span data-ttu-id="5510f-696">(Hong Kong)-s c7 – východ nám</span><span class="sxs-lookup"><span data-stu-id="5510f-696">hk-c7-east-us</span></span> |<span data-ttu-id="5510f-697">data</span><span class="sxs-lookup"><span data-stu-id="5510f-697">data</span></span> |<span data-ttu-id="5510f-698">10.2.2.10</span><span class="sxs-lookup"><span data-stu-id="5510f-698">10.2.2.10</span></span> |<span data-ttu-id="5510f-699">(Hong Kong) c sada-2</span><span class="sxs-lookup"><span data-stu-id="5510f-699">hk-c-aset-2</span></span> |<span data-ttu-id="5510f-700">DC = EASTUS rack = rack4</span><span class="sxs-lookup"><span data-stu-id="5510f-700">dc =EASTUS rack =rack4</span></span> |<span data-ttu-id="5510f-701">Ano</span><span class="sxs-lookup"><span data-stu-id="5510f-701">Yes</span></span> |
| <span data-ttu-id="5510f-702">(Hong Kong) c8-východ nám</span><span class="sxs-lookup"><span data-stu-id="5510f-702">hk-c8-east-us</span></span> |<span data-ttu-id="5510f-703">data</span><span class="sxs-lookup"><span data-stu-id="5510f-703">data</span></span> |<span data-ttu-id="5510f-704">10.2.2.11</span><span class="sxs-lookup"><span data-stu-id="5510f-704">10.2.2.11</span></span> |<span data-ttu-id="5510f-705">(Hong Kong) c sada-2</span><span class="sxs-lookup"><span data-stu-id="5510f-705">hk-c-aset-2</span></span> |<span data-ttu-id="5510f-706">DC = EASTUS rack = rack4</span><span class="sxs-lookup"><span data-stu-id="5510f-706">dc =EASTUS rack =rack4</span></span> |<span data-ttu-id="5510f-707">Ne</span><span class="sxs-lookup"><span data-stu-id="5510f-707">No</span></span> |
| <span data-ttu-id="5510f-708">(Hong Kong) w1 – východ nám</span><span class="sxs-lookup"><span data-stu-id="5510f-708">hk-w1-east-us</span></span> |<span data-ttu-id="5510f-709">webové</span><span class="sxs-lookup"><span data-stu-id="5510f-709">web</span></span> |<span data-ttu-id="5510f-710">10.2.1.4</span><span class="sxs-lookup"><span data-stu-id="5510f-710">10.2.1.4</span></span> |<span data-ttu-id="5510f-711">(Hong Kong) w sada-1</span><span class="sxs-lookup"><span data-stu-id="5510f-711">hk-w-aset-1</span></span> |<span data-ttu-id="5510f-712">Není k dispozici</span><span class="sxs-lookup"><span data-stu-id="5510f-712">N/A</span></span> |<span data-ttu-id="5510f-713">Není k dispozici</span><span class="sxs-lookup"><span data-stu-id="5510f-713">N/A</span></span> |
| <span data-ttu-id="5510f-714">(Hong Kong) w2 – východ nám</span><span class="sxs-lookup"><span data-stu-id="5510f-714">hk-w2-east-us</span></span> |<span data-ttu-id="5510f-715">webové</span><span class="sxs-lookup"><span data-stu-id="5510f-715">web</span></span> |<span data-ttu-id="5510f-716">10.2.1.5</span><span class="sxs-lookup"><span data-stu-id="5510f-716">10.2.1.5</span></span> |<span data-ttu-id="5510f-717">(Hong Kong) w sada-1</span><span class="sxs-lookup"><span data-stu-id="5510f-717">hk-w-aset-1</span></span> |<span data-ttu-id="5510f-718">Není k dispozici</span><span class="sxs-lookup"><span data-stu-id="5510f-718">N/A</span></span> |<span data-ttu-id="5510f-719">Není k dispozici</span><span class="sxs-lookup"><span data-stu-id="5510f-719">N/A</span></span> |

<span data-ttu-id="5510f-720">Postupujte podle hello stejné pokyny jako oblast #1 ale použít 10.2.xxx.xxx adresní prostor.</span><span class="sxs-lookup"><span data-stu-id="5510f-720">Follow hello same instructions as region #1 but use 10.2.xxx.xxx address space.</span></span>

### <a name="step-9-configure-cassandra-on-each-vm"></a><span data-ttu-id="5510f-721">Krok 9: Konfigurace Cassandra na jednotlivé virtuální počítače</span><span class="sxs-lookup"><span data-stu-id="5510f-721">Step 9: Configure Cassandra on each VM</span></span>
<span data-ttu-id="5510f-722">Přihlaste se k hello virtuálního počítače a provádět hello následující:</span><span class="sxs-lookup"><span data-stu-id="5510f-722">Log into hello VM and perform hello following:</span></span>

1. <span data-ttu-id="5510f-723">Upravit toospecify $CASS_HOME/conf/cassandra-rackdc.properties hello datového centra a rack vlastnosti ve formátu hello: dc = EASTUS rack = rack1</span><span class="sxs-lookup"><span data-stu-id="5510f-723">Edit $CASS_HOME/conf/cassandra-rackdc.properties toospecify hello data center and rack properties in hello format:  dc =EASTUS  rack =rack1</span></span>
2. <span data-ttu-id="5510f-724">Upravit uzly počáteční hodnoty tooconfigure cassandra.yaml: semen: "10.1.2.4,10.1.2.6,10.1.2.8,10.1.2.10,10.2.2.4,10.2.2.6,10.2.2.8,10.2.2.10"</span><span class="sxs-lookup"><span data-stu-id="5510f-724">Edit cassandra.yaml tooconfigure seed nodes:  Seeds: "10.1.2.4,10.1.2.6,10.1.2.8,10.1.2.10,10.2.2.4,10.2.2.6,10.2.2.8,10.2.2.10"</span></span>

### <a name="step-10-start-cassandra"></a><span data-ttu-id="5510f-725">Krok 10: Spuštění Cassandra</span><span class="sxs-lookup"><span data-stu-id="5510f-725">Step 10: Start Cassandra</span></span>
<span data-ttu-id="5510f-726">Přihlaste se k každý virtuální počítač a spusťte Cassandra hello pozadí spuštěním hello následující příkaz: $CASS_HOME/bin/cassandra</span><span class="sxs-lookup"><span data-stu-id="5510f-726">Log into each VM and start Cassandra in hello background by running hello following command: $CASS_HOME/bin/cassandra</span></span>

## <a name="test-hello-multi-region-cluster"></a><span data-ttu-id="5510f-727">Test hello clusteru více oblast</span><span class="sxs-lookup"><span data-stu-id="5510f-727">Test hello Multi-Region Cluster</span></span>
<span data-ttu-id="5510f-728">Nyní Cassandra byl nasazený too16 uzly s 8 uzlů v každé oblasti Azure.</span><span class="sxs-lookup"><span data-stu-id="5510f-728">By now Cassandra has been deployed too16 nodes with 8 nodes in each Azure region.</span></span> <span data-ttu-id="5510f-729">Tyto uzly jsou hello stejné clusteru na základě hello běžný název clusteru a konfigurace uzlu hello počáteční hodnoty.</span><span class="sxs-lookup"><span data-stu-id="5510f-729">These nodes are in hello same cluster by virtue of hello common cluster name and hello seed node configuration.</span></span> <span data-ttu-id="5510f-730">Použijte následující proces tootest hello clusteru hello:</span><span class="sxs-lookup"><span data-stu-id="5510f-730">Use hello following process tootest hello cluster:</span></span>

### <a name="step-1-get-hello-internal-load-balancer-ip-for-both-hello-regions-using-powershell"></a><span data-ttu-id="5510f-731">Krok 1: Získání IP nástroje pro vyrovnávání zatížení pro vnitřní hello pro obě hello oblasti pomocí prostředí PowerShell</span><span class="sxs-lookup"><span data-stu-id="5510f-731">Step 1: Get hello internal load balancer IP for both hello regions using PowerShell</span></span>
* <span data-ttu-id="5510f-732">Get-AzureInternalLoadbalancer - ServiceName "(Hong Kong) c-svc západní USA"</span><span class="sxs-lookup"><span data-stu-id="5510f-732">Get-AzureInternalLoadbalancer -ServiceName "hk-c-svc-west-us"</span></span>
* <span data-ttu-id="5510f-733">Get-AzureInternalLoadbalancer - ServiceName "(Hong Kong) c-svc Východ USA"</span><span class="sxs-lookup"><span data-stu-id="5510f-733">Get-AzureInternalLoadbalancer -ServiceName "hk-c-svc-east-us"</span></span>  
  
    <span data-ttu-id="5510f-734">Všimněte si hello IP adresy (například – západ - 10.1.2.101, východ - 10.2.2.101) zobrazí.</span><span class="sxs-lookup"><span data-stu-id="5510f-734">Note hello IP addresses (e.g. west - 10.1.2.101, east - 10.2.2.101) displayed.</span></span>

### <a name="step-2-execute-hello-following-in-hello-west-region-after-logging-into-hk-w1-west-us"></a><span data-ttu-id="5510f-735">Krok 2: Spuštění hello následující po přihlášení na hk-w1 – západní USA v oblasti západní hello</span><span class="sxs-lookup"><span data-stu-id="5510f-735">Step 2: Execute hello following in hello west region after logging into hk-w1-west-us</span></span>
1. <span data-ttu-id="5510f-736">Spuštění $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span><span class="sxs-lookup"><span data-stu-id="5510f-736">Execute $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span></span>
2. <span data-ttu-id="5510f-737">Spusťte následující příkazy CQL hello:</span><span class="sxs-lookup"><span data-stu-id="5510f-737">Execute hello following CQL commands:</span></span>
   
     <span data-ttu-id="5510f-738">Vytvoření KEYSPACE customers_ks REPLIKACE s = {'class': 'NetworkToplogyStrategy', 'WESTUS': 3, 'EASTUS': 3};   POUŽITÍ customers_ks;   Vytvoření tabulky Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   Vložit do VALUES(1, 'John', 'Doe') Customers(customer_id, firstname, lastname);   Vložit do Customers(customer_id, firstname, lastname) hodnoty (2, 'Jana', 'Doe');   Vyberte * od zákazníků;</span><span class="sxs-lookup"><span data-stu-id="5510f-738">CREATE KEYSPACE customers_ks   WITH REPLICATION = { 'class' : 'NetworkToplogyStrategy', 'WESTUS' : 3, 'EASTUS' : 3};   USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');   SELECT * FROM Customers;</span></span>

<span data-ttu-id="5510f-739">Měli byste vidět zobrazení jako hello jeden níže:</span><span class="sxs-lookup"><span data-stu-id="5510f-739">You should see a display like hello one below:</span></span>

| <span data-ttu-id="5510f-740">customer_id</span><span class="sxs-lookup"><span data-stu-id="5510f-740">customer_id</span></span> | <span data-ttu-id="5510f-741">FirstName</span><span class="sxs-lookup"><span data-stu-id="5510f-741">firstname</span></span> | <span data-ttu-id="5510f-742">Příjmení</span><span class="sxs-lookup"><span data-stu-id="5510f-742">Lastname</span></span> |
| --- | --- | --- |
| <span data-ttu-id="5510f-743">1</span><span class="sxs-lookup"><span data-stu-id="5510f-743">1</span></span> |<span data-ttu-id="5510f-744">Jan</span><span class="sxs-lookup"><span data-stu-id="5510f-744">John</span></span> |<span data-ttu-id="5510f-745">Doe</span><span class="sxs-lookup"><span data-stu-id="5510f-745">Doe</span></span> |
| <span data-ttu-id="5510f-746">2</span><span class="sxs-lookup"><span data-stu-id="5510f-746">2</span></span> |<span data-ttu-id="5510f-747">Jana</span><span class="sxs-lookup"><span data-stu-id="5510f-747">Jane</span></span> |<span data-ttu-id="5510f-748">Doe</span><span class="sxs-lookup"><span data-stu-id="5510f-748">Doe</span></span> |

### <a name="step-3-execute-hello-following-in-hello-east-region-after-logging-into-hk-w1-east-us"></a><span data-ttu-id="5510f-749">Krok 3: Spusťte následující hello v oblasti Východ hello po přihlášení na hk-w1 – východ us:</span><span class="sxs-lookup"><span data-stu-id="5510f-749">Step 3: Execute hello following in hello east region after logging into hk-w1-east-us:</span></span>
1. <span data-ttu-id="5510f-750">Spuštění $CASS_HOME/bin/cqlsh 10.2.2.101 9160</span><span class="sxs-lookup"><span data-stu-id="5510f-750">Execute $CASS_HOME/bin/cqlsh 10.2.2.101 9160</span></span>
2. <span data-ttu-id="5510f-751">Spusťte následující příkazy CQL hello:</span><span class="sxs-lookup"><span data-stu-id="5510f-751">Execute hello following CQL commands:</span></span>
   
     <span data-ttu-id="5510f-752">POUŽITÍ customers_ks;   Vytvoření tabulky Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   Vložit do VALUES(1, 'John', 'Doe') Customers(customer_id, firstname, lastname);   Vložit do Customers(customer_id, firstname, lastname) hodnoty (2, 'Jana', 'Doe');   Vyberte * od zákazníků;</span><span class="sxs-lookup"><span data-stu-id="5510f-752">USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');   SELECT * FROM Customers;</span></span>

<span data-ttu-id="5510f-753">Měli byste vidět hello stejné zobrazit, jak je vidět pro oblast západní hello:</span><span class="sxs-lookup"><span data-stu-id="5510f-753">You should see hello same display as seen for hello West region:</span></span>

| <span data-ttu-id="5510f-754">customer_id</span><span class="sxs-lookup"><span data-stu-id="5510f-754">customer_id</span></span> | <span data-ttu-id="5510f-755">FirstName</span><span class="sxs-lookup"><span data-stu-id="5510f-755">firstname</span></span> | <span data-ttu-id="5510f-756">Příjmení</span><span class="sxs-lookup"><span data-stu-id="5510f-756">Lastname</span></span> |
| --- | --- | --- |
| <span data-ttu-id="5510f-757">1</span><span class="sxs-lookup"><span data-stu-id="5510f-757">1</span></span> |<span data-ttu-id="5510f-758">Jan</span><span class="sxs-lookup"><span data-stu-id="5510f-758">John</span></span> |<span data-ttu-id="5510f-759">Doe</span><span class="sxs-lookup"><span data-stu-id="5510f-759">Doe</span></span> |
| <span data-ttu-id="5510f-760">2</span><span class="sxs-lookup"><span data-stu-id="5510f-760">2</span></span> |<span data-ttu-id="5510f-761">Jana</span><span class="sxs-lookup"><span data-stu-id="5510f-761">Jane</span></span> |<span data-ttu-id="5510f-762">Doe</span><span class="sxs-lookup"><span data-stu-id="5510f-762">Doe</span></span> |

<span data-ttu-id="5510f-763">Provést několik další vložení a zobrazit, že ty získat replikované toowest-nám součástí clusteru hello.</span><span class="sxs-lookup"><span data-stu-id="5510f-763">Execute a few more inserts and see that those get replicated toowest-us part of hello cluster.</span></span>

## <a name="test-cassandra-cluster-from-nodejs"></a><span data-ttu-id="5510f-764">Test Cassandra Cluster z Node.js</span><span class="sxs-lookup"><span data-stu-id="5510f-764">Test Cassandra Cluster from Node.js</span></span>
<span data-ttu-id="5510f-765">Pomocí jednoho z virtuálních počítačů Linux hello dříve vytvářet ve vrstvě "web" hello, jsme provede jednoduché tooread hello dříve vložit dat skriptu Node.js</span><span class="sxs-lookup"><span data-stu-id="5510f-765">Using one of hello Linux VMs crated in hello "web" tier previously, we will execute a simple Node.js script tooread hello previously inserted data</span></span>

<span data-ttu-id="5510f-766">**Krok 1: Instalace Node.js a Cassandra klienta**</span><span class="sxs-lookup"><span data-stu-id="5510f-766">**Step 1: Install Node.js and Cassandra Client**</span></span>

1. <span data-ttu-id="5510f-767">Nainstalovat Node.js a npm</span><span class="sxs-lookup"><span data-stu-id="5510f-767">Install Node.js and npm</span></span>
2. <span data-ttu-id="5510f-768">Instalace uzlu balíček "cassandra klienta" pomocí npm</span><span class="sxs-lookup"><span data-stu-id="5510f-768">Install node package "cassandra-client" using npm</span></span>
3. <span data-ttu-id="5510f-769">Spusťte následující skript prostředí řádku hello, který zobrazí řetězce formátu json hello hello načíst dat hello:</span><span class="sxs-lookup"><span data-stu-id="5510f-769">Execute hello following script at hello shell prompt which displays hello json string of hello retrieved data:</span></span>
   
        var pooledCon = require('cassandra-client').PooledConnection;
        var ksName = "custsupport_ks";
        var cfName = "customers_cf";
        var hostList = ['internal_loadbalancer_ip:9160'];
        var ksConOptions = { hosts: hostList,
                             keyspace: ksName, use_bigints: false };
   
        function createKeyspace(callback){
           var cql = 'CREATE KEYSPACE ' + ksName + ' WITH strategy_class=SimpleStrategy AND strategy_options:replication_factor=1';
           var sysConOptions = { hosts: hostList,  
                                 keyspace: 'system', use_bigints: false };
           var con = new pooledCon(sysConOptions);
           con.execute(cql,[],function(err) {
           if (err) {
             console.log("Failed toocreate Keyspace: " + ksName);
             console.log(err);
           }
           else {
             console.log("Created Keyspace: " + ksName);
             callback(ksConOptions, populateCustomerData);
           }
           });
           con.shutdown();
        }
   
        function createColumnFamily(ksConOptions, callback){
          var params = ['customers_cf','custid','varint','custname',
                        'text','custaddress','text'];
          var cql = 'CREATE COLUMNFAMILY ? (? ? PRIMARY KEY,? ?, ? ?)';
        var con =  new pooledCon(ksConOptions);
          con.execute(cql,params,function(err) {
              if (err) {
                 console.log("Failed toocreate column family: " + params[0]);
                 console.log(err);
              }
              else {
                 console.log("Created column family: " + params[0]);
                 callback();
              }
          });
          con.shutdown();
        }
   
        //populate Data
        function populateCustomerData() {
           var params = ['John','Infinity Dr, TX', 1];
           updateCustomer(ksConOptions,params);
   
           params = ['Tom','Fermat Ln, WA', 2];
           updateCustomer(ksConOptions,params);
        }
   
        //update will also insert hello record if none exists
        function updateCustomer(ksConOptions,params)
        {
          var cql = 'UPDATE customers_cf SET custname=?,custaddress=? where custid=?';
          var con = new pooledCon(ksConOptions);
          con.execute(cql,params,function(err) {
              if (err) console.log(err);
              else console.log("Inserted customer : " + params[0]);
          });
          con.shutdown();
        }
   
        //read hello two rows inserted above
        function readCustomer(ksConOptions)
        {
          var cql = 'SELECT * FROM customers_cf WHERE custid IN (1,2)';
          var con = new pooledCon(ksConOptions);
          con.execute(cql,[],function(err,rows) {
              if (err)
                 console.log(err);
              else
                 for (var i=0; i<rows.length; i++)
                    console.log(JSON.stringify(rows[i]));
            });
           con.shutdown();
        }
   
        //exectue hello code
        createKeyspace(createColumnFamily);
        readCustomer(ksConOptions)

## <a name="conclusion"></a><span data-ttu-id="5510f-770">Závěr</span><span class="sxs-lookup"><span data-stu-id="5510f-770">Conclusion</span></span>
<span data-ttu-id="5510f-771">Microsoft Azure je flexibilní platforma, která umožňuje spuštění hello Microsoft jak software s otevřeným zdrojem, jak je ukázáno v tomto cvičení.</span><span class="sxs-lookup"><span data-stu-id="5510f-771">Microsoft Azure is a flexible platform that allows hello running of both Microsoft as well as open source software as demonstrated by this exercise.</span></span> <span data-ttu-id="5510f-772">Clustery s vysokou dostupností Cassandra můžete nasadit na jednoho datového centra prostřednictvím hello šíření uzlů clusteru hello napříč více domén selhání.</span><span class="sxs-lookup"><span data-stu-id="5510f-772">Highly available Cassandra clusters can be deployed on a single data center through hello spreading of hello cluster nodes across multiple fault domains.</span></span> <span data-ttu-id="5510f-773">Také je možné instalovat clustery Cassandra nad několika oblastmi Azure geograficky vzdáleným doklad systémů po havárii.</span><span class="sxs-lookup"><span data-stu-id="5510f-773">Cassandra clusters can also be deployed across multiple geographically distant Azure regions for disaster proof systems.</span></span> <span data-ttu-id="5510f-774">Azure a umožňuje společně Cassandra hello konstrukce vysoce škálovatelnou a vysoce dostupné a po havárii obnovitelné cloudové služby potřeby škálovat podle dnešní internetové služby.</span><span class="sxs-lookup"><span data-stu-id="5510f-774">Azure and Cassandra together enables hello construction of highly scalable, highly available and disaster recoverable cloud services needed by today's internet scale services.</span></span>  

## <a name="references"></a><span data-ttu-id="5510f-775">Odkazy</span><span class="sxs-lookup"><span data-stu-id="5510f-775">References</span></span>
* [<span data-ttu-id="5510f-776">http://cassandra.apache.org</span><span class="sxs-lookup"><span data-stu-id="5510f-776">http://cassandra.apache.org</span></span>](http://cassandra.apache.org)
* [<span data-ttu-id="5510f-777">http://www.datastax.com</span><span class="sxs-lookup"><span data-stu-id="5510f-777">http://www.datastax.com</span></span>](http://www.datastax.com)
* [<span data-ttu-id="5510f-778">http://www.nodejs.org</span><span class="sxs-lookup"><span data-stu-id="5510f-778">http://www.nodejs.org</span></span>](http://www.nodejs.org)

