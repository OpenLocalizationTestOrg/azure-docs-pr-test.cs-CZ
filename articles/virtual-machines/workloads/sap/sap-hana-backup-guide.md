---
title: "Příručce zálohování pro SAP HANA ve virtuálních počítačích Azure | Microsoft Docs"
description: "Zálohování Příručka pro SAP HANA obsahuje dvě hlavní možnosti zálohování pro SAP HANA na virtuálních počítačích Azure"
services: virtual-machines-linux
documentationcenter: 
author: hermanndms
manager: timlt
editor: 
ms.service: virtual-machines-linux
ms.devlang: NA
ms.topic: article
ums.tgt_pltfrm: vm-linux
ms.workload: infrastructure-services
ms.date: 3/13/2017
ms.author: rclaus
ms.openlocfilehash: 9e5b124643b753f404ba6012d3df998f567be59a
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/29/2017
---
# <a name="backup-guide-for-sap-hana-on-azure-virtual-machines"></a><span data-ttu-id="97b16-103">Průvodce zálohováním pro SAP HANA na Azure Virtual Machines</span><span class="sxs-lookup"><span data-stu-id="97b16-103">Backup guide for SAP HANA on Azure Virtual Machines</span></span>

## <a name="getting-started"></a><span data-ttu-id="97b16-104">Začínáme</span><span class="sxs-lookup"><span data-stu-id="97b16-104">Getting Started</span></span>

<span data-ttu-id="97b16-105">Průvodce zálohování pro SAP HANA běžících na virtuálních počítačích Azure se popisují pouze témata specifické pro Azure.</span><span class="sxs-lookup"><span data-stu-id="97b16-105">The backup guide for SAP HANA running on Azure virtual Machines will only describe Azure-specific topics.</span></span> <span data-ttu-id="97b16-106">Pro obecné SAP HANA související položky zálohování, naleznete v dokumentaci SAP HANA (viz _zálohování dokumentace SAP HANA_ dále v tomto článku).</span><span class="sxs-lookup"><span data-stu-id="97b16-106">For general SAP HANA backup related items, check the SAP HANA documentation (see _SAP HANA backup documentation_ later in this article).</span></span>

<span data-ttu-id="97b16-107">Existují dvě hlavní zálohování možnosti pro SAP HANA na virtuálních počítačích Azure je aktivní tohoto článku:</span><span class="sxs-lookup"><span data-stu-id="97b16-107">The focus of this article is on two major backup possibilities for SAP HANA on Azure virtual machines:</span></span>

- <span data-ttu-id="97b16-108">HANA zálohování do systému souborů v virtuální počítač Linux Azure (viz [SAP HANA Azure Backup na úrovni souborů](sap-hana-backup-file-level.md))</span><span class="sxs-lookup"><span data-stu-id="97b16-108">HANA backup to the file system in an Azure Linux Virtual Machine (see [SAP HANA Azure Backup on file level](sap-hana-backup-file-level.md))</span></span>
- <span data-ttu-id="97b16-109">HANA zálohování na základě úložiště snímků ručně pomocí funkce snímku objektu blob úložiště Azure nebo služby zálohování Azure (viz [SAP HANA zálohování podle úložiště snímků](sap-hana-backup-storage-snapshots.md))</span><span class="sxs-lookup"><span data-stu-id="97b16-109">HANA backup based on storage snapshots using the Azure storage blob snapshot feature manually or Azure Backup Service (see [SAP HANA backup based on storage snapshots](sap-hana-backup-storage-snapshots.md))</span></span>

<span data-ttu-id="97b16-110">SAP HANA nabízí zálohu rozhraní API, které umožňuje zálohování nástroje třetích stran pro integraci přímo SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="97b16-110">SAP HANA offers a backup API, which allows third-party backup tools to integrate directly with SAP HANA.</span></span> <span data-ttu-id="97b16-111">(Který není v rámci oboru této příručky.) Neexistuje žádná přímá integrace SAP HANA pomocí služby Azure Backup k dispozici pravé na základě na toto rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="97b16-111">(That is not within the scope of this guide.) There is no direct integration of SAP HANA with Azure Backup service available right now based on this API.</span></span>

<span data-ttu-id="97b16-112">SAP HANA oficiálně podporované u virtuálního počítače Azure typu GS5 jako jedna instance s další omezení pro úlohy OLAP (viz [najít platformy IaaS certifikované](https://global.sap.com/community/ebook/2014-09-02-hana-hardware/enEN/iaas.html) na webu SAP).</span><span class="sxs-lookup"><span data-stu-id="97b16-112">SAP HANA is officially supported on Azure VM type GS5 as single instance with an additional restriction to OLAP workloads (see [Find Certified IaaS Platforms](https://global.sap.com/community/ebook/2014-09-02-hana-hardware/enEN/iaas.html) on the SAP website).</span></span> <span data-ttu-id="97b16-113">Tento článek se aktualizuje jako nové nabídky pro SAP HANA v Azure k dispozici.</span><span class="sxs-lookup"><span data-stu-id="97b16-113">This article will be updated as new offerings for SAP HANA on Azure become available.</span></span>

<span data-ttu-id="97b16-114">Je také SAP HANA hybridní řešení k dispozici na Azure, kde SAP HANA běží nevirtuálním na fyzických serverech.</span><span class="sxs-lookup"><span data-stu-id="97b16-114">There is also an SAP HANA hybrid solution available on Azure, where SAP HANA runs non-virtualized on physical servers.</span></span> <span data-ttu-id="97b16-115">Ale tento průvodce zálohování SAP HANA Azure popisuje čistý prostředí Azure, kde SAP HANA běží ve virtuálním počítači Azure, ne SAP HANA systémem &quot;velké instancí.&quot; V tématu [přehled SAP HANA (velké instance) a architektura v Azure](hana-overview-architecture.md) Další informace o tomto řešení zálohování na &quot;velké instancí&quot; podle úložiště snímků.</span><span class="sxs-lookup"><span data-stu-id="97b16-115">However, this SAP HANA Azure backup guide covers a pure Azure environment where SAP HANA runs in an Azure VM, not SAP HANA running on &quot;large instances.&quot; See [SAP HANA (large instances) overview and architecture on Azure](hana-overview-architecture.md) for more information about this backup solution on &quot;large instances&quot; based on storage snapshots.</span></span>

<span data-ttu-id="97b16-116">Obecné informace o produktech SAP podporován na platformě Azure můžete najít v [1928533 Poznámka SAP](https://launchpad.support.sap.com/#/notes/1928533).</span><span class="sxs-lookup"><span data-stu-id="97b16-116">General information about SAP products supported on Azure can be found in [SAP Note 1928533](https://launchpad.support.sap.com/#/notes/1928533).</span></span>

<span data-ttu-id="97b16-117">Následující tři údaje poskytnout přehled SAP HANA možnosti zálohování pomocí nativního možnosti Azure aktuálně a také se zobrazují tři možných scénářů budoucí zálohy.</span><span class="sxs-lookup"><span data-stu-id="97b16-117">The following three figures give an overview of the SAP HANA backup options using native Azure capabilities currently, and also show three potential future backup scenarios.</span></span> <span data-ttu-id="97b16-118">Související články [SAP HANA Azure Backup na úrovni souborů](sap-hana-backup-file-level.md) a [SAP HANA zálohování podle úložiště snímků](sap-hana-backup-storage-snapshots.md) popisují tyto možnosti podrobněji, včetně velikosti a výkonové požadavky SAP HANA zálohování, které jsou více terabajtů velikost.</span><span class="sxs-lookup"><span data-stu-id="97b16-118">The related articles [SAP HANA Azure Backup on file level](sap-hana-backup-file-level.md) and [SAP HANA backup based on storage snapshots](sap-hana-backup-storage-snapshots.md) describe these options in more detail, including size and performance considerations for SAP HANA backups that are multi-terabytes in size.</span></span>

![Následující obrázek ukazuje existují dvě možnosti pro ukládání aktuální stav virtuálního počítače](media/sap-hana-backup-guide/image001.png)

<span data-ttu-id="97b16-120">Následující obrázek ukazuje možnost ukládání aktuální stav virtuálního počítače prostřednictvím služby Azure Backup nebo ruční snímek disky virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="97b16-120">This figure shows the possibility of saving the current VM state, either via Azure Backup service or manual snapshot of VM disks.</span></span> <span data-ttu-id="97b16-121">S tímto přístupem, jeden nemá & č. 39; t muset spravovat zálohy SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="97b16-121">With this approach, one doesn&#39;t have to manage SAP HANA backups.</span></span> <span data-ttu-id="97b16-122">Výzvy scénáře snímku disku je konzistence systému souborů a k dispozici stav disku konzistentní s aplikací.</span><span class="sxs-lookup"><span data-stu-id="97b16-122">The challenge of the disk snapshot scenario is file system consistency, and an application-consistent disk state.</span></span> <span data-ttu-id="97b16-123">Konzistence tématu je popsán v části _konzistenci dat SAP HANA při pořizování snímků úložiště_ dále v tomto článku.</span><span class="sxs-lookup"><span data-stu-id="97b16-123">The consistency topic is discussed in the section _SAP HANA data consistency when taking storage snapshots_ later in this article.</span></span> <span data-ttu-id="97b16-124">Omezení služby Azure Backup související s SAP HANA zálohy a možnosti jsou popsány i později v tomto článku.</span><span class="sxs-lookup"><span data-stu-id="97b16-124">Capabilities and restrictions of Azure Backup service related to SAP HANA backups are also discussed later in this article.</span></span>

![Následující obrázek ukazuje, že ve virtuálním počítači zálohování souborů možnosti za vyjádření SAP HANA](media/sap-hana-backup-guide/image002.png)

<span data-ttu-id="97b16-126">Následující obrázek ukazuje možnosti trvá zálohu souboru SAP HANA ve virtuálním počítači a pak ukládání záložních souborů HANA někde jinde pomocí různých nástrojů.</span><span class="sxs-lookup"><span data-stu-id="97b16-126">This figure shows options for taking an SAP HANA file backup inside the VM, and then storing it HANA backup files somewhere else using different tools.</span></span> <span data-ttu-id="97b16-127">Zálohování HANA vyžaduje více času, než řešení zálohování založené na snímku, ale má výhody týkající se integrity a konzistence.</span><span class="sxs-lookup"><span data-stu-id="97b16-127">Taking a HANA backup requires more time than a snapshot-based backup solution, but it has advantages regarding integrity and consistency.</span></span> <span data-ttu-id="97b16-128">Další podrobnosti jsou uvedeny dále v tomto článku.</span><span class="sxs-lookup"><span data-stu-id="97b16-128">More details are provided later in this article.</span></span>

![Tento obrázek znázorňuje potenciální budoucí zálohy scénář SAP HANA](media/sap-hana-backup-guide/image003.png)

<span data-ttu-id="97b16-130">Tento obrázek znázorňuje potenciální budoucí zálohy scénář SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="97b16-130">This figure shows a potential future SAP HANA backup scenario.</span></span> <span data-ttu-id="97b16-131">Pokud SAP HANA povolený umožňoval vytvářet zálohy z sekundární replikace, by přidat další možnosti pro strategii zálohování.</span><span class="sxs-lookup"><span data-stu-id="97b16-131">If SAP HANA allowed taking backups from a replication secondary, it would add additional options for backup strategies.</span></span> <span data-ttu-id="97b16-132">Aktuálně není možné podle post na stránkách Wiki SAP HANA:</span><span class="sxs-lookup"><span data-stu-id="97b16-132">Currently it isn't possible according to a post in the SAP HANA Wiki:</span></span>

<span data-ttu-id="97b16-133">_&quot;Je možné provést zálohování na sekundární straně?_</span><span class="sxs-lookup"><span data-stu-id="97b16-133">_&quot;Is it possible to take backups on the secondary side?_</span></span>

<span data-ttu-id="97b16-134">_Ne, teď můžete pouze trvat dat a protokolu zálohování na primární straně. Pokud je povoleno automatické protokolu zálohování, po převzetí na sekundární stranu zálohy protokolu automaticky se zapíšou existuje.&quot;_</span><span class="sxs-lookup"><span data-stu-id="97b16-134">_No, currently you can only take data and log backups on the primary side. If automatic log backup is enabled, after takeover to the secondary side, the log backups will automatically be written there.&quot;_</span></span>

## <a name="sap-resources-for-hana-backup"></a><span data-ttu-id="97b16-135">Prostředky SAP HANA zálohování</span><span class="sxs-lookup"><span data-stu-id="97b16-135">SAP resources for HANA backup</span></span>

### <a name="sap-hana-backup-documentation"></a><span data-ttu-id="97b16-136">Zálohování dokumentace SAP HANA</span><span class="sxs-lookup"><span data-stu-id="97b16-136">SAP HANA backup documentation</span></span>

- [<span data-ttu-id="97b16-137">Úvod do správy SAP HANA</span><span class="sxs-lookup"><span data-stu-id="97b16-137">Introduction to SAP HANA Administration</span></span>](https://help.sap.com/viewer/6b94445c94ae495c83a19646e7c3fd56/2.0.00/en-US)
- [<span data-ttu-id="97b16-138">Plánování zálohování a obnovení strategie</span><span class="sxs-lookup"><span data-stu-id="97b16-138">Planning Your Backup and Recovery Strategy</span></span>](https://help.sap.com/saphelp_hanaplatform/helpdata/en/ef/085cd5949c40b788bba8fd3c65743e/content.htm)
- [<span data-ttu-id="97b16-139">Plánování zálohování HANA pomocí ABAP DBACOCKPIT</span><span class="sxs-lookup"><span data-stu-id="97b16-139">Schedule HANA Backup using ABAP DBACOCKPIT</span></span>](http://www.hanatutorials.com/p/schedule-hana-backup-using-abap.html)
- [<span data-ttu-id="97b16-140">Plán zálohování dat (SAP HANA řídícího panelu)</span><span class="sxs-lookup"><span data-stu-id="97b16-140">Schedule Data Backups (SAP HANA Cockpit)</span></span>](http://help.sap.com/saphelp_hanaplatform/helpdata/en/6d/385fa14ef64a6bab2c97a3d3e40292/frameset.htm)
- <span data-ttu-id="97b16-141">Nejčastější dotazy o SAP HANA zálohování v [1642148 Poznámka SAP](https://launchpad.support.sap.com/#/notes/1642148)</span><span class="sxs-lookup"><span data-stu-id="97b16-141">FAQ about SAP HANA backup in [SAP Note 1642148](https://launchpad.support.sap.com/#/notes/1642148)</span></span>
- <span data-ttu-id="97b16-142">Nejčastější dotazy o SAP HANA snímky databáze a úložiště v [2039883 Poznámka SAP](https://launchpad.support.sap.com/#/notes/2039883)</span><span class="sxs-lookup"><span data-stu-id="97b16-142">FAQ about SAP HANA database and storage snapshots in [SAP Note 2039883](https://launchpad.support.sap.com/#/notes/2039883)</span></span>
- <span data-ttu-id="97b16-143">Systémy souborů síť není vhodný pro zálohování a obnovení v [1820529 Poznámka SAP](https://launchpad.support.sap.com/#/notes/1820529)</span><span class="sxs-lookup"><span data-stu-id="97b16-143">Unsuitable network file systems for backup and recovery in [SAP Note 1820529](https://launchpad.support.sap.com/#/notes/1820529)</span></span>

### <a name="why-sap-hana-backup"></a><span data-ttu-id="97b16-144">Proč SAP HANA zálohování?</span><span class="sxs-lookup"><span data-stu-id="97b16-144">Why SAP HANA backup?</span></span>

<span data-ttu-id="97b16-145">Azure storage nabízí dostupnost a spolehlivost mimo pole (viz [Úvod do Microsoft Azure Storage](../../../storage/common/storage-introduction.md) Další informace o úložišti Azure).</span><span class="sxs-lookup"><span data-stu-id="97b16-145">Azure storage offers availability and reliability out of the box (see [Introduction to Microsoft Azure Storage](../../../storage/common/storage-introduction.md) for more information about Azure storage).</span></span>

<span data-ttu-id="97b16-146">Minimum pro &quot;zálohování&quot; je moct spolehnout na Azure SLA, udržování SAP HANA souborů protokolu a data na disky Azure připojené k serveru SAP HANA virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="97b16-146">The minimum for &quot;backup&quot; is to rely on the Azure SLAs, keeping the SAP HANA data and log files on Azure VHDs attached to the SAP HANA server VM.</span></span> <span data-ttu-id="97b16-147">Tento postup popisuje selhání virtuálních počítačů, ale není možné škody SAP HANA data a soubory protokolu nebo logické chyby jako odstraněním dat nebo soubory omylem odstraněný.</span><span class="sxs-lookup"><span data-stu-id="97b16-147">This approach covers VM failures, but not potential damage to the SAP HANA data and log files, or logical errors like deleting data or files by accident.</span></span> <span data-ttu-id="97b16-148">Zálohy jsou rovněž vyžadovány pro dodržování předpisů nebo právních důvodů.</span><span class="sxs-lookup"><span data-stu-id="97b16-148">Backups are also required for compliance or legal reasons.</span></span> <span data-ttu-id="97b16-149">Stručně řečeno je vždy nutné pro SAP HANA zálohy.</span><span class="sxs-lookup"><span data-stu-id="97b16-149">In short, there is always a need for SAP HANA backups.</span></span>

### <a name="how-to-verify-correctness-of-sap-hana-backup"></a><span data-ttu-id="97b16-150">Jak ověřit správnost zálohování SAP HANA</span><span class="sxs-lookup"><span data-stu-id="97b16-150">How to verify correctness of SAP HANA backup</span></span>
<span data-ttu-id="97b16-151">Při použití úložiště snímků, se doporučuje spustit test obnovení v jiném systému.</span><span class="sxs-lookup"><span data-stu-id="97b16-151">When using storage snapshots, running a test restore on a different system is recommended.</span></span> <span data-ttu-id="97b16-152">Tento přístup poskytuje způsob, jak zajistěte, aby zálohu správná a interní procesy pro zálohování a obnovení pracovní podle očekávání.</span><span class="sxs-lookup"><span data-stu-id="97b16-152">This approach provides a way to ensure that a backup is correct, and internal processes for backup and restore work as expected.</span></span> <span data-ttu-id="97b16-153">Přestože se významným vlivem mezní místně, je mnohem snazší provést v cloudu dočasně poskytnutím potřebné prostředky pro tento účel.</span><span class="sxs-lookup"><span data-stu-id="97b16-153">While this is a significant hurdle on-premises, it is much easier to accomplish in the cloud by providing necessary resources temporarily for this purpose.</span></span>

<span data-ttu-id="97b16-154">Zachovat na paměti, díky jednoduché obnovení a kontrole, jestli je HANA a spouštění není dostatečná.</span><span class="sxs-lookup"><span data-stu-id="97b16-154">Keep in mind that doing a simple restore and checking if HANA is up and running is not sufficient.</span></span> <span data-ttu-id="97b16-155">V ideálním případě jeden měli spustit kontrolu konzistence tabulky a ujistěte se, že je v pořádku obnovenou databázi.</span><span class="sxs-lookup"><span data-stu-id="97b16-155">Ideally, one should run a table consistency check to be sure that the restored database is fine.</span></span> <span data-ttu-id="97b16-156">SAP HANA nabízí několik druhů kontroly konzistence, které jsou popsané v [1977584 Poznámka SAP](https://launchpad.support.sap.com/#/notes/1977584).</span><span class="sxs-lookup"><span data-stu-id="97b16-156">SAP HANA offers several kinds of consistency checks described in [SAP Note 1977584](https://launchpad.support.sap.com/#/notes/1977584).</span></span>

<span data-ttu-id="97b16-157">Informace o kontrole konzistence tabulku je možné také najít na webu SAP na [tabulky a kontrol konzistence katalogu](http://help.sap.com/saphelp_hanaplatform/helpdata/en/25/84ec2e324d44529edc8221956359ea/content.htm#loio9357bf52c7324bee9567dca417ad9f8b).</span><span class="sxs-lookup"><span data-stu-id="97b16-157">Information about the table consistency check can also be found on the SAP website at [Table and Catalog Consistency Checks](http://help.sap.com/saphelp_hanaplatform/helpdata/en/25/84ec2e324d44529edc8221956359ea/content.htm#loio9357bf52c7324bee9567dca417ad9f8b).</span></span>

<span data-ttu-id="97b16-158">Obnovení testu pro standardních souborových záloh, není nutné.</span><span class="sxs-lookup"><span data-stu-id="97b16-158">For standard file backups, a test restore is not necessary.</span></span> <span data-ttu-id="97b16-159">Existují dvě SAP HANA nástroje, které pomáhají ke kontrole, kterou zálohy lze použít pro obnovení: hdbbackupdiag a hdbbackupcheck.</span><span class="sxs-lookup"><span data-stu-id="97b16-159">There are two SAP HANA tools that help to check which backup can be used for restore: hdbbackupdiag and hdbbackupcheck.</span></span> <span data-ttu-id="97b16-160">V tématu [Ruční kontrola zda obnovení je možné](https://help.sap.com/saphelp_hanaplatform/helpdata/en/77/522ef1e3cb4d799bab33e0aeb9c93b/content.htm) Další informace o těchto nástrojů.</span><span class="sxs-lookup"><span data-stu-id="97b16-160">See [Manually Checking Whether a Recovery is Possible](https://help.sap.com/saphelp_hanaplatform/helpdata/en/77/522ef1e3cb4d799bab33e0aeb9c93b/content.htm) for more information about these tools.</span></span>

### <a name="pros-and-cons-of-hana-backup-versus-storage-snapshot"></a><span data-ttu-id="97b16-161">Výhody a nevýhody HANA zálohování versus úložiště snímků</span><span class="sxs-lookup"><span data-stu-id="97b16-161">Pros and cons of HANA backup versus storage snapshot</span></span>

<span data-ttu-id="97b16-162">SAP nemá & č. 39; t udělení preference buď HANA zálohování versus úložiště snímků.</span><span class="sxs-lookup"><span data-stu-id="97b16-162">SAP doesn&#39;t give preference to either HANA backup versus storage snapshot.</span></span> <span data-ttu-id="97b16-163">Vypíše jejich výhody a nevýhody, takže jeden můžete určit, který se použije v závislosti na situaci a technologií úložiště k dispozici (viz [plánování vaše zálohování a obnovení strategie](https://help.sap.com/saphelp_hanaplatform/helpdata/en/ef/085cd5949c40b788bba8fd3c65743e/content.htm)).</span><span class="sxs-lookup"><span data-stu-id="97b16-163">It lists their pros and cons, so one can determine which to use depending on the situation and available storage technology (see [Planning Your Backup and Recovery Strategy](https://help.sap.com/saphelp_hanaplatform/helpdata/en/ef/085cd5949c40b788bba8fd3c65743e/content.htm)).</span></span>

<span data-ttu-id="97b16-164">V Azure, mějte na paměti skutečnost, že objekt blob systému Azure snímku funkce nemá & č. 39; t zaručit konzistence systému souborů (viz [snímky použití objektů blob v prostředí PowerShell](https://blogs.msdn.microsoft.com/cie/2016/05/17/using-blob-snapshots-with-powershell/)).</span><span class="sxs-lookup"><span data-stu-id="97b16-164">On Azure, be aware of the fact that the Azure blob snapshot feature doesn&#39;t guarantee file system consistency (see [Using blob snapshots with PowerShell](https://blogs.msdn.microsoft.com/cie/2016/05/17/using-blob-snapshots-with-powershell/)).</span></span> <span data-ttu-id="97b16-165">V další části _konzistenci dat SAP HANA při pořizování snímků úložiště_, popisuje některé aspekty týkající se této funkce.</span><span class="sxs-lookup"><span data-stu-id="97b16-165">The next section, _SAP HANA data consistency when taking storage snapshots_, discusses some considerations regarding this feature.</span></span>

<span data-ttu-id="97b16-166">Kromě toho je nutné vysvětlení fakturace důsledků při práci často s snímky objektů blob, jak je popsáno v tomto článku: [pochopení jak snímky nabíhat poplatky](/rest/api/storageservices/understanding-how-snapshots-accrue-charges)– ho neběží & č. 39; t jako zřejmé jako pomocí Azure virtuální disky.</span><span class="sxs-lookup"><span data-stu-id="97b16-166">In addition, one has to understand the billing implications when working frequently with blob snapshots as described in this article: [Understanding How Snapshots Accrue Charges](/rest/api/storageservices/understanding-how-snapshots-accrue-charges)—it isn&#39;t as obvious as using Azure virtual disks.</span></span>

### <a name="sap-hana-data-consistency-when-taking-storage-snapshots"></a><span data-ttu-id="97b16-167">SAP HANA konzistenci dat, když se vezme úložiště snímků</span><span class="sxs-lookup"><span data-stu-id="97b16-167">SAP HANA data consistency when taking storage snapshots</span></span>

<span data-ttu-id="97b16-168">Systém a aplikace konzistence souborů je komplexní problém při pořizování snímků úložiště.</span><span class="sxs-lookup"><span data-stu-id="97b16-168">File system and application consistency is a complex issue when taking storage snapshots.</span></span> <span data-ttu-id="97b16-169">Nejjednodušší způsob, jak se vyhnout problémům by mohla být vypnout SAP HANA, nebo může být i celý virtuální počítač.</span><span class="sxs-lookup"><span data-stu-id="97b16-169">The easiest way to avoid problems would be to shut down SAP HANA, or maybe even the whole virtual machine.</span></span> <span data-ttu-id="97b16-170">Vypnutí může být doable s ukázku nebo prototypu nebo i vývojového systému, ale není možnost pro produkční systému.</span><span class="sxs-lookup"><span data-stu-id="97b16-170">A shutdown might be doable with a demo or prototype, or even a development system, but it is not an option for a production system.</span></span>

<span data-ttu-id="97b16-171">V Azure, a jeden má mějte na paměti, že objekt blob systému Azure snímku funkce nemá & č. 39; konzistence systému souborů záruku t.</span><span class="sxs-lookup"><span data-stu-id="97b16-171">On Azure, one has to keep in mind that the Azure blob snapshot feature doesn&#39;t guarantee file system consistency.</span></span> <span data-ttu-id="97b16-172">Funguje bez problémů ale pomocí snímku SAP HANA funkce, dokud související se situací je jenom jeden virtuální disk.</span><span class="sxs-lookup"><span data-stu-id="97b16-172">It works fine however by using the SAP HANA snapshot feature, as long as there is only a single virtual disk involved.</span></span> <span data-ttu-id="97b16-173">Ale i s jeden disk, musí být vráceny další položky.</span><span class="sxs-lookup"><span data-stu-id="97b16-173">But even with a single disk, additional items have to be checked.</span></span> <span data-ttu-id="97b16-174">[SAP Poznámka 2039883](https://launchpad.support.sap.com/#/notes/2039883) obsahuje důležité informace o zálohování SAP HANA pomocí snímků úložiště.</span><span class="sxs-lookup"><span data-stu-id="97b16-174">[SAP Note 2039883](https://launchpad.support.sap.com/#/notes/2039883) has important information about SAP HANA backups via storage snapshots.</span></span> <span data-ttu-id="97b16-175">Například uvádí, že pomocí systému souborů XFS, je nutné spustit **xfs\_freeze** před zahájením snímek úložiště, který chcete zaručit konzistenci (najdete v části [xfs\_freeze(8) - stránka man Linux](https://linux.die.net/man/8/xfs_freeze) podrobnosti o **xfs\_freeze**).</span><span class="sxs-lookup"><span data-stu-id="97b16-175">For example, it mentions that, with the XFS file system, it is necessary to run **xfs\_freeze** before starting a storage snapshot to guarantee consistency (see [xfs\_freeze(8) - Linux man page](https://linux.die.net/man/8/xfs_freeze) for details on **xfs\_freeze**).</span></span>

<span data-ttu-id="97b16-176">Téma konzistence se změní i další náročné, v případě, kde jeden soubor systému zahrnuje několik disky nebo svazky.</span><span class="sxs-lookup"><span data-stu-id="97b16-176">The topic of consistency becomes even more challenging in a case where a single file system spans multiple disks/volumes.</span></span> <span data-ttu-id="97b16-177">Například s využitím mdadm nebo LVM a prokládání.</span><span class="sxs-lookup"><span data-stu-id="97b16-177">For example, by using mdadm or LVM and striping.</span></span> <span data-ttu-id="97b16-178">Poznámka SAP zmíněné stavy:</span><span class="sxs-lookup"><span data-stu-id="97b16-178">The SAP Note mentioned above states:</span></span>

<span data-ttu-id="97b16-179">_&quot;Ale mějte na paměti, která systém úložiště musí zaručit konzistenci vstupně-výstupních operací při vytváření snímku úložiště za SAP HANA datový svazek, tj. snímkování svazku SAP HANA specifických dat služby musí být atomické operace.&quot;_</span><span class="sxs-lookup"><span data-stu-id="97b16-179">_&quot;But keep in mind that the storage system has to guarantee I/O consistency while creating a storage snapshot per SAP HANA data volume, i.e. snapshotting of an SAP HANA service-specific data volume must be an atomic operation.&quot;_</span></span>

<span data-ttu-id="97b16-180">Za předpokladu, že je systém souborů XFS pokrývání uzlů čtyři Azure virtuální disky, následující kroky obsahují konzistentní snímek, který představuje HANA datové oblasti:</span><span class="sxs-lookup"><span data-stu-id="97b16-180">Assuming there is an XFS file system spanning four Azure virtual disks, the following steps provide a consistent snapshot that represents the HANA data area:</span></span>

- <span data-ttu-id="97b16-181">Příprava HANA snímku</span><span class="sxs-lookup"><span data-stu-id="97b16-181">HANA snapshot prepare</span></span>
- <span data-ttu-id="97b16-182">Freeze – systém souborů (například použít **xfs\_freeze**)</span><span class="sxs-lookup"><span data-stu-id="97b16-182">Freeze the file system (for example, use **xfs\_freeze**)</span></span>
- <span data-ttu-id="97b16-183">Vytvářet všechny snímky nezbytné objektů blob v Azure</span><span class="sxs-lookup"><span data-stu-id="97b16-183">Create all necessary blob snapshots on Azure</span></span>
- <span data-ttu-id="97b16-184">Uvolní systému souborů</span><span class="sxs-lookup"><span data-stu-id="97b16-184">Unfreeze the file system</span></span>
- <span data-ttu-id="97b16-185">Potvrďte snímku HANA</span><span class="sxs-lookup"><span data-stu-id="97b16-185">Confirm the HANA snapshot</span></span>

<span data-ttu-id="97b16-186">Doporučuje se použít uvedený postup ve všech případech být v bezpečí, bez ohledu na to, které systém souborů.</span><span class="sxs-lookup"><span data-stu-id="97b16-186">Recommendation is to use the procedure above in all cases to be on the safe side, no matter which file system.</span></span> <span data-ttu-id="97b16-187">Nebo pokud se jedná o jediný disk nebo prokládání, prostřednictvím mdadm nebo LVM na více disků.</span><span class="sxs-lookup"><span data-stu-id="97b16-187">Or if it is a single disk or striping, via mdadm or LVM across multiple disks.</span></span>

<span data-ttu-id="97b16-188">Je důležité pro potvrzení HANA snímku.</span><span class="sxs-lookup"><span data-stu-id="97b16-188">It is important to confirm the HANA snapshot.</span></span> <span data-ttu-id="97b16-189">Z důvodu &quot;kopie při zápisu,&quot; SAP HANA nemusí vyžadovat další místo na disku v to snímku Příprava režimu.</span><span class="sxs-lookup"><span data-stu-id="97b16-189">Due to the &quot;Copy-on-Write,&quot; SAP HANA might not require additional disk space while in this snapshot-prepare mode.</span></span> <span data-ttu-id="97b16-190">Vyb & č. 39; s také není možné spustit nové zálohování, dokud je potvrzen snímku SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="97b16-190">It&#39;s also not possible to start new backups until the SAP HANA snapshot is confirmed.</span></span>

<span data-ttu-id="97b16-191">Služba Azure Backup používá rozšíření virtuálního počítače Azure, abyste dbali konzistence systému souborů.</span><span class="sxs-lookup"><span data-stu-id="97b16-191">Azure Backup service uses Azure VM extensions to take care of the file system consistency.</span></span> <span data-ttu-id="97b16-192">Tato rozšíření virtuálního počítače nejsou k dispozici pro samostatné použití.</span><span class="sxs-lookup"><span data-stu-id="97b16-192">These VM extensions are not available for standalone usage.</span></span> <span data-ttu-id="97b16-193">Jeden má stále ke správě konzistence SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="97b16-193">One still has to manage SAP HANA consistency.</span></span> <span data-ttu-id="97b16-194">Najdete v souvisejícím článku [SAP HANA Azure Backup na úrovni souborů](sap-hana-backup-file-level.md) Další informace.</span><span class="sxs-lookup"><span data-stu-id="97b16-194">See the related article [SAP HANA Azure Backup on file level](sap-hana-backup-file-level.md) for more information.</span></span>

### <a name="sap-hana-backup-scheduling-strategy"></a><span data-ttu-id="97b16-195">Plánování strategie SAP HANA zálohování</span><span class="sxs-lookup"><span data-stu-id="97b16-195">SAP HANA backup scheduling strategy</span></span>

<span data-ttu-id="97b16-196">Článek SAP HANA [plánování vaše zálohování a obnovení strategie](https://help.sap.com/saphelp_hanaplatform/helpdata/en/ef/085cd5949c40b788bba8fd3c65743e/content.htm) stavy základní plán k zálohování:</span><span class="sxs-lookup"><span data-stu-id="97b16-196">The SAP HANA article [Planning Your Backup and Recovery Strategy](https://help.sap.com/saphelp_hanaplatform/helpdata/en/ef/085cd5949c40b788bba8fd3c65743e/content.htm) states a basic plan to do backups:</span></span>

- <span data-ttu-id="97b16-197">Úložiště snímků (denní)</span><span class="sxs-lookup"><span data-stu-id="97b16-197">Storage snapshot (daily)</span></span>
- <span data-ttu-id="97b16-198">Zálohování kompletní datový soubor nebo bacint formátu (jednou týdně)</span><span class="sxs-lookup"><span data-stu-id="97b16-198">Complete data backup using file or bacint format (once a week)</span></span>
- <span data-ttu-id="97b16-199">Automatické protokolu zálohování</span><span class="sxs-lookup"><span data-stu-id="97b16-199">Automatic log backups</span></span>

<span data-ttu-id="97b16-200">Volitelně můžete jeden může přejít zcela bez snímků úložiště; může být nahrazen HANA rozdílové zálohy, jako přírůstkové nebo rozdílové zálohy (viz [rozdílové zálohy](https://help.sap.com/saphelp_hanaplatform/helpdata/en/c3/bb7e33bb571014a03eeabba4e37541/content.htm)).</span><span class="sxs-lookup"><span data-stu-id="97b16-200">Optionally, one could go completely without storage snapshots; they could be replaced by HANA delta backups, like incremental or differential backups (see [Delta Backups](https://help.sap.com/saphelp_hanaplatform/helpdata/en/c3/bb7e33bb571014a03eeabba4e37541/content.htm)).</span></span>

<span data-ttu-id="97b16-201">Průvodce správou HANA obsahuje seznam příklad.</span><span class="sxs-lookup"><span data-stu-id="97b16-201">The HANA Administration guide provides an example list.</span></span> <span data-ttu-id="97b16-202">Navrhování jeden obnovit SAP HANA k určitému bodu v čase pomocí následující posloupnosti zálohování:</span><span class="sxs-lookup"><span data-stu-id="97b16-202">It suggests that one recover SAP HANA to a specific point in time using the following sequence of backups:</span></span>

1. <span data-ttu-id="97b16-203">Úplná záloha</span><span class="sxs-lookup"><span data-stu-id="97b16-203">Full data backup</span></span>
2. <span data-ttu-id="97b16-204">Rozdílovou zálohu</span><span class="sxs-lookup"><span data-stu-id="97b16-204">Differential backup</span></span>
3. <span data-ttu-id="97b16-205">Přírůstkové zálohování 1</span><span class="sxs-lookup"><span data-stu-id="97b16-205">Incremental backup 1</span></span>
4. <span data-ttu-id="97b16-206">Přírůstkové zálohování 2</span><span class="sxs-lookup"><span data-stu-id="97b16-206">Incremental backup 2</span></span>
5. <span data-ttu-id="97b16-207">Zálohy protokolů</span><span class="sxs-lookup"><span data-stu-id="97b16-207">Log backups</span></span>

<span data-ttu-id="97b16-208">O přesný plán, kdy a jak často má proběhnout konkrétní typ zálohy, není možné poskytnout obecných pokynů – je příliš specifické pro zákazníka a závisí na tom, kolik dat změnách v systému.</span><span class="sxs-lookup"><span data-stu-id="97b16-208">Regarding an exact schedule as to when and how often a specific backup type should happen, it is not possible to give a general guideline—it is too customer-specific, and depends on how many data changes occur in the system.</span></span> <span data-ttu-id="97b16-209">Jeden základní ze strany SAP, které můžete zobrazit jako obecné pokyny, doporučuje se zpřístupnění jeden úplné HANA zálohování jednou za týden.</span><span class="sxs-lookup"><span data-stu-id="97b16-209">One basic recommendation from SAP side, which can be seen as general guidance, is to make one full HANA backup once a week.</span></span>
<span data-ttu-id="97b16-210">Týká se zálohy protokolu, naleznete v dokumentaci k SAP HANA [zálohy protokolu](https://help.sap.com/saphelp_hanaplatform/helpdata/en/c3/bb7e33bb571014a03eeabba4e37541/content.htm).</span><span class="sxs-lookup"><span data-stu-id="97b16-210">Regarding log backups, see the SAP HANA documentation [Log Backups](https://help.sap.com/saphelp_hanaplatform/helpdata/en/c3/bb7e33bb571014a03eeabba4e37541/content.htm).</span></span>

<span data-ttu-id="97b16-211">SAP taky doporučuje provádění některých housekeeping zálohování katalogu zabránit růstu nekonečnou (najdete v části [spouštění pro katalog zálohování a zálohování úložiště](http://help.sap.com/saphelp_hanaplatform/helpdata/en/ca/c903c28b0e4301b39814ef41dbf568/content.htm)).</span><span class="sxs-lookup"><span data-stu-id="97b16-211">SAP also recommends doing some housekeeping of the backup catalog to keep it from growing infinitely (see [Housekeeping for Backup Catalog and Backup Storage](http://help.sap.com/saphelp_hanaplatform/helpdata/en/ca/c903c28b0e4301b39814ef41dbf568/content.htm)).</span></span>

### <a name="sap-hana-configuration-files"></a><span data-ttu-id="97b16-212">Konfigurační soubory SAP HANA</span><span class="sxs-lookup"><span data-stu-id="97b16-212">SAP HANA configuration files</span></span>

<span data-ttu-id="97b16-213">Jak je uvedeno v části Nejčastější dotazy v [1642148 Poznámka SAP](https://launchpad.support.sap.com/#/notes/1642148), SAP HANA konfigurační soubory, které nejsou součástí standardní HANA zálohování.</span><span class="sxs-lookup"><span data-stu-id="97b16-213">As stated in the FAQ in [SAP Note 1642148](https://launchpad.support.sap.com/#/notes/1642148), the SAP HANA configuration files are not part of a standard HANA backup.</span></span> <span data-ttu-id="97b16-214">Nejsou nezbytně nutné, aby obnovení systému.</span><span class="sxs-lookup"><span data-stu-id="97b16-214">They are not essential to restore a system.</span></span> <span data-ttu-id="97b16-215">Konfigurace HANA může po obnovení ručně změnit.</span><span class="sxs-lookup"><span data-stu-id="97b16-215">The HANA configuration could be changed manually after the restore.</span></span> <span data-ttu-id="97b16-216">V případě, že jeden chtěli získat stejné vlastní konfigurace během procesu obnovení, je nutné zálohovat konfigurační soubory HANA samostatně.</span><span class="sxs-lookup"><span data-stu-id="97b16-216">In case one would like to get the same custom configuration during the restore process, it is necessary to back up the HANA configuration files separately.</span></span>

<span data-ttu-id="97b16-217">Pokud se má vyhrazený systém zálohování souborů HANA standardní HANA zálohy, jeden může také zkopírujte konfigurační soubory na stejném systém zálohování souborů a potom všechno, co společně zkopírujte do cíl konečné úložiště jako nástrojů úložiště objektů blob.</span><span class="sxs-lookup"><span data-stu-id="97b16-217">If standard HANA backups are going to a dedicated HANA backup file system, one could also copy the configuration files to the same backup filesystem, and then copy everything together to the final storage destination like cool blob storage.</span></span>

### <a name="sap-hana-cockpit"></a><span data-ttu-id="97b16-218">Řídící panel SAP HANA</span><span class="sxs-lookup"><span data-stu-id="97b16-218">SAP HANA Cockpit</span></span>

<span data-ttu-id="97b16-219">Řídící panel SAP HANA nabízí možnost, monitorování a správa SAP HANA prostřednictvím prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="97b16-219">SAP HANA Cockpit offers the possibility of monitoring and managing SAP HANA via a browser.</span></span> <span data-ttu-id="97b16-220">Také umožňuje zpracování SAP HANA záloh a proto je lze použít jako alternativu k SAP HANA Studio a ABAP DBACOCKPIT (viz [řídící panel SAP HANA](https://help.sap.com/saphelp_hanaplatform/helpdata/en/73/c37822444344f3973e0e976b77958e/content.htm) Další informace).</span><span class="sxs-lookup"><span data-stu-id="97b16-220">It also allows handling of SAP HANA backups, and therefore can be used as an alternative to SAP HANA Studio and ABAP DBACOCKPIT (see [SAP HANA Cockpit](https://help.sap.com/saphelp_hanaplatform/helpdata/en/73/c37822444344f3973e0e976b77958e/content.htm) for more information).</span></span>

![Následující obrázek ukazuje obrazovce pro správu databáze SAP HANA řídící panel](media/sap-hana-backup-guide/image004.png)

<span data-ttu-id="97b16-222">Následující obrázek ukazuje obrazovce pro správu databáze SAP HANA řídicí panel a dlaždici zálohování na levé straně.</span><span class="sxs-lookup"><span data-stu-id="97b16-222">This figure shows the SAP HANA Cockpit Database Administration Screen, and the backup tile on the left.</span></span> <span data-ttu-id="97b16-223">Zobrazuje dlaždici zálohování vyžaduje příslušných uživatelských oprávnění pro účet pro přihlášení.</span><span class="sxs-lookup"><span data-stu-id="97b16-223">Seeing the backup tile requires appropriate user permissions for login account.</span></span>

![Zálohy lze sledovat v řídícím SAP HANA době, kdy jsou probíhající](media/sap-hana-backup-guide/image005.png)

<span data-ttu-id="97b16-225">Zálohování se dá sledovat v řídícím SAP HANA jsou probíhající a po jeho dokončení zálohování podrobnosti jsou k dispozici.</span><span class="sxs-lookup"><span data-stu-id="97b16-225">Backups can be monitored in SAP HANA Cockpit while they are ongoing and, once it is finished, all the backup details are available.</span></span>

![Příklad použití Firefox na virtuální počítač Azure SLES 12 Gnome plochy](media/sap-hana-backup-guide/image006.png)

<span data-ttu-id="97b16-227">Na předchozích snímcích obrazovky nebyly provedeny z virtuálního počítače Windows Azure.</span><span class="sxs-lookup"><span data-stu-id="97b16-227">The previous screenshots were made from an Azure Windows VM.</span></span> <span data-ttu-id="97b16-228">Tato funkce je příklad pomocí prohlížeče Firefox na virtuální počítač Azure SLES 12 Gnome plochy.</span><span class="sxs-lookup"><span data-stu-id="97b16-228">This one is an example using Firefox on an Azure SLES 12 VM with Gnome desktop.</span></span> <span data-ttu-id="97b16-229">Zobrazuje možnost definovat plánů zálohování SAP HANA v řídícím SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="97b16-229">It shows the option to define SAP HANA backup schedules in SAP HANA Cockpit.</span></span> <span data-ttu-id="97b16-230">Jako jeden, můžete také zjistit, navrhuje datum a čas jako předpona pro záložní soubory.</span><span class="sxs-lookup"><span data-stu-id="97b16-230">As one can also see, it suggests date/time as a prefix for the backup files.</span></span> <span data-ttu-id="97b16-231">V nástroji SAP HANA Studio výchozí předpona je &quot;COMPLETE\_DATA\_zálohování&quot; při provádění úplnou zálohu souborů.</span><span class="sxs-lookup"><span data-stu-id="97b16-231">In SAP HANA Studio, the default prefix is &quot;COMPLETE\_DATA\_BACKUP&quot; when doing a full file backup.</span></span> <span data-ttu-id="97b16-232">Doporučuje se použít jedinečnou předponu.</span><span class="sxs-lookup"><span data-stu-id="97b16-232">Using a unique prefix is recommended.</span></span>

### <a name="sap-hana-backup-encryption"></a><span data-ttu-id="97b16-233">Zálohu šifrovacího SAP HANA</span><span class="sxs-lookup"><span data-stu-id="97b16-233">SAP HANA backup encryption</span></span>

<span data-ttu-id="97b16-234">SAP HANA nabízí šifrování dat a protokolu.</span><span class="sxs-lookup"><span data-stu-id="97b16-234">SAP HANA offers encryption of data and log.</span></span> <span data-ttu-id="97b16-235">Pokud nejsou šifrovaná data SAP HANA a protokolu, pak záloh nejsou šifrované.</span><span class="sxs-lookup"><span data-stu-id="97b16-235">If SAP HANA data and log are not encrypted, then the backups are also not encrypted.</span></span> <span data-ttu-id="97b16-236">Je na zákazníkovi, který chcete použít k šifrování záloh SAP HANA určitou formu řešení třetí strany.</span><span class="sxs-lookup"><span data-stu-id="97b16-236">It is up to the customer to use some form of third-party solution to encrypt the SAP HANA backups.</span></span> <span data-ttu-id="97b16-237">V tématu [dat a šifrování svazku protokolu](https://help.sap.com/saphelp_hanaplatform/helpdata/en/dc/01f36fbb5710148b668201a6e95cf2/content.htm) na další informace o šifrování SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="97b16-237">See [Data and Log Volume Encryption](https://help.sap.com/saphelp_hanaplatform/helpdata/en/dc/01f36fbb5710148b668201a6e95cf2/content.htm) to find out more about SAP HANA encryption.</span></span>

<span data-ttu-id="97b16-238">V Microsoft Azure může zákazník použít funkci šifrování virtuálních počítačů IaaS k šifrování.</span><span class="sxs-lookup"><span data-stu-id="97b16-238">On Microsoft Azure, a customer could use the IaaS VM encryption feature to encrypt.</span></span> <span data-ttu-id="97b16-239">Například jedna může použít vyhrazený datových disků připojených k virtuálnímu počítači, které se používají k ukládání záloh SAP HANA, ujistěte se, kopie těchto disků.</span><span class="sxs-lookup"><span data-stu-id="97b16-239">For example, one could use dedicated data disks attached to the VM, which are used to store SAP HANA backups, then make copies of these disks.</span></span>

<span data-ttu-id="97b16-240">Služba Azure Backup dokáže zpracovat šifrované virtuálních počítačů/disků (viz [šifrované zálohování a obnovení virtuálních počítačů s Azure Backup](../../../backup/backup-azure-vms-encryption.md)).</span><span class="sxs-lookup"><span data-stu-id="97b16-240">Azure Backup service can handle encrypted VMs/disks (see [How to back up and restore encrypted virtual machines with Azure Backup](../../../backup/backup-azure-vms-encryption.md)).</span></span>

<span data-ttu-id="97b16-241">Další možností by mohla být udržovat virtuální počítač SAP HANA a jeho disky bez šifrování a ukládání záložních souborů SAP HANA v účtu úložiště, pro které bylo povoleno šifrování (viz [šifrování služby úložiště Azure pro Data v klidovém stavu](../../../storage/common/storage-service-encryption.md)).</span><span class="sxs-lookup"><span data-stu-id="97b16-241">Another option would be to maintain the SAP HANA VM and its disks without encryption, and store the SAP HANA backup files in a storage account for which encryption was enabled (see [Azure Storage Service Encryption for Data at Rest](../../../storage/common/storage-service-encryption.md)).</span></span>

## <a name="test-setup"></a><span data-ttu-id="97b16-242">Nastavení testu</span><span class="sxs-lookup"><span data-stu-id="97b16-242">Test setup</span></span>

### <a name="test-virtual-machine-on-azure"></a><span data-ttu-id="97b16-243">Testovací virtuální počítač na platformě Azure</span><span class="sxs-lookup"><span data-stu-id="97b16-243">Test Virtual Machine on Azure</span></span>

<span data-ttu-id="97b16-244">Instalace SAP HANA virtuální počítač Azure GS5 byl použit pro následující testy zálohování nebo obnovení.</span><span class="sxs-lookup"><span data-stu-id="97b16-244">An SAP HANA installation in an Azure GS5 VM was used for the following backup/restore tests.</span></span>

![Následující obrázek ukazuje součástí Azure přehled portálu HANA testovací virtuální počítač](media/sap-hana-backup-guide/image007.png)

<span data-ttu-id="97b16-246">Následující obrázek ukazuje součástí Azure přehled portálu HANA testovací virtuální počítač.</span><span class="sxs-lookup"><span data-stu-id="97b16-246">This figure shows part of the Azure portal overview for the HANA test VM.</span></span>

### <a name="test-backup-size"></a><span data-ttu-id="97b16-247">Velikost zálohování testu</span><span class="sxs-lookup"><span data-stu-id="97b16-247">Test backup size</span></span>

![Tento obrázek byl odebrán z konzoly pro zálohování v HANA Studio a zobrazuje velikost záložní soubor 229 GB pro HANA index server](media/sap-hana-backup-guide/image008.png)

<span data-ttu-id="97b16-249">Fiktivní tabulka byla naplněna s daty se získat velikost celková data zálohování více než 200 GB odvození data realistické výkonu.</span><span class="sxs-lookup"><span data-stu-id="97b16-249">A dummy table was filled up with data to get a total data backup size of over 200 GB to derive realistic performance data.</span></span> <span data-ttu-id="97b16-250">Obrázek byl odebrán z konzoly pro zálohování v HANA Studio a zobrazí se záložní soubor velikost 229 GB pro HANA index server.</span><span class="sxs-lookup"><span data-stu-id="97b16-250">The figure was taken from the backup console in HANA Studio and shows the backup file size of 229 GB for the HANA index server.</span></span> <span data-ttu-id="97b16-251">Pro testy byl použit výchozí zálohování předponu "COMPLETE_DATA_BACKUP" v SAP HANA Studio.</span><span class="sxs-lookup"><span data-stu-id="97b16-251">For the tests, the default backup prefix "COMPLETE_DATA_BACKUP" in SAP HANA Studio was used.</span></span> <span data-ttu-id="97b16-252">V systémech skutečné produkční nesmí být definován užitečnější předpony.</span><span class="sxs-lookup"><span data-stu-id="97b16-252">In real production systems, a more useful prefix should be defined.</span></span> <span data-ttu-id="97b16-253">Řídící panel SAP HANA navrhuje datum a čas.</span><span class="sxs-lookup"><span data-stu-id="97b16-253">SAP HANA Cockpit suggests date/time.</span></span>

### <a name="test-tool-to-copy-files-directly-to-azure-storage"></a><span data-ttu-id="97b16-254">Testování nástroj pro kopírování souborů přímo do úložiště Azure</span><span class="sxs-lookup"><span data-stu-id="97b16-254">Test tool to copy files directly to Azure storage</span></span>

<span data-ttu-id="97b16-255">K přenosu SAP HANA záložní soubory přímo do úložiště objektů blob v Azure nebo sdílené složky Azure, byl nástroj blobxfer použít, protože podporuje obě cíle a lze ji snadno integrovat do skripty pro automatizaci z důvodu jeho rozhraní příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="97b16-255">To transfer SAP HANA backup files directly to Azure blob storage, or Azure file shares, the blobxfer tool was used because it supports both targets and it can be easily integrated into automation scripts due to its command-line interface.</span></span> <span data-ttu-id="97b16-256">Nástroj blobxfer je k dispozici na [Githubu](https://github.com/Azure/blobxfer).</span><span class="sxs-lookup"><span data-stu-id="97b16-256">The blobxfer tool is available on [GitHub](https://github.com/Azure/blobxfer).</span></span>

### <a name="test-backup-size-estimation"></a><span data-ttu-id="97b16-257">Odhad velikosti zálohy testu</span><span class="sxs-lookup"><span data-stu-id="97b16-257">Test backup size estimation</span></span>

<span data-ttu-id="97b16-258">Je důležité odhad zálohování velikost SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="97b16-258">It is important to estimate the backup size of SAP HANA.</span></span> <span data-ttu-id="97b16-259">Tento odhad pomáhá zlepšit výkon definováním záložní soubor maximální velikost pro počet záložních souborů z důvodu paralelismus během kopírování souboru.</span><span class="sxs-lookup"><span data-stu-id="97b16-259">This estimate helps to improve performance by defining the max backup file size for a number of backup files, due to parallelism during a file copy.</span></span> <span data-ttu-id="97b16-260">(Tyto informace jsou vysvětleny dále v tomto článku). Jeden musí také rozhodnout, zda chcete provést úplnou zálohu nebo rozdílové zálohy (přírůstkové nebo rozdílovou).</span><span class="sxs-lookup"><span data-stu-id="97b16-260">(Those details are explained later in this article.) One must also decide whether to do a full backup or a delta backup (incremental or differential).</span></span>

<span data-ttu-id="97b16-261">Naštěstí je jednoduchý příkaz SQL, který odhadne velikost záložní soubory: **vyberte \* z M\_zálohování\_velikost\_odhady** (najdete v části [při odhadu v systému souborů pro zálohování dat](https://help.sap.com/saphelp_hanaplatform/helpdata/en/7d/46337b7a9c4c708d965b65bc0f343c/content.htm)).</span><span class="sxs-lookup"><span data-stu-id="97b16-261">Fortunately, there is a simple SQL statement that estimates the size of the backup files: **select \* from M\_BACKUP\_SIZE\_ESTIMATIONS** (see [Estimate the Space Needed in the File System for a Data Backup](https://help.sap.com/saphelp_hanaplatform/helpdata/en/7d/46337b7a9c4c708d965b65bc0f343c/content.htm)).</span></span>

![Výstup tohoto příkazu SQL odpovídá téměř úplně stejné skutečná velikost úplná záloha na disku](media/sap-hana-backup-guide/image009.png)

<span data-ttu-id="97b16-263">Výstup tohoto příkazu SQL pro testovací systém odpovídá téměř úplně stejné skutečná velikost úplná záloha na disku.</span><span class="sxs-lookup"><span data-stu-id="97b16-263">For the test system, the output of this SQL statement matches almost exactly the real size of the full data backup on disk.</span></span>

### <a name="test-hana-backup-file-size"></a><span data-ttu-id="97b16-264">Test HANA záložní soubor velikost</span><span class="sxs-lookup"><span data-stu-id="97b16-264">Test HANA backup file size</span></span>

![Konzole zálohování HANA Studio umožňuje jednu pro omezení maximální velikost HANA záložní soubory](media/sap-hana-backup-guide/image010.png)

<span data-ttu-id="97b16-266">Konzole zálohování HANA Studio umožňuje jednu pro omezení maximální velikost HANA záložní soubory.</span><span class="sxs-lookup"><span data-stu-id="97b16-266">The HANA Studio backup console allows one to restrict the max file size of HANA backup files.</span></span> <span data-ttu-id="97b16-267">V ukázkové prostředí tato funkce umožňuje získat několik menších souborů zálohování místo jeden záložní soubor 230 GB.</span><span class="sxs-lookup"><span data-stu-id="97b16-267">In the sample environment, that feature makes it possible to get multiple smaller backup files instead of one 230-GB backup file.</span></span> <span data-ttu-id="97b16-268">Menší velikost souborů má významný dopad na výkon (najdete v souvisejícím článku [SAP HANA Azure Backup na úrovni souborů](sap-hana-backup-file-level.md)).</span><span class="sxs-lookup"><span data-stu-id="97b16-268">Smaller file size has a significant impact on performance (see the related article [SAP HANA Azure Backup on file level](sap-hana-backup-file-level.md)).</span></span>

## <a name="summary"></a><span data-ttu-id="97b16-269">Souhrn</span><span class="sxs-lookup"><span data-stu-id="97b16-269">Summary</span></span>

<span data-ttu-id="97b16-270">Založené na výsledky testů, které následující tabulky popisují výhody a nevýhody řešení pro zálohování databáze SAP HANA běžících na virtuálních počítačích Azure.</span><span class="sxs-lookup"><span data-stu-id="97b16-270">Based on the test results the following tables show pros and cons of solutions to back up an SAP HANA database running on Azure virtual machines.</span></span>

<span data-ttu-id="97b16-271">**Zálohování SAP HANA do systému souborů a pak zkopírujte záložní soubory do konečného umístění zálohování**</span><span class="sxs-lookup"><span data-stu-id="97b16-271">**Back up SAP HANA to the file system and copy backup files afterwards to the final backup destination**</span></span>

|<span data-ttu-id="97b16-272">Řešení</span><span class="sxs-lookup"><span data-stu-id="97b16-272">Solution</span></span>                                           |<span data-ttu-id="97b16-273">Odborníci na</span><span class="sxs-lookup"><span data-stu-id="97b16-273">Pros</span></span>                                 |<span data-ttu-id="97b16-274">Nevýhody</span><span class="sxs-lookup"><span data-stu-id="97b16-274">Cons</span></span>                                  |
|---------------------------------------------------|-------------------------------------|--------------------------------------|
|<span data-ttu-id="97b16-275">Zachovat HANA zálohování na disky virtuálních počítačů</span><span class="sxs-lookup"><span data-stu-id="97b16-275">Keep HANA backups on VM disks</span></span>                      |<span data-ttu-id="97b16-276">Žádné další správu úsilí</span><span class="sxs-lookup"><span data-stu-id="97b16-276">No additional management efforts</span></span>     |<span data-ttu-id="97b16-277">Eats místní místa na disku virtuálního počítače</span><span class="sxs-lookup"><span data-stu-id="97b16-277">Eats up local VM disk space</span></span>           |
|<span data-ttu-id="97b16-278">Blobxfer nástroj a zkopírujte záložní soubory do úložiště objektů blob</span><span class="sxs-lookup"><span data-stu-id="97b16-278">Blobxfer tool to copy backup files to blob storage</span></span> |<span data-ttu-id="97b16-279">Paralelismus chcete zkopírovat soubory, možnost použití úložiště na studených objektů blob</span><span class="sxs-lookup"><span data-stu-id="97b16-279">Parallelism to copy multiple files, choice to use cool blob storage</span></span> | <span data-ttu-id="97b16-280">Další nástroje údržby a vlastní skriptování</span><span class="sxs-lookup"><span data-stu-id="97b16-280">Additional tool maintenance and custom scripting</span></span> | 
|<span data-ttu-id="97b16-281">Kopírování objektu BLOB prostřednictvím prostředí Powershell nebo rozhraní příkazového řádku</span><span class="sxs-lookup"><span data-stu-id="97b16-281">Blob copy via Powershell or CLI</span></span>                    |<span data-ttu-id="97b16-282">Žádné další nástroje, které jsou nezbytné, můžete nakonfigurovat pomocí prostředí Azure Powershell nebo rozhraní příkazového řádku</span><span class="sxs-lookup"><span data-stu-id="97b16-282">No additional tool necessary, can be accomplished via Azure Powershell or CLI</span></span> |<span data-ttu-id="97b16-283">Proces ručního nastavení, zákazník musí postará o skriptování a správu zkopírovaných objektů blob pro obnovení</span><span class="sxs-lookup"><span data-stu-id="97b16-283">manual process, customer has to take care of scripting and management of copied blobs for restore</span></span>|
|<span data-ttu-id="97b16-284">Zkopírujte do sdílené složky NFS</span><span class="sxs-lookup"><span data-stu-id="97b16-284">Copy to NFS share</span></span>                                  |<span data-ttu-id="97b16-285">Po zpracování záložní soubory na jiných virtuálních počítačů bez dopadu na serveru HANA</span><span class="sxs-lookup"><span data-stu-id="97b16-285">Post-processing of backup files on other VM without impact on the HANA server</span></span>|<span data-ttu-id="97b16-286">Kopírování pomalé</span><span class="sxs-lookup"><span data-stu-id="97b16-286">Slow copy process</span></span>|
|<span data-ttu-id="97b16-287">Blobxfer kopírovat do služby Azure souborů</span><span class="sxs-lookup"><span data-stu-id="97b16-287">Blobxfer copy to Azure File Service</span></span>                |<span data-ttu-id="97b16-288">Nebude vyžadovat značné množství místa na místní disky virtuálních počítačů</span><span class="sxs-lookup"><span data-stu-id="97b16-288">Doesn't eat up space on local VM disks</span></span>|<span data-ttu-id="97b16-289">Žádné přímé zápisu podporu omezením HANA zálohování, velikost sdílené složky aktuálně na 5 TB</span><span class="sxs-lookup"><span data-stu-id="97b16-289">No direct write support by HANA backup, size restriction of file share currently at 5 TB</span></span>|
|<span data-ttu-id="97b16-290">Azure Backup Agent</span><span class="sxs-lookup"><span data-stu-id="97b16-290">Azure Backup Agent</span></span>                                 | <span data-ttu-id="97b16-291">Bude upřednostňované řešení</span><span class="sxs-lookup"><span data-stu-id="97b16-291">Would be preferred solution</span></span>         | <span data-ttu-id="97b16-292">Momentálně není k dispozici v systému Linux</span><span class="sxs-lookup"><span data-stu-id="97b16-292">Currently not available on Linux</span></span>    |



<span data-ttu-id="97b16-293">**Zálohování SAP HANA podle úložiště snímků**</span><span class="sxs-lookup"><span data-stu-id="97b16-293">**Backup SAP HANA based on storage snapshots**</span></span>

|<span data-ttu-id="97b16-294">Řešení</span><span class="sxs-lookup"><span data-stu-id="97b16-294">Solution</span></span>                                           |<span data-ttu-id="97b16-295">Odborníci na</span><span class="sxs-lookup"><span data-stu-id="97b16-295">Pros</span></span>                                 |<span data-ttu-id="97b16-296">Nevýhody</span><span class="sxs-lookup"><span data-stu-id="97b16-296">Cons</span></span>                                  |
|---------------------------------------------------|-------------------------------------|--------------------------------------|
|<span data-ttu-id="97b16-297">Služby zálohování Azure</span><span class="sxs-lookup"><span data-stu-id="97b16-297">Azure Backup Service</span></span>                               | <span data-ttu-id="97b16-298">Umožňuje zálohování virtuálních počítačů podle snímky objektů blob</span><span class="sxs-lookup"><span data-stu-id="97b16-298">Allows VM backup based on blob snapshots</span></span> | <span data-ttu-id="97b16-299">Pokud nepoužíváte obnovení na úrovni souborů, vyžaduje vytvoření nového virtuálního počítače pro obnovení procesu, který pak znamená potřeba nový licenční klíč SAP HANA</span><span class="sxs-lookup"><span data-stu-id="97b16-299">When not using file level restore, it requires the creation of a new VM for the restore process, which then implies the need of a new SAP HANA license key</span></span>|
|<span data-ttu-id="97b16-300">Snímky ruční objektů blob</span><span class="sxs-lookup"><span data-stu-id="97b16-300">Manual blob snapshots</span></span>                              | <span data-ttu-id="97b16-301">Flexibilita pro vytvoření a obnovení konkrétní disky virtuálních počítačů, aniž byste museli měnit jedinečné ID virtuálního počítače</span><span class="sxs-lookup"><span data-stu-id="97b16-301">Flexibility to create and restore specific VM disks without changing the unique VM ID</span></span>|<span data-ttu-id="97b16-302">Všechny ručního nastavení, které je nutné provést zákazníkem</span><span class="sxs-lookup"><span data-stu-id="97b16-302">All manual work, which has to be done by the customer</span></span>|

## <a name="next-steps"></a><span data-ttu-id="97b16-303">Další kroky</span><span class="sxs-lookup"><span data-stu-id="97b16-303">Next steps</span></span>
* <span data-ttu-id="97b16-304">[SAP HANA Azure Backup na úrovni souborů](sap-hana-backup-file-level.md) popisuje možnost zálohování na základě souborů.</span><span class="sxs-lookup"><span data-stu-id="97b16-304">[SAP HANA Azure Backup on file level](sap-hana-backup-file-level.md) describes the file-based backup option.</span></span>
* <span data-ttu-id="97b16-305">[SAP HANA zálohování podle úložiště snímků](sap-hana-backup-storage-snapshots.md) popisuje zálohování možnosti založené na snímku úložiště.</span><span class="sxs-lookup"><span data-stu-id="97b16-305">[SAP HANA backup based on storage snapshots](sap-hana-backup-storage-snapshots.md) describes the storage snapshot-based backup option.</span></span>
* <span data-ttu-id="97b16-306">Další informace o vytvoření vysoké dostupnosti a plán pro zotavení po havárii SAP HANA v Azure (velké instance) naleznete v tématu [SAP HANA (velké instance) vysoké dostupnosti a zotavení po havárii v Azure](hana-overview-high-availability-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="97b16-306">To learn how to establish high availability and plan for disaster recovery of SAP HANA on Azure (large instances), see [SAP HANA (large instances) high availability and disaster recovery on Azure](hana-overview-high-availability-disaster-recovery.md).</span></span>
