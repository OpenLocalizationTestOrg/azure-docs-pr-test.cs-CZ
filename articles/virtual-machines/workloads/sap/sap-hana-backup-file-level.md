---
title: "aaaSAP HANA Azure Backup na úrovni souborů | Microsoft Docs"
description: "Existují dvě hlavní zálohování možnosti pro SAP HANA na virtuálních počítačích Azure, tento článek se zabývá SAP HANA Azure Backup na úrovni souborů"
services: virtual-machines-linux
documentationcenter: 
author: hermanndms
manager: timlt
editor: 
ms.service: virtual-machines-linux
ms.devlang: NA
ms.topic: article
ums.tgt_pltfrm: vm-linux
ms.workload: infrastructure-services
ms.date: 3/13/2017
ms.author: rclaus
ms.openlocfilehash: d5a55de5634ac7724e7fd0fa3760c6c408c3db74
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="sap-hana-azure-backup-on-file-level"></a><span data-ttu-id="2441d-103">SAP HANA Azure Backup na úrovni souborů</span><span class="sxs-lookup"><span data-stu-id="2441d-103">SAP HANA Azure Backup on file level</span></span>

## <a name="introduction"></a><span data-ttu-id="2441d-104">Úvod</span><span class="sxs-lookup"><span data-stu-id="2441d-104">Introduction</span></span>

<span data-ttu-id="2441d-105">Toto je část třemi částmi řady související články v záloze SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="2441d-105">This is part of a three-part series of related articles on SAP HANA backup.</span></span> <span data-ttu-id="2441d-106">[Příručce zálohování pro SAP HANA ve virtuálních počítačích Azure](./sap-hana-backup-guide.md) poskytuje přehled a informace o začátcích, a [SAP HANA zálohování podle úložiště snímků](./sap-hana-backup-storage-snapshots.md) zahrnuje hello možnost zálohování na základě snímku úložiště.</span><span class="sxs-lookup"><span data-stu-id="2441d-106">[Backup guide for SAP HANA on Azure Virtual Machines](./sap-hana-backup-guide.md) provides an overview and information on getting started, and [SAP HANA backup based on storage snapshots](./sap-hana-backup-storage-snapshots.md) covers hello storage snapshot-based backup option.</span></span>

<span data-ttu-id="2441d-107">Prohlížení hello velikosti virtuálního počítače Azure, jeden můžete vidět, že GS5 umožňuje 64 disků připojených datových.</span><span class="sxs-lookup"><span data-stu-id="2441d-107">Looking at hello Azure VM sizes, one can see that a GS5 allows 64 attached data disks.</span></span> <span data-ttu-id="2441d-108">U systémů SAP HANA může být velký počet disků už používá pro data a soubory protokolu, které by mohly mít v kombinaci s softwaru diskového pole RAID pro optimální disk propustnost vstupně-výstupní operace.</span><span class="sxs-lookup"><span data-stu-id="2441d-108">For large SAP HANA systems, a significant number of disks might already be taken for data and log files, possibly in combination with software RAID for optimal disk IO throughput.</span></span> <span data-ttu-id="2441d-109">potom otázku Hello je, kde toostore SAP HANA zálohovat soubory, které může zaplnit data hello připojené disky v čase?</span><span class="sxs-lookup"><span data-stu-id="2441d-109">hello question then is where toostore SAP HANA backup files, which could fill up hello attached data disks over time?</span></span> <span data-ttu-id="2441d-110">V tématu [velikostí pro virtuální počítače s Linuxem v Azure](../../linux/sizes.md) pro tabulky velikost virtuálního počítače Azure hello.</span><span class="sxs-lookup"><span data-stu-id="2441d-110">See [Sizes for Linux virtual machines in Azure](../../linux/sizes.md) for hello Azure VM size tables.</span></span>

<span data-ttu-id="2441d-111">V tuto chvíli není k dispozici u služby zálohování Azure bez integrace zálohování SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="2441d-111">There is no SAP HANA backup integration available with Azure Backup service at this time.</span></span> <span data-ttu-id="2441d-112">standardní způsob Hello toomanage zálohování a obnovení na úrovni souborů hello je s zálohu na základě souborů prostřednictvím SAP HANA Studio nebo pomocí příkazů SAP HANA SQL.</span><span class="sxs-lookup"><span data-stu-id="2441d-112">hello standard way toomanage backup/restore at hello file level is with a file-based backup via SAP HANA Studio or via SAP HANA SQL statements.</span></span> <span data-ttu-id="2441d-113">V tématu [SAP HANA SQL a Reference zobrazení systému](https://help.sap.com/hana/SAP_HANA_SQL_and_System_Views_Reference_en.pdf) Další informace.</span><span class="sxs-lookup"><span data-stu-id="2441d-113">See [SAP HANA SQL and System Views Reference](https://help.sap.com/hana/SAP_HANA_SQL_and_System_Views_Reference_en.pdf) for more information.</span></span>

![Na tomto obrázku je dialogové okno hello hello zálohování nabídky položky v SAP HANA Studio](media/sap-hana-backup-file-level/image022.png)

<span data-ttu-id="2441d-115">Na tomto obrázku zobrazí dialog hello hello zálohování nabídky položky v sadě SAP HANA Studio.</span><span class="sxs-lookup"><span data-stu-id="2441d-115">This figure shows hello dialog of hello backup menu item in SAP HANA Studio.</span></span> <span data-ttu-id="2441d-116">Při výběru typu &quot;souboru&quot; jeden toospecify má cestu v systému souborů hello kde SAP HANA zapíše hello záložní soubory.</span><span class="sxs-lookup"><span data-stu-id="2441d-116">When choosing type &quot;file,&quot; one has toospecify a path in hello file system where SAP HANA writes hello backup files.</span></span> <span data-ttu-id="2441d-117">Obnovení funguje hello stejným způsobem.</span><span class="sxs-lookup"><span data-stu-id="2441d-117">Restore works hello same way.</span></span>

<span data-ttu-id="2441d-118">Když tato volba vyznívá jednoduché a rovnou předat dál, existují některé aspekty.</span><span class="sxs-lookup"><span data-stu-id="2441d-118">While this choice sounds simple and straight forward, there are some considerations.</span></span> <span data-ttu-id="2441d-119">Jak je uvedeno nahoře, virtuální počítač Azure má omezenou na počet datových disků, které je možné připojit.</span><span class="sxs-lookup"><span data-stu-id="2441d-119">As mentioned before, an Azure VM has a limitation of number of data disks that can be attached.</span></span> <span data-ttu-id="2441d-120">Nemusí být kapacity toostore SAP HANA záložní soubory v systémech souborů hello hello virtuálních počítačů, v závislosti na velikosti hello hello databázi a disk propustnost požadavků, které mohou zahrnovat softwaru RAID pomocí prokládání napříč více dat disky.</span><span class="sxs-lookup"><span data-stu-id="2441d-120">There might not be capacity toostore SAP HANA backup files on hello file systems of hello VM, depending on hello size of hello database and disk throughput requirements, which might involve software RAID using striping across multiple data disks.</span></span> <span data-ttu-id="2441d-121">Různé možnosti pro přesunutí těchto záložních souborů a správu omezení velikosti souborů a výkon při zpracování terabajtů dat, jsou uvedeny dále v tomto článku.</span><span class="sxs-lookup"><span data-stu-id="2441d-121">Various options for moving these backup files, and managing file size restrictions and performance when handling terabytes of data, are provided later in this article.</span></span>

<span data-ttu-id="2441d-122">Další možnost, která nabízí dává větší svobodu týkající se celkové kapacity, je úložiště objektů blob Azure.</span><span class="sxs-lookup"><span data-stu-id="2441d-122">Another option, which offers more freedom regarding total capacity, is Azure blob storage.</span></span> <span data-ttu-id="2441d-123">Při jediného objektu blob se také s omezeným přístupem too1 TB celkové kapacity hello jediného objektu blob kontejneru je aktuálně 500 TB.</span><span class="sxs-lookup"><span data-stu-id="2441d-123">While a single blob is also restricted too1 TB, hello total capacity of a single blob container is currently 500 TB.</span></span> <span data-ttu-id="2441d-124">Kromě toho nabízí zákazníkům hello choice tooselect takzvané &quot;nástrojů&quot; úložiště objektů blob, který má výhody náklady.</span><span class="sxs-lookup"><span data-stu-id="2441d-124">Additionally, it gives customers hello choice tooselect so-called &quot;cool&quot; blob storage, which has a cost benefit.</span></span> <span data-ttu-id="2441d-125">V tématu [Azure Blob Storage: za provozu a cool vrstvy úložiště](../../../storage/blobs/storage-blob-storage-tiers.md) podrobnosti o úložiště na studených objektů blob.</span><span class="sxs-lookup"><span data-stu-id="2441d-125">See [Azure Blob Storage: Hot and cool storage tiers](../../../storage/blobs/storage-blob-storage-tiers.md) for details about cool blob storage.</span></span>

<span data-ttu-id="2441d-126">Pro dodatečné zabezpečení použijte zálohy geograficky replikované úložiště účet toostore hello SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="2441d-126">For additional safety, use a geo-replicated storage account toostore hello SAP HANA backups.</span></span> <span data-ttu-id="2441d-127">V tématu [replikace Azure Storage](../../../storage/common/storage-redundancy.md) podrobnosti o replikaci účet úložiště.</span><span class="sxs-lookup"><span data-stu-id="2441d-127">See [Azure Storage replication](../../../storage/common/storage-redundancy.md) for details about storage account replication.</span></span>

<span data-ttu-id="2441d-128">V účtu vyhrazeného zálohování úložiště, který je geograficky replikované jeden by mohlo způsobit vyhrazené virtuální pevné disky pro SAP HANA zálohy.</span><span class="sxs-lookup"><span data-stu-id="2441d-128">One could place dedicated VHDs for SAP HANA backups in a dedicated backup storage account that is geo-replicated.</span></span> <span data-ttu-id="2441d-129">Jinak jeden zkopírovat hello virtuální pevné disky, které udržují hello SAP HANA zálohy tooa geograficky replikované úložiště účet nebo účet tooa úložiště, který je v jiné oblasti.</span><span class="sxs-lookup"><span data-stu-id="2441d-129">Or else one could copy hello VHDs that keep hello SAP HANA backups tooa geo-replicated storage account, or tooa storage account that is in a different region.</span></span>

## <a name="azure-backup-agent"></a><span data-ttu-id="2441d-130">Azure backup agent</span><span class="sxs-lookup"><span data-stu-id="2441d-130">Azure backup agent</span></span>

<span data-ttu-id="2441d-131">Azure backup nabízí hello možnost toonot zálohovat pouze kompletní virtuální počítače, ale také soubory a adresáře prostřednictvím hello zálohování agenta, který má toobe nainstalovaná na hello hostovaný operační systém.</span><span class="sxs-lookup"><span data-stu-id="2441d-131">Azure backup offers hello option toonot only back up complete VMs, but also files and directories via hello backup agent, which has toobe installed on hello guest OS.</span></span> <span data-ttu-id="2441d-132">Ale od prosince 2016 tohoto agenta je podporována pouze v systému Windows (viz [zálohování Windows serveru nebo klienta tooAzure pomocí modelu nasazení Resource Manager hello](../../../backup/backup-configure-vault.md)).</span><span class="sxs-lookup"><span data-stu-id="2441d-132">But as of December 2016, this agent is only supported on Windows (see [Back up a Windows Server or client tooAzure using hello Resource Manager deployment model](../../../backup/backup-configure-vault.md)).</span></span>

<span data-ttu-id="2441d-133">Alternativní řešení je toofirst kopie SAP HANA tooa záložní soubory virtuálního počítače s Windows v Azure (například prostřednictvím SAMBA sdílení) a potom pomocí hello Azure backup agent z ní.</span><span class="sxs-lookup"><span data-stu-id="2441d-133">A workaround is toofirst copy SAP HANA backup files tooa Windows VM on Azure (for example, via SAMBA share) and then use hello Azure backup agent from there.</span></span> <span data-ttu-id="2441d-134">I když je technicky možné, ho by přidání složitosti a zpomalit hello zálohování nebo obnovení z odlišují důvodu toohello kopírování mezi hello Linux a hello virtuální počítač s Windows.</span><span class="sxs-lookup"><span data-stu-id="2441d-134">While it is technically possible, it would add complexity and slow down hello backup or restore process quite a bit due toohello copy between hello Linux and hello Windows VM.</span></span> <span data-ttu-id="2441d-135">Není doporučeno toofollow tento přístup.</span><span class="sxs-lookup"><span data-stu-id="2441d-135">It is not recommended toofollow this approach.</span></span>

## <a name="azure-blobxfer-utility-details"></a><span data-ttu-id="2441d-136">Podrobnosti nástroj Azure blobxfer</span><span class="sxs-lookup"><span data-stu-id="2441d-136">Azure blobxfer utility details</span></span>

<span data-ttu-id="2441d-137">toostore adresářů a souborů na úložiště Azure, jeden může pomocí rozhraní CLI nebo Powershellu, nebo vytvořte nástroj, pomocí jedné z hello [sady Azure SDK](https://azure.microsoft.com/downloads/).</span><span class="sxs-lookup"><span data-stu-id="2441d-137">toostore directories and files on Azure storage, one could use CLI or PowerShell, or develop a tool using one of hello [Azure SDKs](https://azure.microsoft.com/downloads/).</span></span> <span data-ttu-id="2441d-138">Pro kopírování tooAzure úložiště dat je také nástroj připravené k použití, AzCopy, ale je Windows jenom (viz [přenos dat pomocí hello nástroj příkazového řádku AzCopy](../../../storage/common/storage-use-azcopy.md)).</span><span class="sxs-lookup"><span data-stu-id="2441d-138">There is also a ready-to-use utility, AzCopy, for copying data tooAzure storage, but it is Windows only (see [Transfer data with hello AzCopy Command-Line Utility](../../../storage/common/storage-use-azcopy.md)).</span></span>

<span data-ttu-id="2441d-139">Proto blobxfer byl použit pro kopírování SAP HANA záložní soubory.</span><span class="sxs-lookup"><span data-stu-id="2441d-139">Therefore blobxfer was used for copying SAP HANA backup files.</span></span> <span data-ttu-id="2441d-140">Je open source mnoho zákazníků v produkčním prostředí, dostupná a použitá na [Githubu](https://github.com/Azure/blobxfer).</span><span class="sxs-lookup"><span data-stu-id="2441d-140">It is open source, used by many customers in production environments, and available on [GitHub](https://github.com/Azure/blobxfer).</span></span> <span data-ttu-id="2441d-141">Tento nástroj umožňuje jeden datový toocopy přímo tooeither Azure blob storage nebo sdílenou složku Azure.</span><span class="sxs-lookup"><span data-stu-id="2441d-141">This tool allows one toocopy data directly tooeither Azure blob storage or Azure file share.</span></span> <span data-ttu-id="2441d-142">Také nabízí celou řadu užitečných funkcí, jako je hodnota hash md5 nebo automatické paralelismus při kopírování adresáře s více soubory.</span><span class="sxs-lookup"><span data-stu-id="2441d-142">It also offers a range of useful features, like md5 hash or automatic parallelism when copying a directory with multiple files.</span></span>

## <a name="sap-hana-backup-performance"></a><span data-ttu-id="2441d-143">Výkon zálohování SAP HANA</span><span class="sxs-lookup"><span data-stu-id="2441d-143">SAP HANA backup performance</span></span>

![Je tento snímek hello SAP HANA zálohování konzoly v SAP HANA Studio](media/sap-hana-backup-file-level/image023.png)

<span data-ttu-id="2441d-145">Tomto snímku obrazovky je hello SAP HANA zálohování konzoly v SAP HANA Studio.</span><span class="sxs-lookup"><span data-stu-id="2441d-145">This screenshot is of hello SAP HANA backup console in SAP HANA Studio.</span></span> <span data-ttu-id="2441d-146">Trvalo asi 42 minut toodo hello zálohování z hello 230 GB na disku jednoho Azure standardní úložiště připojené toohello HANA počítač používající systém souborů XFS.</span><span class="sxs-lookup"><span data-stu-id="2441d-146">It took about 42 minutes toodo hello backup of hello 230 GB on a single Azure standard storage disk attached toohello HANA VM using XFS file system.</span></span>

![Tomto snímku obrazovky je YaST na hello SAP HANA testovacího virtuálního počítače](media/sap-hana-backup-file-level/image024.png)

<span data-ttu-id="2441d-148">Tomto snímku obrazovky je YaST na hello SAP HANA testovacího virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="2441d-148">This screenshot is of YaST on hello SAP HANA test VM.</span></span> <span data-ttu-id="2441d-149">Hello 1 TB jednoho disku pro zálohu SAP HANA jeden můžete vidět, jak je uvedeno nahoře.</span><span class="sxs-lookup"><span data-stu-id="2441d-149">One can see hello 1-TB single disk for SAP HANA backup as mentioned before.</span></span> <span data-ttu-id="2441d-150">Trvalo asi 42 minut toobackup 230 GB.</span><span class="sxs-lookup"><span data-stu-id="2441d-150">It took about 42 minutes toobackup 230 GB.</span></span> <span data-ttu-id="2441d-151">Kromě toho byla připojena pět disků 200 GB a vytvořit md0 softwaru diskového pole RAID, s proložení na základě těchto pět disků dat Azure.</span><span class="sxs-lookup"><span data-stu-id="2441d-151">In addition, five 200-GB disks were attached and software RAID md0 created, with striping on top of these five Azure data disks.</span></span>

![Opakující se hello stejné zálohování na softwaru diskového pole RAID s proložení mezi pěti připojenými disky dat úložiště Azure úrovně standard](media/sap-hana-backup-file-level/image025.png)

<span data-ttu-id="2441d-153">Stejné zálohování na softwaru diskového pole RAID s proložení mezi pěti opakovaných hello připojit čas zálohování disky uvést do režimu hello dat pro úložiště Azure standardní 42 minut dolů too10 minut.</span><span class="sxs-lookup"><span data-stu-id="2441d-153">Repeating hello same backup on software RAID with striping across five attached Azure standard storage data disks brought hello backup time from 42 minutes down too10 minutes.</span></span> <span data-ttu-id="2441d-154">bez ukládání do mezipaměti toohello virtuálního počítače byly připojené disky Hello.</span><span class="sxs-lookup"><span data-stu-id="2441d-154">hello disks were attached without caching toohello VM.</span></span> <span data-ttu-id="2441d-155">Proto je zřejmé jak důležité rychlost zapisování na disk je pro hello čas zálohování.</span><span class="sxs-lookup"><span data-stu-id="2441d-155">So it is obvious how important disk write throughput is for hello backup time.</span></span> <span data-ttu-id="2441d-156">Jeden může pak přepínače tooAzure premium storage toofurther urychlit proces hello k zajištění optimálního výkonu.</span><span class="sxs-lookup"><span data-stu-id="2441d-156">One could then switch tooAzure premium storage toofurther accelerate hello process for optimal performance.</span></span> <span data-ttu-id="2441d-157">Obecně platí Azure premium storage je třeba použít pro produkční systémy.</span><span class="sxs-lookup"><span data-stu-id="2441d-157">In general, Azure premium storage should be used for production systems.</span></span>

## <a name="copy-sap-hana-backup-files-tooazure-blob-storage"></a><span data-ttu-id="2441d-158">Zkopírujte úložiště objektů blob tooAzure záložní soubory SAP HANA</span><span class="sxs-lookup"><span data-stu-id="2441d-158">Copy SAP HANA backup files tooAzure blob storage</span></span>

<span data-ttu-id="2441d-159">Prosinec 2016 hello nejlépe je možnost tooquickly úložiště SAP HANA záložní soubory úložiště objektů blob Azure.</span><span class="sxs-lookup"><span data-stu-id="2441d-159">As of December 2016, hello best option tooquickly store SAP HANA backup files is Azure blob storage.</span></span> <span data-ttu-id="2441d-160">Jednoho kontejneru typu jediného objektu blob může obsahovat maximálně 500 TB, dostatek většina systémů SAP HANA spuštěné ve virtuálním počítači GS5 v Azure, tookeep dostatečná SAP HANA zálohy.</span><span class="sxs-lookup"><span data-stu-id="2441d-160">One single blob container has a limit of 500 TB, enough for most SAP HANA systems, running in a GS5 VM on Azure, tookeep sufficient SAP HANA backups.</span></span> <span data-ttu-id="2441d-161">Zákazníci mají hello volba mezi &quot;aktivní&quot; a &quot;studenou&quot; úložiště objektů blob (najdete v části [Azure Blob Storage: za provozu a cool vrstvy úložiště](../../../storage/blobs/storage-blob-storage-tiers.md)).</span><span class="sxs-lookup"><span data-stu-id="2441d-161">Customers have hello choice between &quot;hot&quot; and &quot;cold&quot; blob storage (see [Azure Blob Storage: Hot and cool storage tiers](../../../storage/blobs/storage-blob-storage-tiers.md)).</span></span>

<span data-ttu-id="2441d-162">S nástrojem blobxfer hello je snadno toocopy hello SAP HANA záložní soubory přímo tooAzure úložiště objektů blob.</span><span class="sxs-lookup"><span data-stu-id="2441d-162">With hello blobxfer tool, it is easy toocopy hello SAP HANA backup files directly tooAzure blob storage.</span></span>

![Zde jeden uvidí hello soubory úplného zálohování souboru SAP HANA](media/sap-hana-backup-file-level/image026.png)

<span data-ttu-id="2441d-164">Zde jeden můžete zobrazit soubory hello úplného zálohování souboru SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="2441d-164">Here one can see hello files of a full SAP HANA file backup.</span></span> <span data-ttu-id="2441d-165">Existují čtyři soubory a hello největších jeden má zhruba 230 GB.</span><span class="sxs-lookup"><span data-stu-id="2441d-165">There are four files and hello biggest one has roughly 230 GB.</span></span>

![Trvalo zhruba 3000 sekund kontejner objektů blob účet tooan toocopy hello 230 GB úložiště Azure úrovně standard](media/sap-hana-backup-file-level/image027.png)

<span data-ttu-id="2441d-167">V počátečním testu hello nepoužíváte hodnota hash md5, trvalo zhruba 3000 sekund kontejner objektů blob účet tooan toocopy hello 230 GB úložiště Azure úrovně standard.</span><span class="sxs-lookup"><span data-stu-id="2441d-167">Not using md5 hash in hello initial test, it took roughly 3000 seconds toocopy hello 230 GB tooan Azure standard storage account blob container.</span></span>

![Na tomto snímku obrazovky jeden viděli, jak vypadá na hello portálu Azure](media/sap-hana-backup-file-level/image028.png)

<span data-ttu-id="2441d-169">Na tomto snímku obrazovky jeden můžete zobrazit, jak vypadá na hello portálu Azure.</span><span class="sxs-lookup"><span data-stu-id="2441d-169">In this screenshot, one can see how it looks on hello Azure portal.</span></span> <span data-ttu-id="2441d-170">Kontejner objektů blob s názvem &quot;sap hana zálohování&quot; byl vytvořen a zahrnuje hello čtyři objekty BLOB, které představují hello SAP HANA záložní soubory.</span><span class="sxs-lookup"><span data-stu-id="2441d-170">A blob container named &quot;sap-hana-backups&quot; was created and includes hello four blobs, which represent hello SAP HANA backup files.</span></span> <span data-ttu-id="2441d-171">Jeden z nich má velikost přibližně 230 GB.</span><span class="sxs-lookup"><span data-stu-id="2441d-171">One of them has a size of roughly 230 GB.</span></span>

<span data-ttu-id="2441d-172">zálohování konzoly Hello HANA Studio umožňuje jeden toorestrict hello maximální velikost souboru HANA záložní soubory.</span><span class="sxs-lookup"><span data-stu-id="2441d-172">hello HANA Studio backup console allows one toorestrict hello max file size of HANA backup files.</span></span> <span data-ttu-id="2441d-173">V prostředí ukázkový text hello zvýšení výkonu tím, že ji možné toohave více menší záložní soubory místo jednoho velkého souboru 230 GB.</span><span class="sxs-lookup"><span data-stu-id="2441d-173">In hello sample environment, it improved performance by making it possible toohave multiple smaller backup files, instead of one large 230-GB file.</span></span>

![Nastavení omezení velikosti záložní soubor hello hello HANA straně nemá & č. 39; t zlepšit čas zálohování hello](media/sap-hana-backup-file-level/image029.png)

<span data-ttu-id="2441d-175">Nastavení omezení velikosti záložní soubor hello hello HANA straně nemá & č. 39; t zlepšit hello čas zálohování, protože hello soubory jsou zapsány postupně, jak je vidět na tomto obrázku.</span><span class="sxs-lookup"><span data-stu-id="2441d-175">Setting hello backup file size limit on hello HANA side doesn&#39;t improve hello backup time, because hello files are written sequentially as shown in this figure.</span></span> <span data-ttu-id="2441d-176">limit velikosti souborů Hello byl nastaven too60 GB, tak hello záloha byla vytvořena čtyři velké datové soubory místo hello 230 GB jedním souborem.</span><span class="sxs-lookup"><span data-stu-id="2441d-176">hello file size limit was set too60 GB, so hello backup created four large data files instead of hello 230-GB single file.</span></span>

![tootest paralelismu hello blobxfer nástroje, hello maximální velikost souboru pro HANA zálohy se potom nastavte too15 GB](media/sap-hana-backup-file-level/image030.png)

<span data-ttu-id="2441d-178">tootest paralelismu hello blobxfer nástroje, hello maximální velikost souboru pro zálohování HANA byl nastaven pak too15 GB, což vedlo 19 záložní soubory.</span><span class="sxs-lookup"><span data-stu-id="2441d-178">tootest parallelism of hello blobxfer tool, hello max file size for HANA backups was then set too15 GB, which resulted in 19 backup files.</span></span> <span data-ttu-id="2441d-179">Tato konfigurace brzy hello dobu blobxfer toocopy hello 230 GB tooAzure úložiště objektů blob z 3000 sekund dolů too875 sekund.</span><span class="sxs-lookup"><span data-stu-id="2441d-179">This configuration brought hello time for blobxfer toocopy hello 230 GB tooAzure blob storage from 3000 seconds down too875 seconds.</span></span>

<span data-ttu-id="2441d-180">Tento výsledek je z důvodu omezení toohello 60 MB/s pro zápis objektů blob Azure.</span><span class="sxs-lookup"><span data-stu-id="2441d-180">This result is due toohello limit of 60 MB/sec for writing an Azure blob.</span></span> <span data-ttu-id="2441d-181">Paralelismus prostřednictvím více objektů BLOB řeší hello problémové místo, ale je nevýhodou: zvýšení výkonu hello blobxfer nástroj toocopy všechny tyto tooAzure záložní soubory HANA úložiště objektů blob dochází zatížení hello HANA virtuálního počítače a sítě hello.</span><span class="sxs-lookup"><span data-stu-id="2441d-181">Parallelism via multiple blobs solves hello bottleneck, but there is a downside: increasing performance of hello blobxfer tool toocopy all these HANA backup files tooAzure blob storage puts load on both hello HANA VM and hello network.</span></span> <span data-ttu-id="2441d-182">Operace systému HANA stane dopad.</span><span class="sxs-lookup"><span data-stu-id="2441d-182">Operation of HANA system becomes impacted.</span></span>

## <a name="blob-copy-of-dedicated-azure-data-disks-in-backup-software-raid"></a><span data-ttu-id="2441d-183">Objekt BLOB kopii vyhrazené Azure datové disky v zálohování softwaru diskového pole RAID</span><span class="sxs-lookup"><span data-stu-id="2441d-183">Blob copy of dedicated Azure data disks in backup software RAID</span></span>

<span data-ttu-id="2441d-184">Na rozdíl od hello ruční zálohování virtuálních počítačů datového disku v tomto přístupu jeden zálohovat všechny hello datové disky na virtuální počítač toosave hello celou SAP instalaci, včetně dat HANA HANA neprotokoluje soubory a soubory konfigurace.</span><span class="sxs-lookup"><span data-stu-id="2441d-184">Unlike hello manual VM data disk backup, in this approach one does not back up all hello data disks on a VM toosave hello whole SAP installation, including HANA data, HANA log files, and config files.</span></span> <span data-ttu-id="2441d-185">Místo toho je vhodné hello je toohave vyhrazené softwaru diskového pole RAID s proložení napříč více dat Azure virtuální pevné disky pro ukládání úplné zálohování souboru SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="2441d-185">Instead, hello idea is toohave dedicated software RAID with striping across multiple Azure data VHDs for storing a full SAP HANA file backup.</span></span> <span data-ttu-id="2441d-186">Jeden zkopíruje pouze tyto disky, které mají hello SAP HANA zálohování.</span><span class="sxs-lookup"><span data-stu-id="2441d-186">One copies only these disks, which have hello SAP HANA backup.</span></span> <span data-ttu-id="2441d-187">Může být snadno zachovány v vyhrazený účet úložiště pro zálohy HANA, nebo připojené tooa vyhrazené &quot;zálohování správu virtuálních počítačů&quot; pro další zpracování.</span><span class="sxs-lookup"><span data-stu-id="2441d-187">They could easily be kept in a dedicated HANA backup storage account, or attached tooa dedicated &quot;backup management VM&quot; for further processing.</span></span>

![Všechny virtuální pevné disky související se situací byly zkopírovány pomocí hello ** start-azurestorageblobcopy ** příkaz prostředí PowerShell](media/sap-hana-backup-file-level/image031.png)

<span data-ttu-id="2441d-189">Po dokončení zálohování toohello hello místního softwaru diskového pole RAID, byly zkopírovány všechny virtuální pevné disky související se situací pomocí hello **start-azurestorageblobcopy** příkaz prostředí PowerShell (najdete v části [Start-AzureStorageBlobCopy](/powershell/module/azure.storage/start-azurestorageblobcopy)).</span><span class="sxs-lookup"><span data-stu-id="2441d-189">After hello backup toohello local software RAID was completed, all VHDs involved were copied using hello **start-azurestorageblobcopy** PowerShell command (see [Start-AzureStorageBlobCopy](/powershell/module/azure.storage/start-azurestorageblobcopy)).</span></span> <span data-ttu-id="2441d-190">Jak ovlivňuje pouze systém souborů hello vyhrazené pro udržování hello záložních souborů, nejsou žádné pochybnostmi SAP HANA dat či protokolu konzistence souborů na disku hello.</span><span class="sxs-lookup"><span data-stu-id="2441d-190">As it only affects hello dedicated file system for keeping hello backup files, there are no concerns about SAP HANA data or log file consistency on hello disk.</span></span> <span data-ttu-id="2441d-191">Výhodou tohoto příkazu je, že funguje při hello virtuálního počítače zůstane online.</span><span class="sxs-lookup"><span data-stu-id="2441d-191">A benefit of this command is that it works while hello VM stays online.</span></span> <span data-ttu-id="2441d-192">být toobe určité, že žádný proces zapíše toohello zálohování stripe sady, že toounmount před hello kopírování objektu blob a ji připojit znovu později.</span><span class="sxs-lookup"><span data-stu-id="2441d-192">toobe certain that no process writes toohello backup stripe set, be sure toounmount it before hello blob copy, and mount it again afterwards.</span></span> <span data-ttu-id="2441d-193">Nebo jeden pomocí odpovídající příliš&quot;freeze&quot; hello systému souborů.</span><span class="sxs-lookup"><span data-stu-id="2441d-193">Or one could use an appropriate way too&quot;freeze&quot; hello file system.</span></span> <span data-ttu-id="2441d-194">Například prostřednictvím xfs\_freeze pro systém souborů XFS hello.</span><span class="sxs-lookup"><span data-stu-id="2441d-194">For example, via xfs\_freeze for hello XFS file system.</span></span>

![Tento snímek obrazovky ukazuje hello seznam objektů BLOB v kontejneru hello virtuální pevné disky na hello portálu Azure](media/sap-hana-backup-file-level/image032.png)

<span data-ttu-id="2441d-196">Tento snímek obrazovky ukazuje hello seznam objektů BLOB v hello &quot;virtuální pevné disky&quot; kontejneru na hello portálu Azure.</span><span class="sxs-lookup"><span data-stu-id="2441d-196">This screenshot shows hello list of blobs in hello &quot;vhds&quot; container on hello Azure portal.</span></span> <span data-ttu-id="2441d-197">Hello – snímek obrazovky ukazuje hello pět virtuální pevné disky, které byly připojené tooserve virtuálních počítačů serveru SAP HANA toohello jako hello softwaru diskového pole RAID tookeep SAP HANA záložní soubory.</span><span class="sxs-lookup"><span data-stu-id="2441d-197">hello screenshot shows hello five VHDs, which were attached toohello SAP HANA server VM tooserve as hello software RAID tookeep SAP HANA backup files.</span></span> <span data-ttu-id="2441d-198">Také ukazuje hello pět kopií, které byly provedeny prostřednictvím příkazu Kopírovat objekt blob hello.</span><span class="sxs-lookup"><span data-stu-id="2441d-198">It also shows hello five copies, which were taken via hello blob copy command.</span></span>

![Pro účely testování hello kopie disků RAID zálohovací software SAP HANA hello byly připojené toohello aplikačního serveru virtuálního počítače](media/sap-hana-backup-file-level/image033.png)

<span data-ttu-id="2441d-200">Pro účely testování hello kopie disků RAID zálohovací software SAP HANA hello byly připojené toohello aplikačního serveru virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="2441d-200">For testing purposes, hello copies of hello SAP HANA backup software RAID disks were attached toohello app server VM.</span></span>

![server aplikace Hello virtuální počítač byl vypnut kopie disku tooattach hello](media/sap-hana-backup-file-level/image034.png)

<span data-ttu-id="2441d-202">server aplikace Hello virtuální počítač byl vypnut kopie disku tooattach hello.</span><span class="sxs-lookup"><span data-stu-id="2441d-202">hello app server VM was shut down tooattach hello disk copies.</span></span> <span data-ttu-id="2441d-203">Po spuštění hello virtuálních počítačů, hello disky a hello RAID byly zjištěny správně (připojené prostřednictvím UUID).</span><span class="sxs-lookup"><span data-stu-id="2441d-203">After starting hello VM, hello disks and hello RAID were discovered correctly (mounted via UUID).</span></span> <span data-ttu-id="2441d-204">Pouze hello přípojný bod nebyl nalezen, který se vytvořil prostřednictvím dělicí metody YaST hello.</span><span class="sxs-lookup"><span data-stu-id="2441d-204">Only hello mount point was missing, which was created via hello YaST partitioner.</span></span> <span data-ttu-id="2441d-205">Později hello SAP HANA záložní soubor kopie se stala viditelné na úrovni operačního systému.</span><span class="sxs-lookup"><span data-stu-id="2441d-205">Afterwards hello SAP HANA backup file copies became visible on OS level.</span></span>

## <a name="copy-sap-hana-backup-files-toonfs-share"></a><span data-ttu-id="2441d-206">Zkopírujte SAP HANA záložní soubory, které tooNFS sdílet</span><span class="sxs-lookup"><span data-stu-id="2441d-206">Copy SAP HANA backup files tooNFS share</span></span>

<span data-ttu-id="2441d-207">hello potenciální dopad toolessen na hello systému SAP HANA z hlediska místa na disku nebo výkonu, jeden zvážit ukládat hello SAP HANA záložní soubory do sdílené složky NFS.</span><span class="sxs-lookup"><span data-stu-id="2441d-207">toolessen hello potential impact on hello SAP HANA system from a performance or disk space perspective, one might consider storing hello SAP HANA backup files on an NFS share.</span></span> <span data-ttu-id="2441d-208">Technicky funguje, ale znamená použití druhý virtuální počítač Azure jako hostitele hello hello k sdíleným složkám NFS.</span><span class="sxs-lookup"><span data-stu-id="2441d-208">Technically it works, but it means using a second Azure VM as hello host of hello NFS share.</span></span> <span data-ttu-id="2441d-209">Neměl by být malá velikost virtuálního počítače, z důvodu toohello šířky pásma sítě virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="2441d-209">It should not be a small VM size, due toohello VM network bandwidth.</span></span> <span data-ttu-id="2441d-210">By byla smysl pak tooshut dolů to &quot;zálohování virtuálních počítačů&quot; a převeďte ho pouze pro provádění zálohování hello SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="2441d-210">It would make sense then tooshut down this &quot;backup VM&quot; and only bring it up for executing hello SAP HANA backup.</span></span> <span data-ttu-id="2441d-211">Zápis v systému souborů NFS sdílené složky vloží zatížení v síti hello a ovlivňuje hello SAP HANA systému, ale jenom správu hello záložní soubory později na hello &quot;zálohování virtuálních počítačů&quot; nebude vůbec ovlivnit systému SAP HANA hello.</span><span class="sxs-lookup"><span data-stu-id="2441d-211">Writing on an NFS share puts load on hello network and impacts hello SAP HANA system, but merely managing hello backup files afterwards on hello &quot;backup VM&quot; would not influence hello SAP HANA system at all.</span></span>

![Sdílené složky NFS z jiného virtuálního počítače Azure se serveru SAP HANA připojené toohello virtuálních počítačů](media/sap-hana-backup-file-level/image035.png)

<span data-ttu-id="2441d-213">případ použití tooverify hello systému souborů NFS, sdílené složky NFS z jiného virtuálního počítače Azure byla serveru SAP HANA připojené toohello virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="2441d-213">tooverify hello NFS use case, an NFS share from another Azure VM was mounted toohello SAP HANA server VM.</span></span> <span data-ttu-id="2441d-214">Došlo k dispozici žádné zvláštní systému souborů NFS ladění použít.</span><span class="sxs-lookup"><span data-stu-id="2441d-214">There was no special NFS tuning applied.</span></span>

![Přímo trvalo 1 hodinu a 46 minut toodo hello zálohování](media/sap-hana-backup-file-level/image036.png)

<span data-ttu-id="2441d-216">sdílené složky NFS Hello se sadu rychlého stripe jako hello jeden na serveru SAP HANA hello.</span><span class="sxs-lookup"><span data-stu-id="2441d-216">hello NFS share was a fast stripe set, like hello one on hello SAP HANA server.</span></span> <span data-ttu-id="2441d-217">Nicméně trvalo 1 hodinu a 46 minut toodo hello zálohování přímo na sdílené složky NFS hello místo 10 minut, při zápisu tooa místní stripe set.</span><span class="sxs-lookup"><span data-stu-id="2441d-217">Nevertheless, it took 1 hour and 46 minutes toodo hello backup directly on hello NFS share instead of 10 minutes, when writing tooa local stripe set.</span></span>

![alternativní Hello nebyl mnohem rychlejší v 1 a hod](media/sap-hana-backup-file-level/image037.png)

<span data-ttu-id="2441d-219">alternativní Hello provádění zálohování tooa místní prokládané sady a kopírování toohello sdílených složek NFS na úrovni operačního systému (jednoduchou **cp - avr** příkaz) nebyla mnohem rychlejší.</span><span class="sxs-lookup"><span data-stu-id="2441d-219">hello alternative of doing a backup tooa local stripe set and copying toohello NFS share on OS level (a simple **cp -avr** command) wasn't much quicker.</span></span> <span data-ttu-id="2441d-220">Trvalo 1 a hod.</span><span class="sxs-lookup"><span data-stu-id="2441d-220">It took 1 hour and 43 minutes.</span></span>

<span data-ttu-id="2441d-221">Proto funguje, ale nebyl výkonu vhodné pro testovací zálohování hello 230 GB.</span><span class="sxs-lookup"><span data-stu-id="2441d-221">So it works, but performance wasn't good for hello 230-GB backup test.</span></span> <span data-ttu-id="2441d-222">Aby vypadal i zhoršení pro více terabajtů.</span><span class="sxs-lookup"><span data-stu-id="2441d-222">It would look even worse for multi terabytes.</span></span>

## <a name="copy-sap-hana-backup-files-tooazure-file-service"></a><span data-ttu-id="2441d-223">Zkopírujte služba souborů tooAzure záložní soubory SAP HANA</span><span class="sxs-lookup"><span data-stu-id="2441d-223">Copy SAP HANA backup files tooAzure file service</span></span>

<span data-ttu-id="2441d-224">Je možné toomount uvnitř virtuálního počítače Azure Linux sdílené složky Azure file.</span><span class="sxs-lookup"><span data-stu-id="2441d-224">It is possible toomount an Azure file share inside an Azure Linux VM.</span></span> <span data-ttu-id="2441d-225">článek Hello [jak toouse Azure File storage s Linuxem](../../../storage/files/storage-how-to-use-files-linux.md) obsahuje podrobné informace o tom, toodo ho.</span><span class="sxs-lookup"><span data-stu-id="2441d-225">hello article [How toouse Azure File storage with Linux](../../../storage/files/storage-how-to-use-files-linux.md) provides details on how toodo it.</span></span> <span data-ttu-id="2441d-226">Uvědomte si, že je aktuálně 5 TB kvótu jednu sdílenou složku Azure a maximální velikost souboru 1 TB na soubor.</span><span class="sxs-lookup"><span data-stu-id="2441d-226">Keep in mind that there is currently a 5-TB quota limit of one Azure file share, and a file size limit of 1 TB per file.</span></span> <span data-ttu-id="2441d-227">V tématu [a cíle výkonnosti služby Azure Storage Scalability](../../../storage/common/storage-scalability-targets.md) informace o omezení úložiště.</span><span class="sxs-lookup"><span data-stu-id="2441d-227">See [Azure Storage Scalability and Performance Targets](../../../storage/common/storage-scalability-targets.md) for information on storage limits.</span></span>

<span data-ttu-id="2441d-228">Testy ukázaly, však, že zálohování nemá SAP HANA & č. 39; t aktuálně pracovat přímo s Tento druh CIFS připojení.</span><span class="sxs-lookup"><span data-stu-id="2441d-228">Tests have shown, however, that SAP HANA backup doesn&#39;t currently work directly with this kind of CIFS mount.</span></span> <span data-ttu-id="2441d-229">Je také uvádí [1820529 Poznámka SAP](https://launchpad.support.sap.com/#/notes/1820529) , CIFS se nedoporučuje.</span><span class="sxs-lookup"><span data-stu-id="2441d-229">It is also stated in [SAP Note 1820529](https://launchpad.support.sap.com/#/notes/1820529) that CIFS is not recommended.</span></span>

![Tento obrázek zobrazuje chybu v zálohování dialogové okno hello ve SAP HANA Studio](media/sap-hana-backup-file-level/image038.png)

<span data-ttu-id="2441d-231">Při pokusu o tooback až přímo tooa CIFS připojit sdílenou složku Azure tento obrázek ukazuje chybu v hello zálohování dialogové okno, ve studiu SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="2441d-231">This figure shows an error in hello backup dialog in SAP HANA Studio, when trying tooback up directly tooa CIFS-mounted Azure file share.</span></span> <span data-ttu-id="2441d-232">Tak, aby jeden má toodo zálohu standardní SAP HANA do systému souborů virtuálního počítače první, a pak hello záložní kopii souborů z tam tooAzure služba souborů.</span><span class="sxs-lookup"><span data-stu-id="2441d-232">So one has toodo a standard SAP HANA backup into a VM file system first, and then copy hello backup files from there tooAzure file service.</span></span>

![Následující obrázek ukazuje, že trvalo o 929 sekund toocopy 19 SAP HANA záložní soubory](media/sap-hana-backup-file-level/image039.png)

<span data-ttu-id="2441d-234">Následující obrázek ukazuje, že trvalo o 929 sekund toocopy 19 SAP HANA záložní soubory s celkovou velikost přibližně 230 GB toohello sdílenou složku Azure.</span><span class="sxs-lookup"><span data-stu-id="2441d-234">This figure shows that it took about 929 seconds toocopy 19 SAP HANA backup files with a total size of roughly 230 GB toohello Azure file share.</span></span>

![Hello zdroj strukturu adresáře na hello SAP HANA virtuálního počítače byla zkopírovaný toohello Azure sdílené složky](media/sap-hana-backup-file-level/image040.png)

<span data-ttu-id="2441d-236">Na tomto snímku obrazovky jeden uvidí, že hello zdroj strukturu adresáře na hello SAP HANA virtuálního počítače byla zkopírovaný toohello Azure sdílené složky: jeden adresář (hana\_zálohování\_fsl\_15 gb) a 19 jednotlivých záložní soubory.</span><span class="sxs-lookup"><span data-stu-id="2441d-236">In this screenshot, one can see that hello source directory structure on hello SAP HANA VM was copied toohello Azure file share: one directory (hana\_backup\_fsl\_15gb) and 19 individual backup files.</span></span>

<span data-ttu-id="2441d-237">Ukládání záložních souborů SAP HANA na soubory Azure může být v budoucnu hello zajímavé možnost, při přímo záloh souboru SAP HANA ho podporují.</span><span class="sxs-lookup"><span data-stu-id="2441d-237">Storing SAP HANA backup files on Azure files could be an interesting option in hello future when SAP HANA file backups support it directly.</span></span> <span data-ttu-id="2441d-238">Nebo když se stane možné toomount Azure soubory pomocí systému souborů NFS a maximální kvóty hello je podstatně vyšší než 5 TB.</span><span class="sxs-lookup"><span data-stu-id="2441d-238">Or when it becomes possible toomount Azure files via NFS and hello maximum quota limit is considerably higher than 5 TB.</span></span>

## <a name="next-steps"></a><span data-ttu-id="2441d-239">Další kroky</span><span class="sxs-lookup"><span data-stu-id="2441d-239">Next steps</span></span>
* <span data-ttu-id="2441d-240">[Příručce zálohování pro SAP HANA ve virtuálních počítačích Azure](sap-hana-backup-guide.md) nabízí přehled a informace o zahájení práce.</span><span class="sxs-lookup"><span data-stu-id="2441d-240">[Backup guide for SAP HANA on Azure Virtual Machines](sap-hana-backup-guide.md) gives an overview and information on getting started.</span></span>
* <span data-ttu-id="2441d-241">[SAP HANA zálohování podle úložiště snímků](sap-hana-backup-storage-snapshots.md) popisuje hello úložiště založené na snímku možnost zálohování.</span><span class="sxs-lookup"><span data-stu-id="2441d-241">[SAP HANA backup based on storage snapshots](sap-hana-backup-storage-snapshots.md) describes hello storage snapshot-based backup option.</span></span>
* <span data-ttu-id="2441d-242">jak tooestablish vysokou dostupnost a plán pro zotavení po havárii SAP HANA v Azure (velké instance), najdete v části toolearn [SAP HANA (velké instance) vysoké dostupnosti a zotavení po havárii v Azure](hana-overview-high-availability-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="2441d-242">toolearn how tooestablish high availability and plan for disaster recovery of SAP HANA on Azure (large instances), see [SAP HANA (large instances) high availability and disaster recovery on Azure](hana-overview-high-availability-disaster-recovery.md).</span></span>
