---
title: "Příprava virtuálního pevného disku Windows nahrát do Azure | Microsoft Docs"
description: "Postup přípravy Windows VHD nebo VHDX před nahráním do Azure"
services: virtual-machines-windows
documentationcenter: 
author: glimoli
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 7802489d-33ec-4302-82a4-91463d03887a
ms.service: virtual-machines-windows
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-windows
ms.devlang: na
ms.topic: article
ms.date: 08/01/2017
ms.author: genli
ms.openlocfilehash: aa1cec2ef11da6aa8a8c4089be36994ab5f61682
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/18/2017
---
# <a name="prepare-a-windows-vhd-or-vhdx-to-upload-to-azure"></a><span data-ttu-id="2e011-103">Příprava systému Windows VHD nebo VHDX, který chcete nahrát do Azure</span><span class="sxs-lookup"><span data-stu-id="2e011-103">Prepare a Windows VHD or VHDX to upload to Azure</span></span>
<span data-ttu-id="2e011-104">Před nahráním Windows virtuální počítače (VM) z místní do služby Microsoft Azure, musíte připravit virtuální pevný disk (VHD nebo VHDX).</span><span class="sxs-lookup"><span data-stu-id="2e011-104">Before you upload a Windows  virtual machines (VM) from on-premises to Microsoft Azure, you must prepare the virtual hard disk (VHD or VHDX).</span></span> <span data-ttu-id="2e011-105">Azure podporuje jenom virtuální počítače generace 1, které jsou ve formátu souboru virtuálního pevného disku a mají pevnou velikostí disku.</span><span class="sxs-lookup"><span data-stu-id="2e011-105">Azure supports only generation 1 VMs that are in the VHD file format and have a fixed sized disk.</span></span> <span data-ttu-id="2e011-106">Maximální velikost povolenou pro virtuální pevný disk je 1,023 GB.</span><span class="sxs-lookup"><span data-stu-id="2e011-106">The maximum size allowed for the VHD is 1,023 GB.</span></span> <span data-ttu-id="2e011-107">Můžete převést generace 1 virtuální počítač z je disk VHDX souborů systému na virtuální pevný disk a z dynamicky se zvětšující disk do pevnou velikostí.</span><span class="sxs-lookup"><span data-stu-id="2e011-107">You can convert a generation 1 VM from the VHDX file system to VHD and from a dynamically expanding disk to fixed-sized.</span></span> <span data-ttu-id="2e011-108">Ale generaci Virtuálního počítače nelze změnit.</span><span class="sxs-lookup"><span data-stu-id="2e011-108">But you can't change a VM's generation.</span></span> <span data-ttu-id="2e011-109">Další informace najdete v tématu [měli vytvořit generace 1 nebo 2 virtuálních počítačů Hyper-v](https://technet.microsoft.com/windows-server-docs/compute/hyper-v/plan/should-i-create-a-generation-1-or-2-virtual-machine-in-hyper-v).</span><span class="sxs-lookup"><span data-stu-id="2e011-109">For more information, see [Should I create a generation 1 or 2 VM in Hyper-V](https://technet.microsoft.com/windows-server-docs/compute/hyper-v/plan/should-i-create-a-generation-1-or-2-virtual-machine-in-hyper-v).</span></span>

<span data-ttu-id="2e011-110">Další informace o zásadách podpory pro virtuální počítač Azure, najdete v části [podporu serveru softwaru společnosti Microsoft pro virtuální počítače Microsoft Azure](https://support.microsoft.com/help/2721672/microsoft-server-software-support-for-microsoft-azure-virtual-machines).</span><span class="sxs-lookup"><span data-stu-id="2e011-110">For more information about the support policy for Azure VM, see [Microsoft server software support for Microsoft Azure VMs](https://support.microsoft.com/help/2721672/microsoft-server-software-support-for-microsoft-azure-virtual-machines).</span></span>

> [!Note]
> <span data-ttu-id="2e011-111">Pokyny v tomto článku platí pro 64bitovou verzi Windows Server 2008 R2 a novější operační systém Windows server.</span><span class="sxs-lookup"><span data-stu-id="2e011-111">The instructions in this article apply to the 64-bit version of Windows Server 2008 R2 and later Windows server operating system.</span></span> <span data-ttu-id="2e011-112">Informace o spuštěných 32bitovou verzi operačního systému v Azure najdete v tématu [podpora pro 32bitové operační systémy ve virtuálních počítačích Azure](https://support.microsoft.com/help/4021388/support-for-32-bit-operating-systems-in-azure-virtual-machines).</span><span class="sxs-lookup"><span data-stu-id="2e011-112">For information about running 32-bit version of operating system in Azure, see [Support for 32-bit operating systems in Azure virtual machines](https://support.microsoft.com/help/4021388/support-for-32-bit-operating-systems-in-azure-virtual-machines).</span></span>

## <a name="convert-the-virtual-disk-to-vhd-and-fixed-size-disk"></a><span data-ttu-id="2e011-113">Převést virtuální disk na virtuální pevný disk a disk pevné velikosti</span><span class="sxs-lookup"><span data-stu-id="2e011-113">Convert the virtual disk to VHD and fixed size disk</span></span> 
<span data-ttu-id="2e011-114">Pokud potřebujete převést virtuální disk na požadovaný formát pro Azure, použijte jednu z metod v této části.</span><span class="sxs-lookup"><span data-stu-id="2e011-114">If you need to convert your virtual disk to the required format for Azure, use one of the methods in this section.</span></span> <span data-ttu-id="2e011-115">Zálohování virtuálního počítače před spuštěním procesu převodu virtuálního disku a ujistěte se, že virtuální pevný disk systému Windows správně funguje na místním serveru.</span><span class="sxs-lookup"><span data-stu-id="2e011-115">Back up the VM before you run the virtual disk conversion process and make sure that the Windows VHD works correctly on the local server.</span></span> <span data-ttu-id="2e011-116">Vyřešte všechny chyby v rámci virtuální počítač, než se pokusíte převést nebo ho nahrát do Azure.</span><span class="sxs-lookup"><span data-stu-id="2e011-116">Resolve any errors within the VM itself before you try to convert or upload it to Azure.</span></span>

<span data-ttu-id="2e011-117">Převedete-li disk, vytvořte virtuální počítač, který používá převedený disk.</span><span class="sxs-lookup"><span data-stu-id="2e011-117">After you convert the disk, create a VM that uses the converted disk.</span></span> <span data-ttu-id="2e011-118">Spuštění a přihlášení do virtuálního počítače na dokončení Příprava virtuálního počítače pro odesílání.</span><span class="sxs-lookup"><span data-stu-id="2e011-118">Start and sign in to the VM to finish preparing the VM for upload.</span></span>

### <a name="convert-disk-using-hyper-v-manager"></a><span data-ttu-id="2e011-119">Převedení disku pomocí Správce technologie Hyper-V</span><span class="sxs-lookup"><span data-stu-id="2e011-119">Convert disk using Hyper-V Manager</span></span>
1. <span data-ttu-id="2e011-120">Otevřete Správce technologie Hyper-V a vyberte místního počítače na levé straně.</span><span class="sxs-lookup"><span data-stu-id="2e011-120">Open Hyper-V Manager and select your local computer on the left.</span></span> <span data-ttu-id="2e011-121">V nabídce nahoře seznamu počítačů, klikněte na tlačítko **akce** > **upravit Disk**.</span><span class="sxs-lookup"><span data-stu-id="2e011-121">In the menu above the computer list, click **Action** > **Edit Disk**.</span></span>
2. <span data-ttu-id="2e011-122">Na **najít virtuální pevný Disk** obrazovky, vyhledejte a vyberte virtuální disk.</span><span class="sxs-lookup"><span data-stu-id="2e011-122">On the **Locate Virtual Hard Disk** screen, locate and select your virtual disk.</span></span>
3. <span data-ttu-id="2e011-123">Na **zvolit akci** obrazovky a pak vyberte **převést** a **Další**.</span><span class="sxs-lookup"><span data-stu-id="2e011-123">On the **Choose Action** screen, and then select **Convert** and **Next**.</span></span>
4. <span data-ttu-id="2e011-124">Pokud musíte převést z VHDX, vyberte **virtuálního pevného disku** a pak klikněte na tlačítko **další**</span><span class="sxs-lookup"><span data-stu-id="2e011-124">If you need to convert from VHDX, select **VHD** and then click **Next**</span></span>
5. <span data-ttu-id="2e011-125">Pokud musíte převést z dynamicky se zvětšující disku, vyberte **pevnou velikost** a pak klikněte na tlačítko **další**</span><span class="sxs-lookup"><span data-stu-id="2e011-125">If you need to convert from a dynamically expanding disk, select **Fixed size** and then click **Next**</span></span>
6. <span data-ttu-id="2e011-126">Vyhledejte a vyberte cestu pro uložení nového souboru virtuálního pevného disku.</span><span class="sxs-lookup"><span data-stu-id="2e011-126">Locate and select a path to save the new VHD file to.</span></span>
7. <span data-ttu-id="2e011-127">Klikněte na **Dokončit**.</span><span class="sxs-lookup"><span data-stu-id="2e011-127">Click **Finish**.</span></span>

>[!NOTE]
><span data-ttu-id="2e011-128">Příkazy v tomto článku se musí spustit v relaci prostředí PowerShell zvýšenými oprávněními.</span><span class="sxs-lookup"><span data-stu-id="2e011-128">The commands in this article must be run on an elevated PowerShell session.</span></span>

### <a name="convert-disk-by-using-powershell"></a><span data-ttu-id="2e011-129">Převést disk pomocí prostředí PowerShell</span><span class="sxs-lookup"><span data-stu-id="2e011-129">Convert disk by using PowerShell</span></span>
<span data-ttu-id="2e011-130">Můžete převést virtuální disk pomocí [Convert-VHD](http://technet.microsoft.com/library/hh848454.aspx) příkazu v prostředí Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2e011-130">You can convert a virtual disk by using the [Convert-VHD](http://technet.microsoft.com/library/hh848454.aspx) command in Windows PowerShell.</span></span> <span data-ttu-id="2e011-131">Vyberte **spustit jako správce** při spuštění prostředí PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2e011-131">Select **Run as administrator** when you start PowerShell.</span></span> 

<span data-ttu-id="2e011-132">Následující ukázkový příkaz převede z VHDX na virtuální pevný disk a z dynamicky se zvětšující disk do pevné velikosti:</span><span class="sxs-lookup"><span data-stu-id="2e011-132">The following example command converts from VHDX to VHD, and from a dynamically expanding disk to fixed-size:</span></span>

```Powershell
Convert-VHD –Path c:\test\MY-VM.vhdx –DestinationPath c:\test\MY-NEW-VM.vhd -VHDType Fixed
```
<span data-ttu-id="2e011-133">V tomto příkazu nahraďte hodnotu pro "-cestu" cestou k virtuální pevný disk, který chcete převést a hodnota "-DestinationPath" s novou cestu a název převedený disku.</span><span class="sxs-lookup"><span data-stu-id="2e011-133">In this command, replace the value for "-Path" with the path to the virtual hard disk that you want to convert and the value for "-DestinationPath" with the new path and name of the converted disk.</span></span>

### <a name="convert-from-vmware-vmdk-disk-format"></a><span data-ttu-id="2e011-134">Převod z formátu VMware VMDK disku</span><span class="sxs-lookup"><span data-stu-id="2e011-134">Convert from VMware VMDK disk format</span></span>
<span data-ttu-id="2e011-135">Pokud máte bitovou kopii virtuálního počítače s Windows [formát souboru VMDK](https://en.wikipedia.org/wiki/VMDK), ho převést na virtuální pevný disk pomocí [převaděč virtuálních počítačů Microsoft](https://www.microsoft.com/download/details.aspx?id=42497).</span><span class="sxs-lookup"><span data-stu-id="2e011-135">If you have a Windows VM image in the [VMDK file format](https://en.wikipedia.org/wiki/VMDK), convert it to a VHD by using the [Microsoft VM Converter](https://www.microsoft.com/download/details.aspx?id=42497).</span></span> <span data-ttu-id="2e011-136">Další informace najdete v článku na blogu [jak převést VMware VMDK na VHD Hyper-V](http://blogs.msdn.com/b/timomta/archive/2015/06/11/how-to-convert-a-vmware-vmdk-to-hyper-v-vhd.aspx).</span><span class="sxs-lookup"><span data-stu-id="2e011-136">For more information, see the blog article [How to Convert a VMware VMDK to Hyper-V VHD](http://blogs.msdn.com/b/timomta/archive/2015/06/11/how-to-convert-a-vmware-vmdk-to-hyper-v-vhd.aspx).</span></span>

## <a name="set-windows-configurations-for-azure"></a><span data-ttu-id="2e011-137">Nastavení konfigurace systému Windows Azure</span><span class="sxs-lookup"><span data-stu-id="2e011-137">Set Windows configurations for Azure</span></span>

<span data-ttu-id="2e011-138">Na virtuálním počítači, který chcete nahrát do Azure, spusťte v následujících krocích z všechny příkazy [okno příkazového řádku se zvýšenými oprávněními](https://technet.microsoft.com/library/cc947813.aspx):</span><span class="sxs-lookup"><span data-stu-id="2e011-138">On the VM that you plan to upload to Azure, run all commands in the following steps from an [elevated Command Prompt window](https://technet.microsoft.com/library/cc947813.aspx):</span></span>

1. <span data-ttu-id="2e011-139">Odeberte všechny statické trasy trvalé ve směrovací tabulce:</span><span class="sxs-lookup"><span data-stu-id="2e011-139">Remove any static persistent route on the routing table:</span></span>
   
   * <span data-ttu-id="2e011-140">Chcete-li zobrazit směrovací tabulka, spusťte `route print` na příkazovém řádku.</span><span class="sxs-lookup"><span data-stu-id="2e011-140">To view the route table, run `route print` at the command prompt.</span></span>
   * <span data-ttu-id="2e011-141">Zkontrolujte **trvalost trasy** oddíly.</span><span class="sxs-lookup"><span data-stu-id="2e011-141">Check the **Persistence Routes** sections.</span></span> <span data-ttu-id="2e011-142">Pokud je trvalé trasy, použijte [trasy odstranění](https://technet.microsoft.com/library/cc739598.apx) jeho odebrání.</span><span class="sxs-lookup"><span data-stu-id="2e011-142">If there is a persistent route, use [route delete](https://technet.microsoft.com/library/cc739598.apx) to remove it.</span></span>
2. <span data-ttu-id="2e011-143">Odebrání proxy serveru WinHTTP:</span><span class="sxs-lookup"><span data-stu-id="2e011-143">Remove the WinHTTP proxy:</span></span>
   
    ```PowerShell
    netsh winhttp reset proxy
    ```
3. <span data-ttu-id="2e011-144">Nastavte zásady sítě SAN disku na [Onlineall](https://technet.microsoft.com/library/gg252636.aspx).</span><span class="sxs-lookup"><span data-stu-id="2e011-144">Set the disk SAN policy to [Onlineall](https://technet.microsoft.com/library/gg252636.aspx).</span></span> 
   
    ```PowerShell
    diskpart 
    ```
    <span data-ttu-id="2e011-145">V otevřené okno příkazového řádku zadejte následující příkazy:</span><span class="sxs-lookup"><span data-stu-id="2e011-145">In the open Command Prompt window, type the following commands:</span></span>

     ```DISKPART
    san policy=onlineall
    exit   
    ```

4. <span data-ttu-id="2e011-146">Nastavit čas koordinovaný světový čas (UTC) pro systém Windows a typ spouštění služby Systémový čas (w32time) **automaticky**:</span><span class="sxs-lookup"><span data-stu-id="2e011-146">Set Coordinated Universal Time (UTC) time for Windows and the startup type of the Windows Time (w32time) service to **Automatically**:</span></span>
   
    ```PowerShell
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\TimeZoneInformation' -name "RealTimeIsUniversal" 1 -Type DWord

    Set-Service -Name w32time -StartupType Auto
    ```
5. <span data-ttu-id="2e011-147">Nastavte profil spotřeby na **vysoký výkon**:</span><span class="sxs-lookup"><span data-stu-id="2e011-147">Set the power profile to the **High Performance**:</span></span>

    ```PowerShell
    powercfg /setactive SCHEME_MIN
    ```

## <a name="check-the-windows-services"></a><span data-ttu-id="2e011-148">Zkontrolujte služby systému Windows</span><span class="sxs-lookup"><span data-stu-id="2e011-148">Check the Windows services</span></span>
<span data-ttu-id="2e011-149">Ujistěte se, že každý z následujících služeb systému Windows je nastavena na **Windows výchozí hodnoty**.</span><span class="sxs-lookup"><span data-stu-id="2e011-149">Make sure that each of the following Windows services is set to the **Windows default values**.</span></span> <span data-ttu-id="2e011-150">Toto jsou minimální čísla služeb, které musí nastavit tak, abyste měli jistotu, že virtuální počítač má připojení.</span><span class="sxs-lookup"><span data-stu-id="2e011-150">These are the minimum numbers of services that must be set up to make sure that the VM has connectivity.</span></span> <span data-ttu-id="2e011-151">Chcete-li obnovit nastavení při spuštění, spusťte následující příkazy:</span><span class="sxs-lookup"><span data-stu-id="2e011-151">To reset the startup settings, run the following commands:</span></span>
   
```PowerShell
Set-Service -Name bfe -StartupType Auto
Set-Service -Name dhcp -StartupType Auto
Set-Service -Name dnscache -StartupType Auto
Set-Service -Name IKEEXT -StartupType Auto
Set-Service -Name iphlpsvc -StartupType Auto
Set-Service -Name netlogon -StartupType Manual
Set-Service -Name netman -StartupType Manual
Set-Service -Name nsi -StartupType Auto
Set-Service -Name termService -StartupType Manual
Set-Service -Name MpsSvc -StartupType Auto
Set-Service -Name RemoteRegistry -StartupType Auto
```

## <a name="update-remote-desktop-registry-settings"></a><span data-ttu-id="2e011-152">Aktualizace nastavení registru vzdálené plochy</span><span class="sxs-lookup"><span data-stu-id="2e011-152">Update Remote Desktop registry settings</span></span>
<span data-ttu-id="2e011-153">Zkontrolujte, že následující nastavení jsou správně nakonfigurovány pro připojení ke vzdálené ploše:</span><span class="sxs-lookup"><span data-stu-id="2e011-153">Make sure that the following settings are configured correctly for remote desktop connection:</span></span>

>[!Note] 
><span data-ttu-id="2e011-154">Při spuštění, může se zobrazit chybová zpráva **Set-ItemProperty-cesta ' HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal služby - název &lt;název objektu&gt; &lt;hodnotu&gt;**  v těchto krocích.</span><span class="sxs-lookup"><span data-stu-id="2e011-154">You may receive an error message when you run the **Set-ItemProperty -Path 'HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services -name &lt;object name&gt; &lt;value&gt;** in these steps.</span></span> <span data-ttu-id="2e011-155">Chybová zpráva můžete bezpečně ignorovat.</span><span class="sxs-lookup"><span data-stu-id="2e011-155">The error message can be safely ignored.</span></span> <span data-ttu-id="2e011-156">Znamená jen, že doména není vkládání tato konfigurace prostřednictvím objektu zásad skupiny.</span><span class="sxs-lookup"><span data-stu-id="2e011-156">It means only that the domain is not pushing that configuration through a Group Policy object.</span></span>
>
>

1. <span data-ttu-id="2e011-157">Je povolen protokol RDP (Remote Desktop):</span><span class="sxs-lookup"><span data-stu-id="2e011-157">Remote Desktop Protocol (RDP) is enabled:</span></span>
   
    ```PowerShell
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server' -name "fDenyTSConnections" -Value 0 -Type DWord

    Set-ItemProperty -Path 'HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services' -name "fDenyTSConnections" -Value 0 -Type DWord
    ```
   
2. <span data-ttu-id="2e011-158">Správné nastavení portu RDP (výchozí port 3389):</span><span class="sxs-lookup"><span data-stu-id="2e011-158">The RDP port is set up correctly (Default port 3389):</span></span>
   
    ```PowerShell
   Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Winstations\RDP-Tcp' -name "PortNumber" 3389 -Type DWord
    ```
    <span data-ttu-id="2e011-159">Při nasazení virtuálního počítače, výchozí pravidla vytvářejí proti portu 3389.</span><span class="sxs-lookup"><span data-stu-id="2e011-159">When you deploy a VM, the default rules are created against port 3389.</span></span> <span data-ttu-id="2e011-160">Pokud chcete změnit číslo portu, udělat po nasazení virtuálního počítače v Azure.</span><span class="sxs-lookup"><span data-stu-id="2e011-160">If you want to change the port number,  do that after the VM is deployed in Azure.</span></span>

3. <span data-ttu-id="2e011-161">V každé síťové rozhraní naslouchá naslouchací proces:</span><span class="sxs-lookup"><span data-stu-id="2e011-161">The listener is listening in every network interface:</span></span>
   
    ```PowerShell
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Winstations\RDP-Tcp' -name "LanAdapter" 0 -Type DWord
   ```
4. <span data-ttu-id="2e011-162">Konfigurace režimu ověřování na úrovni sítě pro připojení RDP:</span><span class="sxs-lookup"><span data-stu-id="2e011-162">Configure the Network Level Authentication mode for the RDP connections:</span></span>
   
    ```PowerShell
   Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -name "UserAuthentication" 1 -Type DWord

    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -name "SecurityLayer" 1 -Type DWord

    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -name "fAllowSecProtocolNegotiation" 1 -Type DWord
     ```

5. <span data-ttu-id="2e011-163">Udržování hodnotu:</span><span class="sxs-lookup"><span data-stu-id="2e011-163">Set the keep-alive value：</span></span>
    
    ```PowerShell
    Set-ItemProperty -Path 'HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services' -name "KeepAliveEnable" 1 -Type DWord
    Set-ItemProperty -Path 'HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services' -name "KeepAliveInterval" 1 -Type DWord
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Winstations\RDP-Tcp' -name "KeepAliveTimeout" 1 -Type DWord
    ```
6. <span data-ttu-id="2e011-164">Připojení:</span><span class="sxs-lookup"><span data-stu-id="2e011-164">Reconnect：</span></span>
    
    ```PowerShell
    Set-ItemProperty -Path 'HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services' -name "fDisableAutoReconnect" 0 -Type DWord
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Winstations\RDP-Tcp' -name "fInheritReconnectSame" 1 -Type DWord
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Winstations\RDP-Tcp' -name "fReconnectSame" 0 -Type DWord
    ```
7. <span data-ttu-id="2e011-165">Omezte počet souběžných připojení:</span><span class="sxs-lookup"><span data-stu-id="2e011-165">Limit the number of concurrent connections：</span></span>
    
    ```PowerShell
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\Winstations\RDP-Tcp' -name "MaxInstanceCount" 4294967295 -Type DWord
    ```
8. <span data-ttu-id="2e011-166">Pokud jsou všechny certifikáty podepsané svým držitelem svázané s naslouchací proces protokolu RDP, odeberte je:</span><span class="sxs-lookup"><span data-stu-id="2e011-166">If there are any self-signed certificates tied to the RDP listener, remove them:</span></span>
    
    ```PowerShell
    Remove-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -name "SSLCertificateSHA1Hash"
    ```
    <span data-ttu-id="2e011-167">Toto je zajistit, že se můžete připojit na začátku při nasazení virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="2e011-167">This is to make sure that you can connect at the beginning when you deploy the VM.</span></span> <span data-ttu-id="2e011-168">Můžete také zkontrolovat to v pozdější fázi po nasazení virtuálního počítače v Azure v případě potřeby.</span><span class="sxs-lookup"><span data-stu-id="2e011-168">You can also review this on a later stage after the VM is deployed in Azure if needed.</span></span>

9. <span data-ttu-id="2e011-169">Pokud virtuální počítač bude součástí domény, zkontrolujte všechny následující nastavení a ujistěte se, že předchozí nastavení se nevrátí.</span><span class="sxs-lookup"><span data-stu-id="2e011-169">If the VM will be part of a Domain, check all the following settings to make sure that the former settings are not reverted.</span></span> <span data-ttu-id="2e011-170">Zásady, které se musí kontrolovat jsou následující:</span><span class="sxs-lookup"><span data-stu-id="2e011-170">The policies that must be checked are the following:</span></span>
    
    - <span data-ttu-id="2e011-171">Je povolen protokol RDP:</span><span class="sxs-lookup"><span data-stu-id="2e011-171">RDP is enabled:</span></span>

         <span data-ttu-id="2e011-172">Počítač Konfigurace uživatele\Zásady\Nastavení systému Settings\Administrative Templates\ Windows\Vzdálená plocha\Hostitel relace vzdálené plochy\Připojení:</span><span class="sxs-lookup"><span data-stu-id="2e011-172">Computer Configuration\Policies\Windows Settings\Administrative Templates\ Components\Remote Desktop Services\Remote Desktop Session Host\Connections:</span></span>
         
         <span data-ttu-id="2e011-173">**Povolit uživatelům vzdálené připojení pomocí vzdálené plochy**</span><span class="sxs-lookup"><span data-stu-id="2e011-173">**Allow users to connect remotely by using Remote Desktop**</span></span>

    - <span data-ttu-id="2e011-174">NLA zásad skupiny:</span><span class="sxs-lookup"><span data-stu-id="2e011-174">NLA group policy:</span></span>

        <span data-ttu-id="2e011-175">Settings\Administrative Templates\Components\Remote plocha\Hostitel relace plochy plochy\Zabezpečení:</span><span class="sxs-lookup"><span data-stu-id="2e011-175">Settings\Administrative Templates\Components\Remote Desktop Services\Remote Desktop Session Host\Security:</span></span> 
        
        <span data-ttu-id="2e011-176">**Uživatel ověřování vyžadovat pro vzdálená připojení pomocí ověření úrovně sítě**</span><span class="sxs-lookup"><span data-stu-id="2e011-176">**Require user Authentication for remote connections by using Network Level Authentication**</span></span>
    
    - <span data-ttu-id="2e011-177">Ponechat Alive nastavení:</span><span class="sxs-lookup"><span data-stu-id="2e011-177">Keep Alive settings:</span></span>

        <span data-ttu-id="2e011-178">Počítač Konfigurace uživatele\Zásady\Nastavení systému Settings\Administrative pro správu\Součásti systému Windows\Vzdálená plocha\Hostitel relace vzdálené plochy\Připojení:</span><span class="sxs-lookup"><span data-stu-id="2e011-178">Computer Configuration\Policies\Windows Settings\Administrative Templates\Windows Components\Remote Desktop Services\Remote Desktop Session Host\Connections:</span></span> 
        
        <span data-ttu-id="2e011-179">**Nakonfigurujte interval udržování připojení**</span><span class="sxs-lookup"><span data-stu-id="2e011-179">**Configure keep-alive connection interval**</span></span>

    - <span data-ttu-id="2e011-180">Znovu připojte nastavení:</span><span class="sxs-lookup"><span data-stu-id="2e011-180">Reconnect settings:</span></span>

        <span data-ttu-id="2e011-181">Počítač Konfigurace uživatele\Zásady\Nastavení systému Settings\Administrative pro správu\Součásti systému Windows\Vzdálená plocha\Hostitel relace vzdálené plochy\Připojení:</span><span class="sxs-lookup"><span data-stu-id="2e011-181">Computer Configuration\Policies\Windows Settings\Administrative Templates\Windows Components\Remote Desktop Services\Remote Desktop Session Host\Connections:</span></span> 
        
        <span data-ttu-id="2e011-182">**Automatické obnovení připojení**</span><span class="sxs-lookup"><span data-stu-id="2e011-182">**Automatic reconnection**</span></span>

    - <span data-ttu-id="2e011-183">Omezení počtu připojení nastavení:</span><span class="sxs-lookup"><span data-stu-id="2e011-183">Limit the number of connections settings:</span></span>

        <span data-ttu-id="2e011-184">Počítač Konfigurace uživatele\Zásady\Nastavení systému Settings\Administrative pro správu\Součásti systému Windows\Vzdálená plocha\Hostitel relace vzdálené plochy\Připojení:</span><span class="sxs-lookup"><span data-stu-id="2e011-184">Computer Configuration\Policies\Windows Settings\Administrative Templates\Windows Components\Remote Desktop Services\Remote Desktop Session Host\Connections:</span></span> 
        
        <span data-ttu-id="2e011-185">**Omezení počtu připojení**</span><span class="sxs-lookup"><span data-stu-id="2e011-185">**Limit number of connections**</span></span>

## <a name="configure-windows-firewall-rules"></a><span data-ttu-id="2e011-186">Konfigurace pravidel brány Windows Firewall</span><span class="sxs-lookup"><span data-stu-id="2e011-186">Configure Windows Firewall rules</span></span>
1. <span data-ttu-id="2e011-187">Zapněte bránu Windows Firewall na tři profily (domény, Standard a veřejný):</span><span class="sxs-lookup"><span data-stu-id="2e011-187">Turn on Windows Firewall on the three profiles (Domain, Standard, and Public):</span></span>

   ```PowerShell
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\services\SharedAccess\Parameters\FirewallPolicy\DomainProfile' -name "EnableFirewall" -Value 1 -Type DWord
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\services\SharedAccess\Parameters\FirewallPolicy\PublicProfile' -name "EnableFirewall" -Value 1 -Type DWord
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\services\SharedAccess\Parameters\FirewallPolicy\Standardprofile' -name "EnableFirewall" -Value 1 -Type DWord
   ```

2. <span data-ttu-id="2e011-188">V prostředí PowerShell povolit WinRM pomocí tří profilů brány firewall (Domain, Private a Public) a povolte službu vzdáleného prostředí PowerShell, spusťte následující příkaz:</span><span class="sxs-lookup"><span data-stu-id="2e011-188">Run the following command in PowerShell to allow WinRM through the three firewall profiles (Domain, Private, and Public) and enable the PowerShell Remote service:</span></span>
   
   ```PowerShell
    Enable-PSRemoting -force
    netsh advfirewall firewall set rule dir=in name="Windows Remote Management (HTTP-In)" new enable=yes
    netsh advfirewall firewall set rule dir=in name="Windows Remote Management (HTTP-In)" new enable=yes
   ```
3. <span data-ttu-id="2e011-189">Povolte následující pravidla brány firewall umožňuje provoz protokolu RDP</span><span class="sxs-lookup"><span data-stu-id="2e011-189">Enable the following firewall rules to allow the RDP traffic</span></span> 

   ```PowerShell
    netsh advfirewall firewall set rule group="Remote Desktop" new enable=yes
   ```   
4. <span data-ttu-id="2e011-190">Povolení sdílení souborů a tiskáren pravidla, aby virtuální počítač mohli odpovídat na příkaz ping uvnitř virtuální sítě:</span><span class="sxs-lookup"><span data-stu-id="2e011-190">Enable the File and Printer Sharing rule so that the VM can respond to a ping command inside the Virtual Network:</span></span>

   ```PowerShell
    netsh advfirewall firewall set rule dir=in name="File and Printer Sharing (Echo Request - ICMPv4-In)" new enable=yes
   ``` 
5. <span data-ttu-id="2e011-191">Pokud virtuální počítač bude součástí domény, zkontrolujte následující nastavení a ujistěte se, že předchozí nastavení se nevrátí.</span><span class="sxs-lookup"><span data-stu-id="2e011-191">If the VM  will be part of a Domain, check the following settings to make sure that the former settings are not reverted.</span></span> <span data-ttu-id="2e011-192">AD zásady, které se musí kontrolovat jsou následující:</span><span class="sxs-lookup"><span data-stu-id="2e011-192">The AD policies that must be checked are the following:</span></span>

    - <span data-ttu-id="2e011-193">Povolení profilů brány Windows Firewall</span><span class="sxs-lookup"><span data-stu-id="2e011-193">Enable the Windows Firewall profiles</span></span>

        <span data-ttu-id="2e011-194">Počítač Konfigurace uživatele\Zásady\Nastavení systému Settings\Administrative správu\Síť\Síťová Connection\Windows Firewall\Domain Profile\Windows brány Firewall: **chránit všechna síťová připojení**</span><span class="sxs-lookup"><span data-stu-id="2e011-194">Computer Configuration\Policies\Windows Settings\Administrative Templates\Network\Network Connection\Windows Firewall\Domain Profile\Windows Firewall: **Protect all network connections**</span></span>

       <span data-ttu-id="2e011-195">Počítač Konfigurace uživatele\Zásady\Nastavení systému Settings\Administrative správu\Síť\Síťová Connection\Windows Firewall\Standard Profile\Windows brány Firewall: **chránit všechna síťová připojení**</span><span class="sxs-lookup"><span data-stu-id="2e011-195">Computer Configuration\Policies\Windows Settings\Administrative Templates\Network\Network Connection\Windows Firewall\Standard Profile\Windows Firewall: **Protect all network connections**</span></span>

    - <span data-ttu-id="2e011-196">Povolení protokolu RDP</span><span class="sxs-lookup"><span data-stu-id="2e011-196">Enable RDP</span></span> 

        <span data-ttu-id="2e011-197">Počítač Konfigurace uživatele\Zásady\Nastavení systému Settings\Administrative správu\Síť\Síťová Connection\Windows Firewall\Domain Profile\Windows brány Firewall: **povolit příchozí výjimky vzdálené plochy**</span><span class="sxs-lookup"><span data-stu-id="2e011-197">Computer Configuration\Policies\Windows Settings\Administrative Templates\Network\Network Connection\Windows Firewall\Domain Profile\Windows Firewall: **Allow inbound Remote Desktop exceptions**</span></span>

        <span data-ttu-id="2e011-198">Počítač Konfigurace uživatele\Zásady\Nastavení systému Settings\Administrative správu\Síť\Síťová Connection\Windows Firewall\Standard Profile\Windows brány Firewall: **povolit příchozí výjimky vzdálené plochy**</span><span class="sxs-lookup"><span data-stu-id="2e011-198">Computer Configuration\Policies\Windows Settings\Administrative Templates\Network\Network Connection\Windows Firewall\Standard Profile\Windows Firewall: **Allow inbound Remote Desktop exceptions**</span></span>

    - <span data-ttu-id="2e011-199">Povolit protokol ICMP V4</span><span class="sxs-lookup"><span data-stu-id="2e011-199">Enable ICMP-V4</span></span>

        <span data-ttu-id="2e011-200">Počítač Konfigurace uživatele\Zásady\Nastavení systému Settings\Administrative správu\Síť\Síťová Connection\Windows Firewall\Domain Profile\Windows brány Firewall: **povolit výjimky protokolu ICMP**</span><span class="sxs-lookup"><span data-stu-id="2e011-200">Computer Configuration\Policies\Windows Settings\Administrative Templates\Network\Network Connection\Windows Firewall\Domain Profile\Windows Firewall: **Allow ICMP exceptions**</span></span>

        <span data-ttu-id="2e011-201">Počítač Konfigurace uživatele\Zásady\Nastavení systému Settings\Administrative správu\Síť\Síťová Connection\Windows Firewall\Standard Profile\Windows brány Firewall: **povolit výjimky protokolu ICMP**</span><span class="sxs-lookup"><span data-stu-id="2e011-201">Computer Configuration\Policies\Windows Settings\Administrative Templates\Network\Network Connection\Windows Firewall\Standard Profile\Windows Firewall: **Allow ICMP exceptions**</span></span>

## <a name="verify-vm-is-healthy-secure-and-accessible-with-rdp"></a><span data-ttu-id="2e011-202">Ověřte, zda že virtuální počítač je v pořádku, zabezpečenou a přístupné pomocí protokolu RDP</span><span class="sxs-lookup"><span data-stu-id="2e011-202">Verify VM is healthy, secure, and accessible with RDP</span></span> 
1. <span data-ttu-id="2e011-203">Pokud chcete mít jistotu, že disk je v pořádku a konzistentní, spusťte disková operace kontroly v dalším restartování virtuálního počítače:</span><span class="sxs-lookup"><span data-stu-id="2e011-203">To make sure the disk is healthy and consistent, run a check disk operation at the next VM restart:</span></span>

    ```PowerShell
    Chkdsk /f
    ```
    <span data-ttu-id="2e011-204">Ujistěte se, že tato sestava zobrazuje v pořádku a vyčištění disku.</span><span class="sxs-lookup"><span data-stu-id="2e011-204">Make sure that the report shows a clean and healthy disk.</span></span>

2. <span data-ttu-id="2e011-205">Nastavení konfiguračních dat spouštění (BCD).</span><span class="sxs-lookup"><span data-stu-id="2e011-205">Set the Boot Configuration Data (BCD) settings.</span></span> 

    > [!Note]
    > <span data-ttu-id="2e011-206">Zajistěte, aby spuštění těchto příkazů v okně CMD se zvýšenými oprávněními a **není** na prostředí PowerShell:</span><span class="sxs-lookup"><span data-stu-id="2e011-206">Make sure you run these commands on an elevated CMD window and **NOT** on PowerShell:</span></span>
   
   ```CMD
   bcdedit /set {bootmgr} integrityservices enable
   
   bcdedit /set {default} device partition=C:
   
   bcdedit /set {default} integrityservices enable
   
   bcdedit /set {default} recoveryenabled Off
   
   bcdedit /set {default} osdevice partition=C:
   
   bcdedit /set {default} bootstatuspolicy IgnoreAllFailures
   ```
3. <span data-ttu-id="2e011-207">Ověřte, že úložiště Windows Management Instrumentations konzistentní.</span><span class="sxs-lookup"><span data-stu-id="2e011-207">Verify that the Windows Management Instrumentations repository is consistent.</span></span> <span data-ttu-id="2e011-208">Chcete-li to provést, spusťte následující příkaz:</span><span class="sxs-lookup"><span data-stu-id="2e011-208">To perform this, run the following command:</span></span>

    ```PowerShell
    winmgmt /verifyrepository
    ```
    <span data-ttu-id="2e011-209">Pokud úložiště je poškozený, přečtěte si téma [rozhraní WMI: poškození úložiště, nebo Ne](https://blogs.technet.microsoft.com/askperf/2014/08/08/wmi-repository-corruption-or-not).</span><span class="sxs-lookup"><span data-stu-id="2e011-209">If the repository is corrupted, see [WMI: Repository Corruption, or Not](https://blogs.technet.microsoft.com/askperf/2014/08/08/wmi-repository-corruption-or-not).</span></span>

4. <span data-ttu-id="2e011-210">Ujistěte se, že není jiná aplikace pomocí portu 3389.</span><span class="sxs-lookup"><span data-stu-id="2e011-210">Make sure that any other application is not using the port 3389.</span></span> <span data-ttu-id="2e011-211">Tento port se používá pro službu protokolu RDP v Azure.</span><span class="sxs-lookup"><span data-stu-id="2e011-211">This port is used for the RDP service in Azure.</span></span> <span data-ttu-id="2e011-212">Můžete spustit **netstat - anob** zobrazíte v používaných portů ve virtuálním počítači:</span><span class="sxs-lookup"><span data-stu-id="2e011-212">You can run **netstat -anob** to see which ports are in used on the VM:</span></span>

    ```PowerShell
    netstat -anob
    ```

5. <span data-ttu-id="2e011-213">Pokud virtuální pevný disk systému Windows, který chcete nahrát je řadič domény, postupujte podle těchto kroků:</span><span class="sxs-lookup"><span data-stu-id="2e011-213">If the Windows VHD that you want to upload is a domain controller, then follow these steps:</span></span>

    <span data-ttu-id="2e011-214">A.</span><span class="sxs-lookup"><span data-stu-id="2e011-214">A.</span></span> <span data-ttu-id="2e011-215">Postupujte podle [tyto další kroky](https://support.microsoft.com/kb/2904015) Příprava disku.</span><span class="sxs-lookup"><span data-stu-id="2e011-215">Follow [these extra steps](https://support.microsoft.com/kb/2904015) to prepare the disk.</span></span>

    <span data-ttu-id="2e011-216">B.</span><span class="sxs-lookup"><span data-stu-id="2e011-216">B.</span></span> <span data-ttu-id="2e011-217">Zajistěte, aby v případě, že budete muset spustit virtuální počítač v režimu obnovení adresářových služeb v určitém okamžiku znát heslo režimu obnovení adresářových služeb.</span><span class="sxs-lookup"><span data-stu-id="2e011-217">Make sure that you know the DSRM password in case you have to start the VM in DSRM at some point.</span></span> <span data-ttu-id="2e011-218">Můžete chtít odkazovat na tento odkaz nastavit [heslo režimu obnovení adresářových služeb](https://technet.microsoft.com/library/cc754363(v=ws.11).aspx).</span><span class="sxs-lookup"><span data-stu-id="2e011-218">You may want to refer to this link to set the [DSRM password](https://technet.microsoft.com/library/cc754363(v=ws.11).aspx).</span></span>

6. <span data-ttu-id="2e011-219">Ujistěte se, že jsou pro vás známé předdefinovaného účtu Administrator a heslo.</span><span class="sxs-lookup"><span data-stu-id="2e011-219">Make sure that the Built-in Administrator account and password are known to you.</span></span> <span data-ttu-id="2e011-220">Můžete obnovit aktuální heslo místního správce a ujistěte se, že můžete tento účet pro přihlášení k systému Windows přes připojení RDP.</span><span class="sxs-lookup"><span data-stu-id="2e011-220">You may want to reset the current local administrator password and make sure that you can use this account to sign in to Windows through the RDP connection.</span></span> <span data-ttu-id="2e011-221">Objekt zásad skupiny "Povolit přihlášení prostřednictvím vzdálené plochy" řídí toto oprávnění přístupu.</span><span class="sxs-lookup"><span data-stu-id="2e011-221">This access permission is controlled by the "Allow log on through Remote Desktop Services" Group Policy object.</span></span> <span data-ttu-id="2e011-222">Tento objekt můžete zobrazit v editoru zásad skupiny místní v části:</span><span class="sxs-lookup"><span data-stu-id="2e011-222">You can view this object in the Local Group Policy Editor under:</span></span>

    <span data-ttu-id="2e011-223">Počítač Konfigurace počítače\Nastavení systému Windows\Nastavení Settings\Local přiřazení uživatelských práv</span><span class="sxs-lookup"><span data-stu-id="2e011-223">Computer Configuration\Windows Settings\Security Settings\Local Policies\User Rights Assignment</span></span>

7. <span data-ttu-id="2e011-224">Zkontrolujte následující AD zásady a ujistěte se, že nejsou blokuje přístup RDP prostřednictvím protokolu RDP ani ze sítě:</span><span class="sxs-lookup"><span data-stu-id="2e011-224">Check the following AD polices to make sure that you are not blocking your RDP access through RDP nor from the network:</span></span>

    - <span data-ttu-id="2e011-225">Konfigurace počítače\Nastavení systému Windows\Nastavení Settings\Local Policies\User Rights Assignment\Deny přístup počítačů k tomuto počítači ze sítě.</span><span class="sxs-lookup"><span data-stu-id="2e011-225">Computer Configuration\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Deny access to this computer from the network</span></span>

    - <span data-ttu-id="2e011-226">Počítač Konfigurace počítače\Nastavení systému Windows\Nastavení Settings\Local Policies\User Rights Assignment\Deny přihlášení prostřednictvím vzdálené plochy</span><span class="sxs-lookup"><span data-stu-id="2e011-226">Computer Configuration\Windows Settings\Security Settings\Local Policies\User Rights Assignment\Deny log on through Remote Desktop Services</span></span>


8. <span data-ttu-id="2e011-227">Restartování virtuálního počítače a ujistěte se, že je stále v pořádku Windows jsou dostupné přes připojení RDP.</span><span class="sxs-lookup"><span data-stu-id="2e011-227">Restart the VM to make sure that Windows is still healthy can be reached by using the RDP connection.</span></span> <span data-ttu-id="2e011-228">V tomto okamžiku můžete vytvořit virtuální počítač s vaší místní Hyper-v a ujistěte se, že virtuální počítač se spouští úplně pak otestovat, zda je dostupný protokolu RDP.</span><span class="sxs-lookup"><span data-stu-id="2e011-228">At this point, you may want to create a VM in your local Hyper-V to make sure the VM is starting completely and then test whether it is RDP reachable.</span></span>

9. <span data-ttu-id="2e011-229">Odeberte všechny filtry navíc rozhraní TDI, jako je například software, která analyzuje TCP paketů nebo další brány firewall.</span><span class="sxs-lookup"><span data-stu-id="2e011-229">Remove any extra Transport Driver Interface filters, such as software that analyzes TCP packets or extra firewalls.</span></span> <span data-ttu-id="2e011-230">Můžete také zkontrolovat to v pozdější fázi po nasazení virtuálního počítače v Azure v případě potřeby.</span><span class="sxs-lookup"><span data-stu-id="2e011-230">You can also review this on a later stage after the VM is deployed in Azure if needed.</span></span>

10. <span data-ttu-id="2e011-231">Odinstalujte všechny ostatní software třetích stran a ovladač, který se vztahuje k fyzické komponenty nebo jakoukoli jinou technologii virtualizace.</span><span class="sxs-lookup"><span data-stu-id="2e011-231">Uninstall any other third-party software and driver that is related to physical components or any other virtualization technology.</span></span>

### <a name="install-windows-updates"></a><span data-ttu-id="2e011-232">Instalace aktualizací systému Windows</span><span class="sxs-lookup"><span data-stu-id="2e011-232">Install Windows Updates</span></span>
<span data-ttu-id="2e011-233">Ideální konfigurace **mít počítač na nejnovější úroveň opravy**.</span><span class="sxs-lookup"><span data-stu-id="2e011-233">The ideal configuration is to **have the patch level of the machine at the latest**.</span></span> <span data-ttu-id="2e011-234">Pokud to není možné, ujistěte se, zda jsou nainstalovány následující aktualizace:</span><span class="sxs-lookup"><span data-stu-id="2e011-234">If this is not possible, make sure that the following updates are installed:</span></span>

|                       |                   |           |                                       <span data-ttu-id="2e011-235">Minimální verze x64</span><span class="sxs-lookup"><span data-stu-id="2e011-235">Minimum file version x64</span></span>       |                                      |                                      |                            |
|-------------------------|-------------------|------------------------------------|---------------------------------------------|--------------------------------------|--------------------------------------|----------------------------|
| <span data-ttu-id="2e011-236">Komponenta</span><span class="sxs-lookup"><span data-stu-id="2e011-236">Component</span></span>               | <span data-ttu-id="2e011-237">Binární</span><span class="sxs-lookup"><span data-stu-id="2e011-237">Binary</span></span>            | <span data-ttu-id="2e011-238">Windows 7 a Windows Server 2008 R2</span><span class="sxs-lookup"><span data-stu-id="2e011-238">Windows 7 & Windows Server 2008 R2</span></span> | <span data-ttu-id="2e011-239">Windows 8 a Windows Server 2012</span><span class="sxs-lookup"><span data-stu-id="2e011-239">Windows 8 & Windows Server 2012</span></span>             | <span data-ttu-id="2e011-240">Windows 8.1 a Windows Server 2012 R2</span><span class="sxs-lookup"><span data-stu-id="2e011-240">Windows 8.1 & Windows Server 2012 R2</span></span> | <span data-ttu-id="2e011-241">Windows 10 a Windows Server 2016 RS1</span><span class="sxs-lookup"><span data-stu-id="2e011-241">Windows 10 & Windows Server 2016 RS1</span></span> | <span data-ttu-id="2e011-242">RS2 Windows 10</span><span class="sxs-lookup"><span data-stu-id="2e011-242">Windows 10 RS2</span></span>             |
| <span data-ttu-id="2e011-243">Úložiště</span><span class="sxs-lookup"><span data-stu-id="2e011-243">Storage</span></span>                 | <span data-ttu-id="2e011-244">disk.sys</span><span class="sxs-lookup"><span data-stu-id="2e011-244">disk.sys</span></span>          | <span data-ttu-id="2e011-245">6.1.7601.23403 - KB3125574</span><span class="sxs-lookup"><span data-stu-id="2e011-245">6.1.7601.23403 - KB3125574</span></span>         | <span data-ttu-id="2e011-246">6.2.9200.17638 / 6.2.9200.21757 - KB3137061</span><span class="sxs-lookup"><span data-stu-id="2e011-246">6.2.9200.17638 / 6.2.9200.21757 - KB3137061</span></span> | <span data-ttu-id="2e011-247">6.3.9600.18203 - KB3137061</span><span class="sxs-lookup"><span data-stu-id="2e011-247">6.3.9600.18203 - KB3137061</span></span>           | -                                    | -                          |
|                         | <span data-ttu-id="2e011-248">Storport.sys</span><span class="sxs-lookup"><span data-stu-id="2e011-248">storport.sys</span></span>      | <span data-ttu-id="2e011-249">6.1.7601.23403 - KB3125574</span><span class="sxs-lookup"><span data-stu-id="2e011-249">6.1.7601.23403 - KB3125574</span></span>         | <span data-ttu-id="2e011-250">6.2.9200.17188 / 6.2.9200.21306 - KB3018489</span><span class="sxs-lookup"><span data-stu-id="2e011-250">6.2.9200.17188 / 6.2.9200.21306 - KB3018489</span></span> | <span data-ttu-id="2e011-251">6.3.9600.18573 - KB4022726</span><span class="sxs-lookup"><span data-stu-id="2e011-251">6.3.9600.18573 - KB4022726</span></span>           | <span data-ttu-id="2e011-252">10.0.14393.1358 - KB4022715</span><span class="sxs-lookup"><span data-stu-id="2e011-252">10.0.14393.1358 - KB4022715</span></span>          | <span data-ttu-id="2e011-253">10.0.15063.332</span><span class="sxs-lookup"><span data-stu-id="2e011-253">10.0.15063.332</span></span>             |
|                         | <span data-ttu-id="2e011-254">NTFS.sys</span><span class="sxs-lookup"><span data-stu-id="2e011-254">ntfs.sys</span></span>          | <span data-ttu-id="2e011-255">6.1.7601.23403 - KB3125574</span><span class="sxs-lookup"><span data-stu-id="2e011-255">6.1.7601.23403 - KB3125574</span></span>         | <span data-ttu-id="2e011-256">6.2.9200.17623 / 6.2.9200.21743 - KB3121255</span><span class="sxs-lookup"><span data-stu-id="2e011-256">6.2.9200.17623 / 6.2.9200.21743 - KB3121255</span></span> | <span data-ttu-id="2e011-257">6.3.9600.18654 - KB4022726</span><span class="sxs-lookup"><span data-stu-id="2e011-257">6.3.9600.18654 - KB4022726</span></span>           | <span data-ttu-id="2e011-258">10.0.14393.1198 - KB4022715</span><span class="sxs-lookup"><span data-stu-id="2e011-258">10.0.14393.1198 - KB4022715</span></span>          | <span data-ttu-id="2e011-259">10.0.15063.447</span><span class="sxs-lookup"><span data-stu-id="2e011-259">10.0.15063.447</span></span>             |
|                         | <span data-ttu-id="2e011-260">Iologmsg.dll</span><span class="sxs-lookup"><span data-stu-id="2e011-260">Iologmsg.dll</span></span>      | <span data-ttu-id="2e011-261">6.1.7601.23403 - KB3125574</span><span class="sxs-lookup"><span data-stu-id="2e011-261">6.1.7601.23403 - KB3125574</span></span>         | <span data-ttu-id="2e011-262">6.2.9200.16384 - KB2995387</span><span class="sxs-lookup"><span data-stu-id="2e011-262">6.2.9200.16384 - KB2995387</span></span>                  | -                                    | -                                    | -                          |
|                         | <span data-ttu-id="2e011-263">Classpnp.sys</span><span class="sxs-lookup"><span data-stu-id="2e011-263">Classpnp.sys</span></span>      | <span data-ttu-id="2e011-264">6.1.7601.23403 - KB3125574</span><span class="sxs-lookup"><span data-stu-id="2e011-264">6.1.7601.23403 - KB3125574</span></span>         | <span data-ttu-id="2e011-265">6.2.9200.17061 / 6.2.9200.21180 - KB2995387</span><span class="sxs-lookup"><span data-stu-id="2e011-265">6.2.9200.17061 / 6.2.9200.21180 - KB2995387</span></span> | <span data-ttu-id="2e011-266">6.3.9600.18334 - KB3172614</span><span class="sxs-lookup"><span data-stu-id="2e011-266">6.3.9600.18334 - KB3172614</span></span>           | <span data-ttu-id="2e011-267">10.0.14393.953 - KB4022715</span><span class="sxs-lookup"><span data-stu-id="2e011-267">10.0.14393.953 - KB4022715</span></span>           | -                          |
|                         | <span data-ttu-id="2e011-268">Volsnap.sys</span><span class="sxs-lookup"><span data-stu-id="2e011-268">Volsnap.sys</span></span>       | <span data-ttu-id="2e011-269">6.1.7601.23403 - KB3125574</span><span class="sxs-lookup"><span data-stu-id="2e011-269">6.1.7601.23403 - KB3125574</span></span>         | <span data-ttu-id="2e011-270">6.2.9200.17047 / 6.2.9200.21165 - KB2975331</span><span class="sxs-lookup"><span data-stu-id="2e011-270">6.2.9200.17047 / 6.2.9200.21165 - KB2975331</span></span> | <span data-ttu-id="2e011-271">6.3.9600.18265 - KB3145384</span><span class="sxs-lookup"><span data-stu-id="2e011-271">6.3.9600.18265 - KB3145384</span></span>           | -                                    | <span data-ttu-id="2e011-272">10.0.15063.0</span><span class="sxs-lookup"><span data-stu-id="2e011-272">10.0.15063.0</span></span>               |
|                         | <span data-ttu-id="2e011-273">PartMgr.sys</span><span class="sxs-lookup"><span data-stu-id="2e011-273">partmgr.sys</span></span>       | <span data-ttu-id="2e011-274">6.1.7601.23403 - KB3125574</span><span class="sxs-lookup"><span data-stu-id="2e011-274">6.1.7601.23403 - KB3125574</span></span>         | <span data-ttu-id="2e011-275">6.2.9200.16681 - KB2877114</span><span class="sxs-lookup"><span data-stu-id="2e011-275">6.2.9200.16681 - KB2877114</span></span>                  | <span data-ttu-id="2e011-276">6.3.9600.17401 - KB3000850</span><span class="sxs-lookup"><span data-stu-id="2e011-276">6.3.9600.17401 - KB3000850</span></span>           | <span data-ttu-id="2e011-277">10.0.14393.953 - KB4022715</span><span class="sxs-lookup"><span data-stu-id="2e011-277">10.0.14393.953 - KB4022715</span></span>           | <span data-ttu-id="2e011-278">10.0.15063.0</span><span class="sxs-lookup"><span data-stu-id="2e011-278">10.0.15063.0</span></span>               |
|                         | <span data-ttu-id="2e011-279">volmgr.sys</span><span class="sxs-lookup"><span data-stu-id="2e011-279">volmgr.sys</span></span>        |                                    |                                             |                                      |                                      | <span data-ttu-id="2e011-280">10.0.15063.0</span><span class="sxs-lookup"><span data-stu-id="2e011-280">10.0.15063.0</span></span>               |
|                         | <span data-ttu-id="2e011-281">Volmgrx.sys</span><span class="sxs-lookup"><span data-stu-id="2e011-281">Volmgrx.sys</span></span>       | <span data-ttu-id="2e011-282">6.1.7601.23403 - KB3125574</span><span class="sxs-lookup"><span data-stu-id="2e011-282">6.1.7601.23403 - KB3125574</span></span>         | -                                           | -                                    | -                                    | <span data-ttu-id="2e011-283">10.0.15063.0</span><span class="sxs-lookup"><span data-stu-id="2e011-283">10.0.15063.0</span></span>               |
|                         | <span data-ttu-id="2e011-284">Msiscsi.sys</span><span class="sxs-lookup"><span data-stu-id="2e011-284">Msiscsi.sys</span></span>       | <span data-ttu-id="2e011-285">6.1.7601.23403 - KB3125574</span><span class="sxs-lookup"><span data-stu-id="2e011-285">6.1.7601.23403 - KB3125574</span></span>         | <span data-ttu-id="2e011-286">6.2.9200.21006 - KB2955163</span><span class="sxs-lookup"><span data-stu-id="2e011-286">6.2.9200.21006 - KB2955163</span></span>                  | <span data-ttu-id="2e011-287">6.3.9600.18624 - KB4022726</span><span class="sxs-lookup"><span data-stu-id="2e011-287">6.3.9600.18624 - KB4022726</span></span>           | <span data-ttu-id="2e011-288">10.0.14393.1066 - KB4022715</span><span class="sxs-lookup"><span data-stu-id="2e011-288">10.0.14393.1066 - KB4022715</span></span>          | <span data-ttu-id="2e011-289">10.0.15063.447</span><span class="sxs-lookup"><span data-stu-id="2e011-289">10.0.15063.447</span></span>             |
|                         | <span data-ttu-id="2e011-290">MSDSM.sys</span><span class="sxs-lookup"><span data-stu-id="2e011-290">Msdsm.sys</span></span>         | <span data-ttu-id="2e011-291">6.1.7601.23403 - KB3125574</span><span class="sxs-lookup"><span data-stu-id="2e011-291">6.1.7601.23403 - KB3125574</span></span>         | <span data-ttu-id="2e011-292">6.2.9200.21474 - KB3046101</span><span class="sxs-lookup"><span data-stu-id="2e011-292">6.2.9200.21474 - KB3046101</span></span>                  | <span data-ttu-id="2e011-293">6.3.9600.18592 - KB4022726</span><span class="sxs-lookup"><span data-stu-id="2e011-293">6.3.9600.18592 - KB4022726</span></span>           | -                                    | -                          |
|                         | <span data-ttu-id="2e011-294">MPIO.sys</span><span class="sxs-lookup"><span data-stu-id="2e011-294">Mpio.sys</span></span>          | <span data-ttu-id="2e011-295">6.1.7601.23403 - KB3125574</span><span class="sxs-lookup"><span data-stu-id="2e011-295">6.1.7601.23403 - KB3125574</span></span>         | <span data-ttu-id="2e011-296">6.2.9200.21190 - KB3046101</span><span class="sxs-lookup"><span data-stu-id="2e011-296">6.2.9200.21190 - KB3046101</span></span>                  | <span data-ttu-id="2e011-297">6.3.9600.18616 - KB4022726</span><span class="sxs-lookup"><span data-stu-id="2e011-297">6.3.9600.18616 - KB4022726</span></span>           | <span data-ttu-id="2e011-298">10.0.14393.1198 - KB4022715</span><span class="sxs-lookup"><span data-stu-id="2e011-298">10.0.14393.1198 - KB4022715</span></span>          | -                          |
|                         | <span data-ttu-id="2e011-299">Fveapi.dll</span><span class="sxs-lookup"><span data-stu-id="2e011-299">Fveapi.dll</span></span>        | <span data-ttu-id="2e011-300">6.1.7601.23311 - KB3125574</span><span class="sxs-lookup"><span data-stu-id="2e011-300">6.1.7601.23311 - KB3125574</span></span>         | <span data-ttu-id="2e011-301">6.2.9200.20930 - KB2930244</span><span class="sxs-lookup"><span data-stu-id="2e011-301">6.2.9200.20930 - KB2930244</span></span>                  | <span data-ttu-id="2e011-302">6.3.9600.18294 - KB3172614</span><span class="sxs-lookup"><span data-stu-id="2e011-302">6.3.9600.18294 - KB3172614</span></span>           | <span data-ttu-id="2e011-303">10.0.14393.576 - KB4022715</span><span class="sxs-lookup"><span data-stu-id="2e011-303">10.0.14393.576 - KB4022715</span></span>           | -                          |
|                         | <span data-ttu-id="2e011-304">Fveapibase.dll</span><span class="sxs-lookup"><span data-stu-id="2e011-304">Fveapibase.dll</span></span>    | <span data-ttu-id="2e011-305">6.1.7601.23403 - KB3125574</span><span class="sxs-lookup"><span data-stu-id="2e011-305">6.1.7601.23403 - KB3125574</span></span>         | <span data-ttu-id="2e011-306">6.2.9200.20930 - KB2930244</span><span class="sxs-lookup"><span data-stu-id="2e011-306">6.2.9200.20930 - KB2930244</span></span>                  | <span data-ttu-id="2e011-307">6.3.9600.17415 - KB3172614</span><span class="sxs-lookup"><span data-stu-id="2e011-307">6.3.9600.17415 - KB3172614</span></span>           | <span data-ttu-id="2e011-308">10.0.14393.206 - KB4022715</span><span class="sxs-lookup"><span data-stu-id="2e011-308">10.0.14393.206 - KB4022715</span></span>           | -                          |
| <span data-ttu-id="2e011-309">Síť</span><span class="sxs-lookup"><span data-stu-id="2e011-309">Network</span></span>                 | <span data-ttu-id="2e011-310">netvsc.sys</span><span class="sxs-lookup"><span data-stu-id="2e011-310">netvsc.sys</span></span>        | -                                  | -                                           | -                                    | <span data-ttu-id="2e011-311">10.0.14393.1198 - KB4022715</span><span class="sxs-lookup"><span data-stu-id="2e011-311">10.0.14393.1198 - KB4022715</span></span>          | <span data-ttu-id="2e011-312">10.0.15063.250 - KB4020001</span><span class="sxs-lookup"><span data-stu-id="2e011-312">10.0.15063.250 - KB4020001</span></span> |
|                         | <span data-ttu-id="2e011-313">mrxsmb10.sys</span><span class="sxs-lookup"><span data-stu-id="2e011-313">mrxsmb10.sys</span></span>      | <span data-ttu-id="2e011-314">6.1.7601.23816 - KB4022722</span><span class="sxs-lookup"><span data-stu-id="2e011-314">6.1.7601.23816 - KB4022722</span></span>         | <span data-ttu-id="2e011-315">6.2.9200.22108 - KB4022724</span><span class="sxs-lookup"><span data-stu-id="2e011-315">6.2.9200.22108 - KB4022724</span></span>                  | <span data-ttu-id="2e011-316">6.3.9600.18603 - KB4022726</span><span class="sxs-lookup"><span data-stu-id="2e011-316">6.3.9600.18603 - KB4022726</span></span>           | <span data-ttu-id="2e011-317">10.0.14393.479 - KB4022715</span><span class="sxs-lookup"><span data-stu-id="2e011-317">10.0.14393.479 - KB4022715</span></span>           | <span data-ttu-id="2e011-318">10.0.15063.483</span><span class="sxs-lookup"><span data-stu-id="2e011-318">10.0.15063.483</span></span>             |
|                         | <span data-ttu-id="2e011-319">mrxsmb20.sys</span><span class="sxs-lookup"><span data-stu-id="2e011-319">mrxsmb20.sys</span></span>      | <span data-ttu-id="2e011-320">6.1.7601.23816 - KB4022722</span><span class="sxs-lookup"><span data-stu-id="2e011-320">6.1.7601.23816 - KB4022722</span></span>         | <span data-ttu-id="2e011-321">6.2.9200.21548 - KB4022724</span><span class="sxs-lookup"><span data-stu-id="2e011-321">6.2.9200.21548 - KB4022724</span></span>                  | <span data-ttu-id="2e011-322">6.3.9600.18586 - KB4022726</span><span class="sxs-lookup"><span data-stu-id="2e011-322">6.3.9600.18586 - KB4022726</span></span>           | <span data-ttu-id="2e011-323">10.0.14393.953 - KB4022715</span><span class="sxs-lookup"><span data-stu-id="2e011-323">10.0.14393.953 - KB4022715</span></span>           | <span data-ttu-id="2e011-324">10.0.15063.483</span><span class="sxs-lookup"><span data-stu-id="2e011-324">10.0.15063.483</span></span>             |
|                         | <span data-ttu-id="2e011-325">Mrxsmb.sys</span><span class="sxs-lookup"><span data-stu-id="2e011-325">mrxsmb.sys</span></span>        | <span data-ttu-id="2e011-326">6.1.7601.23816 - KB4022722</span><span class="sxs-lookup"><span data-stu-id="2e011-326">6.1.7601.23816 - KB4022722</span></span>         | <span data-ttu-id="2e011-327">6.2.9200.22074 - KB4022724</span><span class="sxs-lookup"><span data-stu-id="2e011-327">6.2.9200.22074 - KB4022724</span></span>                  | <span data-ttu-id="2e011-328">6.3.9600.18586 - KB4022726</span><span class="sxs-lookup"><span data-stu-id="2e011-328">6.3.9600.18586 - KB4022726</span></span>           | <span data-ttu-id="2e011-329">10.0.14393.953 - KB4022715</span><span class="sxs-lookup"><span data-stu-id="2e011-329">10.0.14393.953 - KB4022715</span></span>           | <span data-ttu-id="2e011-330">10.0.15063.0</span><span class="sxs-lookup"><span data-stu-id="2e011-330">10.0.15063.0</span></span>               |
|                         | <span data-ttu-id="2e011-331">aktualizace</span><span class="sxs-lookup"><span data-stu-id="2e011-331">tcpip.sys</span></span>         | <span data-ttu-id="2e011-332">6.1.7601.23761 - KB4022722</span><span class="sxs-lookup"><span data-stu-id="2e011-332">6.1.7601.23761 - KB4022722</span></span>         | <span data-ttu-id="2e011-333">6.2.9200.22070 - KB4022724</span><span class="sxs-lookup"><span data-stu-id="2e011-333">6.2.9200.22070 - KB4022724</span></span>                  | <span data-ttu-id="2e011-334">6.3.9600.18478 - KB4022726</span><span class="sxs-lookup"><span data-stu-id="2e011-334">6.3.9600.18478 - KB4022726</span></span>           | <span data-ttu-id="2e011-335">10.0.14393.1358 - KB4022715</span><span class="sxs-lookup"><span data-stu-id="2e011-335">10.0.14393.1358 - KB4022715</span></span>          | <span data-ttu-id="2e011-336">10.0.15063.447</span><span class="sxs-lookup"><span data-stu-id="2e011-336">10.0.15063.447</span></span>             |
|                         | <span data-ttu-id="2e011-337">ovladač HTTP.sys</span><span class="sxs-lookup"><span data-stu-id="2e011-337">http.sys</span></span>          | <span data-ttu-id="2e011-338">6.1.7601.23403 - KB3125574</span><span class="sxs-lookup"><span data-stu-id="2e011-338">6.1.7601.23403 - KB3125574</span></span>         | <span data-ttu-id="2e011-339">6.2.9200.17285 - KB3042553</span><span class="sxs-lookup"><span data-stu-id="2e011-339">6.2.9200.17285 - KB3042553</span></span>                  | <span data-ttu-id="2e011-340">6.3.9600.18574 - KB4022726</span><span class="sxs-lookup"><span data-stu-id="2e011-340">6.3.9600.18574 - KB4022726</span></span>           | <span data-ttu-id="2e011-341">10.0.14393.251 - KB4022715</span><span class="sxs-lookup"><span data-stu-id="2e011-341">10.0.14393.251 - KB4022715</span></span>           | <span data-ttu-id="2e011-342">10.0.15063.483</span><span class="sxs-lookup"><span data-stu-id="2e011-342">10.0.15063.483</span></span>             |
|                         | <span data-ttu-id="2e011-343">vmswitch.sys</span><span class="sxs-lookup"><span data-stu-id="2e011-343">vmswitch.sys</span></span>      | <span data-ttu-id="2e011-344">6.1.7601.23727 - KB4022719</span><span class="sxs-lookup"><span data-stu-id="2e011-344">6.1.7601.23727 - KB4022719</span></span>         | <span data-ttu-id="2e011-345">6.2.9200.22117 - KB4022724</span><span class="sxs-lookup"><span data-stu-id="2e011-345">6.2.9200.22117 - KB4022724</span></span>                  | <span data-ttu-id="2e011-346">6.3.9600.18654 - KB4022726</span><span class="sxs-lookup"><span data-stu-id="2e011-346">6.3.9600.18654 - KB4022726</span></span>           | <span data-ttu-id="2e011-347">10.0.14393.1358 - KB4022715</span><span class="sxs-lookup"><span data-stu-id="2e011-347">10.0.14393.1358 - KB4022715</span></span>          | <span data-ttu-id="2e011-348">10.0.15063.138</span><span class="sxs-lookup"><span data-stu-id="2e011-348">10.0.15063.138</span></span>             |
| <span data-ttu-id="2e011-349">Jádro</span><span class="sxs-lookup"><span data-stu-id="2e011-349">Core</span></span>                    | <span data-ttu-id="2e011-350">Ntoskrnl.exe</span><span class="sxs-lookup"><span data-stu-id="2e011-350">ntoskrnl.exe</span></span>      | <span data-ttu-id="2e011-351">6.1.7601.23807 - KB4022719</span><span class="sxs-lookup"><span data-stu-id="2e011-351">6.1.7601.23807 - KB4022719</span></span>         | <span data-ttu-id="2e011-352">6.2.9200.22170 - KB4022718</span><span class="sxs-lookup"><span data-stu-id="2e011-352">6.2.9200.22170 - KB4022718</span></span>                  | <span data-ttu-id="2e011-353">6.3.9600.18696 - KB4022726</span><span class="sxs-lookup"><span data-stu-id="2e011-353">6.3.9600.18696 - KB4022726</span></span>           | <span data-ttu-id="2e011-354">10.0.14393.1358 - KB4022715</span><span class="sxs-lookup"><span data-stu-id="2e011-354">10.0.14393.1358 - KB4022715</span></span>          | <span data-ttu-id="2e011-355">10.0.15063.483</span><span class="sxs-lookup"><span data-stu-id="2e011-355">10.0.15063.483</span></span>             |
| <span data-ttu-id="2e011-356">Vzdálená plocha</span><span class="sxs-lookup"><span data-stu-id="2e011-356">Remote Desktop Services</span></span> | <span data-ttu-id="2e011-357">rdpcorets.dll</span><span class="sxs-lookup"><span data-stu-id="2e011-357">rdpcorets.dll</span></span>     | <span data-ttu-id="2e011-358">6.2.9200.21506 - KB4022719</span><span class="sxs-lookup"><span data-stu-id="2e011-358">6.2.9200.21506 - KB4022719</span></span>         | <span data-ttu-id="2e011-359">6.2.9200.22104 - KB4022724</span><span class="sxs-lookup"><span data-stu-id="2e011-359">6.2.9200.22104 - KB4022724</span></span>                  | <span data-ttu-id="2e011-360">6.3.9600.18619 - KB4022726</span><span class="sxs-lookup"><span data-stu-id="2e011-360">6.3.9600.18619 - KB4022726</span></span>           | <span data-ttu-id="2e011-361">10.0.14393.1198 - KB4022715</span><span class="sxs-lookup"><span data-stu-id="2e011-361">10.0.14393.1198 - KB4022715</span></span>          | <span data-ttu-id="2e011-362">10.0.15063.0</span><span class="sxs-lookup"><span data-stu-id="2e011-362">10.0.15063.0</span></span>               |
|                         | <span data-ttu-id="2e011-363">TERMSRV.dll</span><span class="sxs-lookup"><span data-stu-id="2e011-363">termsrv.dll</span></span>       | <span data-ttu-id="2e011-364">6.1.7601.23403 - KB3125574</span><span class="sxs-lookup"><span data-stu-id="2e011-364">6.1.7601.23403 - KB3125574</span></span>         | <span data-ttu-id="2e011-365">6.2.9200.17048 - KB2973501</span><span class="sxs-lookup"><span data-stu-id="2e011-365">6.2.9200.17048 - KB2973501</span></span>                  | <span data-ttu-id="2e011-366">6.3.9600.17415 - KB3000850</span><span class="sxs-lookup"><span data-stu-id="2e011-366">6.3.9600.17415 - KB3000850</span></span>           | <span data-ttu-id="2e011-367">10.0.14393.0 - KB4022715</span><span class="sxs-lookup"><span data-stu-id="2e011-367">10.0.14393.0 - KB4022715</span></span>             | <span data-ttu-id="2e011-368">10.0.15063.0</span><span class="sxs-lookup"><span data-stu-id="2e011-368">10.0.15063.0</span></span>               |
|                         | <span data-ttu-id="2e011-369">termdd.sys</span><span class="sxs-lookup"><span data-stu-id="2e011-369">termdd.sys</span></span>        | <span data-ttu-id="2e011-370">6.1.7601.23403 - KB3125574</span><span class="sxs-lookup"><span data-stu-id="2e011-370">6.1.7601.23403 - KB3125574</span></span>         | -                                           | -                                    | -                                    | -                          |
|                         | <span data-ttu-id="2e011-371">Win32k.sys</span><span class="sxs-lookup"><span data-stu-id="2e011-371">win32k.sys</span></span>        | <span data-ttu-id="2e011-372">6.1.7601.23807 - KB4022719</span><span class="sxs-lookup"><span data-stu-id="2e011-372">6.1.7601.23807 - KB4022719</span></span>         | <span data-ttu-id="2e011-373">6.2.9200.22168 - KB4022718</span><span class="sxs-lookup"><span data-stu-id="2e011-373">6.2.9200.22168 - KB4022718</span></span>                  | <span data-ttu-id="2e011-374">6.3.9600.18698 - KB4022726</span><span class="sxs-lookup"><span data-stu-id="2e011-374">6.3.9600.18698 - KB4022726</span></span>           | <span data-ttu-id="2e011-375">10.0.14393.594 - KB4022715</span><span class="sxs-lookup"><span data-stu-id="2e011-375">10.0.14393.594 - KB4022715</span></span>           | -                          |
|                         | <span data-ttu-id="2e011-376">rdpdd.dll</span><span class="sxs-lookup"><span data-stu-id="2e011-376">rdpdd.dll</span></span>         | <span data-ttu-id="2e011-377">6.1.7601.23403 - KB3125574</span><span class="sxs-lookup"><span data-stu-id="2e011-377">6.1.7601.23403 - KB3125574</span></span>         | -                                           | -                                    | -                                    | -                          |
|                         | <span data-ttu-id="2e011-378">Rdpwd.sys</span><span class="sxs-lookup"><span data-stu-id="2e011-378">rdpwd.sys</span></span>         | <span data-ttu-id="2e011-379">6.1.7601.23403 - KB3125574</span><span class="sxs-lookup"><span data-stu-id="2e011-379">6.1.7601.23403 - KB3125574</span></span>         | -                                           | -                                    | -                                    | -                          |
| <span data-ttu-id="2e011-380">Zabezpečení</span><span class="sxs-lookup"><span data-stu-id="2e011-380">Security</span></span>                | <span data-ttu-id="2e011-381">Z důvodu WannaCrypt</span><span class="sxs-lookup"><span data-stu-id="2e011-381">Due to WannaCrypt</span></span> | <span data-ttu-id="2e011-382">KB4012212</span><span class="sxs-lookup"><span data-stu-id="2e011-382">KB4012212</span></span>                          | <span data-ttu-id="2e011-383">KB4012213</span><span class="sxs-lookup"><span data-stu-id="2e011-383">KB4012213</span></span>                                   | <span data-ttu-id="2e011-384">KB4012213</span><span class="sxs-lookup"><span data-stu-id="2e011-384">KB4012213</span></span>                            | <span data-ttu-id="2e011-385">KB4012606</span><span class="sxs-lookup"><span data-stu-id="2e011-385">KB4012606</span></span>                            | <span data-ttu-id="2e011-386">KB4012606</span><span class="sxs-lookup"><span data-stu-id="2e011-386">KB4012606</span></span>                  |
|                         |                   |                                    | <span data-ttu-id="2e011-387">KB4012216</span><span class="sxs-lookup"><span data-stu-id="2e011-387">KB4012216</span></span>                                   |                                      | <span data-ttu-id="2e011-388">KB4013198</span><span class="sxs-lookup"><span data-stu-id="2e011-388">KB4013198</span></span>                            | <span data-ttu-id="2e011-389">KB4013198</span><span class="sxs-lookup"><span data-stu-id="2e011-389">KB4013198</span></span>                  |
|                         |                   | <span data-ttu-id="2e011-390">KB4012215</span><span class="sxs-lookup"><span data-stu-id="2e011-390">KB4012215</span></span>                          | <span data-ttu-id="2e011-391">KB4012214</span><span class="sxs-lookup"><span data-stu-id="2e011-391">KB4012214</span></span>                                   | <span data-ttu-id="2e011-392">KB4012216</span><span class="sxs-lookup"><span data-stu-id="2e011-392">KB4012216</span></span>                            | <span data-ttu-id="2e011-393">KB4013429</span><span class="sxs-lookup"><span data-stu-id="2e011-393">KB4013429</span></span>                            | <span data-ttu-id="2e011-394">KB4013429</span><span class="sxs-lookup"><span data-stu-id="2e011-394">KB4013429</span></span>                  |
|                         |                   |                                    | <span data-ttu-id="2e011-395">KB4012217</span><span class="sxs-lookup"><span data-stu-id="2e011-395">KB4012217</span></span>                                   |                                      | <span data-ttu-id="2e011-396">KB4013429</span><span class="sxs-lookup"><span data-stu-id="2e011-396">KB4013429</span></span>                            | <span data-ttu-id="2e011-397">KB4013429</span><span class="sxs-lookup"><span data-stu-id="2e011-397">KB4013429</span></span>                  |
       
### <span data-ttu-id="2e011-398">Kdy použít nástroj sysprep<a id="step23"></a></span><span class="sxs-lookup"><span data-stu-id="2e011-398">When to use sysprep <a id="step23"></a></span></span>    

<span data-ttu-id="2e011-399">Nástroj Sysprep je proces, který můžete spustit do instalace systému windows, který resetuje instalace systému a budou tak poskytovat "ihned prostředí" odebráním všechna osobní data a resetování několik komponent.</span><span class="sxs-lookup"><span data-stu-id="2e011-399">Sysprep is a process that you could run into a windows installation that will reset the installation of the system and will provide an “out of the box experience” by removing all personal data and resetting several components.</span></span> <span data-ttu-id="2e011-400">Obvykle to uděláte Pokud chcete vytvořit šablonu, ze kterého můžete nasadit několik ostatních virtuálních počítačů, které mají určitou konfiguraci.</span><span class="sxs-lookup"><span data-stu-id="2e011-400">You typically do this if you want to create a template from which you can deploy several other VMs that have a specific configuration.</span></span> <span data-ttu-id="2e011-401">Tento postup se nazývá **zobecněn image**.</span><span class="sxs-lookup"><span data-stu-id="2e011-401">This is called a **generalized image**.</span></span>

<span data-ttu-id="2e011-402">Pokud místo toho chcete jenom pro účely vytvoření jeden virtuální počítač z jednoho disku, nemáte pomocí nástroje sysprep.</span><span class="sxs-lookup"><span data-stu-id="2e011-402">If, instead, you want only to create one VM from one disk, you don’t have to use sysprep.</span></span> <span data-ttu-id="2e011-403">V takovém případě můžete pouze vytvořit virtuální počítač z, která se označuje jako **specializované image**.</span><span class="sxs-lookup"><span data-stu-id="2e011-403">In this situation, you can just create the VM from what is known as a **specialized image**.</span></span>

<span data-ttu-id="2e011-404">Další informace o tom, jak vytvořit virtuální počítač z specializované disku najdete v tématu:</span><span class="sxs-lookup"><span data-stu-id="2e011-404">For more information about how to create a VM from a specialized disk, see:</span></span>

- [<span data-ttu-id="2e011-405">Vytvoření virtuálního počítače z specializované disku</span><span class="sxs-lookup"><span data-stu-id="2e011-405">Create a VM from a specialized disk</span></span>](create-vm-specialized.md)
- [<span data-ttu-id="2e011-406">Vytvoření virtuálního počítače z specializované disku VHD</span><span class="sxs-lookup"><span data-stu-id="2e011-406">Create a VM from a specialized VHD disk</span></span>](https://azure.microsoft.com/resources/templates/201-vm-specialized-vhd/)

<span data-ttu-id="2e011-407">Pokud chcete vytvořit bitovou kopii zobecněný, budete muset spustit nástroj sysprep.</span><span class="sxs-lookup"><span data-stu-id="2e011-407">If you want to create a generalized image, you need to run sysprep.</span></span> <span data-ttu-id="2e011-408">Další informace o nástroji Sysprep najdete v tématu [postup použití nástroje Sysprep: Úvod](http://technet.microsoft.com/library/bb457073.aspx).</span><span class="sxs-lookup"><span data-stu-id="2e011-408">For more information about Sysprep, see [How to Use Sysprep: An Introduction](http://technet.microsoft.com/library/bb457073.aspx).</span></span> 

<span data-ttu-id="2e011-409">Ne každý role nebo aplikace, který je nainstalován na počítači se systémem Windows podporuje tento generalizace.</span><span class="sxs-lookup"><span data-stu-id="2e011-409">Not every role or application that’s installed on a Windows-based computer supports this generalization.</span></span> <span data-ttu-id="2e011-410">Proto před spuštěním tohoto postupu, naleznete v následujícím článku, abyste měli jistotu, že role tento počítač podporuje nástroj sysprep.</span><span class="sxs-lookup"><span data-stu-id="2e011-410">So before you run this procedure, refer to the following article to make sure that the role of that computer is supported by sysprep.</span></span> <span data-ttu-id="2e011-411">Další informace najdete [podpora nástroje Sysprep pro role serveru](https://msdn.microsoft.com/windows/hardware/commercialize/manufacture/desktop/sysprep-support-for-server-roles).</span><span class="sxs-lookup"><span data-stu-id="2e011-411">For more information, [Sysprep Support for Server Roles](https://msdn.microsoft.com/windows/hardware/commercialize/manufacture/desktop/sysprep-support-for-server-roles).</span></span>

### <a name="steps-to-generalize-a-vhd"></a><span data-ttu-id="2e011-412">Postup generalize virtuální pevný disk</span><span class="sxs-lookup"><span data-stu-id="2e011-412">Steps to generalize a VHD</span></span>

>[!NOTE]
> <span data-ttu-id="2e011-413">Po spuštění sysprep.exe uvedeného v následujících krocích vypněte virtuální počítač a není znovu zapnout až do vytvoření bitové kopie z něj v Azure.</span><span class="sxs-lookup"><span data-stu-id="2e011-413">After you run sysprep.exe as specified  in the following steps, turn off the VM, and do not turn it back on until you create an image from it in Azure.</span></span>

1. <span data-ttu-id="2e011-414">Přihlaste se k systému Windows virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="2e011-414">Sign in to the Windows VM.</span></span>
2. <span data-ttu-id="2e011-415">Spustit **příkazového řádku** jako správce.</span><span class="sxs-lookup"><span data-stu-id="2e011-415">Run **Command Prompt** as an administrator.</span></span> 
3. <span data-ttu-id="2e011-416">Změňte adresář na: **%windir%\system32\sysprep**a poté spusťte **sysprep.exe**.</span><span class="sxs-lookup"><span data-stu-id="2e011-416">Change the directory to: **%windir%\system32\sysprep**, and then run **sysprep.exe**.</span></span>
3. <span data-ttu-id="2e011-417">V **nástroj pro přípravu systému** dialogové okno, vyberte **prostředí Out-of-Box zadejte systému (při prvním zapnutí)**a ujistěte se, že **generalizace** je zaškrtnuté políčko.</span><span class="sxs-lookup"><span data-stu-id="2e011-417">In the **System Preparation Tool** dialog box, select **Enter System Out-of-Box Experience (OOBE)**, and make sure that the **Generalize** check box is selected.</span></span>

    ![Nástroj pro přípravu systému](media/prepare-for-upload-vhd-image/syspre.png)
4. <span data-ttu-id="2e011-419">V **možnosti vypnutí**, vyberte **vypnutí**.</span><span class="sxs-lookup"><span data-stu-id="2e011-419">In **Shutdown Options**, select **Shutdown**.</span></span>
5. <span data-ttu-id="2e011-420">Klikněte na **OK**.</span><span class="sxs-lookup"><span data-stu-id="2e011-420">Click **OK**.</span></span>
6. <span data-ttu-id="2e011-421">Po dokončení nástroj Sysprep, vypněte virtuální počítač.</span><span class="sxs-lookup"><span data-stu-id="2e011-421">When Sysprep completes, shut down the VM.</span></span> <span data-ttu-id="2e011-422">Nepoužívejte **restartujte** vypnutí virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="2e011-422">Do not use **Restart** to shut down the VM.</span></span>
7. <span data-ttu-id="2e011-423">Virtuální pevný disk je nyní připraven k odeslání.</span><span class="sxs-lookup"><span data-stu-id="2e011-423">Now the VHD is ready to be uploaded.</span></span> <span data-ttu-id="2e011-424">Další informace o tom, jak vytvořit virtuální počítač z zobecněný disku najdete v tématu [nahrát zobecněný virtuální pevný disk a použít ho k vytvoření nové virtuální počítače v Azure](sa-upload-generalized.md).</span><span class="sxs-lookup"><span data-stu-id="2e011-424">For more information about how to create a VM from a generalized disk, see [Upload a generalized VHD and use it to create a new VMs in Azure](sa-upload-generalized.md).</span></span>


## <a name="complete-recommended-configurations"></a><span data-ttu-id="2e011-425">Dokončete doporučené konfigurace</span><span class="sxs-lookup"><span data-stu-id="2e011-425">Complete recommended configurations</span></span>
<span data-ttu-id="2e011-426">Následující nastavení neovlivní odesílání virtuálního pevného disku.</span><span class="sxs-lookup"><span data-stu-id="2e011-426">The following settings do not affect VHD uploading.</span></span> <span data-ttu-id="2e011-427">Ale důrazně doporučujeme nakonfigurovat je.</span><span class="sxs-lookup"><span data-stu-id="2e011-427">However, we strongly recommend that you configured them.</span></span>

* <span data-ttu-id="2e011-428">Nainstalujte [virtuální počítače Azure agenta](http://go.microsoft.com/fwlink/?LinkID=394789&clcid=0x409).</span><span class="sxs-lookup"><span data-stu-id="2e011-428">Install the [Azure VMs Agent](http://go.microsoft.com/fwlink/?LinkID=394789&clcid=0x409).</span></span> <span data-ttu-id="2e011-429">Potom můžete povolit rozšíření virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="2e011-429">Then you can enable VM extensions.</span></span> <span data-ttu-id="2e011-430">Rozšíření virtuálního počítače implementovat většinu důležitých funkcí, které může používat s virtuální počítače jako je resetování hesla, konfigurace RDP a tak dále.</span><span class="sxs-lookup"><span data-stu-id="2e011-430">The VM extensions implement most of the critical functionality that you might want to use with your VMs such as resetting passwords, configuring RDP, and so on.</span></span> <span data-ttu-id="2e011-431">Další informace naleznete v tématu:</span><span class="sxs-lookup"><span data-stu-id="2e011-431">For more information, see:</span></span>

    - [<span data-ttu-id="2e011-432">Agent virtuálního počítače a rozšíření – část 1</span><span class="sxs-lookup"><span data-stu-id="2e011-432">VM Agent and Extensions – Part 1</span></span>](https://azure.microsoft.com/blog/vm-agent-and-extensions-part-1/)
    - [<span data-ttu-id="2e011-433">Agent virtuálního počítače a rozšíření – část 2</span><span class="sxs-lookup"><span data-stu-id="2e011-433">VM Agent and Extensions – Part 2</span></span>](https://azure.microsoft.com/blog/vm-agent-and-extensions-part-2/)
* <span data-ttu-id="2e011-434">Výpis protokolu může být užitečné při řešení problémů s havárií systému Windows.</span><span class="sxs-lookup"><span data-stu-id="2e011-434">The Dump log can be helpful in troubleshooting Windows crash issues.</span></span> <span data-ttu-id="2e011-435">Povolení protokolu kolekce výpisu stavu:</span><span class="sxs-lookup"><span data-stu-id="2e011-435">Enable the Dump log collection:</span></span>
  
    ```PowerShell
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\CrashControl' -name "CrashDumpEnable" -Value "2" -Type DWord
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\CrashControl' -name "DumpFile" -Value "%SystemRoot%\MEMORY.DMP"
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\CrashControl' -name "AutoReboot" -Value 0 -Type DWord
    New-Item -Path 'HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps'
    New-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps' -name "DumpFolder" -Value "c:\CrashDumps"
    New-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps' -name "DumpCount" -Value 10 -Type DWord
    New-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps' -name "DumpType" -Value 2 -Type DWord
    Set-Service -Name WerSvc -StartupType Manual
    ```
    <span data-ttu-id="2e011-436">Pokud se zobrazí všechny chyby během procedurální kroků v tomto článku, znamená to, že klíče registru již existuje.</span><span class="sxs-lookup"><span data-stu-id="2e011-436">If you receive any errors during any of the procedural steps in this article, this means that the registry keys already exists.</span></span> <span data-ttu-id="2e011-437">V takovém případě použijte následující příkazy:</span><span class="sxs-lookup"><span data-stu-id="2e011-437">In this situation, use the following commands instead:</span></span>

    ```PowerShell
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\CrashControl' -name "CrashDumpEnable" -Value "2" -Type DWord
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\CrashControl' -name "DumpFile" -Value "%SystemRoot%\MEMORY.DMP"
    Set-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps' -name "DumpFolder" -Value "c:\CrashDumps"
    Set-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps' -name "DumpCount" -Value 10 -Type DWord
    Set-ItemProperty -Path 'HKLM:\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps' -name "DumpType" -Value 2 -Type DWord
    Set-Service -Name WerSvc -StartupType Manual
    ```
*  <span data-ttu-id="2e011-438">Po vytvoření virtuálního počítače v Azure doporučujeme umístit stránkovací soubor na svazek "Dočasné jednotka" ke zlepšení výkonu.</span><span class="sxs-lookup"><span data-stu-id="2e011-438">After the VM is created in Azure, we recommend that you put the pagefile on the ”Temporal drive” volume to improve performance.</span></span> <span data-ttu-id="2e011-439">Můžete nastavit to následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="2e011-439">You can set up this as follows:</span></span>

    ```PowerShell
    Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management' -name "PagingFiles" -Value "D:\pagefile"
    ```
<span data-ttu-id="2e011-440">Pokud je datový disk, který je připojen k virtuálnímu počítači, písmeno jednotky svazku dočasné jednotky je obvykle "D."</span><span class="sxs-lookup"><span data-stu-id="2e011-440">If there’s any data disk that is attached to the VM, the Temporal drive volume's drive letter is typically "D."</span></span> <span data-ttu-id="2e011-441">Toto označení se může lišit v závislosti na počtu dostupných jednotek a nastavení, které provedete.</span><span class="sxs-lookup"><span data-stu-id="2e011-441">This designation could be different, depending on the number of available drives and the settings that you  make.</span></span>

## <a name="next-steps"></a><span data-ttu-id="2e011-442">Další kroky</span><span class="sxs-lookup"><span data-stu-id="2e011-442">Next steps</span></span>
* [<span data-ttu-id="2e011-443">Nahrajte image virtuálního počítače Windows Azure pro nasazení Resource Manager</span><span class="sxs-lookup"><span data-stu-id="2e011-443">Upload a Windows VM image to Azure for Resource Manager deployments</span></span>](upload-generalized-managed.md)

