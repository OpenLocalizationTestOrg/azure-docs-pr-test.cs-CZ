---
title: "Skupiny dostupnosti SQL serveru – virtuální počítače Azure - Prereqs | Microsoft Docs"
description: "Tento kurz ukazuje, jak konfigurovat požadavky pro vytvoření skupiny dostupnosti SQL serveru Always On na virtuálních počítačích Azure."
services: virtual-machines
documentationCenter: na
authors: MikeRayMSFT
manager: jhubbard
editor: monicar
tags: azure-service-management
ms.assetid: c492db4c-3faa-4645-849f-5a1a663be55a
ms.service: virtual-machines-sql
ms.devlang: na
ms.custom: na
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 05/09/2017
ms.author: mikeray
ms.openlocfilehash: 3d508877928e033f24dae62c1042745ea7250033
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/29/2017
---
# <a name="complete-the-prerequisites-for-creating-always-on-availability-groups-on-azure-virtual-machines"></a><span data-ttu-id="697aa-103">Splnit požadavky pro vytváření skupin dostupnosti Always On na virtuálních počítačích Azure</span><span class="sxs-lookup"><span data-stu-id="697aa-103">Complete the prerequisites for creating Always On availability groups on Azure virtual machines</span></span>

<span data-ttu-id="697aa-104">Tento kurz ukazuje, jak splnit požadavky pro vytváření [SQL serveru skupiny dostupnosti Always On na virtuálních počítačích Azure (VM)](virtual-machines-windows-portal-sql-availability-group-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="697aa-104">This tutorial shows how to complete the prerequisites for creating a [SQL Server Always On availability group on Azure virtual machines (VMs)](virtual-machines-windows-portal-sql-availability-group-tutorial.md).</span></span> <span data-ttu-id="697aa-105">Pokud jste dokončili požadavky, máte řadiče domény, dva virtuální počítače serveru SQL a monitorovací server v jedna skupina prostředků.</span><span class="sxs-lookup"><span data-stu-id="697aa-105">When you've finished the prerequisites, you have a domain controller, two SQL Server VMs, and a witness server in a single resource group.</span></span>

<span data-ttu-id="697aa-106">**Odhad času**: může trvat několik hodin, požadavky.</span><span class="sxs-lookup"><span data-stu-id="697aa-106">**Time estimate**: It might take a couple of hours to complete the prerequisites.</span></span> <span data-ttu-id="697aa-107">Velká část této doby je stráví vytváření virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="697aa-107">Much of this time is spent creating virtual machines.</span></span>

<span data-ttu-id="697aa-108">Následující diagram znázorňuje, co vytvoříte v tomto kurzu.</span><span class="sxs-lookup"><span data-stu-id="697aa-108">The following diagram illustrates what you build in the tutorial.</span></span>

![Skupiny dostupnosti](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/00-EndstateSampleNoELB.png)

## <a name="review-availability-group-documentation"></a><span data-ttu-id="697aa-110">Přečtěte si dokumentaci k skupiny dostupnosti</span><span class="sxs-lookup"><span data-stu-id="697aa-110">Review availability group documentation</span></span>

<span data-ttu-id="697aa-111">Tento kurz předpokládá, že máte základní znalosti o SQL serveru Always On skupiny dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="697aa-111">This tutorial assumes that you have a basic understanding of SQL Server Always On availability groups.</span></span> <span data-ttu-id="697aa-112">Pokud si nejste obeznámeni s touto technologií, přečtěte si téma [přehled o skupin dostupnosti Always On (SQL Server)](http://msdn.microsoft.com/library/ff877884.aspx).</span><span class="sxs-lookup"><span data-stu-id="697aa-112">If you're not familiar with this technology, see [Overview of Always On Availability Groups (SQL Server)](http://msdn.microsoft.com/library/ff877884.aspx).</span></span>


## <a name="create-an-azure-account"></a><span data-ttu-id="697aa-113">Vytvoření účtu Azure</span><span class="sxs-lookup"><span data-stu-id="697aa-113">Create an Azure account</span></span>
<span data-ttu-id="697aa-114">Potřebujete mít účet Azure.</span><span class="sxs-lookup"><span data-stu-id="697aa-114">You need an Azure account.</span></span> <span data-ttu-id="697aa-115">Můžete [otevřít bezplatný účet Azure](/pricing/free-trial/?WT.mc_id=A261C142F) nebo [aktivovat výhody předplatitele Visual Studio](/pricing/member-offers/msdn-benefits-details/?WT.mc_id=A261C142F).</span><span class="sxs-lookup"><span data-stu-id="697aa-115">You can [open a free Azure account](/pricing/free-trial/?WT.mc_id=A261C142F) or [activate Visual Studio subscriber benefits](/pricing/member-offers/msdn-benefits-details/?WT.mc_id=A261C142F).</span></span>

## <a name="create-a-resource-group"></a><span data-ttu-id="697aa-116">Vytvoření skupiny prostředků</span><span class="sxs-lookup"><span data-stu-id="697aa-116">Create a resource group</span></span>
1. <span data-ttu-id="697aa-117">Přihlaste se k webu [Azure Portal](http://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="697aa-117">Sign in to the [Azure portal](http://portal.azure.com).</span></span>
2. <span data-ttu-id="697aa-118">Klikněte na tlačítko  **+**  k vytvoření nového objektu na portálu.</span><span class="sxs-lookup"><span data-stu-id="697aa-118">Click **+** to create a new object in the portal.</span></span>

   ![Nový objekt](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/01-portalplus.png)

3. <span data-ttu-id="697aa-120">Typ **skupiny prostředků** v **Marketplace** okně vyhledávání.</span><span class="sxs-lookup"><span data-stu-id="697aa-120">Type **resource group** in the **Marketplace** search window.</span></span>

   ![Skupina prostředků](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/01-resourcegroupsymbol.png)
4. <span data-ttu-id="697aa-122">Klikněte na tlačítko **skupiny prostředků**.</span><span class="sxs-lookup"><span data-stu-id="697aa-122">Click **Resource group**.</span></span>
5. <span data-ttu-id="697aa-123">Klikněte na možnost **Vytvořit**.</span><span class="sxs-lookup"><span data-stu-id="697aa-123">Click **Create**.</span></span>
6. <span data-ttu-id="697aa-124">Na **skupinu prostředků** okno v části **název skupiny prostředků**, zadejte název pro skupinu prostředků.</span><span class="sxs-lookup"><span data-stu-id="697aa-124">On the **Resource group** blade, under **Resource group name**, type a name for the resource group.</span></span> <span data-ttu-id="697aa-125">Můžete například zadat **sql-ha-rg**.</span><span class="sxs-lookup"><span data-stu-id="697aa-125">For example, type **sql-ha-rg**.</span></span>
7. <span data-ttu-id="697aa-126">Pokud máte víc předplatných Azure, ověřte, že odběr je předplatné Azure, kterou chcete vytvořit skupiny dostupnosti v.</span><span class="sxs-lookup"><span data-stu-id="697aa-126">If you have multiple Azure subscriptions, verify that the subscription is the Azure subscription that you want to create the availability group in.</span></span>
8. <span data-ttu-id="697aa-127">Vyberte umístění.</span><span class="sxs-lookup"><span data-stu-id="697aa-127">Select a location.</span></span> <span data-ttu-id="697aa-128">Umístění je oblast Azure, kde chcete vytvořit skupinu dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="697aa-128">The location is the Azure region where you want to create the availability group.</span></span> <span data-ttu-id="697aa-129">V tomto kurzu vytvoříme sestavení všechny prostředky v jednom místě, Azure.</span><span class="sxs-lookup"><span data-stu-id="697aa-129">For this tutorial, we're going to build all resources in one Azure location.</span></span>
9. <span data-ttu-id="697aa-130">Ověřte, že **připnout na řídicí panel** je zaškrtnuté.</span><span class="sxs-lookup"><span data-stu-id="697aa-130">Verify that **Pin to dashboard** is checked.</span></span> <span data-ttu-id="697aa-131">Toto volitelné nastavení umístí zástupce pro skupinu prostředků na řídicím panelu portálu Azure.</span><span class="sxs-lookup"><span data-stu-id="697aa-131">This optional setting places a shortcut for the resource group on the Azure portal dashboard.</span></span>

   ![Skupina prostředků](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/01-resourcegroup.png)

10. <span data-ttu-id="697aa-133">Klikněte na tlačítko **vytvořit** vytvořte skupinu prostředků.</span><span class="sxs-lookup"><span data-stu-id="697aa-133">Click **Create** to create the resource group.</span></span>

<span data-ttu-id="697aa-134">Azure vytvoří skupinu prostředků a kódy PIN zástupce do skupiny prostředků na portálu.</span><span class="sxs-lookup"><span data-stu-id="697aa-134">Azure creates the resource group and pins a shortcut to the resource group in the portal.</span></span>

## <a name="create-the-network-and-subnets"></a><span data-ttu-id="697aa-135">Vytvoření sítě a podsítě</span><span class="sxs-lookup"><span data-stu-id="697aa-135">Create the network and subnets</span></span>
<span data-ttu-id="697aa-136">Dalším krokem je vytvoření sítě a podsítě ve skupině prostředků Azure.</span><span class="sxs-lookup"><span data-stu-id="697aa-136">The next step is to create the networks and subnets in the Azure resource group.</span></span>

<span data-ttu-id="697aa-137">Toto řešení využívá jednu virtuální síť se dvěma podsítěmi.</span><span class="sxs-lookup"><span data-stu-id="697aa-137">The solution uses one virtual network with two subnets.</span></span> <span data-ttu-id="697aa-138">[Přehled virtuálních sítí](../../../virtual-network/virtual-networks-overview.md) poskytuje další informace o sítích v Azure.</span><span class="sxs-lookup"><span data-stu-id="697aa-138">The [Virtual network overview](../../../virtual-network/virtual-networks-overview.md) provides more information about networks in Azure.</span></span>

<span data-ttu-id="697aa-139">Vytvoření virtuální sítě:</span><span class="sxs-lookup"><span data-stu-id="697aa-139">To create the virtual network:</span></span>

1. <span data-ttu-id="697aa-140">Na portálu Azure ve vaší skupině prostředků, klikněte na tlačítko **+ přidat**.</span><span class="sxs-lookup"><span data-stu-id="697aa-140">In the Azure portal, in your resource group, click **+ Add**.</span></span> <span data-ttu-id="697aa-141">Azure otevře **všechno, co** okno.</span><span class="sxs-lookup"><span data-stu-id="697aa-141">Azure opens the **Everything** blade.</span></span>

   ![Nová položka](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/02-newiteminrg.png)
2. <span data-ttu-id="697aa-143">Vyhledejte **virtuální sítě**.</span><span class="sxs-lookup"><span data-stu-id="697aa-143">Search for **virtual network**.</span></span>

     ![Hledání virtuální sítě](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/04-findvirtualnetwork.png)
3. <span data-ttu-id="697aa-145">Klikněte na tlačítko **virtuální síť**.</span><span class="sxs-lookup"><span data-stu-id="697aa-145">Click **Virtual network**.</span></span>
4. <span data-ttu-id="697aa-146">Na **virtuální síť** okně klikněte na tlačítko **Resource Manager** modelu nasazení a pak klikněte na tlačítko **vytvořit**.</span><span class="sxs-lookup"><span data-stu-id="697aa-146">On the **Virtual network** blade, click the **Resource Manager** deployment model, and then click **Create**.</span></span>

    <span data-ttu-id="697aa-147">Následující tabulka uvádí nastavení virtuální sítě:</span><span class="sxs-lookup"><span data-stu-id="697aa-147">The following table shows the settings for the virtual network:</span></span>

   | <span data-ttu-id="697aa-148">**Pole**</span><span class="sxs-lookup"><span data-stu-id="697aa-148">**Field**</span></span> | <span data-ttu-id="697aa-149">Hodnota</span><span class="sxs-lookup"><span data-stu-id="697aa-149">Value</span></span> |
   | --- | --- |
   | <span data-ttu-id="697aa-150">**Název**</span><span class="sxs-lookup"><span data-stu-id="697aa-150">**Name**</span></span> |<span data-ttu-id="697aa-151">autoHAVNET</span><span class="sxs-lookup"><span data-stu-id="697aa-151">autoHAVNET</span></span> |
   | <span data-ttu-id="697aa-152">**Adresní prostor**</span><span class="sxs-lookup"><span data-stu-id="697aa-152">**Address space**</span></span> |<span data-ttu-id="697aa-153">10.33.0.0/24</span><span class="sxs-lookup"><span data-stu-id="697aa-153">10.33.0.0/24</span></span> |
   | <span data-ttu-id="697aa-154">**Název podsítě**</span><span class="sxs-lookup"><span data-stu-id="697aa-154">**Subnet name**</span></span> |<span data-ttu-id="697aa-155">Správce</span><span class="sxs-lookup"><span data-stu-id="697aa-155">Admin</span></span> |
   | <span data-ttu-id="697aa-156">**Rozsah adres podsítě**</span><span class="sxs-lookup"><span data-stu-id="697aa-156">**Subnet address range**</span></span> |<span data-ttu-id="697aa-157">10.33.0.0/29</span><span class="sxs-lookup"><span data-stu-id="697aa-157">10.33.0.0/29</span></span> |
   | <span data-ttu-id="697aa-158">**Předplatné**</span><span class="sxs-lookup"><span data-stu-id="697aa-158">**Subscription**</span></span> |<span data-ttu-id="697aa-159">Určete předplatné, který chcete použít.</span><span class="sxs-lookup"><span data-stu-id="697aa-159">Specify the subscription that you intend to use.</span></span> <span data-ttu-id="697aa-160">**Předplatné** je prázdná, pokud máte pouze jedno předplatné.</span><span class="sxs-lookup"><span data-stu-id="697aa-160">**Subscription** is blank if you only have one subscription.</span></span> |
   | <span data-ttu-id="697aa-161">**Skupina prostředků**</span><span class="sxs-lookup"><span data-stu-id="697aa-161">**Resource group**</span></span> |<span data-ttu-id="697aa-162">Zvolte **použít existující** a vyberte název skupiny prostředků.</span><span class="sxs-lookup"><span data-stu-id="697aa-162">Choose **Use existing** and pick the name of the resource group.</span></span> |
   | <span data-ttu-id="697aa-163">**Umístění**</span><span class="sxs-lookup"><span data-stu-id="697aa-163">**Location**</span></span> |<span data-ttu-id="697aa-164">Zadejte umístění v Azure.</span><span class="sxs-lookup"><span data-stu-id="697aa-164">Specify the Azure location.</span></span> |

   <span data-ttu-id="697aa-165">Vaše adresa prostoru a podsítě rozsah adres se mohou lišit z tabulky.</span><span class="sxs-lookup"><span data-stu-id="697aa-165">Your address space and subnet address range might be different from the table.</span></span> <span data-ttu-id="697aa-166">V závislosti na vaše předplatné navrhuje portálu k dispozici adresní prostor a odpovídající rozsah adres podsítě.</span><span class="sxs-lookup"><span data-stu-id="697aa-166">Depending on your subscription, the portal suggests an available address space and corresponding subnet address range.</span></span> <span data-ttu-id="697aa-167">Pokud je k dispozici žádné dostatečný Adresní prostor, použijte jiný odběr.</span><span class="sxs-lookup"><span data-stu-id="697aa-167">If no sufficient address space is available, use a different subscription.</span></span>

   <span data-ttu-id="697aa-168">V příkladu je název podsítě **správce**. Tato podsíť je pro řadiče domény.</span><span class="sxs-lookup"><span data-stu-id="697aa-168">The example uses the subnet name **Admin**. This subnet is for the domain controllers.</span></span>

5. <span data-ttu-id="697aa-169">Klikněte na možnost **Vytvořit**.</span><span class="sxs-lookup"><span data-stu-id="697aa-169">Click **Create**.</span></span>

   ![Konfigurace virtuální sítě](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/06-configurevirtualnetwork.png)

<span data-ttu-id="697aa-171">Azure se vrátíte k řídicímu panelu portálu a upozorní vás při vytvoření nové sítě.</span><span class="sxs-lookup"><span data-stu-id="697aa-171">Azure returns you to the portal dashboard and notifies you when the new network is created.</span></span>

### <a name="create-a-second-subnet"></a><span data-ttu-id="697aa-172">Vytvořte druhou podsíť</span><span class="sxs-lookup"><span data-stu-id="697aa-172">Create a second subnet</span></span>
<span data-ttu-id="697aa-173">Nové virtuální sítě obsahuje jednu podsíť, s názvem **správce**. Řadiče domény použít tuto podsíť.</span><span class="sxs-lookup"><span data-stu-id="697aa-173">The new virtual network has one subnet, named **Admin**. The domain controllers use this subnet.</span></span> <span data-ttu-id="697aa-174">Použití virtuálních počítačů serveru SQL druhá podsíť s názvem **SQL**.</span><span class="sxs-lookup"><span data-stu-id="697aa-174">The SQL Server VMs use a second subnet named **SQL**.</span></span> <span data-ttu-id="697aa-175">Konfigurace této podsítě:</span><span class="sxs-lookup"><span data-stu-id="697aa-175">To configure this subnet:</span></span>

1. <span data-ttu-id="697aa-176">Na řídicím panelu, klikněte na skupinu prostředků, kterou jste vytvořili, **SQL-HA-RG**.</span><span class="sxs-lookup"><span data-stu-id="697aa-176">On your dashboard, click the resource group that you created, **SQL-HA-RG**.</span></span> <span data-ttu-id="697aa-177">Vyhledejte ve skupině prostředků v síti **prostředky**.</span><span class="sxs-lookup"><span data-stu-id="697aa-177">Locate the network in the resource group under **Resources**.</span></span>

    <span data-ttu-id="697aa-178">Pokud **SQL-HA-RG** není viditelná, klepněte na tlačítko **skupiny prostředků** a filtrování podle názvu skupiny prostředků.</span><span class="sxs-lookup"><span data-stu-id="697aa-178">If **SQL-HA-RG** isn't visible, find it by clicking **Resource Groups** and filtering by the resource group name.</span></span>
2. <span data-ttu-id="697aa-179">Klikněte na tlačítko **autoHAVNET** v seznamu prostředků.</span><span class="sxs-lookup"><span data-stu-id="697aa-179">Click **autoHAVNET** on the list of resources.</span></span> <span data-ttu-id="697aa-180">Azure se otevře okno Konfigurace sítě.</span><span class="sxs-lookup"><span data-stu-id="697aa-180">Azure opens the network configuration blade.</span></span>
3. <span data-ttu-id="697aa-181">Na **autoHAVNET** okna virtuální sítě v části **nastavení** , klikněte na tlačítko **podsítě**.</span><span class="sxs-lookup"><span data-stu-id="697aa-181">On the **autoHAVNET** virtual network blade, under **Settings** , click **Subnets**.</span></span>

    <span data-ttu-id="697aa-182">Všimněte si, podsítě, které jste už vytvořili.</span><span class="sxs-lookup"><span data-stu-id="697aa-182">Note the subnet that you already created.</span></span>

   ![Konfigurace virtuální sítě](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/07-addsubnet.png)
5. <span data-ttu-id="697aa-184">Vytvořte druhou podsíť.</span><span class="sxs-lookup"><span data-stu-id="697aa-184">Create a second subnet.</span></span> <span data-ttu-id="697aa-185">Klikněte na tlačítko **+ podsítě**.</span><span class="sxs-lookup"><span data-stu-id="697aa-185">Click **+ Subnet**.</span></span>
6. <span data-ttu-id="697aa-186">Na **přidat podsíť** okně nakonfigurovat podsíť zadáním **sqlsubnet** pod **název**.</span><span class="sxs-lookup"><span data-stu-id="697aa-186">On the **Add subnet** blade, configure the subnet by typing **sqlsubnet** under **Name**.</span></span> <span data-ttu-id="697aa-187">Azure automaticky určuje platná **rozsahu adres**.</span><span class="sxs-lookup"><span data-stu-id="697aa-187">Azure automatically specifies a valid **Address range**.</span></span> <span data-ttu-id="697aa-188">Ověřte, zda tento rozsah adres má minimálně 10 adresy v ní.</span><span class="sxs-lookup"><span data-stu-id="697aa-188">Verify that this address range has at least 10 addresses in it.</span></span> <span data-ttu-id="697aa-189">V produkčním prostředí může vyžadovat další adresy.</span><span class="sxs-lookup"><span data-stu-id="697aa-189">In a production environment, you might require more addresses.</span></span>
7. <span data-ttu-id="697aa-190">Klikněte na **OK**.</span><span class="sxs-lookup"><span data-stu-id="697aa-190">Click **OK**.</span></span>

    ![Konfigurace virtuální sítě](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/08-configuresubnet.png)

<span data-ttu-id="697aa-192">Následující tabulka shrnuje nastavení konfigurace sítě:</span><span class="sxs-lookup"><span data-stu-id="697aa-192">The following table summarizes the network configuration settings:</span></span>

| <span data-ttu-id="697aa-193">**Pole**</span><span class="sxs-lookup"><span data-stu-id="697aa-193">**Field**</span></span> | <span data-ttu-id="697aa-194">Hodnota</span><span class="sxs-lookup"><span data-stu-id="697aa-194">Value</span></span> |
| --- | --- |
| <span data-ttu-id="697aa-195">**Název**</span><span class="sxs-lookup"><span data-stu-id="697aa-195">**Name**</span></span> |<span data-ttu-id="697aa-196">**autoHAVNET**</span><span class="sxs-lookup"><span data-stu-id="697aa-196">**autoHAVNET**</span></span> |
| <span data-ttu-id="697aa-197">**Adresní prostor**</span><span class="sxs-lookup"><span data-stu-id="697aa-197">**Address space**</span></span> |<span data-ttu-id="697aa-198">Tato hodnota závisí na k dispozici adresní prostory v rámci vašeho předplatného.</span><span class="sxs-lookup"><span data-stu-id="697aa-198">This value depends on the available address spaces in your subscription.</span></span> <span data-ttu-id="697aa-199">Typické hodnota je 10.0.0.0/16.</span><span class="sxs-lookup"><span data-stu-id="697aa-199">A typical value is 10.0.0.0/16.</span></span> |
| <span data-ttu-id="697aa-200">**Název podsítě**</span><span class="sxs-lookup"><span data-stu-id="697aa-200">**Subnet name**</span></span> |<span data-ttu-id="697aa-201">**Správce**</span><span class="sxs-lookup"><span data-stu-id="697aa-201">**admin**</span></span> |
| <span data-ttu-id="697aa-202">**Rozsah adres podsítě**</span><span class="sxs-lookup"><span data-stu-id="697aa-202">**Subnet address range**</span></span> |<span data-ttu-id="697aa-203">Tato hodnota závisí na rozsahů adres k dispozici v rámci vašeho předplatného.</span><span class="sxs-lookup"><span data-stu-id="697aa-203">This value depends on the available address ranges in your subscription.</span></span> <span data-ttu-id="697aa-204">Typické hodnota je 10.0.0.0/24.</span><span class="sxs-lookup"><span data-stu-id="697aa-204">A typical value is 10.0.0.0/24.</span></span> |
| <span data-ttu-id="697aa-205">**Název podsítě**</span><span class="sxs-lookup"><span data-stu-id="697aa-205">**Subnet name**</span></span> |<span data-ttu-id="697aa-206">**sqlsubnet**</span><span class="sxs-lookup"><span data-stu-id="697aa-206">**sqlsubnet**</span></span> |
| <span data-ttu-id="697aa-207">**Rozsah adres podsítě**</span><span class="sxs-lookup"><span data-stu-id="697aa-207">**Subnet address range**</span></span> |<span data-ttu-id="697aa-208">Tato hodnota závisí na rozsahů adres k dispozici v rámci vašeho předplatného.</span><span class="sxs-lookup"><span data-stu-id="697aa-208">This value depends on the available address ranges in your subscription.</span></span> <span data-ttu-id="697aa-209">Typické hodnota je 10.0.1.0/24.</span><span class="sxs-lookup"><span data-stu-id="697aa-209">A typical value is 10.0.1.0/24.</span></span> |
| <span data-ttu-id="697aa-210">**Předplatné**</span><span class="sxs-lookup"><span data-stu-id="697aa-210">**Subscription**</span></span> |<span data-ttu-id="697aa-211">Určete předplatné, který chcete použít.</span><span class="sxs-lookup"><span data-stu-id="697aa-211">Specify the subscription that you intend to use.</span></span> |
| <span data-ttu-id="697aa-212">**Skupina prostředků**</span><span class="sxs-lookup"><span data-stu-id="697aa-212">**Resource Group**</span></span> |<span data-ttu-id="697aa-213">**SQL-HA-RG**</span><span class="sxs-lookup"><span data-stu-id="697aa-213">**SQL-HA-RG**</span></span> |
| <span data-ttu-id="697aa-214">**Umístění**</span><span class="sxs-lookup"><span data-stu-id="697aa-214">**Location**</span></span> |<span data-ttu-id="697aa-215">Zadejte stejné umístění, které jste zvolili pro skupinu prostředků.</span><span class="sxs-lookup"><span data-stu-id="697aa-215">Specify the same location that you chose for the resource group.</span></span> |

## <a name="create-availability-sets"></a><span data-ttu-id="697aa-216">Vytvoření skupin dostupnosti</span><span class="sxs-lookup"><span data-stu-id="697aa-216">Create availability sets</span></span>

<span data-ttu-id="697aa-217">Než vytvoříte virtuální počítače, budete muset vytvořit skupiny dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="697aa-217">Before you create virtual machines, you need to create availability sets.</span></span> <span data-ttu-id="697aa-218">Skupiny dostupnosti zkrátit dobu prostojů pro události plánované i neplánované údržby.</span><span class="sxs-lookup"><span data-stu-id="697aa-218">Availability sets reduce the downtime for planned or unplanned maintenance events.</span></span> <span data-ttu-id="697aa-219">Nastavení Azure dostupnosti je logické skupiny prostředků, které Azure umístí na fyzických domén selhání a aktualizace domény.</span><span class="sxs-lookup"><span data-stu-id="697aa-219">An Azure availability set is a logical group of resources that Azure places on physical fault domains and update domains.</span></span> <span data-ttu-id="697aa-220">Domény selhání zajistí, že členové skupiny dostupnosti samostatné napájení a síťové prostředky.</span><span class="sxs-lookup"><span data-stu-id="697aa-220">A fault domain ensures that the members of the availability set have separate power and network resources.</span></span> <span data-ttu-id="697aa-221">Doména aktualizace zajistí, že členové skupiny dostupnosti nejsou snížila pro údržbu ve stejnou dobu.</span><span class="sxs-lookup"><span data-stu-id="697aa-221">An update domain ensures that members of the availability set aren't brought down for maintenance at the same time.</span></span> <span data-ttu-id="697aa-222">Další informace najdete v tématu [Správa dostupnosti virtuálních počítačů](../manage-availability.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="697aa-222">For more information, see [Manage the availability of virtual machines](../manage-availability.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>

<span data-ttu-id="697aa-223">Je třeba dvě skupiny dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="697aa-223">You need two availability sets.</span></span> <span data-ttu-id="697aa-224">Jeden je pro řadiče domény.</span><span class="sxs-lookup"><span data-stu-id="697aa-224">One is for the domain controllers.</span></span> <span data-ttu-id="697aa-225">Druhá je pro virtuální počítače serveru SQL.</span><span class="sxs-lookup"><span data-stu-id="697aa-225">The second is for the SQL Server VMs.</span></span>

<span data-ttu-id="697aa-226">Pokud chcete vytvořit skupinu dostupnosti, přejděte do skupiny prostředků a klikněte na tlačítko **přidat**.</span><span class="sxs-lookup"><span data-stu-id="697aa-226">To create an availability set, go to the resource group and click **Add**.</span></span> <span data-ttu-id="697aa-227">Filtrování výsledků zadáním **skupinu dostupnosti**.</span><span class="sxs-lookup"><span data-stu-id="697aa-227">Filter the results by typing **availability set**.</span></span> <span data-ttu-id="697aa-228">Klikněte na tlačítko **sadu dostupnosti** výsledků a pak klikněte na **vytvořit**.</span><span class="sxs-lookup"><span data-stu-id="697aa-228">Click **Availability Set** in the results, and then click **Create**.</span></span>

<span data-ttu-id="697aa-229">Konfigurace dvou sad dostupnosti podle parametry v následující tabulce:</span><span class="sxs-lookup"><span data-stu-id="697aa-229">Configure two availability sets according to the parameters in the following table:</span></span>

| <span data-ttu-id="697aa-230">**Pole**</span><span class="sxs-lookup"><span data-stu-id="697aa-230">**Field**</span></span> | <span data-ttu-id="697aa-231">Skupina dostupnosti řadiče domény</span><span class="sxs-lookup"><span data-stu-id="697aa-231">Domain controller availability set</span></span> | <span data-ttu-id="697aa-232">Skupinu dostupnosti systému SQL Server</span><span class="sxs-lookup"><span data-stu-id="697aa-232">SQL Server availability set</span></span> |
| --- | --- | --- |
| <span data-ttu-id="697aa-233">**Název**</span><span class="sxs-lookup"><span data-stu-id="697aa-233">**Name**</span></span> |<span data-ttu-id="697aa-234">adavailabilityset</span><span class="sxs-lookup"><span data-stu-id="697aa-234">adavailabilityset</span></span> |<span data-ttu-id="697aa-235">sqlavailabilityset</span><span class="sxs-lookup"><span data-stu-id="697aa-235">sqlavailabilityset</span></span> |
| <span data-ttu-id="697aa-236">**Skupina prostředků**</span><span class="sxs-lookup"><span data-stu-id="697aa-236">**Resource group**</span></span> |<span data-ttu-id="697aa-237">SQL-HA-RG</span><span class="sxs-lookup"><span data-stu-id="697aa-237">SQL-HA-RG</span></span> |<span data-ttu-id="697aa-238">SQL-HA-RG</span><span class="sxs-lookup"><span data-stu-id="697aa-238">SQL-HA-RG</span></span> |
| <span data-ttu-id="697aa-239">**Domén selhání**</span><span class="sxs-lookup"><span data-stu-id="697aa-239">**Fault domains**</span></span> |<span data-ttu-id="697aa-240">3</span><span class="sxs-lookup"><span data-stu-id="697aa-240">3</span></span> |<span data-ttu-id="697aa-241">3</span><span class="sxs-lookup"><span data-stu-id="697aa-241">3</span></span> |
| <span data-ttu-id="697aa-242">**Aktualizace domén**</span><span class="sxs-lookup"><span data-stu-id="697aa-242">**Update domains**</span></span> |<span data-ttu-id="697aa-243">5</span><span class="sxs-lookup"><span data-stu-id="697aa-243">5</span></span> |<span data-ttu-id="697aa-244">3</span><span class="sxs-lookup"><span data-stu-id="697aa-244">3</span></span> |

<span data-ttu-id="697aa-245">Po vytvoření skupiny dostupnosti, vraťte se ke skupině prostředků na portálu Azure.</span><span class="sxs-lookup"><span data-stu-id="697aa-245">After you create the availability sets, return to the resource group in the Azure portal.</span></span>

## <a name="create-domain-controllers"></a><span data-ttu-id="697aa-246">Vytvoření řadiče domény</span><span class="sxs-lookup"><span data-stu-id="697aa-246">Create domain controllers</span></span>
<span data-ttu-id="697aa-247">Po vytvoření sítě, podsítě, skupiny dostupnosti a k straně Internetu pro vyrovnávání zatížení, budete připraveni k vytvoření virtuálních počítačů pro řadiče domény.</span><span class="sxs-lookup"><span data-stu-id="697aa-247">After you've created the network, subnets, availability sets, and an Internet-facing load balancer, you're ready to create the virtual machines for the domain controllers.</span></span>

### <a name="create-virtual-machines-for-the-domain-controllers"></a><span data-ttu-id="697aa-248">Vytváření virtuálních počítačů pro řadiče domény</span><span class="sxs-lookup"><span data-stu-id="697aa-248">Create virtual machines for the domain controllers</span></span>
<span data-ttu-id="697aa-249">Chcete-li vytvořit a nakonfigurovat řadiče domény, vraťte se k **SQL-HA-RG** skupinu prostředků.</span><span class="sxs-lookup"><span data-stu-id="697aa-249">To create and configure the domain controllers, return to the **SQL-HA-RG** resource group.</span></span>

1. <span data-ttu-id="697aa-250">Klikněte na tlačítko **Přidat**.</span><span class="sxs-lookup"><span data-stu-id="697aa-250">Click **Add**.</span></span> <span data-ttu-id="697aa-251">**Všechno, co** otevře se okno.</span><span class="sxs-lookup"><span data-stu-id="697aa-251">The **Everything** blade opens.</span></span>
2. <span data-ttu-id="697aa-252">Typ **systému Windows Server 2016 Datacenter**.</span><span class="sxs-lookup"><span data-stu-id="697aa-252">Type **Windows Server 2016 Datacenter**.</span></span>
3. <span data-ttu-id="697aa-253">Klikněte na tlačítko **systému Windows Server 2016 Datacenter**.</span><span class="sxs-lookup"><span data-stu-id="697aa-253">Click **Windows Server 2016 Datacenter**.</span></span> <span data-ttu-id="697aa-254">V **Windows Server 2016 Datacenter** okno, ověřte, zda je model nasazení **Resource Manager**a potom klikněte na **vytvořit**.</span><span class="sxs-lookup"><span data-stu-id="697aa-254">In the **Windows Server 2016 Datacenter** blade, verify that the deployment model is **Resource Manager**, and then click **Create**.</span></span> <span data-ttu-id="697aa-255">Azure otevře **vytvořit virtuální počítač** okno.</span><span class="sxs-lookup"><span data-stu-id="697aa-255">Azure opens the **Create virtual machine** blade.</span></span>

<span data-ttu-id="697aa-256">Opakujte předchozí kroky k vytvoření dvou virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="697aa-256">Repeat the preceding steps to create two virtual machines.</span></span> <span data-ttu-id="697aa-257">Název dva virtuální počítače:</span><span class="sxs-lookup"><span data-stu-id="697aa-257">Name the two virtual machines:</span></span>

* <span data-ttu-id="697aa-258">řadič domény AD primární</span><span class="sxs-lookup"><span data-stu-id="697aa-258">ad-primary-dc</span></span>
* <span data-ttu-id="697aa-259">řadič domény AD sekundární</span><span class="sxs-lookup"><span data-stu-id="697aa-259">ad-secondary-dc</span></span>

  > [!NOTE]
  > <span data-ttu-id="697aa-260">**Řadiče domény ad sekundární** virtuální počítač je volitelné, pro zajištění vysoké dostupnosti pro Active Directory Domain Services.</span><span class="sxs-lookup"><span data-stu-id="697aa-260">The **ad-secondary-dc** virtual machine is optional, to provide high availability for Active Directory Domain Services.</span></span>
  >
  >

<span data-ttu-id="697aa-261">Následující tabulka uvádí nastavení pro tyto dva počítače:</span><span class="sxs-lookup"><span data-stu-id="697aa-261">The following table shows the settings for these two machines:</span></span>

| <span data-ttu-id="697aa-262">**Pole**</span><span class="sxs-lookup"><span data-stu-id="697aa-262">**Field**</span></span> | <span data-ttu-id="697aa-263">Hodnota</span><span class="sxs-lookup"><span data-stu-id="697aa-263">Value</span></span> |
| --- | --- |
| <span data-ttu-id="697aa-264">**Název**</span><span class="sxs-lookup"><span data-stu-id="697aa-264">**Name**</span></span> |<span data-ttu-id="697aa-265">První řadič domény: *řadiče domény ad primární*.</span><span class="sxs-lookup"><span data-stu-id="697aa-265">First domain controller: *ad-primary-dc*.</span></span></br><span data-ttu-id="697aa-266">Druhý řadič domény *řadiče domény ad sekundární*.</span><span class="sxs-lookup"><span data-stu-id="697aa-266">Second domain controller *ad-secondary-dc*.</span></span> |
| <span data-ttu-id="697aa-267">**Typ disku virtuálního počítače**</span><span class="sxs-lookup"><span data-stu-id="697aa-267">**VM disk type**</span></span> |<span data-ttu-id="697aa-268">SSD</span><span class="sxs-lookup"><span data-stu-id="697aa-268">SSD</span></span> |
| <span data-ttu-id="697aa-269">**Uživatelské jméno**</span><span class="sxs-lookup"><span data-stu-id="697aa-269">**User name**</span></span> |<span data-ttu-id="697aa-270">DomainAdmin</span><span class="sxs-lookup"><span data-stu-id="697aa-270">DomainAdmin</span></span> |
| <span data-ttu-id="697aa-271">**Heslo**</span><span class="sxs-lookup"><span data-stu-id="697aa-271">**Password**</span></span> |<span data-ttu-id="697aa-272">Contoso! 0000</span><span class="sxs-lookup"><span data-stu-id="697aa-272">Contoso!0000</span></span> |
| <span data-ttu-id="697aa-273">**Předplatné**</span><span class="sxs-lookup"><span data-stu-id="697aa-273">**Subscription**</span></span> |<span data-ttu-id="697aa-274">*Vaše předplatné*</span><span class="sxs-lookup"><span data-stu-id="697aa-274">*Your subscription*</span></span> |
| <span data-ttu-id="697aa-275">**Skupina prostředků**</span><span class="sxs-lookup"><span data-stu-id="697aa-275">**Resource group**</span></span> |<span data-ttu-id="697aa-276">SQL-HA-RG</span><span class="sxs-lookup"><span data-stu-id="697aa-276">SQL-HA-RG</span></span> |
| <span data-ttu-id="697aa-277">**Umístění**</span><span class="sxs-lookup"><span data-stu-id="697aa-277">**Location**</span></span> |<span data-ttu-id="697aa-278">*Vaše umístění*</span><span class="sxs-lookup"><span data-stu-id="697aa-278">*Your location*</span></span> |
| <span data-ttu-id="697aa-279">**Velikost**</span><span class="sxs-lookup"><span data-stu-id="697aa-279">**Size**</span></span> |<span data-ttu-id="697aa-280">DS1_V2</span><span class="sxs-lookup"><span data-stu-id="697aa-280">DS1_V2</span></span> |
| <span data-ttu-id="697aa-281">**Storage**</span><span class="sxs-lookup"><span data-stu-id="697aa-281">**Storage**</span></span> | <span data-ttu-id="697aa-282">**Používat spravované disky** - **Ano**</span><span class="sxs-lookup"><span data-stu-id="697aa-282">**Use managed disks** - **Yes**</span></span> |
| <span data-ttu-id="697aa-283">**Virtuální síť**</span><span class="sxs-lookup"><span data-stu-id="697aa-283">**Virtual network**</span></span> |<span data-ttu-id="697aa-284">autoHAVNET</span><span class="sxs-lookup"><span data-stu-id="697aa-284">autoHAVNET</span></span> |
| <span data-ttu-id="697aa-285">**Podsíť**</span><span class="sxs-lookup"><span data-stu-id="697aa-285">**Subnet**</span></span> |<span data-ttu-id="697aa-286">Správce</span><span class="sxs-lookup"><span data-stu-id="697aa-286">admin</span></span> |
| <span data-ttu-id="697aa-287">**Veřejná IP adresa**</span><span class="sxs-lookup"><span data-stu-id="697aa-287">**Public IP address**</span></span> |<span data-ttu-id="697aa-288">*Stejný název jako virtuální počítač*</span><span class="sxs-lookup"><span data-stu-id="697aa-288">*Same name as the VM*</span></span> |
| <span data-ttu-id="697aa-289">**Skupina zabezpečení sítě**</span><span class="sxs-lookup"><span data-stu-id="697aa-289">**Network security group**</span></span> |<span data-ttu-id="697aa-290">*Stejný název jako virtuální počítač*</span><span class="sxs-lookup"><span data-stu-id="697aa-290">*Same name as the VM*</span></span> |
| <span data-ttu-id="697aa-291">**Sady dostupnosti.**</span><span class="sxs-lookup"><span data-stu-id="697aa-291">**Availability set**</span></span> |<span data-ttu-id="697aa-292">adavailabilityset</span><span class="sxs-lookup"><span data-stu-id="697aa-292">adavailabilityset</span></span> </br><span data-ttu-id="697aa-293">**Poruch domén**: 2</span><span class="sxs-lookup"><span data-stu-id="697aa-293">**Fault domains**:2</span></span></br><span data-ttu-id="697aa-294">**Aktualizovat domén**: 2</span><span class="sxs-lookup"><span data-stu-id="697aa-294">**Update domains**:2</span></span>|
| <span data-ttu-id="697aa-295">**Diagnostika**</span><span class="sxs-lookup"><span data-stu-id="697aa-295">**Diagnostics**</span></span> |<span data-ttu-id="697aa-296">Povoleno</span><span class="sxs-lookup"><span data-stu-id="697aa-296">Enabled</span></span> |
| <span data-ttu-id="697aa-297">**Účet úložiště diagnostiky**</span><span class="sxs-lookup"><span data-stu-id="697aa-297">**Diagnostics storage account**</span></span> |<span data-ttu-id="697aa-298">*Automaticky vytvoří*</span><span class="sxs-lookup"><span data-stu-id="697aa-298">*Automatically created*</span></span> |

   >[!IMPORTANT]
   ><span data-ttu-id="697aa-299">Virtuální počítač můžete umístit pouze ve skupině dostupnosti nastavena při jeho vytvoření.</span><span class="sxs-lookup"><span data-stu-id="697aa-299">You can only place a VM in an availability set when you create it.</span></span> <span data-ttu-id="697aa-300">Nelze změnit po vytvoření virtuálního počítače skupinu dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="697aa-300">You can't change the availability set after a VM is created.</span></span> <span data-ttu-id="697aa-301">V tématu [Správa dostupnosti virtuálních počítačů](../manage-availability.md).</span><span class="sxs-lookup"><span data-stu-id="697aa-301">See [Manage the availability of virtual machines](../manage-availability.md).</span></span>

<span data-ttu-id="697aa-302">Azure vytvoří virtuální počítače.</span><span class="sxs-lookup"><span data-stu-id="697aa-302">Azure creates the virtual machines.</span></span>

<span data-ttu-id="697aa-303">Po vytvoření virtuálních počítačů, konfigurace řadiče domény.</span><span class="sxs-lookup"><span data-stu-id="697aa-303">After the virtual machines are created, configure the domain controller.</span></span>

### <a name="configure-the-domain-controller"></a><span data-ttu-id="697aa-304">Konfigurace řadiče domény</span><span class="sxs-lookup"><span data-stu-id="697aa-304">Configure the domain controller</span></span>
<span data-ttu-id="697aa-305">V následujících krocích konfigurace **řadiče domény ad primární** počítače jako řadič domény pro spolecnost.contoso.com.</span><span class="sxs-lookup"><span data-stu-id="697aa-305">In the following steps, configure the **ad-primary-dc** machine as a domain controller for corp.contoso.com.</span></span>

1. <span data-ttu-id="697aa-306">Na portálu, otevřete **SQL-HA-RG** prostředku, skupiny a vyberte **řadiče domény ad primární** počítače.</span><span class="sxs-lookup"><span data-stu-id="697aa-306">In the portal, open the **SQL-HA-RG** resource group and select the **ad-primary-dc** machine.</span></span> <span data-ttu-id="697aa-307">Na **řadiče domény ad primární** okně klikněte na tlačítko **Connect** otevřete soubor RDP pro přístup ke vzdálené ploše.</span><span class="sxs-lookup"><span data-stu-id="697aa-307">On the **ad-primary-dc** blade, click **Connect** to open an RDP file for remote desktop access.</span></span>

    ![Připojit k virtuálnímu počítači](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/20-connectrdp.png)
2. <span data-ttu-id="697aa-309">Přihlaste se pomocí účtu správce nakonfigurované (**\DomainAdmin**) a heslo (**Contoso! 0000**).</span><span class="sxs-lookup"><span data-stu-id="697aa-309">Sign in with your configured administrator account (**\DomainAdmin**) and password (**Contoso!0000**).</span></span>
3. <span data-ttu-id="697aa-310">Ve výchozím nastavení **správce serveru** měla by se zobrazit řídicí panel.</span><span class="sxs-lookup"><span data-stu-id="697aa-310">By default, the **Server Manager** dashboard should be displayed.</span></span>
4. <span data-ttu-id="697aa-311">Klikněte **přidat role a funkce** odkaz na řídicím panelu.</span><span class="sxs-lookup"><span data-stu-id="697aa-311">Click the **Add roles and features** link on the dashboard.</span></span>

    ![Správce serveru – přidání rolí](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/22-addfeatures.png)
5. <span data-ttu-id="697aa-313">Vyberte **Další** až na **role serveru** části.</span><span class="sxs-lookup"><span data-stu-id="697aa-313">Select **Next** until you get to the **Server Roles** section.</span></span>
6. <span data-ttu-id="697aa-314">Vyberte **Active Directory Domain Services** a **DNS Server** role.</span><span class="sxs-lookup"><span data-stu-id="697aa-314">Select the **Active Directory Domain Services** and **DNS Server** roles.</span></span> <span data-ttu-id="697aa-315">Když se zobrazí výzva, přidejte všechny další funkce, které jsou vyžadované tyto role.</span><span class="sxs-lookup"><span data-stu-id="697aa-315">When you're prompted, add any additional features that are required by these roles.</span></span>

   > [!NOTE]
   > <span data-ttu-id="697aa-316">Windows vás varuje, že neexistuje žádná statická IP adresa.</span><span class="sxs-lookup"><span data-stu-id="697aa-316">Windows warns you that there is no static IP address.</span></span> <span data-ttu-id="697aa-317">Pokud testujete konfiguraci, klikněte na tlačítko **pokračovat**.</span><span class="sxs-lookup"><span data-stu-id="697aa-317">If you're testing the configuration, click **Continue**.</span></span> <span data-ttu-id="697aa-318">U produkčních scénářích nastavit IP adresu v portálu Azure nebo [nastavit statickou IP adresu počítače řadiče domény pomocí prostředí PowerShell](../../../virtual-network/virtual-networks-reserved-private-ip.md).</span><span class="sxs-lookup"><span data-stu-id="697aa-318">For production scenarios, set the IP address to static in the Azure portal, or [use PowerShell to set the static IP address of the domain controller machine](../../../virtual-network/virtual-networks-reserved-private-ip.md).</span></span>
   >
   >

    ![Role dialogové okno Přidání](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/23-addroles.png)
7. <span data-ttu-id="697aa-320">Klikněte na tlačítko **Další** dokud nepřejdete **potvrzení** části.</span><span class="sxs-lookup"><span data-stu-id="697aa-320">Click **Next** until you reach the **Confirmation** section.</span></span> <span data-ttu-id="697aa-321">Vyberte **cílový server automaticky restartovat, pokud je to nutné** zaškrtávací políčko.</span><span class="sxs-lookup"><span data-stu-id="697aa-321">Select the **Restart the destination server automatically if required** check box.</span></span>
8. <span data-ttu-id="697aa-322">Klikněte na **Nainstalovat**.</span><span class="sxs-lookup"><span data-stu-id="697aa-322">Click **Install**.</span></span>
9. <span data-ttu-id="697aa-323">Po dokončení instalace funkce vraťte k **správce serveru** řídicího panelu.</span><span class="sxs-lookup"><span data-stu-id="697aa-323">After the features finish installing, return to the **Server Manager** dashboard.</span></span>
10. <span data-ttu-id="697aa-324">Vyberte novou **služby AD DS** možnost v levém podokně.</span><span class="sxs-lookup"><span data-stu-id="697aa-324">Select the new **AD DS** option on the left-hand pane.</span></span>
11. <span data-ttu-id="697aa-325">Klikněte **Další** odkaz na žlutý pruh upozornění.</span><span class="sxs-lookup"><span data-stu-id="697aa-325">Click the **More** link on the yellow warning bar.</span></span>

    ![Dialogové okno AD DS na virtuální počítač Server DNS](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/24-addsmore.png)
12. <span data-ttu-id="697aa-327">V **akce** sloupec **všechny podrobnosti úlohy serveru** dialogové okno, klikněte na tlačítko **zvýšit úroveň tohoto serveru na řadič domény**.</span><span class="sxs-lookup"><span data-stu-id="697aa-327">In the **Action** column of the **All Server Task Details** dialog, click **Promote this server to a domain controller**.</span></span>
13. <span data-ttu-id="697aa-328">V **Průvodce konfigurací služby domény služby Active Directory**, použijte následující hodnoty:</span><span class="sxs-lookup"><span data-stu-id="697aa-328">In the **Active Directory Domain Services Configuration Wizard**, use the following values:</span></span>

    | <span data-ttu-id="697aa-329">**Stránka**</span><span class="sxs-lookup"><span data-stu-id="697aa-329">**Page**</span></span> | <span data-ttu-id="697aa-330">Nastavení</span><span class="sxs-lookup"><span data-stu-id="697aa-330">Setting</span></span> |
    | --- | --- |
    | <span data-ttu-id="697aa-331">**Konfigurace nasazení**</span><span class="sxs-lookup"><span data-stu-id="697aa-331">**Deployment Configuration**</span></span> |<span data-ttu-id="697aa-332">**Přidat novou doménovou strukturu**</span><span class="sxs-lookup"><span data-stu-id="697aa-332">**Add a new forest**</span></span><br/> <span data-ttu-id="697aa-333">**Název kořenové domény** = corp.contoso.com</span><span class="sxs-lookup"><span data-stu-id="697aa-333">**Root domain name** = corp.contoso.com</span></span> |
    | <span data-ttu-id="697aa-334">**Možnosti řadiče domény**</span><span class="sxs-lookup"><span data-stu-id="697aa-334">**Domain Controller Options**</span></span> |<span data-ttu-id="697aa-335">**Heslo režimu obnovení adresářových služeb** = Contoso! 0000</span><span class="sxs-lookup"><span data-stu-id="697aa-335">**DSRM Password** = Contoso!0000</span></span><br/><span data-ttu-id="697aa-336">**Potvrzení hesla** = Contoso! 0000</span><span class="sxs-lookup"><span data-stu-id="697aa-336">**Confirm Password** = Contoso!0000</span></span> |
14. <span data-ttu-id="697aa-337">Klikněte na tlačítko **Další** projít dalších stránek v průvodci.</span><span class="sxs-lookup"><span data-stu-id="697aa-337">Click **Next** to go through the other pages in the wizard.</span></span> <span data-ttu-id="697aa-338">Na **Kontrola předpokladů** ověřte, že, zobrazí se následující zpráva: **všech požadovaných součástí byly úspěšně zkontrolovány**.</span><span class="sxs-lookup"><span data-stu-id="697aa-338">On the **Prerequisites Check** page, verify that you see the following message: **All prerequisite checks passed successfully**.</span></span> <span data-ttu-id="697aa-339">Můžete zkontrolovat všechny příslušné zprávy upozornění, ale je možné pokračovat v instalaci.</span><span class="sxs-lookup"><span data-stu-id="697aa-339">You can review any applicable warning messages, but it's possible to continue with the installation.</span></span>
15. <span data-ttu-id="697aa-340">Klikněte na **Nainstalovat**.</span><span class="sxs-lookup"><span data-stu-id="697aa-340">Click **Install**.</span></span> <span data-ttu-id="697aa-341">**Řadiče domény ad primární** virtuální počítač automaticky restartuje.</span><span class="sxs-lookup"><span data-stu-id="697aa-341">The **ad-primary-dc** virtual machine automatically reboots.</span></span>

### <a name="note-the-ip-address-of-the-primary-domain-controller"></a><span data-ttu-id="697aa-342">Poznamenejte si adresu IP primárního řadiče domény</span><span class="sxs-lookup"><span data-stu-id="697aa-342">Note the IP address of the primary domain controller</span></span>

<span data-ttu-id="697aa-343">Použijte primární řadič domény pro službu DNS.</span><span class="sxs-lookup"><span data-stu-id="697aa-343">Use the primary domain controller for DNS.</span></span> <span data-ttu-id="697aa-344">Všimněte si IP adresu řadiče domény.</span><span class="sxs-lookup"><span data-stu-id="697aa-344">Note the primary domain controller IP address.</span></span>

<span data-ttu-id="697aa-345">Jeden způsob, jak získat IP adresu řadiče domény je prostřednictvím portálu Azure.</span><span class="sxs-lookup"><span data-stu-id="697aa-345">One way to get the primary domain controller IP address is through the Azure portal.</span></span>

1. <span data-ttu-id="697aa-346">Na portálu Azure otevřete skupinu prostředků.</span><span class="sxs-lookup"><span data-stu-id="697aa-346">On the Azure portal, open the resource group.</span></span>

2. <span data-ttu-id="697aa-347">Klikněte na primárním řadiči domény.</span><span class="sxs-lookup"><span data-stu-id="697aa-347">Click the primary domain controller.</span></span>

3. <span data-ttu-id="697aa-348">V okně řadiče domény, klikněte na **síťových rozhraní**.</span><span class="sxs-lookup"><span data-stu-id="697aa-348">On the primary domain controller blade, click **Network interfaces**.</span></span>

![Síťová rozhraní](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/25-primarydcip.png)

<span data-ttu-id="697aa-350">Všimněte si, privátní IP adresu pro tento server.</span><span class="sxs-lookup"><span data-stu-id="697aa-350">Note the private IP address for this server.</span></span>

### <a name="configure-the-virtual-network-dns"></a><span data-ttu-id="697aa-351">Konfigurace virtuální sítě DNS</span><span class="sxs-lookup"><span data-stu-id="697aa-351">Configure the virtual network DNS</span></span>
<span data-ttu-id="697aa-352">Když vytvoříte první řadič domény a povolit DNS na prvním serveru, nakonfigurujte virtuální sítě na používání tohoto serveru DNS.</span><span class="sxs-lookup"><span data-stu-id="697aa-352">After you create the first domain controller and enable DNS on the first server, configure the virtual network to use this server for DNS.</span></span>

1. <span data-ttu-id="697aa-353">Na portálu Azure klikněte na virtuální síť.</span><span class="sxs-lookup"><span data-stu-id="697aa-353">In the Azure portal, click on the virtual network.</span></span>

2. <span data-ttu-id="697aa-354">V části **nastavení**, klikněte na tlačítko **DNS Server**.</span><span class="sxs-lookup"><span data-stu-id="697aa-354">Under **Settings**, click **DNS Server**.</span></span>

3. <span data-ttu-id="697aa-355">Klikněte na tlačítko **vlastní**a zadejte privátní IP adresu primárního řadiče domény.</span><span class="sxs-lookup"><span data-stu-id="697aa-355">Click **Custom**, and type the private IP address of the primary domain controller.</span></span>

4. <span data-ttu-id="697aa-356">Klikněte na **Uložit**.</span><span class="sxs-lookup"><span data-stu-id="697aa-356">Click **Save**.</span></span>

### <a name="configure-the-second-domain-controller"></a><span data-ttu-id="697aa-357">Konfigurace druhého řadiče domény</span><span class="sxs-lookup"><span data-stu-id="697aa-357">Configure the second domain controller</span></span>
<span data-ttu-id="697aa-358">Po restartování počítače primárním řadiči domény, můžete nakonfigurovat druhého řadiče domény.</span><span class="sxs-lookup"><span data-stu-id="697aa-358">After the primary domain controller reboots, you can configure the second domain controller.</span></span> <span data-ttu-id="697aa-359">Tento volitelný krok je pro vysokou dostupnost.</span><span class="sxs-lookup"><span data-stu-id="697aa-359">This optional step is for high availability.</span></span> <span data-ttu-id="697aa-360">Postupujte podle těchto kroků nakonfigurujete druhého řadiče domény:</span><span class="sxs-lookup"><span data-stu-id="697aa-360">Follow these steps to configure the second domain controller:</span></span>

1. <span data-ttu-id="697aa-361">Na portálu, otevřete **SQL-HA-RG** prostředku, skupiny a vyberte **řadiče domény ad sekundární** počítače.</span><span class="sxs-lookup"><span data-stu-id="697aa-361">In the portal, open the **SQL-HA-RG** resource group and select the **ad-secondary-dc** machine.</span></span> <span data-ttu-id="697aa-362">Na **řadiče domény ad sekundární** okně klikněte na tlačítko **Connect** otevřete soubor RDP pro přístup ke vzdálené ploše.</span><span class="sxs-lookup"><span data-stu-id="697aa-362">On the **ad-secondary-dc** blade, click **Connect** to open an RDP file for remote desktop access.</span></span>
2. <span data-ttu-id="697aa-363">Přihlaste se k virtuálnímu počítači pomocí účtu správce nakonfigurované (**BUILTIN\DomainAdmin**) a heslo (**Contoso! 0000**).</span><span class="sxs-lookup"><span data-stu-id="697aa-363">Sign in to the VM by using your configured administrator account (**BUILTIN\DomainAdmin**) and password (**Contoso!0000**).</span></span>
3. <span data-ttu-id="697aa-364">Změňte upřednostňovanou adresu serveru DNS na adresu řadiče domény.</span><span class="sxs-lookup"><span data-stu-id="697aa-364">Change the preferred DNS server address to the address of the domain controller.</span></span>
4. <span data-ttu-id="697aa-365">V **Centrum sítí a sdílení**, klikněte na síťové rozhraní.</span><span class="sxs-lookup"><span data-stu-id="697aa-365">In **Network and Sharing Center**, click the network interface.</span></span>
   <span data-ttu-id="697aa-366">![Síťové rozhraní](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/26-networkinterface.png)</span><span class="sxs-lookup"><span data-stu-id="697aa-366">![Network interface](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/26-networkinterface.png)</span></span>

5. <span data-ttu-id="697aa-367">Klikněte na **Vlastnosti**.</span><span class="sxs-lookup"><span data-stu-id="697aa-367">Click **Properties**.</span></span>
6. <span data-ttu-id="697aa-368">Vyberte **Internet Protocol verze 4 (TCP/IPv4)** a klikněte na tlačítko **vlastnosti**.</span><span class="sxs-lookup"><span data-stu-id="697aa-368">Select **Internet Protocol Version 4 (TCP/IPv4)** and click **Properties**.</span></span>
7. <span data-ttu-id="697aa-369">Vyberte **použít následující adresy serverů DNS** a zadat adresu primárním řadiči domény v **upřednostňovaný server DNS**.</span><span class="sxs-lookup"><span data-stu-id="697aa-369">Select **Use the following DNS server addresses** and specify the address of the primary domain controller in **Preferred DNS server**.</span></span>
8. <span data-ttu-id="697aa-370">Klikněte na tlačítko **OK**a potom **Zavřít** k provedení změn.</span><span class="sxs-lookup"><span data-stu-id="697aa-370">Click **OK**, and then **Close** to commit the changes.</span></span> <span data-ttu-id="697aa-371">Nyní budete moci připojit k virtuálnímu počítači **corp.contoso.com**.</span><span class="sxs-lookup"><span data-stu-id="697aa-371">You are now able to join the VM to **corp.contoso.com**.</span></span>

   >[!IMPORTANT]
   ><span data-ttu-id="697aa-372">Pokud ztratíte připojení k vzdálené ploše po změně nastavení DNS, přejděte na portál Azure a restartování virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="697aa-372">If you lose the connection to your remote desktop after changing the DNS setting, go to the Azure portal and restart the virtual machine.</span></span>

9. <span data-ttu-id="697aa-373">Vzdálenou plochu sekundární řadič domény, otevřete **řídicí panel Správce serveru**.</span><span class="sxs-lookup"><span data-stu-id="697aa-373">From the remote desktop to the secondary domain controller, open **Server Manager Dashboard**.</span></span>
10. <span data-ttu-id="697aa-374">Klikněte **přidat role a funkce** odkaz na řídicím panelu.</span><span class="sxs-lookup"><span data-stu-id="697aa-374">Click the **Add roles and features** link on the dashboard.</span></span>

    ![Správce serveru – přidání rolí](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/22-addfeatures.png)
11. <span data-ttu-id="697aa-376">Vyberte **Další** až na **role serveru** části.</span><span class="sxs-lookup"><span data-stu-id="697aa-376">Select **Next** until you get to the **Server Roles** section.</span></span>
12. <span data-ttu-id="697aa-377">Vyberte **Active Directory Domain Services** a **DNS Server** role.</span><span class="sxs-lookup"><span data-stu-id="697aa-377">Select the **Active Directory Domain Services** and **DNS Server** roles.</span></span> <span data-ttu-id="697aa-378">Když se zobrazí výzva, přidejte všechny další funkce, které jsou vyžadované tyto role.</span><span class="sxs-lookup"><span data-stu-id="697aa-378">When you're prompted, add any additional features that are required by these roles.</span></span>
13. <span data-ttu-id="697aa-379">Po dokončení instalace funkce vraťte k **správce serveru** řídicího panelu.</span><span class="sxs-lookup"><span data-stu-id="697aa-379">After the features finish installing, return to the **Server Manager** dashboard.</span></span>
14. <span data-ttu-id="697aa-380">Vyberte novou **služby AD DS** možnost v levém podokně.</span><span class="sxs-lookup"><span data-stu-id="697aa-380">Select the new **AD DS** option on the left-hand pane.</span></span>
15. <span data-ttu-id="697aa-381">Klikněte **Další** odkaz na žlutý pruh upozornění.</span><span class="sxs-lookup"><span data-stu-id="697aa-381">Click the **More** link on the yellow warning bar.</span></span>
16. <span data-ttu-id="697aa-382">V **akce** sloupec **všechny podrobnosti úlohy serveru** dialogové okno, klikněte na tlačítko **zvýšit úroveň tohoto serveru na řadič domény**.</span><span class="sxs-lookup"><span data-stu-id="697aa-382">In the **Action** column of the **All Server Task Details** dialog, click **Promote this server to a domain controller**.</span></span>
17. <span data-ttu-id="697aa-383">V části **konfigurace nasazení**, vyberte **přidat řadič domény do existující domény**.</span><span class="sxs-lookup"><span data-stu-id="697aa-383">Under **Deployment Configuration**, select **Add a domain controller to an existing domain**.</span></span>
   <span data-ttu-id="697aa-384">![Konfigurace nasazení](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/28-deploymentconfig.png)</span><span class="sxs-lookup"><span data-stu-id="697aa-384">![Deployment configuration](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/28-deploymentconfig.png)</span></span>
18. <span data-ttu-id="697aa-385">Klikněte na **Vybrat**.</span><span class="sxs-lookup"><span data-stu-id="697aa-385">Click **Select**.</span></span>
19. <span data-ttu-id="697aa-386">Připojit pomocí účtu správce (**CORP. CONTOSO.COM\domainadmin**) a heslo (**Contoso! 0000**).</span><span class="sxs-lookup"><span data-stu-id="697aa-386">Connect by using the administrator account (**CORP.CONTOSO.COM\domainadmin**) and password (**Contoso!0000**).</span></span>
20. <span data-ttu-id="697aa-387">V **vyberte doménu doménové struktuře**, klikněte na doménu a pak klikněte na tlačítko **OK**.</span><span class="sxs-lookup"><span data-stu-id="697aa-387">In **Select a domain from the forest**, click your domain, and then click **OK**.</span></span>
21. <span data-ttu-id="697aa-388">V **možnosti řadiče domény**, použijte výchozí hodnoty a nastavit heslo režimu obnovení adresářových služeb.</span><span class="sxs-lookup"><span data-stu-id="697aa-388">In **Domain Controller Options**, use the default values and set a DSRM password.</span></span>

   >[!NOTE]
   ><span data-ttu-id="697aa-389">**Možnosti služby DNS** stránky může varovat, že nelze vytvořit delegování pro tento server DNS.</span><span class="sxs-lookup"><span data-stu-id="697aa-389">The **DNS Options** page might warn you that a delegation for this DNS server can't be created.</span></span> <span data-ttu-id="697aa-390">Toto upozornění v testovacím prostředí můžete ignorovat.</span><span class="sxs-lookup"><span data-stu-id="697aa-390">You can ignore this warning in non-production environments.</span></span>
22. <span data-ttu-id="697aa-391">Klikněte na tlačítko **Další** dokud nedosáhne dialogu **požadavky** zkontrolujte.</span><span class="sxs-lookup"><span data-stu-id="697aa-391">Click **Next** until the dialog reaches the **Prerequisites** check.</span></span> <span data-ttu-id="697aa-392">Pak klikněte na **Nainstalovat**.</span><span class="sxs-lookup"><span data-stu-id="697aa-392">Then click **Install**.</span></span>

<span data-ttu-id="697aa-393">Jakmile server dokončí změny konfigurace, restartujte server.</span><span class="sxs-lookup"><span data-stu-id="697aa-393">After the server finishes the configuration changes, restart the server.</span></span>

### <a name="add-the-private-ip-address-to-the-second-domain-controller-to-the-vpn-dns-server"></a><span data-ttu-id="697aa-394">Přidejte privátní IP adresa druhého řadiče domény na server DNS sítě VPN</span><span class="sxs-lookup"><span data-stu-id="697aa-394">Add the Private IP Address to the second domain controller to the VPN DNS Server</span></span>

<span data-ttu-id="697aa-395">Na portálu Azure v rámci virtuální sítě změňte obsahující IP adresu řadiče domény sekundární Server DNS.</span><span class="sxs-lookup"><span data-stu-id="697aa-395">In the Azure portal, under virtual network, change the DNS Server to include the IP address of the secondary domain controller.</span></span> <span data-ttu-id="697aa-396">To umožňuje redundance služby DNS.</span><span class="sxs-lookup"><span data-stu-id="697aa-396">This allows the DNS service redundancy.</span></span>

### <span data-ttu-id="697aa-397"><a name=DomainAccounts></a>Konfigurovat účty domény</span><span class="sxs-lookup"><span data-stu-id="697aa-397"><a name=DomainAccounts></a> Configure the domain accounts</span></span>

<span data-ttu-id="697aa-398">V dalších krocích můžete nakonfigurovat účty služby Active Directory.</span><span class="sxs-lookup"><span data-stu-id="697aa-398">In the next steps, you configure the Active Directory accounts.</span></span> <span data-ttu-id="697aa-399">Následující tabulka uvádí účty:</span><span class="sxs-lookup"><span data-stu-id="697aa-399">The following table shows the accounts:</span></span>

| |<span data-ttu-id="697aa-400">Účet instalace</span><span class="sxs-lookup"><span data-stu-id="697aa-400">Installation account</span></span><br/> |<span data-ttu-id="697aa-401">SQL Server-0</span><span class="sxs-lookup"><span data-stu-id="697aa-401">sqlserver-0</span></span> <br/><span data-ttu-id="697aa-402">Účet systému SQL Server a služba SQL Agent</span><span class="sxs-lookup"><span data-stu-id="697aa-402">SQL Server and SQL Agent Service account</span></span> |<span data-ttu-id="697aa-403">SQL Server-1</span><span class="sxs-lookup"><span data-stu-id="697aa-403">sqlserver-1</span></span><br/><span data-ttu-id="697aa-404">Účet systému SQL Server a služba SQL Agent</span><span class="sxs-lookup"><span data-stu-id="697aa-404">SQL Server and SQL Agent Service account</span></span>
| --- | --- | --- | ---
|<span data-ttu-id="697aa-405">**Křestní jméno**</span><span class="sxs-lookup"><span data-stu-id="697aa-405">**First Name**</span></span> |<span data-ttu-id="697aa-406">Instalace</span><span class="sxs-lookup"><span data-stu-id="697aa-406">Install</span></span> |<span data-ttu-id="697aa-407">SQLSvc1</span><span class="sxs-lookup"><span data-stu-id="697aa-407">SQLSvc1</span></span> | <span data-ttu-id="697aa-408">SQLSvc2</span><span class="sxs-lookup"><span data-stu-id="697aa-408">SQLSvc2</span></span>
|<span data-ttu-id="697aa-409">**SamAccountName uživatele**</span><span class="sxs-lookup"><span data-stu-id="697aa-409">**User SamAccountName**</span></span> |<span data-ttu-id="697aa-410">Instalace</span><span class="sxs-lookup"><span data-stu-id="697aa-410">Install</span></span> |<span data-ttu-id="697aa-411">SQLSvc1</span><span class="sxs-lookup"><span data-stu-id="697aa-411">SQLSvc1</span></span> | <span data-ttu-id="697aa-412">SQLSvc2</span><span class="sxs-lookup"><span data-stu-id="697aa-412">SQLSvc2</span></span>

<span data-ttu-id="697aa-413">K vytvoření každého účtu použijte následující postup.</span><span class="sxs-lookup"><span data-stu-id="697aa-413">Use the following steps to create each account.</span></span>

1. <span data-ttu-id="697aa-414">Přihlaste se k **řadiče domény ad primární** počítače.</span><span class="sxs-lookup"><span data-stu-id="697aa-414">Sign in to the **ad-primary-dc** machine.</span></span>
2. <span data-ttu-id="697aa-415">V **správce serveru**, vyberte **nástroje**a potom klikněte na **Centrum správy služby Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="697aa-415">In **Server Manager**, select **Tools**, and then click **Active Directory Administrative Center**.</span></span>   
3. <span data-ttu-id="697aa-416">Vyberte **corp (místní)** v levém podokně.</span><span class="sxs-lookup"><span data-stu-id="697aa-416">Select **corp (local)** from the left pane.</span></span>
4. <span data-ttu-id="697aa-417">Na pravé straně **úlohy** podokně, vyberte **nový**a potom klikněte na **uživatele**.</span><span class="sxs-lookup"><span data-stu-id="697aa-417">On the right **Tasks** pane, select **New**, and then click **User**.</span></span>
   <span data-ttu-id="697aa-418">![Centrum správy služby Active Directory](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/29-addcnewuser.png)</span><span class="sxs-lookup"><span data-stu-id="697aa-418">![Active Directory Administrative Center](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/29-addcnewuser.png)</span></span>

   >[!TIP]
   ><span data-ttu-id="697aa-419">Nastavte pro každý účet složité heslo.</span><span class="sxs-lookup"><span data-stu-id="697aa-419">Set a complex password for each account.</span></span><br/> <span data-ttu-id="697aa-420">Pro nevýrobní prostředí nastavte uživatelský účet nikdy nevyprší.</span><span class="sxs-lookup"><span data-stu-id="697aa-420">For non-production environments, set the user account to never expire.</span></span>

5. <span data-ttu-id="697aa-421">Klikněte na tlačítko **OK** vytvořit uživateli.</span><span class="sxs-lookup"><span data-stu-id="697aa-421">Click **OK** to create the user.</span></span>
6. <span data-ttu-id="697aa-422">Opakujte předchozí kroky pro každou z uvedených účtů.</span><span class="sxs-lookup"><span data-stu-id="697aa-422">Repeat the preceding steps for each of the three accounts.</span></span>

### <a name="grant-the-required-permissions-to-the-installation-account"></a><span data-ttu-id="697aa-423">Přidělení požadovaných oprávnění k účtu instalace</span><span class="sxs-lookup"><span data-stu-id="697aa-423">Grant the required permissions to the installation account</span></span>
1. <span data-ttu-id="697aa-424">V **Centrum správy služby Active Directory**, vyberte **corp (místní)** v levém podokně.</span><span class="sxs-lookup"><span data-stu-id="697aa-424">In the **Active Directory Administrative Center**, select **corp (local)** in the left pane.</span></span> <span data-ttu-id="697aa-425">Poté v pravém **úlohy** podokně klikněte na tlačítko **vlastnosti**.</span><span class="sxs-lookup"><span data-stu-id="697aa-425">Then in the right-hand **Tasks** pane, click **Properties**.</span></span>

    ![Vlastnosti uživatele CORP](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/31-addcproperties.png)
2. <span data-ttu-id="697aa-427">Vyberte **rozšíření**a klikněte **Upřesnit** na tlačítko **zabezpečení** kartě.</span><span class="sxs-lookup"><span data-stu-id="697aa-427">Select **Extensions**, and then click the **Advanced** button on the **Security** tab.</span></span>
3. <span data-ttu-id="697aa-428">V **Upřesnit nastavení zabezpečení pro corp** dialogové okno, klikněte na tlačítko **přidat**.</span><span class="sxs-lookup"><span data-stu-id="697aa-428">In the **Advanced Security Settings for corp** dialog, click **Add**.</span></span>
4. <span data-ttu-id="697aa-429">Klikněte na tlačítko **vybrat objekt zabezpečení**, vyhledejte **CORP\Install**a potom klikněte na **OK**.</span><span class="sxs-lookup"><span data-stu-id="697aa-429">Click **Select a principal**, search for **CORP\Install**, and then click **OK**.</span></span>
5. <span data-ttu-id="697aa-430">Vyberte **číst vlastnosti všech** zaškrtávací políčko.</span><span class="sxs-lookup"><span data-stu-id="697aa-430">Select the **Read all properties** check box.</span></span>

6. <span data-ttu-id="697aa-431">Vyberte **vytvářet objekty počítačů** zaškrtávací políčko.</span><span class="sxs-lookup"><span data-stu-id="697aa-431">Select the **Create Computer objects** check box.</span></span>

     ![Oprávnění uživatele Corp](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/33-addpermissions.png)
7. <span data-ttu-id="697aa-433">Klikněte na tlačítko **OK**a potom klikněte na **OK** znovu.</span><span class="sxs-lookup"><span data-stu-id="697aa-433">Click **OK**, and then click **OK** again.</span></span> <span data-ttu-id="697aa-434">Zavřít **corp** vlastnosti – okno.</span><span class="sxs-lookup"><span data-stu-id="697aa-434">Close the **corp** properties window.</span></span>

<span data-ttu-id="697aa-435">Teď, když jste dokončili konfigurace služby Active Directory a uživatelských objektů, vytvořte dva virtuální počítače SQL serveru a serveru s kopií clusteru virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="697aa-435">Now that you've finished configuring Active Directory and the user objects, create two SQL Server VMs and a witness server VM.</span></span> <span data-ttu-id="697aa-436">Potom připojí všechny tři k doméně.</span><span class="sxs-lookup"><span data-stu-id="697aa-436">Then join all three to the domain.</span></span>

## <a name="create-sql-server-vms"></a><span data-ttu-id="697aa-437">Vytvoření virtuálních počítačů serveru SQL</span><span class="sxs-lookup"><span data-stu-id="697aa-437">Create SQL Server VMs</span></span>

<span data-ttu-id="697aa-438">Vytvořte tři další virtuální počítače.</span><span class="sxs-lookup"><span data-stu-id="697aa-438">Create three additional virtual machines.</span></span> <span data-ttu-id="697aa-439">Řešení vyžaduje dva virtuální počítače s instancí systému SQL Server.</span><span class="sxs-lookup"><span data-stu-id="697aa-439">The solution requires two virtual machines with SQL Server instances.</span></span> <span data-ttu-id="697aa-440">Třetí virtuální počítač bude fungovat jako určující.</span><span class="sxs-lookup"><span data-stu-id="697aa-440">A third virtual machine will function as a witness.</span></span> <span data-ttu-id="697aa-441">Můžete použít Windows Server 2016 [cloudu určující](http://docs.microsoft.com/windows-server/failover-clustering/deploy-cloud-witness), ale tento dokument konzistenci předchozích operačních systémech používá virtuální počítač pro určující.</span><span class="sxs-lookup"><span data-stu-id="697aa-441">Windows Server 2016 can use a [cloud witness](http://docs.microsoft.com/windows-server/failover-clustering/deploy-cloud-witness), however for consistency with previous operating systems this document uses a virtual machine for a witness.</span></span>  

<span data-ttu-id="697aa-442">Než budete pokračovat, zvažte následující rozhodnutí deisign.</span><span class="sxs-lookup"><span data-stu-id="697aa-442">Before you proceed consider the following deisign decisions.</span></span>

* <span data-ttu-id="697aa-443">**Úložiště – spravované Azure disky**</span><span class="sxs-lookup"><span data-stu-id="697aa-443">**Storage - Azure Managed Disks**</span></span>

   <span data-ttu-id="697aa-444">Pro úložiště virtuálního počítače použijte Azure spravované disky.</span><span class="sxs-lookup"><span data-stu-id="697aa-444">For the virtual machine storage, use Azure Managed Disks.</span></span> <span data-ttu-id="697aa-445">Společnost Microsoft doporučuje spravované disky pro virtuální počítače systému SQL Server.</span><span class="sxs-lookup"><span data-stu-id="697aa-445">Microsoft recommends Managed Disks for SQL Server virtual machines.</span></span> <span data-ttu-id="697aa-446">Služba Managed Disks se stará o úložiště na pozadí.</span><span class="sxs-lookup"><span data-stu-id="697aa-446">Managed Disks handles storage behind the scenes.</span></span> <span data-ttu-id="697aa-447">Navíc, pokud jsou virtuální počítače se službou Managed Disks ve stejné skupině dostupnosti, Azure distribuuje prostředky úložiště pro zajištění odpovídající redundance.</span><span class="sxs-lookup"><span data-stu-id="697aa-447">In addition, when virtual machines with Managed Disks are in the same availability set, Azure distributes the storage resources to provide appropriate redundancy.</span></span> <span data-ttu-id="697aa-448">Další informace najdete v tématu [Přehled služby Azure Managed Disks](../managed-disks-overview.md).</span><span class="sxs-lookup"><span data-stu-id="697aa-448">For additional information, see [Azure Managed Disks Overview](../managed-disks-overview.md).</span></span> <span data-ttu-id="697aa-449">Podrobnosti o spravovaných disků v nastavení dostupnosti, najdete v části [použijte spravované disky pro virtuální počítače v nastavení dostupnosti](../manage-availability.md#use-managed-disks-for-vms-in-an-availability-set).</span><span class="sxs-lookup"><span data-stu-id="697aa-449">For specifics about managed disks in an availability set, see [Use Managed Disks for VMs in an availability set](../manage-availability.md#use-managed-disks-for-vms-in-an-availability-set).</span></span>

* <span data-ttu-id="697aa-450">**Síť – privátní IP adresy v produkčním prostředí**</span><span class="sxs-lookup"><span data-stu-id="697aa-450">**Network - Private IP addresses in production**</span></span>

   <span data-ttu-id="697aa-451">Pro virtuální počítače tento kurz používá veřejné IP adresy.</span><span class="sxs-lookup"><span data-stu-id="697aa-451">For the virtual machines, this tutorial uses public IP addresses.</span></span> <span data-ttu-id="697aa-452">To umožňuje vzdálené připojení přímo k virtuálnímu počítači přes internet – umožňuje jednodušší kroky konfigurace.</span><span class="sxs-lookup"><span data-stu-id="697aa-452">This enables remote connection directly to the virtual machine over the internet - it makes configuration steps easier.</span></span> <span data-ttu-id="697aa-453">V produkčním prostředí společnost Microsoft doporučuje pouze privátních IP adres kvůli snížení nároků ohrožení zabezpečení instance serveru SQL Server prostředků virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="697aa-453">In production environments, Microsoft recommends only private IP addresses in order to reduce the vulnerability footprint of the SQL Server instance VM resource.</span></span>

### <a name="create-and-configure-the-sql-server-vms"></a><span data-ttu-id="697aa-454">Vytvoření a konfigurace virtuálních počítačů serveru SQL</span><span class="sxs-lookup"><span data-stu-id="697aa-454">Create and configure the SQL Server VMs</span></span>
<span data-ttu-id="697aa-455">Dále vytvořte tři virtuální počítače – dva virtuální počítače serveru SQL a virtuálního počítače pro do dodatečného uzlu clusteru.</span><span class="sxs-lookup"><span data-stu-id="697aa-455">Next, create three VMs--two SQL Server VMs and a VM for an additional cluster node.</span></span> <span data-ttu-id="697aa-456">Chcete-li vytvořit všech virtuálních počítačích, přejděte zpět na **SQL-HA-RG** skupinu prostředků, klikněte na tlačítko **přidat**, vyhledejte položku odpovídající galerie, klikněte na **virtuálního počítače**a potom klikněte na **z Galerie**.</span><span class="sxs-lookup"><span data-stu-id="697aa-456">To create each of the VMs, go back to the **SQL-HA-RG** resource group, click **Add**, search for the appropriate gallery item, click **Virtual Machine**, and then click **From Gallery**.</span></span> <span data-ttu-id="697aa-457">Použijte informace v následující tabulce vám pomohou vytvořit virtuální počítače:</span><span class="sxs-lookup"><span data-stu-id="697aa-457">Use the information in the following table to help you create the VMs:</span></span>


| <span data-ttu-id="697aa-458">Stránka</span><span class="sxs-lookup"><span data-stu-id="697aa-458">Page</span></span> | <span data-ttu-id="697aa-459">VM1</span><span class="sxs-lookup"><span data-stu-id="697aa-459">VM1</span></span> | <span data-ttu-id="697aa-460">VIRTUÁLNÍHO POČÍTAČE 2</span><span class="sxs-lookup"><span data-stu-id="697aa-460">VM2</span></span> | <span data-ttu-id="697aa-461">VM3</span><span class="sxs-lookup"><span data-stu-id="697aa-461">VM3</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="697aa-462">Vyberte položky odpovídající Galerie</span><span class="sxs-lookup"><span data-stu-id="697aa-462">Select the appropriate gallery item</span></span> |<span data-ttu-id="697aa-463">**Windows Server 2016 Datacenter**</span><span class="sxs-lookup"><span data-stu-id="697aa-463">**Windows Server 2016 Datacenter**</span></span> |<span data-ttu-id="697aa-464">**SQL Server 2016 SP1 Enterprise na systém Windows Server 2016**</span><span class="sxs-lookup"><span data-stu-id="697aa-464">**SQL Server 2016 SP1 Enterprise on Windows Server 2016**</span></span> |<span data-ttu-id="697aa-465">**SQL Server 2016 SP1 Enterprise na systém Windows Server 2016**</span><span class="sxs-lookup"><span data-stu-id="697aa-465">**SQL Server 2016 SP1 Enterprise on Windows Server 2016**</span></span> |
| <span data-ttu-id="697aa-466">Konfigurace virtuálního počítače **základy**</span><span class="sxs-lookup"><span data-stu-id="697aa-466">Virtual machine configuration **Basics**</span></span> |<span data-ttu-id="697aa-467">**Název** = fsw clusteru</span><span class="sxs-lookup"><span data-stu-id="697aa-467">**Name** = cluster-fsw</span></span><br/><span data-ttu-id="697aa-468">**Uživatelské jméno** = DomainAdmin</span><span class="sxs-lookup"><span data-stu-id="697aa-468">**User Name** = DomainAdmin</span></span><br/><span data-ttu-id="697aa-469">**Heslo** = Contoso! 0000</span><span class="sxs-lookup"><span data-stu-id="697aa-469">**Password** = Contoso!0000</span></span><br/><span data-ttu-id="697aa-470">**Předplatné** = vaše předplatné</span><span class="sxs-lookup"><span data-stu-id="697aa-470">**Subscription** = Your subscription</span></span><br/><span data-ttu-id="697aa-471">**Skupina prostředků** = SQL-HA-RG</span><span class="sxs-lookup"><span data-stu-id="697aa-471">**Resource group** = SQL-HA-RG</span></span><br/><span data-ttu-id="697aa-472">**Umístění** = vaše umístění azure</span><span class="sxs-lookup"><span data-stu-id="697aa-472">**Location** = Your azure location</span></span> |<span data-ttu-id="697aa-473">**Název** sqlserver-0 =</span><span class="sxs-lookup"><span data-stu-id="697aa-473">**Name** = sqlserver-0</span></span><br/><span data-ttu-id="697aa-474">**Uživatelské jméno** = DomainAdmin</span><span class="sxs-lookup"><span data-stu-id="697aa-474">**User Name** = DomainAdmin</span></span><br/><span data-ttu-id="697aa-475">**Heslo** = Contoso! 0000</span><span class="sxs-lookup"><span data-stu-id="697aa-475">**Password** = Contoso!0000</span></span><br/><span data-ttu-id="697aa-476">**Předplatné** = vaše předplatné</span><span class="sxs-lookup"><span data-stu-id="697aa-476">**Subscription** = Your subscription</span></span><br/><span data-ttu-id="697aa-477">**Skupina prostředků** = SQL-HA-RG</span><span class="sxs-lookup"><span data-stu-id="697aa-477">**Resource group** = SQL-HA-RG</span></span><br/><span data-ttu-id="697aa-478">**Umístění** = vaše umístění azure</span><span class="sxs-lookup"><span data-stu-id="697aa-478">**Location** = Your azure location</span></span> |<span data-ttu-id="697aa-479">**Název** = sqlserver-1</span><span class="sxs-lookup"><span data-stu-id="697aa-479">**Name** = sqlserver-1</span></span><br/><span data-ttu-id="697aa-480">**Uživatelské jméno** = DomainAdmin</span><span class="sxs-lookup"><span data-stu-id="697aa-480">**User Name** = DomainAdmin</span></span><br/><span data-ttu-id="697aa-481">**Heslo** = Contoso! 0000</span><span class="sxs-lookup"><span data-stu-id="697aa-481">**Password** = Contoso!0000</span></span><br/><span data-ttu-id="697aa-482">**Předplatné** = vaše předplatné</span><span class="sxs-lookup"><span data-stu-id="697aa-482">**Subscription** = Your subscription</span></span><br/><span data-ttu-id="697aa-483">**Skupina prostředků** = SQL-HA-RG</span><span class="sxs-lookup"><span data-stu-id="697aa-483">**Resource group** = SQL-HA-RG</span></span><br/><span data-ttu-id="697aa-484">**Umístění** = vaše umístění azure</span><span class="sxs-lookup"><span data-stu-id="697aa-484">**Location** = Your azure location</span></span> |
| <span data-ttu-id="697aa-485">Konfigurace virtuálního počítače **velikost**</span><span class="sxs-lookup"><span data-stu-id="697aa-485">Virtual machine configuration **Size**</span></span> |<span data-ttu-id="697aa-486">**VELIKOST** = DS1\_V2 (1 jádro, 3.5 GB)</span><span class="sxs-lookup"><span data-stu-id="697aa-486">**SIZE** = DS1\_V2 (1 core, 3.5 GB)</span></span> |<span data-ttu-id="697aa-487">**VELIKOST** = DS2\_V2 (2 jádra, 7 GB)</span><span class="sxs-lookup"><span data-stu-id="697aa-487">**SIZE** = DS2\_V2 (2 cores, 7 GB)</span></span></br><span data-ttu-id="697aa-488">Velikost musí podporovat úložiště SSD (podpora disku Premium.</span><span class="sxs-lookup"><span data-stu-id="697aa-488">The size must support SSD storage (Premium disk support.</span></span> <span data-ttu-id="697aa-489">))</span><span class="sxs-lookup"><span data-stu-id="697aa-489">))</span></span> |<span data-ttu-id="697aa-490">**VELIKOST** = DS2\_V2 (2 jádra, 7 GB)</span><span class="sxs-lookup"><span data-stu-id="697aa-490">**SIZE** = DS2\_V2 (2 cores, 7 GB)</span></span> |
| <span data-ttu-id="697aa-491">Konfigurace virtuálního počítače **nastavení**</span><span class="sxs-lookup"><span data-stu-id="697aa-491">Virtual machine configuration **Settings**</span></span> |<span data-ttu-id="697aa-492">**Úložiště**: použijte spravované disky.</span><span class="sxs-lookup"><span data-stu-id="697aa-492">**Storage**: Use managed disks.</span></span><br/><span data-ttu-id="697aa-493">**Virtuální síť** = autoHAVNET</span><span class="sxs-lookup"><span data-stu-id="697aa-493">**Virtual network** = autoHAVNET</span></span><br/><span data-ttu-id="697aa-494">**Podsíť** = sqlsubnet(10.1.1.0/24)</span><span class="sxs-lookup"><span data-stu-id="697aa-494">**Subnet** = sqlsubnet(10.1.1.0/24)</span></span><br/><span data-ttu-id="697aa-495">**Veřejná IP adresa** automaticky generovaný.</span><span class="sxs-lookup"><span data-stu-id="697aa-495">**Public IP address** automatically generated.</span></span><br/><span data-ttu-id="697aa-496">**Skupina zabezpečení sítě** = None</span><span class="sxs-lookup"><span data-stu-id="697aa-496">**Network security group** = None</span></span><br/><span data-ttu-id="697aa-497">**Monitorování diagnostiky** = povoleno</span><span class="sxs-lookup"><span data-stu-id="697aa-497">**Monitoring Diagnostics** = Enabled</span></span><br/><span data-ttu-id="697aa-498">**Účet úložiště diagnostiky** = použít účet úložiště automaticky generované</span><span class="sxs-lookup"><span data-stu-id="697aa-498">**Diagnostics storage account** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="697aa-499">**Skupina dostupnosti** = sqlAvailabilitySet</span><span class="sxs-lookup"><span data-stu-id="697aa-499">**Availability set** = sqlAvailabilitySet</span></span><br/> |<span data-ttu-id="697aa-500">**Úložiště**: použijte spravované disky.</span><span class="sxs-lookup"><span data-stu-id="697aa-500">**Storage**: Use managed disks.</span></span><br/><span data-ttu-id="697aa-501">**Virtuální síť** = autoHAVNET</span><span class="sxs-lookup"><span data-stu-id="697aa-501">**Virtual network** = autoHAVNET</span></span><br/><span data-ttu-id="697aa-502">**Podsíť** = sqlsubnet(10.1.1.0/24)</span><span class="sxs-lookup"><span data-stu-id="697aa-502">**Subnet** = sqlsubnet(10.1.1.0/24)</span></span><br/><span data-ttu-id="697aa-503">**Veřejná IP adresa** automaticky generovaný.</span><span class="sxs-lookup"><span data-stu-id="697aa-503">**Public IP address** automatically generated.</span></span><br/><span data-ttu-id="697aa-504">**Skupina zabezpečení sítě** = None</span><span class="sxs-lookup"><span data-stu-id="697aa-504">**Network security group** = None</span></span><br/><span data-ttu-id="697aa-505">**Monitorování diagnostiky** = povoleno</span><span class="sxs-lookup"><span data-stu-id="697aa-505">**Monitoring Diagnostics** = Enabled</span></span><br/><span data-ttu-id="697aa-506">**Účet úložiště diagnostiky** = použít účet úložiště automaticky generované</span><span class="sxs-lookup"><span data-stu-id="697aa-506">**Diagnostics storage account** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="697aa-507">**Skupina dostupnosti** = sqlAvailabilitySet</span><span class="sxs-lookup"><span data-stu-id="697aa-507">**Availability set** = sqlAvailabilitySet</span></span><br/> |<span data-ttu-id="697aa-508">**Úložiště**: použijte spravované disky.</span><span class="sxs-lookup"><span data-stu-id="697aa-508">**Storage**: Use managed disks.</span></span><br/><span data-ttu-id="697aa-509">**Virtuální síť** = autoHAVNET</span><span class="sxs-lookup"><span data-stu-id="697aa-509">**Virtual network** = autoHAVNET</span></span><br/><span data-ttu-id="697aa-510">**Podsíť** = sqlsubnet(10.1.1.0/24)</span><span class="sxs-lookup"><span data-stu-id="697aa-510">**Subnet** = sqlsubnet(10.1.1.0/24)</span></span><br/><span data-ttu-id="697aa-511">**Veřejná IP adresa** automaticky generovaný.</span><span class="sxs-lookup"><span data-stu-id="697aa-511">**Public IP address** automatically generated.</span></span><br/><span data-ttu-id="697aa-512">**Skupina zabezpečení sítě** = None</span><span class="sxs-lookup"><span data-stu-id="697aa-512">**Network security group** = None</span></span><br/><span data-ttu-id="697aa-513">**Monitorování diagnostiky** = povoleno</span><span class="sxs-lookup"><span data-stu-id="697aa-513">**Monitoring Diagnostics** = Enabled</span></span><br/><span data-ttu-id="697aa-514">**Účet úložiště diagnostiky** = použít účet úložiště automaticky generované</span><span class="sxs-lookup"><span data-stu-id="697aa-514">**Diagnostics storage account** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="697aa-515">**Skupina dostupnosti** = sqlAvailabilitySet</span><span class="sxs-lookup"><span data-stu-id="697aa-515">**Availability set** = sqlAvailabilitySet</span></span><br/> |
| <span data-ttu-id="697aa-516">Konfigurace virtuálního počítače **nastavení systému SQL Server**</span><span class="sxs-lookup"><span data-stu-id="697aa-516">Virtual machine configuration **SQL Server settings**</span></span> |<span data-ttu-id="697aa-517">Neuvedeno</span><span class="sxs-lookup"><span data-stu-id="697aa-517">Not applicable</span></span> |<span data-ttu-id="697aa-518">**Připojení k SQL** = privátní (uvnitř virtuální sítě)</span><span class="sxs-lookup"><span data-stu-id="697aa-518">**SQL connectivity** = Private (within Virtual Network)</span></span><br/><span data-ttu-id="697aa-519">**Port** = 1433</span><span class="sxs-lookup"><span data-stu-id="697aa-519">**Port** = 1433</span></span><br/><span data-ttu-id="697aa-520">**Ověřování SQL** = zakázat</span><span class="sxs-lookup"><span data-stu-id="697aa-520">**SQL Authentication** = Disable</span></span><br/><span data-ttu-id="697aa-521">**Konfigurace úložiště** = obecné</span><span class="sxs-lookup"><span data-stu-id="697aa-521">**Storage configuration** = General</span></span><br/><span data-ttu-id="697aa-522">**Automatizované opravy** = neděle na 2:00</span><span class="sxs-lookup"><span data-stu-id="697aa-522">**Automated patching** = Sunday at 2:00</span></span><br/><span data-ttu-id="697aa-523">**Automatizované zálohování** = zakázáno</span><span class="sxs-lookup"><span data-stu-id="697aa-523">**Automated backup** = Disabled</span></span></br><span data-ttu-id="697aa-524">**Integrace se službou Azure Key Vault** = zakázáno</span><span class="sxs-lookup"><span data-stu-id="697aa-524">**Azure Key Vault integration** = Disabled</span></span> |<span data-ttu-id="697aa-525">**Připojení k SQL** = privátní (uvnitř virtuální sítě)</span><span class="sxs-lookup"><span data-stu-id="697aa-525">**SQL connectivity** = Private (within Virtual Network)</span></span><br/><span data-ttu-id="697aa-526">**Port** = 1433</span><span class="sxs-lookup"><span data-stu-id="697aa-526">**Port** = 1433</span></span><br/><span data-ttu-id="697aa-527">**Ověřování SQL** = zakázat</span><span class="sxs-lookup"><span data-stu-id="697aa-527">**SQL Authentication** = Disable</span></span><br/><span data-ttu-id="697aa-528">**Konfigurace úložiště** = obecné</span><span class="sxs-lookup"><span data-stu-id="697aa-528">**Storage configuration** = General</span></span><br/><span data-ttu-id="697aa-529">**Automatizované opravy** = neděle na 2:00</span><span class="sxs-lookup"><span data-stu-id="697aa-529">**Automated patching** = Sunday at 2:00</span></span><br/><span data-ttu-id="697aa-530">**Automatizované zálohování** = zakázáno</span><span class="sxs-lookup"><span data-stu-id="697aa-530">**Automated backup** = Disabled</span></span></br><span data-ttu-id="697aa-531">**Integrace se službou Azure Key Vault** = zakázáno</span><span class="sxs-lookup"><span data-stu-id="697aa-531">**Azure Key Vault integration** = Disabled</span></span> |

<br/>

> [!NOTE]
> <span data-ttu-id="697aa-532">Velikosti počítačů navrhované tady jsou určené pro testování skupin dostupnosti ve virtuálních počítačích Azure.</span><span class="sxs-lookup"><span data-stu-id="697aa-532">The machine sizes suggested here are meant for testing availability groups in Azure VMs.</span></span> <span data-ttu-id="697aa-533">Nejlepšího výkonu dosáhnete v produkčním prostředí, najdete v části doporučení pro velikosti počítačů systému SQL Server a konfigurace v [nejlepší postupy z hlediska výkonu pro SQL Server na virtuálních počítačích Azure](virtual-machines-windows-sql-performance.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="697aa-533">For the best performance on production workloads, see the recommendations for SQL Server machine sizes and configuration in [Performance best practices for SQL Server in Azure virtual machines](virtual-machines-windows-sql-performance.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>
>
>

<span data-ttu-id="697aa-534">Po tři virtuální počítače jsou plně zřízený, je nutné připojit, aby **corp.contoso.com** domény a přidělit CORP\Install práva správce na počítače.</span><span class="sxs-lookup"><span data-stu-id="697aa-534">After the three VMs are fully provisioned, you need to join them to the **corp.contoso.com** domain and grant CORP\Install administrative rights to the machines.</span></span>

### <span data-ttu-id="697aa-535"><a name="joinDomain"></a>Připojení serveru k doméně</span><span class="sxs-lookup"><span data-stu-id="697aa-535"><a name="joinDomain"></a>Join the servers to the domain</span></span>

<span data-ttu-id="697aa-536">Teď už moct připojit virtuální počítače na **corp.contoso.com**. Udělejte pro virtuální počítače SQL serveru i souborovém serveru určující sdílené složky:</span><span class="sxs-lookup"><span data-stu-id="697aa-536">You're now able to join the VMs to **corp.contoso.com**. Do the following for both the SQL Server VMs and the file share witness server:</span></span>

1. <span data-ttu-id="697aa-537">Vzdálené připojení k virtuálnímu počítači s **BUILTIN\DomainAdmin**.</span><span class="sxs-lookup"><span data-stu-id="697aa-537">Remotely connect to the virtual machine with **BUILTIN\DomainAdmin**.</span></span>
2. <span data-ttu-id="697aa-538">V **správce serveru**, klikněte na tlačítko **místní Server**.</span><span class="sxs-lookup"><span data-stu-id="697aa-538">In **Server Manager**, click **Local Server**.</span></span>
3. <span data-ttu-id="697aa-539">Klikněte **pracovní skupiny** odkaz.</span><span class="sxs-lookup"><span data-stu-id="697aa-539">Click the **WORKGROUP** link.</span></span>
4. <span data-ttu-id="697aa-540">V **název počítače** klikněte na tlačítko **změnu**.</span><span class="sxs-lookup"><span data-stu-id="697aa-540">In the **Computer Name** section, click **Change**.</span></span>
5. <span data-ttu-id="697aa-541">Vyberte **domény** zaškrtávací políčko a zadejte **corp.contoso.com** v textovém poli.</span><span class="sxs-lookup"><span data-stu-id="697aa-541">Select the **Domain** check box and type **corp.contoso.com** in the text box.</span></span> <span data-ttu-id="697aa-542">Klikněte na **OK**.</span><span class="sxs-lookup"><span data-stu-id="697aa-542">Click **OK**.</span></span>
6. <span data-ttu-id="697aa-543">V **zabezpečení systému Windows** místní dialogové okno, zadejte pověření pro účet správce domény výchozí (**CORP\DomainAdmin**) a heslo (**Contoso! 0000**).</span><span class="sxs-lookup"><span data-stu-id="697aa-543">In the **Windows Security** popup dialog, specify the credentials for the default domain administrator account (**CORP\DomainAdmin**) and the password (**Contoso!0000**).</span></span>
7. <span data-ttu-id="697aa-544">Když se zobrazí zpráva "Vítejte v doméně corp.contoso.com", klikněte na tlačítko **OK**.</span><span class="sxs-lookup"><span data-stu-id="697aa-544">When you see the "Welcome to the corp.contoso.com domain" message, click **OK**.</span></span>
8. <span data-ttu-id="697aa-545">Klikněte na tlačítko **Zavřít**a potom klikněte na **restartovat nyní** v automaticky otevřeném okně. dialog.</span><span class="sxs-lookup"><span data-stu-id="697aa-545">Click **Close**, and then click **Restart Now** in the popup dialog.</span></span>

### <a name="add-the-corpinstall-user-as-an-administrator-on-each-cluster-vm"></a><span data-ttu-id="697aa-546">Přidejte Corp\Install uživatele s oprávněními správce na každý cluster virtuálních počítačů</span><span class="sxs-lookup"><span data-stu-id="697aa-546">Add the Corp\Install user as an administrator on each cluster VM</span></span>

<span data-ttu-id="697aa-547">Po restartování každý virtuální počítač jako člena domény, přidejte **CORP\Install** jako člen místní skupiny administrators.</span><span class="sxs-lookup"><span data-stu-id="697aa-547">After each virtual machine restarts as a member of the domain, add **CORP\Install** as a member of the local administrators group.</span></span>

1. <span data-ttu-id="697aa-548">Počkejte, až po restartování virtuálního počítače a potom spusťte soubor RDP znovu z primárního řadiče domény se přihlásit k **sqlserver-0** pomocí **CORP\DomainAdmin** účtu.</span><span class="sxs-lookup"><span data-stu-id="697aa-548">Wait until the VM is restarted, then launch the RDP file again from the primary domain controller to sign in to **sqlserver-0** by using the **CORP\DomainAdmin** account.</span></span>
   >[!TIP]
   ><span data-ttu-id="697aa-549">Ujistěte se, přihlásit pomocí účtu správce domény.</span><span class="sxs-lookup"><span data-stu-id="697aa-549">Make sure that you sign in with the domain administrator account.</span></span> <span data-ttu-id="697aa-550">V předchozích krocích jste používali účet správce VYTVOŘENÉ v.</span><span class="sxs-lookup"><span data-stu-id="697aa-550">In the previous steps, you were using the BUILT IN administrator account.</span></span> <span data-ttu-id="697aa-551">Teď, když je server v doméně, použijte účet domény.</span><span class="sxs-lookup"><span data-stu-id="697aa-551">Now that the server is in the domain, use the domain account.</span></span> <span data-ttu-id="697aa-552">V relaci RDP, zadejte *domény*\\*uživatelské jméno*.</span><span class="sxs-lookup"><span data-stu-id="697aa-552">In your RDP session, specify *DOMAIN*\\*username*.</span></span>

2. <span data-ttu-id="697aa-553">V **správce serveru**, vyberte **nástroje**a potom klikněte na **Správa počítače**.</span><span class="sxs-lookup"><span data-stu-id="697aa-553">In **Server Manager**, select **Tools**, and then click **Computer Management**.</span></span>
3. <span data-ttu-id="697aa-554">V **Správa počítače** okně rozbalte **místní uživatelé a skupiny**a potom vyberte **skupiny**.</span><span class="sxs-lookup"><span data-stu-id="697aa-554">In the **Computer Management** window, expand **Local Users and Groups**, and then select **Groups**.</span></span>
4. <span data-ttu-id="697aa-555">Dvakrát klikněte **správci** skupiny.</span><span class="sxs-lookup"><span data-stu-id="697aa-555">Double-click the **Administrators** group.</span></span>
5. <span data-ttu-id="697aa-556">V **správci vlastnosti** dialogové okno, klikněte na tlačítko **přidat** tlačítko.</span><span class="sxs-lookup"><span data-stu-id="697aa-556">In the **Administrators Properties** dialog, click the **Add** button.</span></span>
6. <span data-ttu-id="697aa-557">Zadejte uživatele **CORP\Install**a potom klikněte na **OK**.</span><span class="sxs-lookup"><span data-stu-id="697aa-557">Enter the user **CORP\Install**, and then click **OK**.</span></span>
7. <span data-ttu-id="697aa-558">Klikněte na tlačítko **OK** zavřete **vlastností správce** dialogové okno.</span><span class="sxs-lookup"><span data-stu-id="697aa-558">Click **OK** to close the **Administrator Properties** dialog.</span></span>
8. <span data-ttu-id="697aa-559">Opakujte předchozí kroky na **sqlserver-1** a **clusteru fsw**.</span><span class="sxs-lookup"><span data-stu-id="697aa-559">Repeat the previous steps on **sqlserver-1** and **cluster-fsw**.</span></span>

### <span data-ttu-id="697aa-560"><a name="setServiceAccount"></a>Nastavit účty služby SQL Server</span><span class="sxs-lookup"><span data-stu-id="697aa-560"><a name="setServiceAccount"></a>Set the SQL Server service accounts</span></span>

<span data-ttu-id="697aa-561">Na každý virtuální počítač SQL Server nastavte účet služby SQL Server.</span><span class="sxs-lookup"><span data-stu-id="697aa-561">On each SQL Server VM, set the SQL Server service account.</span></span> <span data-ttu-id="697aa-562">Používání účtů, které jste vytvořili při zpracování je [nakonfigurované účty domény](#DomainAccounts).</span><span class="sxs-lookup"><span data-stu-id="697aa-562">Use the accounts that you created when you [configured the domain accounts](#DomainAccounts).</span></span>

1. <span data-ttu-id="697aa-563">Otevřete **Správce konfigurace systému SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="697aa-563">Open **SQL Server Configuration Manager**.</span></span>
2. <span data-ttu-id="697aa-564">Klikněte pravým tlačítkem na službu SQL Server a pak klikněte na **vlastnosti**.</span><span class="sxs-lookup"><span data-stu-id="697aa-564">Right-click the SQL Server service, and then click **Properties**.</span></span>
3. <span data-ttu-id="697aa-565">Nastavte účet a heslo.</span><span class="sxs-lookup"><span data-stu-id="697aa-565">Set the account and password.</span></span>
4. <span data-ttu-id="697aa-566">Opakujte tyto kroky na další počítač serveru SQL.</span><span class="sxs-lookup"><span data-stu-id="697aa-566">Repeat these steps on the other SQL Server VM.</span></span>  

<span data-ttu-id="697aa-567">Pro skupiny dostupnosti systému SQL Server musí každý virtuální počítač SQL Server spustit jako účet domény.</span><span class="sxs-lookup"><span data-stu-id="697aa-567">For SQL Server availability groups, each SQL Server VM needs to run as a domain account.</span></span>

### <a name="create-a-sign-in-on-each-sql-server-vm-for-the-installation-account"></a><span data-ttu-id="697aa-568">Vytvořte na každý virtuální počítač SQL Server k účtu instalace přihlášení</span><span class="sxs-lookup"><span data-stu-id="697aa-568">Create a sign-in on each SQL Server VM for the installation account</span></span>

<span data-ttu-id="697aa-569">Použijte účet instalace (CORP\install) ke konfiguraci skupiny dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="697aa-569">Use the installation account (CORP\install) to configure the availability group.</span></span> <span data-ttu-id="697aa-570">Tento účet musí být členem skupiny **sysadmin** pevné role serveru na každý virtuální počítač SQL Server.</span><span class="sxs-lookup"><span data-stu-id="697aa-570">This account needs to be a member of the **sysadmin** fixed server role on each SQL Server VM.</span></span> <span data-ttu-id="697aa-571">Přihlášení k účtu instalace vytvořit následující kroky:</span><span class="sxs-lookup"><span data-stu-id="697aa-571">The following steps create a sign-in for the installation account:</span></span>

1. <span data-ttu-id="697aa-572">Připojení k serveru pomocí protokol RDP (Remote Desktop) pomocí  *\<MachineName\>\DomainAdmin* účtu.</span><span class="sxs-lookup"><span data-stu-id="697aa-572">Connect to the server through the Remote Desktop Protocol (RDP) by using the *\<MachineName\>\DomainAdmin* account.</span></span>

1. <span data-ttu-id="697aa-573">Otevřete aplikaci SQL Server Management Studio a připojte se k místní instanci systému SQL Server.</span><span class="sxs-lookup"><span data-stu-id="697aa-573">Open SQL Server Management Studio and connect to the local instance of SQL Server.</span></span>

1. <span data-ttu-id="697aa-574">V **Průzkumník objektů**, klikněte na tlačítko **zabezpečení**.</span><span class="sxs-lookup"><span data-stu-id="697aa-574">In **Object Explorer**, click **Security**.</span></span>

1. <span data-ttu-id="697aa-575">Klikněte pravým tlačítkem na **přihlášení**.</span><span class="sxs-lookup"><span data-stu-id="697aa-575">Right-click **Logins**.</span></span> <span data-ttu-id="697aa-576">Klikněte na tlačítko **nového přihlašovacího jména**.</span><span class="sxs-lookup"><span data-stu-id="697aa-576">Click **New Login**.</span></span>

1. <span data-ttu-id="697aa-577">V **přihlášení – nové**, klikněte na tlačítko **vyhledávání**.</span><span class="sxs-lookup"><span data-stu-id="697aa-577">In **Login - New**, click **Search**.</span></span>

1. <span data-ttu-id="697aa-578">Klikněte na tlačítko **umístění**.</span><span class="sxs-lookup"><span data-stu-id="697aa-578">Click **Locations**.</span></span>

1. <span data-ttu-id="697aa-579">Zadejte přihlašovací údaje domény správce sítě.</span><span class="sxs-lookup"><span data-stu-id="697aa-579">Enter the domain administrator network credentials.</span></span>

1. <span data-ttu-id="697aa-580">Použijte účet instalace.</span><span class="sxs-lookup"><span data-stu-id="697aa-580">Use the installation account.</span></span>

1. <span data-ttu-id="697aa-581">Nastavit přihlášení jako člen **sysadmin** pevné role serveru.</span><span class="sxs-lookup"><span data-stu-id="697aa-581">Set the sign-in to be a member of the **sysadmin** fixed server role.</span></span>

1. <span data-ttu-id="697aa-582">Klikněte na **OK**.</span><span class="sxs-lookup"><span data-stu-id="697aa-582">Click **OK**.</span></span>

<span data-ttu-id="697aa-583">Opakujte předchozí kroky na další počítač serveru SQL.</span><span class="sxs-lookup"><span data-stu-id="697aa-583">Repeat the preceding steps on the other SQL Server VM.</span></span>

## <a name="add-failover-clustering-features-to-both-sql-server-vms"></a><span data-ttu-id="697aa-584">Přidání funkcí Clustering převzetí služeb při selhání do obou virtuálním počítačům systému SQL Server</span><span class="sxs-lookup"><span data-stu-id="697aa-584">Add Failover Clustering features to both SQL Server VMs</span></span>

<span data-ttu-id="697aa-585">Pokud chcete přidat funkce Clustering převzetí služeb při selhání, udělejte na oba virtuální počítače SQL serveru:</span><span class="sxs-lookup"><span data-stu-id="697aa-585">To add Failover Clustering features, do the following on both SQL Server VMs:</span></span>

1. <span data-ttu-id="697aa-586">Připojit k virtuálnímu počítači systému SQL Server pomocí protokol RDP (Remote Desktop) pomocí *CORP\install* účtu.</span><span class="sxs-lookup"><span data-stu-id="697aa-586">Connect to the SQL Server virtual machine through the Remote Desktop Protocol (RDP) by using the *CORP\install* account.</span></span> <span data-ttu-id="697aa-587">Otevřete **řídicí panel Správce serveru**.</span><span class="sxs-lookup"><span data-stu-id="697aa-587">Open **Server Manager Dashboard**.</span></span>
2. <span data-ttu-id="697aa-588">Klikněte **přidat role a funkce** odkaz na řídicím panelu.</span><span class="sxs-lookup"><span data-stu-id="697aa-588">Click the **Add roles and features** link on the dashboard.</span></span>

    ![Správce serveru – přidání rolí](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/22-addfeatures.png)
3. <span data-ttu-id="697aa-590">Vyberte **Další** až na **funkce serveru** části.</span><span class="sxs-lookup"><span data-stu-id="697aa-590">Select **Next** until you get to the **Server Features** section.</span></span>
4. <span data-ttu-id="697aa-591">V **funkce**, vyberte **Clustering převzetí služeb při selhání**.</span><span class="sxs-lookup"><span data-stu-id="697aa-591">In **Features**, select **Failover Clustering**.</span></span>
5. <span data-ttu-id="697aa-592">Přidejte všechny další požadované funkce.</span><span class="sxs-lookup"><span data-stu-id="697aa-592">Add any additional required features.</span></span>
6. <span data-ttu-id="697aa-593">Klikněte na tlačítko **nainstalovat** a přidejte funkce.</span><span class="sxs-lookup"><span data-stu-id="697aa-593">Click **Install** to add the features.</span></span>

<span data-ttu-id="697aa-594">Opakujte kroky na další počítač serveru SQL.</span><span class="sxs-lookup"><span data-stu-id="697aa-594">Repeat the steps on the other SQL Server VM.</span></span>

## <a name="a-nameendpoint-firewall-configure-the-firewall-on-each-sql-server-vm"></a><span data-ttu-id="697aa-595"><a name="endpoint-firewall">Konfigurace brány firewall na každý virtuální počítač s SQL serverem</span><span class="sxs-lookup"><span data-stu-id="697aa-595"><a name="endpoint-firewall"> Configure the firewall on each SQL Server VM</span></span>

<span data-ttu-id="697aa-596">Řešení vyžaduje následující porty TCP otevřen v bráně firewall:</span><span class="sxs-lookup"><span data-stu-id="697aa-596">The solution requires the following TCP ports to be open in the firewall:</span></span>

- <span data-ttu-id="697aa-597">**Virtuální počítač systému SQL Server**:</span><span class="sxs-lookup"><span data-stu-id="697aa-597">**SQL Server VM**:</span></span><br/>
   <span data-ttu-id="697aa-598">Port 1433 pro výchozí instanci systému SQL Server.</span><span class="sxs-lookup"><span data-stu-id="697aa-598">Port 1433 for a default instance of SQL Server.</span></span>
- <span data-ttu-id="697aa-599">**Sondu nástroje pro vyrovnávání zatížení Azure:**</span><span class="sxs-lookup"><span data-stu-id="697aa-599">**Azure load balancer probe:**</span></span><br/>
   <span data-ttu-id="697aa-600">Jakýkoli dostupný port.</span><span class="sxs-lookup"><span data-stu-id="697aa-600">Any available port.</span></span> <span data-ttu-id="697aa-601">Příklady často používají 59999.</span><span class="sxs-lookup"><span data-stu-id="697aa-601">Examples frequently use 59999.</span></span>
- <span data-ttu-id="697aa-602">**Koncový bod zrcadlení databáze:**</span><span class="sxs-lookup"><span data-stu-id="697aa-602">**Database mirroring endpoint:**</span></span> <br/>
   <span data-ttu-id="697aa-603">Jakýkoli dostupný port.</span><span class="sxs-lookup"><span data-stu-id="697aa-603">Any available port.</span></span> <span data-ttu-id="697aa-604">Příklady často používají 5022.</span><span class="sxs-lookup"><span data-stu-id="697aa-604">Examples frequently use 5022.</span></span>

<span data-ttu-id="697aa-605">Porty brány firewall musí být otevřen v obou virtuálním počítačům systému SQL Server.</span><span class="sxs-lookup"><span data-stu-id="697aa-605">The firewall ports need to be open on both SQL Server VMs.</span></span>

<span data-ttu-id="697aa-606">Způsob otevření portů závisí na řešení brány firewall, který používáte.</span><span class="sxs-lookup"><span data-stu-id="697aa-606">The method of opening the ports depends on the firewall solution that you use.</span></span> <span data-ttu-id="697aa-607">V další části vysvětluje, jak otevřít porty v bráně Windows Firewall.</span><span class="sxs-lookup"><span data-stu-id="697aa-607">The next section explains how to open the ports in Windows Firewall.</span></span> <span data-ttu-id="697aa-608">Otevřete požadované porty na všech virtuálních počítačů serveru SQL.</span><span class="sxs-lookup"><span data-stu-id="697aa-608">Open the required ports on each of your SQL Server VMs.</span></span>

### <a name="open-a-tcp-port-in-the-firewall"></a><span data-ttu-id="697aa-609">Otevřete TCP port v bráně firewall</span><span class="sxs-lookup"><span data-stu-id="697aa-609">Open a TCP port in the firewall</span></span>

1. <span data-ttu-id="697aa-610">Na prvním serveru SQL **spustit** obrazovky, spusťte **brány Windows Firewall s pokročilým zabezpečením**.</span><span class="sxs-lookup"><span data-stu-id="697aa-610">On the first SQL Server **Start** screen, launch **Windows Firewall with Advanced Security**.</span></span>
2. <span data-ttu-id="697aa-611">V levém podokně, vyberte **příchozí pravidla**.</span><span class="sxs-lookup"><span data-stu-id="697aa-611">On the left pane, select **Inbound Rules**.</span></span> <span data-ttu-id="697aa-612">V pravém podokně klikněte na tlačítko **nové pravidlo**.</span><span class="sxs-lookup"><span data-stu-id="697aa-612">On the right pane, click **New Rule**.</span></span>
3. <span data-ttu-id="697aa-613">Pro **typ pravidla**, zvolte **Port**.</span><span class="sxs-lookup"><span data-stu-id="697aa-613">For **Rule Type**, choose **Port**.</span></span>
4. <span data-ttu-id="697aa-614">Port, zadejte **TCP** a zadejte odpovídající port čísla.</span><span class="sxs-lookup"><span data-stu-id="697aa-614">For the port, specify **TCP** and type the appropriate port numbers.</span></span> <span data-ttu-id="697aa-615">Podívejte se na následující příklad:</span><span class="sxs-lookup"><span data-stu-id="697aa-615">See the following example:</span></span>

   ![Brány firewall pro SQL](./media/virtual-machines-windows-portal-sql-availability-group-tutorial/35-tcpports.png)

5. <span data-ttu-id="697aa-617">Klikněte na **Další**.</span><span class="sxs-lookup"><span data-stu-id="697aa-617">Click **Next**.</span></span>
6. <span data-ttu-id="697aa-618">Na **akce** ponechte **povolit připojení** vybrané a potom klikněte na **Další**.</span><span class="sxs-lookup"><span data-stu-id="697aa-618">On the **Action** page, keep **Allow the connection** selected, and then click **Next**.</span></span>
7. <span data-ttu-id="697aa-619">Na **profil** stránky, přijměte výchozí nastavení a pak klikněte na tlačítko **Další**.</span><span class="sxs-lookup"><span data-stu-id="697aa-619">On the **Profile** page, accept the default settings, and then click **Next**.</span></span>
8. <span data-ttu-id="697aa-620">Na **název** stránky, zadejte název pravidla (například **Azure LB testu**) v **název** textového pole a pak klikněte na tlačítko **Dokončit**.</span><span class="sxs-lookup"><span data-stu-id="697aa-620">On the **Name** page, specify a rule name (such as **Azure LB Probe**) in the **Name** text box, and then click **Finish**.</span></span>

<span data-ttu-id="697aa-621">Opakujte tyto kroky na druhý virtuální počítač SQL Server.</span><span class="sxs-lookup"><span data-stu-id="697aa-621">Repeat these steps on the second SQL Server VM.</span></span>

## <a name="next-steps"></a><span data-ttu-id="697aa-622">Další kroky</span><span class="sxs-lookup"><span data-stu-id="697aa-622">Next steps</span></span>

* [<span data-ttu-id="697aa-623">Vytvoření skupiny dostupnosti SQL serveru Always On na virtuálních počítačích Azure</span><span class="sxs-lookup"><span data-stu-id="697aa-623">Create a SQL Server Always On availability group on Azure virtual machines</span></span>](virtual-machines-windows-portal-sql-availability-group-tutorial.md)
