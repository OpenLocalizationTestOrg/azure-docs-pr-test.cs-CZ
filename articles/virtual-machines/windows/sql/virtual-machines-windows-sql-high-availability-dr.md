---
title: "aaaHigh dostupnost a zotavení po havárii pro SQL Server | Microsoft Docs"
description: "Diskuzi o hello různých typů HADR strategie pro SQL Server běžící v Azure Virtual Machines."
services: virtual-machines-windows
documentationcenter: na
author: MikeRayMSFT
manager: jhubbard
editor: 
tags: azure-service-management
ms.assetid: 53981f7e-8370-4979-b26a-93a5988d905f
ms.service: virtual-machines-sql
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 06/27/2017
ms.author: mikeray
ms.openlocfilehash: 2b62d8b30520952ba6b7da7177a2c2de95bea8ce
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="high-availability-and-disaster-recovery-for-sql-server-in-azure-virtual-machines"></a><span data-ttu-id="4ac58-103">Vysoká dostupnost a zotavení po havárii pro SQL Server v Azure Virtual Machines</span><span class="sxs-lookup"><span data-stu-id="4ac58-103">High availability and disaster recovery for SQL Server in Azure Virtual Machines</span></span>

<span data-ttu-id="4ac58-104">Virtuální počítače Microsoft Azure (VM) se systémem SQL Server může pomoci nižší náklady hello vysokou dostupnost a po havárii (HADR) obnovení databáze řešení.</span><span class="sxs-lookup"><span data-stu-id="4ac58-104">Microsoft Azure virtual machines (VMs) with SQL Server can help lower hello cost of a high availability and disaster recovery (HADR) database solution.</span></span> <span data-ttu-id="4ac58-105">Většina řešení SQL Server HADR jsou podporovány ve virtuálních počítačích Azure, jen Azure i jako hybridní řešení.</span><span class="sxs-lookup"><span data-stu-id="4ac58-105">Most SQL Server HADR solutions are supported in Azure virtual machines, both as Azure-only and as hybrid solutions.</span></span> <span data-ttu-id="4ac58-106">V řešení jen Azure celý systém HADR hello běží v Azure.</span><span class="sxs-lookup"><span data-stu-id="4ac58-106">In an Azure-only solution, hello entire HADR system runs in Azure.</span></span> <span data-ttu-id="4ac58-107">V hybridní konfigurace součást řešení hello spuštění v Azure a hello další část běží na místě ve vaší organizaci.</span><span class="sxs-lookup"><span data-stu-id="4ac58-107">In a hybrid configuration, part of hello solution runs in Azure and hello other part runs on-premises in your organization.</span></span> <span data-ttu-id="4ac58-108">Hello flexibilitu hello prostředí Azure vám umožní toomove částečně nebo zcela tooAzure toosatisfy hello nároky a HADR požadavky systému SQL Server databáze systémy.</span><span class="sxs-lookup"><span data-stu-id="4ac58-108">hello flexibility of hello Azure environment enables you toomove partially or completely tooAzure toosatisfy hello budget and HADR requirements of your SQL Server database systems.</span></span>

[!INCLUDE [learn-about-deployment-models](../../../../includes/learn-about-deployment-models-both-include.md)]

## <a name="understanding-hello-need-for-an-hadr-solution"></a><span data-ttu-id="4ac58-109">Principy hello potřebu řešení s HADR</span><span class="sxs-lookup"><span data-stu-id="4ac58-109">Understanding hello need for an HADR solution</span></span>
<span data-ttu-id="4ac58-110">Až tooyou tooensure se, zda má systém databáze hello HADR možnosti, které vyžaduje smlouvu o úrovni služeb hello (SLA).</span><span class="sxs-lookup"><span data-stu-id="4ac58-110">It is up tooyou tooensure that your database system possesses hello HADR capabilities that hello service-level agreement (SLA) requires.</span></span> <span data-ttu-id="4ac58-111">Hello skutečnost, že Azure poskytuje vysokou dostupnost mechanismů, například službou opravy pro cloudové služby a detekce chyb obnovení pro virtuální počítače, samotné nezaručí, že splňujete hello potřeby SLA.</span><span class="sxs-lookup"><span data-stu-id="4ac58-111">hello fact that Azure provides high availability mechanisms, such as service healing for cloud services and failure recovery detection for Virtual Machines, does not itself guarantee you can meet hello desired SLA.</span></span> <span data-ttu-id="4ac58-112">Tyto mechanismy chránit hello vysokou dostupnost hello virtuálních počítačů, ale není hello vysoké dostupnosti systému SQL Server spuštěnou uvnitř hello virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="4ac58-112">These mechanisms protect hello high availability of hello VMs but not hello high availability of SQL Server running inside hello VMs.</span></span> <span data-ttu-id="4ac58-113">Je možné pro toofail instance systému SQL Server hello při hello virtuálních počítačů online a v pořádku.</span><span class="sxs-lookup"><span data-stu-id="4ac58-113">It is possible for hello SQL Server instance toofail while hello VM is online and healthy.</span></span> <span data-ttu-id="4ac58-114">Kromě toho povolit i hello vysokou dostupnost mechanismy, které poskytuje Azure výpadek hello virtuálních počítačích kvůli tooevents je to třeba obnovení z selhání softwaru nebo hardwaru a upgrady operačního systému.</span><span class="sxs-lookup"><span data-stu-id="4ac58-114">Moreover, even hello high availability mechanisms provided by Azure allow for downtime of hello VMs due tooevents such as recovery from software or hardware failures and operating system upgrades.</span></span>

<span data-ttu-id="4ac58-115">Geograficky redundantní úložiště (GRS) v Azure, což je implementováno s funkci geografická replikace, navíc nemusí být řešení pro zotavení po havárii odpovídající, pro vaše databáze.</span><span class="sxs-lookup"><span data-stu-id="4ac58-115">In addition, Geo Redundant Storage (GRS) in Azure, which is implemented with a feature called geo-replication, may not be an adequate disaster recovery solution for your databases.</span></span> <span data-ttu-id="4ac58-116">Protože geografická replikace asynchronně odešle data, poslední aktualizace může dojít ke ztrátě v hello události po havárii.</span><span class="sxs-lookup"><span data-stu-id="4ac58-116">Because geo-replication sends data asynchronously, recent updates can be lost in hello event of disaster.</span></span> <span data-ttu-id="4ac58-117">Další informace týkající se omezeních geografická replikace jsou popsané v hello [geografická replikace není podporována pro data a soubory protokolu na různých discích](#geo-replication-support) části.</span><span class="sxs-lookup"><span data-stu-id="4ac58-117">More information regarding geo-replication limitations are covered in hello [Geo-replication not supported for data and log files on separate disks](#geo-replication-support) section.</span></span>

## <a name="hadr-deployment-architectures"></a><span data-ttu-id="4ac58-118">HADR nasazení architektury</span><span class="sxs-lookup"><span data-stu-id="4ac58-118">HADR deployment architectures</span></span>
<span data-ttu-id="4ac58-119">SQL Server HADR technologie, které jsou podporovány v Azure patří:</span><span class="sxs-lookup"><span data-stu-id="4ac58-119">SQL Server HADR technologies that are supported in Azure include:</span></span>

* [<span data-ttu-id="4ac58-120">Always On skupiny dostupnosti</span><span class="sxs-lookup"><span data-stu-id="4ac58-120">Always On Availability Groups</span></span>](https://technet.microsoft.com/library/hh510230.aspx)
* [<span data-ttu-id="4ac58-121">Always On instance clusteru převzetí služeb při selhání</span><span class="sxs-lookup"><span data-stu-id="4ac58-121">Always On Failover Cluster Instances</span></span>](https://technet.microsoft.com/library/ms189134.aspx)
* [<span data-ttu-id="4ac58-122">Přesouvání protokolu</span><span class="sxs-lookup"><span data-stu-id="4ac58-122">Log Shipping</span></span>](https://technet.microsoft.com/library/ms187103.aspx)
* [<span data-ttu-id="4ac58-123">Zálohování systému SQL Server a obnovení služby úložiště objektů Blob v Azure</span><span class="sxs-lookup"><span data-stu-id="4ac58-123">SQL Server Backup and Restore with Azure Blob Storage Service</span></span>](https://msdn.microsoft.com/library/jj919148.aspx)
* <span data-ttu-id="4ac58-124">[Zrcadlení databáze](https://technet.microsoft.com/library/ms189852.aspx) – nepoužívané v systému SQL Server 2016</span><span class="sxs-lookup"><span data-stu-id="4ac58-124">[Database Mirroring](https://technet.microsoft.com/library/ms189852.aspx) - Deprecated in SQL Server 2016</span></span>

<span data-ttu-id="4ac58-125">Je možné toocombine hello technologie společně tooimplement řešení SQL serveru, který má vysokou dostupnost a funkcím pro obnovení po havárii.</span><span class="sxs-lookup"><span data-stu-id="4ac58-125">It is possible toocombine hello technologies together tooimplement a SQL Server solution that has both high availability and disaster recovery capabilities.</span></span> <span data-ttu-id="4ac58-126">V závislosti na hello technologie, které používáte může vyžadovat hybridní nasazení tunelového připojení sítě VPN s hello virtuální síť Azure.</span><span class="sxs-lookup"><span data-stu-id="4ac58-126">Depending on hello technology you use, a hybrid deployment may require a VPN tunnel with hello Azure virtual network.</span></span> <span data-ttu-id="4ac58-127">v níže uvedených částech Hello ukážeme některé hello příklad nasazení architektury.</span><span class="sxs-lookup"><span data-stu-id="4ac58-127">hello sections below show you some of hello example deployment architectures.</span></span>

## <a name="azure-only-high-availability-solutions"></a><span data-ttu-id="4ac58-128">Jenom Azure: řešení s vysokou dostupností</span><span class="sxs-lookup"><span data-stu-id="4ac58-128">Azure-only: High availability solutions</span></span>

<span data-ttu-id="4ac58-129">Řešení vysoké dostupnosti může mít pro SQL Server na úrovni databáze pomocí skupin dostupnosti Always On - nazývají skupiny dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="4ac58-129">You can have a high availability solution for SQL Server at a database level with Always On Availability Groups - called availability groups.</span></span> <span data-ttu-id="4ac58-130">Můžete také vytvořit řešení vysoké dostupnosti na úrovni instance instancemi vždy na převzetí služeb při selhání clusteru – převzetí služeb při selhání instance clusteru.</span><span class="sxs-lookup"><span data-stu-id="4ac58-130">You can also create a high availability solution at an instance level with Always On Failover Cluster Instances - failover cluster instances.</span></span> <span data-ttu-id="4ac58-131">Pro další redundanci můžete vytvořit redundance na obou úrovních vytvořením skupiny dostupnosti na převzetí služeb při selhání instance clusteru.</span><span class="sxs-lookup"><span data-stu-id="4ac58-131">For additional redundancy, you can create redundancy at both levels by creating availability groups on failover cluster instances.</span></span> 

| <span data-ttu-id="4ac58-132">Technologie</span><span class="sxs-lookup"><span data-stu-id="4ac58-132">Technology</span></span> | <span data-ttu-id="4ac58-133">Příklad architektury</span><span class="sxs-lookup"><span data-stu-id="4ac58-133">Example Architectures</span></span> |
| --- | --- |
| <span data-ttu-id="4ac58-134">**Skupiny dostupnosti**</span><span class="sxs-lookup"><span data-stu-id="4ac58-134">**Availability groups**</span></span> |<span data-ttu-id="4ac58-135">Hello replik dostupnosti spuštěna ve virtuálních počítačích Azure ve stejné oblasti poskytovat vysokou dostupnost.</span><span class="sxs-lookup"><span data-stu-id="4ac58-135">Availability replicas running in Azure VMs in hello same region provide high availability.</span></span> <span data-ttu-id="4ac58-136">Je nutné tooconfigure řadič domény virtuálního počítače, protože Windows převzetí služeb při selhání clustering vyžaduje domény služby Active Directory.</span><span class="sxs-lookup"><span data-stu-id="4ac58-136">You need tooconfigure a domain controller VM, because Windows failover clustering requires an Active Directory domain.</span></span><br/> <span data-ttu-id="4ac58-137">![Skupiny dostupnosti](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_ha_always_on.gif)</span><span class="sxs-lookup"><span data-stu-id="4ac58-137">![Availability Groups](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_ha_always_on.gif)</span></span><br/><span data-ttu-id="4ac58-138">Další informace najdete v tématu [konfigurace skupiny dostupnosti v Azure (GUI)](virtual-machines-windows-portal-sql-alwayson-availability-groups.md).</span><span class="sxs-lookup"><span data-stu-id="4ac58-138">For more information, see [Configure Availability Groups in Azure (GUI)](virtual-machines-windows-portal-sql-alwayson-availability-groups.md).</span></span> |
| <span data-ttu-id="4ac58-139">**Instance clusteru převzetí služeb při selhání**</span><span class="sxs-lookup"><span data-stu-id="4ac58-139">**Failover cluster instances**</span></span> |<span data-ttu-id="4ac58-140">Instance clusteru převzetí služeb při selhání (FCI), které vyžadují sdílené úložiště, můžete vytvořit 3 různými způsoby.</span><span class="sxs-lookup"><span data-stu-id="4ac58-140">Failover Cluster Instances (FCI), which require shared storage, can be created in 3 different ways.</span></span><br/><br/><span data-ttu-id="4ac58-141">1. Cluster převzetí služeb při selhání dvěma uzly se systémem ve virtuálních počítačích Azure s použitím připojené úložiště [Windows Server 2016 prostory úložiště – přímé \(S2D\) ](virtual-machines-windows-portal-sql-create-failover-cluster.md) tooprovide softwarový virtuální síť SAN.</span><span class="sxs-lookup"><span data-stu-id="4ac58-141">1. A two-node failover cluster running in Azure VMs with attached storage using [Windows Server 2016 Storage Spaces Direct \(S2D\)](virtual-machines-windows-portal-sql-create-failover-cluster.md) tooprovide a software-based virtual SAN.</span></span><br/><br/><span data-ttu-id="4ac58-142">2. Cluster převzetí služeb při selhání dvěma uzly se systémem ve virtuálních počítačích Azure s úložištěm podporuje clustering řešení třetí strany.</span><span class="sxs-lookup"><span data-stu-id="4ac58-142">2. A two-node failover cluster running in Azure VMs with storage supported by a third-party clustering solution.</span></span> <span data-ttu-id="4ac58-143">Konkrétní příklad, který používá s DataKeeper najdete v tématu [vysoká dostupnost pro sdílenou složku pomocí clustering převzetí služeb při selhání a 3. stran software s DataKeeper](https://azure.microsoft.com/blog/high-availability-for-a-file-share-using-wsfc-ilb-and-3rd-party-software-sios-datakeeper/).</span><span class="sxs-lookup"><span data-stu-id="4ac58-143">For a specific example that uses SIOS DataKeeper, see [High availability for a file share using failover clustering and 3rd party software SIOS DataKeeper](https://azure.microsoft.com/blog/high-availability-for-a-file-share-using-wsfc-ilb-and-3rd-party-software-sios-datakeeper/).</span></span><br/><br/><span data-ttu-id="4ac58-144">3. Clusteru s podporou převzetí služeb při selhání dvěma uzly ve virtuálních počítačích Azure s vzdálené služby iSCSI Target sdílené blokové úložiště přes ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="4ac58-144">3. A two-node failover cluster running in Azure VMs with remote iSCSI Target shared block storage via ExpressRoute.</span></span> <span data-ttu-id="4ac58-145">Například NetApp privátní úložiště (NPS) zpřístupní cíle iSCSI prostřednictvím ExpressRoute s Equinix tooAzure virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="4ac58-145">For example, NetApp Private Storage (NPS) exposes an iSCSI target via ExpressRoute with Equinix tooAzure VMs.</span></span><br/><br/><span data-ttu-id="4ac58-146">Pro sdílené úložiště jiných výrobců a řešení replikace dat měli byste požádat dodavatele hello pro všechna data související tooaccessing problémy na převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="4ac58-146">For third-party shared storage and data replication solutions, you should contact hello vendor for any issues related tooaccessing data on failover.</span></span><br/><br/><span data-ttu-id="4ac58-147">Všimněte si, že pomocí FCI na [Azure File storage](https://azure.microsoft.com/services/storage/files/) se zatím nepodporuje, protože toto řešení nevyužívá Storage úrovně Premium.</span><span class="sxs-lookup"><span data-stu-id="4ac58-147">Note that using FCI on top of [Azure File storage](https://azure.microsoft.com/services/storage/files/) is not supported yet, because this solution does not utilize Premium Storage.</span></span> <span data-ttu-id="4ac58-148">Tento brzy toosupport pracujeme.</span><span class="sxs-lookup"><span data-stu-id="4ac58-148">We are working toosupport this soon.</span></span> |

## <a name="azure-only-disaster-recovery-solutions"></a><span data-ttu-id="4ac58-149">Jenom Azure: řešení zotavení po havárii</span><span class="sxs-lookup"><span data-stu-id="4ac58-149">Azure-only: Disaster recovery solutions</span></span>
<span data-ttu-id="4ac58-150">Můžete mít řešení zotavení po havárii pro databáze SQL Server v Azure pomocí skupin dostupnosti, zrcadlení databáze nebo zálohování a obnovení pomocí úložiště objektů BLOB.</span><span class="sxs-lookup"><span data-stu-id="4ac58-150">You can have a disaster recovery solution for your SQL Server databases in Azure using availability groups, database mirroring, or backup and restore with storage blobs.</span></span>

| <span data-ttu-id="4ac58-151">Technologie</span><span class="sxs-lookup"><span data-stu-id="4ac58-151">Technology</span></span> | <span data-ttu-id="4ac58-152">Příklad architektury</span><span class="sxs-lookup"><span data-stu-id="4ac58-152">Example Architectures</span></span> |
| --- | --- |
| <span data-ttu-id="4ac58-153">**Skupiny dostupnosti**</span><span class="sxs-lookup"><span data-stu-id="4ac58-153">**Availability Groups**</span></span> |<span data-ttu-id="4ac58-154">Repliky dostupnosti systémem přes několik datových center ve virtuálních počítačích Azure pro zotavení po havárii.</span><span class="sxs-lookup"><span data-stu-id="4ac58-154">Availability replicas running across multiple datacenters in Azure VMs for disaster recovery.</span></span> <span data-ttu-id="4ac58-155">Toto řešení mezi oblastmi chrání před dokončení lokality výpadku.</span><span class="sxs-lookup"><span data-stu-id="4ac58-155">This cross-region solution protects against complete site outage.</span></span> <br/> <span data-ttu-id="4ac58-156">![Skupiny dostupnosti](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_dr_alwayson.png)</span><span class="sxs-lookup"><span data-stu-id="4ac58-156">![Availability Groups](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_dr_alwayson.png)</span></span><br/><span data-ttu-id="4ac58-157">V oblasti musí být všechny repliky v rámci hello stejné cloudové služby a hello stejnou virtuální síť.</span><span class="sxs-lookup"><span data-stu-id="4ac58-157">Within a region, all replicas should be within hello same cloud service and hello same VNet.</span></span> <span data-ttu-id="4ac58-158">Vzhledem k tomu, že každou oblast, bude mít samostatné virtuální sítě, tato řešení vyžadovat tooVNet připojení virtuální sítě.</span><span class="sxs-lookup"><span data-stu-id="4ac58-158">Because each region will have a separate VNet, these solutions require VNet tooVNet connectivity.</span></span> <span data-ttu-id="4ac58-159">Další informace najdete v tématu [konfigurace VNet-to-VNet připojení pomocí portálu Azure hello](../../../vpn-gateway/vpn-gateway-howto-vnet-vnet-resource-manager-portal.md).</span><span class="sxs-lookup"><span data-stu-id="4ac58-159">For more information, see [Configure a VNet-to-VNet connection using hello Azure portal](../../../vpn-gateway/vpn-gateway-howto-vnet-vnet-resource-manager-portal.md).</span></span> <span data-ttu-id="4ac58-160">Podrobné pokyny najdete v tématu [nakonfigurovat skupinu dostupnosti SQL Server na virtuálních počítačích Azure v různých oblastech](virtual-machines-windows-portal-sql-availability-group-dr.md).</span><span class="sxs-lookup"><span data-stu-id="4ac58-160">For detailed instructions, see [Configure a SQL Server Availability Group on Azure Virtual Machines in Different Regions](virtual-machines-windows-portal-sql-availability-group-dr.md).</span></span>|
| <span data-ttu-id="4ac58-161">**Zrcadlení databáze**</span><span class="sxs-lookup"><span data-stu-id="4ac58-161">**Database Mirroring**</span></span> |<span data-ttu-id="4ac58-162">Objekt zabezpečení a zrcadlení a servery v různých datových centrech pro zotavení po havárii.</span><span class="sxs-lookup"><span data-stu-id="4ac58-162">Principal and mirror and servers running in different datacenters for disaster recovery.</span></span> <span data-ttu-id="4ac58-163">Je nutné nasadit pomocí certifikátů serveru, protože domény služby active directory nemůžou zahrnovat několik datových center.</span><span class="sxs-lookup"><span data-stu-id="4ac58-163">You must deploy using server certificates because an active directory domain cannot span multiple datacenters.</span></span><br/>![Zrcadlení databáze](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_dr_dbmirroring.gif) |
| <span data-ttu-id="4ac58-165">**Zálohování a obnovení pomocí služby Azure Blob Storage**</span><span class="sxs-lookup"><span data-stu-id="4ac58-165">**Backup and Restore with Azure Blob Storage Service**</span></span> |<span data-ttu-id="4ac58-166">Provozní databáze zálohovat přímo tooblob úložiště v jiném datovém centru pro zotavení po havárii.</span><span class="sxs-lookup"><span data-stu-id="4ac58-166">Production databases backed up directly tooblob storage in a different datacenter for disaster recovery.</span></span><br/><span data-ttu-id="4ac58-167">![Zálohování a obnovení](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_dr_backup_restore.gif)</span><span class="sxs-lookup"><span data-stu-id="4ac58-167">![Backup and Restore](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_dr_backup_restore.gif)</span></span><br/><span data-ttu-id="4ac58-168">Další informace najdete v tématu [zálohování a obnovení pro SQL Server v Azure Virtual Machines](virtual-machines-windows-sql-backup-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="4ac58-168">For more information, see [Backup and Restore for SQL Server in Azure Virtual Machines](virtual-machines-windows-sql-backup-recovery.md).</span></span> |

## <a name="hybrid-it-disaster-recovery-solutions"></a><span data-ttu-id="4ac58-169">Hybridního IT: Řešení zotavení po havárii</span><span class="sxs-lookup"><span data-stu-id="4ac58-169">Hybrid IT: Disaster recovery solutions</span></span>
<span data-ttu-id="4ac58-170">Můžete mít řešení pro zotavení po havárii pro databáze SQL Server v IT hybridní prostředí pomocí skupin dostupnosti, zrcadlení databáze, přesouvání protokolu a zálohování a obnovení s Azure blog storage.</span><span class="sxs-lookup"><span data-stu-id="4ac58-170">You can have a disaster recovery solution for your SQL Server databases in a hybrid-IT environment using availability groups, database mirroring, log shipping, and backup and restore with Azure blog storage.</span></span>

| <span data-ttu-id="4ac58-171">Technologie</span><span class="sxs-lookup"><span data-stu-id="4ac58-171">Technology</span></span> | <span data-ttu-id="4ac58-172">Příklad architektury</span><span class="sxs-lookup"><span data-stu-id="4ac58-172">Example Architectures</span></span> |
| --- | --- |
| <span data-ttu-id="4ac58-173">**Skupiny dostupnosti**</span><span class="sxs-lookup"><span data-stu-id="4ac58-173">**Availability Groups**</span></span> |<span data-ttu-id="4ac58-174">Některé repliky dostupnosti spuštěna ve virtuálních počítačích Azure a další repliky spuštěné místně pro zotavení po havárii webů.</span><span class="sxs-lookup"><span data-stu-id="4ac58-174">Some availability replicas running in Azure VMs and other replicas running on-premises for cross-site disaster recovery.</span></span> <span data-ttu-id="4ac58-175">Hello pracoviště může být buď místní nebo v datovém centru Azure.</span><span class="sxs-lookup"><span data-stu-id="4ac58-175">hello production site can be either on-premises or in an Azure datacenter.</span></span><br/>![Skupiny dostupnosti](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_alwayson.gif)<br/><span data-ttu-id="4ac58-177">Protože všechny repliky dostupnosti musí být v hello stejného clusteru převzetí služeb při selhání, hello clusteru musí span obě sítě (clusteru s podporou převzetí služeb při selhání více podsítí).</span><span class="sxs-lookup"><span data-stu-id="4ac58-177">Because all availability replicas must be in hello same failover cluster, hello cluster must span both networks (a multi-subnet failover cluster).</span></span> <span data-ttu-id="4ac58-178">Tato konfigurace vyžaduje připojení VPN mezi Azure a hello do místní sítě.</span><span class="sxs-lookup"><span data-stu-id="4ac58-178">This configuration requires a VPN connection between Azure and hello on-premises network.</span></span><br/><br/><span data-ttu-id="4ac58-179">Úspěšné zotavení po havárii databází nainstalujete také repliky řadiče domény v lokalitě pro obnovení po havárii hello.</span><span class="sxs-lookup"><span data-stu-id="4ac58-179">For successful disaster recovery of your databases, you should also install a replica domain controller at hello disaster recovery site.</span></span><br/><br/><span data-ttu-id="4ac58-180">Je možné toouse hello Průvodce přidáním repliky v aplikaci SSMS tooadd Azure repliky tooan existující vždy na skupiny dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="4ac58-180">It is possible toouse hello Add Replica Wizard in SSMS tooadd an Azure replica tooan existing Always On Availability Group.</span></span> <span data-ttu-id="4ac58-181">Další informace najdete v tématu kurz: rozšířit vaše tooAzure vždy na skupiny dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="4ac58-181">For more information, see Tutorial: Extend your Always On Availability Group tooAzure.</span></span> |
| <span data-ttu-id="4ac58-182">**Zrcadlení databáze**</span><span class="sxs-lookup"><span data-stu-id="4ac58-182">**Database Mirroring**</span></span> |<span data-ttu-id="4ac58-183">Jeden partnera systémem do virtuálního počítače Azure a hello ostatní spuštěné místně pro zotavení po havárii webů pomocí certifikátů serveru.</span><span class="sxs-lookup"><span data-stu-id="4ac58-183">One partner running in an Azure VM and hello other running on-premises for cross-site disaster recovery using server certificates.</span></span> <span data-ttu-id="4ac58-184">Partneři nemusí toobe v hello stejné domény služby Active Directory a není třeba žádné připojení k síti VPN.</span><span class="sxs-lookup"><span data-stu-id="4ac58-184">Partners do not need toobe in hello same Active Directory domain, and no VPN connection is required.</span></span><br/><span data-ttu-id="4ac58-185">![Zrcadlení databáze](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_dbmirroring.gif)</span><span class="sxs-lookup"><span data-stu-id="4ac58-185">![Database Mirroring](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_dbmirroring.gif)</span></span><br/><span data-ttu-id="4ac58-186">Jiné databáze zrcadlení scénář zahrnuje jednu partnera spuštění ve virtuálním počítači Azure a hello jiných spuštěná místně v hello stejné domény služby Active Directory pro zotavení po havárii webů.</span><span class="sxs-lookup"><span data-stu-id="4ac58-186">Another database mirroring scenario involves one partner running in an Azure VM and hello other running on-premises in hello same Active Directory domain for cross-site disaster recovery.</span></span> <span data-ttu-id="4ac58-187">A [připojení VPN mezi hello Azure virtuální sítě a hello místní sítě](../../../vpn-gateway/vpn-gateway-site-to-site-create.md) je vyžadován.</span><span class="sxs-lookup"><span data-stu-id="4ac58-187">A [VPN connection between hello Azure virtual network and hello on-premises network](../../../vpn-gateway/vpn-gateway-site-to-site-create.md) is required.</span></span><br/><br/><span data-ttu-id="4ac58-188">Úspěšné zotavení po havárii databází nainstalujete také repliky řadiče domény v lokalitě pro obnovení po havárii hello.</span><span class="sxs-lookup"><span data-stu-id="4ac58-188">For successful disaster recovery of your databases, you should also install a replica domain controller at hello disaster recovery site.</span></span> |
| <span data-ttu-id="4ac58-189">**Přesouvání protokolu**</span><span class="sxs-lookup"><span data-stu-id="4ac58-189">**Log Shipping**</span></span> |<span data-ttu-id="4ac58-190">Jeden server se systémem do virtuálního počítače Azure a hello ostatní spuštěné místně pro zotavení po havárii webů.</span><span class="sxs-lookup"><span data-stu-id="4ac58-190">One server running in an Azure VM and hello other running on-premises for cross-site disaster recovery.</span></span> <span data-ttu-id="4ac58-191">Přesouvání protokolu, závisí na sdílení souborů systému Windows, připojení VPN mezi hello virtuální síť Azure a hello místní sítě je vyžadováno.</span><span class="sxs-lookup"><span data-stu-id="4ac58-191">Log shipping depends on Windows file sharing, so a VPN connection between hello Azure virtual network and hello on-premises network is required.</span></span><br/>![Přesouvání protokolu](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_log_shipping.gif)<br/><span data-ttu-id="4ac58-193">Úspěšné zotavení po havárii databází nainstalujete také repliky řadiče domény v lokalitě pro obnovení po havárii hello.</span><span class="sxs-lookup"><span data-stu-id="4ac58-193">For successful disaster recovery of your databases, you should also install a replica domain controller at hello disaster recovery site.</span></span> |
| <span data-ttu-id="4ac58-194">**Zálohování a obnovení pomocí služby Azure Blob Storage**</span><span class="sxs-lookup"><span data-stu-id="4ac58-194">**Backup and Restore with Azure Blob Storage Service**</span></span> |<span data-ttu-id="4ac58-195">Místní provozní databáze zálohovat přímo tooAzure objektu blob úložiště pro zotavení po havárii.</span><span class="sxs-lookup"><span data-stu-id="4ac58-195">On-premises production databases backed up directly tooAzure blob storage for disaster recovery.</span></span><br/><span data-ttu-id="4ac58-196">![Zálohování a obnovení](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_backup_restore.gif)</span><span class="sxs-lookup"><span data-stu-id="4ac58-196">![Backup and Restore](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_backup_restore.gif)</span></span><br/><span data-ttu-id="4ac58-197">Další informace najdete v tématu [zálohování a obnovení pro SQL Server v Azure Virtual Machines](virtual-machines-windows-sql-backup-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="4ac58-197">For more information, see [Backup and Restore for SQL Server in Azure Virtual Machines](virtual-machines-windows-sql-backup-recovery.md).</span></span> |

## <a name="important-considerations-for-sql-server-hadr-in-azure"></a><span data-ttu-id="4ac58-198">Důležité informace pro SQL Server HADR v Azure</span><span class="sxs-lookup"><span data-stu-id="4ac58-198">Important considerations for SQL Server HADR in Azure</span></span>
<span data-ttu-id="4ac58-199">Virtuální počítače Azure, úložiště a síťové mít odlišné provozní vlastnosti než místní, nevirtualizovaný infrastruktury IT.</span><span class="sxs-lookup"><span data-stu-id="4ac58-199">Azure VMs, storage, and networking have different operational characteristics than an on-premises, non-virtualized IT infrastructure.</span></span> <span data-ttu-id="4ac58-200">Úspěšné dokončení implementace řešení HADR SQL Server v Azure vyžaduje, abyste pochopili tyto rozdíly a návrh vašeho řešení tooaccommodate je.</span><span class="sxs-lookup"><span data-stu-id="4ac58-200">A successful implementation of a HADR SQL Server solution in Azure requires that you understand these differences and design your solution tooaccommodate them.</span></span>

### <a name="high-availability-nodes-in-an-availability-set"></a><span data-ttu-id="4ac58-201">Uzly vysoké dostupnosti v nastavení dostupnosti</span><span class="sxs-lookup"><span data-stu-id="4ac58-201">High availability nodes in an availability set</span></span>
<span data-ttu-id="4ac58-202">Skupiny dostupnosti v Azure umožní tooplace hello vysokou dostupnost uzly do samostatné domény selhání (FDs) a aktualizace domény (UDs).</span><span class="sxs-lookup"><span data-stu-id="4ac58-202">Availability sets in Azure enable you tooplace hello high availability nodes into separate Fault Domains (FDs) and Update Domains (UDs).</span></span> <span data-ttu-id="4ac58-203">Pro virtuální počítače Azure toobe umístit do hello stejné nastavení dostupnosti, musíte ho nasadit v hello stejné cloudové služby.</span><span class="sxs-lookup"><span data-stu-id="4ac58-203">For Azure VMs toobe placed in hello same availability set, you must deploy them in hello same cloud service.</span></span> <span data-ttu-id="4ac58-204">Pouze uzly v hello, které mohou být součástí stejné cloudové služby hello stejné skupině dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="4ac58-204">Only nodes in hello same cloud service can participate in hello same availability set.</span></span> <span data-ttu-id="4ac58-205">Další informace najdete v tématu [hello Správa dostupnosti virtuálních počítačů](../manage-availability.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="4ac58-205">For more information, see [Manage hello Availability of Virtual Machines](../manage-availability.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>

### <a name="failover-cluster-behavior-in-azure-networking"></a><span data-ttu-id="4ac58-206">Chování clusteru převzetí služeb při selhání v Azure sítě</span><span class="sxs-lookup"><span data-stu-id="4ac58-206">Failover cluster behavior in Azure networking</span></span>
<span data-ttu-id="4ac58-207">Hello bez specifikaci RFC služba DHCP v Azure může způsobit hello vytvoření určité převzetí služeb při selhání clusteru konfigurace toofail, z důvodu název sítě s clustery toohello přiřazeny duplicitní IP adresu, jako je například hello stejnou IP adresu jako jeden z uzlů clusteru hello.</span><span class="sxs-lookup"><span data-stu-id="4ac58-207">hello non-RFC-compliant DHCP service in Azure can cause hello creation of certain failover cluster configurations toofail, due toohello cluster network name being assigned a duplicate IP address, such as hello same IP address as one of hello cluster nodes.</span></span> <span data-ttu-id="4ac58-208">Jedná se o problém při implementaci skupin dostupnosti, které závisí na funkci clusteru převzetí služeb při selhání Windows hello.</span><span class="sxs-lookup"><span data-stu-id="4ac58-208">This is an issue when you implement Availability Groups, which depends on hello Windows failover cluster feature.</span></span>

<span data-ttu-id="4ac58-209">Při vytvoření clusteru se dvěma uzly a pak přepne do online režimu, podívejte se na scénář hello:</span><span class="sxs-lookup"><span data-stu-id="4ac58-209">Consider hello scenario when a two-node cluster is created and brought online:</span></span>

1. <span data-ttu-id="4ac58-210">Hello clusteru přechodu do režimu online a potom Uzel1 požadavky dynamicky přiřazenou IP adresu pro název sítě s clustery hello.</span><span class="sxs-lookup"><span data-stu-id="4ac58-210">hello cluster comes online, then NODE1 requests a dynamically assigned IP address for hello cluster network name.</span></span>
2. <span data-ttu-id="4ac58-211">Žádné IP adresy, než Uzel1 na vlastní IP adresu je dán hello službu DHCP, protože hello služba DHCP rozpozná, že žádost o hello pochází z Uzel1 sám sebe.</span><span class="sxs-lookup"><span data-stu-id="4ac58-211">No IP address other than NODE1’s own IP address is given by hello DHCP service, since hello DHCP service recognizes that hello request comes from NODE1 itself.</span></span>
3. <span data-ttu-id="4ac58-212">Windows zjistí, že duplicitní adresa je přiřazená tooNODE1 a toohello název sítě clusteru převzetí služeb při selhání a hello výchozí skupiny clusteru selže toocome online.</span><span class="sxs-lookup"><span data-stu-id="4ac58-212">Windows detects that a duplicate address is assigned both tooNODE1 and toohello failover cluster network name, and hello default cluster group fails toocome online.</span></span>
4. <span data-ttu-id="4ac58-213">Hello výchozí skupiny clusteru přesune tooNODE2, která zpracovává Uzel1 na IP adresu jako IP adresu clusteru hello a přináší hello výchozí skupiny clusteru online.</span><span class="sxs-lookup"><span data-stu-id="4ac58-213">hello default cluster group moves tooNODE2, which treats NODE1’s IP address as hello cluster IP address and brings hello default cluster group online.</span></span>
5. <span data-ttu-id="4ac58-214">Když Uzel2 pokusí tooestablish připojení s UZEL1, pakety směrované na Uzel1 nikdy neopustí Uzel2, protože vyřešila Uzel1 na IP adresu tooitself.</span><span class="sxs-lookup"><span data-stu-id="4ac58-214">When NODE2 attempts tooestablish connectivity with NODE1, packets directed at NODE1 never leave NODE2 because it resolves NODE1’s IP address tooitself.</span></span> <span data-ttu-id="4ac58-215">Uzel2 nelze navázat připojení s UZEL1, pak dojde ke ztrátě kvora a ukončí hello clusteru.</span><span class="sxs-lookup"><span data-stu-id="4ac58-215">NODE2 cannot establish connectivity with NODE1, then loses quorum and shuts down hello cluster.</span></span>
6. <span data-ttu-id="4ac58-216">V té doby hello Uzel1 může odesílat pakety tooNODE2, ale nemůže odpovědět, UZEL2.</span><span class="sxs-lookup"><span data-stu-id="4ac58-216">In hello meantime, NODE1 can send packets tooNODE2, but NODE2 cannot reply.</span></span> <span data-ttu-id="4ac58-217">Uzel1 dojde ke ztrátě kvora a ukončí hello clusteru.</span><span class="sxs-lookup"><span data-stu-id="4ac58-217">NODE1 loses quorum and shuts down hello cluster.</span></span>

<span data-ttu-id="4ac58-218">Tento scénář může zabránit přiřazení nepoužívané statickou IP adresu, jako jsou například místní IP adresu jako 169.254.1.1, název toohello sítě s clustery v pořadí toobring hello síťového názvu clusteru online.</span><span class="sxs-lookup"><span data-stu-id="4ac58-218">This scenario can be avoided by assigning an unused static IP address, such as a link-local IP address like 169.254.1.1, toohello cluster network name in order toobring hello cluster network name online.</span></span> <span data-ttu-id="4ac58-219">toosimplify to zpracovat, najdete v části [Windows konfiguraci clusteru převzetí služeb při selhání v Azure pro skupiny dostupnosti](http://social.technet.microsoft.com/wiki/contents/articles/14776.configuring-windows-failover-cluster-in-windows-azure-for-alwayson-availability-groups.aspx).</span><span class="sxs-lookup"><span data-stu-id="4ac58-219">toosimplify this process, see [Configuring Windows failover cluster in Azure for availability groups](http://social.technet.microsoft.com/wiki/contents/articles/14776.configuring-windows-failover-cluster-in-windows-azure-for-alwayson-availability-groups.aspx).</span></span>

<span data-ttu-id="4ac58-220">Další informace najdete v tématu [konfigurovat skupiny dostupnosti v Azure (GUI)](virtual-machines-windows-portal-sql-alwayson-availability-groups.md).</span><span class="sxs-lookup"><span data-stu-id="4ac58-220">For more information, see [Configure availability groups in Azure (GUI)](virtual-machines-windows-portal-sql-alwayson-availability-groups.md).</span></span>

### <a name="availability-group-listener-support"></a><span data-ttu-id="4ac58-221">Podpora naslouchací proces skupiny dostupnosti</span><span class="sxs-lookup"><span data-stu-id="4ac58-221">Availability group listener support</span></span>
<span data-ttu-id="4ac58-222">Naslouchací procesy skupiny dostupnosti jsou podporovány v Azure virtuální počítače se systémem Windows Server 2008 R2, Windows Server 2012, Windows Server 2012 R2 a Windows Server 2016.</span><span class="sxs-lookup"><span data-stu-id="4ac58-222">Availability group listeners are supported on Azure VMs running Windows Server 2008 R2, Windows Server 2012, Windows Server 2012 R2, and Windows Server 2016.</span></span> <span data-ttu-id="4ac58-223">Tato podpora je možné pomocí hello Vyrovnávání zatížení sítě koncových bodů povoleno na virtuálních počítačích Azure hello, které jsou uzly skupiny dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="4ac58-223">This support is made possible by hello use of load-balanced endpoints enabled on hello Azure VMs that are availability group nodes.</span></span> <span data-ttu-id="4ac58-224">Postupujte podle kroků speciální konfigurace pro hello toowork naslouchací procesy pro oba klientských aplikací, které jsou spuštěné v Azure a také ty spuštěné místně.</span><span class="sxs-lookup"><span data-stu-id="4ac58-224">You must follow special configuration steps for hello listeners toowork for both client applications that are running in Azure as well as those running on-premises.</span></span>

<span data-ttu-id="4ac58-225">Existují dvě hlavní možnosti pro nastavení vaší naslouchací proces: externí (veřejných) nebo interní.</span><span class="sxs-lookup"><span data-stu-id="4ac58-225">There are two main options for setting up your listener: external (public) or internal.</span></span> <span data-ttu-id="4ac58-226">hello Hello externí naslouchací proces (veřejné) používá internetové nástroj pro vyrovnávání zatížení a souvisí s veřejná virtuální IP (VIP) které je přístupné přes internet.</span><span class="sxs-lookup"><span data-stu-id="4ac58-226">hello external (public) listener uses an internet facing load balancer and is associated with a public Virtual IP (VIP) that is accessible over hello internet.</span></span> <span data-ttu-id="4ac58-227">Interní nástroj používá interní naslouchací proces a hello pouze podporuje klienty v rámci stejné virtuální síti.</span><span class="sxs-lookup"><span data-stu-id="4ac58-227">An internal listener uses an internal load balancer and only supports clients within hello same Virtual Network.</span></span> <span data-ttu-id="4ac58-228">Buď typ nástroje pro vyrovnávání zatížení, je nutné povolit přímé odpovědi ze serveru.</span><span class="sxs-lookup"><span data-stu-id="4ac58-228">For either load balancer type, you must enable Direct Server Return.</span></span> 

<span data-ttu-id="4ac58-229">Pokud hello skupiny dostupnosti zahrnuje několik podsítí Azure (například nasazení, které protne oblastí Azure), musíte zahrnout hello klienta připojovací řetězec "**MultisubnetFailover = True**".</span><span class="sxs-lookup"><span data-stu-id="4ac58-229">If hello Availability Group spans multiple Azure subnets (such as a deployment that crosses Azure regions), hello client connection string must include "**MultisubnetFailover=True**".</span></span> <span data-ttu-id="4ac58-230">Výsledkem paralelní připojení pokusy o toohello repliky v různých podsítích hello.</span><span class="sxs-lookup"><span data-stu-id="4ac58-230">This results in parallel connection attempts toohello replicas in hello different subnets.</span></span> <span data-ttu-id="4ac58-231">Pokyny týkající se nastavení naslouchací proces najdete v tématu</span><span class="sxs-lookup"><span data-stu-id="4ac58-231">For instructions on setting up a listener, see</span></span>

* <span data-ttu-id="4ac58-232">[Konfigurace naslouchací proces ILB pro skupiny dostupnosti v Azure](virtual-machines-windows-portal-sql-ps-alwayson-int-listener.md).</span><span class="sxs-lookup"><span data-stu-id="4ac58-232">[Configure an ILB listener for availability groups in Azure](virtual-machines-windows-portal-sql-ps-alwayson-int-listener.md).</span></span>
* <span data-ttu-id="4ac58-233">[Konfigurace o externí naslouchací proces pro skupiny dostupnosti v Azure](../classic/ps-sql-ext-listener.md).</span><span class="sxs-lookup"><span data-stu-id="4ac58-233">[Configure an external listener for availability groups in Azure](../classic/ps-sql-ext-listener.md).</span></span>

<span data-ttu-id="4ac58-234">Můžete se pořád připojit repliky dostupnosti tooeach samostatně připojením přímo toohello instance služby.</span><span class="sxs-lookup"><span data-stu-id="4ac58-234">You can still connect tooeach availability replica separately by connecting directly toohello service instance.</span></span> <span data-ttu-id="4ac58-235">Navíc vzhledem k tomu, že zpětně kompatibilní s klienty zrcadlení databáze skupiny dostupnosti se můžete připojit toohello replik dostupnosti jako databáze zrcadlení partneři jsou nakonfigurovány hello repliky podobný zrcadlení toodatabase:</span><span class="sxs-lookup"><span data-stu-id="4ac58-235">Also, since availability groups are backward compatible with database mirroring clients, you can connect toohello availability replicas like database mirroring partners as long as hello replicas are configured similar toodatabase mirroring:</span></span>

* <span data-ttu-id="4ac58-236">Jedna primární replika a jedna sekundární replika</span><span class="sxs-lookup"><span data-stu-id="4ac58-236">One primary replica and one secondary replica</span></span>
* <span data-ttu-id="4ac58-237">Hello sekundární repliky nakonfigurován jako bez možnosti čtení (**čitelný sekundární** možnost nastavit příliš**ne**)</span><span class="sxs-lookup"><span data-stu-id="4ac58-237">hello secondary replica is configured as non-readable (**Readable Secondary** option set too**No**)</span></span>

<span data-ttu-id="4ac58-238">Zde je příklad klienta připojovací řetězec, který odpovídá konfiguraci zrcadlení jako databáze toothis pomocí ADO.NET nebo SQL Server Native Client:</span><span class="sxs-lookup"><span data-stu-id="4ac58-238">An example client connection string that corresponds toothis database mirroring-like configuration using ADO.NET or SQL Server Native Client is below:</span></span>

    Data Source=ReplicaServer1;Failover Partner=ReplicaServer2;Initial Catalog=AvailabilityDatabase;

<span data-ttu-id="4ac58-239">Další informace o připojení klientů najdete v tématu:</span><span class="sxs-lookup"><span data-stu-id="4ac58-239">For more information on client connectivity, see:</span></span>

* [<span data-ttu-id="4ac58-240">Klíčová slova připojovací řetězec pomocí SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="4ac58-240">Using Connection String Keywords with SQL Server Native Client</span></span>](https://msdn.microsoft.com/library/ms130822.aspx)
* [<span data-ttu-id="4ac58-241">Připojení klienti tooa relace zrcadlení databáze (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="4ac58-241">Connect Clients tooa Database Mirroring Session (SQL Server)</span></span>](https://technet.microsoft.com/library/ms175484.aspx)
* [<span data-ttu-id="4ac58-242">TooAvailability naslouchací proces skupiny v IT hybridní připojení</span><span class="sxs-lookup"><span data-stu-id="4ac58-242">Connecting tooAvailability Group Listener in Hybrid IT</span></span>](http://blogs.msdn.com/b/sqlalwayson/archive/2013/02/14/connecting-to-availability-group-listener-in-hybrid-it.aspx)
* [<span data-ttu-id="4ac58-243">Naslouchací procesy skupiny dostupnosti, připojení klientů a převzetí služeb při selhání aplikace (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="4ac58-243">Availability Group Listeners, Client Connectivity, and Application Failover (SQL Server)</span></span>](https://technet.microsoft.com/library/hh213417.aspx)
* [<span data-ttu-id="4ac58-244">Použití řetězců připojení zrcadlení databáze se skupinami dostupnosti</span><span class="sxs-lookup"><span data-stu-id="4ac58-244">Using Database-Mirroring Connection Strings with Availability Groups</span></span>](https://technet.microsoft.com/library/hh213417.aspx)

### <a name="network-latency-in-hybrid-it"></a><span data-ttu-id="4ac58-245">Latence sítě v hybridní IT</span><span class="sxs-lookup"><span data-stu-id="4ac58-245">Network latency in hybrid IT</span></span>
<span data-ttu-id="4ac58-246">Měli byste nasadit řešení HADR hello předpokladu, že může být období s vysoké latenci mezi místní sítí a Azure.</span><span class="sxs-lookup"><span data-stu-id="4ac58-246">You should deploy your HADR solution with hello assumption that there may be periods of time with high network latency between your on-premises network and Azure.</span></span> <span data-ttu-id="4ac58-247">Při nasazování tooAzure repliky, používejte pro hello synchronizace režim asynchronního potvrzování místo synchronním potvrzováním.</span><span class="sxs-lookup"><span data-stu-id="4ac58-247">When deploying replicas tooAzure, you should use asynchronous commit instead of synchronous commit for hello synchronization mode.</span></span> <span data-ttu-id="4ac58-248">Při nasazení serverů zrcadlení databáze místně i v Azure, používat režim vysoce výkonné hello místo hello vysokou bezpečnost režimu.</span><span class="sxs-lookup"><span data-stu-id="4ac58-248">When deploying database mirroring servers both on-premises and in Azure, use hello high-performance mode instead of hello high-safety mode.</span></span>

### <a name="geo-replication-support"></a><span data-ttu-id="4ac58-249">Geografická replikace podpory</span><span class="sxs-lookup"><span data-stu-id="4ac58-249">Geo-replication support</span></span>
<span data-ttu-id="4ac58-250">Geografická replikace v disky Azure nepodporuje hello datový soubor a soubor protokolu hello stejné databáze toobe uložené na různých discích.</span><span class="sxs-lookup"><span data-stu-id="4ac58-250">Geo-replication in Azure disks does not support hello data file and log file of hello same database toobe stored on separate disks.</span></span> <span data-ttu-id="4ac58-251">GRS replikovat změny na každém disku nezávisle a asynchronně.</span><span class="sxs-lookup"><span data-stu-id="4ac58-251">GRS replicates changes on each disk independently and asynchronously.</span></span> <span data-ttu-id="4ac58-252">Tento mechanismus zaručuje hello zápisu pořadí v rámci hello geograficky replikované kopírovat, ale ne geograficky replikované kopie více disků jediný disk.</span><span class="sxs-lookup"><span data-stu-id="4ac58-252">This mechanism guarantees hello write order within a single disk on hello geo-replicated copy, but not across geo-replicated copies of multiple disks.</span></span> <span data-ttu-id="4ac58-253">Pokud nakonfigurujete databáze toostore jeho datového souboru a jeho soubor protokolu na různých discích, hello obnovit disky po havárii může obsahovat více aktuální kopie hello datový soubor než hello souboru protokolu, které zalomení hello předběžné protokolování v systému SQL Server a hello kyseliny Vlastnosti transakce.</span><span class="sxs-lookup"><span data-stu-id="4ac58-253">If you configure a database toostore its data file and its log file on separate disks, hello recovered disks after a disaster may contain a more up-to-date copy of hello data file than hello log file, which breaks hello write-ahead log in SQL Server and hello ACID properties of transactions.</span></span> <span data-ttu-id="4ac58-254">Pokud nemáte hello možnost toodisable geografická replikace na účet úložiště hello, byste měli mít všechna data a soubory protokolu pro danou databázi na hello stejný disk.</span><span class="sxs-lookup"><span data-stu-id="4ac58-254">If you do not have hello option toodisable geo-replication on hello storage account, you should keep all data and log files for a given database on hello same disk.</span></span> <span data-ttu-id="4ac58-255">Pokud je nutné použít více než jeden disk z důvodu toohello velikost hello databáze, je třeba toodeploy jedno z řešení obnovení po havárii hello uvedené výše redundanci dat tooensure.</span><span class="sxs-lookup"><span data-stu-id="4ac58-255">If you must use more than one disk due toohello size of hello database, you need toodeploy one of hello disaster recovery solutions listed above tooensure data redundancy.</span></span>

## <a name="next-steps"></a><span data-ttu-id="4ac58-256">Další kroky</span><span class="sxs-lookup"><span data-stu-id="4ac58-256">Next steps</span></span>
<span data-ttu-id="4ac58-257">Pokud potřebujete toocreate virtuální počítač Azure se systémem SQL Server, přečtěte si [zřizování virtuálního počítače systému SQL Server na platformě Azure](virtual-machines-windows-portal-sql-server-provision.md).</span><span class="sxs-lookup"><span data-stu-id="4ac58-257">If you need toocreate an Azure virtual machine with SQL Server, see [Provisioning a SQL Server Virtual Machine on Azure](virtual-machines-windows-portal-sql-server-provision.md).</span></span>

<span data-ttu-id="4ac58-258">tooget hello nejlepší výkon ze SQL Server běžící na virtuálním počítači Azure, najdete v části hello pokyny v [osvědčené postupy z hlediska výkonu pro SQL Server v Azure Virtual Machines](virtual-machines-windows-sql-performance.md).</span><span class="sxs-lookup"><span data-stu-id="4ac58-258">tooget hello best performance from SQL Server running on an Azure VM, see hello guidance in [Performance Best Practices for SQL Server in Azure Virtual Machines](virtual-machines-windows-sql-performance.md).</span></span>

<span data-ttu-id="4ac58-259">Další témata související s toorunning systému SQL Server ve virtuálních počítačích Azure, najdete v části [systému SQL Server na virtuálních počítačích Azure](virtual-machines-windows-sql-server-iaas-overview.md).</span><span class="sxs-lookup"><span data-stu-id="4ac58-259">For other topics related toorunning SQL Server in Azure VMs, see [SQL Server on Azure Virtual Machines](virtual-machines-windows-sql-server-iaas-overview.md).</span></span>

### <a name="other-resources"></a><span data-ttu-id="4ac58-260">Další prostředky</span><span class="sxs-lookup"><span data-stu-id="4ac58-260">Other resources</span></span>
* [<span data-ttu-id="4ac58-261">Instalace nové doménové struktury služby Active Directory v Azure</span><span class="sxs-lookup"><span data-stu-id="4ac58-261">Install a new Active Directory forest in Azure</span></span>](../../../active-directory/active-directory-new-forest-virtual-machine.md)
* [<span data-ttu-id="4ac58-262">Vytvoření clusteru převzetí služeb při selhání pro skupiny dostupnosti ve virtuálním počítači Azure</span><span class="sxs-lookup"><span data-stu-id="4ac58-262">Create Failover Cluster for availability groups in Azure VM</span></span>](http://gallery.technet.microsoft.com/scriptcenter/Create-WSFC-Cluster-for-7c207d3a)

