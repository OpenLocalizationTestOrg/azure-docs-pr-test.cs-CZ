---
title: "Vysoká dostupnost a zotavení po havárii pro SQL Server | Microsoft Docs"
description: "Informace o různých typů HADR strategie pro SQL Server běžící v Azure Virtual Machines."
services: virtual-machines-windows
documentationcenter: na
author: MikeRayMSFT
manager: jhubbard
editor: 
tags: azure-service-management
ms.assetid: 53981f7e-8370-4979-b26a-93a5988d905f
ms.service: virtual-machines-sql
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 06/27/2017
ms.author: mikeray
ms.openlocfilehash: 27d05c1681f7d7b3090fc7abd4a6b15d1c030e2c
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 07/11/2017
---
# <a name="high-availability-and-disaster-recovery-for-sql-server-in-azure-virtual-machines"></a><span data-ttu-id="381aa-103">Vysoká dostupnost a zotavení po havárii pro SQL Server v Azure Virtual Machines</span><span class="sxs-lookup"><span data-stu-id="381aa-103">High availability and disaster recovery for SQL Server in Azure Virtual Machines</span></span>

<span data-ttu-id="381aa-104">Virtuální počítače Microsoft Azure (VM) se systémem SQL Server může pomoci snížit náklady na vysokou dostupnost a po havárii (HADR) obnovení databáze řešení.</span><span class="sxs-lookup"><span data-stu-id="381aa-104">Microsoft Azure virtual machines (VMs) with SQL Server can help lower the cost of a high availability and disaster recovery (HADR) database solution.</span></span> <span data-ttu-id="381aa-105">Většina řešení SQL Server HADR jsou podporovány ve virtuálních počítačích Azure, jen Azure i jako hybridní řešení.</span><span class="sxs-lookup"><span data-stu-id="381aa-105">Most SQL Server HADR solutions are supported in Azure virtual machines, both as Azure-only and as hybrid solutions.</span></span> <span data-ttu-id="381aa-106">V řešení jen Azure celý systém HADR běží v Azure.</span><span class="sxs-lookup"><span data-stu-id="381aa-106">In an Azure-only solution, the entire HADR system runs in Azure.</span></span> <span data-ttu-id="381aa-107">V hybridní konfigurace část řešení běží v Azure a další část spustí místní ve vaší organizaci.</span><span class="sxs-lookup"><span data-stu-id="381aa-107">In a hybrid configuration, part of the solution runs in Azure and the other part runs on-premises in your organization.</span></span> <span data-ttu-id="381aa-108">Flexibilitu prostředí Azure umožňuje přesunout částečně nebo zcela do Azure pro uspokojení nároky a HADR požadavky systémů databáze systému SQL Server.</span><span class="sxs-lookup"><span data-stu-id="381aa-108">The flexibility of the Azure environment enables you to move partially or completely to Azure to satisfy the budget and HADR requirements of your SQL Server database systems.</span></span>

[!INCLUDE [learn-about-deployment-models](../../../../includes/learn-about-deployment-models-both-include.md)]

## <a name="understanding-the-need-for-an-hadr-solution"></a><span data-ttu-id="381aa-109">Principy potřebu řešení s HADR</span><span class="sxs-lookup"><span data-stu-id="381aa-109">Understanding the need for an HADR solution</span></span>
<span data-ttu-id="381aa-110">Můžete se rozhodnout, aby, zda má systém databáze HADR možností, které vyžaduje smlouvu úrovně služeb (SLA).</span><span class="sxs-lookup"><span data-stu-id="381aa-110">It is up to you to ensure that your database system possesses the HADR capabilities that the service-level agreement (SLA) requires.</span></span> <span data-ttu-id="381aa-111">Skutečnost, že Azure poskytuje vysokou dostupnost mechanismy, jako je například služba opravy pro cloudové služby a detekce chyb obnovení pro virtuální počítače, které samo o sobě zaručit, že splňujete požadované smlouvy o úrovni služeb.</span><span class="sxs-lookup"><span data-stu-id="381aa-111">The fact that Azure provides high availability mechanisms, such as service healing for cloud services and failure recovery detection for Virtual Machines, does not itself guarantee you can meet the desired SLA.</span></span> <span data-ttu-id="381aa-112">Tyto mechanismy chránit zajištění vysoké dostupnosti virtuálních počítačů, ale ne vysokou dostupnost systému SQL Server spuštěnou uvnitř virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="381aa-112">These mechanisms protect the high availability of the VMs but not the high availability of SQL Server running inside the VMs.</span></span> <span data-ttu-id="381aa-113">Je možné pro instanci systému SQL Server k selhání, zatímco virtuální počítač je online a v pořádku.</span><span class="sxs-lookup"><span data-stu-id="381aa-113">It is possible for the SQL Server instance to fail while the VM is online and healthy.</span></span> <span data-ttu-id="381aa-114">Kromě toho i vysokou dostupnost, které mechanismy, které poskytuje Azure povolit výpadek virtuálních počítačů z důvodu události je to třeba obnovení ze softwaru nebo selhání hardwaru a upgrady operačního systému.</span><span class="sxs-lookup"><span data-stu-id="381aa-114">Moreover, even the high availability mechanisms provided by Azure allow for downtime of the VMs due to events such as recovery from software or hardware failures and operating system upgrades.</span></span>

<span data-ttu-id="381aa-115">Geograficky redundantní úložiště (GRS) v Azure, což je implementováno s funkci geografická replikace, navíc nemusí být řešení pro zotavení po havárii odpovídající, pro vaše databáze.</span><span class="sxs-lookup"><span data-stu-id="381aa-115">In addition, Geo Redundant Storage (GRS) in Azure, which is implemented with a feature called geo-replication, may not be an adequate disaster recovery solution for your databases.</span></span> <span data-ttu-id="381aa-116">Protože geografická replikace asynchronně odešle data, může dojít ke ztrátě v případě havárie poslední aktualizace.</span><span class="sxs-lookup"><span data-stu-id="381aa-116">Because geo-replication sends data asynchronously, recent updates can be lost in the event of disaster.</span></span> <span data-ttu-id="381aa-117">Další informace týkající se omezeních geografická replikace jsou popsané v [geografická replikace není podporována pro data a soubory protokolu na různých discích](#geo-replication-support) části.</span><span class="sxs-lookup"><span data-stu-id="381aa-117">More information regarding geo-replication limitations are covered in the [Geo-replication not supported for data and log files on separate disks](#geo-replication-support) section.</span></span>

## <a name="hadr-deployment-architectures"></a><span data-ttu-id="381aa-118">HADR nasazení architektury</span><span class="sxs-lookup"><span data-stu-id="381aa-118">HADR deployment architectures</span></span>
<span data-ttu-id="381aa-119">SQL Server HADR technologie, které jsou podporovány v Azure patří:</span><span class="sxs-lookup"><span data-stu-id="381aa-119">SQL Server HADR technologies that are supported in Azure include:</span></span>

* [<span data-ttu-id="381aa-120">Always On skupiny dostupnosti</span><span class="sxs-lookup"><span data-stu-id="381aa-120">Always On Availability Groups</span></span>](https://technet.microsoft.com/library/hh510230.aspx)
* [<span data-ttu-id="381aa-121">Always On instance clusteru převzetí služeb při selhání</span><span class="sxs-lookup"><span data-stu-id="381aa-121">Always On Failover Cluster Instances</span></span>](https://technet.microsoft.com/library/ms189134.aspx)
* [<span data-ttu-id="381aa-122">Přesouvání protokolu</span><span class="sxs-lookup"><span data-stu-id="381aa-122">Log Shipping</span></span>](https://technet.microsoft.com/library/ms187103.aspx)
* [<span data-ttu-id="381aa-123">Zálohování systému SQL Server a obnovení služby úložiště objektů Blob v Azure</span><span class="sxs-lookup"><span data-stu-id="381aa-123">SQL Server Backup and Restore with Azure Blob Storage Service</span></span>](https://msdn.microsoft.com/library/jj919148.aspx)
* <span data-ttu-id="381aa-124">[Zrcadlení databáze](https://technet.microsoft.com/library/ms189852.aspx) – nepoužívané v systému SQL Server 2016</span><span class="sxs-lookup"><span data-stu-id="381aa-124">[Database Mirroring](https://technet.microsoft.com/library/ms189852.aspx) - Deprecated in SQL Server 2016</span></span>

<span data-ttu-id="381aa-125">Je možné kombinovat technologie společně k implementaci řešení SQL serveru, který má vysokou dostupnost a funkcím pro obnovení po havárii.</span><span class="sxs-lookup"><span data-stu-id="381aa-125">It is possible to combine the technologies together to implement a SQL Server solution that has both high availability and disaster recovery capabilities.</span></span> <span data-ttu-id="381aa-126">V závislosti na technologie, které používáte může vyžadovat hybridní nasazení tunelového připojení sítě VPN s virtuální síť Azure.</span><span class="sxs-lookup"><span data-stu-id="381aa-126">Depending on the technology you use, a hybrid deployment may require a VPN tunnel with the Azure virtual network.</span></span> <span data-ttu-id="381aa-127">V níže uvedených částech ukážeme některé architektur příklad nasazení.</span><span class="sxs-lookup"><span data-stu-id="381aa-127">The sections below show you some of the example deployment architectures.</span></span>

## <a name="azure-only-high-availability-solutions"></a><span data-ttu-id="381aa-128">Jenom Azure: řešení s vysokou dostupností</span><span class="sxs-lookup"><span data-stu-id="381aa-128">Azure-only: High availability solutions</span></span>

<span data-ttu-id="381aa-129">Řešení vysoké dostupnosti může mít pro SQL Server na úrovni databáze pomocí skupin dostupnosti Always On - nazývají skupiny dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="381aa-129">You can have a high availability solution for SQL Server at a database level with Always On Availability Groups - called availability groups.</span></span> <span data-ttu-id="381aa-130">Můžete také vytvořit řešení vysoké dostupnosti na úrovni instance instancemi vždy na převzetí služeb při selhání clusteru – převzetí služeb při selhání instance clusteru.</span><span class="sxs-lookup"><span data-stu-id="381aa-130">You can also create a high availability solution at an instance level with Always On Failover Cluster Instances - failover cluster instances.</span></span> <span data-ttu-id="381aa-131">Pro další redundanci můžete vytvořit redundance na obou úrovních vytvořením skupiny dostupnosti na převzetí služeb při selhání instance clusteru.</span><span class="sxs-lookup"><span data-stu-id="381aa-131">For additional redundancy, you can create redundancy at both levels by creating availability groups on failover cluster instances.</span></span> 

| <span data-ttu-id="381aa-132">Technologie</span><span class="sxs-lookup"><span data-stu-id="381aa-132">Technology</span></span> | <span data-ttu-id="381aa-133">Příklad architektury</span><span class="sxs-lookup"><span data-stu-id="381aa-133">Example Architectures</span></span> |
| --- | --- |
| <span data-ttu-id="381aa-134">**Skupiny dostupnosti**</span><span class="sxs-lookup"><span data-stu-id="381aa-134">**Availability groups**</span></span> |<span data-ttu-id="381aa-135">Spuštění ve virtuálních počítačích Azure ve stejné oblasti replik dostupnosti zajištění vysoké dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="381aa-135">Availability replicas running in Azure VMs in the same region provide high availability.</span></span> <span data-ttu-id="381aa-136">Musíte nakonfigurovat řadič domény virtuálního počítače, protože Windows převzetí služeb při selhání clustering vyžaduje domény služby Active Directory.</span><span class="sxs-lookup"><span data-stu-id="381aa-136">You need to configure a domain controller VM, because Windows failover clustering requires an Active Directory domain.</span></span><br/> <span data-ttu-id="381aa-137">![Skupiny dostupnosti](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_ha_always_on.gif)</span><span class="sxs-lookup"><span data-stu-id="381aa-137">![Availability Groups](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_ha_always_on.gif)</span></span><br/><span data-ttu-id="381aa-138">Další informace najdete v tématu [konfigurace skupiny dostupnosti v Azure (GUI)](virtual-machines-windows-portal-sql-alwayson-availability-groups.md).</span><span class="sxs-lookup"><span data-stu-id="381aa-138">For more information, see [Configure Availability Groups in Azure (GUI)](virtual-machines-windows-portal-sql-alwayson-availability-groups.md).</span></span> |
| <span data-ttu-id="381aa-139">**Instance clusteru převzetí služeb při selhání**</span><span class="sxs-lookup"><span data-stu-id="381aa-139">**Failover cluster instances**</span></span> |<span data-ttu-id="381aa-140">Instance clusteru převzetí služeb při selhání (FCI), které vyžadují sdílené úložiště, můžete vytvořit 3 různými způsoby.</span><span class="sxs-lookup"><span data-stu-id="381aa-140">Failover Cluster Instances (FCI), which require shared storage, can be created in 3 different ways.</span></span><br/><br/><span data-ttu-id="381aa-141">1. Cluster převzetí služeb při selhání dvěma uzly se systémem ve virtuálních počítačích Azure s použitím připojené úložiště [Windows Server 2016 prostory úložiště – přímé \(S2D\) ](virtual-machines-windows-portal-sql-create-failover-cluster.md) zajistit softwarový virtuální síť SAN.</span><span class="sxs-lookup"><span data-stu-id="381aa-141">1. A two-node failover cluster running in Azure VMs with attached storage using [Windows Server 2016 Storage Spaces Direct \(S2D\)](virtual-machines-windows-portal-sql-create-failover-cluster.md) to provide a software-based virtual SAN.</span></span><br/><br/><span data-ttu-id="381aa-142">2. Cluster převzetí služeb při selhání dvěma uzly se systémem ve virtuálních počítačích Azure s úložištěm podporuje clustering řešení třetí strany.</span><span class="sxs-lookup"><span data-stu-id="381aa-142">2. A two-node failover cluster running in Azure VMs with storage supported by a third-party clustering solution.</span></span> <span data-ttu-id="381aa-143">Konkrétní příklad, který používá s DataKeeper najdete v tématu [vysoká dostupnost pro sdílenou složku pomocí clustering převzetí služeb při selhání a 3. stran software s DataKeeper](https://azure.microsoft.com/blog/high-availability-for-a-file-share-using-wsfc-ilb-and-3rd-party-software-sios-datakeeper/).</span><span class="sxs-lookup"><span data-stu-id="381aa-143">For a specific example that uses SIOS DataKeeper, see [High availability for a file share using failover clustering and 3rd party software SIOS DataKeeper](https://azure.microsoft.com/blog/high-availability-for-a-file-share-using-wsfc-ilb-and-3rd-party-software-sios-datakeeper/).</span></span><br/><br/><span data-ttu-id="381aa-144">3. Clusteru s podporou převzetí služeb při selhání dvěma uzly ve virtuálních počítačích Azure s vzdálené služby iSCSI Target sdílené blokové úložiště přes ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="381aa-144">3. A two-node failover cluster running in Azure VMs with remote iSCSI Target shared block storage via ExpressRoute.</span></span> <span data-ttu-id="381aa-145">Například NetApp privátní úložiště (NPS) zpřístupní cíle iSCSI prostřednictvím ExpressRoute s Equinix na virtuálních počítačích Azure.</span><span class="sxs-lookup"><span data-stu-id="381aa-145">For example, NetApp Private Storage (NPS) exposes an iSCSI target via ExpressRoute with Equinix to Azure VMs.</span></span><br/><br/><span data-ttu-id="381aa-146">Pro sdílené úložiště jiných výrobců a řešení replikace dat by měl kontaktujte dodavatele kvůli veškeré problémy související s přístup k datům na převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="381aa-146">For third-party shared storage and data replication solutions, you should contact the vendor for any issues related to accessing data on failover.</span></span><br/><br/><span data-ttu-id="381aa-147">Všimněte si, že pomocí FCI na [Azure File storage](https://azure.microsoft.com/services/storage/files/) se zatím nepodporuje, protože toto řešení nevyužívá Storage úrovně Premium.</span><span class="sxs-lookup"><span data-stu-id="381aa-147">Note that using FCI on top of [Azure File storage](https://azure.microsoft.com/services/storage/files/) is not supported yet, because this solution does not utilize Premium Storage.</span></span> <span data-ttu-id="381aa-148">Pracujeme na brzy to podporují.</span><span class="sxs-lookup"><span data-stu-id="381aa-148">We are working to support this soon.</span></span> |

## <a name="azure-only-disaster-recovery-solutions"></a><span data-ttu-id="381aa-149">Jenom Azure: řešení zotavení po havárii</span><span class="sxs-lookup"><span data-stu-id="381aa-149">Azure-only: Disaster recovery solutions</span></span>
<span data-ttu-id="381aa-150">Můžete mít řešení zotavení po havárii pro databáze SQL Server v Azure pomocí skupin dostupnosti, zrcadlení databáze nebo zálohování a obnovení pomocí úložiště objektů BLOB.</span><span class="sxs-lookup"><span data-stu-id="381aa-150">You can have a disaster recovery solution for your SQL Server databases in Azure using availability groups, database mirroring, or backup and restore with storage blobs.</span></span>

| <span data-ttu-id="381aa-151">Technologie</span><span class="sxs-lookup"><span data-stu-id="381aa-151">Technology</span></span> | <span data-ttu-id="381aa-152">Příklad architektury</span><span class="sxs-lookup"><span data-stu-id="381aa-152">Example Architectures</span></span> |
| --- | --- |
| <span data-ttu-id="381aa-153">**Skupiny dostupnosti**</span><span class="sxs-lookup"><span data-stu-id="381aa-153">**Availability Groups**</span></span> |<span data-ttu-id="381aa-154">Repliky dostupnosti systémem přes několik datových center ve virtuálních počítačích Azure pro zotavení po havárii.</span><span class="sxs-lookup"><span data-stu-id="381aa-154">Availability replicas running across multiple datacenters in Azure VMs for disaster recovery.</span></span> <span data-ttu-id="381aa-155">Toto řešení mezi oblastmi chrání před dokončení lokality výpadku.</span><span class="sxs-lookup"><span data-stu-id="381aa-155">This cross-region solution protects against complete site outage.</span></span> <br/> <span data-ttu-id="381aa-156">![Skupiny dostupnosti](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_dr_alwayson.png)</span><span class="sxs-lookup"><span data-stu-id="381aa-156">![Availability Groups](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_dr_alwayson.png)</span></span><br/><span data-ttu-id="381aa-157">V oblasti musí být všechny repliky v rámci stejné cloudové služby a stejnou virtuální síť.</span><span class="sxs-lookup"><span data-stu-id="381aa-157">Within a region, all replicas should be within the same cloud service and the same VNet.</span></span> <span data-ttu-id="381aa-158">Protože každá oblast bude mít samostatné virtuální sítě, tato řešení vyžadují virtuální síť připojení virtuální sítě.</span><span class="sxs-lookup"><span data-stu-id="381aa-158">Because each region will have a separate VNet, these solutions require VNet to VNet connectivity.</span></span> <span data-ttu-id="381aa-159">Další informace najdete v tématu [konfigurace připojení typu VNet-to-VNet pomocí portálu Azure](../../../vpn-gateway/vpn-gateway-howto-vnet-vnet-resource-manager-portal.md).</span><span class="sxs-lookup"><span data-stu-id="381aa-159">For more information, see [Configure a VNet-to-VNet connection using the Azure portal](../../../vpn-gateway/vpn-gateway-howto-vnet-vnet-resource-manager-portal.md).</span></span> <span data-ttu-id="381aa-160">Podrobné pokyny najdete v tématu [nakonfigurovat skupinu dostupnosti SQL Server na virtuálních počítačích Azure v různých oblastech](virtual-machines-windows-portal-sql-availability-group-dr.md).</span><span class="sxs-lookup"><span data-stu-id="381aa-160">For detailed instructions, see [Configure a SQL Server Availability Group on Azure Virtual Machines in Different Regions](virtual-machines-windows-portal-sql-availability-group-dr.md).</span></span>|
| <span data-ttu-id="381aa-161">**Zrcadlení databáze**</span><span class="sxs-lookup"><span data-stu-id="381aa-161">**Database Mirroring**</span></span> |<span data-ttu-id="381aa-162">Objekt zabezpečení a zrcadlení a servery v různých datových centrech pro zotavení po havárii.</span><span class="sxs-lookup"><span data-stu-id="381aa-162">Principal and mirror and servers running in different datacenters for disaster recovery.</span></span> <span data-ttu-id="381aa-163">Je nutné nasadit pomocí certifikátů serveru, protože domény služby active directory nemůžou zahrnovat několik datových center.</span><span class="sxs-lookup"><span data-stu-id="381aa-163">You must deploy using server certificates because an active directory domain cannot span multiple datacenters.</span></span><br/>![Zrcadlení databáze](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_dr_dbmirroring.gif) |
| <span data-ttu-id="381aa-165">**Zálohování a obnovení pomocí služby Azure Blob Storage**</span><span class="sxs-lookup"><span data-stu-id="381aa-165">**Backup and Restore with Azure Blob Storage Service**</span></span> |<span data-ttu-id="381aa-166">Provozní databáze zálohovat přímo do úložiště objektů blob v jiném datovém centru pro zotavení po havárii.</span><span class="sxs-lookup"><span data-stu-id="381aa-166">Production databases backed up directly to blob storage in a different datacenter for disaster recovery.</span></span><br/><span data-ttu-id="381aa-167">![Zálohování a obnovení](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_dr_backup_restore.gif)</span><span class="sxs-lookup"><span data-stu-id="381aa-167">![Backup and Restore](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_dr_backup_restore.gif)</span></span><br/><span data-ttu-id="381aa-168">Další informace najdete v tématu [zálohování a obnovení pro SQL Server v Azure Virtual Machines](virtual-machines-windows-sql-backup-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="381aa-168">For more information, see [Backup and Restore for SQL Server in Azure Virtual Machines](virtual-machines-windows-sql-backup-recovery.md).</span></span> |

## <a name="hybrid-it-disaster-recovery-solutions"></a><span data-ttu-id="381aa-169">Hybridního IT: Řešení zotavení po havárii</span><span class="sxs-lookup"><span data-stu-id="381aa-169">Hybrid IT: Disaster recovery solutions</span></span>
<span data-ttu-id="381aa-170">Můžete mít řešení pro zotavení po havárii pro databáze SQL Server v IT hybridní prostředí pomocí skupin dostupnosti, zrcadlení databáze, přesouvání protokolu a zálohování a obnovení s Azure blog storage.</span><span class="sxs-lookup"><span data-stu-id="381aa-170">You can have a disaster recovery solution for your SQL Server databases in a hybrid-IT environment using availability groups, database mirroring, log shipping, and backup and restore with Azure blog storage.</span></span>

| <span data-ttu-id="381aa-171">Technologie</span><span class="sxs-lookup"><span data-stu-id="381aa-171">Technology</span></span> | <span data-ttu-id="381aa-172">Příklad architektury</span><span class="sxs-lookup"><span data-stu-id="381aa-172">Example Architectures</span></span> |
| --- | --- |
| <span data-ttu-id="381aa-173">**Skupiny dostupnosti**</span><span class="sxs-lookup"><span data-stu-id="381aa-173">**Availability Groups**</span></span> |<span data-ttu-id="381aa-174">Některé repliky dostupnosti spuštěna ve virtuálních počítačích Azure a další repliky spuštěné místně pro zotavení po havárii webů.</span><span class="sxs-lookup"><span data-stu-id="381aa-174">Some availability replicas running in Azure VMs and other replicas running on-premises for cross-site disaster recovery.</span></span> <span data-ttu-id="381aa-175">Pracoviště může být buď místní nebo v datovém centru Azure.</span><span class="sxs-lookup"><span data-stu-id="381aa-175">The production site can be either on-premises or in an Azure datacenter.</span></span><br/>![Skupiny dostupnosti](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_alwayson.gif)<br/><span data-ttu-id="381aa-177">Protože všechny repliky dostupnosti musí být ve stejném clusteru převzetí služeb při selhání, musí clusteru span obě sítě (clusteru s podporou převzetí služeb při selhání více podsítí).</span><span class="sxs-lookup"><span data-stu-id="381aa-177">Because all availability replicas must be in the same failover cluster, the cluster must span both networks (a multi-subnet failover cluster).</span></span> <span data-ttu-id="381aa-178">Tato konfigurace vyžaduje připojení VPN mezi Azure a místní sítě.</span><span class="sxs-lookup"><span data-stu-id="381aa-178">This configuration requires a VPN connection between Azure and the on-premises network.</span></span><br/><br/><span data-ttu-id="381aa-179">Úspěšné zotavení po havárii databází nainstalujete také repliky řadiče domény v lokalitě pro obnovení po havárii.</span><span class="sxs-lookup"><span data-stu-id="381aa-179">For successful disaster recovery of your databases, you should also install a replica domain controller at the disaster recovery site.</span></span><br/><br/><span data-ttu-id="381aa-180">Je možné použít Průvodce přidáním repliky v aplikaci SSMS přidat repliku Azure do existující vždy na dostupnosti skupiny.</span><span class="sxs-lookup"><span data-stu-id="381aa-180">It is possible to use the Add Replica Wizard in SSMS to add an Azure replica to an existing Always On Availability Group.</span></span> <span data-ttu-id="381aa-181">Další informace najdete v tématu kurz: rozšíření vaší vždy na skupiny dostupnosti do Azure.</span><span class="sxs-lookup"><span data-stu-id="381aa-181">For more information, see Tutorial: Extend your Always On Availability Group to Azure.</span></span> |
| <span data-ttu-id="381aa-182">**Zrcadlení databáze**</span><span class="sxs-lookup"><span data-stu-id="381aa-182">**Database Mirroring**</span></span> |<span data-ttu-id="381aa-183">Jeden partner spuštění ve virtuálním počítači Azure a ostatní spuštěné místní pro zotavení po havárii webů pomocí certifikátů serveru.</span><span class="sxs-lookup"><span data-stu-id="381aa-183">One partner running in an Azure VM and the other running on-premises for cross-site disaster recovery using server certificates.</span></span> <span data-ttu-id="381aa-184">Partneři nemusí být ve stejné doméně služby Active Directory a není třeba žádné připojení k síti VPN.</span><span class="sxs-lookup"><span data-stu-id="381aa-184">Partners do not need to be in the same Active Directory domain, and no VPN connection is required.</span></span><br/><span data-ttu-id="381aa-185">![Zrcadlení databáze](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_dbmirroring.gif)</span><span class="sxs-lookup"><span data-stu-id="381aa-185">![Database Mirroring](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_dbmirroring.gif)</span></span><br/><span data-ttu-id="381aa-186">Jiné databáze zrcadlení scénář zahrnuje jednu partnera spuštění ve virtuálním počítači Azure a ostatní spuštěné místní ve stejné doméně služby Active Directory pro zotavení po havárii webů.</span><span class="sxs-lookup"><span data-stu-id="381aa-186">Another database mirroring scenario involves one partner running in an Azure VM and the other running on-premises in the same Active Directory domain for cross-site disaster recovery.</span></span> <span data-ttu-id="381aa-187">A [VPN připojení mezi virtuální síť Azure a místní sítí](../../../vpn-gateway/vpn-gateway-site-to-site-create.md) je vyžadován.</span><span class="sxs-lookup"><span data-stu-id="381aa-187">A [VPN connection between the Azure virtual network and the on-premises network](../../../vpn-gateway/vpn-gateway-site-to-site-create.md) is required.</span></span><br/><br/><span data-ttu-id="381aa-188">Úspěšné zotavení po havárii databází nainstalujete také repliky řadiče domény v lokalitě pro obnovení po havárii.</span><span class="sxs-lookup"><span data-stu-id="381aa-188">For successful disaster recovery of your databases, you should also install a replica domain controller at the disaster recovery site.</span></span> |
| <span data-ttu-id="381aa-189">**Přesouvání protokolu**</span><span class="sxs-lookup"><span data-stu-id="381aa-189">**Log Shipping**</span></span> |<span data-ttu-id="381aa-190">Jeden server se službou ve virtuálním počítači Azure a ostatní spuštěné místní zotavení po havárii webů.</span><span class="sxs-lookup"><span data-stu-id="381aa-190">One server running in an Azure VM and the other running on-premises for cross-site disaster recovery.</span></span> <span data-ttu-id="381aa-191">Přesouvání protokolu, závisí na sdílení souborů systému Windows, je nutné připojení VPN mezi virtuální síť Azure a místní sítě.</span><span class="sxs-lookup"><span data-stu-id="381aa-191">Log shipping depends on Windows file sharing, so a VPN connection between the Azure virtual network and the on-premises network is required.</span></span><br/>![Přesouvání protokolu](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_log_shipping.gif)<br/><span data-ttu-id="381aa-193">Úspěšné zotavení po havárii databází nainstalujete také repliky řadiče domény v lokalitě pro obnovení po havárii.</span><span class="sxs-lookup"><span data-stu-id="381aa-193">For successful disaster recovery of your databases, you should also install a replica domain controller at the disaster recovery site.</span></span> |
| <span data-ttu-id="381aa-194">**Zálohování a obnovení pomocí služby Azure Blob Storage**</span><span class="sxs-lookup"><span data-stu-id="381aa-194">**Backup and Restore with Azure Blob Storage Service**</span></span> |<span data-ttu-id="381aa-195">Místní provozních databází zálohují přímo na úložiště objektů blob v Azure pro zotavení po havárii.</span><span class="sxs-lookup"><span data-stu-id="381aa-195">On-premises production databases backed up directly to Azure blob storage for disaster recovery.</span></span><br/><span data-ttu-id="381aa-196">![Zálohování a obnovení](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_backup_restore.gif)</span><span class="sxs-lookup"><span data-stu-id="381aa-196">![Backup and Restore](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_backup_restore.gif)</span></span><br/><span data-ttu-id="381aa-197">Další informace najdete v tématu [zálohování a obnovení pro SQL Server v Azure Virtual Machines](virtual-machines-windows-sql-backup-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="381aa-197">For more information, see [Backup and Restore for SQL Server in Azure Virtual Machines](virtual-machines-windows-sql-backup-recovery.md).</span></span> |

## <a name="important-considerations-for-sql-server-hadr-in-azure"></a><span data-ttu-id="381aa-198">Důležité informace pro SQL Server HADR v Azure</span><span class="sxs-lookup"><span data-stu-id="381aa-198">Important considerations for SQL Server HADR in Azure</span></span>
<span data-ttu-id="381aa-199">Virtuální počítače Azure, úložiště a síťové mít odlišné provozní vlastnosti než místní, nevirtualizovaný infrastruktury IT.</span><span class="sxs-lookup"><span data-stu-id="381aa-199">Azure VMs, storage, and networking have different operational characteristics than an on-premises, non-virtualized IT infrastructure.</span></span> <span data-ttu-id="381aa-200">Úspěšné dokončení implementace řešení HADR SQL Server v Azure vyžaduje, abyste pochopili tyto rozdíly a navrhněte řešení jim přizpůsobit.</span><span class="sxs-lookup"><span data-stu-id="381aa-200">A successful implementation of a HADR SQL Server solution in Azure requires that you understand these differences and design your solution to accommodate them.</span></span>

### <a name="high-availability-nodes-in-an-availability-set"></a><span data-ttu-id="381aa-201">Uzly vysoké dostupnosti v nastavení dostupnosti</span><span class="sxs-lookup"><span data-stu-id="381aa-201">High availability nodes in an availability set</span></span>
<span data-ttu-id="381aa-202">Skupiny dostupnosti v Azure umožní umístěte vysokou dostupnost uzly do samostatné domény selhání (FDs) a aktualizace domény (UDs).</span><span class="sxs-lookup"><span data-stu-id="381aa-202">Availability sets in Azure enable you to place the high availability nodes into separate Fault Domains (FDs) and Update Domains (UDs).</span></span> <span data-ttu-id="381aa-203">Pro virtuální počítače Azure umístit do stejné skupiny dostupnosti musíte ho nasadit v rámci stejné cloudové služby.</span><span class="sxs-lookup"><span data-stu-id="381aa-203">For Azure VMs to be placed in the same availability set, you must deploy them in the same cloud service.</span></span> <span data-ttu-id="381aa-204">Pouze uzly v rámci stejné cloudové služby mohl stát součástí stejné skupiny dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="381aa-204">Only nodes in the same cloud service can participate in the same availability set.</span></span> <span data-ttu-id="381aa-205">Další informace najdete v tématu [Správa dostupnosti virtuálních počítačů](../manage-availability.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="381aa-205">For more information, see [Manage the Availability of Virtual Machines](../manage-availability.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>

### <a name="failover-cluster-behavior-in-azure-networking"></a><span data-ttu-id="381aa-206">Chování clusteru převzetí služeb při selhání v Azure sítě</span><span class="sxs-lookup"><span data-stu-id="381aa-206">Failover cluster behavior in Azure networking</span></span>
<span data-ttu-id="381aa-207">Služba DHCP bez specifikaci RFC v Azure může způsobit vytvoření určité převzetí služeb při selhání konfigurace clusteru k selhání kvůli název sítě clusteru, který je právě přiřazován duplicitní IP adresu, jako je například stejnou IP adresu jako jeden z uzlů clusteru.</span><span class="sxs-lookup"><span data-stu-id="381aa-207">The non-RFC-compliant DHCP service in Azure can cause the creation of certain failover cluster configurations to fail, due to the cluster network name being assigned a duplicate IP address, such as the same IP address as one of the cluster nodes.</span></span> <span data-ttu-id="381aa-208">Jedná se o problém při implementaci skupin dostupnosti, které závisí na funkci systému Windows převzetí služeb při selhání clusteru.</span><span class="sxs-lookup"><span data-stu-id="381aa-208">This is an issue when you implement Availability Groups, which depends on the Windows failover cluster feature.</span></span>

<span data-ttu-id="381aa-209">Představte si situaci, při vytvoření clusteru se dvěma uzly a pak přepne do online režimu:</span><span class="sxs-lookup"><span data-stu-id="381aa-209">Consider the scenario when a two-node cluster is created and brought online:</span></span>

1. <span data-ttu-id="381aa-210">Cluster přepne do režimu online a potom Uzel1 požadavky dynamicky přiřazenou IP adresu pro název sítě s clustery.</span><span class="sxs-lookup"><span data-stu-id="381aa-210">The cluster comes online, then NODE1 requests a dynamically assigned IP address for the cluster network name.</span></span>
2. <span data-ttu-id="381aa-211">Není zadána adresa IP než Uzel1 na vlastní IP adresu pomocí služby DHCP, vzhledem k tomu, že služba DHCP rozpozná, že požadavek pochází z Uzel1 sám sebe.</span><span class="sxs-lookup"><span data-stu-id="381aa-211">No IP address other than NODE1’s own IP address is given by the DHCP service, since the DHCP service recognizes that the request comes from NODE1 itself.</span></span>
3. <span data-ttu-id="381aa-212">Systém Windows rozpozná, že duplicitní adresu přiřazen Uzel1 i název sítě s clustery převzetí služeb při selhání, a výchozí skupiny clusteru selže do režimu online.</span><span class="sxs-lookup"><span data-stu-id="381aa-212">Windows detects that a duplicate address is assigned both to NODE1 and to the failover cluster network name, and the default cluster group fails to come online.</span></span>
4. <span data-ttu-id="381aa-213">Výchozí skupiny clusteru přesune do Uzel2, která zpracovává Uzel1 na IP adresu jako IP adresu clusteru a přináší výchozí skupiny clusteru online.</span><span class="sxs-lookup"><span data-stu-id="381aa-213">The default cluster group moves to NODE2, which treats NODE1’s IP address as the cluster IP address and brings the default cluster group online.</span></span>
5. <span data-ttu-id="381aa-214">Když Uzel2 se pokusí navázat připojení s UZEL1, pakety směrované na Uzel1 nikdy neopustí Uzel2, protože vyřešila Uzel1 na IP adresu na sebe sama.</span><span class="sxs-lookup"><span data-stu-id="381aa-214">When NODE2 attempts to establish connectivity with NODE1, packets directed at NODE1 never leave NODE2 because it resolves NODE1’s IP address to itself.</span></span> <span data-ttu-id="381aa-215">Uzel2 nelze navázat připojení s UZEL1, pak dojde ke ztrátě kvora a ukončí clusteru.</span><span class="sxs-lookup"><span data-stu-id="381aa-215">NODE2 cannot establish connectivity with NODE1, then loses quorum and shuts down the cluster.</span></span>
6. <span data-ttu-id="381aa-216">Do té doby Uzel1 mohou odesílat pakety Uzel2, ale nemůže odpovědět, UZEL2.</span><span class="sxs-lookup"><span data-stu-id="381aa-216">In the meantime, NODE1 can send packets to NODE2, but NODE2 cannot reply.</span></span> <span data-ttu-id="381aa-217">Uzel1 dojde ke ztrátě kvora a cluster vypne.</span><span class="sxs-lookup"><span data-stu-id="381aa-217">NODE1 loses quorum and shuts down the cluster.</span></span>

<span data-ttu-id="381aa-218">Tento scénář se vyhnout přiřazením nepoužívané statickou IP adresu, jako je například místní IP adresa jako 169.254.1.1, název sítě s clustery, aby byla síťového názvu clusteru online.</span><span class="sxs-lookup"><span data-stu-id="381aa-218">This scenario can be avoided by assigning an unused static IP address, such as a link-local IP address like 169.254.1.1, to the cluster network name in order to bring the cluster network name online.</span></span> <span data-ttu-id="381aa-219">Pro zjednodušení tohoto procesu, najdete v části [Windows konfiguraci clusteru převzetí služeb při selhání v Azure pro skupiny dostupnosti](http://social.technet.microsoft.com/wiki/contents/articles/14776.configuring-windows-failover-cluster-in-windows-azure-for-alwayson-availability-groups.aspx).</span><span class="sxs-lookup"><span data-stu-id="381aa-219">To simplify this process, see [Configuring Windows failover cluster in Azure for availability groups](http://social.technet.microsoft.com/wiki/contents/articles/14776.configuring-windows-failover-cluster-in-windows-azure-for-alwayson-availability-groups.aspx).</span></span>

<span data-ttu-id="381aa-220">Další informace najdete v tématu [konfigurovat skupiny dostupnosti v Azure (GUI)](virtual-machines-windows-portal-sql-alwayson-availability-groups.md).</span><span class="sxs-lookup"><span data-stu-id="381aa-220">For more information, see [Configure availability groups in Azure (GUI)](virtual-machines-windows-portal-sql-alwayson-availability-groups.md).</span></span>

### <a name="availability-group-listener-support"></a><span data-ttu-id="381aa-221">Podpora naslouchací proces skupiny dostupnosti</span><span class="sxs-lookup"><span data-stu-id="381aa-221">Availability group listener support</span></span>
<span data-ttu-id="381aa-222">Naslouchací procesy skupiny dostupnosti jsou podporovány v Azure virtuální počítače se systémem Windows Server 2008 R2, Windows Server 2012, Windows Server 2012 R2 a Windows Server 2016.</span><span class="sxs-lookup"><span data-stu-id="381aa-222">Availability group listeners are supported on Azure VMs running Windows Server 2008 R2, Windows Server 2012, Windows Server 2012 R2, and Windows Server 2016.</span></span> <span data-ttu-id="381aa-223">Tato podpora je možné pomocí služby Vyrovnávání zatížení sítě koncových bodů povoleno na virtuálních počítačích Azure, které jsou uzly skupiny dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="381aa-223">This support is made possible by the use of load-balanced endpoints enabled on the Azure VMs that are availability group nodes.</span></span> <span data-ttu-id="381aa-224">Postupujte podle kroků speciální konfigurace pro naslouchací procesy pro oba klientských aplikací, které jsou spuštěné v Azure a také ty spuštěné místně.</span><span class="sxs-lookup"><span data-stu-id="381aa-224">You must follow special configuration steps for the listeners to work for both client applications that are running in Azure as well as those running on-premises.</span></span>

<span data-ttu-id="381aa-225">Existují dvě hlavní možnosti pro nastavení vaší naslouchací proces: externí (veřejných) nebo interní.</span><span class="sxs-lookup"><span data-stu-id="381aa-225">There are two main options for setting up your listener: external (public) or internal.</span></span> <span data-ttu-id="381aa-226">Externí naslouchací proces (veřejné) používá Internetovou nástroj pro vyrovnávání zatížení a související s veřejná virtuální IP (VIP), který je přístupný prostřednictvím Internetu.</span><span class="sxs-lookup"><span data-stu-id="381aa-226">The external (public) listener uses an internet facing load balancer and is associated with a public Virtual IP (VIP) that is accessible over the internet.</span></span> <span data-ttu-id="381aa-227">Naslouchací proces interní používá interní nástroj a podporuje pouze klienty ve stejné virtuální síti.</span><span class="sxs-lookup"><span data-stu-id="381aa-227">An internal listener uses an internal load balancer and only supports clients within the same Virtual Network.</span></span> <span data-ttu-id="381aa-228">Buď typ nástroje pro vyrovnávání zatížení, je nutné povolit přímé odpovědi ze serveru.</span><span class="sxs-lookup"><span data-stu-id="381aa-228">For either load balancer type, you must enable Direct Server Return.</span></span> 

<span data-ttu-id="381aa-229">Pokud skupina dostupnosti zahrnuje několik podsítí Azure (například nasazení, které protne oblastí Azure), musí zahrnovat klienta připojovací řetězec "**MultisubnetFailover = True**".</span><span class="sxs-lookup"><span data-stu-id="381aa-229">If the Availability Group spans multiple Azure subnets (such as a deployment that crosses Azure regions), the client connection string must include "**MultisubnetFailover=True**".</span></span> <span data-ttu-id="381aa-230">Výsledkem pokusy o připojení paralelní s replikami v různých podsítích.</span><span class="sxs-lookup"><span data-stu-id="381aa-230">This results in parallel connection attempts to the replicas in the different subnets.</span></span> <span data-ttu-id="381aa-231">Pokyny týkající se nastavení naslouchací proces najdete v tématu</span><span class="sxs-lookup"><span data-stu-id="381aa-231">For instructions on setting up a listener, see</span></span>

* <span data-ttu-id="381aa-232">[Konfigurace naslouchací proces ILB pro skupiny dostupnosti v Azure](virtual-machines-windows-portal-sql-ps-alwayson-int-listener.md).</span><span class="sxs-lookup"><span data-stu-id="381aa-232">[Configure an ILB listener for availability groups in Azure](virtual-machines-windows-portal-sql-ps-alwayson-int-listener.md).</span></span>
* <span data-ttu-id="381aa-233">[Konfigurace o externí naslouchací proces pro skupiny dostupnosti v Azure](../classic/ps-sql-ext-listener.md).</span><span class="sxs-lookup"><span data-stu-id="381aa-233">[Configure an external listener for availability groups in Azure](../classic/ps-sql-ext-listener.md).</span></span>

<span data-ttu-id="381aa-234">Stále připojením ke každé repliky dostupnosti samostatně přímým připojením k instanci služby.</span><span class="sxs-lookup"><span data-stu-id="381aa-234">You can still connect to each availability replica separately by connecting directly to the service instance.</span></span> <span data-ttu-id="381aa-235">Navíc vzhledem k tomu, že zpětně kompatibilní s klienty zrcadlení databáze skupiny dostupnosti se můžete připojit k replik dostupnosti jako databáze zrcadlení partnery repliky jsou nakonfigurovány podobná zrcadlení databáze:</span><span class="sxs-lookup"><span data-stu-id="381aa-235">Also, since availability groups are backward compatible with database mirroring clients, you can connect to the availability replicas like database mirroring partners as long as the replicas are configured similar to database mirroring:</span></span>

* <span data-ttu-id="381aa-236">Jedna primární replika a jedna sekundární replika</span><span class="sxs-lookup"><span data-stu-id="381aa-236">One primary replica and one secondary replica</span></span>
* <span data-ttu-id="381aa-237">Sekundární repliky nakonfigurován jako bez možnosti čtení (**čitelný sekundární** možnost nastavena na **ne**)</span><span class="sxs-lookup"><span data-stu-id="381aa-237">The secondary replica is configured as non-readable (**Readable Secondary** option set to **No**)</span></span>

<span data-ttu-id="381aa-238">Zde je příklad klienta připojovací řetězec, který odpovídá této konfigurace zrcadlení jako databáze pomocí ADO.NET nebo SQL Server Native Client:</span><span class="sxs-lookup"><span data-stu-id="381aa-238">An example client connection string that corresponds to this database mirroring-like configuration using ADO.NET or SQL Server Native Client is below:</span></span>

    Data Source=ReplicaServer1;Failover Partner=ReplicaServer2;Initial Catalog=AvailabilityDatabase;

<span data-ttu-id="381aa-239">Další informace o připojení klientů najdete v tématu:</span><span class="sxs-lookup"><span data-stu-id="381aa-239">For more information on client connectivity, see:</span></span>

* [<span data-ttu-id="381aa-240">Klíčová slova připojovací řetězec pomocí SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="381aa-240">Using Connection String Keywords with SQL Server Native Client</span></span>](https://msdn.microsoft.com/library/ms130822.aspx)
* [<span data-ttu-id="381aa-241">Připojení klientů k databázi zrcadlení relace (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="381aa-241">Connect Clients to a Database Mirroring Session (SQL Server)</span></span>](https://technet.microsoft.com/library/ms175484.aspx)
* [<span data-ttu-id="381aa-242">Připojování k naslouchací proces skupiny dostupnosti v hybridní IT</span><span class="sxs-lookup"><span data-stu-id="381aa-242">Connecting to Availability Group Listener in Hybrid IT</span></span>](http://blogs.msdn.com/b/sqlalwayson/archive/2013/02/14/connecting-to-availability-group-listener-in-hybrid-it.aspx)
* [<span data-ttu-id="381aa-243">Naslouchací procesy skupiny dostupnosti, připojení klientů a převzetí služeb při selhání aplikace (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="381aa-243">Availability Group Listeners, Client Connectivity, and Application Failover (SQL Server)</span></span>](https://technet.microsoft.com/library/hh213417.aspx)
* [<span data-ttu-id="381aa-244">Použití řetězců připojení zrcadlení databáze se skupinami dostupnosti</span><span class="sxs-lookup"><span data-stu-id="381aa-244">Using Database-Mirroring Connection Strings with Availability Groups</span></span>](https://technet.microsoft.com/library/hh213417.aspx)

### <a name="network-latency-in-hybrid-it"></a><span data-ttu-id="381aa-245">Latence sítě v hybridní IT</span><span class="sxs-lookup"><span data-stu-id="381aa-245">Network latency in hybrid IT</span></span>
<span data-ttu-id="381aa-246">Měli byste nasadit řešení HADR za předpokladu, že může být období s vysoké latenci mezi místní sítí a Azure.</span><span class="sxs-lookup"><span data-stu-id="381aa-246">You should deploy your HADR solution with the assumption that there may be periods of time with high network latency between your on-premises network and Azure.</span></span> <span data-ttu-id="381aa-247">Pokud nasazujete repliky do Azure, měli byste použít asynchronního potvrzování místo synchronním potvrzováním pro režim synchronizace.</span><span class="sxs-lookup"><span data-stu-id="381aa-247">When deploying replicas to Azure, you should use asynchronous commit instead of synchronous commit for the synchronization mode.</span></span> <span data-ttu-id="381aa-248">Při nasazování serverů zrcadlení databáze místní i v Azure, použijte režim vysoce výkonné místo režimu vysokou bezpečnost.</span><span class="sxs-lookup"><span data-stu-id="381aa-248">When deploying database mirroring servers both on-premises and in Azure, use the high-performance mode instead of the high-safety mode.</span></span>

### <a name="geo-replication-support"></a><span data-ttu-id="381aa-249">Geografická replikace podpory</span><span class="sxs-lookup"><span data-stu-id="381aa-249">Geo-replication support</span></span>
<span data-ttu-id="381aa-250">Geografická replikace v disky Azure nepodporuje datový soubor a soubor protokolu stejné databáze ukládaly na různých discích.</span><span class="sxs-lookup"><span data-stu-id="381aa-250">Geo-replication in Azure disks does not support the data file and log file of the same database to be stored on separate disks.</span></span> <span data-ttu-id="381aa-251">GRS replikovat změny na každém disku nezávisle a asynchronně.</span><span class="sxs-lookup"><span data-stu-id="381aa-251">GRS replicates changes on each disk independently and asynchronously.</span></span> <span data-ttu-id="381aa-252">Tento mechanismus zaručuje zápisu pořadí v rámci jednoho disku do geograficky replikované kopírovat, ale ne geograficky replikované kopie více disků.</span><span class="sxs-lookup"><span data-stu-id="381aa-252">This mechanism guarantees the write order within a single disk on the geo-replicated copy, but not across geo-replicated copies of multiple disks.</span></span> <span data-ttu-id="381aa-253">Pokud nakonfigurujete databázi k ukládání jeho datového souboru a jeho soubor protokolu na různých discích, obnovené disky po havárii může obsahovat více aktuální kopii datového souboru než soubor protokolu, která dělí předběžné protokolování v systému SQL Server a ACID vlastností transakce.</span><span class="sxs-lookup"><span data-stu-id="381aa-253">If you configure a database to store its data file and its log file on separate disks, the recovered disks after a disaster may contain a more up-to-date copy of the data file than the log file, which breaks the write-ahead log in SQL Server and the ACID properties of transactions.</span></span> <span data-ttu-id="381aa-254">Pokud nemáte možnost zakázat geografická replikace na účtu úložiště, byste měli mít všechna data a soubory protokolu pro danou databázi na stejném disku.</span><span class="sxs-lookup"><span data-stu-id="381aa-254">If you do not have the option to disable geo-replication on the storage account, you should keep all data and log files for a given database on the same disk.</span></span> <span data-ttu-id="381aa-255">Pokud je nutné použít více než jeden disk kvůli překročení velikosti databáze, budete muset nasaďte jednu z výše uvedených zajistit redundanci dat řešení obnovení po havárii.</span><span class="sxs-lookup"><span data-stu-id="381aa-255">If you must use more than one disk due to the size of the database, you need to deploy one of the disaster recovery solutions listed above to ensure data redundancy.</span></span>

## <a name="next-steps"></a><span data-ttu-id="381aa-256">Další kroky</span><span class="sxs-lookup"><span data-stu-id="381aa-256">Next steps</span></span>
<span data-ttu-id="381aa-257">Pokud potřebujete vytvořit virtuální počítač Azure se systémem SQL Server, přečtěte si téma [zřizování virtuálního počítače systému SQL Server na platformě Azure](virtual-machines-windows-portal-sql-server-provision.md).</span><span class="sxs-lookup"><span data-stu-id="381aa-257">If you need to create an Azure virtual machine with SQL Server, see [Provisioning a SQL Server Virtual Machine on Azure](virtual-machines-windows-portal-sql-server-provision.md).</span></span>

<span data-ttu-id="381aa-258">Nejlepšího výkonu dosáhnete z SQL Server běžící na virtuálním počítači Azure najdete pokyny v [osvědčené postupy z hlediska výkonu pro SQL Server v Azure Virtual Machines](virtual-machines-windows-sql-performance.md).</span><span class="sxs-lookup"><span data-stu-id="381aa-258">To get the best performance from SQL Server running on an Azure VM, see the guidance in [Performance Best Practices for SQL Server in Azure Virtual Machines](virtual-machines-windows-sql-performance.md).</span></span>

<span data-ttu-id="381aa-259">Další témata související se systémem SQL Server ve virtuálních počítačích Azure, najdete v části [systému SQL Server na virtuálních počítačích Azure](virtual-machines-windows-sql-server-iaas-overview.md).</span><span class="sxs-lookup"><span data-stu-id="381aa-259">For other topics related to running SQL Server in Azure VMs, see [SQL Server on Azure Virtual Machines](virtual-machines-windows-sql-server-iaas-overview.md).</span></span>

### <a name="other-resources"></a><span data-ttu-id="381aa-260">Další prostředky</span><span class="sxs-lookup"><span data-stu-id="381aa-260">Other resources</span></span>
* [<span data-ttu-id="381aa-261">Instalace nové doménové struktury služby Active Directory v Azure</span><span class="sxs-lookup"><span data-stu-id="381aa-261">Install a new Active Directory forest in Azure</span></span>](../../../active-directory/active-directory-new-forest-virtual-machine.md)
* [<span data-ttu-id="381aa-262">Vytvoření clusteru převzetí služeb při selhání pro skupiny dostupnosti ve virtuálním počítači Azure</span><span class="sxs-lookup"><span data-stu-id="381aa-262">Create Failover Cluster for availability groups in Azure VM</span></span>](http://gallery.technet.microsoft.com/scriptcenter/Create-WSFC-Cluster-for-7c207d3a)

