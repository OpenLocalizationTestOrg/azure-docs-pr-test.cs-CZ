---
title: "aaaCreate SQL Server naslouchací proces skupiny dostupnosti ve virtuálních počítačích Azure | Microsoft Docs"
description: "Podrobné pokyny pro vytvoření naslouchacího procesu pro skupiny dostupnosti Always On pro SQL Server na virtuálních počítačích Azure"
services: virtual-machines
documentationcenter: na
author: MikeRayMSFT
manager: jhubbard
editor: monicar
ms.assetid: d1f291e9-9af2-41ba-9d29-9541e3adcfcf
ms.service: virtual-machines-sql
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 05/01/2017
ms.author: mikeray
ms.openlocfilehash: c6a44dc5c7c18b572c2bf5772b4651b7210aacbd
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="configure-a-load-balancer-for-an-always-on-availability-group-in-azure"></a><span data-ttu-id="a9cb3-103">Konfigurace vyrovnávání zatížení pro skupiny dostupnosti Always On v Azure</span><span class="sxs-lookup"><span data-stu-id="a9cb3-103">Configure a load balancer for an Always On availability group in Azure</span></span>
<span data-ttu-id="a9cb3-104">Tento článek vysvětluje, jak toocreate Vyrovnávání zatížení pro skupinu dostupnosti SQL serveru Always On v Azure virtuální počítače, které běží s Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-104">This article explains how toocreate a load balancer for a SQL Server Always On availability group in Azure virtual machines that are running with Azure Resource Manager.</span></span> <span data-ttu-id="a9cb3-105">Skupiny dostupnosti vyžaduje nástroj pro vyrovnávání zatížení, pokud jsou hello instance systému SQL Server na virtuálních počítačích Azure.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-105">An availability group requires a load balancer when hello SQL Server instances are on Azure virtual machines.</span></span> <span data-ttu-id="a9cb3-106">Nástroj pro vyrovnávání zatížení Hello ukládá hello IP adresu pro naslouchací proces skupiny dostupnosti hello.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-106">hello load balancer stores hello IP address for hello availability group listener.</span></span> <span data-ttu-id="a9cb3-107">Pokud skupinu dostupnosti zahrnuje několik oblastí, musí každá oblast Vyrovnávání zatížení.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-107">If an availability group spans multiple regions, each region needs a load balancer.</span></span>

<span data-ttu-id="a9cb3-108">toocomplete tuto úlohu je nutné toohave skupinu dostupnosti systému SQL Server nasazený na Azure virtuální počítače, které běží s Resource Managerem.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-108">toocomplete this task, you need toohave a SQL Server availability group deployed on Azure virtual machines that are running with Resource Manager.</span></span> <span data-ttu-id="a9cb3-109">Virtuální počítače systému SQL Server musí patřit toohello stejné skupině dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-109">Both SQL Server virtual machines must belong toohello same availability set.</span></span> <span data-ttu-id="a9cb3-110">Můžete použít hello [šablony aplikace Microsoft](virtual-machines-windows-portal-sql-alwayson-availability-groups.md) tooautomatically vytvoření skupiny dostupnosti hello ve službě Správce prostředků.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-110">You can use hello [Microsoft template](virtual-machines-windows-portal-sql-alwayson-availability-groups.md) tooautomatically create hello availability group in Resource Manager.</span></span> <span data-ttu-id="a9cb3-111">Tato šablona interní nástroj pro vás automaticky vytvoří.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-111">This template automatically creates an internal load balancer for you.</span></span> 

<span data-ttu-id="a9cb3-112">Pokud dáváte přednost, můžete [ručně nakonfigurovat skupinu dostupnosti](virtual-machines-windows-portal-sql-alwayson-availability-groups-manual.md).</span><span class="sxs-lookup"><span data-stu-id="a9cb3-112">If you prefer, you can [manually configure an availability group](virtual-machines-windows-portal-sql-alwayson-availability-groups-manual.md).</span></span>

<span data-ttu-id="a9cb3-113">Tento článek vyžaduje vaše skupiny dostupnosti jsou již nakonfigurována.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-113">This article requires that your availability groups are already configured.</span></span>  

<span data-ttu-id="a9cb3-114">Související témata:</span><span class="sxs-lookup"><span data-stu-id="a9cb3-114">Related topics include:</span></span>

* [<span data-ttu-id="a9cb3-115">Konfigurace skupin dostupnosti Always On virtuální počítač Azure (GUI)</span><span class="sxs-lookup"><span data-stu-id="a9cb3-115">Configure Always On availability groups in Azure VM (GUI)</span></span>](virtual-machines-windows-portal-sql-alwayson-availability-groups-manual.md)   
* [<span data-ttu-id="a9cb3-116">Nakonfigurujte připojení VNet-to-VNet s použitím Azure Resource Manageru a prostředí PowerShell</span><span class="sxs-lookup"><span data-stu-id="a9cb3-116">Configure a VNet-to-VNet connection by using Azure Resource Manager and PowerShell</span></span>](../../../vpn-gateway/vpn-gateway-vnet-vnet-rm-ps.md)

<span data-ttu-id="a9cb3-117">Podle s návodem v tomto článku, vytvořit a nakonfigurovat Vyrovnávání zatížení v hello portálu Azure.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-117">By walking through this article, you create and configure a load balancer in hello Azure portal.</span></span> <span data-ttu-id="a9cb3-118">Po dokončení procesu hello nakonfigurujete hello clusteru toouse hello IP adresu z hello Vyrovnávání zatížení pro naslouchací proces skupiny dostupnosti hello.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-118">After hello process is complete, you configure hello cluster toouse hello IP address from hello load balancer for hello availability group listener.</span></span>

## <a name="create-and-configure-hello-load-balancer-in-hello-azure-portal"></a><span data-ttu-id="a9cb3-119">Vytvoření a konfigurace pro vyrovnávání zatížení hello v hello portálu Azure</span><span class="sxs-lookup"><span data-stu-id="a9cb3-119">Create and configure hello load balancer in hello Azure portal</span></span>
<span data-ttu-id="a9cb3-120">V této části hello úkolu hello následující:</span><span class="sxs-lookup"><span data-stu-id="a9cb3-120">In this portion of hello task, do hello following:</span></span>

1. <span data-ttu-id="a9cb3-121">V hello portálu Azure vytvořit nástroj pro vyrovnávání zatížení hello a nakonfigurovat hello IP adresy.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-121">In hello Azure portal, create hello load balancer and configure hello IP address.</span></span>
2. <span data-ttu-id="a9cb3-122">Nakonfigurujte fond back-end hello.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-122">Configure hello back-end pool.</span></span>
3. <span data-ttu-id="a9cb3-123">Vytvořte test paměti hello.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-123">Create hello probe.</span></span> 
4. <span data-ttu-id="a9cb3-124">Nastavit pravidla Vyrovnávání zatížení hello.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-124">Set hello load balancing rules.</span></span>

> [!NOTE]
> <span data-ttu-id="a9cb3-125">Pokud instance systému SQL Server hello v více skupin prostředků a oblastí, provedení každého kroku dvakrát, jednou v každé skupině prostředků.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-125">If hello SQL Server instances are in multiple resource groups and regions, perform each step twice, once in each resource group.</span></span>
> 
> 

### <a name="step-1-create-hello-load-balancer-and-configure-hello-ip-address"></a><span data-ttu-id="a9cb3-126">Krok 1: Vytvoření hello nástroj pro vyrovnávání zatížení a nakonfigurovat hello IP adresy</span><span class="sxs-lookup"><span data-stu-id="a9cb3-126">Step 1: Create hello load balancer and configure hello IP address</span></span>
<span data-ttu-id="a9cb3-127">Nejprve vytvořte hello nástroj pro vyrovnávání zatížení.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-127">First, create hello load balancer.</span></span> 

1. <span data-ttu-id="a9cb3-128">V hello portálu Azure otevřete hello skupinu prostředků, která obsahuje virtuální počítače, hello systému SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-128">In hello Azure portal, open hello resource group that contains hello SQL Server virtual machines.</span></span> 

2. <span data-ttu-id="a9cb3-129">Ve skupině prostředků hello, klikněte na tlačítko **přidat**.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-129">In hello resource group, click **Add**.</span></span>

3. <span data-ttu-id="a9cb3-130">Vyhledejte **nástroj pro vyrovnávání zatížení** a potom ve výsledcích hledání hello, vyberte **Vyrovnávání zatížení**, která je publikována serverem **Microsoft**.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-130">Search for **load balancer** and then, in hello search results, select **Load Balancer**, which is published by **Microsoft**.</span></span>

4. <span data-ttu-id="a9cb3-131">Na hello **nástroj pro vyrovnávání zatížení** okně klikněte na tlačítko **vytvořit**.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-131">On hello **Load Balancer** blade, click **Create**.</span></span>

5. <span data-ttu-id="a9cb3-132">V hello **vytvořit nástroj pro vyrovnávání zatížení** dialogové okno pole, nástroj pro vyrovnávání zatížení hello nakonfigurovat následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="a9cb3-132">In hello **Create load balancer** dialog box, configure hello load balancer as follows:</span></span>

   | <span data-ttu-id="a9cb3-133">Nastavení</span><span class="sxs-lookup"><span data-stu-id="a9cb3-133">Setting</span></span> | <span data-ttu-id="a9cb3-134">Hodnota</span><span class="sxs-lookup"><span data-stu-id="a9cb3-134">Value</span></span> |
   | --- | --- |
   | <span data-ttu-id="a9cb3-135">**Název**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-135">**Name**</span></span> |<span data-ttu-id="a9cb3-136">Název text představující hello nástroj pro vyrovnávání zatížení.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-136">A text name representing hello load balancer.</span></span> <span data-ttu-id="a9cb3-137">Například **sqlLB**.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-137">For example, **sqlLB**.</span></span> |
   | <span data-ttu-id="a9cb3-138">**Typ**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-138">**Type**</span></span> |<span data-ttu-id="a9cb3-139">**Interní**: většinu implementací použijte Vyrovnávání zatížení interní, která umožňuje aplikacím v rámci hello stejné skupiny dostupnosti toohello tooconnect virtuální sítě.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-139">**Internal**: Most implementations use an internal load balancer, which allows applications within hello same virtual network tooconnect toohello availability group.</span></span>  </br> <span data-ttu-id="a9cb3-140">**Externí**: umožňuje aplikacím tooconnect toohello skupiny dostupnosti prostřednictvím veřejného Internetu připojení.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-140">**External**: Allows applications tooconnect toohello availability group through a public Internet connection.</span></span> |
   | <span data-ttu-id="a9cb3-141">**Virtuální síť**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-141">**Virtual network**</span></span> |<span data-ttu-id="a9cb3-142">Vyberte hello virtuální síť, která jsou intances hello systému SQL Server v.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-142">Select hello virtual network that hello SQL Server intances are in.</span></span> |
   | <span data-ttu-id="a9cb3-143">**Podsíť**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-143">**Subnet**</span></span> |<span data-ttu-id="a9cb3-144">Vyberte hello podsítě, která jsou instance systému SQL Server hello v.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-144">Select hello subnet that hello SQL Server instances are in.</span></span> |
   | <span data-ttu-id="a9cb3-145">**Přiřazení IP adresy**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-145">**IP address assignment**</span></span> |<span data-ttu-id="a9cb3-146">**Statické**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-146">**Static**</span></span> |
   | <span data-ttu-id="a9cb3-147">**Privátní IP adresa**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-147">**Private IP address**</span></span> |<span data-ttu-id="a9cb3-148">Zadejte dostupnou IP adresu z podsítě hello.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-148">Specify an available IP address from hello subnet.</span></span> <span data-ttu-id="a9cb3-149">Při vytváření naslouchací proces na hello clusteru, použijte tuto adresu IP.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-149">Use this IP address when you create a listener on hello cluster.</span></span> <span data-ttu-id="a9cb3-150">Ve skriptu prostředí PowerShell, dále v tomto článku, použijte tuto adresu pro hello `$ILBIP` proměnné.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-150">In a PowerShell script, later in this article, use this address for hello `$ILBIP` variable.</span></span> |
   | <span data-ttu-id="a9cb3-151">**Předplatné**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-151">**Subscription**</span></span> |<span data-ttu-id="a9cb3-152">Pokud máte více předplatných, může se objevit v tomto poli.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-152">If you have multiple subscriptions, this field might appear.</span></span> <span data-ttu-id="a9cb3-153">Vyberte hello předplatné, které chcete tooassociate se tento prostředek.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-153">Select hello subscription that you want tooassociate with this resource.</span></span> <span data-ttu-id="a9cb3-154">Ho je obvykle hello stejného předplatného jako všechny hello prostředky pro skupinu dostupnosti hello.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-154">It is normally hello same subscription as all hello resources for hello availability group.</span></span> |
   | <span data-ttu-id="a9cb3-155">**Skupina prostředků**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-155">**Resource group**</span></span> |<span data-ttu-id="a9cb3-156">Vyberte skupinu prostředků hello, jestli jsou instance systému SQL Server hello v.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-156">Select hello resource group that hello SQL Server instances are in.</span></span> |
   | <span data-ttu-id="a9cb3-157">**Umístění**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-157">**Location**</span></span> |<span data-ttu-id="a9cb3-158">Vyberte umístění Azure, které jsou instance systému SQL Server hello v hello.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-158">Select hello Azure location that hello SQL Server instances are in.</span></span> |

6. <span data-ttu-id="a9cb3-159">Klikněte na možnost **Vytvořit**.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-159">Click **Create**.</span></span> 

<span data-ttu-id="a9cb3-160">Azure vytvoří nástroj pro vyrovnávání zatížení hello.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-160">Azure creates hello load balancer.</span></span> <span data-ttu-id="a9cb3-161">Nástroj pro vyrovnávání zatížení Hello patří tooa konkrétní sítě, podsítě, skupinu prostředků a umístění.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-161">hello load balancer belongs tooa specific network, subnet, resource group, and location.</span></span> <span data-ttu-id="a9cb3-162">Jakmile Azure dokončí úlohu hello, ověřte nastavení nástroje pro vyrovnávání zatížení hello v Azure.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-162">After Azure completes hello task, verify hello load balancer settings in Azure.</span></span> 

### <a name="step-2-configure-hello-back-end-pool"></a><span data-ttu-id="a9cb3-163">Krok 2: Konfigurace fondu back-end hello</span><span class="sxs-lookup"><span data-stu-id="a9cb3-163">Step 2: Configure hello back-end pool</span></span>
<span data-ttu-id="a9cb3-164">Azure volání hello fond adres back-end *fond back-end*.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-164">Azure calls hello back-end address pool *backend pool*.</span></span> <span data-ttu-id="a9cb3-165">V takovém případě fond back-end hello je hello adresy hello dvě instance systému SQL Server ve skupině dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-165">In this case, hello back-end pool is hello addresses of hello two SQL Server instances in your availability group.</span></span> 

1. <span data-ttu-id="a9cb3-166">Ve skupině prostředků klikněte na tlačítko hello Vyrovnávání zatížení, který jste vytvořili.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-166">In your resource group, click hello load balancer that you created.</span></span> 

2. <span data-ttu-id="a9cb3-167">Na **nastavení**, klikněte na tlačítko **back-endové fondy**.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-167">On **Settings**, click **Backend pools**.</span></span>

3. <span data-ttu-id="a9cb3-168">Na **back-endové fondy**, klikněte na tlačítko **přidat** toocreate fond back-end adresy.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-168">On **Backend pools**, click **Add** toocreate a back-end address pool.</span></span> 

4. <span data-ttu-id="a9cb3-169">Na **přidejte fond back-end**v části **název**, zadejte název pro fond back-end hello.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-169">On **Add backend pool**, under **Name**, type a name for hello back-end pool.</span></span>

5. <span data-ttu-id="a9cb3-170">V části **virtuální počítače**, klikněte na tlačítko **přidat virtuální počítač**.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-170">Under **Virtual machines**, click **Add a virtual machine**.</span></span> 

6. <span data-ttu-id="a9cb3-171">V části **vyberte virtuální počítače**, klikněte na tlačítko **zvolit skupinu dostupnosti**a pak zadejte hello dostupnosti nastavit, že virtuální počítače systému SQL Server hello patří do.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-171">Under **Choose virtual machines**, click **Choose an availability set**, and then specify hello availability set that hello SQL Server virtual machines belong to.</span></span>

7. <span data-ttu-id="a9cb3-172">Po zvolení hello skupinu dostupnosti, klikněte na tlačítko **zvolte hello virtuální počítače**, vyberte hello dva virtuální počítače, které hostit hello instance systému SQL Server ve skupině dostupnosti hello a pak klikněte na tlačítko **vyberte**.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-172">After you have chosen hello availability set, click **Choose hello virtual machines**, select hello two virtual machines that host hello SQL Server instances in hello availability group, and then click **Select**.</span></span> 

8. <span data-ttu-id="a9cb3-173">Klikněte na tlačítko **OK** tooclose hello okna pro **vyberte virtuální počítače**, a **přidejte fond back-end**.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-173">Click **OK** tooclose hello blades for **Choose virtual machines**, and **Add backend pool**.</span></span> 

<span data-ttu-id="a9cb3-174">Azure aktualizuje hello nastavení fondu back-end adres hello.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-174">Azure updates hello settings for hello back-end address pool.</span></span> <span data-ttu-id="a9cb3-175">Vaše skupina dostupnosti má nyní fond dvě instance systému SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-175">Now your availability set has a pool of two SQL Server instances.</span></span>

### <a name="step-3-create-a-probe"></a><span data-ttu-id="a9cb3-176">Krok 3: Vytvoření sondu</span><span class="sxs-lookup"><span data-stu-id="a9cb3-176">Step 3: Create a probe</span></span>
<span data-ttu-id="a9cb3-177">Test Hello definuje, jak Azure ověřuje, která z instance systému SQL Server hello aktuálně vlastníkem hello naslouchací proces skupiny dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-177">hello probe defines how Azure verifies which of hello SQL Server instances currently owns hello availability group listener.</span></span> <span data-ttu-id="a9cb3-178">Azure sondy hello služby na základě IP adresy hello portu, které definujete při vytváření hello testu.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-178">Azure probes hello service based on hello IP address on a port that you define when you create hello probe.</span></span>

1. <span data-ttu-id="a9cb3-179">Nástroj pro vyrovnávání zatížení na hello **nastavení** okně klikněte na tlačítko **testy stavu**.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-179">On hello load balancer **Settings** blade, click **Health probes**.</span></span> 

2. <span data-ttu-id="a9cb3-180">Na hello **testy stavu** okně klikněte na tlačítko **přidat**.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-180">On hello **Health probes** blade, click **Add**.</span></span>

3. <span data-ttu-id="a9cb3-181">Konfigurace testu hello na hello **přidat test** okno.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-181">Configure hello probe on hello **Add probe** blade.</span></span> <span data-ttu-id="a9cb3-182">Hello použijte následující hodnoty tooconfigure hello testu:</span><span class="sxs-lookup"><span data-stu-id="a9cb3-182">Use hello following values tooconfigure hello probe:</span></span>

   | <span data-ttu-id="a9cb3-183">Nastavení</span><span class="sxs-lookup"><span data-stu-id="a9cb3-183">Setting</span></span> | <span data-ttu-id="a9cb3-184">Hodnota</span><span class="sxs-lookup"><span data-stu-id="a9cb3-184">Value</span></span> |
   | --- | --- |
   | <span data-ttu-id="a9cb3-185">**Název**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-185">**Name**</span></span> |<span data-ttu-id="a9cb3-186">Název text představující hello testu.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-186">A text name representing hello probe.</span></span> <span data-ttu-id="a9cb3-187">Například **SQLAlwaysOnEndPointProbe**.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-187">For example, **SQLAlwaysOnEndPointProbe**.</span></span> |
   | <span data-ttu-id="a9cb3-188">**Protokol**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-188">**Protocol**</span></span> |<span data-ttu-id="a9cb3-189">**TCP**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-189">**TCP**</span></span> |
   | <span data-ttu-id="a9cb3-190">**Port**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-190">**Port**</span></span> |<span data-ttu-id="a9cb3-191">Můžete použít jakýkoli dostupný port.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-191">You can use any available port.</span></span> <span data-ttu-id="a9cb3-192">Například *59999*.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-192">For example, *59999*.</span></span> |
   | <span data-ttu-id="a9cb3-193">**Interval**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-193">**Interval**</span></span> |<span data-ttu-id="a9cb3-194">*5*</span><span class="sxs-lookup"><span data-stu-id="a9cb3-194">*5*</span></span> |
   | <span data-ttu-id="a9cb3-195">**Prahová hodnota špatného stavu**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-195">**Unhealthy threshold**</span></span> |<span data-ttu-id="a9cb3-196">*2*</span><span class="sxs-lookup"><span data-stu-id="a9cb3-196">*2*</span></span> |

4.  <span data-ttu-id="a9cb3-197">Klikněte na **OK**.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-197">Click **OK**.</span></span> 

> [!NOTE]
> <span data-ttu-id="a9cb3-198">Ujistěte se, že je otevřen v bráně firewall hello obou instancí systému SQL Server hello port, který zadáte.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-198">Make sure that hello port you specify is open on hello firewall of both SQL Server instances.</span></span> <span data-ttu-id="a9cb3-199">Obě instance vyžadují příchozí pravidlo hello port TCP, který používáte.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-199">Both instances require an inbound rule for hello TCP port that you use.</span></span> <span data-ttu-id="a9cb3-200">Další informace najdete v tématu [přidat nebo upravit pravidlo brány Firewall](http://technet.microsoft.com/library/cc753558.aspx).</span><span class="sxs-lookup"><span data-stu-id="a9cb3-200">For more information, see [Add or Edit Firewall Rule](http://technet.microsoft.com/library/cc753558.aspx).</span></span> 
> 
> 

<span data-ttu-id="a9cb3-201">Azure vytvoří hello kontrolu a používá je tootest, kterou instanci systému SQL Server má hello naslouchací proces skupiny dostupnosti hello.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-201">Azure creates hello probe and then uses it tootest which SQL Server instance has hello listener for hello availability group.</span></span>

### <a name="step-4-set-hello-load-balancing-rules"></a><span data-ttu-id="a9cb3-202">Krok 4: Nastavení pravidla Vyrovnávání zatížení hello</span><span class="sxs-lookup"><span data-stu-id="a9cb3-202">Step 4: Set hello load balancing rules</span></span>
<span data-ttu-id="a9cb3-203">pravidla Vyrovnávání zatížení Hello nakonfigurujte, jak nástroj pro vyrovnávání zatížení hello směruje provoz instance systému SQL Server toohello.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-203">hello load balancing rules configure how hello load balancer routes traffic toohello SQL Server instances.</span></span> <span data-ttu-id="a9cb3-204">Pro tuto službu Vyrovnávání zatížení můžete povolit přímá odpověď ze serveru, protože pouze jedna ze dvou instancí systému SQL Server hello vlastní prostředek naslouchací proces skupiny dostupnosti hello najednou.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-204">For this load balancer, you enable direct server return because only one of hello two SQL Server instances owns hello availability group listener resource at a time.</span></span>

1. <span data-ttu-id="a9cb3-205">Nástroj pro vyrovnávání zatížení na hello **nastavení** okně klikněte na tlačítko **pravidla Vyrovnávání zatížení**.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-205">On hello load balancer **Settings** blade, click **Load balancing rules**.</span></span> 

2. <span data-ttu-id="a9cb3-206">Na hello **pravidla Vyrovnávání zatížení** okně klikněte na tlačítko **přidat**.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-206">On hello **Load balancing rules** blade, click **Add**.</span></span>

3. <span data-ttu-id="a9cb3-207">Na hello **pravidla Vyrovnávání zatížení přidat** okně nakonfigurovat pravidlo Vyrovnávání zatížení hello.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-207">On hello **Add load balancing rules** blade, configure hello load balancing rule.</span></span> <span data-ttu-id="a9cb3-208">Použijte hello následující nastavení:</span><span class="sxs-lookup"><span data-stu-id="a9cb3-208">Use hello following settings:</span></span> 

   | <span data-ttu-id="a9cb3-209">Nastavení</span><span class="sxs-lookup"><span data-stu-id="a9cb3-209">Setting</span></span> | <span data-ttu-id="a9cb3-210">Hodnota</span><span class="sxs-lookup"><span data-stu-id="a9cb3-210">Value</span></span> |
   | --- | --- |
   | <span data-ttu-id="a9cb3-211">**Název**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-211">**Name**</span></span> |<span data-ttu-id="a9cb3-212">Název text představující hello pravidla Vyrovnávání zatížení.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-212">A text name representing hello load balancing rules.</span></span> <span data-ttu-id="a9cb3-213">Například **SQLAlwaysOnEndPointListener**.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-213">For example, **SQLAlwaysOnEndPointListener**.</span></span> |
   | <span data-ttu-id="a9cb3-214">**Protokol**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-214">**Protocol**</span></span> |<span data-ttu-id="a9cb3-215">**TCP**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-215">**TCP**</span></span> |
   | <span data-ttu-id="a9cb3-216">**Port**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-216">**Port**</span></span> |<span data-ttu-id="a9cb3-217">*1433*</span><span class="sxs-lookup"><span data-stu-id="a9cb3-217">*1433*</span></span> |
   | <span data-ttu-id="a9cb3-218">**Back-endový Port**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-218">**Backend Port**</span></span> |<span data-ttu-id="a9cb3-219">*1433*. Tato hodnota se ignoruje, protože toto pravidlo používá **plovoucí IP adresa (přímá odpověď ze serveru)**.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-219">*1433*. This value is ignored because this rule uses **Floating IP (direct server return)**.</span></span> |
   | <span data-ttu-id="a9cb3-220">**Test**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-220">**Probe**</span></span> |<span data-ttu-id="a9cb3-221">Použijte název hello hello kontroly, kterou jste vytvořili pro tuto službu Vyrovnávání zatížení.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-221">Use hello name of hello probe that you created for this load balancer.</span></span> |
   | <span data-ttu-id="a9cb3-222">**Trvalost relace**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-222">**Session persistence**</span></span> |<span data-ttu-id="a9cb3-223">**None**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-223">**None**</span></span> |
   | <span data-ttu-id="a9cb3-224">**Časový limit nečinnosti (minuty)**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-224">**Idle timeout (minutes)**</span></span> |<span data-ttu-id="a9cb3-225">*4*</span><span class="sxs-lookup"><span data-stu-id="a9cb3-225">*4*</span></span> |
   | <span data-ttu-id="a9cb3-226">**Plovoucí IP adresa (přímá odpověď ze serveru)**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-226">**Floating IP (direct server return)**</span></span> |<span data-ttu-id="a9cb3-227">**Povoleno**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-227">**Enabled**</span></span> |

   > [!NOTE]
   > <span data-ttu-id="a9cb3-228">Máte tooscroll dolů hello okno tooview všechna nastavení hello.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-228">You might have tooscroll down hello blade tooview all hello settings.</span></span>
   > 

4. <span data-ttu-id="a9cb3-229">Klikněte na **OK**.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-229">Click **OK**.</span></span> 
5. <span data-ttu-id="a9cb3-230">Azure nakonfiguruje hello pravidlo Vyrovnávání zatížení.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-230">Azure configures hello load balancing rule.</span></span> <span data-ttu-id="a9cb3-231">Nástroj pro vyrovnávání zatížení hello je teď nakonfigurované tooroute instance systému SQL Server toohello v provozu, který je hostitelem hello naslouchací proces skupiny dostupnosti hello.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-231">Now hello load balancer is configured tooroute traffic toohello SQL Server instance that hosts hello listener for hello availability group.</span></span> 

<span data-ttu-id="a9cb3-232">V tomto okamžiku má skupina prostředků hello Vyrovnávání zatížení, která se připojuje tooboth počítače systému SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-232">At this point, hello resource group has a load balancer that connects tooboth SQL Server machines.</span></span> <span data-ttu-id="a9cb3-233">Nástroj pro vyrovnávání zatížení Hello také obsahuje IP adresu pro hello SQL serveru Always On naslouchací proces skupiny dostupnosti, aby mohl počítač buď odpovídat toorequests pro skupiny dostupnosti hello.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-233">hello load balancer also contains an IP address for hello SQL Server Always On availability group listener, so that either machine can respond toorequests for hello availability groups.</span></span>

> [!NOTE]
> <span data-ttu-id="a9cb3-234">Pokud vaše instance systému SQL Server ve dvou oblastech, opakujte kroky hello v hello jiné oblasti.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-234">If your SQL Server instances are in two separate regions, repeat hello steps in hello other region.</span></span> <span data-ttu-id="a9cb3-235">Každou oblast, vyžaduje nástroj pro vyrovnávání zatížení.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-235">Each region requires a load balancer.</span></span> 
> 
> 

## <a name="configure-hello-cluster-toouse-hello-load-balancer-ip-address"></a><span data-ttu-id="a9cb3-236">Konfigurace toouse clusteru hello, hello adresy IP nástroje pro vyrovnávání zatížení</span><span class="sxs-lookup"><span data-stu-id="a9cb3-236">Configure hello cluster toouse hello load balancer IP address</span></span>
<span data-ttu-id="a9cb3-237">dalším krokem Hello je naslouchací proces hello tooconfigure na hello clusteru a převeďte hello online naslouchací proces.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-237">hello next step is tooconfigure hello listener on hello cluster, and bring hello listener online.</span></span> <span data-ttu-id="a9cb3-238">Hello následující:</span><span class="sxs-lookup"><span data-stu-id="a9cb3-238">Do hello following:</span></span> 

1. <span data-ttu-id="a9cb3-239">Vytvořte naslouchací proces skupiny dostupnosti hello na hello převzetí služeb při selhání clusteru.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-239">Create hello availability group listener on hello failover cluster.</span></span> 

2. <span data-ttu-id="a9cb3-240">Přepněte hello online naslouchací proces.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-240">Bring hello listener online.</span></span>

### <a name="step-5-create-hello-availability-group-listener-on-hello-failover-cluster"></a><span data-ttu-id="a9cb3-241">Krok 5: Vytvoření hello naslouchací proces skupiny dostupnosti v clusteru převzetí služeb při selhání hello</span><span class="sxs-lookup"><span data-stu-id="a9cb3-241">Step 5: Create hello availability group listener on hello failover cluster</span></span>
<span data-ttu-id="a9cb3-242">V tomto kroku vytvoříte ručně hello naslouchací proces skupiny dostupnosti ve Správci clusteru převzetí služeb při selhání a SQL Server Management Studio.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-242">In this step, you manually create hello availability group listener in Failover Cluster Manager and SQL Server Management Studio.</span></span>

[!INCLUDE [ag-listener-configure](../../../../includes/virtual-machines-ag-listener-configure.md)]

### <a name="verify-hello-configuration-of-hello-listener"></a><span data-ttu-id="a9cb3-243">Ověření konfigurace hello hello naslouchacího procesu</span><span class="sxs-lookup"><span data-stu-id="a9cb3-243">Verify hello configuration of hello listener</span></span>

<span data-ttu-id="a9cb3-244">Pokud prostředky clusteru hello a závislosti jsou správně nakonfigurovány, musí být schopný tooview hello naslouchání v aplikaci SQL Server Management Studio.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-244">If hello cluster resources and dependencies are correctly configured, you should be able tooview hello listener in SQL Server Management Studio.</span></span> <span data-ttu-id="a9cb3-245">tooset hello port naslouchacího procesu, hello následující:</span><span class="sxs-lookup"><span data-stu-id="a9cb3-245">tooset hello listener port, do hello following:</span></span>

1. <span data-ttu-id="a9cb3-246">Spusťte SQL Server Management Studio a připojte toohello primární repliky.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-246">Start SQL Server Management Studio, and then connect toohello primary replica.</span></span>

2. <span data-ttu-id="a9cb3-247">Přejděte příliš**vysoké dostupnosti AlwaysOn** > **skupiny dostupnosti** > **naslouchací procesy skupiny dostupnosti**.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-247">Go too**AlwaysOn High Availability** > **Availability Groups** > **Availability Group Listeners**.</span></span>  
    <span data-ttu-id="a9cb3-248">Teď byste měli vidět název hello naslouchacího procesu, který jste vytvořili ve Správci clusteru převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-248">You should now see hello listener name that you created in Failover Cluster Manager.</span></span> 

3. <span data-ttu-id="a9cb3-249">Klikněte pravým tlačítkem na název naslouchacího procesu hello a pak klikněte na **vlastnosti**.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-249">Right-click hello listener name, and then click **Properties**.</span></span>

4. <span data-ttu-id="a9cb3-250">V hello **Port** zadejte číslo portu naslouchacího procesu skupiny dostupnosti hello hello pomocí hello $EndpointPort jste použili předtím (1433 byla výchozí hello) a potom klikněte na **OK**.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-250">In hello **Port** box, specify hello port number for hello availability group listener by using hello $EndpointPort you used earlier (1433 was hello default), and then click **OK**.</span></span>

<span data-ttu-id="a9cb3-251">Nyní máte skupinu dostupnosti v Azure virtuální počítače běžící v režimu Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-251">You now have an availability group in Azure virtual machines running in Resource Manager mode.</span></span> 

## <a name="test-hello-connection-toohello-listener"></a><span data-ttu-id="a9cb3-252">Naslouchací proces toohello testovací hello připojení</span><span class="sxs-lookup"><span data-stu-id="a9cb3-252">Test hello connection toohello listener</span></span>
<span data-ttu-id="a9cb3-253">Testovací připojení hello díky hello následující:</span><span class="sxs-lookup"><span data-stu-id="a9cb3-253">Test hello connection by doing hello following:</span></span>

1. <span data-ttu-id="a9cb3-254">Instance systému SQL Server tooa RDP, který je v hello stejné virtuální síti však není vlastní hello repliky.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-254">RDP tooa SQL Server instance that is in hello same virtual network, but does not own hello replica.</span></span> <span data-ttu-id="a9cb3-255">Tento server můžete hello jiné instance systému SQL Server v clusteru hello.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-255">This server can be hello other SQL Server instance in hello cluster.</span></span>

2. <span data-ttu-id="a9cb3-256">Použití **sqlcmd** nástroj tootest hello připojení.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-256">Use **sqlcmd** utility tootest hello connection.</span></span> <span data-ttu-id="a9cb3-257">Například vytvoří hello následující skript **sqlcmd** připojení toohello primární repliky prostřednictvím hello naslouchací proces s ověřováním systému Windows:</span><span class="sxs-lookup"><span data-stu-id="a9cb3-257">For example, hello following script establishes a **sqlcmd** connection toohello primary replica through hello listener with Windows authentication:</span></span>
   
        sqlcmd -S <listenerName> -E

<span data-ttu-id="a9cb3-258">Hello SQLCMD připojení automaticky připojí toohello instance systému SQL Server, který je hostitelem primární repliky hello.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-258">hello SQLCMD connection automatically connects toohello SQL Server instance that hosts hello primary replica.</span></span> 

## <a name="create-an-ip-address-for-an-additional-availability-group"></a><span data-ttu-id="a9cb3-259">Vytvoření IP adresu pro skupinu dostupnosti další</span><span class="sxs-lookup"><span data-stu-id="a9cb3-259">Create an IP address for an additional availability group</span></span>

<span data-ttu-id="a9cb3-260">Každou skupinu dostupnosti používá samostatné naslouchací proces.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-260">Each availability group uses a separate listener.</span></span> <span data-ttu-id="a9cb3-261">Každý naslouchací proces má svou vlastní IP adresu.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-261">Each listener has its own IP address.</span></span> <span data-ttu-id="a9cb3-262">Použití hello stejná IP adresa hello toohold služby Vyrovnávání zatížení pro další moduly pro naslouchání.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-262">Use hello same load balancer toohold hello IP address for additional listeners.</span></span> <span data-ttu-id="a9cb3-263">Po vytvoření skupiny dostupnosti, přidejte hello IP adresu toohello nástroj pro vyrovnávání zatížení a pak nakonfigurujte hello naslouchací proces.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-263">After you create an availability group, add hello IP address toohello load balancer, and then configure hello listener.</span></span>

<span data-ttu-id="a9cb3-264">tooadd k IP adresu tooa pro vyrovnávání zatížení s hello portál Azure, hello následující:</span><span class="sxs-lookup"><span data-stu-id="a9cb3-264">tooadd an IP address tooa load balancer with hello Azure portal, do hello following:</span></span>

1. <span data-ttu-id="a9cb3-265">V hello portálu Azure otevřete hello skupinu prostředků, který obsahuje nástroj pro vyrovnávání zatížení hello a pak klikněte na nástroj pro vyrovnávání zatížení hello.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-265">In hello Azure portal, open hello resource group that contains hello load balancer, and then click hello load balancer.</span></span> 

2. <span data-ttu-id="a9cb3-266">V části **nastavení**, klikněte na tlačítko **fondu IP front-endu**a potom klikněte na **přidat**.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-266">Under **SETTINGS**, click **Frontend IP pool**, and then click **Add**.</span></span> 

3. <span data-ttu-id="a9cb3-267">V části **přidat IP adresu front-endu**, přiřadit název hello front-endu.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-267">Under **Add frontend IP address**, assign a name for hello front end.</span></span> 

4. <span data-ttu-id="a9cb3-268">Ověřte, že hello **virtuální síť** a hello **podsíť** jsou hello stejná hodnota jako hello instance systému SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-268">Verify that hello **Virtual network** and hello **Subnet** are hello same as hello SQL Server instances.</span></span>

5. <span data-ttu-id="a9cb3-269">Nastavit hello IP adresu pro naslouchací proces hello.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-269">Set hello IP address for hello listener.</span></span> 
   
   >[!TIP]
   ><span data-ttu-id="a9cb3-270">Můžete nastavit hello IP adresu toostatic a zadejte adresu, která není právě používána v podsíti hello.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-270">You can set hello IP address toostatic and type an address that is not currently used in hello subnet.</span></span> <span data-ttu-id="a9cb3-271">Alternativně můžete nastavit hello IP adresu toodynamic a uložit hello nové front-endu fond IP adres.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-271">Alternatively, you can set hello IP address toodynamic and save hello new front-end IP pool.</span></span> <span data-ttu-id="a9cb3-272">Pokud tak učiníte, hello portál Azure automaticky přiřadí k dispozici toohello fondu IP adres.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-272">When you do so, hello Azure portal automatically assigns an available IP address toohello pool.</span></span> <span data-ttu-id="a9cb3-273">Můžete znovu otevřít fondu hello front-end IP adres a změnit přiřazení toostatic hello.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-273">You can then reopen hello front-end IP pool and change hello assignment toostatic.</span></span> 

6. <span data-ttu-id="a9cb3-274">Uložte hello IP adresu pro naslouchací proces hello.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-274">Save hello IP address for hello listener.</span></span> 

7. <span data-ttu-id="a9cb3-275">Přidáte test stavu pomocí hello následující nastavení:</span><span class="sxs-lookup"><span data-stu-id="a9cb3-275">Add a health probe by using hello following settings:</span></span>

   |<span data-ttu-id="a9cb3-276">Nastavení</span><span class="sxs-lookup"><span data-stu-id="a9cb3-276">Setting</span></span> |<span data-ttu-id="a9cb3-277">Hodnota</span><span class="sxs-lookup"><span data-stu-id="a9cb3-277">Value</span></span>
   |:-----|:----
   |<span data-ttu-id="a9cb3-278">**Název**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-278">**Name**</span></span> |<span data-ttu-id="a9cb3-279">Název tooidentify hello testu.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-279">A name tooidentify hello probe.</span></span>
   |<span data-ttu-id="a9cb3-280">**Protokol**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-280">**Protocol**</span></span> |<span data-ttu-id="a9cb3-281">TCP</span><span class="sxs-lookup"><span data-stu-id="a9cb3-281">TCP</span></span>
   |<span data-ttu-id="a9cb3-282">**Port**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-282">**Port**</span></span> |<span data-ttu-id="a9cb3-283">Nepoužitého portu TCP, který musí být k dispozici na všech virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-283">An unused TCP port, which must be available on all virtual machines.</span></span> <span data-ttu-id="a9cb3-284">Nelze zadat pro žádným jiným účelem.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-284">It cannot be used for any other purpose.</span></span> <span data-ttu-id="a9cb3-285">Žádné dva naslouchací procesy můžete použít hello stejný port testu.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-285">No two listeners can use hello same probe port.</span></span> 
   |<span data-ttu-id="a9cb3-286">**Interval**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-286">**Interval**</span></span> |<span data-ttu-id="a9cb3-287">Hello mezi testu pokusů.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-287">hello amount of time between probe attempts.</span></span> <span data-ttu-id="a9cb3-288">Použijte výchozí hello (5).</span><span class="sxs-lookup"><span data-stu-id="a9cb3-288">Use hello default (5).</span></span>
   |<span data-ttu-id="a9cb3-289">**Prahová hodnota špatného stavu**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-289">**Unhealthy threshold**</span></span> |<span data-ttu-id="a9cb3-290">Hello počet po sobě jdoucích prahové hodnoty, které musí selhat, aby virtuální počítač není v pořádku.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-290">hello number of consecutive thresholds that should fail before a virtual machine is considered unhealthy.</span></span>

8. <span data-ttu-id="a9cb3-291">Klikněte na tlačítko **OK** toosave hello testu.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-291">Click **OK** toosave hello probe.</span></span> 

9. <span data-ttu-id="a9cb3-292">Vytvořte pravidlo Vyrovnávání zatížení.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-292">Create a load balancing rule.</span></span> <span data-ttu-id="a9cb3-293">Klikněte na tlačítko **pravidla Vyrovnávání zatížení**a potom klikněte na **přidat**.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-293">Click **Load balancing rules**, and then click **Add**.</span></span>

10. <span data-ttu-id="a9cb3-294">Nakonfigurujte hello nové služby Vyrovnávání zatížení pravidla pomocí hello následující nastavení:</span><span class="sxs-lookup"><span data-stu-id="a9cb3-294">Configure hello new load balancing rule by using hello following settings:</span></span>

   |<span data-ttu-id="a9cb3-295">Nastavení</span><span class="sxs-lookup"><span data-stu-id="a9cb3-295">Setting</span></span> |<span data-ttu-id="a9cb3-296">Hodnota</span><span class="sxs-lookup"><span data-stu-id="a9cb3-296">Value</span></span>
   |:-----|:----
   |<span data-ttu-id="a9cb3-297">**Název**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-297">**Name**</span></span> |<span data-ttu-id="a9cb3-298">Název tooidentify hello načíst pravidlo vyrovnávání.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-298">A name tooidentify hello load balancing rule.</span></span> 
   |<span data-ttu-id="a9cb3-299">**Adresa IP front-endu**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-299">**Frontend IP address**</span></span> |<span data-ttu-id="a9cb3-300">Vyberte hello IP adresu, kterou jste vytvořili.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-300">Select hello IP address you created.</span></span> 
   |<span data-ttu-id="a9cb3-301">**Protokol**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-301">**Protocol**</span></span> |<span data-ttu-id="a9cb3-302">TCP</span><span class="sxs-lookup"><span data-stu-id="a9cb3-302">TCP</span></span>
   |<span data-ttu-id="a9cb3-303">**Port**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-303">**Port**</span></span> |<span data-ttu-id="a9cb3-304">Použijte hello port, který používáte hello instance systému SQL Server.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-304">Use hello port that hello SQL Server instances are using.</span></span> <span data-ttu-id="a9cb3-305">Výchozí instance používá port 1433, pokud jste změnili ho.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-305">A default instance uses port 1433, unless you changed it.</span></span> 
   |<span data-ttu-id="a9cb3-306">**Back-endový port**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-306">**Backend port**</span></span> |<span data-ttu-id="a9cb3-307">Hello použijte stejnou hodnotu jako **Port**.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-307">Use hello same value as **Port**.</span></span>
   |<span data-ttu-id="a9cb3-308">**Fond back-end**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-308">**Backend pool**</span></span> |<span data-ttu-id="a9cb3-309">Hello fond, který obsahuje hello virtuálních počítačů s instancí systému SQL Server hello.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-309">hello pool that contains hello virtual machines with hello SQL Server instances.</span></span> 
   |<span data-ttu-id="a9cb3-310">**Test stavu**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-310">**Health probe**</span></span> |<span data-ttu-id="a9cb3-311">Zvolte hello test, který jste vytvořili.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-311">Choose hello probe you created.</span></span>
   |<span data-ttu-id="a9cb3-312">**Trvalost relace**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-312">**Session persistence**</span></span> |<span data-ttu-id="a9cb3-313">Žádný</span><span class="sxs-lookup"><span data-stu-id="a9cb3-313">None</span></span>
   |<span data-ttu-id="a9cb3-314">**Časový limit nečinnosti (minuty)**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-314">**Idle timeout (minutes)**</span></span> |<span data-ttu-id="a9cb3-315">Výchozí (4)</span><span class="sxs-lookup"><span data-stu-id="a9cb3-315">Default (4)</span></span>
   |<span data-ttu-id="a9cb3-316">**Plovoucí IP adresa (přímá odpověď ze serveru)**</span><span class="sxs-lookup"><span data-stu-id="a9cb3-316">**Floating IP (direct server return)**</span></span> | <span data-ttu-id="a9cb3-317">Povoleno</span><span class="sxs-lookup"><span data-stu-id="a9cb3-317">Enabled</span></span>

### <a name="configure-hello-availability-group-toouse-hello-new-ip-address"></a><span data-ttu-id="a9cb3-318">Konfigurace hello dostupnosti skupiny toouse hello nové IP adresy</span><span class="sxs-lookup"><span data-stu-id="a9cb3-318">Configure hello availability group toouse hello new IP address</span></span>

<span data-ttu-id="a9cb3-319">toofinish konfigurace clusteru hello opakování hello kroky, které jste udělali, když jste provedli hello první skupiny dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-319">toofinish configuring hello cluster, repeat hello steps that you followed when you made hello first availability group.</span></span> <span data-ttu-id="a9cb3-320">To znamená, nakonfigurujte hello [toouse hello novou IP adresu clusteru](#configure-the-cluster-to-use-the-load-balancer-ip-address).</span><span class="sxs-lookup"><span data-stu-id="a9cb3-320">That is, configure hello [cluster toouse hello new IP address](#configure-the-cluster-to-use-the-load-balancer-ip-address).</span></span> 

<span data-ttu-id="a9cb3-321">Po přidání IP adresu pro naslouchací proces hello, nakonfigurujte skupinu dostupnosti další hello pomocí hello následující:</span><span class="sxs-lookup"><span data-stu-id="a9cb3-321">After you have added an IP address for hello listener, configure hello additional availability group by doing hello following:</span></span> 

1. <span data-ttu-id="a9cb3-322">Ověřte, zda je na virtuální počítače systému SQL Server otevřen port hello testu pro hello novou IP adresu.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-322">Verify that hello probe port for hello new IP address is open on both SQL Server virtual machines.</span></span> 

2. <span data-ttu-id="a9cb3-323">[Ve Správci clusteru přidat hello klientský přístupový bod](#addcap).</span><span class="sxs-lookup"><span data-stu-id="a9cb3-323">[In Cluster Manager, add hello client access point](#addcap).</span></span>

3. <span data-ttu-id="a9cb3-324">[Konfigurace prostředků hello IP pro skupinu dostupnosti hello](#congroup).</span><span class="sxs-lookup"><span data-stu-id="a9cb3-324">[Configure hello IP resource for hello availability group](#congroup).</span></span>

   >[!IMPORTANT]
   ><span data-ttu-id="a9cb3-325">Když vytvoříte hello IP adresu, použijte hello IP adresu, zda jste přidali Vyrovnávání zatížení toohello.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-325">When you create hello IP address, use hello IP address that you added toohello load balancer.</span></span>  

4. <span data-ttu-id="a9cb3-326">[Vytvořte prostředek skupiny dostupnosti systému SQL Server hello závislost na hello klientský přístupový bod](#dependencyGroup).</span><span class="sxs-lookup"><span data-stu-id="a9cb3-326">[Make hello SQL Server availability group resource dependent on hello client access point](#dependencyGroup).</span></span>

5. <span data-ttu-id="a9cb3-327">[Usnadnění přístupu klienta hello bodu prostředků, které jsou závislé na IP adrese hello](#listname).</span><span class="sxs-lookup"><span data-stu-id="a9cb3-327">[Make hello client access point resource dependent on hello IP address](#listname).</span></span>
 
6. <span data-ttu-id="a9cb3-328">[Nastavení parametrů clusteru hello v prostředí PowerShell](#setparam).</span><span class="sxs-lookup"><span data-stu-id="a9cb3-328">[Set hello cluster parameters in PowerShell](#setparam).</span></span>

<span data-ttu-id="a9cb3-329">Po dokončení konfigurace hello dostupnosti skupiny toouse hello novou IP adresu, nakonfigurujte hello připojení toohello naslouchací proces.</span><span class="sxs-lookup"><span data-stu-id="a9cb3-329">After you configure hello availability group toouse hello new IP address, configure hello connection toohello listener.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="a9cb3-330">Další kroky</span><span class="sxs-lookup"><span data-stu-id="a9cb3-330">Next steps</span></span>

- [<span data-ttu-id="a9cb3-331">Konfigurovat skupinu dostupnosti SQL serveru Always On na virtuálních počítačích, které jsou v různých oblastech Azure</span><span class="sxs-lookup"><span data-stu-id="a9cb3-331">Configure a SQL Server Always On availability group on Azure virtual machines in different regions</span></span>](virtual-machines-windows-portal-sql-availability-group-dr.md)
