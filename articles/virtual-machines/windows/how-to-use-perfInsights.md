---
title: "Jak používat PerfInsights v Microsoft Azure | Microsoft Docs"
description: "Zjišťuje použití PerfInsights k řešení potíží s výkonem virtuálního počítače s Windows."
services: virtual-machines-windows'
documentationcenter: 
author: genlin
manager: cshepard
editor: na
tags: 
ms.service: virtual-machines-windows
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-windows
ms.devlang: na
ms.topic: article
ms.date: 07/18/2017
ms.author: genli
ms.openlocfilehash: f22bd42302b96118dba0d4e5e387c6798a0b8777
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/18/2017
---
# <a name="how-to-use-perfinsights"></a><span data-ttu-id="71524-103">Jak používat PerfInsights</span><span class="sxs-lookup"><span data-stu-id="71524-103">How to use PerfInsights</span></span> 

<span data-ttu-id="71524-104">[PerfInsights](http://aka.ms/perfinsightsdownload) je automatizovaného skriptu, který shromažďuje diagnostické informace užitečné, běží zatížení vstupu a výstupu přízvuk a poskytuje sestavy analýzy k řešení potíží s výkonem virtuálního počítače s Windows v Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="71524-104">[PerfInsights](http://aka.ms/perfinsightsdownload) is an automated script that collects useful diagnostic information, runs I/O stress loads, and provides an analysis report to help troubleshoot Windows VM performance problems in Microsoft Azure.</span></span> 

<span data-ttu-id="71524-105">Doporučujeme vám, spusťte tento skript před otevřením lístku podpory se společností Microsoft pro problémy s výkonem virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="71524-105">We recommend that you run this script before you open a Support ticket with Microsoft for VM performance issues.</span></span>

## <a name="supported-troubleshooting-scenarios"></a><span data-ttu-id="71524-106">Podporované scénáře řešení potíží</span><span class="sxs-lookup"><span data-stu-id="71524-106">Supported troubleshooting scenarios</span></span>

<span data-ttu-id="71524-107">PerfInsights můžete shromažďovat a analyzovat několik druhů informace, které jsou seskupené do jedinečný scénáře.</span><span class="sxs-lookup"><span data-stu-id="71524-107">PerfInsights can collect and analyze several kinds of information that are grouped into unique scenarios.</span></span>

### <a name="collect-disk-configuration"></a><span data-ttu-id="71524-108">Shromáždit konfiguraci disku</span><span class="sxs-lookup"><span data-stu-id="71524-108">Collect disk configuration</span></span> 

<span data-ttu-id="71524-109">Tento scénář shromažďuje konfigurace disku a další důležité informace, včetně následující položky:</span><span class="sxs-lookup"><span data-stu-id="71524-109">This scenario collects the disk configuration and other important information, including the following items:</span></span>

-   <span data-ttu-id="71524-110">Protokoly událostí</span><span class="sxs-lookup"><span data-stu-id="71524-110">Event logs</span></span>

-   <span data-ttu-id="71524-111">Stav sítě pro všechny příchozí a odchozí připojení</span><span class="sxs-lookup"><span data-stu-id="71524-111">Network status for all incoming and outgoing connections</span></span>

-   <span data-ttu-id="71524-112">Konfigurace nastavení sítě a brány firewall</span><span class="sxs-lookup"><span data-stu-id="71524-112">Network and firewall configuration settings</span></span>

-   <span data-ttu-id="71524-113">Seznam úloh pro všechny aplikace, které jsou aktuálně spuštěny v systému</span><span class="sxs-lookup"><span data-stu-id="71524-113">Task list for all applications that are currently running on the system</span></span>

-   <span data-ttu-id="71524-114">Soubor s informacemi o vytvořené msinfo32 pro virtuální počítač (VM)</span><span class="sxs-lookup"><span data-stu-id="71524-114">Information file created by msinfo32 for the virtual machine (VM)</span></span>

-   <span data-ttu-id="71524-115">Nastavení konfigurace databáze serveru Microsoft SQL Server (Pokud je virtuální počítač se identifikuje jako server, který se systémem SQL Server)</span><span class="sxs-lookup"><span data-stu-id="71524-115">Microsoft SQL Server database configuration settings (if the VM is identified as a server that is running SQL Server)</span></span>

-   <span data-ttu-id="71524-116">Čítače spolehlivost úložiště</span><span class="sxs-lookup"><span data-stu-id="71524-116">Storage reliability counters</span></span>

-   <span data-ttu-id="71524-117">Důležité opravy hotfix pro Windows</span><span class="sxs-lookup"><span data-stu-id="71524-117">Important Windows hotfixes</span></span>

-   <span data-ttu-id="71524-118">Ovladače nainstalované filtru</span><span class="sxs-lookup"><span data-stu-id="71524-118">Installed filter drivers</span></span>

<span data-ttu-id="71524-119">Toto je pasivní kolekce informace, které by neměly vliv na systém.</span><span class="sxs-lookup"><span data-stu-id="71524-119">This is a passive collection of information that shouldn't affect the system.</span></span> 

>[!Note]
><span data-ttu-id="71524-120">Tento scénář je automaticky zahrnuty v každé z následujících scénářů.</span><span class="sxs-lookup"><span data-stu-id="71524-120">This scenario is automatically included in each of the following scenarios.</span></span>

### <a name="benchmarkstorage-performance-test"></a><span data-ttu-id="71524-121">Test výkonu srovnávacího testu/úložiště</span><span class="sxs-lookup"><span data-stu-id="71524-121">Benchmark/Storage Performance Test</span></span>

<span data-ttu-id="71524-122">Tento scénář běží [diskspd](https://github.com/Microsoft/diskspd) srovnávacího testu (IOPS a MB/s) pro všechny disky, které jsou připojené k virtuálnímu počítači.</span><span class="sxs-lookup"><span data-stu-id="71524-122">This scenario runs the [diskspd](https://github.com/Microsoft/diskspd) benchmark test (IOPS and MBPS) for all drives that are attached to the VM.</span></span> 

> [!Note]
> <span data-ttu-id="71524-123">V tomto scénáři může mít vliv na systém a není doporučeno spouštět v systému za provozu produkční.</span><span class="sxs-lookup"><span data-stu-id="71524-123">This scenario can affect the system and shouldn’t be run on a live production system.</span></span> <span data-ttu-id="71524-124">V případě potřeby spusťte tento scénář v vyhrazené údržby vyhnuli potížím.</span><span class="sxs-lookup"><span data-stu-id="71524-124">If necessary, run this scenario in a dedicated maintenance window to avoid any problems.</span></span> <span data-ttu-id="71524-125">Zvýšit zatížení, která je způsobena trasování nebo srovnávacího testu testovací může nepříznivě ovlivnit výkon virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="71524-125">An increased workload that is caused by a trace or benchmark test could adversely affect the performance of your VM.</span></span>
>

### <a name="general-vm-slow-analysis"></a><span data-ttu-id="71524-126">Analýza pomalá obecné virtuálních počítačů</span><span class="sxs-lookup"><span data-stu-id="71524-126">General VM Slow analysis</span></span> 

<span data-ttu-id="71524-127">Tento scénář spustí [čítače výkonu](https://msdn.microsoft.com/library/windows/desktop/aa373083(v=vs.85).aspx) trasování pomocí čítačů, které jsou určené v souboru Generalcounters.txt.</span><span class="sxs-lookup"><span data-stu-id="71524-127">This scenario runs a [performance counter](https://msdn.microsoft.com/library/windows/desktop/aa373083(v=vs.85).aspx) trace by using the counters that are specified in the Generalcounters.txt file.</span></span> <span data-ttu-id="71524-128">Pokud virtuální počítač se identifikuje jako server, který je spuštěn SQL Server, spustí se trasování čítače výkonu pomocí čítačů, které se nacházejí v souboru Sqlcounters.txt.</span><span class="sxs-lookup"><span data-stu-id="71524-128">If the VM is identified as a server that is running SQL Server, it runs a performance counter trace by using the counters that are found in the Sqlcounters.txt file.</span></span> <span data-ttu-id="71524-129">Zahrnuje také výkonu diagnostická data.</span><span class="sxs-lookup"><span data-stu-id="71524-129">It also includes Performance Diagnostics data.</span></span>

### <a name="vm-slow-analysis-and-benchmark"></a><span data-ttu-id="71524-130">Virtuální počítač pomalé analýzy a srovnávacího testu</span><span class="sxs-lookup"><span data-stu-id="71524-130">VM Slow analysis and benchmark</span></span>

<span data-ttu-id="71524-131">Tento scénář spustí [čítače výkonu](https://msdn.microsoft.com/library/windows/desktop/aa373083(v=vs.85).aspx) trasování, který je následován [diskspd](https://github.com/Microsoft/diskspd) srovnávacího testu.</span><span class="sxs-lookup"><span data-stu-id="71524-131">This scenario runs a [performance counter](https://msdn.microsoft.com/library/windows/desktop/aa373083(v=vs.85).aspx) trace that is followed by a [diskspd](https://github.com/Microsoft/diskspd) benchmark test.</span></span> 

> [!Note]
> <span data-ttu-id="71524-132">V tomto scénáři může mít vliv na systém a není doporučeno spouštět v systému za provozu produkční.</span><span class="sxs-lookup"><span data-stu-id="71524-132">This scenario can affect the system and shouldn’t be run on a live production system.</span></span> <span data-ttu-id="71524-133">V případě potřeby spusťte tento scénář v vyhrazené údržby vyhnuli potížím.</span><span class="sxs-lookup"><span data-stu-id="71524-133">If necessary, run this scenario in a dedicated maintenance window to avoid any problems.</span></span> <span data-ttu-id="71524-134">Zvýšit zatížení, která je způsobena trasování nebo srovnávacího testu testovací může nepříznivě ovlivnit výkon virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="71524-134">An increased workload that is caused by a trace or benchmark test could adversely affect the performance of your VM.</span></span>
>

### <a name="azure-files-analysis"></a><span data-ttu-id="71524-135">Azure analysis soubory</span><span class="sxs-lookup"><span data-stu-id="71524-135">Azure Files analysis</span></span> 

<span data-ttu-id="71524-136">Tento scénář se spustí zachycení čítače výkonu speciální společně s provést síťové trasování.</span><span class="sxs-lookup"><span data-stu-id="71524-136">This scenario runs a special performance counter capture together with a network trace.</span></span> <span data-ttu-id="71524-137">Zachytávání zahrnuje všechny čítače "Sdílených složek SMB klienta".</span><span class="sxs-lookup"><span data-stu-id="71524-137">The capture includes all the "SMB Client Shares" counters.</span></span> <span data-ttu-id="71524-138">Tady jsou některé klíčové SMB klienta sdílenou složku čítače výkonu, které jsou součástí zachytávání:</span><span class="sxs-lookup"><span data-stu-id="71524-138">The following are some key SMB client share performance counters that are part of the capture:</span></span>

| <span data-ttu-id="71524-139">**Typ**</span><span class="sxs-lookup"><span data-stu-id="71524-139">**Type**</span></span>     | <span data-ttu-id="71524-140">**Čítač sdílené složky SMB klienta**</span><span class="sxs-lookup"><span data-stu-id="71524-140">**SMB client shares counter**</span></span> |
|--------------|-------------------------------|
| <span data-ttu-id="71524-141">IOPS</span><span class="sxs-lookup"><span data-stu-id="71524-141">IOPS</span></span>         | <span data-ttu-id="71524-142">Data požadavků za sekundu</span><span class="sxs-lookup"><span data-stu-id="71524-142">Data Requests/sec</span></span>             |
|              | <span data-ttu-id="71524-143">Přečtěte si požadavky/s</span><span class="sxs-lookup"><span data-stu-id="71524-143">Read Requests/sec</span></span>             |
|              | <span data-ttu-id="71524-144">Zápis požadavků za sekundu</span><span class="sxs-lookup"><span data-stu-id="71524-144">Write Requests/sec</span></span>            |
| <span data-ttu-id="71524-145">Latence</span><span class="sxs-lookup"><span data-stu-id="71524-145">Latency</span></span>      | <span data-ttu-id="71524-146">Střední doba nebo dat požadavku</span><span class="sxs-lookup"><span data-stu-id="71524-146">Avg. sec/Data Request</span></span>         |
|              | <span data-ttu-id="71524-147">Průměrná doba/čtení</span><span class="sxs-lookup"><span data-stu-id="71524-147">Avg. sec/Read</span></span>                 |
|              | <span data-ttu-id="71524-148">Průměrná doba/zápis</span><span class="sxs-lookup"><span data-stu-id="71524-148">Avg. sec/Write</span></span>                |
| <span data-ttu-id="71524-149">Velikost vstupně-výstupní operace</span><span class="sxs-lookup"><span data-stu-id="71524-149">IO Size</span></span>      | <span data-ttu-id="71524-150">Střední Požadavek na bajtů nebo dat</span><span class="sxs-lookup"><span data-stu-id="71524-150">Avg. Bytes/Data Request</span></span>       |
|              | <span data-ttu-id="71524-151">Střední Bajty/čtení</span><span class="sxs-lookup"><span data-stu-id="71524-151">Avg. Bytes/Read</span></span>               |
|              | <span data-ttu-id="71524-152">Střední Bajty a zápis</span><span class="sxs-lookup"><span data-stu-id="71524-152">Avg. Bytes/Write</span></span>              |
| <span data-ttu-id="71524-153">Propustnost</span><span class="sxs-lookup"><span data-stu-id="71524-153">Throughput</span></span>   | <span data-ttu-id="71524-154">Data bajty/s</span><span class="sxs-lookup"><span data-stu-id="71524-154">Data Bytes/sec</span></span>                |
|              | <span data-ttu-id="71524-155">Číst bajty/s</span><span class="sxs-lookup"><span data-stu-id="71524-155">Read Bytes/sec</span></span>                |
|              | <span data-ttu-id="71524-156">Zápis bajtů za sekundu</span><span class="sxs-lookup"><span data-stu-id="71524-156">Write Bytes/sec</span></span>               |
| <span data-ttu-id="71524-157">Délka fronty</span><span class="sxs-lookup"><span data-stu-id="71524-157">Queue Length</span></span> | <span data-ttu-id="71524-158">Střední Délka fronty pro čtení</span><span class="sxs-lookup"><span data-stu-id="71524-158">Avg. Read Queue Length</span></span>        |
|              | <span data-ttu-id="71524-159">Střední Délka fronty zápisu</span><span class="sxs-lookup"><span data-stu-id="71524-159">Avg. Write Queue Length</span></span>       |
|              | <span data-ttu-id="71524-160">Střední Délka fronty dat</span><span class="sxs-lookup"><span data-stu-id="71524-160">Avg. Data Queue Length</span></span>        |

### <a name="custom-configuration"></a><span data-ttu-id="71524-161">Vlastní konfigurace</span><span class="sxs-lookup"><span data-stu-id="71524-161">Custom configuration</span></span> 

<span data-ttu-id="71524-162">Když spustíte vlastní konfiguraci, používáte všech trasování (diagnostiku výkonu, čítače výkonu, xperf, sítě, storport) paralelně, podle toho, kolik různých trasování jsou vybrané.</span><span class="sxs-lookup"><span data-stu-id="71524-162">When you run a custom configuration, you are running all traces (performance diagnostics, performance counter, xperf, network, storport) in parallel, depending how many different traces are selected.</span></span> <span data-ttu-id="71524-163">Po dokončení trasování je nástroj spuštěn srovnávacího testu diskspd, pokud je zaškrtnuto.</span><span class="sxs-lookup"><span data-stu-id="71524-163">After tracing is completed, the tool runs the diskspd benchmark, if it is selected.</span></span> 

> [!Note]
> <span data-ttu-id="71524-164">V tomto scénáři může mít vliv na systém a není doporučeno spouštět v systému za provozu produkční.</span><span class="sxs-lookup"><span data-stu-id="71524-164">This scenario can affect the system and shouldn’t be run on a live production system.</span></span> <span data-ttu-id="71524-165">V případě potřeby spusťte tento scénář v vyhrazené údržby vyhnuli potížím.</span><span class="sxs-lookup"><span data-stu-id="71524-165">If necessary, run this scenario in a dedicated maintenance window to avoid any problems.</span></span> <span data-ttu-id="71524-166">Zvýšit zatížení, která je způsobena trasování nebo srovnávacího testu testovací může nepříznivě ovlivnit výkon virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="71524-166">An increased workload that is caused by a trace or benchmark test could adversely affect the performance of your VM.</span></span>
>

## <a name="what-kind-of-information-is-collected-by-the-script"></a><span data-ttu-id="71524-167">Jaký druh informací se shromažďují skript?</span><span class="sxs-lookup"><span data-stu-id="71524-167">What kind of information is collected by the script?</span></span>

<span data-ttu-id="71524-168">Informace o virtuální počítač s Windows, disky nebo úložiště fondy konfigurace, čítače výkonu, protokoly a různé trasování jsou shromažďovány v závislosti na scénáři výkonu použít:</span><span class="sxs-lookup"><span data-stu-id="71524-168">Information about Windows VM, disks or storage pools configuration, performance counters, logs and various traces are collected depending on the performance scenario used:</span></span>

|<span data-ttu-id="71524-169">Data shromážděná</span><span class="sxs-lookup"><span data-stu-id="71524-169">Data collected</span></span>                              |  |  | <span data-ttu-id="71524-170">Scénáře výkonu</span><span class="sxs-lookup"><span data-stu-id="71524-170">Performance Scenarios</span></span> |  |  | |
|----------------------------------|----------------------------|------------------------------------|--------------------------|--------------------------------|----------------------|----------------------|
|                              | <span data-ttu-id="71524-171">Shromažďování konfigurace disku</span><span class="sxs-lookup"><span data-stu-id="71524-171">Collect disk Configuration</span></span> | <span data-ttu-id="71524-172">Test výkonu srovnávacího testu/úložiště</span><span class="sxs-lookup"><span data-stu-id="71524-172">Benchmark/Storage Performance test</span></span> | <span data-ttu-id="71524-173">Analýza pomalá obecné virtuálních počítačů</span><span class="sxs-lookup"><span data-stu-id="71524-173">General VM Slow analysis</span></span> | <span data-ttu-id="71524-174">Virtuální počítač pomalé analýzy a srovnávacího testu</span><span class="sxs-lookup"><span data-stu-id="71524-174">VM Slow analysis and benchmark</span></span> | <span data-ttu-id="71524-175">Azure analysis soubory</span><span class="sxs-lookup"><span data-stu-id="71524-175">Azure Files analysis</span></span> | <span data-ttu-id="71524-176">Vlastní konfigurace</span><span class="sxs-lookup"><span data-stu-id="71524-176">Custom configuration</span></span> |
| <span data-ttu-id="71524-177">Informace z protokolů událostí</span><span class="sxs-lookup"><span data-stu-id="71524-177">Information from Event logs</span></span>      | <span data-ttu-id="71524-178">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-178">Yes</span></span>                        | <span data-ttu-id="71524-179">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-179">Yes</span></span>                                | <span data-ttu-id="71524-180">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-180">Yes</span></span>                      | <span data-ttu-id="71524-181">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-181">Yes</span></span>                            | <span data-ttu-id="71524-182">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-182">Yes</span></span>                  | <span data-ttu-id="71524-183">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-183">Yes</span></span>                  |
| <span data-ttu-id="71524-184">Informace o systému</span><span class="sxs-lookup"><span data-stu-id="71524-184">System information</span></span>               | <span data-ttu-id="71524-185">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-185">Yes</span></span>                        | <span data-ttu-id="71524-186">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-186">Yes</span></span>                                | <span data-ttu-id="71524-187">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-187">Yes</span></span>                      | <span data-ttu-id="71524-188">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-188">Yes</span></span>                            | <span data-ttu-id="71524-189">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-189">Yes</span></span>                  | <span data-ttu-id="71524-190">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-190">Yes</span></span>                  |
| <span data-ttu-id="71524-191">Svazek mapy</span><span class="sxs-lookup"><span data-stu-id="71524-191">Volume Map</span></span>                       | <span data-ttu-id="71524-192">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-192">Yes</span></span>                        | <span data-ttu-id="71524-193">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-193">Yes</span></span>                                | <span data-ttu-id="71524-194">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-194">Yes</span></span>                      | <span data-ttu-id="71524-195">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-195">Yes</span></span>                            | <span data-ttu-id="71524-196">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-196">Yes</span></span>                  | <span data-ttu-id="71524-197">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-197">Yes</span></span>                  |
| <span data-ttu-id="71524-198">Mapa disku</span><span class="sxs-lookup"><span data-stu-id="71524-198">Disk Map</span></span>                         | <span data-ttu-id="71524-199">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-199">Yes</span></span>                        | <span data-ttu-id="71524-200">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-200">Yes</span></span>                                | <span data-ttu-id="71524-201">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-201">Yes</span></span>                      | <span data-ttu-id="71524-202">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-202">Yes</span></span>                            | <span data-ttu-id="71524-203">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-203">Yes</span></span>                  | <span data-ttu-id="71524-204">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-204">Yes</span></span>                  |
| <span data-ttu-id="71524-205">Spuštěné úlohy</span><span class="sxs-lookup"><span data-stu-id="71524-205">Running Tasks</span></span>                    | <span data-ttu-id="71524-206">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-206">Yes</span></span>                        | <span data-ttu-id="71524-207">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-207">Yes</span></span>                                | <span data-ttu-id="71524-208">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-208">Yes</span></span>                      | <span data-ttu-id="71524-209">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-209">Yes</span></span>                            | <span data-ttu-id="71524-210">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-210">Yes</span></span>                  | <span data-ttu-id="71524-211">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-211">Yes</span></span>                  |
| <span data-ttu-id="71524-212">Čítače spolehlivost úložiště</span><span class="sxs-lookup"><span data-stu-id="71524-212">Storage Reliability Counters</span></span>     | <span data-ttu-id="71524-213">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-213">Yes</span></span>                        | <span data-ttu-id="71524-214">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-214">Yes</span></span>                                | <span data-ttu-id="71524-215">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-215">Yes</span></span>                      | <span data-ttu-id="71524-216">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-216">Yes</span></span>                            | <span data-ttu-id="71524-217">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-217">Yes</span></span>                  | <span data-ttu-id="71524-218">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-218">Yes</span></span>                  |
| <span data-ttu-id="71524-219">Informace o úložiště</span><span class="sxs-lookup"><span data-stu-id="71524-219">Storage information</span></span>              | <span data-ttu-id="71524-220">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-220">Yes</span></span>                        | <span data-ttu-id="71524-221">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-221">Yes</span></span>                                | <span data-ttu-id="71524-222">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-222">Yes</span></span>                      | <span data-ttu-id="71524-223">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-223">Yes</span></span>                            | <span data-ttu-id="71524-224">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-224">Yes</span></span>                  | <span data-ttu-id="71524-225">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-225">Yes</span></span>                  |
| <span data-ttu-id="71524-226">Výstup fsutil</span><span class="sxs-lookup"><span data-stu-id="71524-226">Fsutil output</span></span>                    | <span data-ttu-id="71524-227">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-227">Yes</span></span>                        | <span data-ttu-id="71524-228">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-228">Yes</span></span>                                | <span data-ttu-id="71524-229">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-229">Yes</span></span>                      | <span data-ttu-id="71524-230">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-230">Yes</span></span>                            | <span data-ttu-id="71524-231">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-231">Yes</span></span>                  | <span data-ttu-id="71524-232">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-232">Yes</span></span>                  |
| <span data-ttu-id="71524-233">Informace o ovladač filtru</span><span class="sxs-lookup"><span data-stu-id="71524-233">Filter Driver info</span></span>               | <span data-ttu-id="71524-234">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-234">Yes</span></span>                        | <span data-ttu-id="71524-235">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-235">Yes</span></span>                                | <span data-ttu-id="71524-236">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-236">Yes</span></span>                      | <span data-ttu-id="71524-237">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-237">Yes</span></span>                            | <span data-ttu-id="71524-238">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-238">Yes</span></span>                  | <span data-ttu-id="71524-239">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-239">Yes</span></span>                  |
| <span data-ttu-id="71524-240">Výstup příkazu netstat</span><span class="sxs-lookup"><span data-stu-id="71524-240">Netstat output</span></span>                   | <span data-ttu-id="71524-241">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-241">Yes</span></span>                        | <span data-ttu-id="71524-242">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-242">Yes</span></span>                                | <span data-ttu-id="71524-243">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-243">Yes</span></span>                      | <span data-ttu-id="71524-244">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-244">Yes</span></span>                            | <span data-ttu-id="71524-245">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-245">Yes</span></span>                  | <span data-ttu-id="71524-246">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-246">Yes</span></span>                  |
| <span data-ttu-id="71524-247">Konfigurace sítě</span><span class="sxs-lookup"><span data-stu-id="71524-247">Network configuration</span></span>            | <span data-ttu-id="71524-248">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-248">Yes</span></span>                        | <span data-ttu-id="71524-249">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-249">Yes</span></span>                                | <span data-ttu-id="71524-250">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-250">Yes</span></span>                      | <span data-ttu-id="71524-251">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-251">Yes</span></span>                            | <span data-ttu-id="71524-252">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-252">Yes</span></span>                  | <span data-ttu-id="71524-253">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-253">Yes</span></span>                  |
| <span data-ttu-id="71524-254">Konfigurace brány firewall</span><span class="sxs-lookup"><span data-stu-id="71524-254">Firewall configuration</span></span>           | <span data-ttu-id="71524-255">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-255">Yes</span></span>                        | <span data-ttu-id="71524-256">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-256">Yes</span></span>                                | <span data-ttu-id="71524-257">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-257">Yes</span></span>                      | <span data-ttu-id="71524-258">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-258">Yes</span></span>                            | <span data-ttu-id="71524-259">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-259">Yes</span></span>                  | <span data-ttu-id="71524-260">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-260">Yes</span></span>                  |
| <span data-ttu-id="71524-261">Konfigurace systému SQL Server</span><span class="sxs-lookup"><span data-stu-id="71524-261">SQL Server configuration</span></span>         | <span data-ttu-id="71524-262">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-262">Yes</span></span>                        | <span data-ttu-id="71524-263">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-263">Yes</span></span>                                | <span data-ttu-id="71524-264">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-264">Yes</span></span>                      | <span data-ttu-id="71524-265">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-265">Yes</span></span>                            | <span data-ttu-id="71524-266">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-266">Yes</span></span>                  | <span data-ttu-id="71524-267">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-267">Yes</span></span>                  |
| <span data-ttu-id="71524-268">Trasování diagnostiky výkonu *</span><span class="sxs-lookup"><span data-stu-id="71524-268">Performance Diagnostics Traces *</span></span> |                            |                                    | <span data-ttu-id="71524-269">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-269">Yes</span></span>                      |                                |                      | <span data-ttu-id="71524-270">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-270">Yes</span></span>                  |
| <span data-ttu-id="71524-271">Čítač výkonu trasování **</span><span class="sxs-lookup"><span data-stu-id="71524-271">Performance counter Trace **</span></span>     |                            |                                    |                          |                                |                      | <span data-ttu-id="71524-272">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-272">Yes</span></span>                  |
| <span data-ttu-id="71524-273">Čítač SMB trasování **</span><span class="sxs-lookup"><span data-stu-id="71524-273">SMB counter Trace **</span></span>             |                            |                                    |                          |                                | <span data-ttu-id="71524-274">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-274">Yes</span></span>                  |                      |
| <span data-ttu-id="71524-275">Čítače systému SQL Server trasování **</span><span class="sxs-lookup"><span data-stu-id="71524-275">SQL Server counter Trace **</span></span>      |                            |                                    |                          |                                |                      | <span data-ttu-id="71524-276">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-276">Yes</span></span>                  |
| <span data-ttu-id="71524-277">XPerf trasování</span><span class="sxs-lookup"><span data-stu-id="71524-277">XPerf Trace</span></span>                      |                            |                                    |                          |                                |                      | <span data-ttu-id="71524-278">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-278">Yes</span></span>                  |
| <span data-ttu-id="71524-279">StorPort trasování</span><span class="sxs-lookup"><span data-stu-id="71524-279">StorPort Trace</span></span>                   |                            |                                    |                          |                                |                      | <span data-ttu-id="71524-280">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-280">Yes</span></span>                  |
| <span data-ttu-id="71524-281">Trasování sítě</span><span class="sxs-lookup"><span data-stu-id="71524-281">Network Trace</span></span>                    |                            |                                    |                          |                                | <span data-ttu-id="71524-282">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-282">Yes</span></span>                  | <span data-ttu-id="71524-283">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-283">Yes</span></span>                  |
| <span data-ttu-id="71524-284">Trasování srovnávacího testu Diskspd ***</span><span class="sxs-lookup"><span data-stu-id="71524-284">Diskspd Benchmark trace ***</span></span>      |                            | <span data-ttu-id="71524-285">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-285">Yes</span></span>                                |                          | <span data-ttu-id="71524-286">Ano</span><span class="sxs-lookup"><span data-stu-id="71524-286">Yes</span></span>                            |                      |                      |
|       |                            |                         |                                                   |                      |                      |

### <a name="performance-diagnostics-trace-"></a><span data-ttu-id="71524-287">Trasování výkonu diagnostiky (*)</span><span class="sxs-lookup"><span data-stu-id="71524-287">Performance Diagnostics trace (*)</span></span>

<span data-ttu-id="71524-288">Běží na pozadí pro shromažďování dat a diagnostikovat problémy s výkonem probíhající modul založený na pravidlech.</span><span class="sxs-lookup"><span data-stu-id="71524-288">Runs a rule-based engine in the background to collect data and diagnose ongoing performance issues.</span></span> <span data-ttu-id="71524-289">Aktuálně jsou podporovány následující pravidla:</span><span class="sxs-lookup"><span data-stu-id="71524-289">The following rules are currently supported:</span></span>

- <span data-ttu-id="71524-290">Pravidlo HighCpuUsage: zjistí vysoké období využití procesoru a zobrazuje hlavních spotřebitelů využití procesoru během těchto období.</span><span class="sxs-lookup"><span data-stu-id="71524-290">HighCpuUsage rule: Detects high CPU usage periods and shows the top CPU usage consumers during those periods.</span></span>
- <span data-ttu-id="71524-291">Pravidlo HighDiskUsage: zjistí využití období vysoké disku na fyzických discích a zobrazuje nejvyšší disku příjemci využití během těchto období.</span><span class="sxs-lookup"><span data-stu-id="71524-291">HighDiskUsage rule: Detects high disk usage periods on physical disks and shows the top disk usage consumers during those periods.</span></span>
- <span data-ttu-id="71524-292">Pravidlo HighResolutionDiskMetric: ukazuje IOP, propustnosti a latence metriky vstupně-výstupní operace za 50 milisekund pro každého fyzického disku.</span><span class="sxs-lookup"><span data-stu-id="71524-292">HighResolutionDiskMetric rule: Shows IOPS, throughput and IO latency metrics per 50 milliseconds for each physical disk.</span></span> <span data-ttu-id="71524-293">Pomáhá rychle zjistit disku omezení tečky.</span><span class="sxs-lookup"><span data-stu-id="71524-293">It helps to quickly identify disk throttling periods.</span></span>
- <span data-ttu-id="71524-294">Pravidlo HighMemoryUsage: zjistí období využití velkého množství paměti a zobrazuje hlavní paměti příjemci využití během těchto období.</span><span class="sxs-lookup"><span data-stu-id="71524-294">HighMemoryUsage rule: Detects high memory usage periods, and shows the top memory usage consumers during those periods.</span></span>

> [!NOTE] 
> <span data-ttu-id="71524-295">V současné době jsou podporovány verze Windows, které zahrnují rozhraní .NET Framework 3.5 nebo novější verze.</span><span class="sxs-lookup"><span data-stu-id="71524-295">Currently, Windows versions that include the .NET Framework 3.5 or later versions are supported.</span></span>

### <a name="performance-counter-trace-"></a><span data-ttu-id="71524-296">Trasování čítače výkonu (*)</span><span class="sxs-lookup"><span data-stu-id="71524-296">Performance Counter trace (**)</span></span>

<span data-ttu-id="71524-297">Shromažďuje následující čítače výkonu:</span><span class="sxs-lookup"><span data-stu-id="71524-297">Collects the following Performance Counters:</span></span>

- <span data-ttu-id="71524-298">\Process, \Processor, \Memory, \Thread, \PhysicalDisk, \LogicalDisk</span><span class="sxs-lookup"><span data-stu-id="71524-298">\Process, \Processor, \Memory, \Thread, \PhysicalDisk, \LogicalDisk</span></span>
- <span data-ttu-id="71524-299">\Cache\Dirty stránky, zápisů \Cache\Lazy/s, \Server\Pool nestránkovaného fondu, chyb, selhání \Server\Pool stránkovaného fondu</span><span class="sxs-lookup"><span data-stu-id="71524-299">\Cache\Dirty Pages, \Cache\Lazy Write Flushes/sec, \Server\Pool Nonpaged, Failures, \Server\Pool Paged Failures</span></span>
- <span data-ttu-id="71524-300">Vybrané čítače pod \Network rozhraní \IPv4\Datagrams, \IPv6\Datagrams, \TCPv4\Segments, \TCPv6\Segments, \Network adaptéru, \WFPv4\Packets, \WFPv6\Packets, \UDPv4\Datagrams, \UDPv6\Datagrams, \TCPv4\Connection, \TCPv6\Connection, \Network QoS Policy\Packets, \Per procesor síťové rozhraní karty aktivity, \Microsoft Winsock BSP</span><span class="sxs-lookup"><span data-stu-id="71524-300">Selected counters under \Network Interface, \IPv4\Datagrams, \IPv6\Datagrams, \TCPv4\Segments, \TCPv6\Segments,  \Network Adapter, \WFPv4\Packets, \WFPv6\Packets, \UDPv4\Datagrams, \UDPv6\Datagrams, \TCPv4\Connection, \TCPv6\Connection, \Network QoS Policy\Packets, \Per Processor Network Interface Card Activity, \Microsoft Winsock BSP</span></span>

#### <a name="for-sql-server-instances"></a><span data-ttu-id="71524-301">Pro instance systému SQL Server</span><span class="sxs-lookup"><span data-stu-id="71524-301">For SQL Server instances</span></span>
- <span data-ttu-id="71524-302">Správce serveru: vyrovnávací paměti \SQL, \SQLServer:Resource fondu statistiky, \SQLServer:SQL Statistics\\</span><span class="sxs-lookup"><span data-stu-id="71524-302">\SQL Server:Buffer Manager, \SQLServer:Resource Pool Stats, \SQLServer:SQL Statistics\\</span></span>
- <span data-ttu-id="71524-303">\SQLServer:Locks, \SQLServer:General statistiky</span><span class="sxs-lookup"><span data-stu-id="71524-303">\SQLServer:Locks, \SQLServer:General, Statistics</span></span>
- <span data-ttu-id="71524-304">\SQLServer:Access metody</span><span class="sxs-lookup"><span data-stu-id="71524-304">\SQLServer:Access Methods</span></span>

#### <a name="for-azure-files"></a><span data-ttu-id="71524-305">Pro soubory Azure</span><span class="sxs-lookup"><span data-stu-id="71524-305">For Azure Files</span></span>
<span data-ttu-id="71524-306">\SMB sdílených složek klienta</span><span class="sxs-lookup"><span data-stu-id="71524-306">\SMB Client Shares</span></span>

### <a name="diskspd-benchmark-trace-"></a><span data-ttu-id="71524-307">Trasování srovnávacího testu Diskspd (*)</span><span class="sxs-lookup"><span data-stu-id="71524-307">Diskspd Benchmark trace (***)</span></span>
<span data-ttu-id="71524-308">Zatížení testy Diskspd vstupně-výstupní operace [Disk operačního systému (zápisu) a jednotky fondu (čtení a zápis)]</span><span class="sxs-lookup"><span data-stu-id="71524-308">Diskspd IO workload tests [OS Disk (write) and pool drives (read/write)]</span></span>

## <a name="run-the-perfinsights-on-your-vm"></a><span data-ttu-id="71524-309">Spustit PerfInsights na vašem virtuálním počítači</span><span class="sxs-lookup"><span data-stu-id="71524-309">Run the PerfInsights on your VM</span></span>

### <a name="what-do-i-have-to-know-before-i-run-the-script"></a><span data-ttu-id="71524-310">Co je nutné vědět před I spusťte skript?</span><span class="sxs-lookup"><span data-stu-id="71524-310">What do I have to know before I run the script?</span></span> 

<span data-ttu-id="71524-311">**Požadavky na skript**</span><span class="sxs-lookup"><span data-stu-id="71524-311">**Script requirements**</span></span>

1.  <span data-ttu-id="71524-312">Tento skript musí spustit na virtuálním počítači, který má problémy s výkonem.</span><span class="sxs-lookup"><span data-stu-id="71524-312">This script must be run on the VM that has the performance issue.</span></span> 

2.  <span data-ttu-id="71524-313">Jsou podporovány následující operační systémy: Windows Server 2008 R2, 2012, 2012 R2, 2016; Windows 8.1 a Windows 10.</span><span class="sxs-lookup"><span data-stu-id="71524-313">The following OSes are supported: Windows Server 2008 R2, 2012, 2012 R2, 2016; Windows 8.1 and Windows 10.</span></span>

<span data-ttu-id="71524-314">**Možné problémy při spuštění skriptu na produkční virtuální počítače:**</span><span class="sxs-lookup"><span data-stu-id="71524-314">**Possible issues when you run the script on production VMs:**</span></span>

1.  <span data-ttu-id="71524-315">Skript může nepříznivě ovlivnit výkon virtuálního počítače, pokud se používá spolu s "Srovnávacího testu" nebo "Vlastní" scénář, který je nakonfigurovaný pomocí XPerf nebo nástroje DiskSpd.</span><span class="sxs-lookup"><span data-stu-id="71524-315">The script might adversely affect the performance of the VM when it is used together with the "Benchmark" or "Custom" scenario that is configured by using XPerf or DiskSpd.</span></span> <span data-ttu-id="71524-316">Buďte opatrní při spuštění skriptu v produkčním prostředí.</span><span class="sxs-lookup"><span data-stu-id="71524-316">Be careful when you run the script in a production environment.</span></span>

2.  <span data-ttu-id="71524-317">Pokud použijete skript společně s "Srovnávacího testu" nebo "Vlastní" scénář, který je nakonfigurovaný pomocí nástroje DiskSpd, ujistěte se, že žádné další aktivita na pozadí naruší vstupně-výstupní úlohy na otestované disky.</span><span class="sxs-lookup"><span data-stu-id="71524-317">When you use the script together with the "Benchmark" or "Custom" scenario that is configured by using DiskSpd, make sure that no other background activity interferes with the I/O workload on the tested disks.</span></span>

3.  <span data-ttu-id="71524-318">Ve výchozím nastavení používá skript ke shromažďování dat na jednotku dočasné úložiště.</span><span class="sxs-lookup"><span data-stu-id="71524-318">By default, the script uses the temporary storage drive to collect data.</span></span> <span data-ttu-id="71524-319">Pokud trasování zůstane povolena delší dobu, může být množství dat, které jsou shromážděny relevantní.</span><span class="sxs-lookup"><span data-stu-id="71524-319">If tracing stays enabled for a longer time, the amount of data that is collected might be relevant.</span></span> <span data-ttu-id="71524-320">To může snížit dostupnost místa na disku dočasné, proto by to ovlivnilo jakékoli aplikace, které jsou závislé na této jednotce.</span><span class="sxs-lookup"><span data-stu-id="71524-320">This can reduce the availability of space on the temporary disk, therefore affecting any application that relies on this drive.</span></span>

### <a name="how-do-i-run-perfinsights"></a><span data-ttu-id="71524-321">Jak spustit PerfInsights?</span><span class="sxs-lookup"><span data-stu-id="71524-321">How do I run PerfInsights?</span></span> 

<span data-ttu-id="71524-322">Pokud chcete spustit skript, postupujte takto:</span><span class="sxs-lookup"><span data-stu-id="71524-322">To run the script, follow these steps:</span></span>

1. <span data-ttu-id="71524-323">Stáhněte si [PerfInsights.zip](http://aka.ms/perfinsightsdownload).</span><span class="sxs-lookup"><span data-stu-id="71524-323">Download [PerfInsights.zip](http://aka.ms/perfinsightsdownload).</span></span>

2. <span data-ttu-id="71524-324">Odblokování PerfInsights.zip souboru.</span><span class="sxs-lookup"><span data-stu-id="71524-324">Unblock the PerfInsights.zip file.</span></span> <span data-ttu-id="71524-325">Chcete-li to provést, klikněte pravým tlačítkem na soubor PerfInsights.zip, vyberte možnost **vlastnosti**.</span><span class="sxs-lookup"><span data-stu-id="71524-325">To do this, right-click the PerfInsights.zip file, select **Properties**.</span></span> <span data-ttu-id="71524-326">V **Obecné** vyberte **Odblokovat** a pak vyberte **OK**.</span><span class="sxs-lookup"><span data-stu-id="71524-326">In the **General** tab, select **Unblock** and then select **OK**.</span></span> <span data-ttu-id="71524-327">Tím se zajistí, že skript se spustí bez jakékoli další bezpečnostní zobrazí výzvu.</span><span class="sxs-lookup"><span data-stu-id="71524-327">This will make sure that the script runs without any additional security prompts.</span></span>  

    ![Odemkněte tento soubor zip](media/how-to-use-perfInsights/unlock-file.png)

3.  <span data-ttu-id="71524-329">Rozbalte komprimovaný soubor PerfInsights.zip do dočasné jednotky (ve výchozím nastavení je to obvykle diskovou jednotku d).</span><span class="sxs-lookup"><span data-stu-id="71524-329">Expand the compressed PerfInsights.zip file into your temporary drive (by default, usually the D drive).</span></span> <span data-ttu-id="71524-330">Komprimovaný soubor musí obsahovat následující soubory a složky:</span><span class="sxs-lookup"><span data-stu-id="71524-330">The compressed file should contain the following files and folders:</span></span>

    ![soubory ve složce zip](media/how-to-use-perfInsights/file-folder.png)

4.  <span data-ttu-id="71524-332">Otevřete prostředí Windows PowerShell jako správce a spusťte skript PerfInsights.ps1.</span><span class="sxs-lookup"><span data-stu-id="71524-332">Open Windows PowerShell as an administrator, and then run the PerfInsights.ps1 script.</span></span>

    ```
    cd <the path of PerfInsights folder >
    Powershell.exe -ExecutionPolicy UnRestricted -NoProfile -File .\\PerfInsights.ps1
    ```

    <span data-ttu-id="71524-333">Můžete chtít zadejte "y" Pokud se zobrazí výzva k potvrzení, že chcete změnit zásady spouštění.</span><span class="sxs-lookup"><span data-stu-id="71524-333">You might have to enter "y" to if you are asked to confirm that you want to change the execution policy.</span></span>

    <span data-ttu-id="71524-334">V dialogovém okně právní omezení budete mít možnost sdílet diagnostické informace s Microsoft Support.</span><span class="sxs-lookup"><span data-stu-id="71524-334">In the Disclaimer dialog box, you are given the option to share diagnostic information with Microsoft Support.</span></span> <span data-ttu-id="71524-335">Budete také musí souhlasit s licenční smlouvy pokračujte.</span><span class="sxs-lookup"><span data-stu-id="71524-335">You must also consent to the license agreement to continue.</span></span> <span data-ttu-id="71524-336">Proveďte požadovaná nastavení a potom klikněte na **spustit skript**.</span><span class="sxs-lookup"><span data-stu-id="71524-336">Make your selections, and then click **Run Script**.</span></span>

    ![Pole právní omezení](media/how-to-use-perfInsights/disclaimer.png)

5.  <span data-ttu-id="71524-338">Číslo případu odeslání, pokud je k dispozici, při spuštění skriptu (to je pro naše statistiky).</span><span class="sxs-lookup"><span data-stu-id="71524-338">Submit the case number, if it is available, when you run the script (This is for our statistics).</span></span> <span data-ttu-id="71524-339">Potom klikněte na **OK**.</span><span class="sxs-lookup"><span data-stu-id="71524-339">Then, click **OK**.</span></span>
    
    ![Zadejte ID podpory](media/how-to-use-perfInsights/enter-support-number.png)

6.  <span data-ttu-id="71524-341">Vyberte jednotku dočasné úložiště.</span><span class="sxs-lookup"><span data-stu-id="71524-341">Select your temporary storage drive.</span></span> <span data-ttu-id="71524-342">Skript může automaticky rozpoznat písmeno jednotky.</span><span class="sxs-lookup"><span data-stu-id="71524-342">The Script can auto-detect the drive letter of the drive.</span></span> <span data-ttu-id="71524-343">Dojde-li všechny problémy v této fázi, může být vyzvání k vyberte jednotky (výchozí jednotce je D).</span><span class="sxs-lookup"><span data-stu-id="71524-343">If any problems occur in this stage, you might be prompted to select the drive (the default drive is D).</span></span> <span data-ttu-id="71524-344">Vygenerovaný protokoly jsou zde uloženy v protokolu\_složky kolekce.</span><span class="sxs-lookup"><span data-stu-id="71524-344">Generated logs are stored here in the log\_collection folder.</span></span> <span data-ttu-id="71524-345">Po zadání nebo přijměte písmeno jednotky, klikněte na tlačítko **OK**.</span><span class="sxs-lookup"><span data-stu-id="71524-345">After you enter or accept the drive letter, click **OK**.</span></span>

    ![Zadejte jednotku](media/how-to-use-perfInsights/enter-drive.png)

7.  <span data-ttu-id="71524-347">Vyberte ze seznamu zadaný odstraňování potíží.</span><span class="sxs-lookup"><span data-stu-id="71524-347">Select a troubleshooting scenario from the provided list.</span></span>

       ![Vyberte scénáře podpory](media/how-to-use-perfInsights/select-scenarios.png)

8.  <span data-ttu-id="71524-349">Můžete také spustit PerfInsights bez uživatelského rozhraní.</span><span class="sxs-lookup"><span data-stu-id="71524-349">You can also run PerfInsights without UI.</span></span>

    <span data-ttu-id="71524-350">Tento příkaz spustí "Obecné virtuálních počítačů pomalá analysis" řešení potíží s scénář bez výzvy k uživatelského rozhraní nebo zaznamenání dat po dobu 30 sekund.</span><span class="sxs-lookup"><span data-stu-id="71524-350">The following command runs the "General VM Slow analysis" troubleshooting scenario without a UI prompt or capture data for 30 seconds.</span></span> <span data-ttu-id="71524-351">Budete vyzváni k souhlas s právní omezení a smlouva EULA, které jsou uvedené v kroku 4.</span><span class="sxs-lookup"><span data-stu-id="71524-351">It prompts you to consent to the same disclaimer and EULA that  are mentioned in step 4.</span></span>

        powershell.exe -ExecutionPolicy UnRestricted -NoProfile -Command ".\\PerfInsights.ps1 -NoGui -Scenario vmslow -TracingDuration 30"

    <span data-ttu-id="71524-352">Pokud chcete PerfInsights spouštět v bezobslužném režimu, použijte **- AcceptDisclaimerAndShareDiagnostics** parametr.</span><span class="sxs-lookup"><span data-stu-id="71524-352">If you want PerfInsights to run in silent mode, use the **-AcceptDisclaimerAndShareDiagnostics** parameter.</span></span> <span data-ttu-id="71524-353">Například použijte následující příkaz:</span><span class="sxs-lookup"><span data-stu-id="71524-353">For example, use the following command:</span></span>

        powershell.exe -ExecutionPolicy UnRestricted -NoProfile -Command ".\\PerfInsights.ps1 -NoGui -Scenario vmslow -TracingDuration 30 -AcceptDisclaimerAndShareDiagnostics"

### <a name="how-do-i-troubleshoot-issues-while-running-the-script"></a><span data-ttu-id="71524-354">Jak řešit problémy při spouštění skriptu?</span><span class="sxs-lookup"><span data-stu-id="71524-354">How do I troubleshoot issues while running the script?</span></span>

<span data-ttu-id="71524-355">Pokud skript ukončí neobvyklým způsobem, můžete vyčistit nekonzistentním stavu spuštěním skriptu společně s přepínačem-čištění následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="71524-355">If the script terminates abnormally, you can clean up an inconsistent state by running the script together with the -Cleanup switch, as follows:</span></span>

    powershell.exe -ExecutionPolicy UnRestricted -NoProfile -Command ".\\PerfInsights.ps1 -Cleanup"

<span data-ttu-id="71524-356">Pokud všechny problémy, ke kterým došlo během automatické zjišťování dočasné jednotce, může být vyzvání k vyberte jednotky (výchozí jednotce je D).</span><span class="sxs-lookup"><span data-stu-id="71524-356">If any problems occur during the automatic detection of the temporary drive, you might be prompted to select the drive (the default drive is D).</span></span>

![Zadejte jednotku](media/how-to-use-perfInsights/enter-drive.png)

<span data-ttu-id="71524-358">Skript odinstaluje nástroj nástroje a odebere dočasné složky.</span><span class="sxs-lookup"><span data-stu-id="71524-358">The script uninstalls the utility tools and removes temporary folders.</span></span>

### <a name="troubleshooting-other-script-issues"></a><span data-ttu-id="71524-359">Řešení potíží s další problémy skriptu</span><span class="sxs-lookup"><span data-stu-id="71524-359">Troubleshooting other script issues</span></span> 

<span data-ttu-id="71524-360">Dojde-li potíže při spuštění skriptu, stiskněte kombinaci kláves Ctrl + C přerušení provádění skriptu.</span><span class="sxs-lookup"><span data-stu-id="71524-360">If any problems occur when you run the script, press Ctrl+C to interrupt the script execution.</span></span> <span data-ttu-id="71524-361">Chcete-li odebrat dočasné objekty, najdete v části "Vyčištění po abnormální ukončení".</span><span class="sxs-lookup"><span data-stu-id="71524-361">To remove temporary objects, see the "Clean up after abnormal termination" section.</span></span>

<span data-ttu-id="71524-362">Pokud nadále dochází k selhání skriptu ani po několika pokusech, doporučujeme, abyste spusťte skript v "režimu ladění" pomocí "-Debug" parametr možnost při spuštění.</span><span class="sxs-lookup"><span data-stu-id="71524-362">If you continue to experience script failure even after several attempts, we recommend that you run the script in "debug mode" by using the "-Debug" parameter option on startup.</span></span>

<span data-ttu-id="71524-363">Po dojde k selhání, zkopírujte úplný výstup konzoly prostředí PowerShell a odeslat do agenta nástroje Microsoft Support, který pomáhá vám pomoci při řešení problému.</span><span class="sxs-lookup"><span data-stu-id="71524-363">After the failure occurs, copy the full output of the PowerShell console, and send it to the Microsoft Support agent who is assisting you to help troubleshoot the problem.</span></span>

### <a name="how-do-i-run-the-script-in-custom-configuration-mode"></a><span data-ttu-id="71524-364">Jak spustit skript v režimu vlastní konfigurace?</span><span class="sxs-lookup"><span data-stu-id="71524-364">How do I run the script in custom configuration mode?</span></span>

<span data-ttu-id="71524-365">Výběrem **vlastní** konfigurace, můžete povolit několik trasování paralelně (použijte posunu vícenásobným výběrem):</span><span class="sxs-lookup"><span data-stu-id="71524-365">By selecting the **Custom** configuration, you can enable several traces in parallel (use Shift to multi-select):</span></span>

![Vyberte scénáře](media/how-to-use-perfInsights/select-scenario.png)

<span data-ttu-id="71524-367">Když vyberete diagnostiku výkonu, trasování čítače výkonu, trasování XPerf, síťové trasování nebo scénářů, Storport trasování, postupujte podle pokynů v dialogových oknech a pokuste se znovu provést problémy s pomalým výkonem po spuštění trasování.</span><span class="sxs-lookup"><span data-stu-id="71524-367">When you select the Performance Diagnostics, Performance Counter Trace, XPerf Trace, Network Trace, or Storport Trace scenarios, follow the instructions in the dialog boxes, and try to reproduce the slow performance issue after you start the traces.</span></span>

<span data-ttu-id="71524-368">Následující dialogové okno umožňuje spustit trasování:</span><span class="sxs-lookup"><span data-stu-id="71524-368">The following dialog box lets you start a trace:</span></span>

![Spuštění trasování](media/how-to-use-perfInsights/start-trace-message.png)

<span data-ttu-id="71524-370">Chcete-li zastavit trasování, budete muset potvrzení příkazu v dialogovém okně druhý.</span><span class="sxs-lookup"><span data-stu-id="71524-370">To stop the traces, you have to confirm the command in a second dialog box.</span></span>

<span data-ttu-id="71524-371">![Zastavit trasování](media/how-to-use-perfInsights/stop-trace-message.png)
![Zastavit trasování](media/how-to-use-perfInsights/ok-trace-message.png)</span><span class="sxs-lookup"><span data-stu-id="71524-371">![stop-trace](media/how-to-use-perfInsights/stop-trace-message.png)
![stop-trace](media/how-to-use-perfInsights/ok-trace-message.png)</span></span>

<span data-ttu-id="71524-372">Po dokončení trasování nebo operací se generuje nový soubor ve D:\\protokolu\_kolekce (nebo dočasné jednotce) s názvem **CollectedData\_rrrr MM-dd\_hh\_mm\_ss.zip.**</span><span class="sxs-lookup"><span data-stu-id="71524-372">When the traces or operations are completed, a new file is generated in D:\\log\_collection (or the temporary drive) that is named **CollectedData\_yyyy-MM-dd\_hh\_mm\_ss.zip.**</span></span> <span data-ttu-id="71524-373">Tento soubor můžete odeslat do agenta podporu pro analýzu.</span><span class="sxs-lookup"><span data-stu-id="71524-373">You can send this file to the Support agent for analysis.</span></span>

## <a name="review-the-diagnostics-report-created-by-perfinsights"></a><span data-ttu-id="71524-374">Zkontrolujte sestavu diagnostiky vytvořené PerfInsights</span><span class="sxs-lookup"><span data-stu-id="71524-374">Review the diagnostics report created by PerfInsights</span></span>

<span data-ttu-id="71524-375">V rámci **CollectedData\_rrrr MM-dd\_hh\_mm\_ss.zip soubor** je generován PerfInsights, můžete najít s podrobnými informacemi o zjištění PerfInsights sestavu ve formátu HTML.</span><span class="sxs-lookup"><span data-stu-id="71524-375">Within the **CollectedData\_yyyy-MM-dd\_hh\_mm\_ss.zip file,** that is generated by PerfInsights, you can find an HTML report that details the findings of PerfInsights.</span></span> <span data-ttu-id="71524-376">Zkontrolujte sestavu, rozbalte **CollectedData\_rrrr MM-dd\_hh\_mm\_ss.zip** souboru a pak otevřete **PerfInsights Report.html** souboru.</span><span class="sxs-lookup"><span data-stu-id="71524-376">To review the report, expand the **CollectedData\_yyyy-MM-dd\_hh\_mm\_ss.zip** file, and then open the **PerfInsights Report.html** file.</span></span>

<span data-ttu-id="71524-377">Vyberte **zjištění** kartě.</span><span class="sxs-lookup"><span data-stu-id="71524-377">Select the **Findings** tab.</span></span>

![Karta najít](media/how-to-use-perfInsights/findingtab.png)

<span data-ttu-id="71524-379">**Poznámky k**</span><span class="sxs-lookup"><span data-stu-id="71524-379">**Notes**</span></span>

-   <span data-ttu-id="71524-380">Zprávy červeně jsou známé problémy s konfigurací, které může způsobit problémy s výkonem.</span><span class="sxs-lookup"><span data-stu-id="71524-380">Messages in red are known configuration issues that may cause performance issues.</span></span>

-   <span data-ttu-id="71524-381">Upozornění, které představují-optimální konfigurace, které nutně nezpůsobí problémy s výkonem se zprávy žlutě.</span><span class="sxs-lookup"><span data-stu-id="71524-381">Messages in yellow are warnings that represent non-optimal configurations that do not necessarily cause performance issues.</span></span>

-   <span data-ttu-id="71524-382">Zprávy modře jsou pouze informativní příkazy.</span><span class="sxs-lookup"><span data-stu-id="71524-382">Messages in blue are informative statements only.</span></span>

<span data-ttu-id="71524-383">Zkontrolujte odkazy HTTP pro všechny chybové zprávy červeně získat podrobnější informace o zjištění a jak může ovlivnit výkon nebo osvědčené postupy pro výkonu optimalizované konfigurace.</span><span class="sxs-lookup"><span data-stu-id="71524-383">Review the HTTP links for all error messages in red to get more detailed information about the findings and how they can affect the performance or best practices for performance-optimized configurations.</span></span>

### <a name="disk-configuration-tab"></a><span data-ttu-id="71524-384">Na kartě Konfigurace disku</span><span class="sxs-lookup"><span data-stu-id="71524-384">Disk Configuration Tab</span></span>

<span data-ttu-id="71524-385">**Přehled** část zobrazuje různé náhledy konfiguraci úložiště, včetně informací z nástroje Diskpart a prostory úložiště</span><span class="sxs-lookup"><span data-stu-id="71524-385">The **Overview** section displays different views of the storage configuration, including information from Diskpart and Storage Spaces</span></span>

<span data-ttu-id="71524-386">**DiskMap** a **VolumeMap** části popisují na hlediska duální jak logické svazky a fyzické disky jsou vzájemně souvisí.</span><span class="sxs-lookup"><span data-stu-id="71524-386">The **DiskMap** and **VolumeMap** sections describe on a dual perspective how logical volumes and physical disks are related to each other.</span></span>

<span data-ttu-id="71524-387">V pohledu fyzický disk (DiskMap) v tabulce jsou uvedeny všechny logické svazky, které běží na disku.</span><span class="sxs-lookup"><span data-stu-id="71524-387">In the PhysicalDisk perspective (DiskMap), the table shows all logical volumes that are running on the disk.</span></span> <span data-ttu-id="71524-388">V následujícím příkladu spustí PhysicalDrive2 2 logické svazků vytvořených na více oddílů (J a H):</span><span class="sxs-lookup"><span data-stu-id="71524-388">In the following example, PhysicalDrive2 runs 2 Logical Volumes created on multiple partitions (J and H):</span></span>

![Karta data](media/how-to-use-perfInsights/disktab.png)

<span data-ttu-id="71524-390">Ve svazku perspektivy (*VolumeMap*), tabulky zobrazují všechny fyzické disky v rámci každé logické svazku.</span><span class="sxs-lookup"><span data-stu-id="71524-390">In the Volume perspective (*VolumeMap*), the tables show all the physical disks under each logical volume.</span></span> <span data-ttu-id="71524-391">Všimněte si, že pro RAID nebo dynamické disky, můžete spustit logický svazek na několik fyzických disků.</span><span class="sxs-lookup"><span data-stu-id="71524-391">Notice that for RAID/Dynamic disks, you might run a logical volume upon multiple physical disks.</span></span> <span data-ttu-id="71524-392">V následující ukázce *C:\\připojit* je přípojný bod nakonfigurovaný jako *SpannedDisk* na PhysicalDisks \#2 a \#3:</span><span class="sxs-lookup"><span data-stu-id="71524-392">In the following sample *C:\\mount* is a mountpoint configured as *SpannedDisk* on PhysicalDisks \#2 and \#3:</span></span>

![Karta svazku](media/how-to-use-perfInsights/volumetab.png)

### <a name="sql-server-tab"></a><span data-ttu-id="71524-394">Karta systému SQL Server</span><span class="sxs-lookup"><span data-stu-id="71524-394">SQL Server tab</span></span>

<span data-ttu-id="71524-395">Pokud cílový počítač hostuje všechny instance systému SQL Server, zobrazí se další karta v sestavě, který je pojmenován **systému SQL Server**:</span><span class="sxs-lookup"><span data-stu-id="71524-395">If the target VM hosts any SQL Server instances, you will see an additional tab in the report that is named **SQL Server**:</span></span>

![Karta SQL](media/how-to-use-perfInsights/sqltab.png)

<span data-ttu-id="71524-397">Tato část obsahuje přehled"" a další dílčí karty pro každou z instance systému SQL Server, který je hostitelem virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="71524-397">This section contains an "Overview" and additional sub tabs for each of the SQL Server instances hosted on the VM.</span></span>

<span data-ttu-id="71524-398">V části "Přehled" obsahuje užitečné tabulku, která shrnuje všechny fyzické disky (systémové a datové disky) se systémem, které obsahují směs datových souborů a souborů protokolů transakci.</span><span class="sxs-lookup"><span data-stu-id="71524-398">The "Overview" section contains a helpful table that summarizes all the physical disks (system and data disks) that are running and that contain a mixture of data files and transaction log files.</span></span>

<span data-ttu-id="71524-399">V následujícím příkladu *PhysicalDrive0* (spouštění jednotka C) se zobrazí, protože jak *modeldev* a *modellog* soubory jsou umístěny na jednotce C a jsou různých typů (jako je datový soubor a transakčního protokolu v uvedeném pořadí):</span><span class="sxs-lookup"><span data-stu-id="71524-399">In the following example, *PhysicalDrive0* (running the C drive) is displayed because both the *modeldev* and *modellog* files are located on the C drive, and they are of different types (such as Data File and Transaction Log, respectively):</span></span>

![LogInfo](media/how-to-use-perfInsights/loginfo.png)

<span data-ttu-id="71524-401">Karty specifické pro instanci systému SQL Server obsahovat obecné oddíl, který zobrazuje základní informace o vybrané instanci a dalších částech rozšířené informace, včetně nastavení, konfigurace a možnosti uživatele.</span><span class="sxs-lookup"><span data-stu-id="71524-401">The SQL Server instance-specific tabs contain a general section that displays basic information about the selected instance and additional sections for advanced information, including Settings, Configurations, and User Options.</span></span>

## <a name="references-to-the-external-tools-used"></a><span data-ttu-id="71524-402">Odkazy na externí nástroje použít</span><span class="sxs-lookup"><span data-stu-id="71524-402">References to the external tools used</span></span>

### <a name="diskspd"></a><span data-ttu-id="71524-403">Nástroje Diskspd</span><span class="sxs-lookup"><span data-stu-id="71524-403">Diskspd</span></span>

<span data-ttu-id="71524-404">DISKSPD je úložiště zatížení generátor a výkon testu nástroj od týmů engineering Windows a Windows Server a Server infrastruktury cloudu.</span><span class="sxs-lookup"><span data-stu-id="71524-404">DISKSPD is a storage load generator and performance test tool from the Windows and Windows Server and Cloud Server Infrastructure engineering teams.</span></span> <span data-ttu-id="71524-405">Další informace najdete v tématu [Diskspd](https://github.com/Microsoft/diskspd).</span><span class="sxs-lookup"><span data-stu-id="71524-405">For more information, see [Diskspd](https://github.com/Microsoft/diskspd).</span></span>

### <a name="xperf"></a><span data-ttu-id="71524-406">XPerf</span><span class="sxs-lookup"><span data-stu-id="71524-406">XPerf</span></span>

<span data-ttu-id="71524-407">XPerf je nástroj příkazového řádku pro zachycení trasování ze sady nástrojů výkonu systému Windows.</span><span class="sxs-lookup"><span data-stu-id="71524-407">Xperf is a command-line tool to capture traces from the Windows Performance Tools Kit.</span></span>

<span data-ttu-id="71524-408">Další informace najdete v tématu [nástrojů výkonu systému Windows – Xperf](https://blogs.msdn.microsoft.com/ntdebugging/2008/04/03/windows-performance-toolkit-xperf/).</span><span class="sxs-lookup"><span data-stu-id="71524-408">For more information, see [Windows Performance Toolkit – Xperf](https://blogs.msdn.microsoft.com/ntdebugging/2008/04/03/windows-performance-toolkit-xperf/).</span></span>

## <a name="next-steps"></a><span data-ttu-id="71524-409">Další kroky</span><span class="sxs-lookup"><span data-stu-id="71524-409">Next Steps</span></span>

### <a name="upload-diagnostics-logs-and-reports-to-microsoft-support-for-further-review"></a><span data-ttu-id="71524-410">Odeslat diagnostické protokoly a sestavy do služby Microsoft Support ke další kontrolu</span><span class="sxs-lookup"><span data-stu-id="71524-410">Upload diagnostics logs and reports to Microsoft Support for further review</span></span>

<span data-ttu-id="71524-411">Při práci s zaměstnancům společnosti Microsoft Support, můžete být vyzváni k přenosu výstupu, který je generován PerfInsights pomůže proces řešení potíží.</span><span class="sxs-lookup"><span data-stu-id="71524-411">When you work with the Microsoft Support staff, you may be requested to transmit the output that is generated by PerfInsights to assist the troubleshooting process.</span></span>

<span data-ttu-id="71524-412">Podpora agenta pro vytvoření pracovního prostoru DTM a obdržíte e-mailovou zprávu, která obsahuje odkaz [DTM portálu (https://filetransfer.support.microsoft.com/EFTClient/Account/Login.htm) a jedinečné ID uživatele a heslo.</span><span class="sxs-lookup"><span data-stu-id="71524-412">The Support agent will create a DTM workspace for you, and you will receive an email message that includes a link to the [DTM portal (https://filetransfer.support.microsoft.com/EFTClient/Account/Login.htm) and a unique user ID and password.</span></span>

<span data-ttu-id="71524-413">Tato zpráva bude odeslána z **CTS automatizovaná diagnostiky služba** (ctsadiag@microsoft.com).</span><span class="sxs-lookup"><span data-stu-id="71524-413">This message will be sent from **CTS Automated Diagnostics Services** (ctsadiag@microsoft.com).</span></span>

![Ukázka zprávy](media/how-to-use-perfInsights/supportemail.png)

<span data-ttu-id="71524-415">Za účelem zvýšení zabezpečení bude nutné změnit heslo při prvním použití.</span><span class="sxs-lookup"><span data-stu-id="71524-415">For additional security, you will be required to change your password on first use.</span></span>

<span data-ttu-id="71524-416">Po přihlášení do DTM zjistíte, dialogové okno pro odeslání **CollectedData\_rrrr MM-dd\_hh\_mm\_ss.zip** soubor, který byl shromážděný nástrojem PerfInsights.</span><span class="sxs-lookup"><span data-stu-id="71524-416">After you log in to DTM, you will find a dialog box to upload the **CollectedData\_yyyy-MM-dd\_hh\_mm\_ss.zip** file that was collected by PerfInsights.</span></span>
