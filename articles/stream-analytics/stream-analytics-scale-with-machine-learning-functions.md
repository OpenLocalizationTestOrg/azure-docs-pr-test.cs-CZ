---
title: "Úlohy škálování s Azure Stream Analytics & AzureML funkce | Microsoft Docs"
description: "Zjistěte, jak se správně škálovat úlohy Stream Analytics (rozdělení do oddílů, SU množství a více) při použití funkce Azure Machine Learning."
keywords: 
documentationcenter: 
services: stream-analytics
author: jeffstokes72
manager: jhubbard
editor: cgronlun
ms.assetid: 47ce7c5e-1de1-41ca-9a26-b5ecce814743
ms.service: stream-analytics
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-services
ms.date: 03/28/2017
ms.author: jeffstok
ms.openlocfilehash: 5e07e4efcd14cd8c12124cb34058ef6c345f7f47
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/29/2017
---
# <a name="scale-your-stream-analytics-job-with-azure-machine-learning-functions"></a><span data-ttu-id="1d38c-103">Škálovat vaše úloha Stream Analytics s funkcemi Azure Machine Learning</span><span class="sxs-lookup"><span data-stu-id="1d38c-103">Scale your Stream Analytics job with Azure Machine Learning functions</span></span>
<span data-ttu-id="1d38c-104">Často je poměrně snadné ho nastavit úlohu služby Stream Analytics a procházely ukázková data.</span><span class="sxs-lookup"><span data-stu-id="1d38c-104">It is often quite easy to set up an Stream Analytics job and run some sample data through it.</span></span> <span data-ttu-id="1d38c-105">Co můžeme dělat, když budeme potřebovat spuštění stejné úlohy s vyšší datový svazek?</span><span class="sxs-lookup"><span data-stu-id="1d38c-105">What should we do when we need to run the same job with higher data volume?</span></span> <span data-ttu-id="1d38c-106">To vyžaduje nám pochopit, jak nakonfigurovat úlohy služby Stream Analytics tak, aby bude škálovat.</span><span class="sxs-lookup"><span data-stu-id="1d38c-106">It requires us to understand how to configure the Stream Analytics job so that it will scale.</span></span> <span data-ttu-id="1d38c-107">V tomto dokumentu se zaměříme na zvláštní aspekty škálování úlohy Stream Analytics s funkcemi, Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="1d38c-107">In this document, we will focus on the special aspects of scaling Stream Analytics jobs with Machine Learning functions.</span></span> <span data-ttu-id="1d38c-108">Informace o tom, jak obecně škálování úlohy Stream Analytics najdete v článku [škálování úlohy](stream-analytics-scale-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="1d38c-108">For information on how to scale Stream Analytics jobs in general see the article [Scaling jobs](stream-analytics-scale-jobs.md).</span></span>

## <a name="what-is-an-azure-machine-learning-function-in-stream-analytics"></a><span data-ttu-id="1d38c-109">Co je Azure Machine Learning funkce v Stream Analytics?</span><span class="sxs-lookup"><span data-stu-id="1d38c-109">What is an Azure Machine Learning function in Stream Analytics?</span></span>
<span data-ttu-id="1d38c-110">Funkce Machine Learning v Stream Analytics lze použít jako normální funkce volání v jazyce dotaz služby Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="1d38c-110">A Machine Learning function in Stream Analytics can be used like a regular function call in the Stream Analytics query language.</span></span> <span data-ttu-id="1d38c-111">Ale za scény, volání funkce je ve skutečnosti žádostí o webové službě Azure Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="1d38c-111">However, behind the scene, the function calls are actually Azure Machine Learning Web Service requests.</span></span> <span data-ttu-id="1d38c-112">Webové služby Machine Learning podporovat "dávkování" více řádků, která se nazývá zkrácená batch, ve stejném volání webové služby rozhraní API, ke zlepšení celkovou propustnost.</span><span class="sxs-lookup"><span data-stu-id="1d38c-112">Machine Learning web services support “batching” multiple rows, which is called mini-batch, in the same web service API call, to improve overall throughput.</span></span> <span data-ttu-id="1d38c-113">Podrobnosti najdete v následujících článcích podrobnosti; [Funkce azure Machine Learning v Stream Analytics](https://blogs.technet.microsoft.com/machinelearning/2015/12/10/azure-ml-now-available-as-a-function-in-azure-stream-analytics/) a [webové služby Azure Machine Learning](../machine-learning/machine-learning-consume-web-services.md).</span><span class="sxs-lookup"><span data-stu-id="1d38c-113">Please see the following articles for more details; [Azure Machine Learning functions in Stream Analytics](https://blogs.technet.microsoft.com/machinelearning/2015/12/10/azure-ml-now-available-as-a-function-in-azure-stream-analytics/) and [Azure Machine Learning Web Services](../machine-learning/machine-learning-consume-web-services.md).</span></span>

## <a name="configure-a-stream-analytics-job-with-machine-learning-functions"></a><span data-ttu-id="1d38c-114">Úloha Stream Analytics nakonfigurovat funkce Machine Learning</span><span class="sxs-lookup"><span data-stu-id="1d38c-114">Configure a Stream Analytics job with Machine Learning functions</span></span>
<span data-ttu-id="1d38c-115">Při konfiguraci funkce Machine Learning úlohy Stream Analytics, existují dva parametry vzít v úvahu, velikost dávky volání funkce Machine Learning a jednotky streamování (SUs) zřízené pro úlohu služby Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="1d38c-115">When configuring a Machine Learning function for Stream Analytics job, there are two parameters to consider, the batch size of the Machine Learning function calls, and the streaming units (SUs) provisioned for the Stream Analytics job.</span></span> <span data-ttu-id="1d38c-116">Pokud chcete zjistit, na odpovídající hodnoty pro tyto, nejprve musí být přijato rozhodnutí mezi latence a propustnosti, tedy latence úlohy služby Stream Analytics a propustnost každý SU.</span><span class="sxs-lookup"><span data-stu-id="1d38c-116">To determine the appropriate values for these, first a decision must be made between latency and throughput, that is, latency of the Stream Analytics job, and throughput of each SU.</span></span> <span data-ttu-id="1d38c-117">Služba SUs mohou být přidány do úlohu chcete zvýšit propustnost dobře oddílů dotazu Stream Analytics, vždy, i když další služby SUs zvyšuje náklady na provozování úlohy.</span><span class="sxs-lookup"><span data-stu-id="1d38c-117">SUs may always be added to a job to increase throughput of a well partitioned Stream Analytics query, although additional SUs increases the cost of running the job.</span></span>

<span data-ttu-id="1d38c-118">Proto je důležité určit *tolerance* latence ve spuštění úlohy Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="1d38c-118">Therefore it is important to determine the *tolerance* of latency in running a Stream Analytics job.</span></span> <span data-ttu-id="1d38c-119">Další spuštění žádosti o služby Azure Machine Learning zvýší se latence přirozeně s velikost dávky, která bude složené latence úlohu služby Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="1d38c-119">Additional latency from running Azure Machine Learning service requests will naturally increase with batch size, which will compound the latency of the Stream Analytics job.</span></span> <span data-ttu-id="1d38c-120">Na druhé straně zvýšit velikost dávky umožňuje úlohu služby Stream Analytics ke zpracování * další události s *stejné číslo* nástroje Machine Learning webové žádosti o služby.</span><span class="sxs-lookup"><span data-stu-id="1d38c-120">On the other hand, increasing batch size allows the Stream Analytics job to process *more events with the *same number* of Machine Learning web service requests.</span></span> <span data-ttu-id="1d38c-121">Zvýšení Machine Learning webové služby latence je často dílčí lineární se zvýšení velikost dávky, proto je důležité vzít v úvahu nejvíce cenově efektivní velikost dávky pro webové služby Machine Learning v jakékoliv jiné situaci s danou.</span><span class="sxs-lookup"><span data-stu-id="1d38c-121">Often the increase of Machine Learning web service latency is sub-linear to the increase of batch size so it is important to consider the most cost-efficient batch size for a Machine Learning web service in any given situation.</span></span> <span data-ttu-id="1d38c-122">Výchozí velikost dávky pro webovou službu požadavky je 1000 a může být změněno buď pomocí [Stream Analytics REST API](https://msdn.microsoft.com/library/mt653706.aspx "Stream Analytics REST API") nebo [klienta PowerShell pro Stream Analytics](stream-analytics-monitor-and-manage-jobs-use-powershell.md "klienta PowerShell pro Stream Analytics").</span><span class="sxs-lookup"><span data-stu-id="1d38c-122">The default batch size for the web service requests is 1000 and may be modified either by using the [Stream Analytics REST API](https://msdn.microsoft.com/library/mt653706.aspx "Stream Analytics REST API") or the [PowerShell client for Stream Analytics](stream-analytics-monitor-and-manage-jobs-use-powershell.md "PowerShell client for Stream Analytics").</span></span>

<span data-ttu-id="1d38c-123">Po zjištění velikost dávky množství streamování jednotky (SUs) může být určené, podle počtu událostí, které potřebuje funkce procesů za sekundu.</span><span class="sxs-lookup"><span data-stu-id="1d38c-123">Once a batch size has been determined, the amount of streaming units (SUs) can be determined, based on the number of events that the function needs to process per second.</span></span> <span data-ttu-id="1d38c-124">Další informace o jednotky streamování najdete v tématu [škálování úlohy Stream Analytics](stream-analytics-scale-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="1d38c-124">For more information about streaming units, see [Stream Analytics scale jobs](stream-analytics-scale-jobs.md).</span></span>

<span data-ttu-id="1d38c-125">Obecně platí je 20 souběžných připojení k webové službě Machine Learning pro každých 6 služby SUs s tím rozdílem, že 1 SU úlohy a úlohy 3 SU získají 20 souběžných připojení také.</span><span class="sxs-lookup"><span data-stu-id="1d38c-125">In general, there are 20 concurrent connections to the Machine Learning web service for every 6 SUs, except that 1 SU jobs and 3 SU jobs will get 20 concurrent connections also.</span></span>  <span data-ttu-id="1d38c-126">Například pokud míra vstupních dat je 200 000 událostí za sekundu a velikost dávky je ponecháno na výchozí hodnotu 1 000 výsledné latence webové služby pomocí služby batch zkrácená 1000 událostí je 200 MS.</span><span class="sxs-lookup"><span data-stu-id="1d38c-126">For example, if the input data rate is 200,000 events per second and the batch size is left to the default of 1000 the resulting web service latency with 1000 events mini-batch is 200ms.</span></span> <span data-ttu-id="1d38c-127">To znamená, že každé připojení provádět 5 požadavky k webové službě Machine Learning za sekundu.</span><span class="sxs-lookup"><span data-stu-id="1d38c-127">This means every connection can make 5 requests to the Machine Learning web service in a second.</span></span> <span data-ttu-id="1d38c-128">S 20 připojení může úloha Stream Analytics zpracovat 20 000 událostí ve 200 MS a proto 100 000 událostí za sekundu.</span><span class="sxs-lookup"><span data-stu-id="1d38c-128">With 20 connections, the Stream Analytics job can process 20,000 events in 200ms  and therefore 100,000 events in a second.</span></span> <span data-ttu-id="1d38c-129">Proto při zpracování 200 000 událostí za sekundu, úlohu služby Stream Analytics musí 40 souběžných připojení, která dodává se 12 služby SUS.</span><span class="sxs-lookup"><span data-stu-id="1d38c-129">So to process 200,000 events per second, the Stream Analytics job needs 40 concurrent connections, which comes out to 12 SUs.</span></span> <span data-ttu-id="1d38c-130">Následující obrázek znázorňuje žádosti z úlohy Stream Analytics, které chcete koncový bod webové služby Machine Learning – každých 6 SUs má 20 souběžných připojení k webové službě Machine Learning na maximum.</span><span class="sxs-lookup"><span data-stu-id="1d38c-130">The diagram below illustrates the requests from the Stream Analytics job to the Machine Learning web service endpoint – Every 6 SUs has 20 concurrent connections to Machine Learning web service at max.</span></span>

<span data-ttu-id="1d38c-131">![Škálování služby Stream Analytics se Machine Learning funkce 2 úlohy příklad](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-00.png "škálování Stream Analytics příklad úlohy Machine Learning funkce 2")</span><span class="sxs-lookup"><span data-stu-id="1d38c-131">![Scale Stream Analytics with Machine Learning Functions 2 job example](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-00.png "Scale Stream Analytics with Machine Learning Functions 2 job example")</span></span>

<span data-ttu-id="1d38c-132">Obecně platí ***B*** pro velikost dávky ***L*** pro webové služby s latencí na velikost dávky B v milisekundách, propustnost Stream Analytics úlohy s ***N*** služby SUs je:</span><span class="sxs-lookup"><span data-stu-id="1d38c-132">In general, ***B*** for batch size, ***L*** for the web service latency at batch size B in milliseconds, the throughput of an Stream Analytics job with ***N*** SUs is:</span></span>

<span data-ttu-id="1d38c-133">![Škálování služby Stream Analytics s Machine Learning funkce vzorec](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-02.png "škálování služby Stream Analytics s vzorec funkce Machine Learning")</span><span class="sxs-lookup"><span data-stu-id="1d38c-133">![Scale Stream Analytics with Machine Learning Functions Formula](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-02.png "Scale Stream Analytics with Machine Learning Functions Formula")</span></span>

<span data-ttu-id="1d38c-134">Další aspekt mohou být 'maximální počet souběžných volání' na straně webové služby Machine Learning, se doporučuje tuto možnost nastavíte na maximální hodnotu (aktuálně 200).</span><span class="sxs-lookup"><span data-stu-id="1d38c-134">An additional consideration may be the 'max concurrent calls' on the Machine Learning web service side, it’s recommended to set this to the maximum value (200 currently).</span></span>

<span data-ttu-id="1d38c-135">Další informace o tomto nastavení najdete [škálování najdete v článku webové služby Machine Learning](../machine-learning/machine-learning-scaling-webservice.md).</span><span class="sxs-lookup"><span data-stu-id="1d38c-135">For more information on this setting please review the [Scaling article for Machine Learning Web Services](../machine-learning/machine-learning-scaling-webservice.md).</span></span>

## <a name="example--sentiment-analysis"></a><span data-ttu-id="1d38c-136">Příklad – postojích analýzy</span><span class="sxs-lookup"><span data-stu-id="1d38c-136">Example – Sentiment Analysis</span></span>
<span data-ttu-id="1d38c-137">Následující příklad obsahuje úlohy Stream Analytics s analýzou postojích funkce Machine Learning, jak je popsáno v [Stream Analytics Machine Learning integrace kurzu](stream-analytics-machine-learning-integration-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="1d38c-137">The following example includes a Stream Analytics job with the sentiment analysis Machine Learning function, as described in the [Stream Analytics Machine Learning integration tutorial](stream-analytics-machine-learning-integration-tutorial.md).</span></span>

<span data-ttu-id="1d38c-138">Dotaz je jednoduchý plně oddíly dotazu, za nímž následuje **postojích** fungovat, jak je uvedeno níže:</span><span class="sxs-lookup"><span data-stu-id="1d38c-138">The query is a simple fully partitioned query followed by the **sentiment** function, as shown below:</span></span>

    WITH subquery AS (
        SELECT text, sentiment(text) as result from input
    )

    Select text, result.[Score]
    Into output
    From subquery

<span data-ttu-id="1d38c-139">Vezměte v úvahu následující scénář; s propustností 10 000 tweetů za sekundu úloha Stream Analytics musí být vytvořený provést analýzu postojích tweetů (událostí).</span><span class="sxs-lookup"><span data-stu-id="1d38c-139">Consider the following scenario; with a throughput of 10,000 tweets per second a Stream Analytics job must be created to perform sentiment analysis of the tweets (events).</span></span> <span data-ttu-id="1d38c-140">Pomocí 1 SU, může tato úloha Stream Analytics moci provoz zvládla?</span><span class="sxs-lookup"><span data-stu-id="1d38c-140">Using 1 SU, could this Stream Analytics job be able to handle the traffic?</span></span> <span data-ttu-id="1d38c-141">Pomocí výchozí velikost dávky 1000 by mohli udržovat tempo s vstupu úlohy.</span><span class="sxs-lookup"><span data-stu-id="1d38c-141">Using the default batch size of 1000 the job should be able to keep up with the input.</span></span> <span data-ttu-id="1d38c-142">Další přidané funkce Machine Learning má více než jedna sekunda latence, což je obecný generovat výchozí latence postojích analýzy webové službě Machine Learning (s výchozí velikost dávky 1000).</span><span class="sxs-lookup"><span data-stu-id="1d38c-142">Further the added Machine Learning function should generate no more than a second of latency, which is the general default latency of the sentiment analysis Machine Learning web service (with a default batch size of 1000).</span></span> <span data-ttu-id="1d38c-143">Úloha Stream Analytics **celkové** nebo latence začátku do konce by obvykle na několik sekund.</span><span class="sxs-lookup"><span data-stu-id="1d38c-143">The Stream Analytics job’s **overall** or end-to-end latency would typically be a few seconds.</span></span> <span data-ttu-id="1d38c-144">Podrobnější podívejte se do této úlohy Stream Analytics *zejména* volání funkce Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="1d38c-144">Take a more detailed look into this Stream Analytics job, *especially* the Machine Learning function calls.</span></span> <span data-ttu-id="1d38c-145">Velikost dávky s jako 1000, propustnost 10 000 událostí, které bude trvat asi 10 žádosti webové služby.</span><span class="sxs-lookup"><span data-stu-id="1d38c-145">Having the batch size as 1000, a throughput of 10,000 events will take about 10 requests to web service.</span></span> <span data-ttu-id="1d38c-146">I když 1 SU jsou dostatečný počet souběžných připojení přizpůsobená tento vstupní provoz.</span><span class="sxs-lookup"><span data-stu-id="1d38c-146">Even with 1 SU, there are enough concurrent connections to accommodate this input traffic.</span></span>

<span data-ttu-id="1d38c-147">Ale co když rychlost těchto událostí vstupní zvyšuje úroveň 100 x a teď je potřeba úlohu služby Stream Analytics ke zpracování 1 000 000 tweetů za sekundu?</span><span class="sxs-lookup"><span data-stu-id="1d38c-147">But what if the input event rate increases by 100x and now the Stream Analytics job needs to process 1,000,000 tweets per second?</span></span> <span data-ttu-id="1d38c-148">Existují dvě možnosti:</span><span class="sxs-lookup"><span data-stu-id="1d38c-148">There are two options:</span></span>

1. <span data-ttu-id="1d38c-149">Zvětšete velikost dávky, nebo</span><span class="sxs-lookup"><span data-stu-id="1d38c-149">Increase the batch size, or</span></span>
2. <span data-ttu-id="1d38c-150">Oddíl vstupního datového proudu se zpracovat události paralelně</span><span class="sxs-lookup"><span data-stu-id="1d38c-150">Partition the input stream to process the events in parallel</span></span>

<span data-ttu-id="1d38c-151">S parametrem první úlohu **latence** zvýší.</span><span class="sxs-lookup"><span data-stu-id="1d38c-151">With the first option, the job **latency** will increase.</span></span>

<span data-ttu-id="1d38c-152">Druhá možnost se další služby SUs by nutné zřídit a proto generovat více souběžných žádosti webové služby Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="1d38c-152">With the second option, more SUs would need to be provisioned and therefore generate more concurrent Machine Learning web service requests.</span></span> <span data-ttu-id="1d38c-153">To znamená úlohu **náklady** zvýší.</span><span class="sxs-lookup"><span data-stu-id="1d38c-153">This means the job **cost** will increase.</span></span>

<span data-ttu-id="1d38c-154">Předpokládá, že latence postojích analýzy webové službě Machine Learning je 200 MS pro dávky 1000 událostí nebo níže 250ms pro dávky 5 000 událostí, 300ms pro dávky 10 000 událostí nebo 500ms pro dávky 25 000 událostí.</span><span class="sxs-lookup"><span data-stu-id="1d38c-154">Assume the latency of the sentiment analysis Machine Learning web service is 200ms for 1000-event batches or below, 250ms for 5,000-event batches, 300ms for 10,000-event batches or 500ms for 25,000-event batches.</span></span>

1. <span data-ttu-id="1d38c-155">Pomocí možnosti první (**není** zřizování další služby SUs), velikost dávky by mohla být zvýšena na **25 000**.</span><span class="sxs-lookup"><span data-stu-id="1d38c-155">Using the first option, (**not** provisioning more SUs), the batch size could be increased to **25,000**.</span></span> <span data-ttu-id="1d38c-156">To zase umožní úlohu pro zpracování 1 000 000 událostí s 20 souběžných připojení k webové službě Machine Learning (s latencí 500ms za hovor).</span><span class="sxs-lookup"><span data-stu-id="1d38c-156">This in turn would allow the job to process 1,000,000 events with 20 concurrent connections to the Machine Learning web service (with a latency of 500ms per call).</span></span> <span data-ttu-id="1d38c-157">Tak další latence úlohu služby Stream Analytics z důvodu požadavků funkce postojích na žádosti webové služby Machine Learning by být zvýšena z **200 MS** k **500ms**.</span><span class="sxs-lookup"><span data-stu-id="1d38c-157">So the additional latency of the Stream Analytics job due to the sentiment function requests against the Machine Learning web service requests would be increased from **200ms** to **500ms**.</span></span> <span data-ttu-id="1d38c-158">Uvědomte si však, že velikost dávky **nelze** zvýší nekonečnou strojového učení webové služby vyžaduje, aby velikost datové části žádosti o 4 MB volného místa nebo menší časový limit po 100 sekundách operace žádosti o webovou službu.</span><span class="sxs-lookup"><span data-stu-id="1d38c-158">However, note that batch size **cannot** be increased infinitely as the Machine Learning web services requires the payload size of a request be 4MB or smaller web service requests timeout after 100 seconds of operation.</span></span>
2. <span data-ttu-id="1d38c-159">Pomocí druhou možnost, velikost dávky je ponechány na 1000, s 200 MS webové služby latencí, každých 20 souběžných připojení k webové službě, budou moci události procesu 1000 * 20 * 5 = 100 000 za sekundu.</span><span class="sxs-lookup"><span data-stu-id="1d38c-159">Using the second option, the batch size is left at 1000, with 200ms web service latency, every 20 concurrent connections to the web service would be able to process 1000 * 20 * 5 events = 100,000 per second.</span></span> <span data-ttu-id="1d38c-160">Ke zpracování 1 000 000 událostí za sekundu, takže úlohy by měli 60 služby SUs.</span><span class="sxs-lookup"><span data-stu-id="1d38c-160">So to process 1,000,000 events per second, the job would need 60 SUs.</span></span> <span data-ttu-id="1d38c-161">Úlohy služby Stream Analytics by ve srovnání s první možnost, zkontrolujte další žádosti webové služby batch, zase generování vyšší náklady.</span><span class="sxs-lookup"><span data-stu-id="1d38c-161">Compared to the first option, Stream Analytics job would make more web service batch requests, in turn generating an increased cost.</span></span>

<span data-ttu-id="1d38c-162">Níže je tabulka pro propustnost úlohu služby Stream Analytics pro různé služby SUs a velikostí dávky (v počtu událostí za sekundu).</span><span class="sxs-lookup"><span data-stu-id="1d38c-162">Below is a table for the throughput of the Stream Analytics job for different SUs and batch sizes (in number of events per second).</span></span>

| <span data-ttu-id="1d38c-163">velikost dávky (ML latence)</span><span class="sxs-lookup"><span data-stu-id="1d38c-163">batch size (ML latency)</span></span> | <span data-ttu-id="1d38c-164">500 (200 MS)</span><span class="sxs-lookup"><span data-stu-id="1d38c-164">500 (200ms)</span></span> | <span data-ttu-id="1d38c-165">1 000 (200 MS)</span><span class="sxs-lookup"><span data-stu-id="1d38c-165">1,000 (200ms)</span></span> | <span data-ttu-id="1d38c-166">5 000 (250ms)</span><span class="sxs-lookup"><span data-stu-id="1d38c-166">5,000 (250ms)</span></span> | <span data-ttu-id="1d38c-167">10 000 (300ms)</span><span class="sxs-lookup"><span data-stu-id="1d38c-167">10,000 (300ms)</span></span> | <span data-ttu-id="1d38c-168">25 000 (500ms)</span><span class="sxs-lookup"><span data-stu-id="1d38c-168">25,000 (500ms)</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="1d38c-169">**1 SU**</span><span class="sxs-lookup"><span data-stu-id="1d38c-169">**1 SU**</span></span> |<span data-ttu-id="1d38c-170">2,500</span><span class="sxs-lookup"><span data-stu-id="1d38c-170">2,500</span></span> |<span data-ttu-id="1d38c-171">5,000</span><span class="sxs-lookup"><span data-stu-id="1d38c-171">5,000</span></span> |<span data-ttu-id="1d38c-172">20,000</span><span class="sxs-lookup"><span data-stu-id="1d38c-172">20,000</span></span> |<span data-ttu-id="1d38c-173">30,000</span><span class="sxs-lookup"><span data-stu-id="1d38c-173">30,000</span></span> |<span data-ttu-id="1d38c-174">50,000</span><span class="sxs-lookup"><span data-stu-id="1d38c-174">50,000</span></span> |
| <span data-ttu-id="1d38c-175">**3 služby SUs**</span><span class="sxs-lookup"><span data-stu-id="1d38c-175">**3 SUs**</span></span> |<span data-ttu-id="1d38c-176">2,500</span><span class="sxs-lookup"><span data-stu-id="1d38c-176">2,500</span></span> |<span data-ttu-id="1d38c-177">5,000</span><span class="sxs-lookup"><span data-stu-id="1d38c-177">5,000</span></span> |<span data-ttu-id="1d38c-178">20,000</span><span class="sxs-lookup"><span data-stu-id="1d38c-178">20,000</span></span> |<span data-ttu-id="1d38c-179">30,000</span><span class="sxs-lookup"><span data-stu-id="1d38c-179">30,000</span></span> |<span data-ttu-id="1d38c-180">50,000</span><span class="sxs-lookup"><span data-stu-id="1d38c-180">50,000</span></span> |
| <span data-ttu-id="1d38c-181">**6 služby SUs**</span><span class="sxs-lookup"><span data-stu-id="1d38c-181">**6 SUs**</span></span> |<span data-ttu-id="1d38c-182">2,500</span><span class="sxs-lookup"><span data-stu-id="1d38c-182">2,500</span></span> |<span data-ttu-id="1d38c-183">5,000</span><span class="sxs-lookup"><span data-stu-id="1d38c-183">5,000</span></span> |<span data-ttu-id="1d38c-184">20,000</span><span class="sxs-lookup"><span data-stu-id="1d38c-184">20,000</span></span> |<span data-ttu-id="1d38c-185">30,000</span><span class="sxs-lookup"><span data-stu-id="1d38c-185">30,000</span></span> |<span data-ttu-id="1d38c-186">50,000</span><span class="sxs-lookup"><span data-stu-id="1d38c-186">50,000</span></span> |
| <span data-ttu-id="1d38c-187">**12 služby SUs**</span><span class="sxs-lookup"><span data-stu-id="1d38c-187">**12 SUs**</span></span> |<span data-ttu-id="1d38c-188">5,000</span><span class="sxs-lookup"><span data-stu-id="1d38c-188">5,000</span></span> |<span data-ttu-id="1d38c-189">10 000</span><span class="sxs-lookup"><span data-stu-id="1d38c-189">10,000</span></span> |<span data-ttu-id="1d38c-190">40,000</span><span class="sxs-lookup"><span data-stu-id="1d38c-190">40,000</span></span> |<span data-ttu-id="1d38c-191">60,000</span><span class="sxs-lookup"><span data-stu-id="1d38c-191">60,000</span></span> |<span data-ttu-id="1d38c-192">100,000</span><span class="sxs-lookup"><span data-stu-id="1d38c-192">100,000</span></span> |
| <span data-ttu-id="1d38c-193">**18 služby SUs**</span><span class="sxs-lookup"><span data-stu-id="1d38c-193">**18 SUs**</span></span> |<span data-ttu-id="1d38c-194">7,500</span><span class="sxs-lookup"><span data-stu-id="1d38c-194">7,500</span></span> |<span data-ttu-id="1d38c-195">15,000</span><span class="sxs-lookup"><span data-stu-id="1d38c-195">15,000</span></span> |<span data-ttu-id="1d38c-196">60,000</span><span class="sxs-lookup"><span data-stu-id="1d38c-196">60,000</span></span> |<span data-ttu-id="1d38c-197">90,000</span><span class="sxs-lookup"><span data-stu-id="1d38c-197">90,000</span></span> |<span data-ttu-id="1d38c-198">150,000</span><span class="sxs-lookup"><span data-stu-id="1d38c-198">150,000</span></span> |
| <span data-ttu-id="1d38c-199">**24 služby SUs**</span><span class="sxs-lookup"><span data-stu-id="1d38c-199">**24 SUs**</span></span> |<span data-ttu-id="1d38c-200">10 000</span><span class="sxs-lookup"><span data-stu-id="1d38c-200">10,000</span></span> |<span data-ttu-id="1d38c-201">20,000</span><span class="sxs-lookup"><span data-stu-id="1d38c-201">20,000</span></span> |<span data-ttu-id="1d38c-202">80,000</span><span class="sxs-lookup"><span data-stu-id="1d38c-202">80,000</span></span> |<span data-ttu-id="1d38c-203">120,000</span><span class="sxs-lookup"><span data-stu-id="1d38c-203">120,000</span></span> |<span data-ttu-id="1d38c-204">200 000</span><span class="sxs-lookup"><span data-stu-id="1d38c-204">200,000</span></span> |
| <span data-ttu-id="1d38c-205">**…**</span><span class="sxs-lookup"><span data-stu-id="1d38c-205">**…**</span></span> |<span data-ttu-id="1d38c-206">…</span><span class="sxs-lookup"><span data-stu-id="1d38c-206">…</span></span> |<span data-ttu-id="1d38c-207">…</span><span class="sxs-lookup"><span data-stu-id="1d38c-207">…</span></span> |<span data-ttu-id="1d38c-208">…</span><span class="sxs-lookup"><span data-stu-id="1d38c-208">…</span></span> |<span data-ttu-id="1d38c-209">…</span><span class="sxs-lookup"><span data-stu-id="1d38c-209">…</span></span> |<span data-ttu-id="1d38c-210">…</span><span class="sxs-lookup"><span data-stu-id="1d38c-210">…</span></span> |
| <span data-ttu-id="1d38c-211">**60 služby SUs**</span><span class="sxs-lookup"><span data-stu-id="1d38c-211">**60 SUs**</span></span> |<span data-ttu-id="1d38c-212">25,000</span><span class="sxs-lookup"><span data-stu-id="1d38c-212">25,000</span></span> |<span data-ttu-id="1d38c-213">50,000</span><span class="sxs-lookup"><span data-stu-id="1d38c-213">50,000</span></span> |<span data-ttu-id="1d38c-214">200 000</span><span class="sxs-lookup"><span data-stu-id="1d38c-214">200,000</span></span> |<span data-ttu-id="1d38c-215">300,000</span><span class="sxs-lookup"><span data-stu-id="1d38c-215">300,000</span></span> |<span data-ttu-id="1d38c-216">500,000</span><span class="sxs-lookup"><span data-stu-id="1d38c-216">500,000</span></span> |

<span data-ttu-id="1d38c-217">Nyní by byste již měli mít dostatečné povědomí o tom, jak funkce Machine Learning v Stream Analytics fungovat.</span><span class="sxs-lookup"><span data-stu-id="1d38c-217">By now, you should already have a good understanding of how Machine Learning functions in Stream Analytics work.</span></span> <span data-ttu-id="1d38c-218">Je pravděpodobně také pochopit, že úlohy Stream Analytics "načítat" data ze zdroje dat a každý "vyžádání" vrátí dávky události pro úlohu služby Stream Analytics ke zpracování.</span><span class="sxs-lookup"><span data-stu-id="1d38c-218">You likely also understand that Stream Analytics jobs “pull” data from data sources and each “pull” returns a batch of events for the Stream Analytics job to process.</span></span> <span data-ttu-id="1d38c-219">Jak tomuto vlivu model vyžádání Machine Learning webové žádosti o služby?</span><span class="sxs-lookup"><span data-stu-id="1d38c-219">How does this pull model impact the Machine Learning web service requests?</span></span>

<span data-ttu-id="1d38c-220">Za normálních okolností velikost dávky nastavený pro Machine Learning funkce nebudou přesně dělitelná počet událostí vrácených Každá úloha Stream Analytics "vyžádání".</span><span class="sxs-lookup"><span data-stu-id="1d38c-220">Normally, the batch size we set for Machine Learning functions won’t exactly be divisible by the number of events returned by each Stream Analytics job “pull”.</span></span> <span data-ttu-id="1d38c-221">Pokud k tomu dojde, že webová služba Machine Learning bude volána s "částečné" dávky.</span><span class="sxs-lookup"><span data-stu-id="1d38c-221">When this occurs the Machine Learning web service will be called with “partial” batches.</span></span> <span data-ttu-id="1d38c-222">To slouží k není zpoplatněná režijní náklady na latenci dalších úloh v slučování událostí z vyžádání obsahu na vyžádání.</span><span class="sxs-lookup"><span data-stu-id="1d38c-222">This is done to not incur additional job latency overhead in coalescing events from pull to pull.</span></span>

## <a name="new-function-related-monitoring-metrics"></a><span data-ttu-id="1d38c-223">Nové funkce související s monitorování metriky</span><span class="sxs-lookup"><span data-stu-id="1d38c-223">New function-related monitoring metrics</span></span>
<span data-ttu-id="1d38c-224">V oblasti monitorování úlohy Stream Analytics byly přidány tři další metriky týkající se funkce.</span><span class="sxs-lookup"><span data-stu-id="1d38c-224">In the Monitor area of a Stream Analytics job, three additional function-related metrics have been added.</span></span> <span data-ttu-id="1d38c-225">Jak je znázorněno na následujícím obrázku jsou žádosti o funkce, funkce události a NEÚSPĚŠNÉ požadavky funkce.</span><span class="sxs-lookup"><span data-stu-id="1d38c-225">They are FUNCTION REQUESTS, FUNCTION EVENTS and FAILED FUNCTION REQUESTS, as shown in the graphic below.</span></span>

<span data-ttu-id="1d38c-226">![Škálování služby Stream Analytics s Machine Learning funkce metriky](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-01.png "škálování služby Stream Analytics s Machine Learning funkce metriky")</span><span class="sxs-lookup"><span data-stu-id="1d38c-226">![Scale Stream Analytics with Machine Learning Functions Metrics](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-01.png "Scale Stream Analytics with Machine Learning Functions Metrics")</span></span>

<span data-ttu-id="1d38c-227">Jsou definovány takto:</span><span class="sxs-lookup"><span data-stu-id="1d38c-227">The are defined as follows:</span></span>

<span data-ttu-id="1d38c-228">**POŽADAVKY funkce**: počet požadavků funkce.</span><span class="sxs-lookup"><span data-stu-id="1d38c-228">**FUNCTION REQUESTS**: The number of function requests.</span></span>

<span data-ttu-id="1d38c-229">**Funkce události**: číslo události v žádosti o funkce.</span><span class="sxs-lookup"><span data-stu-id="1d38c-229">**FUNCTION EVENTS**: The number events in the function requests.</span></span>

<span data-ttu-id="1d38c-230">**NEÚSPĚŠNÉ požadavky funkce**: počet požadavků neúspěšné funkce.</span><span class="sxs-lookup"><span data-stu-id="1d38c-230">**FAILED FUNCTION REQUESTS**: The number of failed function requests.</span></span>

## <a name="key-takeaways"></a><span data-ttu-id="1d38c-231">Klíče Takeaways</span><span class="sxs-lookup"><span data-stu-id="1d38c-231">Key Takeaways</span></span>
<span data-ttu-id="1d38c-232">To Shrneme hlavní body, aby bylo možné škálovat úlohu služby Stream Analytics s funkcemi, Machine Learning, je třeba zvážit následující položky:</span><span class="sxs-lookup"><span data-stu-id="1d38c-232">To summarize the main points, in order to scale an Stream Analytics job with Machine Learning functions, the following items must be considered:</span></span>

1. <span data-ttu-id="1d38c-233">Rychlost, jakou vstupní událost</span><span class="sxs-lookup"><span data-stu-id="1d38c-233">The input event rate</span></span>
2. <span data-ttu-id="1d38c-234">. Povolená latence pro spuštěná úloha Stream Analytics (a tedy velikost dávky žádosti webové služby Machine Learning)</span><span class="sxs-lookup"><span data-stu-id="1d38c-234">The tolerated latency for the running Stream Analytics job (and thus the batch size of the Machine Learning web service requests)</span></span>
3. <span data-ttu-id="1d38c-235">Zřízené SUs analýzy datového proudu a počet žádosti webové služby Machine Learning (Další funkce související náklady na)</span><span class="sxs-lookup"><span data-stu-id="1d38c-235">The provisioned Stream Analytics SUs and the number of Machine Learning web service requests (the additional function-related costs)</span></span>

<span data-ttu-id="1d38c-236">Jako příklad byl použit dotaz služby Stream Analytics plně oddílů.</span><span class="sxs-lookup"><span data-stu-id="1d38c-236">A fully partitioned Stream Analytics query was used as an example.</span></span> <span data-ttu-id="1d38c-237">Pokud je potřeba komplexnější dotaz [fórum Azure Stream Analytics](https://social.msdn.microsoft.com/Forums/en-US/home?forum=AzureStreamAnalytics) je skvělým zdrojem pro získávání potřebujete další pomoc od týmu Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="1d38c-237">If a more complex query is needed the [Azure Stream Analytics forum](https://social.msdn.microsoft.com/Forums/en-US/home?forum=AzureStreamAnalytics) is a great resource for getting additional help from the Stream Analytics team.</span></span>

## <a name="next-steps"></a><span data-ttu-id="1d38c-238">Další kroky</span><span class="sxs-lookup"><span data-stu-id="1d38c-238">Next steps</span></span>
<span data-ttu-id="1d38c-239">Další informace o Stream Analytics najdete v tématu:</span><span class="sxs-lookup"><span data-stu-id="1d38c-239">To learn more about Stream Analytics, see:</span></span>

* [<span data-ttu-id="1d38c-240">Začínáme používat službu Azure Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="1d38c-240">Get started using Azure Stream Analytics</span></span>](stream-analytics-real-time-fraud-detection.md)
* [<span data-ttu-id="1d38c-241">Škálování služby Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="1d38c-241">Scale Azure Stream Analytics jobs</span></span>](stream-analytics-scale-jobs.md)
* [<span data-ttu-id="1d38c-242">Referenční příručka k jazyku Azure Stream Analytics Query Language</span><span class="sxs-lookup"><span data-stu-id="1d38c-242">Azure Stream Analytics Query Language Reference</span></span>](https://msdn.microsoft.com/library/azure/dn834998.aspx)
* [<span data-ttu-id="1d38c-243">Referenční příručka k rozhraní REST API pro správu služby Azure Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="1d38c-243">Azure Stream Analytics Management REST API Reference</span></span>](https://msdn.microsoft.com/library/azure/dn835031.aspx)
