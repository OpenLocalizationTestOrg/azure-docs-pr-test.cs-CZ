---
title: "aaaJob škálování s Azure Stream Analytics & AzureML funkce | Microsoft Docs"
description: "Zjistěte, jak tooproperly škálování úlohy Stream Analytics (rozdělení do oddílů, SU množství a více) při použití funkce Azure Machine Learning."
keywords: 
documentationcenter: 
services: stream-analytics
author: jeffstokes72
manager: jhubbard
editor: cgronlun
ms.assetid: 47ce7c5e-1de1-41ca-9a26-b5ecce814743
ms.service: stream-analytics
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-services
ms.date: 03/28/2017
ms.author: jeffstok
ms.openlocfilehash: 3fbdfaf7e8e86896c56f1d18bbde3a10bd3dca04
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="scale-your-stream-analytics-job-with-azure-machine-learning-functions"></a><span data-ttu-id="caaba-103">Škálovat vaše úloha Stream Analytics s funkcemi Azure Machine Learning</span><span class="sxs-lookup"><span data-stu-id="caaba-103">Scale your Stream Analytics job with Azure Machine Learning functions</span></span>
<span data-ttu-id="caaba-104">Často je poměrně snadné tooset až úlohu služby Stream Analytics a procházely ukázková data.</span><span class="sxs-lookup"><span data-stu-id="caaba-104">It is often quite easy tooset up an Stream Analytics job and run some sample data through it.</span></span> <span data-ttu-id="caaba-105">Co můžeme udělat, když budeme potřebovat toorun hello stejné úlohy s vyšší datový svazek?</span><span class="sxs-lookup"><span data-stu-id="caaba-105">What should we do when we need toorun hello same job with higher data volume?</span></span> <span data-ttu-id="caaba-106">To nám vyžaduje toounderstand jak tooconfigure hello Stream Analytics úlohy tak, aby se bude škálovat.</span><span class="sxs-lookup"><span data-stu-id="caaba-106">It requires us toounderstand how tooconfigure hello Stream Analytics job so that it will scale.</span></span> <span data-ttu-id="caaba-107">V tomto dokumentu se zaměříme na hello zvláštní aspekty škálování služby Stream Analytics úlohy se funkce Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="caaba-107">In this document, we will focus on hello special aspects of scaling Stream Analytics jobs with Machine Learning functions.</span></span> <span data-ttu-id="caaba-108">Informace o tom, jak úlohy Stream Analytics tooscale obecně najdete článku hello [škálování úlohy](stream-analytics-scale-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="caaba-108">For information on how tooscale Stream Analytics jobs in general see hello article [Scaling jobs](stream-analytics-scale-jobs.md).</span></span>

## <a name="what-is-an-azure-machine-learning-function-in-stream-analytics"></a><span data-ttu-id="caaba-109">Co je Azure Machine Learning funkce v Stream Analytics?</span><span class="sxs-lookup"><span data-stu-id="caaba-109">What is an Azure Machine Learning function in Stream Analytics?</span></span>
<span data-ttu-id="caaba-110">Funkce Machine Learning v Stream Analytics lze použít jako volání regulární funkce v hello Stream Analytics query language.</span><span class="sxs-lookup"><span data-stu-id="caaba-110">A Machine Learning function in Stream Analytics can be used like a regular function call in hello Stream Analytics query language.</span></span> <span data-ttu-id="caaba-111">Však za hello scény hello volání funkce je ve skutečnosti žádostí o webovou službu Azure Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="caaba-111">However, behind hello scene, hello function calls are actually Azure Machine Learning Web Service requests.</span></span> <span data-ttu-id="caaba-112">Machine Learning webové služby podpory "dávkování" více řádků, kterému se říká zkrácená batch, v hello stejné webové služby volání rozhraní API, tooimprove celkovou propustnost.</span><span class="sxs-lookup"><span data-stu-id="caaba-112">Machine Learning web services support “batching” multiple rows, which is called mini-batch, in hello same web service API call, tooimprove overall throughput.</span></span> <span data-ttu-id="caaba-113">Podrobnosti najdete na následující články pro další podrobnosti; hello [Funkce azure Machine Learning v Stream Analytics](https://blogs.technet.microsoft.com/machinelearning/2015/12/10/azure-ml-now-available-as-a-function-in-azure-stream-analytics/) a [webové služby Azure Machine Learning](../machine-learning/machine-learning-consume-web-services.md).</span><span class="sxs-lookup"><span data-stu-id="caaba-113">Please see hello following articles for more details; [Azure Machine Learning functions in Stream Analytics](https://blogs.technet.microsoft.com/machinelearning/2015/12/10/azure-ml-now-available-as-a-function-in-azure-stream-analytics/) and [Azure Machine Learning Web Services](../machine-learning/machine-learning-consume-web-services.md).</span></span>

## <a name="configure-a-stream-analytics-job-with-machine-learning-functions"></a><span data-ttu-id="caaba-114">Úloha Stream Analytics nakonfigurovat funkce Machine Learning</span><span class="sxs-lookup"><span data-stu-id="caaba-114">Configure a Stream Analytics job with Machine Learning functions</span></span>
<span data-ttu-id="caaba-115">Při konfiguraci funkce Machine Learning úlohy Stream Analytics, existují dva parametry tooconsider, velikost dávky hello hello volání funkce Machine Learning a hello jednotky (SUs) zřízené pro úlohy služby Stream Analytics hello streamování.</span><span class="sxs-lookup"><span data-stu-id="caaba-115">When configuring a Machine Learning function for Stream Analytics job, there are two parameters tooconsider, hello batch size of hello Machine Learning function calls, and hello streaming units (SUs) provisioned for hello Stream Analytics job.</span></span> <span data-ttu-id="caaba-116">hello příslušnými hodnotami toodetermine pro tyto, nejprve musí být přijato rozhodnutí mezi latence a propustnosti, to znamená, latenci úlohy Stream Analytics hello a propustnost každý SU.</span><span class="sxs-lookup"><span data-stu-id="caaba-116">toodetermine hello appropriate values for these, first a decision must be made between latency and throughput, that is, latency of hello Stream Analytics job, and throughput of each SU.</span></span> <span data-ttu-id="caaba-117">Služby SUs vždy lze přidat tooa úlohy tooincrease propustnost dobře oddílů dotazu Stream Analytics, i když další služby SUs zvyšuje náklady hello spuštěná úloha hello.</span><span class="sxs-lookup"><span data-stu-id="caaba-117">SUs may always be added tooa job tooincrease throughput of a well partitioned Stream Analytics query, although additional SUs increases hello cost of running hello job.</span></span>

<span data-ttu-id="caaba-118">Proto je důležité toodetermine hello *tolerance* latence ve spuštění úlohy Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="caaba-118">Therefore it is important toodetermine hello *tolerance* of latency in running a Stream Analytics job.</span></span> <span data-ttu-id="caaba-119">Další spuštění žádosti o služby Azure Machine Learning zvýší se latence přirozeně s velikost dávky, která bude složené hello latence úlohy Stream Analytics hello.</span><span class="sxs-lookup"><span data-stu-id="caaba-119">Additional latency from running Azure Machine Learning service requests will naturally increase with batch size, which will compound hello latency of hello Stream Analytics job.</span></span> <span data-ttu-id="caaba-120">Na hello druhé straně, zvýšit velikost dávky umožňuje tooprocess úlohy Stream Analytics hello * další události s hello *stejné číslo* nástroje Machine Learning webové žádosti o služby.</span><span class="sxs-lookup"><span data-stu-id="caaba-120">On hello other hand, increasing batch size allows hello Stream Analytics job tooprocess *more events with hello *same number* of Machine Learning web service requests.</span></span> <span data-ttu-id="caaba-121">Proto je důležité tooconsider hello velikost na nejvíce cenově efektivní dávky pro webové služby Machine Learning v jakékoliv jiné situaci s danou, je často hello zvýšení latence služby Machine Learning webové dílčí lineární toohello zvýšení velikosti dávky.</span><span class="sxs-lookup"><span data-stu-id="caaba-121">Often hello increase of Machine Learning web service latency is sub-linear toohello increase of batch size so it is important tooconsider hello most cost-efficient batch size for a Machine Learning web service in any given situation.</span></span> <span data-ttu-id="caaba-122">Hello výchozí velikost dávky pro webovou službu hello požadavky je 1000 a může být změněno buď pomocí hello [Stream Analytics REST API](https://msdn.microsoft.com/library/mt653706.aspx "Stream Analytics REST API") nebo hello [klienta PowerShell pro Stream Analytics](stream-analytics-monitor-and-manage-jobs-use-powershell.md "klienta PowerShell pro Stream Analytics").</span><span class="sxs-lookup"><span data-stu-id="caaba-122">hello default batch size for hello web service requests is 1000 and may be modified either by using hello [Stream Analytics REST API](https://msdn.microsoft.com/library/mt653706.aspx "Stream Analytics REST API") or hello [PowerShell client for Stream Analytics](stream-analytics-monitor-and-manage-jobs-use-powershell.md "PowerShell client for Stream Analytics").</span></span>

<span data-ttu-id="caaba-123">Po určil velikost dávky množství hello streamování jednotky (SUs) může být určené, na základě hello počet událostí, které potřebuje funkce hello tooprocess za sekundu.</span><span class="sxs-lookup"><span data-stu-id="caaba-123">Once a batch size has been determined, hello amount of streaming units (SUs) can be determined, based on hello number of events that hello function needs tooprocess per second.</span></span> <span data-ttu-id="caaba-124">Další informace o jednotky streamování najdete v tématu [škálování úlohy Stream Analytics](stream-analytics-scale-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="caaba-124">For more information about streaming units, see [Stream Analytics scale jobs](stream-analytics-scale-jobs.md).</span></span>

<span data-ttu-id="caaba-125">Obecně je 20 souběžných připojení toohello webové službě Machine Learning pro každých 6 služby SUs s tím rozdílem, že 1 SU úlohy a úlohy 3 SU získají 20 souběžných připojení také.</span><span class="sxs-lookup"><span data-stu-id="caaba-125">In general, there are 20 concurrent connections toohello Machine Learning web service for every 6 SUs, except that 1 SU jobs and 3 SU jobs will get 20 concurrent connections also.</span></span>  <span data-ttu-id="caaba-126">Například pokud míra vstupních dat hello je 200 000 událostí za sekundu a velikost dávky hello je ponechán toohello výchozí 1000 hello výsledný web latence služby pomocí služby batch zkrácená 1000 událostí je 200 MS.</span><span class="sxs-lookup"><span data-stu-id="caaba-126">For example, if hello input data rate is 200,000 events per second and hello batch size is left toohello default of 1000 hello resulting web service latency with 1000 events mini-batch is 200ms.</span></span> <span data-ttu-id="caaba-127">To znamená, že každé připojení provádět 5 požadavky webové službě Machine Learning toohello za sekundu.</span><span class="sxs-lookup"><span data-stu-id="caaba-127">This means every connection can make 5 requests toohello Machine Learning web service in a second.</span></span> <span data-ttu-id="caaba-128">S 20 připojení zpracovávat úlohy služby Stream Analytics hello 20 000 událostí ve 200 MS a proto 100 000 událostí za sekundu.</span><span class="sxs-lookup"><span data-stu-id="caaba-128">With 20 connections, hello Stream Analytics job can process 20,000 events in 200ms  and therefore 100,000 events in a second.</span></span> <span data-ttu-id="caaba-129">Proto tooprocess 200 000 událostí za sekundu, hello úlohy služby Stream Analytics musí 40 souběžných připojení, která dodává se službou SUs too12.</span><span class="sxs-lookup"><span data-stu-id="caaba-129">So tooprocess 200,000 events per second, hello Stream Analytics job needs 40 concurrent connections, which comes out too12 SUs.</span></span> <span data-ttu-id="caaba-130">Hello obrázek níže znázorňuje hello požadavky od hello Stream Analytics úlohy toohello Machine Learning koncový bod webové služby – každých 6 SUs má 20 souběžných připojení tooMachine Learning webové služby v max.</span><span class="sxs-lookup"><span data-stu-id="caaba-130">hello diagram below illustrates hello requests from hello Stream Analytics job toohello Machine Learning web service endpoint – Every 6 SUs has 20 concurrent connections tooMachine Learning web service at max.</span></span>

<span data-ttu-id="caaba-131">![Škálování služby Stream Analytics se Machine Learning funkce 2 úlohy příklad](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-00.png "škálování Stream Analytics příklad úlohy Machine Learning funkce 2")</span><span class="sxs-lookup"><span data-stu-id="caaba-131">![Scale Stream Analytics with Machine Learning Functions 2 job example](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-00.png "Scale Stream Analytics with Machine Learning Functions 2 job example")</span></span>

<span data-ttu-id="caaba-132">Obecně platí ***B*** pro velikost dávky ***L*** hello webové služby latence na velikost dávky B v milisekundách, text hello propustnost úlohu služby Stream Analytics s ***N*** služby SUs je:</span><span class="sxs-lookup"><span data-stu-id="caaba-132">In general, ***B*** for batch size, ***L*** for hello web service latency at batch size B in milliseconds, hello throughput of an Stream Analytics job with ***N*** SUs is:</span></span>

<span data-ttu-id="caaba-133">![Škálování služby Stream Analytics s Machine Learning funkce vzorec](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-02.png "škálování služby Stream Analytics s vzorec funkce Machine Learning")</span><span class="sxs-lookup"><span data-stu-id="caaba-133">![Scale Stream Analytics with Machine Learning Functions Formula](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-02.png "Scale Stream Analytics with Machine Learning Functions Formula")</span></span>

<span data-ttu-id="caaba-134">Další aspekt může být hello 'maximální počet souběžných volání' na hello Machine Learning webové služby straně, se doporučuje tooset tuto toohello maximální hodnotu (aktuálně 200).</span><span class="sxs-lookup"><span data-stu-id="caaba-134">An additional consideration may be hello 'max concurrent calls' on hello Machine Learning web service side, it’s recommended tooset this toohello maximum value (200 currently).</span></span>

<span data-ttu-id="caaba-135">Další informace o tomto nastavení najdete v tématu hello [škálování najdete v článku webové služby Machine Learning](../machine-learning/machine-learning-scaling-webservice.md).</span><span class="sxs-lookup"><span data-stu-id="caaba-135">For more information on this setting please review hello [Scaling article for Machine Learning Web Services](../machine-learning/machine-learning-scaling-webservice.md).</span></span>

## <a name="example--sentiment-analysis"></a><span data-ttu-id="caaba-136">Příklad – postojích analýzy</span><span class="sxs-lookup"><span data-stu-id="caaba-136">Example – Sentiment Analysis</span></span>
<span data-ttu-id="caaba-137">Hello následující příklad obsahuje úlohy Stream Analytics hello postojích analýzy funkce Machine Learning, jak je popsáno v hello [Stream Analytics Machine Learning integrace kurzu](stream-analytics-machine-learning-integration-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="caaba-137">hello following example includes a Stream Analytics job with hello sentiment analysis Machine Learning function, as described in hello [Stream Analytics Machine Learning integration tutorial](stream-analytics-machine-learning-integration-tutorial.md).</span></span>

<span data-ttu-id="caaba-138">Hello dotaz je jednoduchý dotaz plně oddílů, který následuje hello **postojích** fungovat, jak je uvedeno níže:</span><span class="sxs-lookup"><span data-stu-id="caaba-138">hello query is a simple fully partitioned query followed by hello **sentiment** function, as shown below:</span></span>

    WITH subquery AS (
        SELECT text, sentiment(text) as result from input
    )

    Select text, result.[Score]
    Into output
    From subquery

<span data-ttu-id="caaba-139">Zvažte následující scénáře; hello s propustností 10 000 tweetů za sekundu úloha Stream Analytics se musí vytvořit tooperform postojích analýzu hello tweetů (událostí).</span><span class="sxs-lookup"><span data-stu-id="caaba-139">Consider hello following scenario; with a throughput of 10,000 tweets per second a Stream Analytics job must be created tooperform sentiment analysis of hello tweets (events).</span></span> <span data-ttu-id="caaba-140">Pomocí 1 SU, může tato úloha Stream Analytics být schopný toohandle hello provozu?</span><span class="sxs-lookup"><span data-stu-id="caaba-140">Using 1 SU, could this Stream Analytics job be able toohandle hello traffic?</span></span> <span data-ttu-id="caaba-141">Pomocí hello výchozí velikost dávky 1000 hello úlohy by měl být schopný tookeep až se vstupem hello.</span><span class="sxs-lookup"><span data-stu-id="caaba-141">Using hello default batch size of 1000 hello job should be able tookeep up with hello input.</span></span> <span data-ttu-id="caaba-142">Další hello přidaná funkce Machine Learning měl generovat víc než jedna sekunda latence, což je výchozí obecné latence hello hello postojích analýzy webové službě Machine Learning (s výchozí velikost dávky 1000).</span><span class="sxs-lookup"><span data-stu-id="caaba-142">Further hello added Machine Learning function should generate no more than a second of latency, which is hello general default latency of hello sentiment analysis Machine Learning web service (with a default batch size of 1000).</span></span> <span data-ttu-id="caaba-143">Úloha Stream Analytics Hello **celkové** nebo latence začátku do konce by obvykle na několik sekund.</span><span class="sxs-lookup"><span data-stu-id="caaba-143">hello Stream Analytics job’s **overall** or end-to-end latency would typically be a few seconds.</span></span> <span data-ttu-id="caaba-144">Podrobnější podívejte se do této úlohy Stream Analytics *zejména* hello volání funkce Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="caaba-144">Take a more detailed look into this Stream Analytics job, *especially* hello Machine Learning function calls.</span></span> <span data-ttu-id="caaba-145">Velikost dávky hello s jako 1000, propustnost 10 000 událostí, které bude trvat asi 10 požadavky tooweb služby.</span><span class="sxs-lookup"><span data-stu-id="caaba-145">Having hello batch size as 1000, a throughput of 10,000 events will take about 10 requests tooweb service.</span></span> <span data-ttu-id="caaba-146">I když 1 SU, jsou dostatečný počet souběžných připojení tooaccommodate to vstupní provoz.</span><span class="sxs-lookup"><span data-stu-id="caaba-146">Even with 1 SU, there are enough concurrent connections tooaccommodate this input traffic.</span></span>

<span data-ttu-id="caaba-147">Ale co když rychlost vstupní událostí hello zvyšuje úroveň 100 x a úloha Stream Analytics hello potřebuje teď tooprocess 1 000 000 tweetů za sekundu?</span><span class="sxs-lookup"><span data-stu-id="caaba-147">But what if hello input event rate increases by 100x and now hello Stream Analytics job needs tooprocess 1,000,000 tweets per second?</span></span> <span data-ttu-id="caaba-148">Existují dvě možnosti:</span><span class="sxs-lookup"><span data-stu-id="caaba-148">There are two options:</span></span>

1. <span data-ttu-id="caaba-149">Zvětšete velikost dávky hello, nebo</span><span class="sxs-lookup"><span data-stu-id="caaba-149">Increase hello batch size, or</span></span>
2. <span data-ttu-id="caaba-150">Oddíl hello vstupního datového proudu tooprocess hello události paralelně</span><span class="sxs-lookup"><span data-stu-id="caaba-150">Partition hello input stream tooprocess hello events in parallel</span></span>

<span data-ttu-id="caaba-151">První možností hello hello úlohy **latence** zvýší.</span><span class="sxs-lookup"><span data-stu-id="caaba-151">With hello first option, hello job **latency** will increase.</span></span>

<span data-ttu-id="caaba-152">Další služby SUs s hello druhá možnost se by potřebovat toobe zřízený a proto generovat více souběžných žádosti webové služby Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="caaba-152">With hello second option, more SUs would need toobe provisioned and therefore generate more concurrent Machine Learning web service requests.</span></span> <span data-ttu-id="caaba-153">To znamená hello úlohy **náklady** zvýší.</span><span class="sxs-lookup"><span data-stu-id="caaba-153">This means hello job **cost** will increase.</span></span>

<span data-ttu-id="caaba-154">Předpokládá, že hello latence hello postojích analýzy webové službě Machine Learning je 200 MS pro dávky 1000 událostí nebo níže 250ms pro dávky 5 000 událostí, 300ms pro dávky 10 000 událostí nebo 500ms pro dávky 25 000 událostí.</span><span class="sxs-lookup"><span data-stu-id="caaba-154">Assume hello latency of hello sentiment analysis Machine Learning web service is 200ms for 1000-event batches or below, 250ms for 5,000-event batches, 300ms for 10,000-event batches or 500ms for 25,000-event batches.</span></span>

1. <span data-ttu-id="caaba-155">Pomocí hello první možnosti, (**není** zřizování další služby SUs), velikost dávky hello mohlo dojít ke zvýšení příliš**25 000**.</span><span class="sxs-lookup"><span data-stu-id="caaba-155">Using hello first option, (**not** provisioning more SUs), hello batch size could be increased too**25,000**.</span></span> <span data-ttu-id="caaba-156">To zase umožní hello úlohy tooprocess 1 000 000 událostí s 20 souběžných připojení toohello webové službě Machine Learning (s latencí 500ms za hovor).</span><span class="sxs-lookup"><span data-stu-id="caaba-156">This in turn would allow hello job tooprocess 1,000,000 events with 20 concurrent connections toohello Machine Learning web service (with a latency of 500ms per call).</span></span> <span data-ttu-id="caaba-157">Proto hello další latence úlohy Stream Analytics hello kvůli toohello postojích funkce požadavky DHCP proti hello Machine Learning žádosti webové služby by být zvýšena z **200 MS** příliš**500ms**.</span><span class="sxs-lookup"><span data-stu-id="caaba-157">So hello additional latency of hello Stream Analytics job due toohello sentiment function requests against hello Machine Learning web service requests would be increased from **200ms** too**500ms**.</span></span> <span data-ttu-id="caaba-158">Ale Všimněte si, že velikost dávky **nelze** být zvýšena nekonečnou jako hello webových služeb Machine Learning vyžaduje velikost datové části hello požadavku se 4 MB volného místa nebo menší web časový limit žádosti o službu po 100 sekundách operace.</span><span class="sxs-lookup"><span data-stu-id="caaba-158">However, note that batch size **cannot** be increased infinitely as hello Machine Learning web services requires hello payload size of a request be 4MB or smaller web service requests timeout after 100 seconds of operation.</span></span>
2. <span data-ttu-id="caaba-159">Pomocí hello druhou možnost, velikost dávky hello je ponechány na 1000, s 200 MS webové služby latencí, každých 20 souběžných připojení toohello webová služba bude mít tooprocess 1000 * 20 * 5 události = 100 000 za sekundu.</span><span class="sxs-lookup"><span data-stu-id="caaba-159">Using hello second option, hello batch size is left at 1000, with 200ms web service latency, every 20 concurrent connections toohello web service would be able tooprocess 1000 * 20 * 5 events = 100,000 per second.</span></span> <span data-ttu-id="caaba-160">1 000 000 událostí tooprocess na druhé, úlohu hello, takže by měli 60 služby SUs.</span><span class="sxs-lookup"><span data-stu-id="caaba-160">So tooprocess 1,000,000 events per second, hello job would need 60 SUs.</span></span> <span data-ttu-id="caaba-161">Porovnání toohello první možnost se Stream Analytics úlohy by zkontrolujte další webové žádosti o služby batch, zase generování vyšší náklady.</span><span class="sxs-lookup"><span data-stu-id="caaba-161">Compared toohello first option, Stream Analytics job would make more web service batch requests, in turn generating an increased cost.</span></span>

<span data-ttu-id="caaba-162">Níže je tabulka pro hello propustnost hello Stream Analytics úlohy pro různé služby SUs a velikostí dávky (v počtu událostí za sekundu).</span><span class="sxs-lookup"><span data-stu-id="caaba-162">Below is a table for hello throughput of hello Stream Analytics job for different SUs and batch sizes (in number of events per second).</span></span>

| <span data-ttu-id="caaba-163">velikost dávky (ML latence)</span><span class="sxs-lookup"><span data-stu-id="caaba-163">batch size (ML latency)</span></span> | <span data-ttu-id="caaba-164">500 (200 MS)</span><span class="sxs-lookup"><span data-stu-id="caaba-164">500 (200ms)</span></span> | <span data-ttu-id="caaba-165">1 000 (200 MS)</span><span class="sxs-lookup"><span data-stu-id="caaba-165">1,000 (200ms)</span></span> | <span data-ttu-id="caaba-166">5 000 (250ms)</span><span class="sxs-lookup"><span data-stu-id="caaba-166">5,000 (250ms)</span></span> | <span data-ttu-id="caaba-167">10 000 (300ms)</span><span class="sxs-lookup"><span data-stu-id="caaba-167">10,000 (300ms)</span></span> | <span data-ttu-id="caaba-168">25 000 (500ms)</span><span class="sxs-lookup"><span data-stu-id="caaba-168">25,000 (500ms)</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="caaba-169">**1 SU**</span><span class="sxs-lookup"><span data-stu-id="caaba-169">**1 SU**</span></span> |<span data-ttu-id="caaba-170">2,500</span><span class="sxs-lookup"><span data-stu-id="caaba-170">2,500</span></span> |<span data-ttu-id="caaba-171">5,000</span><span class="sxs-lookup"><span data-stu-id="caaba-171">5,000</span></span> |<span data-ttu-id="caaba-172">20,000</span><span class="sxs-lookup"><span data-stu-id="caaba-172">20,000</span></span> |<span data-ttu-id="caaba-173">30,000</span><span class="sxs-lookup"><span data-stu-id="caaba-173">30,000</span></span> |<span data-ttu-id="caaba-174">50,000</span><span class="sxs-lookup"><span data-stu-id="caaba-174">50,000</span></span> |
| <span data-ttu-id="caaba-175">**3 služby SUs**</span><span class="sxs-lookup"><span data-stu-id="caaba-175">**3 SUs**</span></span> |<span data-ttu-id="caaba-176">2,500</span><span class="sxs-lookup"><span data-stu-id="caaba-176">2,500</span></span> |<span data-ttu-id="caaba-177">5,000</span><span class="sxs-lookup"><span data-stu-id="caaba-177">5,000</span></span> |<span data-ttu-id="caaba-178">20,000</span><span class="sxs-lookup"><span data-stu-id="caaba-178">20,000</span></span> |<span data-ttu-id="caaba-179">30,000</span><span class="sxs-lookup"><span data-stu-id="caaba-179">30,000</span></span> |<span data-ttu-id="caaba-180">50,000</span><span class="sxs-lookup"><span data-stu-id="caaba-180">50,000</span></span> |
| <span data-ttu-id="caaba-181">**6 služby SUs**</span><span class="sxs-lookup"><span data-stu-id="caaba-181">**6 SUs**</span></span> |<span data-ttu-id="caaba-182">2,500</span><span class="sxs-lookup"><span data-stu-id="caaba-182">2,500</span></span> |<span data-ttu-id="caaba-183">5,000</span><span class="sxs-lookup"><span data-stu-id="caaba-183">5,000</span></span> |<span data-ttu-id="caaba-184">20,000</span><span class="sxs-lookup"><span data-stu-id="caaba-184">20,000</span></span> |<span data-ttu-id="caaba-185">30,000</span><span class="sxs-lookup"><span data-stu-id="caaba-185">30,000</span></span> |<span data-ttu-id="caaba-186">50,000</span><span class="sxs-lookup"><span data-stu-id="caaba-186">50,000</span></span> |
| <span data-ttu-id="caaba-187">**12 služby SUs**</span><span class="sxs-lookup"><span data-stu-id="caaba-187">**12 SUs**</span></span> |<span data-ttu-id="caaba-188">5,000</span><span class="sxs-lookup"><span data-stu-id="caaba-188">5,000</span></span> |<span data-ttu-id="caaba-189">10 000</span><span class="sxs-lookup"><span data-stu-id="caaba-189">10,000</span></span> |<span data-ttu-id="caaba-190">40,000</span><span class="sxs-lookup"><span data-stu-id="caaba-190">40,000</span></span> |<span data-ttu-id="caaba-191">60,000</span><span class="sxs-lookup"><span data-stu-id="caaba-191">60,000</span></span> |<span data-ttu-id="caaba-192">100,000</span><span class="sxs-lookup"><span data-stu-id="caaba-192">100,000</span></span> |
| <span data-ttu-id="caaba-193">**18 služby SUs**</span><span class="sxs-lookup"><span data-stu-id="caaba-193">**18 SUs**</span></span> |<span data-ttu-id="caaba-194">7,500</span><span class="sxs-lookup"><span data-stu-id="caaba-194">7,500</span></span> |<span data-ttu-id="caaba-195">15,000</span><span class="sxs-lookup"><span data-stu-id="caaba-195">15,000</span></span> |<span data-ttu-id="caaba-196">60,000</span><span class="sxs-lookup"><span data-stu-id="caaba-196">60,000</span></span> |<span data-ttu-id="caaba-197">90,000</span><span class="sxs-lookup"><span data-stu-id="caaba-197">90,000</span></span> |<span data-ttu-id="caaba-198">150,000</span><span class="sxs-lookup"><span data-stu-id="caaba-198">150,000</span></span> |
| <span data-ttu-id="caaba-199">**24 služby SUs**</span><span class="sxs-lookup"><span data-stu-id="caaba-199">**24 SUs**</span></span> |<span data-ttu-id="caaba-200">10 000</span><span class="sxs-lookup"><span data-stu-id="caaba-200">10,000</span></span> |<span data-ttu-id="caaba-201">20,000</span><span class="sxs-lookup"><span data-stu-id="caaba-201">20,000</span></span> |<span data-ttu-id="caaba-202">80,000</span><span class="sxs-lookup"><span data-stu-id="caaba-202">80,000</span></span> |<span data-ttu-id="caaba-203">120,000</span><span class="sxs-lookup"><span data-stu-id="caaba-203">120,000</span></span> |<span data-ttu-id="caaba-204">200 000</span><span class="sxs-lookup"><span data-stu-id="caaba-204">200,000</span></span> |
| <span data-ttu-id="caaba-205">**…**</span><span class="sxs-lookup"><span data-stu-id="caaba-205">**…**</span></span> |<span data-ttu-id="caaba-206">…</span><span class="sxs-lookup"><span data-stu-id="caaba-206">…</span></span> |<span data-ttu-id="caaba-207">…</span><span class="sxs-lookup"><span data-stu-id="caaba-207">…</span></span> |<span data-ttu-id="caaba-208">…</span><span class="sxs-lookup"><span data-stu-id="caaba-208">…</span></span> |<span data-ttu-id="caaba-209">…</span><span class="sxs-lookup"><span data-stu-id="caaba-209">…</span></span> |<span data-ttu-id="caaba-210">…</span><span class="sxs-lookup"><span data-stu-id="caaba-210">…</span></span> |
| <span data-ttu-id="caaba-211">**60 služby SUs**</span><span class="sxs-lookup"><span data-stu-id="caaba-211">**60 SUs**</span></span> |<span data-ttu-id="caaba-212">25,000</span><span class="sxs-lookup"><span data-stu-id="caaba-212">25,000</span></span> |<span data-ttu-id="caaba-213">50,000</span><span class="sxs-lookup"><span data-stu-id="caaba-213">50,000</span></span> |<span data-ttu-id="caaba-214">200 000</span><span class="sxs-lookup"><span data-stu-id="caaba-214">200,000</span></span> |<span data-ttu-id="caaba-215">300,000</span><span class="sxs-lookup"><span data-stu-id="caaba-215">300,000</span></span> |<span data-ttu-id="caaba-216">500,000</span><span class="sxs-lookup"><span data-stu-id="caaba-216">500,000</span></span> |

<span data-ttu-id="caaba-217">Nyní by byste již měli mít dostatečné povědomí o tom, jak funkce Machine Learning v Stream Analytics fungovat.</span><span class="sxs-lookup"><span data-stu-id="caaba-217">By now, you should already have a good understanding of how Machine Learning functions in Stream Analytics work.</span></span> <span data-ttu-id="caaba-218">Je pravděpodobně také pochopit, že úlohy Stream Analytics "pro vyžádání obsahu" data ze zdroje dat a každý "vyžádání" vrátí dávky události pro hello tooprocess úlohy Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="caaba-218">You likely also understand that Stream Analytics jobs “pull” data from data sources and each “pull” returns a batch of events for hello Stream Analytics job tooprocess.</span></span> <span data-ttu-id="caaba-219">Tom, jak tento model pull ovlivnit žádosti webové služby hello Machine Learning?</span><span class="sxs-lookup"><span data-stu-id="caaba-219">How does this pull model impact hello Machine Learning web service requests?</span></span>

<span data-ttu-id="caaba-220">Za normálních okolností hello velikost dávky nastavený pro Machine Learning funkce nesmí být přesně dělitelná hello počet událostí vrácených Každá úloha Stream Analytics "vyžádání".</span><span class="sxs-lookup"><span data-stu-id="caaba-220">Normally, hello batch size we set for Machine Learning functions won’t exactly be divisible by hello number of events returned by each Stream Analytics job “pull”.</span></span> <span data-ttu-id="caaba-221">Když k tomu dojde, že hello webové službě Machine Learning bude volána s "částečné" dávky.</span><span class="sxs-lookup"><span data-stu-id="caaba-221">When this occurs hello Machine Learning web service will be called with “partial” batches.</span></span> <span data-ttu-id="caaba-222">Děje se tak toonot toho vám být účtovány další úlohy latence režie v slučování událostí z toopull vyžádání obsahu.</span><span class="sxs-lookup"><span data-stu-id="caaba-222">This is done toonot incur additional job latency overhead in coalescing events from pull toopull.</span></span>

## <a name="new-function-related-monitoring-metrics"></a><span data-ttu-id="caaba-223">Nové funkce související s monitorování metriky</span><span class="sxs-lookup"><span data-stu-id="caaba-223">New function-related monitoring metrics</span></span>
<span data-ttu-id="caaba-224">V oblasti monitorování úlohy Stream Analytics hello byly přidány tři další metriky týkající se funkce.</span><span class="sxs-lookup"><span data-stu-id="caaba-224">In hello Monitor area of a Stream Analytics job, three additional function-related metrics have been added.</span></span> <span data-ttu-id="caaba-225">Jak je znázorněno v následujícím hello obrázku jsou žádosti o funkce, funkce události a NEÚSPĚŠNÉ požadavky funkce.</span><span class="sxs-lookup"><span data-stu-id="caaba-225">They are FUNCTION REQUESTS, FUNCTION EVENTS and FAILED FUNCTION REQUESTS, as shown in hello graphic below.</span></span>

<span data-ttu-id="caaba-226">![Škálování služby Stream Analytics s Machine Learning funkce metriky](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-01.png "škálování služby Stream Analytics s Machine Learning funkce metriky")</span><span class="sxs-lookup"><span data-stu-id="caaba-226">![Scale Stream Analytics with Machine Learning Functions Metrics](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-01.png "Scale Stream Analytics with Machine Learning Functions Metrics")</span></span>

<span data-ttu-id="caaba-227">Hello jsou definovány takto:</span><span class="sxs-lookup"><span data-stu-id="caaba-227">hello are defined as follows:</span></span>

<span data-ttu-id="caaba-228">**POŽADAVKY funkce**: hello počet požadavků na funkce.</span><span class="sxs-lookup"><span data-stu-id="caaba-228">**FUNCTION REQUESTS**: hello number of function requests.</span></span>

<span data-ttu-id="caaba-229">**Funkce události**: hello číslo události v hello funkce požadavky.</span><span class="sxs-lookup"><span data-stu-id="caaba-229">**FUNCTION EVENTS**: hello number events in hello function requests.</span></span>

<span data-ttu-id="caaba-230">**NEÚSPĚŠNÉ požadavky funkce**: hello počet požadavků neúspěšné funkce.</span><span class="sxs-lookup"><span data-stu-id="caaba-230">**FAILED FUNCTION REQUESTS**: hello number of failed function requests.</span></span>

## <a name="key-takeaways"></a><span data-ttu-id="caaba-231">Klíče Takeaways</span><span class="sxs-lookup"><span data-stu-id="caaba-231">Key Takeaways</span></span>
<span data-ttu-id="caaba-232">toosummarize hello hlavní body v pořadí tooscale úlohu služby Stream Analytics s funkcemi, Machine Learning, hello následující položky je třeba zvážit:</span><span class="sxs-lookup"><span data-stu-id="caaba-232">toosummarize hello main points, in order tooscale an Stream Analytics job with Machine Learning functions, hello following items must be considered:</span></span>

1. <span data-ttu-id="caaba-233">rychlost vstupní událostí Hello</span><span class="sxs-lookup"><span data-stu-id="caaba-233">hello input event rate</span></span>
2. <span data-ttu-id="caaba-234">Hello tolerovat latence pro spuštění úlohy Stream Analytics hello (a tedy velikost dávky hello webové služby Machine Learning hello požadavky)</span><span class="sxs-lookup"><span data-stu-id="caaba-234">hello tolerated latency for hello running Stream Analytics job (and thus hello batch size of hello Machine Learning web service requests)</span></span>
3. <span data-ttu-id="caaba-235">Hello zřízení služby Stream Analytics SUs a hello počet žádosti webové služby Machine Learning (hello další funkce nákladů souvisejících s)</span><span class="sxs-lookup"><span data-stu-id="caaba-235">hello provisioned Stream Analytics SUs and hello number of Machine Learning web service requests (hello additional function-related costs)</span></span>

<span data-ttu-id="caaba-236">Jako příklad byl použit dotaz služby Stream Analytics plně oddílů.</span><span class="sxs-lookup"><span data-stu-id="caaba-236">A fully partitioned Stream Analytics query was used as an example.</span></span> <span data-ttu-id="caaba-237">Pokud je potřeba komplexnější dotaz hello [fórum Azure Stream Analytics](https://social.msdn.microsoft.com/Forums/en-US/home?forum=AzureStreamAnalytics) je skvělým zdrojem pro získávání potřebujete další pomoc od týmu Stream Analytics hello.</span><span class="sxs-lookup"><span data-stu-id="caaba-237">If a more complex query is needed hello [Azure Stream Analytics forum](https://social.msdn.microsoft.com/Forums/en-US/home?forum=AzureStreamAnalytics) is a great resource for getting additional help from hello Stream Analytics team.</span></span>

## <a name="next-steps"></a><span data-ttu-id="caaba-238">Další kroky</span><span class="sxs-lookup"><span data-stu-id="caaba-238">Next steps</span></span>
<span data-ttu-id="caaba-239">toolearn Další informace o Stream Analytics, najdete v části:</span><span class="sxs-lookup"><span data-stu-id="caaba-239">toolearn more about Stream Analytics, see:</span></span>

* [<span data-ttu-id="caaba-240">Začínáme používat službu Azure Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="caaba-240">Get started using Azure Stream Analytics</span></span>](stream-analytics-real-time-fraud-detection.md)
* [<span data-ttu-id="caaba-241">Škálování služby Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="caaba-241">Scale Azure Stream Analytics jobs</span></span>](stream-analytics-scale-jobs.md)
* [<span data-ttu-id="caaba-242">Referenční příručka k jazyku Azure Stream Analytics Query Language</span><span class="sxs-lookup"><span data-stu-id="caaba-242">Azure Stream Analytics Query Language Reference</span></span>](https://msdn.microsoft.com/library/azure/dn834998.aspx)
* [<span data-ttu-id="caaba-243">Referenční příručka k rozhraní REST API pro správu služby Azure Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="caaba-243">Azure Stream Analytics Management REST API Reference</span></span>](https://msdn.microsoft.com/library/azure/dn835031.aspx)
