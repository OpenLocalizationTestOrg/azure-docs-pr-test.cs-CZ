---
title: "aaaService sběrnici asynchronní zasílání zpráv | Microsoft Docs"
description: "Popis asynchronní zasílání zpráv Azure Service Bus."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: f1435549-e1f2-40cb-a280-64ea07b39fc7
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 04/19/2017
ms.author: sethm
ms.openlocfilehash: 5ab6ddf052155a9dd975b413cfaf393119c1999d
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="asynchronous-messaging-patterns-and-high-availability"></a><span data-ttu-id="fba4e-103">Asynchronní schémata zasílání zpráv a vysoká dostupnost</span><span class="sxs-lookup"><span data-stu-id="fba4e-103">Asynchronous messaging patterns and high availability</span></span>

<span data-ttu-id="fba4e-104">Asynchronní zasílání zpráv, můžou se implementovat v mnoha různými způsoby.</span><span class="sxs-lookup"><span data-stu-id="fba4e-104">Asynchronous messaging can be implemented in a variety of different ways.</span></span> <span data-ttu-id="fba4e-105">Pomocí fronty, témata a odběry Azure Service Bus podporuje asynchronism prostřednictvím dopředného mechanismus a úložiště.</span><span class="sxs-lookup"><span data-stu-id="fba4e-105">With queues, topics, and subscriptions, Azure Service Bus supports asynchronism via a store and forward mechanism.</span></span> <span data-ttu-id="fba4e-106">V běžném provozu (synchronní) odesílat zprávy tooqueues a témat a příjem zpráv z fronty a odběry.</span><span class="sxs-lookup"><span data-stu-id="fba4e-106">In normal (synchronous) operation, you send messages tooqueues and topics, and receive messages from queues and subscriptions.</span></span> <span data-ttu-id="fba4e-107">Aplikace, které můžete psát závisí na těchto entitách se vždy k dispozici.</span><span class="sxs-lookup"><span data-stu-id="fba4e-107">Applications you write depend on these entities always being available.</span></span> <span data-ttu-id="fba4e-108">Když se změní stav entity hello kvůli tooa z různých důvodů, je nutné způsob tooprovide omezenou schopnost entita, která může stát odpovědí na většinu potřeb.</span><span class="sxs-lookup"><span data-stu-id="fba4e-108">When hello entity health changes, due tooa variety of circumstances, you need a way tooprovide a reduced capability entity that can satisfy most needs.</span></span>

<span data-ttu-id="fba4e-109">Aplikace se obvykle používají asynchronní zasílání zpráv tooenable vzory pro různé scénáře komunikace.</span><span class="sxs-lookup"><span data-stu-id="fba4e-109">Applications typically use asynchronous messaging patterns tooenable a number of communication scenarios.</span></span> <span data-ttu-id="fba4e-110">Můžete vytvořit aplikace, ve kterých klienti odesílají zprávy tooservices, i když není spuštěná hello.</span><span class="sxs-lookup"><span data-stu-id="fba4e-110">You can build applications in which clients can send messages tooservices, even when hello service is not running.</span></span> <span data-ttu-id="fba4e-111">Pro aplikace, které mají shluky komunikace může pomoct fronty úrovně hello načíst tím, že poskytuje komunikační toobuffer místě.</span><span class="sxs-lookup"><span data-stu-id="fba4e-111">For applications that experience bursts of communications, a queue can help level hello load by providing a place toobuffer communications.</span></span> <span data-ttu-id="fba4e-112">Nakonec můžete získat jednoduchý, ale efektivní zatížení vyrovnávání toodistribute zprávy mezi různými počítači.</span><span class="sxs-lookup"><span data-stu-id="fba4e-112">Finally, you can get a simple but effective load balancer toodistribute messages across multiple machines.</span></span>

<span data-ttu-id="fba4e-113">V pořadí toomaintain dostupnosti všech těchto entitách vezměte v úvahu počet různé způsoby, ve kterém může vyskytovat tyto entity není k dispozici pro odolný systém zasílání zpráv.</span><span class="sxs-lookup"><span data-stu-id="fba4e-113">In order toomaintain availability of any of these entities, consider a number of different ways in which these entities can appear unavailable for a durable messaging system.</span></span> <span data-ttu-id="fba4e-114">Obecně řečeno vidíme hello entity stát není k dispozici tooapplications, kterou jsme napsali v hello následující různými způsoby:</span><span class="sxs-lookup"><span data-stu-id="fba4e-114">Generally speaking, we see hello entity become unavailable tooapplications we write in hello following different ways:</span></span>

* <span data-ttu-id="fba4e-115">Nelze toosend zprávy.</span><span class="sxs-lookup"><span data-stu-id="fba4e-115">Unable toosend messages.</span></span>
* <span data-ttu-id="fba4e-116">Nelze tooreceive zprávy.</span><span class="sxs-lookup"><span data-stu-id="fba4e-116">Unable tooreceive messages.</span></span>
* <span data-ttu-id="fba4e-117">Entity nelze toomanage (vytvořit, získat, aktualizovat nebo odstranit entity).</span><span class="sxs-lookup"><span data-stu-id="fba4e-117">Unable toomanage entities (create, retrieve, update, or delete entities).</span></span>
* <span data-ttu-id="fba4e-118">Služba nemůže toocontact hello.</span><span class="sxs-lookup"><span data-stu-id="fba4e-118">Unable toocontact hello service.</span></span>

<span data-ttu-id="fba4e-119">Pro každý z těchto chyb selhání různé režimy existovat umožňující pracovní tooperform toocontinue aplikace na určité úrovni snížené schopnosti.</span><span class="sxs-lookup"><span data-stu-id="fba4e-119">For each of these failures, different failure modes exist that enable an application toocontinue tooperform work at some level of reduced capability.</span></span> <span data-ttu-id="fba4e-120">Například systém, který může odesílat zprávy, ale není přijímat můžete nadále získávat objednávek zákazníků, ale nemůže zpracovat tyto objednávky.</span><span class="sxs-lookup"><span data-stu-id="fba4e-120">For example, a system that can send messages but not receive them can still receive orders from customers but cannot process those orders.</span></span> <span data-ttu-id="fba4e-121">Toto téma popisuje potenciální problémy, ke kterým dochází, a jak jsou omezeny těchto problémů.</span><span class="sxs-lookup"><span data-stu-id="fba4e-121">This topic discusses potential issues that can occur, and how those issues are mitigated.</span></span> <span data-ttu-id="fba4e-122">Service Bus zavedla několika způsoby zmírnění, které musí přihlásíte k odběru a toto téma taky popisuje pravidla pro hello použít tyto způsoby zmírnění výslovný souhlas hello.</span><span class="sxs-lookup"><span data-stu-id="fba4e-122">Service Bus has introduced a number of mitigations which you must opt into, and this topic also discusses hello rules governing hello use of those opt-in mitigations.</span></span>

## <a name="reliability-in-service-bus"></a><span data-ttu-id="fba4e-123">Spolehlivost v Service Bus</span><span class="sxs-lookup"><span data-stu-id="fba4e-123">Reliability in Service Bus</span></span>
<span data-ttu-id="fba4e-124">Existuje několik způsobů toohandle zprávu a entity problémy a jsou pokyny, kterými se řídí hello příslušné použití těchto způsoby zmírnění rizik.</span><span class="sxs-lookup"><span data-stu-id="fba4e-124">There are several ways toohandle message and entity issues, and there are guidelines governing hello appropriate use of those mitigations.</span></span> <span data-ttu-id="fba4e-125">toounderstand hello pokyny, nejprve je potřeba pochopit, co může selhat v Service Bus.</span><span class="sxs-lookup"><span data-stu-id="fba4e-125">toounderstand hello guidelines, you must first understand what can fail in Service Bus.</span></span> <span data-ttu-id="fba4e-126">Z důvodu toohello návrhu Azure systémů všechny tyto problémy jsou často toobe krátkodobou.</span><span class="sxs-lookup"><span data-stu-id="fba4e-126">Due toohello design of Azure systems, all of these issues tend toobe short-lived.</span></span> <span data-ttu-id="fba4e-127">Na vysoké úrovni hello různé příčiny nedostupnosti zobrazit takto:</span><span class="sxs-lookup"><span data-stu-id="fba4e-127">At a high level, hello different causes of unavailability appear as follows:</span></span>

* <span data-ttu-id="fba4e-128">Omezení z externího systému, na kterém závisí Service Bus.</span><span class="sxs-lookup"><span data-stu-id="fba4e-128">Throttling from an external system on which Service Bus depends.</span></span> <span data-ttu-id="fba4e-129">Omezení dojde na interakce s úložiště a výpočetní prostředky.</span><span class="sxs-lookup"><span data-stu-id="fba4e-129">Throttling occurs from interactions with storage and compute resources.</span></span>
* <span data-ttu-id="fba4e-130">Problém pro systém, na kterém závisí Service Bus.</span><span class="sxs-lookup"><span data-stu-id="fba4e-130">Issue for a system on which Service Bus depends.</span></span> <span data-ttu-id="fba4e-131">Například určitá část úložiště může dojít k potížím.</span><span class="sxs-lookup"><span data-stu-id="fba4e-131">For example, a given part of storage can encounter issues.</span></span>
* <span data-ttu-id="fba4e-132">Chyba služby Service Bus na jednom subsystému.</span><span class="sxs-lookup"><span data-stu-id="fba4e-132">Failure of Service Bus on single subsystem.</span></span> <span data-ttu-id="fba4e-133">V takovém případě výpočetním uzlu můžete získat v nekonzistentním stavu a restartování sám sebe, způsobuje všechny entity slouží tooload vyrovnávání tooother uzlů.</span><span class="sxs-lookup"><span data-stu-id="fba4e-133">In this situation, a compute node can get into an inconsistent state and must restart itself, causing all entities it serves tooload balance tooother nodes.</span></span> <span data-ttu-id="fba4e-134">To zase způsobit na krátkou dobu zpracování pomalé zprávy.</span><span class="sxs-lookup"><span data-stu-id="fba4e-134">This in turn can cause a short period of slow message processing.</span></span>
* <span data-ttu-id="fba4e-135">Chyba služby Service Bus v rámci datového centra Azure.</span><span class="sxs-lookup"><span data-stu-id="fba4e-135">Failure of Service Bus within an Azure datacenter.</span></span> <span data-ttu-id="fba4e-136">Jedná se o "závažnou chybu" během které hello systému nedostupný pro mnoho minut nebo několik hodin.</span><span class="sxs-lookup"><span data-stu-id="fba4e-136">This is a "catastrophic failure" during which hello system is unreachable for many minutes or a few hours.</span></span>

> [!NOTE]
> <span data-ttu-id="fba4e-137">termín Hello **úložiště** může zahrnovat Azure Storage a SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="fba4e-137">hello term **storage** can mean both Azure Storage and SQL Azure.</span></span>
> 
> 

<span data-ttu-id="fba4e-138">Service Bus obsahuje počet jejich zmírnění pro tyto problémy.</span><span class="sxs-lookup"><span data-stu-id="fba4e-138">Service Bus contains a number of mitigations for these issues.</span></span> <span data-ttu-id="fba4e-139">Hello následující části popisují jednotlivé problémy a jejich odpovídajících jejich zmírnění.</span><span class="sxs-lookup"><span data-stu-id="fba4e-139">hello following sections discuss each issue and their respective mitigations.</span></span>

### <a name="throttling"></a><span data-ttu-id="fba4e-140">Omezování</span><span class="sxs-lookup"><span data-stu-id="fba4e-140">Throttling</span></span>
<span data-ttu-id="fba4e-141">Službou Service Bus omezování umožňuje správu míra spolupráci zprávy.</span><span class="sxs-lookup"><span data-stu-id="fba4e-141">With Service Bus, throttling enables cooperative message rate management.</span></span> <span data-ttu-id="fba4e-142">Každý uzel jednotlivé služby Service Bus je umístěno mnoho entit.</span><span class="sxs-lookup"><span data-stu-id="fba4e-142">Each individual Service Bus node houses many entities.</span></span> <span data-ttu-id="fba4e-143">Každý z těchto entit vytváří požadavky na hello systému z hlediska využití procesoru, paměti, úložiště a jiné omezující vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="fba4e-143">Each of those entities makes demands on hello system in terms of CPU, memory, storage, and other facets.</span></span> <span data-ttu-id="fba4e-144">Když některé z těchto omezující vlastnosti zjistí využití který překračuje definované prahové hodnoty, Service Bus můžete odepřít daného požadavku.</span><span class="sxs-lookup"><span data-stu-id="fba4e-144">When any of these facets detects usage that exceeds defined thresholds, Service Bus can deny a given request.</span></span> <span data-ttu-id="fba4e-145">volající Hello obdrží [ServerBusyException] [ ServerBusyException] a opakování za 10 sekund.</span><span class="sxs-lookup"><span data-stu-id="fba4e-145">hello caller receives a [ServerBusyException][ServerBusyException] and retries after 10 seconds.</span></span>

<span data-ttu-id="fba4e-146">Zmírnění dopadů musí kód hello hello Chyba čtení a zastaví všechny opakování uvítací zprávu alespoň 10 sekund.</span><span class="sxs-lookup"><span data-stu-id="fba4e-146">As a mitigation, hello code must read hello error and halt any retries of hello message for at least 10 seconds.</span></span> <span data-ttu-id="fba4e-147">Vzhledem k tomu, že hello chybě může dojít mezi částí aplikace hello zákazníka, očekává se, že každého jednotlivého nezávisle provede hello logika opakovaných pokusů.</span><span class="sxs-lookup"><span data-stu-id="fba4e-147">Since hello error can happen across pieces of hello customer application, it is expected that each piece independently executes hello retry logic.</span></span> <span data-ttu-id="fba4e-148">Kód Hello může snížit pravděpodobnost hello omezené tím, že umožňuje vytváření oddílů na se fronta nebo téma.</span><span class="sxs-lookup"><span data-stu-id="fba4e-148">hello code can reduce hello probability of being throttled by enabling partitioning on a queue or topic.</span></span>

### <a name="issue-for-an-azure-dependency"></a><span data-ttu-id="fba4e-149">Problém pro Azure závislostí</span><span class="sxs-lookup"><span data-stu-id="fba4e-149">Issue for an Azure dependency</span></span>
<span data-ttu-id="fba4e-150">Ostatní součásti v rámci Azure občas může mít problémy služby.</span><span class="sxs-lookup"><span data-stu-id="fba4e-150">Other components within Azure can occasionally have service issues.</span></span> <span data-ttu-id="fba4e-151">Například pokud probíhá upgrade systému, který používá Service Bus, daný systém může dočasně mají omezenou možnosti.</span><span class="sxs-lookup"><span data-stu-id="fba4e-151">For example, when a system that Service Bus uses is being upgraded, that system can temporarily experience reduced capabilities.</span></span> <span data-ttu-id="fba4e-152">toowork kolem těchto typů problémů, Service Bus pravidelně prověří a implementuje způsoby zmírnění rizik.</span><span class="sxs-lookup"><span data-stu-id="fba4e-152">toowork around these types of issues, Service Bus regularly investigates and implements mitigations.</span></span> <span data-ttu-id="fba4e-153">Vedlejší efekty tyto způsoby zmírnění zobrazí.</span><span class="sxs-lookup"><span data-stu-id="fba4e-153">Side effects of these mitigations do appear.</span></span> <span data-ttu-id="fba4e-154">Například toohandle přechodná problémů s úložištěm, Service Bus implementuje systém, který umožňuje konzistentně toowork operace odesílání zpráv.</span><span class="sxs-lookup"><span data-stu-id="fba4e-154">For example, toohandle transient issues with storage, Service Bus implements a system that allows message send operations toowork consistently.</span></span> <span data-ttu-id="fba4e-155">Kvůli toohello povaha zmírnění hello odeslané zprávy může trvat až minut tooappear too15 v hello vliv fronty nebo předplatné a připravený pro operace příjmu.</span><span class="sxs-lookup"><span data-stu-id="fba4e-155">Due toohello nature of hello mitigation, a sent message can take up too15 minutes tooappear in hello affected queue or subscription and be ready for a receive operation.</span></span> <span data-ttu-id="fba4e-156">Obecně řečeno většiny entit nebude k tomuto problému dojde.</span><span class="sxs-lookup"><span data-stu-id="fba4e-156">Generally speaking, most entities will not experience this issue.</span></span> <span data-ttu-id="fba4e-157">Však zadána hello počet entit v Service Bus v rámci Azure tohoto omezení je někdy potřebné pro malou zákazníků služby Service Bus.</span><span class="sxs-lookup"><span data-stu-id="fba4e-157">However, given hello number of entities in Service Bus within Azure, this mitigation is sometimes needed for a small subset of Service Bus customers.</span></span>

### <a name="service-bus-failure-on-a-single-subsystem"></a><span data-ttu-id="fba4e-158">Service Bus selhání v jednom subsystému</span><span class="sxs-lookup"><span data-stu-id="fba4e-158">Service Bus failure on a single subsystem</span></span>
<span data-ttu-id="fba4e-159">S libovolnou aplikací okolností může způsobit interní součást Service Bus toobecome nekonzistentní.</span><span class="sxs-lookup"><span data-stu-id="fba4e-159">With any application, circumstances can cause an internal component of Service Bus toobecome inconsistent.</span></span> <span data-ttu-id="fba4e-160">Když Service Bus to zjistí, shromažďuje data z aplikace tooaid hello při diagnostikování, co se stalo.</span><span class="sxs-lookup"><span data-stu-id="fba4e-160">When Service Bus detects this, it collects data from hello application tooaid in diagnosing what happened.</span></span> <span data-ttu-id="fba4e-161">Jakmile se hello data shromažďují, aplikace hello je restartována v tooreturn pokusu o jeho tooa konzistentním stavu.</span><span class="sxs-lookup"><span data-stu-id="fba4e-161">Once hello data is collected, hello application is restarted in an attempt tooreturn it tooa consistent state.</span></span> <span data-ttu-id="fba4e-162">Tento proces probíhá poměrně rychle a jsou mnohem kratší výsledky v entitě zobrazování toobe není k dispozici pro až tooa několik minut, i když je typické dobu mimo provoz.</span><span class="sxs-lookup"><span data-stu-id="fba4e-162">This process happens fairly quickly, and results in an entity appearing toobe unavailable for up tooa few minutes, though typical down times are much shorter.</span></span>

<span data-ttu-id="fba4e-163">V těchto případech hello klientská aplikace generuje [System.TimeoutException] [ System.TimeoutException] nebo [MessagingException] [ MessagingException] výjimka.</span><span class="sxs-lookup"><span data-stu-id="fba4e-163">In these cases, hello client application generates a [System.TimeoutException][System.TimeoutException] or [MessagingException][MessagingException] exception.</span></span> <span data-ttu-id="fba4e-164">Service Bus obsahuje ke zmírnění tohoto problému v hello formu logika opakovaných pokusů automatizované klienta.</span><span class="sxs-lookup"><span data-stu-id="fba4e-164">Service Bus contains a mitigation for this issue in hello form of automated client retry logic.</span></span> <span data-ttu-id="fba4e-165">Jakmile doba opakování hello vyčerpá a uvítací zprávu doručeno, můžete prozkoumat pomocí dalších funkcí, jako třeba [spárovat obory názvů][paired namespaces].</span><span class="sxs-lookup"><span data-stu-id="fba4e-165">Once hello retry period is exhausted and hello message is not delivered, you can explore using other features such as [paired namespaces][paired namespaces].</span></span> <span data-ttu-id="fba4e-166">Obory názvů spárované mít další upozornění, které jsou popsané v tomto článku.</span><span class="sxs-lookup"><span data-stu-id="fba4e-166">Paired namespaces have other caveats that are discussed in that article.</span></span>

### <a name="failure-of-service-bus-within-an-azure-datacenter"></a><span data-ttu-id="fba4e-167">Selhání v rámci datového centra Azure Service Bus</span><span class="sxs-lookup"><span data-stu-id="fba4e-167">Failure of Service Bus within an Azure datacenter</span></span>
<span data-ttu-id="fba4e-168">selhání nasazení upgradu služby Service Bus nebo závislé systému je Hello nejpravděpodobnější důvod selhání v datovém centru Azure.</span><span class="sxs-lookup"><span data-stu-id="fba4e-168">hello most probable reason for a failure in an Azure datacenter is a failed upgrade deployment of Service Bus or a dependent system.</span></span> <span data-ttu-id="fba4e-169">Jak platformy hello používá, co hello pravděpodobnost selhání tohoto typu.</span><span class="sxs-lookup"><span data-stu-id="fba4e-169">As hello platform has matured, hello likelihood of this type of failure has diminished.</span></span> <span data-ttu-id="fba4e-170">Selhání datacenter může také vyskytnout z důvodů, které zahrnují následující hello:</span><span class="sxs-lookup"><span data-stu-id="fba4e-170">A datacenter failure can also happen for reasons that include hello following:</span></span>

* <span data-ttu-id="fba4e-171">Elektrický výpadek (napájení a generování power zmizí).</span><span class="sxs-lookup"><span data-stu-id="fba4e-171">Electrical outage (power supply and generating power disappear).</span></span>
* <span data-ttu-id="fba4e-172">Připojení (internet zalomení mezi klienty a Azure).</span><span class="sxs-lookup"><span data-stu-id="fba4e-172">Connectivity (internet break between your clients and Azure).</span></span>

<span data-ttu-id="fba4e-173">V obou případech havárie přírodních nebo syntetická způsobilo problém hello.</span><span class="sxs-lookup"><span data-stu-id="fba4e-173">In both cases, a natural or man-made disaster caused hello issue.</span></span> <span data-ttu-id="fba4e-174">toowork řešení a ujistěte se, že může i dál posílat zprávy, můžete použít [spárovat obory názvů] [ paired namespaces] tooenable zprávy toobe odeslané tooa druhý umístění, zatímco primární umístění hello se provádí v pořádku znovu.</span><span class="sxs-lookup"><span data-stu-id="fba4e-174">toowork around this and make sure that you can still send messages, you can use [paired namespaces][paired namespaces] tooenable messages toobe sent tooa second location while hello primary location is made healthy again.</span></span> <span data-ttu-id="fba4e-175">Další informace najdete v tématu [osvědčené postupy pro izolační aplikace proti výpadkům Service Bus a havárií][Best practices for insulating applications against Service Bus outages and disasters].</span><span class="sxs-lookup"><span data-stu-id="fba4e-175">For more information, see [Best practices for insulating applications against Service Bus outages and disasters][Best practices for insulating applications against Service Bus outages and disasters].</span></span>

## <a name="paired-namespaces"></a><span data-ttu-id="fba4e-176">Spárované obory názvů</span><span class="sxs-lookup"><span data-stu-id="fba4e-176">Paired namespaces</span></span>
<span data-ttu-id="fba4e-177">Hello [spárovat obory názvů] [ paired namespaces] funkce podporuje scénáře, ve kterém entity služby sběrnice nebo nasazení v rámci datového centra k dispozici.</span><span class="sxs-lookup"><span data-stu-id="fba4e-177">hello [paired namespaces][paired namespaces] feature supports scenarios in which a Service Bus entity or deployment within a data center becomes unavailable.</span></span> <span data-ttu-id="fba4e-178">Pokud k této události dochází zřídka, distribuovaných systémů stále musí být připraveny toohandle nejhorší scénářích případů.</span><span class="sxs-lookup"><span data-stu-id="fba4e-178">While this event occurs infrequently, distributed systems still must be prepared toohandle worst case scenarios.</span></span> <span data-ttu-id="fba4e-179">Obvykle tato událost se stane, protože některé elementu, na kterém závisí Service Bus dochází krátkodobé problém.</span><span class="sxs-lookup"><span data-stu-id="fba4e-179">Typically, this event happens because some element on which Service Bus depends is experiencing a short-term issue.</span></span> <span data-ttu-id="fba4e-180">dostupnost aplikace toomaintain během výpadku uživatelé sběrnice můžete použít dva samostatné obory názvů, pokud možno v samostatných datových centrech, toohost jejich entit pro zasílání zpráv.</span><span class="sxs-lookup"><span data-stu-id="fba4e-180">toomaintain application availability during an outage, Service Bus users can use two separate namespaces, preferably in separate data centers, toohost their messaging entities.</span></span> <span data-ttu-id="fba4e-181">Hello zbytek Tato část používá hello následující terminologií:</span><span class="sxs-lookup"><span data-stu-id="fba4e-181">hello remainder of this section uses hello following terminology:</span></span>

* <span data-ttu-id="fba4e-182">Primární obor názvů: hello obor názvů, se kterým komunikuje aplikace pro odesílání a příjmu operace.</span><span class="sxs-lookup"><span data-stu-id="fba4e-182">Primary namespace: hello namespace with which your application interacts, for send and receive operations.</span></span>
* <span data-ttu-id="fba4e-183">Sekundární obor názvů: hello obor názvů, který funguje jako zálohování toohello primární obor názvů.</span><span class="sxs-lookup"><span data-stu-id="fba4e-183">Secondary namespace: hello namespace that acts as a backup toohello primary namespace.</span></span> <span data-ttu-id="fba4e-184">Aplikace logiky nekomunikuje s Tento obor názvů.</span><span class="sxs-lookup"><span data-stu-id="fba4e-184">Application logic does not interact with this namespace.</span></span>
* <span data-ttu-id="fba4e-185">Převzetí služeb při selhání interval: hello množství času tooaccept normální selhání než aplikace hello přepíná z oboru názvů hello primární obor názvů toohello sekundární.</span><span class="sxs-lookup"><span data-stu-id="fba4e-185">Failover interval: hello amount of time tooaccept normal failures before hello application switches from hello primary namespace toohello secondary namespace.</span></span>

<span data-ttu-id="fba4e-186">Spárovat obory názvů podporu *odeslat dostupnosti*.</span><span class="sxs-lookup"><span data-stu-id="fba4e-186">Paired namespaces support *send availability*.</span></span> <span data-ttu-id="fba4e-187">Modul Send dostupnosti zachovává hello možnost toosend zprávy.</span><span class="sxs-lookup"><span data-stu-id="fba4e-187">Send availability preserves hello ability toosend messages.</span></span> <span data-ttu-id="fba4e-188">dostupnost odesílání toouse, aplikace musí splňovat hello následující požadavky:</span><span class="sxs-lookup"><span data-stu-id="fba4e-188">toouse send availability, your application must meet hello following requirements:</span></span>

1. <span data-ttu-id="fba4e-189">Zprávy jsou přijímány pouze z primární názvů hello.</span><span class="sxs-lookup"><span data-stu-id="fba4e-189">Messages are only received from hello primary namespace.</span></span>
2. <span data-ttu-id="fba4e-190">Zprávy odeslané tooa danou fronta nebo téma může dorazí mimo pořadí.</span><span class="sxs-lookup"><span data-stu-id="fba4e-190">Messages sent tooa given queue or topic might arrive out of order.</span></span>
3. <span data-ttu-id="fba4e-191">Zprávy v rámci relace může být dodány ve správném pořadí.</span><span class="sxs-lookup"><span data-stu-id="fba4e-191">Messages within a session might arrive out of order.</span></span> <span data-ttu-id="fba4e-192">Toto je zalomení z normální funkce relací.</span><span class="sxs-lookup"><span data-stu-id="fba4e-192">This is a break from normal functionality of sessions.</span></span> <span data-ttu-id="fba4e-193">To znamená, že vaše aplikace používá zprávy skupinu toologically relací.</span><span class="sxs-lookup"><span data-stu-id="fba4e-193">This means that your application uses sessions toologically group messages.</span></span>
4. <span data-ttu-id="fba4e-194">Stav relace je zachováno pouze v oboru názvů primární hello.</span><span class="sxs-lookup"><span data-stu-id="fba4e-194">Session state is only maintained on hello primary namespace.</span></span>
5. <span data-ttu-id="fba4e-195">primární fronty Hello můžete uvést do režimu online a začít přijímat zprávy před sekundární fronty hello nabízí všechny zprávy do fronty primární hello.</span><span class="sxs-lookup"><span data-stu-id="fba4e-195">hello primary queue can come online and start accepting messages before hello secondary queue delivers all messages into hello primary queue.</span></span>

<span data-ttu-id="fba4e-196">Hello následující oddíly popisují hello rozhraní API, jak jsou implementované hello rozhraní API a ukazuje ukázkový kód, který používá funkce hello.</span><span class="sxs-lookup"><span data-stu-id="fba4e-196">hello following sections discuss hello APIs, how hello APIs are implemented, and shows sample code that uses hello feature.</span></span> <span data-ttu-id="fba4e-197">Všimněte si, že jsou fakturace důsledky spojené s touto funkcí.</span><span class="sxs-lookup"><span data-stu-id="fba4e-197">Note that there are billing implications associated with this feature.</span></span>

### <a name="hello-messagingfactorypairnamespaceasync-api"></a><span data-ttu-id="fba4e-198">Hello MessagingFactory.PairNamespaceAsync rozhraní API</span><span class="sxs-lookup"><span data-stu-id="fba4e-198">hello MessagingFactory.PairNamespaceAsync API</span></span>
<span data-ttu-id="fba4e-199">Funkce obory názvů spárované Hello zahrnuje hello [PairNamespaceAsync] [ PairNamespaceAsync] metodu hello [Microsoft.ServiceBus.Messaging.MessagingFactory] [ Microsoft.ServiceBus.Messaging.MessagingFactory] třídy:</span><span class="sxs-lookup"><span data-stu-id="fba4e-199">hello paired namespaces feature includes hello [PairNamespaceAsync][PairNamespaceAsync] method on hello [Microsoft.ServiceBus.Messaging.MessagingFactory][Microsoft.ServiceBus.Messaging.MessagingFactory] class:</span></span>

```csharp
public Task PairNamespaceAsync(PairedNamespaceOptions options);
```

<span data-ttu-id="fba4e-200">Po dokončení úloh hello párování hello obor názvů je také dokončení a připravené tooact při pro žádné [MessageReceiver][MessageReceiver], [QueueClient] [ QueueClient], nebo [TopicClient] [ TopicClient] vytvořené pomocí hello [MessagingFactory] [ MessagingFactory] instance.</span><span class="sxs-lookup"><span data-stu-id="fba4e-200">When hello task completes, hello namespace pairing is also complete and ready tooact upon for any [MessageReceiver][MessageReceiver], [QueueClient][QueueClient], or [TopicClient][TopicClient] created with hello [MessagingFactory][MessagingFactory] instance.</span></span> <span data-ttu-id="fba4e-201">[Microsoft.ServiceBus.Messaging.PairedNamespaceOptions] [ Microsoft.ServiceBus.Messaging.PairedNamespaceOptions] je hello základní třídu pro hello různých typů spojení, které jsou k dispozici [MessagingFactory] [ MessagingFactory] objektu.</span><span class="sxs-lookup"><span data-stu-id="fba4e-201">[Microsoft.ServiceBus.Messaging.PairedNamespaceOptions][Microsoft.ServiceBus.Messaging.PairedNamespaceOptions] is hello base class for hello different types of pairing that are available with a [MessagingFactory][MessagingFactory] object.</span></span> <span data-ttu-id="fba4e-202">V současné době hello jen odvozené třídy je jednu s názvem [SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions], který implementuje hello odesílání dostupnosti požadavky.</span><span class="sxs-lookup"><span data-stu-id="fba4e-202">Currently, hello only derived class is one named [SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions], which implements hello send availability requirements.</span></span> <span data-ttu-id="fba4e-203">[SendAvailabilityPairedNamespaceOptions] [ SendAvailabilityPairedNamespaceOptions] obsahuje sadu konstruktory, které sestavení na sobě navzájem.</span><span class="sxs-lookup"><span data-stu-id="fba4e-203">[SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions] has a set of constructors that build on each other.</span></span> <span data-ttu-id="fba4e-204">Prohlížení hello konstruktor s hello většinu parametrů, je můžete porozumět chování hello hello další konstruktory.</span><span class="sxs-lookup"><span data-stu-id="fba4e-204">Looking at hello constructor with hello most parameters, you can understand hello behavior of hello other constructors.</span></span>

```csharp
public SendAvailabilityPairedNamespaceOptions(
    NamespaceManager secondaryNamespaceManager,
    MessagingFactory messagingFactory,
    int backlogQueueCount,
    TimeSpan failoverInterval,
    bool enableSyphon)
```

<span data-ttu-id="fba4e-205">Tyto parametry mají následující významy hello:</span><span class="sxs-lookup"><span data-stu-id="fba4e-205">These parameters have hello following meanings:</span></span>

* <span data-ttu-id="fba4e-206">*secondaryNamespaceManager*: inicializovali [NamespaceManager] [ NamespaceManager] instance pro obor názvů sekundární hello této hello [PairNamespaceAsync] [ PairNamespaceAsync] metoda může používat tooset až hello sekundární oboru názvů.</span><span class="sxs-lookup"><span data-stu-id="fba4e-206">*secondaryNamespaceManager*: An initialized [NamespaceManager][NamespaceManager] instance for hello secondary namespace that hello [PairNamespaceAsync][PairNamespaceAsync] method can use tooset up hello secondary namespace.</span></span> <span data-ttu-id="fba4e-207">obor názvů správce Hello je použité tooobtain hello seznam front v oboru názvů hello a toomake se, že existují nevyřízené položky fronty hello vyžaduje.</span><span class="sxs-lookup"><span data-stu-id="fba4e-207">hello namespace manager is used tooobtain hello list of queues in hello namespace and toomake sure that hello required backlog queues exist.</span></span> <span data-ttu-id="fba4e-208">Pokud tyto fronty nejsou k dispozici, jejich vytvoření.</span><span class="sxs-lookup"><span data-stu-id="fba4e-208">If those queues do not exist, they are created.</span></span> <span data-ttu-id="fba4e-209">[NamespaceManager] [ NamespaceManager] vyžaduje hello možnost toocreate token s hello **spravovat** deklarací identity.</span><span class="sxs-lookup"><span data-stu-id="fba4e-209">[NamespaceManager][NamespaceManager] requires hello ability toocreate a token with hello **Manage** claim.</span></span>
* <span data-ttu-id="fba4e-210">*messagingFactory*: hello [MessagingFactory] [ MessagingFactory] instance pro obor názvů sekundární hello.</span><span class="sxs-lookup"><span data-stu-id="fba4e-210">*messagingFactory*: hello [MessagingFactory][MessagingFactory] instance for hello secondary namespace.</span></span> <span data-ttu-id="fba4e-211">Hello [MessagingFactory] [ MessagingFactory] objekt je použité toosend a v případě hello [EnableSyphon] [ EnableSyphon] vlastnost je nastavena příliš**true** , přijímat zprávy z front hello nevyřízených položek.</span><span class="sxs-lookup"><span data-stu-id="fba4e-211">hello [MessagingFactory][MessagingFactory] object is used toosend and, if hello [EnableSyphon][EnableSyphon] property is set too**true**, receive messages from hello backlog queues.</span></span>
* <span data-ttu-id="fba4e-212">*backlogQueueCount*: hello počet nevyřízených položek fronty toocreate.</span><span class="sxs-lookup"><span data-stu-id="fba4e-212">*backlogQueueCount*: hello number of backlog queues toocreate.</span></span> <span data-ttu-id="fba4e-213">Tato hodnota musí být alespoň 1.</span><span class="sxs-lookup"><span data-stu-id="fba4e-213">This value must be at least 1.</span></span> <span data-ttu-id="fba4e-214">Při odesílání zprávy toohello nevyřízených položek, jednu z těchto front náhodně vybere.</span><span class="sxs-lookup"><span data-stu-id="fba4e-214">When sending messages toohello backlog, one of these queues is randomly chosen.</span></span> <span data-ttu-id="fba4e-215">Pokud nastavíte hodnotu too1 hello, můžete použít někdy tento pouze jedna fronta.</span><span class="sxs-lookup"><span data-stu-id="fba4e-215">If you set hello value too1, then only one queue can ever be used.</span></span> <span data-ttu-id="fba4e-216">Pokud k tomu dojde a hello jeden nevyřízené položky fronty generuje chyby, klient hello není možné tootry různých nevyřízené položky fronty a může selhat toosend zprávu.</span><span class="sxs-lookup"><span data-stu-id="fba4e-216">When this happens and hello one backlog queue generates errors, hello client is not able tootry a different backlog queue and may fail toosend your message.</span></span> <span data-ttu-id="fba4e-217">Doporučujeme tuto hodnotu toosome větší hodnotu a výchozí hello hodnota too10 nastavení.</span><span class="sxs-lookup"><span data-stu-id="fba4e-217">We recommend setting this value toosome larger value and default hello value too10.</span></span> <span data-ttu-id="fba4e-218">Můžete změnit tato tooa vyšší nebo nižší hodnotu v závislosti na množství dat, které vaše aplikace odešle za den.</span><span class="sxs-lookup"><span data-stu-id="fba4e-218">You can change this tooa higher or lower value depending on how much data your application sends per day.</span></span> <span data-ttu-id="fba4e-219">Každá fronta nevyřízené položky mohou být uloženy až too5 GB zpráv.</span><span class="sxs-lookup"><span data-stu-id="fba4e-219">Each backlog queue can hold up too5 GB of messages.</span></span>
* <span data-ttu-id="fba4e-220">*failoverInterval*: hello množství času, během kterého bude přijímat chyby na primární obor názvů hello před přepnutím jednu entitu přes toohello sekundární oboru názvů.</span><span class="sxs-lookup"><span data-stu-id="fba4e-220">*failoverInterval*: hello amount of time during which you will accept failures on hello primary namespace before switching any single entity over toohello secondary namespace.</span></span> <span data-ttu-id="fba4e-221">Na základě entity entity dojde k převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="fba4e-221">Failovers occur on an entity-by-entity basis.</span></span> <span data-ttu-id="fba4e-222">Entity v jeden obor názvů často za provozu v různých uzlech v rámci služby Service Bus.</span><span class="sxs-lookup"><span data-stu-id="fba4e-222">Entities in a single namespace frequently live in different nodes within Service Bus.</span></span> <span data-ttu-id="fba4e-223">Selhání v jedné entity neznamená selhání v jiném.</span><span class="sxs-lookup"><span data-stu-id="fba4e-223">A failure in one entity does not imply a failure in another.</span></span> <span data-ttu-id="fba4e-224">Tuto hodnotu můžete nastavit příliš[System.TimeSpan.Zero] [ System.TimeSpan.Zero] toofailover toohello sekundární okamžitě po selhání vaše první, pouze dočasné.</span><span class="sxs-lookup"><span data-stu-id="fba4e-224">You can set this value too[System.TimeSpan.Zero][System.TimeSpan.Zero] toofailover toohello secondary immediately after your first, non-transient failure.</span></span> <span data-ttu-id="fba4e-225">Selhání, které aktivují časovače hello převzetí služeb při selhání jsou [MessagingException] [ MessagingException] v které hello [IsTransient] [ IsTransient] vlastnost je nastavena hodnota false, nebo [System.TimeoutException][System.TimeoutException].</span><span class="sxs-lookup"><span data-stu-id="fba4e-225">Failures that trigger hello failover timer are any [MessagingException][MessagingException] in which hello [IsTransient][IsTransient] property is false, or a [System.TimeoutException][System.TimeoutException].</span></span> <span data-ttu-id="fba4e-226">Ostatní výjimky, jako například [UnauthorizedAccessException] [ UnauthorizedAccessException] nezpůsobí převzetí služeb při selhání, protože označují, že klient hello není správně nakonfigurovaná.</span><span class="sxs-lookup"><span data-stu-id="fba4e-226">Other exceptions, such as [UnauthorizedAccessException][UnauthorizedAccessException] do not cause failover, because they indicate that hello client is configured incorrectly.</span></span> <span data-ttu-id="fba4e-227">A [ServerBusyException] [ ServerBusyException] nemá příčina převzetí služeb při selhání protože správné vzor hello je toowait 10 sekund, potom uvítací zprávu znovu odešlete.</span><span class="sxs-lookup"><span data-stu-id="fba4e-227">A [ServerBusyException][ServerBusyException] does not cause failover because hello correct pattern is toowait 10 seconds, then send hello message again.</span></span>
* <span data-ttu-id="fba4e-228">*enableSyphon*: Určuje, že tato konkrétní párování by také syphon zprávy z primární názvů back toohello hello sekundární oboru názvů.</span><span class="sxs-lookup"><span data-stu-id="fba4e-228">*enableSyphon*: Indicates that this particular pairing should also syphon messages from hello secondary namespace back toohello primary namespace.</span></span> <span data-ttu-id="fba4e-229">Obecně platí, aplikace, které odesílají zprávy měli nastavit hodnotu příliš**false**; aplikace, které přijímají zprávy musí tato hodnota nastavená příliš**true**.</span><span class="sxs-lookup"><span data-stu-id="fba4e-229">In general, applications that send messages should set this value too**false**; applications that receive messages should set this value too**true**.</span></span> <span data-ttu-id="fba4e-230">Hello důvodem je, že často, existují méně příjemci zprávy než odesílatelé zpráv.</span><span class="sxs-lookup"><span data-stu-id="fba4e-230">hello reason for this is that frequently, there are fewer message receivers than message senders.</span></span> <span data-ttu-id="fba4e-231">V závislosti na hello počet příjemců můžete toohave jednu aplikaci instance popisovače hello Trativod povinností.</span><span class="sxs-lookup"><span data-stu-id="fba4e-231">Depending on hello number of receivers, you can choose toohave a single application instance handle hello syphon duties.</span></span> <span data-ttu-id="fba4e-232">Použití mnoha příjemci má fakturační důsledky pro každou frontu nevyřízených položek.</span><span class="sxs-lookup"><span data-stu-id="fba4e-232">Using many receivers has billing implications for each backlog queue.</span></span>

<span data-ttu-id="fba4e-233">toouse hello kódu, vytvořit primární [MessagingFactory] [ MessagingFactory] instance, sekundární [MessagingFactory] [ MessagingFactory] instance, sekundární databázi [NamespaceManager] [ NamespaceManager] instance a [SendAvailabilityPairedNamespaceOptions] [ SendAvailabilityPairedNamespaceOptions] instance.</span><span class="sxs-lookup"><span data-stu-id="fba4e-233">toouse hello code, create a primary [MessagingFactory][MessagingFactory] instance, a secondary [MessagingFactory][MessagingFactory] instance, a secondary [NamespaceManager][NamespaceManager] instance, and a [SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions] instance.</span></span> <span data-ttu-id="fba4e-234">Hello volání může být stejně jednoduché jako hello následující:</span><span class="sxs-lookup"><span data-stu-id="fba4e-234">hello call can be as simple as hello following:</span></span>

```csharp
SendAvailabilityPairedNamespaceOptions sendAvailabilityOptions = new SendAvailabilityPairedNamespaceOptions(secondaryNamespaceManager, secondary);
primary.PairNamespaceAsync(sendAvailabilityOptions).Wait();
```

<span data-ttu-id="fba4e-235">Když hello Úloha vrácená hello [PairNamespaceAsync] [ PairNamespaceAsync] metoda dokončí, vše, co je nastavit a připravené toouse.</span><span class="sxs-lookup"><span data-stu-id="fba4e-235">When hello task returned by hello [PairNamespaceAsync][PairNamespaceAsync] method completes, everything is set up and ready toouse.</span></span> <span data-ttu-id="fba4e-236">Předtím, než se vrátí hello úloh, pravděpodobně nebyly dokončeny, všechny práce na pozadí hello, které jsou nezbytné pro hello párování toowork vpravo.</span><span class="sxs-lookup"><span data-stu-id="fba4e-236">Before hello task is returned, you may not have completed all of hello background work necessary for hello pairing toowork right.</span></span> <span data-ttu-id="fba4e-237">V důsledku toho by neměl spustit, odesílání zpráv, dokud vrátí hello úloh.</span><span class="sxs-lookup"><span data-stu-id="fba4e-237">As a result, you should not start sending messages until hello task returns.</span></span> <span data-ttu-id="fba4e-238">Pokud došlo k jeho selhání, třeba chybná přihlašovací údaje nebo selhání toocreate hello nevyřízené položky fronty, budou tyto výjimky vyvolány po dokončení úlohy hello.</span><span class="sxs-lookup"><span data-stu-id="fba4e-238">If any failures occurred, such as bad credentials, or failure toocreate hello backlog queues, those exceptions will be thrown once hello task completes.</span></span> <span data-ttu-id="fba4e-239">Po hello úkolů vrátí, ověřte, zda byly hello fronty najít nebo vytvořit tak, že prověří hello [BacklogQueueCount] [ BacklogQueueCount] vlastnost na vaše [SendAvailabilityPairedNamespaceOptions] [ SendAvailabilityPairedNamespaceOptions] instance.</span><span class="sxs-lookup"><span data-stu-id="fba4e-239">Once hello task returns, verify that hello queues were found or created by examining hello [BacklogQueueCount][BacklogQueueCount] property on your [SendAvailabilityPairedNamespaceOptions][SendAvailabilityPairedNamespaceOptions] instance.</span></span> <span data-ttu-id="fba4e-240">Pro hello předcházející kód, který operaci vypadat takto:</span><span class="sxs-lookup"><span data-stu-id="fba4e-240">For hello preceding code, that operation appears as follows:</span></span>

```csharp
if (sendAvailabilityOptions.BacklogQueueCount < 1)
{
    // Handle case where no queues were created.
}
```

## <a name="next-steps"></a><span data-ttu-id="fba4e-241">Další kroky</span><span class="sxs-lookup"><span data-stu-id="fba4e-241">Next steps</span></span>
<span data-ttu-id="fba4e-242">Teď, když jste se naučili základy hello asynchronní zasílání zpráv ve sběrnici Service Bus, přečtěte si další informace o [spárovat obory názvů][paired namespaces].</span><span class="sxs-lookup"><span data-stu-id="fba4e-242">Now that you've learned hello basics of asynchronous messaging in Service Bus, read more details about [paired namespaces][paired namespaces].</span></span>

[ServerBusyException]: /dotnet/api/microsoft.servicebus.messaging.serverbusyexception
[System.TimeoutException]: https://msdn.microsoft.com/library/system.timeoutexception.aspx
[MessagingException]: /dotnet/api/microsoft.servicebus.messaging.messagingexception
[Best practices for insulating applications against Service Bus outages and disasters]: service-bus-outages-disasters.md
[Microsoft.ServiceBus.Messaging.MessagingFactory]: /dotnet/api/microsoft.servicebus.messaging.messagingfactory
[MessageReceiver]: /dotnet/api/microsoft.servicebus.messaging.messagereceiver
[QueueClient]: /dotnet/api/microsoft.servicebus.messaging.queueclient
[TopicClient]: /dotnet/api/microsoft.servicebus.messaging.topicclient
[Microsoft.ServiceBus.Messaging.PairedNamespaceOptions]: /dotnet/api/microsoft.servicebus.messaging.pairednamespaceoptions
[MessagingFactory]: /dotnet/api/microsoft.servicebus.messaging.messagingfactory
[SendAvailabilityPairedNamespaceOptions]: /dotnet/api/microsoft.servicebus.messaging.sendavailabilitypairednamespaceoptions
[NamespaceManager]: /dotnet/api/microsoft.servicebus.namespacemanager
[PairNamespaceAsync]: /dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_PairNamespaceAsync_Microsoft_ServiceBus_Messaging_PairedNamespaceOptions_
[EnableSyphon]: /dotnet/api/microsoft.servicebus.messaging.sendavailabilitypairednamespaceoptions#Microsoft_ServiceBus_Messaging_SendAvailabilityPairedNamespaceOptions_EnableSyphon
[System.TimeSpan.Zero]: https://msdn.microsoft.com/library/system.timespan.zero.aspx
[IsTransient]: /dotnet/api/microsoft.servicebus.messaging.messagingexception#Microsoft_ServiceBus_Messaging_MessagingException_IsTransient
[UnauthorizedAccessException]: https://msdn.microsoft.com/library/system.unauthorizedaccessexception.aspx
[BacklogQueueCount]: /dotnet/api/microsoft.servicebus.messaging.sendavailabilitypairednamespaceoptions?redirectedfrom=MSDN#Microsoft_ServiceBus_Messaging_SendAvailabilityPairedNamespaceOptions_BacklogQueueCount
[paired namespaces]: service-bus-paired-namespaces.md
