---
title: "aaaBest postupy pro zlepšení výkonu pomocí Azure Service Bus | Microsoft Docs"
description: "Popisuje, jak toouse Service Bus toooptimize výkon při výměně zprostředkované zprávy."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: e756c15d-31fc-45c0-8df4-0bca0da10bb2
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 05/10/2017
ms.author: sethm
ms.openlocfilehash: 52764d227757cbb11246675878933f21685817f1
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="best-practices-for-performance-improvements-using-service-bus-messaging"></a><span data-ttu-id="0bba3-103">Osvědčené postupy pro zlepšení výkonu pomocí zasílání zpráv Service Bus</span><span class="sxs-lookup"><span data-stu-id="0bba3-103">Best Practices for performance improvements using Service Bus Messaging</span></span>

<span data-ttu-id="0bba3-104">Tento článek popisuje, jak toouse [zasílání zpráv Azure Service Bus](https://azure.microsoft.com/services/service-bus/) toooptimize výkon při výměně zprostředkované zprávy.</span><span class="sxs-lookup"><span data-stu-id="0bba3-104">This article describes how toouse [Azure Service Bus messaging](https://azure.microsoft.com/services/service-bus/) toooptimize performance when exchanging brokered messages.</span></span> <span data-ttu-id="0bba3-105">první část Hello Toto téma popisuje hello různé mechanismy, které jsou nabízeny toohelp zvýšení výkonu.</span><span class="sxs-lookup"><span data-stu-id="0bba3-105">hello first part of this topic describes hello different mechanisms that are offered toohelp increase performance.</span></span> <span data-ttu-id="0bba3-106">Druhá část Hello obsahuje pokyny k jak hello toouse Service Bus tak, že můžete nabídnout nejlepší výkon v daném scénáři.</span><span class="sxs-lookup"><span data-stu-id="0bba3-106">hello second part provides guidance on how toouse Service Bus in a way that can offer hello best performance in a given scenario.</span></span>

<span data-ttu-id="0bba3-107">Hello termín "client" v tomto tématu se vztahuje tooany entity, který přistupuje k Service Bus.</span><span class="sxs-lookup"><span data-stu-id="0bba3-107">Throughout this topic, hello term "client" refers tooany entity that accesses Service Bus.</span></span> <span data-ttu-id="0bba3-108">Klient může trvat hello role odesílatele nebo příjemce.</span><span class="sxs-lookup"><span data-stu-id="0bba3-108">A client can take hello role of a sender or a receiver.</span></span> <span data-ttu-id="0bba3-109">Hello termín "sender" se používá pro Service Bus fronta nebo téma klienta, který odesílá zprávy fronty Service Bus tooa nebo téma.</span><span class="sxs-lookup"><span data-stu-id="0bba3-109">hello term "sender" is used for a Service Bus queue or topic client that sends messages tooa Service Bus queue or topic.</span></span> <span data-ttu-id="0bba3-110">Hello termín "příjemce" odkazuje tooa Service Bus fronty nebo předplatného klienta, který přijímá zprávy z fronty Service Bus nebo předplatné.</span><span class="sxs-lookup"><span data-stu-id="0bba3-110">hello term "receiver" refers tooa Service Bus queue or subscription client that receives messages from a Service Bus queue or subscription.</span></span>

<span data-ttu-id="0bba3-111">Tyto části seznámí několik konceptů, že Service Bus používá toohelp výkonu.</span><span class="sxs-lookup"><span data-stu-id="0bba3-111">These sections introduce several concepts that Service Bus uses toohelp boost performance.</span></span>

## <a name="protocols"></a><span data-ttu-id="0bba3-112">Protokoly</span><span class="sxs-lookup"><span data-stu-id="0bba3-112">Protocols</span></span>
<span data-ttu-id="0bba3-113">Service Bus umožňuje toosend klientů a přijímat zprávy přes jeden ze tří protokolů:</span><span class="sxs-lookup"><span data-stu-id="0bba3-113">Service Bus enables clients toosend and receive messages via one of three protocols:</span></span>

1. <span data-ttu-id="0bba3-114">Pokročilé zpráv služby Řízení front Protocol (AMQP)</span><span class="sxs-lookup"><span data-stu-id="0bba3-114">Advanced Message Queuing Protocol (AMQP)</span></span>
2. <span data-ttu-id="0bba3-115">Sběrnice zpráv protokolu (SBMP)</span><span class="sxs-lookup"><span data-stu-id="0bba3-115">Service Bus Messaging Protocol (SBMP)</span></span>
3. <span data-ttu-id="0bba3-116">HTTP</span><span class="sxs-lookup"><span data-stu-id="0bba3-116">HTTP</span></span>

<span data-ttu-id="0bba3-117">Protokoly AMQP a SBMP jsou efektivnější, protože udržují hello připojení tooService sběrnice, dokud existuje objekt pro vytváření zpráv hello.</span><span class="sxs-lookup"><span data-stu-id="0bba3-117">AMQP and SBMP are more efficient, because they maintain hello connection tooService Bus as long as hello messaging factory exists.</span></span> <span data-ttu-id="0bba3-118">Také implementuje dávkování a prefetching.</span><span class="sxs-lookup"><span data-stu-id="0bba3-118">It also implements batching and prefetching.</span></span> <span data-ttu-id="0bba3-119">Pokud není výslovně uvedeno, veškerý obsah v tomto tématu se předpokládá použití hello AMQP nebo SBMP.</span><span class="sxs-lookup"><span data-stu-id="0bba3-119">Unless explicitly mentioned, all content in this topic assumes hello use of AMQP or SBMP.</span></span>

## <a name="reusing-factories-and-clients"></a><span data-ttu-id="0bba3-120">Opětovné použití objektů Factory a klientů</span><span class="sxs-lookup"><span data-stu-id="0bba3-120">Reusing factories and clients</span></span>
<span data-ttu-id="0bba3-121">Service Bus klient objekty, jako například [QueueClient] [ QueueClient] nebo [MessageSender][MessageSender], jsou vytvořeny pomocí [ MessagingFactory] [ MessagingFactory] objekt, který také poskytuje interní správu připojení.</span><span class="sxs-lookup"><span data-stu-id="0bba3-121">Service Bus client objects, such as [QueueClient][QueueClient] or [MessageSender][MessageSender], are created through a [MessagingFactory][MessagingFactory] object, which also provides internal management of connections.</span></span> <span data-ttu-id="0bba3-122">Zasílání zpráv objekty Factory nebo fronty, témata a předplatné klientů by neměl zavřít po odeslat zprávu a pak hello další zprávu odešlete znovu vytvořit.</span><span class="sxs-lookup"><span data-stu-id="0bba3-122">You should not close messaging factories or queue, topic, and subscription clients after you send a message, and then re-create them when you send hello next message.</span></span> <span data-ttu-id="0bba3-123">Zavřením instanci messagingfactory odstraní hello připojení toohello sběrnice služby a je vytvořeno nové připojení, když znovu vytvořit objekt pro vytváření hello.</span><span class="sxs-lookup"><span data-stu-id="0bba3-123">Closing a messaging factory deletes hello connection toohello Service Bus service, and a new connection is established when recreating hello factory.</span></span> <span data-ttu-id="0bba3-124">Navazování připojení je náročná operace, se můžete vyhnout znovu pomocí hello stejný objekt pro vytváření a klienta objekty pro více operací.</span><span class="sxs-lookup"><span data-stu-id="0bba3-124">Establishing a connection is an expensive operation that you can avoid by re-using hello same factory and client objects for multiple operations.</span></span> <span data-ttu-id="0bba3-125">Můžete bezpečně hello [QueueClient] [ QueueClient] objekt pro odesílání zpráv z více vláken a souběžných asynchronní operace.</span><span class="sxs-lookup"><span data-stu-id="0bba3-125">You can safely use hello [QueueClient][QueueClient] object for sending messages from concurrent asynchronous operations and multiple threads.</span></span> 

## <a name="concurrent-operations"></a><span data-ttu-id="0bba3-126">Souběžných operací</span><span class="sxs-lookup"><span data-stu-id="0bba3-126">Concurrent operations</span></span>
<span data-ttu-id="0bba3-127">Provádění operace (odesílání, příjem, odstranit, apod) nějakou dobu trvá.</span><span class="sxs-lookup"><span data-stu-id="0bba3-127">Performing an operation (send, receive, delete, etc.) takes some time.</span></span> <span data-ttu-id="0bba3-128">Tentokrát zahrnuje hello zpracování operace hello podle hello služby Service Bus v přidání toohello latenci dotazů a odpovědí hello hello.</span><span class="sxs-lookup"><span data-stu-id="0bba3-128">This time includes hello processing of hello operation by hello Service Bus service in addition toohello latency of hello request and hello reply.</span></span> <span data-ttu-id="0bba3-129">tooincrease hello počet operací za čas, operace musí být spuštěn současně.</span><span class="sxs-lookup"><span data-stu-id="0bba3-129">tooincrease hello number of operations per time, operations must execute concurrently.</span></span> <span data-ttu-id="0bba3-130">Můžete provést několika různými způsoby:</span><span class="sxs-lookup"><span data-stu-id="0bba3-130">You can do this in several different ways:</span></span>

* <span data-ttu-id="0bba3-131">**Asynchronní operace**: hello klienta plány operations provedením asynchronní operace.</span><span class="sxs-lookup"><span data-stu-id="0bba3-131">**Asynchronous operations**: hello client schedules operations by performing asynchronous operations.</span></span> <span data-ttu-id="0bba3-132">Další požadavek Hello je spuštěn před dokončením hello předchozí požadavek.</span><span class="sxs-lookup"><span data-stu-id="0bba3-132">hello next request is started before hello previous request is completed.</span></span> <span data-ttu-id="0bba3-133">Hello tady je příklad operace asynchronní odesílání:</span><span class="sxs-lookup"><span data-stu-id="0bba3-133">hello following is an example of an asynchronous send operation:</span></span>
  
 ```csharp
  BrokeredMessage m1 = new BrokeredMessage(body);
  BrokeredMessage m2 = new BrokeredMessage(body);
  
  Task send1 = queueClient.SendAsync(m1).ContinueWith((t) => 
    {
      Console.WriteLine("Sent message #1");
    });
  Task send2 = queueClient.SendAsync(m2).ContinueWith((t) => 
    {
      Console.WriteLine("Sent message #2");
    });
  Task.WaitAll(send1, send2);
  Console.WriteLine("All messages sent");
  ```
  
  <span data-ttu-id="0bba3-134">Toto je příklad asynchronní příjem operace:</span><span class="sxs-lookup"><span data-stu-id="0bba3-134">This is an example of an asynchronous receive operation:</span></span>
  
  ```csharp
  Task receive1 = queueClient.ReceiveAsync().ContinueWith(ProcessReceivedMessage);
  Task receive2 = queueClient.ReceiveAsync().ContinueWith(ProcessReceivedMessage);
  
  Task.WaitAll(receive1, receive2);
  Console.WriteLine("All messages received");
  
  async void ProcessReceivedMessage(Task<BrokeredMessage> t)
  {
    BrokeredMessage m = t.Result;
    Console.WriteLine("{0} received", m.Label);
    await m.CompleteAsync();
    Console.WriteLine("{0} complete", m.Label);
  }
  ```
* <span data-ttu-id="0bba3-135">**Více objektů Factory**: Všichni klienti (odesílatelé v přidání tooreceivers), které jsou vytvořené pomocí hello stejný objekt pro vytváření sdílené složky jednoho připojení TCP.</span><span class="sxs-lookup"><span data-stu-id="0bba3-135">**Multiple factories**: all clients (senders in addition tooreceivers) that are created by hello same factory share one TCP connection.</span></span> <span data-ttu-id="0bba3-136">Hello zprávy maximální propustnost je omezena hello počet operací, které můžete přejít přes toto připojení TCP.</span><span class="sxs-lookup"><span data-stu-id="0bba3-136">hello maximum message throughput is limited by hello number of operations that can go through this TCP connection.</span></span> <span data-ttu-id="0bba3-137">Hello propustnost, kterou lze získat pomocí jednoho factory se výrazně liší podle doby odezvy TCP a velikost zprávy.</span><span class="sxs-lookup"><span data-stu-id="0bba3-137">hello throughput that can be obtained with a single factory varies greatly with TCP round-trip times and message size.</span></span> <span data-ttu-id="0bba3-138">tooobtain počty vyšší propustnost, byste měli používat více objektů Factory zasílání zpráv.</span><span class="sxs-lookup"><span data-stu-id="0bba3-138">tooobtain higher throughput rates, you should use multiple messaging factories.</span></span>

## <a name="receive-mode"></a><span data-ttu-id="0bba3-139">Zobrazí režim</span><span class="sxs-lookup"><span data-stu-id="0bba3-139">Receive mode</span></span>
<span data-ttu-id="0bba3-140">Při vytvoření fronty nebo předplatného klienta, můžete určit režim příjmu: *funkce Náhled zámku* nebo *přijetí a odstranění*.</span><span class="sxs-lookup"><span data-stu-id="0bba3-140">When creating a queue or subscription client, you can specify a receive mode: *Peek-lock* or *Receive and Delete*.</span></span> <span data-ttu-id="0bba3-141">Výchozí Hello přijímat režimu je [PeekLock][PeekLock].</span><span class="sxs-lookup"><span data-stu-id="0bba3-141">hello default receive mode is [PeekLock][PeekLock].</span></span> <span data-ttu-id="0bba3-142">Při fungování v tomto režimu, hello klienta odešle požadavek tooreceive zprávu ze sběrnice.</span><span class="sxs-lookup"><span data-stu-id="0bba3-142">When operating in this mode, hello client sends a request tooreceive a message from Service Bus.</span></span> <span data-ttu-id="0bba3-143">Po přijetí uvítací zprávu klienta hello odešle zprávu požadavku toocomplete hello.</span><span class="sxs-lookup"><span data-stu-id="0bba3-143">After hello client has received hello message, it sends a request toocomplete hello message.</span></span>

<span data-ttu-id="0bba3-144">Při nastavení hello přijímat režimu příliš[ReceiveAndDelete][ReceiveAndDelete], oba kroky se zkombinují v jedné žádosti.</span><span class="sxs-lookup"><span data-stu-id="0bba3-144">When setting hello receive mode too[ReceiveAndDelete][ReceiveAndDelete], both steps are combined in a single request.</span></span> <span data-ttu-id="0bba3-145">Tím se zkracuje hello celkový počet operací a může zvýšit hello celkovou propustnost zpráv.</span><span class="sxs-lookup"><span data-stu-id="0bba3-145">This reduces hello overall number of operations, and can improve hello overall message throughput.</span></span> <span data-ttu-id="0bba3-146">Tato výkonnější kompromisnímu hello riziko ztráty zprávy.</span><span class="sxs-lookup"><span data-stu-id="0bba3-146">This performance gain comes at hello risk of losing messages.</span></span>

<span data-ttu-id="0bba3-147">Service Bus nepodporuje transakce pro operace přijímat a odstranění.</span><span class="sxs-lookup"><span data-stu-id="0bba3-147">Service Bus does not support transactions for receive-and-delete operations.</span></span> <span data-ttu-id="0bba3-148">Kromě toho jsou požadovány pro všechny scénáře, ve které hello klienta chce toodefer sémantiku funkce Náhled uzamčení nebo [nedoručených zpráv](service-bus-dead-letter-queues.md) zprávu.</span><span class="sxs-lookup"><span data-stu-id="0bba3-148">In addition, peek-lock semantics are required for any scenarios in which hello client wants toodefer or [dead-letter](service-bus-dead-letter-queues.md) a message.</span></span>

## <a name="client-side-batching"></a><span data-ttu-id="0bba3-149">Dávkování na straně klienta</span><span class="sxs-lookup"><span data-stu-id="0bba3-149">Client-side batching</span></span>
<span data-ttu-id="0bba3-150">Dávkování na straně klienta umožňuje fronta nebo téma klienta toodelay hello odesílání zpráv pro určitou dobu.</span><span class="sxs-lookup"><span data-stu-id="0bba3-150">Client-side batching enables a queue or topic client toodelay hello sending of a message for a certain period of time.</span></span> <span data-ttu-id="0bba3-151">Pokud klient hello odešle další zprávy během tohoto období, přenáší zprávy hello v jedné dávce.</span><span class="sxs-lookup"><span data-stu-id="0bba3-151">If hello client sends additional messages during this time period, it transmits hello messages in a single batch.</span></span> <span data-ttu-id="0bba3-152">Dávkování na straně klienta rovněž způsobí, že fronty nebo předplatného klienta toobatch více **Complete** požadavky do jedné žádosti.</span><span class="sxs-lookup"><span data-stu-id="0bba3-152">Client-side batching also causes a queue or subscription client toobatch multiple **Complete** requests into a single request.</span></span> <span data-ttu-id="0bba3-153">Dávkování je dostupná jenom pro asynchronní **odeslat** a **Complete** operace.</span><span class="sxs-lookup"><span data-stu-id="0bba3-153">Batching is only available for asynchronous **Send** and **Complete** operations.</span></span> <span data-ttu-id="0bba3-154">Synchronní operace jsou okamžitě se odešlou toohello služby Service Bus.</span><span class="sxs-lookup"><span data-stu-id="0bba3-154">Synchronous operations are immediately sent toohello Service Bus service.</span></span> <span data-ttu-id="0bba3-155">Dávkování dojít k funkce Náhled nebo přijímat operace, ani dávkování dojde k do klientů.</span><span class="sxs-lookup"><span data-stu-id="0bba3-155">Batching does not occur for peek or receive operations, nor does batching occur across clients.</span></span>

<span data-ttu-id="0bba3-156">Ve výchozím nastavení používá klienta s intervalem batch 20ms.</span><span class="sxs-lookup"><span data-stu-id="0bba3-156">By default, a client uses a batch interval of 20ms.</span></span> <span data-ttu-id="0bba3-157">Hello batch interval můžete změnit nastavení hello [BatchFlushInterval] [ BatchFlushInterval] vlastnost před vytvořením hello messagingfactory.</span><span class="sxs-lookup"><span data-stu-id="0bba3-157">You can change hello batch interval by setting hello [BatchFlushInterval][BatchFlushInterval] property before creating hello messaging factory.</span></span> <span data-ttu-id="0bba3-158">Toto nastavení ovlivní všechny klienty, které jsou vytvořené pomocí tento objekt pro vytváření.</span><span class="sxs-lookup"><span data-stu-id="0bba3-158">This setting affects all clients that are created by this factory.</span></span>

<span data-ttu-id="0bba3-159">dávkování toodisable, nastavte hello [BatchFlushInterval] [ BatchFlushInterval] vlastnost příliš**TimeSpan.Zero**.</span><span class="sxs-lookup"><span data-stu-id="0bba3-159">toodisable batching, set hello [BatchFlushInterval][BatchFlushInterval] property too**TimeSpan.Zero**.</span></span> <span data-ttu-id="0bba3-160">Například:</span><span class="sxs-lookup"><span data-stu-id="0bba3-160">For example:</span></span>

```csharp
MessagingFactorySettings mfs = new MessagingFactorySettings();
mfs.TokenProvider = tokenProvider;
mfs.NetMessagingTransportSettings.BatchFlushInterval = TimeSpan.FromSeconds(0.05);
MessagingFactory messagingFactory = MessagingFactory.Create(namespaceUri, mfs);
```

<span data-ttu-id="0bba3-161">Dávkování nemá vliv na hello počet operací, fakturovatelný zasílání zpráv a je dostupná jenom pro hello protokolu klienta služby Service Bus.</span><span class="sxs-lookup"><span data-stu-id="0bba3-161">Batching does not affect hello number of billable messaging operations, and is available only for hello Service Bus client protocol.</span></span> <span data-ttu-id="0bba3-162">Hello protokolu HTTP nepodporuje dávkování.</span><span class="sxs-lookup"><span data-stu-id="0bba3-162">hello HTTP protocol does not support batching.</span></span>

## <a name="batching-store-access"></a><span data-ttu-id="0bba3-163">Dávkování přístup k úložišti</span><span class="sxs-lookup"><span data-stu-id="0bba3-163">Batching store access</span></span>
<span data-ttu-id="0bba3-164">tooincrease propustnost hello fronty, tématu nebo předplatného, Service Bus dávek více zpráv při zápisu tooits interní úložiště.</span><span class="sxs-lookup"><span data-stu-id="0bba3-164">tooincrease hello throughput of a queue, topic, or subscription, Service Bus batches multiple messages when it writes tooits internal store.</span></span> <span data-ttu-id="0bba3-165">Pokud je povoleno na se fronta nebo téma, zápis zpráv do úložiště hello se zpracovat v dávce.</span><span class="sxs-lookup"><span data-stu-id="0bba3-165">If enabled on a queue or topic, writing messages into hello store will be batched.</span></span> <span data-ttu-id="0bba3-166">Pokud je povoleno na fronty nebo předplatného, odstranění zprávy z hello úložiště bude zpracovat v dávce.</span><span class="sxs-lookup"><span data-stu-id="0bba3-166">If enabled on a queue or subscription, deleting messages from hello store will be batched.</span></span> <span data-ttu-id="0bba3-167">Pokud je povolený přístup dávkové úložiště pro entitu, Service Bus zpozdí operace zápisu úložiště o dané entity podle až too20ms.</span><span class="sxs-lookup"><span data-stu-id="0bba3-167">If batched store access is enabled for an entity, Service Bus delays a store write operation regarding that entity by up too20ms.</span></span> <span data-ttu-id="0bba3-168">Další úložiště operace, ke kterým došlo během tohoto intervalu jsou přidány toohello dávky.</span><span class="sxs-lookup"><span data-stu-id="0bba3-168">Additional store operations that occur during this interval are added toohello batch.</span></span> <span data-ttu-id="0bba3-169">Zpracovat v dávce ovlivňuje pouze přístup k úložišti **odeslat** a **Complete** operace; přijímat operace neovlivní.</span><span class="sxs-lookup"><span data-stu-id="0bba3-169">Batched store access only affects **Send** and **Complete** operations; receive operations are not affected.</span></span> <span data-ttu-id="0bba3-170">Dávkové úložiště přístup je vlastnost u entity.</span><span class="sxs-lookup"><span data-stu-id="0bba3-170">Batched store access is a property on an entity.</span></span> <span data-ttu-id="0bba3-171">Dávkování dochází mezi všechny entity, které umožňují přístup dávkové úložiště.</span><span class="sxs-lookup"><span data-stu-id="0bba3-171">Batching occurs across all entities that enable batched store access.</span></span>

<span data-ttu-id="0bba3-172">Při vytváření nové fronty, tématu nebo předplatného, je ve výchozím nastavení povolen přístup dávkové úložiště.</span><span class="sxs-lookup"><span data-stu-id="0bba3-172">When creating a new queue, topic or subscription, batched store access is enabled by default.</span></span> <span data-ttu-id="0bba3-173">toodisable zpracovat v dávce přístup k úložišti, sada hello [EnableBatchedOperations] [ EnableBatchedOperations] vlastnost příliš**false** před vytvořením hello entity.</span><span class="sxs-lookup"><span data-stu-id="0bba3-173">toodisable batched store access, set hello [EnableBatchedOperations][EnableBatchedOperations] property too**false** before creating hello entity.</span></span> <span data-ttu-id="0bba3-174">Například:</span><span class="sxs-lookup"><span data-stu-id="0bba3-174">For example:</span></span>

```csharp
QueueDescription qd = new QueueDescription();
qd.EnableBatchedOperations = false;
Queue q = namespaceManager.CreateQueue(qd);
```

<span data-ttu-id="0bba3-175">Dávkové úložiště přístup nemá vliv na hello počet operací, fakturovatelný zasílání zpráv a je vlastností fronty, tématu nebo předplatného.</span><span class="sxs-lookup"><span data-stu-id="0bba3-175">Batched store access does not affect hello number of billable messaging operations, and is a property of a queue, topic, or subscription.</span></span> <span data-ttu-id="0bba3-176">Je nezávislý na hello přijímat režim a hello protokol, který se používá mezi klientem a hello služby Service Bus.</span><span class="sxs-lookup"><span data-stu-id="0bba3-176">It is independent of hello receive mode and hello protocol that is used between a client and hello Service Bus service.</span></span>

## <a name="prefetching"></a><span data-ttu-id="0bba3-177">Prefetching</span><span class="sxs-lookup"><span data-stu-id="0bba3-177">Prefetching</span></span>
<span data-ttu-id="0bba3-178">Prefetching umožňuje hello fronty nebo předplatného klienta tooload další zprávy ze služby hello při provádění operace příjmu.</span><span class="sxs-lookup"><span data-stu-id="0bba3-178">Prefetching enables hello queue or subscription client tooload additional messages from hello service when it performs a receive operation.</span></span> <span data-ttu-id="0bba3-179">Klient Hello ukládá tyto zprávy v místní mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="0bba3-179">hello client stores these messages in a local cache.</span></span> <span data-ttu-id="0bba3-180">Hello velikost mezipaměti hello je dáno hello [QueueClient.PrefetchCount] [ QueueClient.PrefetchCount] nebo [SubscriptionClient.PrefetchCount] [ SubscriptionClient.PrefetchCount] Vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="0bba3-180">hello size of hello cache is determined by hello [QueueClient.PrefetchCount][QueueClient.PrefetchCount] or [SubscriptionClient.PrefetchCount][SubscriptionClient.PrefetchCount] properties.</span></span> <span data-ttu-id="0bba3-181">Každého klienta, který umožňuje prefetching udržuje vlastní mezipaměť.</span><span class="sxs-lookup"><span data-stu-id="0bba3-181">Each client that enables prefetching maintains its own cache.</span></span> <span data-ttu-id="0bba3-182">Mezipaměť není sdílet mezi klienty.</span><span class="sxs-lookup"><span data-stu-id="0bba3-182">A cache is not shared across clients.</span></span> <span data-ttu-id="0bba3-183">Pokud klient hello zahájí operace příjmu a jeho mezipaměť je prázdná, hello služba přenáší dávku zpráv.</span><span class="sxs-lookup"><span data-stu-id="0bba3-183">If hello client initiates a receive operation and its cache is empty, hello service transmits a batch of messages.</span></span> <span data-ttu-id="0bba3-184">Hello velikost dávky hello rovná hello velikost mezipaměti hello nebo 256 KB, podle toho, která je menší.</span><span class="sxs-lookup"><span data-stu-id="0bba3-184">hello size of hello batch equals hello size of hello cache or 256 KB, whichever is smaller.</span></span> <span data-ttu-id="0bba3-185">Pokud klient hello zahájí operace příjmu a hello mezipaměti obsahuje zprávu, zpráva hello je převzat ze hello mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="0bba3-185">If hello client initiates a receive operation and hello cache contains a message, hello message is taken from hello cache.</span></span>

<span data-ttu-id="0bba3-186">Když je prefetched zprávu, hello služby zámky hello prefetched zpráva.</span><span class="sxs-lookup"><span data-stu-id="0bba3-186">When a message is prefetched, hello service locks hello prefetched message.</span></span> <span data-ttu-id="0bba3-187">Tímto způsobem, nelze přijímat zprávy prefetched hello jiný příjemce.</span><span class="sxs-lookup"><span data-stu-id="0bba3-187">By doing this, hello prefetched message cannot be received by a different receiver.</span></span> <span data-ttu-id="0bba3-188">Pokud příjemce hello nelze dokončit uvítací zprávu, než vyprší platnost hello zámku, změní na uvítací zprávu k dispozici tooother příjemci.</span><span class="sxs-lookup"><span data-stu-id="0bba3-188">If hello receiver cannot complete hello message before hello lock expires, hello message becomes available tooother receivers.</span></span> <span data-ttu-id="0bba3-189">Hello prefetched kopii uvítací zprávu zůstává v mezipaměti hello.</span><span class="sxs-lookup"><span data-stu-id="0bba3-189">hello prefetched copy of hello message remains in hello cache.</span></span> <span data-ttu-id="0bba3-190">Hello příjemce, který využívá hello platnost mezipaměti kopie obdrží výjimku, když se pokusí toocomplete této zprávě.</span><span class="sxs-lookup"><span data-stu-id="0bba3-190">hello receiver that consumes hello expired cached copy will receive an exception when it tries toocomplete that message.</span></span> <span data-ttu-id="0bba3-191">Ve výchozím nastavení zámek zprávy hello vyprší po 60 sekund.</span><span class="sxs-lookup"><span data-stu-id="0bba3-191">By default, hello message lock expires after 60 seconds.</span></span> <span data-ttu-id="0bba3-192">Tato hodnota může být rozšířené too5 minut.</span><span class="sxs-lookup"><span data-stu-id="0bba3-192">This value can be extended too5 minutes.</span></span> <span data-ttu-id="0bba3-193">tooprevent hello spotřebu zprávy s vypršenou platností, velikost mezipaměti hello by měl vždycky být menší než hello počet zpráv, které mohou být využívány službou klienta v rámci hello je interval časového limitu zámku.</span><span class="sxs-lookup"><span data-stu-id="0bba3-193">tooprevent hello consumption of expired messages, hello cache size should always be smaller than hello number of messages that can be consumed by a client within hello lock time-out interval.</span></span>

<span data-ttu-id="0bba3-194">Pokud používáte hello výchozí zámku vypršení platnosti 60 sekund, správné hodnoty pro [SubscriptionClient.PrefetchCount] [ SubscriptionClient.PrefetchCount] je 20krát hello maximální počet zpracovaných položek všechny přijímačů objektu pro vytváření hello.</span><span class="sxs-lookup"><span data-stu-id="0bba3-194">When using hello default lock expiration of 60 seconds, a good value for [SubscriptionClient.PrefetchCount][SubscriptionClient.PrefetchCount] is 20 times hello maximum processing rates of all receivers of hello factory.</span></span> <span data-ttu-id="0bba3-195">Například objekt factory vytvoří 3 příjemci a každý příjemce může zpracovat až too10 zpráv za sekundu.</span><span class="sxs-lookup"><span data-stu-id="0bba3-195">For example, a factory creates 3 receivers, and each receiver can process up too10 messages per second.</span></span> <span data-ttu-id="0bba3-196">Hello předběžné načtení počet nesmí být delší než 20 × 3 × 10 = 600.</span><span class="sxs-lookup"><span data-stu-id="0bba3-196">hello prefetch count should not exceed 20 X 3 X 10 = 600.</span></span> <span data-ttu-id="0bba3-197">Ve výchozím nastavení [QueueClient.PrefetchCount] [ QueueClient.PrefetchCount] je sada too0, což znamená, že žádné další zprávy jsou načtených ze služby hello.</span><span class="sxs-lookup"><span data-stu-id="0bba3-197">By default, [QueueClient.PrefetchCount][QueueClient.PrefetchCount] is set too0, which means that no additional messages are fetched from hello service.</span></span>

<span data-ttu-id="0bba3-198">Prefetching zprávy o zvýšení hello celkovou propustnost pro fronty nebo předplatného, protože snižuje celkový počet operace zpráv nebo odezev hello.</span><span class="sxs-lookup"><span data-stu-id="0bba3-198">Prefetching messages increases hello overall throughput for a queue or subscription because it reduces hello overall number of message operations, or round trips.</span></span> <span data-ttu-id="0bba3-199">Načítání hello první zprávu, ale bude trvat déle (z důvodu toohello zvětšit velikost zprávy).</span><span class="sxs-lookup"><span data-stu-id="0bba3-199">Fetching hello first message, however, will take longer (due toohello increased message size).</span></span> <span data-ttu-id="0bba3-200">Přijímání zpráv prefetched bude rychlejší, protože tyto zprávy již byly staženy klientem hello.</span><span class="sxs-lookup"><span data-stu-id="0bba3-200">Receiving prefetched messages will be faster because these messages have already been downloaded by hello client.</span></span>

<span data-ttu-id="0bba3-201">Hello time to live (TTL) vlastnosti zprávy, které se kontroluje server hello ve hello dobu, kdy hello server odešle hello zpráva toohello klienta.</span><span class="sxs-lookup"><span data-stu-id="0bba3-201">hello time-to-live (TTL) property of a message is checked by hello server at hello time hello server sends hello message toohello client.</span></span> <span data-ttu-id="0bba3-202">Klient Hello nekontroluje vlastnost TTL hello zprávy při příjmu zprávy hello.</span><span class="sxs-lookup"><span data-stu-id="0bba3-202">hello client does not check hello message’s TTL property when hello message is received.</span></span> <span data-ttu-id="0bba3-203">Místo toho může být přijata zpráva hello i v případě TTL dané zprávy hello byla úspěšná, zatímco uvítací zprávu se ukládá do mezipaměti klienta hello.</span><span class="sxs-lookup"><span data-stu-id="0bba3-203">Instead, hello message can be received even if hello message’s TTL has passed while hello message was cached by hello client.</span></span>

<span data-ttu-id="0bba3-204">Prefetching nemá vliv na hello počet operací, fakturovatelný zasílání zpráv a je dostupná jenom pro hello protokolu klienta služby Service Bus.</span><span class="sxs-lookup"><span data-stu-id="0bba3-204">Prefetching does not affect hello number of billable messaging operations, and is available only for hello Service Bus client protocol.</span></span> <span data-ttu-id="0bba3-205">Hello protokolu HTTP nepodporuje prefetching.</span><span class="sxs-lookup"><span data-stu-id="0bba3-205">hello HTTP protocol does not support prefetching.</span></span> <span data-ttu-id="0bba3-206">Prefetching je k dispozici pro synchronní a asynchronní operace příjmu.</span><span class="sxs-lookup"><span data-stu-id="0bba3-206">Prefetching is available for both synchronous and asynchronous receive operations.</span></span>

## <a name="express-queues-and-topics"></a><span data-ttu-id="0bba3-207">Express front a témat</span><span class="sxs-lookup"><span data-stu-id="0bba3-207">Express queues and topics</span></span>

<span data-ttu-id="0bba3-208">Expresní entity povolte vysoké propustnosti a menší latence scénáře a jsou podporovány pouze v hello zasílání zpráv úrovně Standard.</span><span class="sxs-lookup"><span data-stu-id="0bba3-208">Express entities enable high throughput and reduced latency scenarios, and are supported only in hello Standard messaging tier.</span></span> <span data-ttu-id="0bba3-209">Entity vytvořené v [Premium obory názvů](service-bus-premium-messaging.md) nepodporují expresní možnost hello.</span><span class="sxs-lookup"><span data-stu-id="0bba3-209">Entities created in [Premium namespaces](service-bus-premium-messaging.md) do not support hello express option.</span></span> <span data-ttu-id="0bba3-210">S expresní entity Pokud je odeslána zpráva tooa fronta nebo téma, hello zprávy se neuloží okamžitě v úložišti pro přenos zpráv hello.</span><span class="sxs-lookup"><span data-stu-id="0bba3-210">With express entities, if a message is sent tooa queue or topic, hello message is not immediately stored in hello messaging store.</span></span> <span data-ttu-id="0bba3-211">Místo toho do mezipaměti v paměti.</span><span class="sxs-lookup"><span data-stu-id="0bba3-211">Instead, it is cached in memory.</span></span> <span data-ttu-id="0bba3-212">Pokud zpráva zůstává ve frontě hello na několik sekund, je zapsán automaticky toostable úložiště, tedy chránit před ztrátou kvůli výpadku tooan.</span><span class="sxs-lookup"><span data-stu-id="0bba3-212">If a message remains in hello queue for more than a few seconds, it is automatically written toostable storage, thus protecting it against loss due tooan outage.</span></span> <span data-ttu-id="0bba3-213">Zápis uvítací zprávu do mezipaměti paměti zvyšuje propustnost a snižuje latence, protože neexistuje žádný přístup toostable úložiště hello čas hello zprávy se odesílají.</span><span class="sxs-lookup"><span data-stu-id="0bba3-213">Writing hello message into a memory cache increases throughput and reduces latency because there is no access toostable storage at hello time hello message is sent.</span></span> <span data-ttu-id="0bba3-214">Zprávy, které se spotřebovávají během několika sekund nezapisují toohello úložiště pro zasílání zpráv.</span><span class="sxs-lookup"><span data-stu-id="0bba3-214">Messages that are consumed within a few seconds are not written toohello messaging store.</span></span> <span data-ttu-id="0bba3-215">Hello následující ukázka vytvoří express tématu.</span><span class="sxs-lookup"><span data-stu-id="0bba3-215">hello following example creates an express topic.</span></span>

```csharp
TopicDescription td = new TopicDescription(TopicName);
td.EnableExpress = true;
namespaceManager.CreateTopic(td);
```

<span data-ttu-id="0bba3-216">Pokud expresní entity tooan je odeslána zpráva obsahující důležité informace, které nesmí být ztraceny, hello odesílatele můžete vynutit Service Bus tooimmediately zachovat hello zpráva toostable úložiště podle nastavení hello [ForcePersistence] [ ForcePersistence] vlastnost příliš**true**.</span><span class="sxs-lookup"><span data-stu-id="0bba3-216">If a message containing critical information that must not be lost is sent tooan express entity, hello sender can force Service Bus tooimmediately persist hello message toostable storage by setting hello [ForcePersistence][ForcePersistence] property too**true**.</span></span>

> [!NOTE]
> <span data-ttu-id="0bba3-217">Expresní entity nepodporují transakce.</span><span class="sxs-lookup"><span data-stu-id="0bba3-217">Express entities do not support transactions.</span></span>

## <a name="use-of-partitioned-queues-or-topics"></a><span data-ttu-id="0bba3-218">Použití oddílů fronty nebo témata</span><span class="sxs-lookup"><span data-stu-id="0bba3-218">Use of partitioned queues or topics</span></span>
<span data-ttu-id="0bba3-219">Service Bus používá interně hello stejný uzel a zasílání zpráv tooprocess úložiště a ukládat všechny zprávy pro entity přenosu zpráv (fronty nebo tématu).</span><span class="sxs-lookup"><span data-stu-id="0bba3-219">Internally, Service Bus uses hello same node and messaging store tooprocess and store all messages for a messaging entity (queue or topic).</span></span> <span data-ttu-id="0bba3-220">Oddílů fronta nebo téma, na hello je druhé straně, rozdělené mezi více uzly a úložiště pro zasílání zpráv.</span><span class="sxs-lookup"><span data-stu-id="0bba3-220">A partitioned queue or topic, on hello other hand, is distributed across multiple nodes and messaging stores.</span></span> <span data-ttu-id="0bba3-221">Oddílů fronty a témata nejen poskytne vyšší výkon než regulární fronty a témata, budou také vykazovat vyšší dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="0bba3-221">Partitioned queues and topics not only yield a higher throughput than regular queues and topics, they also exhibit superior availability.</span></span> <span data-ttu-id="0bba3-222">toocreate dělené entity, sada hello [enablepartitioning je] [ EnablePartitioning] vlastnost příliš**true**, jak ukazuje následující příklad hello.</span><span class="sxs-lookup"><span data-stu-id="0bba3-222">toocreate a partitioned entity, set hello [EnablePartitioning][EnablePartitioning] property too**true**, as shown in hello following example.</span></span> <span data-ttu-id="0bba3-223">Další informace o dělené entity najdete v tématu [segmentované entity zasílání zpráv][Partitioned messaging entities].</span><span class="sxs-lookup"><span data-stu-id="0bba3-223">For more information about partitioned entities, see [Partitioned messaging entities][Partitioned messaging entities].</span></span>

```csharp
// Create partitioned queue.
QueueDescription qd = new QueueDescription(QueueName);
qd.EnablePartitioning = true;
namespaceManager.CreateQueue(qd);
```

## <a name="use-of-multiple-queues"></a><span data-ttu-id="0bba3-224">Použití více front</span><span class="sxs-lookup"><span data-stu-id="0bba3-224">Use of multiple queues</span></span>

<span data-ttu-id="0bba3-225">Pokud není možné toouse oddílů fronta nebo téma nebo hello očekává, že zatížení nemůže zpracovávat jeden oddílů fronta nebo téma, musíte použít více entit pro zasílání zpráv.</span><span class="sxs-lookup"><span data-stu-id="0bba3-225">If it is not possible toouse a partitioned queue or topic, or hello expected load cannot be handled by a single partitioned queue or topic, you must use multiple messaging entities.</span></span> <span data-ttu-id="0bba3-226">Pokud používáte více entit, vytvořte vyhrazený klienta pro každou entitu, místo použití hello stejné klienta pro všechny entity.</span><span class="sxs-lookup"><span data-stu-id="0bba3-226">When using multiple entities, create a dedicated client for each entity, instead of using hello same client for all entities.</span></span>

## <a name="development-and-testing-features"></a><span data-ttu-id="0bba3-227">Vývoj a testování funkcí</span><span class="sxs-lookup"><span data-stu-id="0bba3-227">Development and testing features</span></span>

<span data-ttu-id="0bba3-228">Service Bus má jednu funkci, který je používán speciálně pro vývoj který **by měl být nikdy použit ve konfigurace produkční**: [TopicDescription.EnableFilteringMessagesBeforePublishing][].</span><span class="sxs-lookup"><span data-stu-id="0bba3-228">Service Bus has one feature that is used specifically for development which **should never be used in production configurations**: [TopicDescription.EnableFilteringMessagesBeforePublishing][].</span></span>

<span data-ttu-id="0bba3-229">Pokud nová pravidla nebo filtry přidají toohello téma, můžete použít [TopicDescription.EnableFilteringMessagesBeforePublishing][] tooverify, který hello nové výraz filtru funguje podle očekávání.</span><span class="sxs-lookup"><span data-stu-id="0bba3-229">When new rules or filters are added toohello topic, you can use [TopicDescription.EnableFilteringMessagesBeforePublishing][] tooverify that hello new filter expression is working as expected.</span></span>

## <a name="scenarios"></a><span data-ttu-id="0bba3-230">Scénáře</span><span class="sxs-lookup"><span data-stu-id="0bba3-230">Scenarios</span></span>
<span data-ttu-id="0bba3-231">Hello následující části popisují typické scénáře zasílání zpráv a popisují nastavení hello preferované Service Bus.</span><span class="sxs-lookup"><span data-stu-id="0bba3-231">hello following sections describe typical messaging scenarios and outline hello preferred Service Bus settings.</span></span> <span data-ttu-id="0bba3-232">Propustnosti jsou klasifikovány jako malé (méně než 1 zpráv za sekundu), střední (1 zpráv za sekundu nebo větší, ale méně než 100 zpráv za sekundu) a vysokou (100 zprávy/druhý nebo vyšší).</span><span class="sxs-lookup"><span data-stu-id="0bba3-232">Throughput rates are classified as small (less than 1 message/second), moderate (1 message/second or greater but less than 100 messages/second) and high (100 messages/second or greater).</span></span> <span data-ttu-id="0bba3-233">Hello počet klientů jsou klasifikovány jako malá (5 nebo méně), střední (víc než 5 ale menší než nebo rovna too20) a velké (více než 20).</span><span class="sxs-lookup"><span data-stu-id="0bba3-233">hello number of clients are classified as small (5 or fewer), moderate (more than 5 but less than or equal too20), and large (more than 20).</span></span>

### <a name="high-throughput-queue"></a><span data-ttu-id="0bba3-234">Vysokou propustností fronty</span><span class="sxs-lookup"><span data-stu-id="0bba3-234">High-throughput queue</span></span>
<span data-ttu-id="0bba3-235">Cíl: Maximalizujte propustnost hello jedné frontě.</span><span class="sxs-lookup"><span data-stu-id="0bba3-235">Goal: Maximize hello throughput of a single queue.</span></span> <span data-ttu-id="0bba3-236">počet Hello odesílateli a příjemci je malá.</span><span class="sxs-lookup"><span data-stu-id="0bba3-236">hello number of senders and receivers is small.</span></span>

* <span data-ttu-id="0bba3-237">Oddílů frontu použijte pro lepší výkon a dostupnost.</span><span class="sxs-lookup"><span data-stu-id="0bba3-237">Use a partitioned queue for improved performance and availability.</span></span>
* <span data-ttu-id="0bba3-238">tooincrease hello celkové míra odesílání do fronty hello, použijte více odesílatelé toocreate objekty pro vytváření zpráv.</span><span class="sxs-lookup"><span data-stu-id="0bba3-238">tooincrease hello overall send rate into hello queue, use multiple message factories toocreate senders.</span></span> <span data-ttu-id="0bba3-239">Pro každý odesílatele použijte asynchronní operace nebo více vláken.</span><span class="sxs-lookup"><span data-stu-id="0bba3-239">For each sender, use asynchronous operations or multiple threads.</span></span>
* <span data-ttu-id="0bba3-240">tooincrease hello celkovou rychlost příjmu z fronty hello, použijte několika příjemců toocreate objekty pro vytváření zpráv.</span><span class="sxs-lookup"><span data-stu-id="0bba3-240">tooincrease hello overall receive rate from hello queue, use multiple message factories toocreate receivers.</span></span>
* <span data-ttu-id="0bba3-241">Použijte výhod tootake asynchronních operací dávkování na straně klienta.</span><span class="sxs-lookup"><span data-stu-id="0bba3-241">Use asynchronous operations tootake advantage of client-side batching.</span></span>
* <span data-ttu-id="0bba3-242">Nastavit hello dávkování intervalu too50ms tooreduce hello počet přenosů protokolu klienta služby Service Bus.</span><span class="sxs-lookup"><span data-stu-id="0bba3-242">Set hello batching interval too50ms tooreduce hello number of Service Bus client protocol transmissions.</span></span> <span data-ttu-id="0bba3-243">Pokud jsou použity více odesílatelé, zvýšit hello dávkování too100ms intervalu.</span><span class="sxs-lookup"><span data-stu-id="0bba3-243">If multiple senders are used, increase hello batching interval too100ms.</span></span>
* <span data-ttu-id="0bba3-244">Ponechte povolen přístup dávkové úložiště.</span><span class="sxs-lookup"><span data-stu-id="0bba3-244">Leave batched store access enabled.</span></span> <span data-ttu-id="0bba3-245">Tím se zvyšuje hello celkovou rychlost, jakou může být zprávy zapisovány do fronty hello.</span><span class="sxs-lookup"><span data-stu-id="0bba3-245">This increases hello overall rate at which messages can be written into hello queue.</span></span>
* <span data-ttu-id="0bba3-246">Nastavte hello předběžné načtení počet too20 hello míry maximální zpracování všech příjemci objekt pro vytváření.</span><span class="sxs-lookup"><span data-stu-id="0bba3-246">Set hello prefetch count too20 times hello maximum processing rates of all receivers of a factory.</span></span> <span data-ttu-id="0bba3-247">Tím se snižuje počet hello přenosy protokolu klienta služby Service Bus.</span><span class="sxs-lookup"><span data-stu-id="0bba3-247">This reduces hello number of Service Bus client protocol transmissions.</span></span>

### <a name="multiple-high-throughput-queues"></a><span data-ttu-id="0bba3-248">Více vysokou propustností fronty</span><span class="sxs-lookup"><span data-stu-id="0bba3-248">Multiple high-throughput queues</span></span>
<span data-ttu-id="0bba3-249">Cíl: Maximalizujte celkovou propustnost více front.</span><span class="sxs-lookup"><span data-stu-id="0bba3-249">Goal: Maximize overall throughput of multiple queues.</span></span> <span data-ttu-id="0bba3-250">propustnost Hello jednotlivé fronty je střední nebo vysokou.</span><span class="sxs-lookup"><span data-stu-id="0bba3-250">hello throughput of an individual queue is moderate or high.</span></span>

<span data-ttu-id="0bba3-251">tooobtain maximální propustnost napříč více front, použít nastavení hello uvedených toomaximize hello propustnost jedné frontě.</span><span class="sxs-lookup"><span data-stu-id="0bba3-251">tooobtain maximum throughput across multiple queues, use hello settings outlined toomaximize hello throughput of a single queue.</span></span> <span data-ttu-id="0bba3-252">Kromě toho použijte různé objekty Factory toocreate klienty, kteří odesílat nebo přijímat z jiné fronty.</span><span class="sxs-lookup"><span data-stu-id="0bba3-252">In addition, use different factories toocreate clients that send or receive from different queues.</span></span>

### <a name="low-latency-queue"></a><span data-ttu-id="0bba3-253">Fronty s nízkou latencí</span><span class="sxs-lookup"><span data-stu-id="0bba3-253">Low latency queue</span></span>
<span data-ttu-id="0bba3-254">Cíl: Minimalizaci latence začátku do konce se fronta nebo téma.</span><span class="sxs-lookup"><span data-stu-id="0bba3-254">Goal: Minimize end-to-end latency of a queue or topic.</span></span> <span data-ttu-id="0bba3-255">počet Hello odesílateli a příjemci je malá.</span><span class="sxs-lookup"><span data-stu-id="0bba3-255">hello number of senders and receivers is small.</span></span> <span data-ttu-id="0bba3-256">propustnost Hello hello fronty je malá nebo střední.</span><span class="sxs-lookup"><span data-stu-id="0bba3-256">hello throughput of hello queue is small or moderate.</span></span>

* <span data-ttu-id="0bba3-257">Oddílů frontu použijte pro lepší dostupnost.</span><span class="sxs-lookup"><span data-stu-id="0bba3-257">Use a partitioned queue for improved availability.</span></span>
* <span data-ttu-id="0bba3-258">Zakážete dávkování na straně klienta.</span><span class="sxs-lookup"><span data-stu-id="0bba3-258">Disable client-side batching.</span></span> <span data-ttu-id="0bba3-259">Hello klienta, ihned odešle zprávu.</span><span class="sxs-lookup"><span data-stu-id="0bba3-259">hello client immediately sends a message.</span></span>
* <span data-ttu-id="0bba3-260">Zakážete přístup dávkové úložiště.</span><span class="sxs-lookup"><span data-stu-id="0bba3-260">Disable batched store access.</span></span> <span data-ttu-id="0bba3-261">Služba Hello okamžitě zapíše úložiště toohello hello zpráv.</span><span class="sxs-lookup"><span data-stu-id="0bba3-261">hello service immediately writes hello message toohello store.</span></span>
* <span data-ttu-id="0bba3-262">Pokud používáte jednoho klienta, nastavte hello předběžné načtení počet too20 časy hello zpracování míra hello příjemce.</span><span class="sxs-lookup"><span data-stu-id="0bba3-262">If using a single client, set hello prefetch count too20 times hello processing rate of hello receiver.</span></span> <span data-ttu-id="0bba3-263">Pokud více zpráv přijaty ve frontě hello v hello stejný čas, hello Service Bus klientský protokol odesílá je vše na hello stejnou dobu.</span><span class="sxs-lookup"><span data-stu-id="0bba3-263">If multiple messages arrive at hello queue at hello same time, hello Service Bus client protocol transmits them all at hello same time.</span></span> <span data-ttu-id="0bba3-264">Když hello klient obdrží hello další zprávu, zpráva již v místní mezipaměti hello.</span><span class="sxs-lookup"><span data-stu-id="0bba3-264">When hello client receives hello next message, that message is already in hello local cache.</span></span> <span data-ttu-id="0bba3-265">Hello mezipaměti musí být malé.</span><span class="sxs-lookup"><span data-stu-id="0bba3-265">hello cache should be small.</span></span>
* <span data-ttu-id="0bba3-266">Pokud používáte více klientů, nastavte too0 počet předběžné načtení hello.</span><span class="sxs-lookup"><span data-stu-id="0bba3-266">If using multiple clients, set hello prefetch count too0.</span></span> <span data-ttu-id="0bba3-267">Díky tomu mohou hello druhý klienta přijímat hello druhou zprávu při první klient hello stále zpracovává hello první zprávu.</span><span class="sxs-lookup"><span data-stu-id="0bba3-267">By doing this, hello second client can receive hello second message while hello first client is still processing hello first message.</span></span>

### <a name="queue-with-a-large-number-of-senders"></a><span data-ttu-id="0bba3-268">Fronty s velkým počtem uživatelů</span><span class="sxs-lookup"><span data-stu-id="0bba3-268">Queue with a large number of senders</span></span>
<span data-ttu-id="0bba3-269">Cíl: Maximalizujte propustnost se fronta nebo téma s velkým počtem uživatelů.</span><span class="sxs-lookup"><span data-stu-id="0bba3-269">Goal: Maximize throughput of a queue or topic with a large number of senders.</span></span> <span data-ttu-id="0bba3-270">Každý odesílatel odešle zprávy střední míru.</span><span class="sxs-lookup"><span data-stu-id="0bba3-270">Each sender sends messages with a moderate rate.</span></span> <span data-ttu-id="0bba3-271">Hello počet příjemců je malá.</span><span class="sxs-lookup"><span data-stu-id="0bba3-271">hello number of receivers is small.</span></span>

<span data-ttu-id="0bba3-272">Service Bus umožňuje až tooa souběžných připojení too1000 entity pro zasílání zpráv (nebo 5000 pomocí protokolu AMQP).</span><span class="sxs-lookup"><span data-stu-id="0bba3-272">Service Bus enables up too1000 concurrent connections tooa messaging entity (or 5000 using AMQP).</span></span> <span data-ttu-id="0bba3-273">Tento limit je vyžadována na úrovni oboru názvů hello a fronty, témata nebo odběry jsou omezená podle hello maximální počet souběžných připojení na obor názvů.</span><span class="sxs-lookup"><span data-stu-id="0bba3-273">This limit is enforced at hello namespace level, and queues/topics/subscriptions are capped by hello limit of concurrent connections per namespace.</span></span> <span data-ttu-id="0bba3-274">Pro fronty je toto číslo sdílet mezi odesílateli a příjemci.</span><span class="sxs-lookup"><span data-stu-id="0bba3-274">For queues, this number is shared between senders and receivers.</span></span> <span data-ttu-id="0bba3-275">Pokud jsou požadovány pro odesílatelé všechna připojení 1000, měli byste nahradit hello fronty téma a v rámci jednoho předplatného.</span><span class="sxs-lookup"><span data-stu-id="0bba3-275">If all 1000 connections are required for senders, you should replace hello queue with a topic and a single subscription.</span></span> <span data-ttu-id="0bba3-276">Téma přijme až too1000 souběžných připojení z odesílatelé, zatímco hello předplatné přijímá další 1 000 souběžných připojení z příjemců.</span><span class="sxs-lookup"><span data-stu-id="0bba3-276">A topic accepts up too1000 concurrent connections from senders, whereas hello subscription accepts an additional 1000 concurrent connections from receivers.</span></span> <span data-ttu-id="0bba3-277">Pokud více než 1 000 souběžných odesílatelé, by měli poslat hello odesílatelé toohello zpráv služby Service Bus protokol prostřednictvím protokolu HTTP.</span><span class="sxs-lookup"><span data-stu-id="0bba3-277">If more than 1000 concurrent senders are required, hello senders should send messages toohello Service Bus protocol via HTTP.</span></span>

<span data-ttu-id="0bba3-278">propustnost toomaximize hello následující:</span><span class="sxs-lookup"><span data-stu-id="0bba3-278">toomaximize throughput, do hello following:</span></span>

* <span data-ttu-id="0bba3-279">Oddílů frontu použijte pro lepší výkon a dostupnost.</span><span class="sxs-lookup"><span data-stu-id="0bba3-279">Use a partitioned queue for improved performance and availability.</span></span>
* <span data-ttu-id="0bba3-280">Pokud každý odesílatele se nachází v jiném procesu, použijte pouze jeden objekt factory pro procesy.</span><span class="sxs-lookup"><span data-stu-id="0bba3-280">If each sender resides in a different process, use only a single factory per process.</span></span>
* <span data-ttu-id="0bba3-281">Použijte výhod tootake asynchronních operací dávkování na straně klienta.</span><span class="sxs-lookup"><span data-stu-id="0bba3-281">Use asynchronous operations tootake advantage of client-side batching.</span></span>
* <span data-ttu-id="0bba3-282">Použijte výchozí hello dávkování interval 20ms tooreduce hello počtu přenosy protokolu klienta služby Service Bus.</span><span class="sxs-lookup"><span data-stu-id="0bba3-282">Use hello default batching interval of 20ms tooreduce hello number of Service Bus client protocol transmissions.</span></span>
* <span data-ttu-id="0bba3-283">Ponechte povolen přístup dávkové úložiště.</span><span class="sxs-lookup"><span data-stu-id="0bba3-283">Leave batched store access enabled.</span></span> <span data-ttu-id="0bba3-284">Tím se zvyšuje hello celkovou rychlost, jakou může být zprávy zapisovány do hello fronta nebo téma.</span><span class="sxs-lookup"><span data-stu-id="0bba3-284">This increases hello overall rate at which messages can be written into hello queue or topic.</span></span>
* <span data-ttu-id="0bba3-285">Nastavte hello předběžné načtení počet too20 hello míry maximální zpracování všech příjemci objekt pro vytváření.</span><span class="sxs-lookup"><span data-stu-id="0bba3-285">Set hello prefetch count too20 times hello maximum processing rates of all receivers of a factory.</span></span> <span data-ttu-id="0bba3-286">Tím se snižuje počet hello přenosy protokolu klienta služby Service Bus.</span><span class="sxs-lookup"><span data-stu-id="0bba3-286">This reduces hello number of Service Bus client protocol transmissions.</span></span>

### <a name="queue-with-a-large-number-of-receivers"></a><span data-ttu-id="0bba3-287">Fronty s velkým počtem příjemci</span><span class="sxs-lookup"><span data-stu-id="0bba3-287">Queue with a large number of receivers</span></span>
<span data-ttu-id="0bba3-288">Cíl: Maximalizovat hello přijímat míra fronty nebo předplatné s velký počet příjemců.</span><span class="sxs-lookup"><span data-stu-id="0bba3-288">Goal: Maximize hello receive rate of a queue or subscription with a large number of receivers.</span></span> <span data-ttu-id="0bba3-289">Každý příjemce přijímá zprávy střední rychlostí.</span><span class="sxs-lookup"><span data-stu-id="0bba3-289">Each receiver receives messages at a moderate rate.</span></span> <span data-ttu-id="0bba3-290">Hello počet odesílatelé je malá.</span><span class="sxs-lookup"><span data-stu-id="0bba3-290">hello number of senders is small.</span></span>

<span data-ttu-id="0bba3-291">Service Bus umožňuje až too1000 souběžných připojení tooan entity.</span><span class="sxs-lookup"><span data-stu-id="0bba3-291">Service Bus enables up too1000 concurrent connections tooan entity.</span></span> <span data-ttu-id="0bba3-292">Pokud fronty vyžaduje více než 1 000 příjemci, měli byste nahradit hello fronty téma a více předplatných.</span><span class="sxs-lookup"><span data-stu-id="0bba3-292">If a queue requires more than 1000 receivers, you should replace hello queue with a topic and multiple subscriptions.</span></span> <span data-ttu-id="0bba3-293">Každý odběr může podporovat až too1000 souběžných připojení.</span><span class="sxs-lookup"><span data-stu-id="0bba3-293">Each subscription can support up too1000 concurrent connections.</span></span> <span data-ttu-id="0bba3-294">Příjemci Alternativně můžete přistupovat hello frontě prostřednictvím hello protokolu HTTP.</span><span class="sxs-lookup"><span data-stu-id="0bba3-294">Alternatively, receivers can access hello queue via hello HTTP protocol.</span></span>

<span data-ttu-id="0bba3-295">propustnost toomaximize hello následující:</span><span class="sxs-lookup"><span data-stu-id="0bba3-295">toomaximize throughput, do hello following:</span></span>

* <span data-ttu-id="0bba3-296">Oddílů frontu použijte pro lepší výkon a dostupnost.</span><span class="sxs-lookup"><span data-stu-id="0bba3-296">Use a partitioned queue for improved performance and availability.</span></span>
* <span data-ttu-id="0bba3-297">Pokud každý příjemce se nachází v jiném procesu, použijte pouze jeden objekt factory pro procesy.</span><span class="sxs-lookup"><span data-stu-id="0bba3-297">If each receiver resides in a different process, use only a single factory per process.</span></span>
* <span data-ttu-id="0bba3-298">Příjemci můžete použít synchronní nebo asynchronní operace.</span><span class="sxs-lookup"><span data-stu-id="0bba3-298">Receivers can use synchronous or asynchronous operations.</span></span> <span data-ttu-id="0bba3-299">Zadaný hello mírný přijímat počet jednotlivé příjemce, dávkování na straně klienta dokončení požadavku nemá vliv na propustnost příjemce.</span><span class="sxs-lookup"><span data-stu-id="0bba3-299">Given hello moderate receive rate of an individual receiver, client-side batching of a Complete request does not affect receiver throughput.</span></span>
* <span data-ttu-id="0bba3-300">Ponechte povolen přístup dávkové úložiště.</span><span class="sxs-lookup"><span data-stu-id="0bba3-300">Leave batched store access enabled.</span></span> <span data-ttu-id="0bba3-301">Tím se snižuje hello celkové zatížení hello entity.</span><span class="sxs-lookup"><span data-stu-id="0bba3-301">This reduces hello overall load of hello entity.</span></span> <span data-ttu-id="0bba3-302">Také snižuje hello celková rychlost, jakou může být zprávy zapisovány do hello fronta nebo téma.</span><span class="sxs-lookup"><span data-stu-id="0bba3-302">It also reduces hello overall rate at which messages can be written into hello queue or topic.</span></span>
* <span data-ttu-id="0bba3-303">Nastavte hello předběžné načtení počet tooa malé hodnotu (například PrefetchCount = 10).</span><span class="sxs-lookup"><span data-stu-id="0bba3-303">Set hello prefetch count tooa small value (for example, PrefetchCount = 10).</span></span> <span data-ttu-id="0bba3-304">To brání tomu, aby příjemci nečinnosti, zatímco ostatní příjemce máte velké množství zpráv do mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="0bba3-304">This prevents receivers from being idle while other receivers have large numbers of messages cached.</span></span>

### <a name="topic-with-a-small-number-of-subscriptions"></a><span data-ttu-id="0bba3-305">Téma se malý počet odběrů</span><span class="sxs-lookup"><span data-stu-id="0bba3-305">Topic with a small number of subscriptions</span></span>
<span data-ttu-id="0bba3-306">Cíl: Maximalizujte propustnost hello tématu s malým počtem odběry.</span><span class="sxs-lookup"><span data-stu-id="0bba3-306">Goal: Maximize hello throughput of a topic with a small number of subscriptions.</span></span> <span data-ttu-id="0bba3-307">Zprávu přijme mnoho odběrů, což znamená, že hello kombinaci přijímat míra nad všechny odběry je větší než míra odesílání hello.</span><span class="sxs-lookup"><span data-stu-id="0bba3-307">A message is received by many subscriptions, which means hello combined receive rate over all subscriptions is larger than hello send rate.</span></span> <span data-ttu-id="0bba3-308">Hello počet odesílatelé je malá.</span><span class="sxs-lookup"><span data-stu-id="0bba3-308">hello number of senders is small.</span></span> <span data-ttu-id="0bba3-309">Hello počet příjemců na předplatné je malá.</span><span class="sxs-lookup"><span data-stu-id="0bba3-309">hello number of receivers per subscription is small.</span></span>

<span data-ttu-id="0bba3-310">propustnost toomaximize hello následující:</span><span class="sxs-lookup"><span data-stu-id="0bba3-310">toomaximize throughput, do hello following:</span></span>

* <span data-ttu-id="0bba3-311">Použijte oddílů tématu pro lepší výkon a dostupnost.</span><span class="sxs-lookup"><span data-stu-id="0bba3-311">Use a partitioned topic for improved performance and availability.</span></span>
* <span data-ttu-id="0bba3-312">tooincrease hello celkové míra odesílání do tématu hello, použijte více odesílatelé toocreate objekty pro vytváření zpráv.</span><span class="sxs-lookup"><span data-stu-id="0bba3-312">tooincrease hello overall send rate into hello topic, use multiple message factories toocreate senders.</span></span> <span data-ttu-id="0bba3-313">Pro každý odesílatele použijte asynchronní operace nebo více vláken.</span><span class="sxs-lookup"><span data-stu-id="0bba3-313">For each sender, use asynchronous operations or multiple threads.</span></span>
* <span data-ttu-id="0bba3-314">tooincrease hello celkovou rychlost příjmu z odběru, použijte několika příjemců toocreate objekty pro vytváření zpráv.</span><span class="sxs-lookup"><span data-stu-id="0bba3-314">tooincrease hello overall receive rate from a subscription, use multiple message factories toocreate receivers.</span></span> <span data-ttu-id="0bba3-315">Pro každý příjemce použijte asynchronní operace nebo více vláken.</span><span class="sxs-lookup"><span data-stu-id="0bba3-315">For each receiver, use asynchronous operations or multiple threads.</span></span>
* <span data-ttu-id="0bba3-316">Použijte výhod tootake asynchronních operací dávkování na straně klienta.</span><span class="sxs-lookup"><span data-stu-id="0bba3-316">Use asynchronous operations tootake advantage of client-side batching.</span></span>
* <span data-ttu-id="0bba3-317">Použijte výchozí hello dávkování interval 20ms tooreduce hello počtu přenosy protokolu klienta služby Service Bus.</span><span class="sxs-lookup"><span data-stu-id="0bba3-317">Use hello default batching interval of 20ms tooreduce hello number of Service Bus client protocol transmissions.</span></span>
* <span data-ttu-id="0bba3-318">Ponechte povolen přístup dávkové úložiště.</span><span class="sxs-lookup"><span data-stu-id="0bba3-318">Leave batched store access enabled.</span></span> <span data-ttu-id="0bba3-319">Tím se zvyšuje hello celkovou rychlost, jakou může být zprávy zapisovány do tématu hello.</span><span class="sxs-lookup"><span data-stu-id="0bba3-319">This increases hello overall rate at which messages can be written into hello topic.</span></span>
* <span data-ttu-id="0bba3-320">Nastavte hello předběžné načtení počet too20 hello míry maximální zpracování všech příjemci objekt pro vytváření.</span><span class="sxs-lookup"><span data-stu-id="0bba3-320">Set hello prefetch count too20 times hello maximum processing rates of all receivers of a factory.</span></span> <span data-ttu-id="0bba3-321">Tím se snižuje počet hello přenosy protokolu klienta služby Service Bus.</span><span class="sxs-lookup"><span data-stu-id="0bba3-321">This reduces hello number of Service Bus client protocol transmissions.</span></span>

### <a name="topic-with-a-large-number-of-subscriptions"></a><span data-ttu-id="0bba3-322">Téma se velký počet odběrů</span><span class="sxs-lookup"><span data-stu-id="0bba3-322">Topic with a large number of subscriptions</span></span>
<span data-ttu-id="0bba3-323">Cíl: Maximalizujte propustnost hello téma se velký počet předplatných.</span><span class="sxs-lookup"><span data-stu-id="0bba3-323">Goal: Maximize hello throughput of a topic with a large number of subscriptions.</span></span> <span data-ttu-id="0bba3-324">Zprávu přijme mnoho odběrů, což znamená, že hello kombinaci přijímat míra přes všechny odběry je mnohem větší než míra odesílání hello.</span><span class="sxs-lookup"><span data-stu-id="0bba3-324">A message is received by many subscriptions, which means hello combined receive rate over all subscriptions is much larger than hello send rate.</span></span> <span data-ttu-id="0bba3-325">Hello počet odesílatelé je malá.</span><span class="sxs-lookup"><span data-stu-id="0bba3-325">hello number of senders is small.</span></span> <span data-ttu-id="0bba3-326">Hello počet příjemců na předplatné je malá.</span><span class="sxs-lookup"><span data-stu-id="0bba3-326">hello number of receivers per subscription is small.</span></span>

<span data-ttu-id="0bba3-327">Témata s velkým počtem odběry obvykle odhalí nízkou celkovou propustnost všechny zprávy jsou směrované tooall odběry.</span><span class="sxs-lookup"><span data-stu-id="0bba3-327">Topics with a large number of subscriptions typically expose a low overall throughput if all messages are routed tooall subscriptions.</span></span> <span data-ttu-id="0bba3-328">To je způsobeno hello skutečnost, že každou zprávu přijme mnohokrát, a všechny zprávy, které jsou obsaženy v tématu a všechny její odběry jsou uložené ve hello stejné úložiště.</span><span class="sxs-lookup"><span data-stu-id="0bba3-328">This is caused by hello fact that each message is received many times, and all messages that are contained in a topic and all its subscriptions are stored in hello same store.</span></span> <span data-ttu-id="0bba3-329">Předpokládá se, že hello počet odesílatelé a počet příjemců na předplatné je malá.</span><span class="sxs-lookup"><span data-stu-id="0bba3-329">It is assumed that hello number of senders and number of receivers per subscription is small.</span></span> <span data-ttu-id="0bba3-330">Service Bus podporuje až too2 000 odběry na téma.</span><span class="sxs-lookup"><span data-stu-id="0bba3-330">Service Bus supports up too2,000 subscriptions per topic.</span></span>

<span data-ttu-id="0bba3-331">propustnost toomaximize hello následující:</span><span class="sxs-lookup"><span data-stu-id="0bba3-331">toomaximize throughput, do hello following:</span></span>

* <span data-ttu-id="0bba3-332">Použijte oddílů tématu pro lepší výkon a dostupnost.</span><span class="sxs-lookup"><span data-stu-id="0bba3-332">Use a partitioned topic for improved performance and availability.</span></span>
* <span data-ttu-id="0bba3-333">Použijte výhod tootake asynchronních operací dávkování na straně klienta.</span><span class="sxs-lookup"><span data-stu-id="0bba3-333">Use asynchronous operations tootake advantage of client-side batching.</span></span>
* <span data-ttu-id="0bba3-334">Použijte výchozí hello dávkování interval 20ms tooreduce hello počtu přenosy protokolu klienta služby Service Bus.</span><span class="sxs-lookup"><span data-stu-id="0bba3-334">Use hello default batching interval of 20ms tooreduce hello number of Service Bus client protocol transmissions.</span></span>
* <span data-ttu-id="0bba3-335">Ponechte povolen přístup dávkové úložiště.</span><span class="sxs-lookup"><span data-stu-id="0bba3-335">Leave batched store access enabled.</span></span> <span data-ttu-id="0bba3-336">Tím se zvyšuje hello celkovou rychlost, jakou může být zprávy zapisovány do tématu hello.</span><span class="sxs-lookup"><span data-stu-id="0bba3-336">This increases hello overall rate at which messages can be written into hello topic.</span></span>
* <span data-ttu-id="0bba3-337">Nastavte hello předběžné načtení počet too20 časy hello očekává přijímat míry v sekundách.</span><span class="sxs-lookup"><span data-stu-id="0bba3-337">Set hello prefetch count too20 times hello expected receive rate in seconds.</span></span> <span data-ttu-id="0bba3-338">Tím se snižuje počet hello přenosy protokolu klienta služby Service Bus.</span><span class="sxs-lookup"><span data-stu-id="0bba3-338">This reduces hello number of Service Bus client protocol transmissions.</span></span>

## <a name="next-steps"></a><span data-ttu-id="0bba3-339">Další kroky</span><span class="sxs-lookup"><span data-stu-id="0bba3-339">Next steps</span></span>
<span data-ttu-id="0bba3-340">toolearn Další informace o optimalizaci výkonu služby Service Bus, najdete v části [segmentované entity zasílání zpráv][Partitioned messaging entities].</span><span class="sxs-lookup"><span data-stu-id="0bba3-340">toolearn more about optimizing Service Bus performance, see [Partitioned messaging entities][Partitioned messaging entities].</span></span>

[QueueClient]: /dotnet/api/microsoft.servicebus.messaging.queueclient
[MessageSender]: /dotnet/api/microsoft.servicebus.messaging.messagesender
[MessagingFactory]: /dotnet/api/microsoft.servicebus.messaging.messagingfactory
[PeekLock]: /dotnet/api/microsoft.servicebus.messaging.receivemode
[ReceiveAndDelete]: /dotnet/api/microsoft.servicebus.messaging.receivemode
[BatchFlushInterval]: /dotnet/api/microsoft.servicebus.messaging.netmessagingtransportsettings.batchflushinterval#Microsoft_ServiceBus_Messaging_NetMessagingTransportSettings_BatchFlushInterval
[EnableBatchedOperations]: /dotnet/api/microsoft.servicebus.messaging.queuedescription.enablebatchedoperations#Microsoft_ServiceBus_Messaging_QueueDescription_EnableBatchedOperations
[QueueClient.PrefetchCount]: /dotnet/api/microsoft.servicebus.messaging.queueclient.prefetchcount#Microsoft_ServiceBus_Messaging_QueueClient_PrefetchCount
[SubscriptionClient.PrefetchCount]: /dotnet/api/microsoft.servicebus.messaging.subscriptionclient.prefetchcount#Microsoft_ServiceBus_Messaging_SubscriptionClient_PrefetchCount
[ForcePersistence]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage.forcepersistence#Microsoft_ServiceBus_Messaging_BrokeredMessage_ForcePersistence
[EnablePartitioning]: /dotnet/api/microsoft.servicebus.messaging.queuedescription.enablepartitioning#Microsoft_ServiceBus_Messaging_QueueDescription_EnablePartitioning
[Partitioned messaging entities]: service-bus-partitioning.md
[TopicDescription.EnableFilteringMessagesBeforePublishing]: /dotnet/api/microsoft.servicebus.messaging.topicdescription.enablefilteringmessagesbeforepublishing#Microsoft_ServiceBus_Messaging_TopicDescription_EnableFilteringMessagesBeforePublishing
