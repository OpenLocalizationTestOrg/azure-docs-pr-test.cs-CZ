---
title: "aaaWrite aplikace, které používají fronty Azure Service Bus | Microsoft Docs"
description: "Jak toowrite jednoduchou aplikaci na základě fronty, která používá Azure Service Bus."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: 754d91b3-1426-405e-84b4-fd36d65b114a
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/07/2017
ms.author: sethm
ms.openlocfilehash: 93b75902a06becd6e33e05298e09f5669d0e2aef
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="create-applications-that-use-service-bus-queues"></a><span data-ttu-id="49d3b-103">Vytváření aplikací používajících fronty Service Bus</span><span class="sxs-lookup"><span data-stu-id="49d3b-103">Create applications that use Service Bus queues</span></span>
<span data-ttu-id="49d3b-104">Toto téma popisuje fronty Service Bus a ukazuje, jak toowrite jednoduchou aplikaci na základě fronty, která používá Service Bus.</span><span class="sxs-lookup"><span data-stu-id="49d3b-104">This topic describes Service Bus queues and shows how toowrite a simple queue-based application that uses Service Bus.</span></span>

<span data-ttu-id="49d3b-105">Představte si třeba situaci z hello, world maloobchodních, ve kterém směruje prodeje dat z jednotlivých Point-of-Sale (POS) terminály musí být tooan inventáře správy systému, který používá hello data toodetermine, když má stock toobe doplnit.</span><span class="sxs-lookup"><span data-stu-id="49d3b-105">Consider a scenario from hello world of retail in which sales data from individual Point-of-Sale (POS) terminals must be routed tooan inventory management system that uses hello data toodetermine when stock has toobe replenished.</span></span> <span data-ttu-id="49d3b-106">Toto řešení používá pro komunikaci hello mezi hello terminály a systém pro správu inventáře hello, zasílání zpráv Service Bus, jak ukazuje následující obrázek hello:</span><span class="sxs-lookup"><span data-stu-id="49d3b-106">This solution uses Service Bus messaging for hello communication between hello terminals and hello inventory management system, as illustrated in hello following figure:</span></span>

![Fronty služby Service Bus obrázku 1](./media/service-bus-create-queues/IC657161.gif)

<span data-ttu-id="49d3b-108">Každý terminál POS sestavy jeho data prodeje odesláním zprávy toohello **DataCollectionQueue**.</span><span class="sxs-lookup"><span data-stu-id="49d3b-108">Each POS terminal reports its sales data by sending messages toohello **DataCollectionQueue**.</span></span> <span data-ttu-id="49d3b-109">Tyto zprávy zůstanou v této frontě, dokud se načítají pomocí systému pro správu inventáře hello.</span><span class="sxs-lookup"><span data-stu-id="49d3b-109">These messages remain in this queue until they are retrieved by hello inventory management system.</span></span> <span data-ttu-id="49d3b-110">Toto chování se často říká *asynchronní zasílání zpráv*, protože hello POS Terminálové nemá toowait na odpověď od hello inventáře správy systému toocontinue zpracování.</span><span class="sxs-lookup"><span data-stu-id="49d3b-110">This pattern is often termed *asynchronous messaging*, because hello POS terminal does not have toowait for a reply from hello inventory management system toocontinue processing.</span></span>

## <a name="why-queuing"></a><span data-ttu-id="49d3b-111">Proč služba Řízení front?</span><span class="sxs-lookup"><span data-stu-id="49d3b-111">Why queuing?</span></span>
<span data-ttu-id="49d3b-112">Předtím, než se podíváme na hello kód, který je požadovaný tooset si tuto aplikaci, zvažte hello výhody používání fronty v tomto scénáři místo nutnosti terminály hello POS komunikovat přímo (synchronně) toohello inventáře systému pro správu.</span><span class="sxs-lookup"><span data-stu-id="49d3b-112">Before we look at hello code that is required tooset up this application, consider hello advantages of using a queue in this scenario instead of having hello POS terminals talk directly (synchronously) toohello inventory management system.</span></span>

### <a name="temporal-decoupling"></a><span data-ttu-id="49d3b-113">Časové oddělení</span><span class="sxs-lookup"><span data-stu-id="49d3b-113">Temporal decoupling</span></span>
<span data-ttu-id="49d3b-114">S asynchronním vzorcem zasílání zpráv hello producenti a spotřebitelé nemají toobe online na hello stejnou dobu.</span><span class="sxs-lookup"><span data-stu-id="49d3b-114">With hello asynchronous messaging pattern, producers and consumers do not have toobe online at hello same time.</span></span> <span data-ttu-id="49d3b-115">Hello infrastruktury přenosu zpráv spolehlivě uloží zprávy, dokud spotřebitel hello je připraven tooreceive je.</span><span class="sxs-lookup"><span data-stu-id="49d3b-115">hello messaging infrastructure reliably stores messages until hello consuming party is ready tooreceive them.</span></span> <span data-ttu-id="49d3b-116">To znamená, že hello součásti hello distribuované aplikace můžou být odpojit; například za účelem údržby nebo z důvodu tooa součást havárií, aniž by to ovlivnilo hello celý systém.</span><span class="sxs-lookup"><span data-stu-id="49d3b-116">This means hello components of hello distributed application can be disconnected, either voluntarily; for example, for maintenance, or due tooa component crash, without affecting hello whole system.</span></span> <span data-ttu-id="49d3b-117">Kromě toho hello využívání aplikace může mít pouze toobe online v určitou dobu hello den.</span><span class="sxs-lookup"><span data-stu-id="49d3b-117">Furthermore, hello consuming application may only have toobe online during certain times of hello day.</span></span> <span data-ttu-id="49d3b-118">Například v tomto scénáři prodejní systém pro správu inventáře hello může mít pouze toocome online po skončení hello hello pracovního dne.</span><span class="sxs-lookup"><span data-stu-id="49d3b-118">For example, in this retail scenario, hello inventory management system may only have toocome online after hello end of hello business day.</span></span>

### <a name="load-leveling"></a><span data-ttu-id="49d3b-119">Vyrovnávání zátěže</span><span class="sxs-lookup"><span data-stu-id="49d3b-119">Load leveling</span></span>
<span data-ttu-id="49d3b-120">V mnoha aplikacích zatížení systému se liší v čase, zatímco hello zpracování čas potřebný pro jednotlivé jednotky práce je obvykle stálá.</span><span class="sxs-lookup"><span data-stu-id="49d3b-120">In many applications system load varies over time, whereas hello processing time required for each unit of work is typically constant.</span></span> <span data-ttu-id="49d3b-121">Propojovací zpráva producenti a spotřebitelé s znamená fronty, které hello spotřebitelskou aplikací (pracovník hello) má jenom toobe zřizuje tooservice průměrem načíst místo zátěž ve špičce.</span><span class="sxs-lookup"><span data-stu-id="49d3b-121">Intermediating message producers and consumers with a queue means that hello consuming application (hello worker) only has toobe provisioned tooservice an average load rather than a peak load.</span></span> <span data-ttu-id="49d3b-122">Hello hloubka fronty hello se zvýší a kontrakt jako hello příchozí zátěží se liší.</span><span class="sxs-lookup"><span data-stu-id="49d3b-122">hello depth of hello queue will grow and contract as hello incoming load varies.</span></span> <span data-ttu-id="49d3b-123">To znamená přímou úsporu nákladů s ohledem toohello množství infrastruktury požadované tooservice hello aplikace zatížení.</span><span class="sxs-lookup"><span data-stu-id="49d3b-123">This directly saves money with regard toohello amount of infrastructure required tooservice hello application load.</span></span>

![Fronty služby Service Bus obrázku 2](./media/service-bus-create-queues/IC657162.gif)

### <a name="load-balancing"></a><span data-ttu-id="49d3b-125">Vyrovnávání zatížení</span><span class="sxs-lookup"><span data-stu-id="49d3b-125">Load balancing</span></span>
<span data-ttu-id="49d3b-126">Jako hello zátěž zvyšuje, další pracovních procesů může být přidané tooread z fronty pracovních procesů hello.</span><span class="sxs-lookup"><span data-stu-id="49d3b-126">As hello load increases, more worker processes can be added tooread from hello worker queue.</span></span> <span data-ttu-id="49d3b-127">Každou zprávu zpracovává jenom jeden hello pracovních procesů.</span><span class="sxs-lookup"><span data-stu-id="49d3b-127">Each message is processed by only one of hello worker processes.</span></span> <span data-ttu-id="49d3b-128">Kromě toho tato Vyrovnávání zatížení založené na operaci pull umožňuje optimální využití hello pracovních počítačů i v případě hello pracovní počítače liší s ohledem tooprocessing výkonu, jak se bude načítat zprávy na svou vlastním maximální rychlostí.</span><span class="sxs-lookup"><span data-stu-id="49d3b-128">Furthermore, this pull-based load balancing allows for optimum usage of hello worker computers even if hello worker computers differ with regard tooprocessing power, as they will pull messages at their own maximum rate.</span></span> <span data-ttu-id="49d3b-129">Toto chování se často říká hello konkurence mezi spotřebiteli vzor.</span><span class="sxs-lookup"><span data-stu-id="49d3b-129">This pattern is often termed hello competing consumer pattern.</span></span>

![Obrázek 3 fronty Service Bus](./media/service-bus-create-queues/IC657163.gif)

### <a name="loose-coupling"></a><span data-ttu-id="49d3b-131">Volné párování</span><span class="sxs-lookup"><span data-stu-id="49d3b-131">Loose coupling</span></span>
<span data-ttu-id="49d3b-132">Pomocí toointermediate služby Řízení front zpráv mezi producenti a spotřebitelé zpráv poskytuje vnitřní volné párování mezi součástmi hello.</span><span class="sxs-lookup"><span data-stu-id="49d3b-132">Using message queuing toointermediate between message producers and consumers provides an intrinsic loose coupling between hello components.</span></span> <span data-ttu-id="49d3b-133">Protože producenti a spotřebitelé nemají informace o sobě navzájem, bez nutnosti nijak neprojeví na hello producent lze upgradovat příjemce.</span><span class="sxs-lookup"><span data-stu-id="49d3b-133">Because producers and consumers are not aware of each other, a consumer can be upgraded without having any effect on hello producer.</span></span> <span data-ttu-id="49d3b-134">Kromě toho hello zasílání zpráv topologie můžete rozvíjet bez ovlivnění hello stávající koncové body.</span><span class="sxs-lookup"><span data-stu-id="49d3b-134">Furthermore, hello messaging topology can evolve without affecting hello existing endpoints.</span></span> <span data-ttu-id="49d3b-135">Probereme to více při mluvíme o publikování a přihlášení k odběru.</span><span class="sxs-lookup"><span data-stu-id="49d3b-135">We’ll discuss this more when we talk about publish/subscribe.</span></span>

## <a name="show-me-hello-code"></a><span data-ttu-id="49d3b-136">Zobrazit mi hello kódu</span><span class="sxs-lookup"><span data-stu-id="49d3b-136">Show me hello code</span></span>
<span data-ttu-id="49d3b-137">Následující části ukazuje, jak Hello toouse Service Bus toobuild této aplikace.</span><span class="sxs-lookup"><span data-stu-id="49d3b-137">hello following section shows how toouse Service Bus toobuild this application.</span></span>

### <a name="sign-up-for-an-azure-account"></a><span data-ttu-id="49d3b-138">Zaregistrujte si účet Azure</span><span class="sxs-lookup"><span data-stu-id="49d3b-138">Sign up for an Azure account</span></span>
<span data-ttu-id="49d3b-139">Budete potřebovat účet Azure v pořadí toostart práce s Service Bus.</span><span class="sxs-lookup"><span data-stu-id="49d3b-139">You’ll need an Azure account in order toostart working with Service Bus.</span></span> <span data-ttu-id="49d3b-140">Pokud není již nemáte, můžete zaregistrovat bezplatný účet [zde](https://azure.microsoft.com/pricing/free-trial/?WT.mc_id=A85619ABF).</span><span class="sxs-lookup"><span data-stu-id="49d3b-140">If you do not already have one, you can sign up for a free account [here](https://azure.microsoft.com/pricing/free-trial/?WT.mc_id=A85619ABF).</span></span>

### <a name="create-a-namespace"></a><span data-ttu-id="49d3b-141">Vytvoření oboru názvů</span><span class="sxs-lookup"><span data-stu-id="49d3b-141">Create a namespace</span></span>
<span data-ttu-id="49d3b-142">Jakmile máte předplatné, můžete [vytvořit obor názvů služby](service-bus-create-namespace-portal.md).</span><span class="sxs-lookup"><span data-stu-id="49d3b-142">Once you have a subscription, you can [create a service namespace](service-bus-create-namespace-portal.md).</span></span> <span data-ttu-id="49d3b-143">Každý obor názvů funguje jako kontejner oboru pro sadu entit služby Service Bus.</span><span class="sxs-lookup"><span data-stu-id="49d3b-143">Each namespace acts as a scoping container for a set of Service Bus entities.</span></span> <span data-ttu-id="49d3b-144">Zadejte jedinečný název váš nový obor názvů mezi všechny účty služby Service Bus.</span><span class="sxs-lookup"><span data-stu-id="49d3b-144">Give your new namespace a unique name across all Service Bus accounts.</span></span> 

### <a name="install-hello-nuget-package"></a><span data-ttu-id="49d3b-145">Nainstalujte balíček NuGet hello</span><span class="sxs-lookup"><span data-stu-id="49d3b-145">Install hello NuGet package</span></span>
<span data-ttu-id="49d3b-146">obor názvů sběrnice hello toouse, aplikace musí odkazovat hello sestavení Service Bus, konkrétně Microsoft.ServiceBus.dll.</span><span class="sxs-lookup"><span data-stu-id="49d3b-146">toouse hello Service Bus namespace, an application must reference hello Service Bus assembly, specifically Microsoft.ServiceBus.dll.</span></span> <span data-ttu-id="49d3b-147">Můžete najít toto sestavení součástí hello Microsoft Azure SDK a stažení hello je k dispozici na hello [stránky pro stažení sady Azure SDK](https://azure.microsoft.com/downloads/).</span><span class="sxs-lookup"><span data-stu-id="49d3b-147">You can find this assembly as part of hello Microsoft Azure SDK, and hello download is available at hello [Azure SDK download page](https://azure.microsoft.com/downloads/).</span></span> <span data-ttu-id="49d3b-148">Ale hello [balíček Service Bus NuGet](https://www.nuget.org/packages/WindowsAzure.ServiceBus) je hello nejjednodušší způsob, jak tooget hello rozhraní API služby Service Bus a tooconfigure aplikaci se všemi závislostmi služby Service Bus hello služby.</span><span class="sxs-lookup"><span data-stu-id="49d3b-148">However, hello [Service Bus NuGet package](https://www.nuget.org/packages/WindowsAzure.ServiceBus) is hello easiest way tooget hello Service Bus API and tooconfigure your application with all of hello Service Bus dependencies.</span></span>

### <a name="create-hello-queue"></a><span data-ttu-id="49d3b-149">Vytvořit frontu hello</span><span class="sxs-lookup"><span data-stu-id="49d3b-149">Create hello queue</span></span>
<span data-ttu-id="49d3b-150">Operace správy pro Service Bus entit pro zasílání zpráv (fronty a publikování a přihlášení k odběru témata) se provádí prostřednictvím hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) třídy.</span><span class="sxs-lookup"><span data-stu-id="49d3b-150">Management operations for Service Bus messaging entities (queues and publish/subscribe topics) are performed via hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) class.</span></span> <span data-ttu-id="49d3b-151">Service Bus používá [sdíleného přístupového podpisu (SAS)](service-bus-sas.md) model zabezpečení založený na.</span><span class="sxs-lookup"><span data-stu-id="49d3b-151">Service Bus uses a [Shared Access Signature (SAS)](service-bus-sas.md) based security model.</span></span> <span data-ttu-id="49d3b-152">Hello [TokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider) třída představuje poskytovatele tokenu zabezpečení se zabudovanými metodami pro vytváření vracení některé známé poskytovatele tokenů.</span><span class="sxs-lookup"><span data-stu-id="49d3b-152">hello [TokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider) class represents a security token provider with built-in factory methods returning some well-known token providers.</span></span> <span data-ttu-id="49d3b-153">Použijeme [CreateSharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#Microsoft_ServiceBus_TokenProvider_CreateSharedAccessSignatureTokenProvider_System_String_) přihlašovací údaje SAS metoda toohold hello.</span><span class="sxs-lookup"><span data-stu-id="49d3b-153">We’ll use a [CreateSharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#Microsoft_ServiceBus_TokenProvider_CreateSharedAccessSignatureTokenProvider_System_String_) method toohold hello SAS credentials.</span></span> <span data-ttu-id="49d3b-154">Hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) instance je pak vytvořený pomocí hello bázové adresy oboru názvů Service Bus hello a zprostředkovatele tokenu hello.</span><span class="sxs-lookup"><span data-stu-id="49d3b-154">hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) instance is then constructed with hello base address of hello Service Bus namespace and hello token provider.</span></span>

<span data-ttu-id="49d3b-155">Hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) třída poskytuje metody toocreate, výčet a odstranění entit pro zasílání zpráv.</span><span class="sxs-lookup"><span data-stu-id="49d3b-155">hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) class provides methods toocreate, enumerate and delete messaging entities.</span></span> <span data-ttu-id="49d3b-156">Hello kód, který zobrazí se zde zobrazí jak hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) instance je vytvořený a slouží toocreate hello **DataCollectionQueue** fronty.</span><span class="sxs-lookup"><span data-stu-id="49d3b-156">hello code that is shown here shows how hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) instance is created and used toocreate hello **DataCollectionQueue** queue.</span></span>

```csharp
Uri uri = ServiceBusEnvironment.CreateServiceUri("sb", 
                "test-blog", string.Empty);
string name = "RootManageSharedAccessKey";
string key = "abcdefghijklmopqrstuvwxyz";

TokenProvider tokenProvider = 
    TokenProvider.CreateSharedAccessSignatureTokenProvider(name, key);
NamespaceManager namespaceManager = 
    new NamespaceManager(uri, tokenProvider);
namespaceManager.CreateQueue("DataCollectionQueue");
```

<span data-ttu-id="49d3b-157">Všimněte si, že jsou přetížení hello [CreateQueue](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateQueue_System_String_) metoda, která povolení vlastností toobe fronty hello přizpůsobená.</span><span class="sxs-lookup"><span data-stu-id="49d3b-157">Note that there are overloads of hello [CreateQueue](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateQueue_System_String_) method that enable properties of hello queue toobe tuned.</span></span> <span data-ttu-id="49d3b-158">Například můžete nastavit hello výchozí time to live (TTL) hodnotu pro zprávy odeslané toohello fronty.</span><span class="sxs-lookup"><span data-stu-id="49d3b-158">For example, you can set hello default time-to-live (TTL) value for messages sent toohello queue.</span></span>

### <a name="send-messages-toohello-queue"></a><span data-ttu-id="49d3b-159">Odesílat zprávy fronty toohello</span><span class="sxs-lookup"><span data-stu-id="49d3b-159">Send messages toohello queue</span></span>
<span data-ttu-id="49d3b-160">Pro spuštění operace na Service Bus entity; například odesílání a přijímání zpráv, aplikace musíte nejdřív vytvořit [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) objektu.</span><span class="sxs-lookup"><span data-stu-id="49d3b-160">For run-time operations on Service Bus entities; for example, sending and receiving messages, an application must first create a [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) object.</span></span> <span data-ttu-id="49d3b-161">Podobně jako toohello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) třídy, hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) instance je vytvořený z hello bázové adresy oboru názvů služby hello a zprostředkovatele tokenu hello.</span><span class="sxs-lookup"><span data-stu-id="49d3b-161">Similar toohello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) class, hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) instance is created from hello base address of hello service namespace and hello token provider.</span></span>

```csharp
 BrokeredMessage bm = new BrokeredMessage(salesData);
 bm.Label = "SalesReport";
 bm.Properties["StoreName"] = "Redmond";
 bm.Properties["MachineID"] = "POS_1";
```

<span data-ttu-id="49d3b-162">Zprávy odeslané do a fronty přijal od služby Service Bus jsou instance třídy hello [BrokeredMessage](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage) třídy.</span><span class="sxs-lookup"><span data-stu-id="49d3b-162">Messages sent to, and received from Service Bus queues are instances of hello [BrokeredMessage](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage) class.</span></span> <span data-ttu-id="49d3b-163">Tato třída obsahuje sadu standardních vlastností (jako například [popisek](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label) a [TimeToLive](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_TimeToLive)), slovník, který je použité toohold vlastnosti aplikace a tělo s libovolnými aplikačními daty.</span><span class="sxs-lookup"><span data-stu-id="49d3b-163">This class consists of a set of standard properties (such as [Label](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label) and [TimeToLive](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_TimeToLive)), a dictionary that is used toohold application properties, and a body of arbitrary application data.</span></span> <span data-ttu-id="49d3b-164">Aplikace může tělo hello nastavit tak předávání jakýkoli serializovatelný objekt (hello následující příklad předá **SalesData** objekt, který představuje data prodeje hello z terminálu hello POS), který budou používat hello [ DataContractSerializer](https://msdn.microsoft.com/library/system.runtime.serialization.datacontractserializer.aspx) tooserialize hello objektu.</span><span class="sxs-lookup"><span data-stu-id="49d3b-164">An application can set hello body by passing in any serializable object (hello following example passes in a **SalesData** object that represents hello sales data from hello POS terminal), which will use hello [DataContractSerializer](https://msdn.microsoft.com/library/system.runtime.serialization.datacontractserializer.aspx) tooserialize hello object.</span></span> <span data-ttu-id="49d3b-165">Alternativně [datového proudu](https://msdn.microsoft.com/library/system.io.stream.aspx) může být zadán objekt.</span><span class="sxs-lookup"><span data-stu-id="49d3b-165">Alternatively, a [Stream](https://msdn.microsoft.com/library/system.io.stream.aspx) object can be provided.</span></span>

<span data-ttu-id="49d3b-166">Nejjednodušší způsob, jak toosend zprávy tooa zadané frontě, v našem případu hello Hello **DataCollectionQueue**, je toouse [CreateMessageSender](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageSender_System_String_) toocreate [MessageSender](/dotnet/api/microsoft.servicebus.messaging.messagesender) objektu přímo z hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) instance.</span><span class="sxs-lookup"><span data-stu-id="49d3b-166">hello easiest way toosend messages tooa given queue, in our case hello **DataCollectionQueue**, is toouse [CreateMessageSender](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageSender_System_String_) toocreate a [MessageSender](/dotnet/api/microsoft.servicebus.messaging.messagesender) object directly from hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) instance.</span></span>

```csharp
MessageSender sender = factory.CreateMessageSender("DataCollectionQueue");
sender.Send(bm);
```

### <a name="receiving-messages-from-hello-queue"></a><span data-ttu-id="49d3b-167">Přijímání zpráv z fronty hello</span><span class="sxs-lookup"><span data-stu-id="49d3b-167">Receiving messages from hello queue</span></span>
<span data-ttu-id="49d3b-168">tooreceive zprávy z fronty hello, můžete použít [MessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagereceiver) objekt, který vytvoříte přímo z hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) pomocí [CreateMessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageReceiver_System_String_).</span><span class="sxs-lookup"><span data-stu-id="49d3b-168">tooreceive messages from hello queue, you can use a [MessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagereceiver) object which you create directly from hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) using [CreateMessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageReceiver_System_String_).</span></span> <span data-ttu-id="49d3b-169">Zpráva příjemci můžou pracovat ve dvou různých režimech: **ReceiveAndDelete** a **PeekLock**.</span><span class="sxs-lookup"><span data-stu-id="49d3b-169">Message receivers can work in two different modes: **ReceiveAndDelete** and **PeekLock**.</span></span> <span data-ttu-id="49d3b-170">Hello [ReceiveMode](/dotnet/api/microsoft.servicebus.messaging.receivemode) je nastaven při vytváření příjemce zprávu hello jako parametr toohello [CreateMessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagingfactory?redirectedfrom=MSDN#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageReceiver_System_String_Microsoft_ServiceBus_Messaging_ReceiveMode_) volání.</span><span class="sxs-lookup"><span data-stu-id="49d3b-170">hello [ReceiveMode](/dotnet/api/microsoft.servicebus.messaging.receivemode) is set when hello message receiver is created, as a parameter toohello [CreateMessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagingfactory?redirectedfrom=MSDN#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageReceiver_System_String_Microsoft_ServiceBus_Messaging_ReceiveMode_) call.</span></span>

<span data-ttu-id="49d3b-171">Při použití hello **ReceiveAndDelete** přijímat hello režimu, je jednorázová operace; to znamená, když Service Bus přijme požadavek hello, označí uvítací zprávu jako spotřebovávanou a vrátí ji toohello aplikace.</span><span class="sxs-lookup"><span data-stu-id="49d3b-171">When using hello **ReceiveAndDelete** mode, hello receive is a single-shot operation; that is, when Service Bus receives hello request, it marks hello message as being consumed and returns it toohello application.</span></span> <span data-ttu-id="49d3b-172">**ReceiveAndDelete** režimu je hello nejjednodušší model a funguje nejlépe ve scénářích, které hello aplikace může tolerovat selhání kdyby toooccur se zpráva nezpracuje.</span><span class="sxs-lookup"><span data-stu-id="49d3b-172">**ReceiveAndDelete** mode is hello simplest model and works best for scenarios in which hello application can tolerate not processing a message if a failure were toooccur.</span></span> <span data-ttu-id="49d3b-173">toounderstand, představte si třeba situaci v problémy, které příjemce hello hello přijímání požadavků a pak dojde k chybě před zpracováním ho.</span><span class="sxs-lookup"><span data-stu-id="49d3b-173">toounderstand this, consider a scenario in which hello consumer issues hello receive request and then crashes before processing it.</span></span> <span data-ttu-id="49d3b-174">Vzhledem k tomu, že Service Bus označena uvítací zprávu jako spotřebovávanou, když hello aplikace se restartuje a začne znovu přijímat zprávy ho bude neuskutečnily uvítací zprávu, která se spotřebovala před hello havárií.</span><span class="sxs-lookup"><span data-stu-id="49d3b-174">Since Service Bus marked hello message as being consumed, when hello application restarts and starts consuming messages again, it will have missed hello message that was consumed before hello crash.</span></span>

<span data-ttu-id="49d3b-175">V **PeekLock** přijímat hello režimu, se stane dvoufázová operace, takže je možné toosupport aplikace, které nemůžou tolerovat vynechání zpráv.</span><span class="sxs-lookup"><span data-stu-id="49d3b-175">In **PeekLock** mode, hello receive becomes a two-stage operation, which makes it possible toosupport applications that cannot tolerate missing messages.</span></span> <span data-ttu-id="49d3b-176">Když Service Bus přijme požadavek hello, najde hello další zprávy toobe využívat, uzamkne ji tooprevent jinými spotřebiteli a vrátí ji toohello aplikace.</span><span class="sxs-lookup"><span data-stu-id="49d3b-176">When Service Bus receives hello request, it finds hello next message toobe consumed, locks it tooprevent other consumers receiving it, and then returns it toohello application.</span></span> <span data-ttu-id="49d3b-177">Po hello aplikace dokončí zpracování zprávy hello (nebo ji bezpečně uloží pro pozdější zpracování), tím potvrdí dokončení druhé fáze hello hello přijímat proces voláním [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) na uvítací přijal zprávu.</span><span class="sxs-lookup"><span data-stu-id="49d3b-177">After hello application finishes processing hello message (or stores it reliably for future processing), it completes hello second stage of hello receive process by calling [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) on hello received message.</span></span> <span data-ttu-id="49d3b-178">Když Service Bus uvidí hello [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) volání, která se označuje uvítací zprávu jako spotřebovávanou.</span><span class="sxs-lookup"><span data-stu-id="49d3b-178">When Service Bus sees hello [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) call, it marks hello message as being consumed.</span></span>

<span data-ttu-id="49d3b-179">K dispozici jsou dva další výsledky.</span><span class="sxs-lookup"><span data-stu-id="49d3b-179">Two other outcomes are possible.</span></span> <span data-ttu-id="49d3b-180">První, pokud aplikace hello nedokáže tooprocess hello zprávy z nějakého důvodu, můžete volat [Abandon](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) na uvítací přijal zprávu (místo [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete)).</span><span class="sxs-lookup"><span data-stu-id="49d3b-180">First, if hello application is unable tooprocess hello message for some reason, it can call [Abandon](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) on hello received message (instead of [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete)).</span></span> <span data-ttu-id="49d3b-181">To způsobí, že Service Bus toounlock uvítací zprávu a nastavit jej jako dostupné toobe přijetí, buď hello příjemce stejné nebo jiné dokončuje příjemce.</span><span class="sxs-lookup"><span data-stu-id="49d3b-181">This causes Service Bus toounlock hello message and make it available toobe received again, either by hello same consumer or by another completing consumer.</span></span> <span data-ttu-id="49d3b-182">Druhý je časový limit zámku hello a pokud aplikace hello nemůže zpracovat zprávu hello před hello zámku vyprší časový limit (například pokud hello aplikace spadne), pak bude odemknutí Service Bus hello zprávy a nastavit jej jako dostupné toobe přijetí (v podstatě provádění [Abandon](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) operace ve výchozím nastavení).</span><span class="sxs-lookup"><span data-stu-id="49d3b-182">Second, there is a time-out associated with hello lock and if hello application cannot process hello message before hello lock time-out expires (for example, if hello application crashes), then Service Bus will unlock hello message and make it available toobe received again (essentially performing an [Abandon](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Abandon) operation by default).</span></span>

<span data-ttu-id="49d3b-183">Všimněte si, že pokud hello aplikace spadne po zpracování uvítací zprávu, ale před hello [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) byl vydán požadavek, uvítací zprávu bude víckrát toohello aplikace odešle znovu.</span><span class="sxs-lookup"><span data-stu-id="49d3b-183">Note that if hello application crashes after it processes hello message but before hello [Complete](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Complete) request was issued, hello message will be redelivered toohello application when it restarts.</span></span> <span data-ttu-id="49d3b-184">To se často říká * alespoň jednou * zpracování.</span><span class="sxs-lookup"><span data-stu-id="49d3b-184">This is often termed *At Least Once * processing.</span></span> <span data-ttu-id="49d3b-185">To znamená, že každá zpráva se zpracuje alespoň jednou, ale v některých situacích hello může doručit víckrát.</span><span class="sxs-lookup"><span data-stu-id="49d3b-185">This means that each message will be processed at least once but in certain situations hello same message may be redelivered.</span></span> <span data-ttu-id="49d3b-186">Pokud hello scénář nemůže tolerovat zpracování duplicitní, bude potřeba další logiku v hello aplikace toodetect duplikáty.</span><span class="sxs-lookup"><span data-stu-id="49d3b-186">If hello scenario cannot tolerate duplicate processing, then additional logic is required in hello application toodetect duplicates.</span></span> <span data-ttu-id="49d3b-187">Toho lze dosáhnout podle hello [MessageId](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId) vlastnost uvítací zprávu.</span><span class="sxs-lookup"><span data-stu-id="49d3b-187">This can be achieved based on hello [MessageId](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId) property of hello message.</span></span> <span data-ttu-id="49d3b-188">Hodnota této vlastnosti Hello konstantní mezi pokusy o doručení.</span><span class="sxs-lookup"><span data-stu-id="49d3b-188">hello value of this property remains constant across delivery attempts.</span></span> <span data-ttu-id="49d3b-189">To se říká *právě jednou* zpracování.</span><span class="sxs-lookup"><span data-stu-id="49d3b-189">This is termed *Exactly Once* processing.</span></span>

<span data-ttu-id="49d3b-190">Hello kód, který se zobrazí tady obdrží a zpracuje zprávy pomocí hello **PeekLock** režimu, což je výchozí hello, pokud žádné [ReceiveMode](/dotnet/api/microsoft.servicebus.messaging.receivemode) explicitně zadat hodnotu.</span><span class="sxs-lookup"><span data-stu-id="49d3b-190">hello code that is shown here receives and processes a message using hello **PeekLock** mode, which is hello default if no [ReceiveMode](/dotnet/api/microsoft.servicebus.messaging.receivemode) value is explicitly provided.</span></span>

```csharp
MessageReceiver receiver = factory.CreateMessageReceiver("DataCollectionQueue");
BrokeredMessage receivedMessage = receiver.Receive();
try
{
    ProcessMessage(receivedMessage);
    receivedMessage.Complete();
}
catch (Exception e)
{
    receivedMessage.Abandon();
}
```

### <a name="use-hello-queue-client"></a><span data-ttu-id="49d3b-191">Použijte hello fronty klienta</span><span class="sxs-lookup"><span data-stu-id="49d3b-191">Use hello queue client</span></span>
<span data-ttu-id="49d3b-192">Hello příklady dříve v této části vytvořit [MessageSender](/dotnet/api/microsoft.servicebus.messaging.messagesender) a [MessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagereceiver) objekty přímo z hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) toosend a přijímat zprávy z fronty hello v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="49d3b-192">hello examples earlier in this section created [MessageSender](/dotnet/api/microsoft.servicebus.messaging.messagesender) and [MessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagereceiver) objects directly from hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) toosend and receive messages from hello queue, respectively.</span></span> <span data-ttu-id="49d3b-193">Alternativní způsob je toouse [QueueClient](/dotnet/api/microsoft.servicebus.messaging.queueclient) objekt, který podporuje jak operace odesílání a přijímání v přidání toomore rozšířené funkce, jako je například relací.</span><span class="sxs-lookup"><span data-stu-id="49d3b-193">An alternative approach is toouse a [QueueClient](/dotnet/api/microsoft.servicebus.messaging.queueclient) object, which supports both send and receive operations in addition toomore advanced features, such as sessions.</span></span>

```csharp
QueueClient queueClient = factory.CreateQueueClient("DataCollectionQueue");
queueClient.Send(bm);

BrokeredMessage message = queueClient.Receive();

try
{
    ProcessMessage(message);
    message.Complete();
}
catch (Exception e)
{
    message.Abandon();
} 
```

## <a name="next-steps"></a><span data-ttu-id="49d3b-194">Další kroky</span><span class="sxs-lookup"><span data-stu-id="49d3b-194">Next steps</span></span>
<span data-ttu-id="49d3b-195">Teď, když jste se naučili základy hello front, najdete v části [vytvářet aplikace, které používají témata a odběry Service Bus](service-bus-create-topics-subscriptions.md) toocontinue toto pojednání pomocí funkce pbulikovat/odebírat hello témat Service Bus a odběry.</span><span class="sxs-lookup"><span data-stu-id="49d3b-195">Now that you've learned hello basics of queues, see [Create applications that use Service Bus topics and subscriptions](service-bus-create-topics-subscriptions.md) toocontinue this discussion using hello publish/subscribe capabilities of Service Bus topics and subscriptions.</span></span>

