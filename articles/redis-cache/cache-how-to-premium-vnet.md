---
title: "aaaConfigure virtuální sítě pro mezipaměť Azure Redis Cache Premium | Microsoft Docs"
description: "Zjistěte, jak toocreate a spravovat podpory služby Virtual Network pro vaše instance služby Azure Redis Cache úrovně Premium"
services: redis-cache
documentationcenter: 
author: steved0x
manager: douge
editor: 
ms.assetid: 8b1e43a0-a70e-41e6-8994-0ac246d8bf7f
ms.service: cache
ms.workload: tbd
ms.tgt_pltfrm: cache-redis
ms.devlang: na
ms.topic: article
ms.date: 05/15/2017
ms.author: sdanie
ms.openlocfilehash: fab715f4d9365ee4c2f8b89d2e2e58768c25b671
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="how-tooconfigure-virtual-network-support-for-a-premium-azure-redis-cache"></a><span data-ttu-id="258fa-103">Jak tooconfigure podpora virtuální sítě pro mezipaměť Azure Redis Cache Premium</span><span class="sxs-lookup"><span data-stu-id="258fa-103">How tooconfigure Virtual Network Support for a Premium Azure Redis Cache</span></span>
<span data-ttu-id="258fa-104">Azure Redis Cache má jiný mezipaměti nabídky, které poskytují flexibilitu při výběru hello velikost mezipaměti a funkcí, včetně funkce úrovně Premium, jako je clustering, trvalosti a podpory služby virtual network.</span><span class="sxs-lookup"><span data-stu-id="258fa-104">Azure Redis Cache has different cache offerings, which provide flexibility in hello choice of cache size and features, including Premium tier features such as clustering, persistence, and virtual network support.</span></span> <span data-ttu-id="258fa-105">Virtuální síť je privátní síť v cloudu hello.</span><span class="sxs-lookup"><span data-stu-id="258fa-105">A VNet is a private network in hello cloud.</span></span> <span data-ttu-id="258fa-106">Pokud instanci služby Azure Redis Cache je konfigurován s virtuální síť, není veřejně adresovatelné a můžete přistupovat pouze z virtuálních počítačů a aplikací v rámci hello virtuální sítě.</span><span class="sxs-lookup"><span data-stu-id="258fa-106">When an Azure Redis Cache instance is configured with a VNet, it is not publicly addressable and can only be accessed from virtual machines and applications within hello VNet.</span></span> <span data-ttu-id="258fa-107">Tento článek popisuje, jak podporují tooconfigure virtuální sítě pro instanci služby Azure Redis Cache premium.</span><span class="sxs-lookup"><span data-stu-id="258fa-107">This article describes how tooconfigure virtual network support for a premium Azure Redis Cache instance.</span></span>

> [!NOTE]
> <span data-ttu-id="258fa-108">Azure Redis Cache podporuje obě classic a Resource Manager virtuální sítě.</span><span class="sxs-lookup"><span data-stu-id="258fa-108">Azure Redis Cache supports both classic and Resource Manager VNets.</span></span>
> 
> 

<span data-ttu-id="258fa-109">Informace o dalších funkcí mezipaměti premium najdete v tématu [Úvod toohello Azure Redis Cache na úrovni Premium](cache-premium-tier-intro.md).</span><span class="sxs-lookup"><span data-stu-id="258fa-109">For information on other premium cache features, see [Introduction toohello Azure Redis Cache Premium tier](cache-premium-tier-intro.md).</span></span>

## <a name="why-vnet"></a><span data-ttu-id="258fa-110">Proč virtuální síť?</span><span class="sxs-lookup"><span data-stu-id="258fa-110">Why VNet?</span></span>
<span data-ttu-id="258fa-111">[Virtuální síť Azure (VNet)](https://azure.microsoft.com/services/virtual-network/) nasazení poskytuje lepší zabezpečení a izolaci pro vaši Azure Redis Cache, stejně jako podsítě, zásady řízení přístupu a další funkce toofurther omezení přístupu.</span><span class="sxs-lookup"><span data-stu-id="258fa-111">[Azure Virtual Network (VNet)](https://azure.microsoft.com/services/virtual-network/) deployment provides enhanced security and isolation for your Azure Redis Cache, as well as subnets, access control policies, and other features toofurther restrict access.</span></span>

## <a name="virtual-network-support"></a><span data-ttu-id="258fa-112">Podpora virtuální sítě</span><span class="sxs-lookup"><span data-stu-id="258fa-112">Virtual network support</span></span>
<span data-ttu-id="258fa-113">Podpora služby Virtual Network (VNet) je nakonfigurován na hello **nová mezipaměť Redis** okno při vytvoření mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="258fa-113">Virtual Network (VNet) support is configured on hello **New Redis Cache** blade during cache creation.</span></span> 

[!INCLUDE [redis-cache-create](../../includes/redis-cache-premium-create.md)]

<span data-ttu-id="258fa-114">Jakmile vyberete cenová úroveň premium integrace Redis virtuální sítě můžete nakonfigurovat tak, že vyberete virtuální síť, která je v hello stejném předplatném a umístění jako mezipaměť.</span><span class="sxs-lookup"><span data-stu-id="258fa-114">Once you have selected a premium pricing tier, you can configure Redis VNet integration by selecting a VNet that is in hello same subscription and location as your cache.</span></span> <span data-ttu-id="258fa-115">toouse nové sítě VNet, je nejprve vytvořte pomocí následujících kroků hello v [vytvoření virtuální sítě pomocí portálu Azure hello](../virtual-network/virtual-networks-create-vnet-arm-pportal.md) nebo [vytvoření virtuální sítě (klasické) pomocí portálu Azure hello](../virtual-network/virtual-networks-create-vnet-classic-pportal.md) a pak se vraťte toohello **Nová mezipaměť Redis** toocreate okna a konfiguraci mezipaměti premium.</span><span class="sxs-lookup"><span data-stu-id="258fa-115">toouse a new VNet, create it first by following hello steps in [Create a virtual network using hello Azure portal](../virtual-network/virtual-networks-create-vnet-arm-pportal.md) or [Create a virtual network (classic) by using hello Azure portal](../virtual-network/virtual-networks-create-vnet-classic-pportal.md) and then return toohello **New Redis Cache** blade toocreate and configure your premium cache.</span></span>

<span data-ttu-id="258fa-116">tooconfigure hello virtuální sítě pro nové mezipaměti, klikněte na tlačítko **virtuální sítě** na hello **nová mezipaměť Redis** okno a vyberte hello požadovaného virtuální sítě z rozevíracího seznamu hello.</span><span class="sxs-lookup"><span data-stu-id="258fa-116">tooconfigure hello VNet for your new cache, click **Virtual Network** on hello **New Redis Cache** blade, and select hello desired VNet from hello drop-down list.</span></span>

![Virtuální síť][redis-cache-vnet]

<span data-ttu-id="258fa-118">Vyberte hello požadované podsíť z hello **podsíť** rozevíracího seznamu a zadejte hello potřeby **statická IP adresa**.</span><span class="sxs-lookup"><span data-stu-id="258fa-118">Select hello desired subnet from hello **Subnet** drop-down list, and specify hello desired **Static IP address**.</span></span> <span data-ttu-id="258fa-119">Pokud používáte klasickou virtuální síť hello **statická IP adresa** pole je volitelné, a pokud není zadaný žádný, jedna je vybrána z hello vybrané podsítě.</span><span class="sxs-lookup"><span data-stu-id="258fa-119">If you are using a classic VNet hello **Static IP address** field is optional, and if none is specified, one is chosen from hello selected subnet.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="258fa-120">Při nasazení Azure Redis Cache tooa virtuální sítě Resource Manageru, hello mezipaměti musí být ve vyhrazené podsíť, která obsahuje žádné další prostředky s výjimkou instance služby Azure Redis Cache.</span><span class="sxs-lookup"><span data-stu-id="258fa-120">When deploying an Azure Redis Cache tooa Resource Manager VNet, hello cache must be in a dedicated subnet that contains no other resources except for Azure Redis Cache instances.</span></span> <span data-ttu-id="258fa-121">Pokud je proveden pokus o toodeploy Azure Redis Cache tooa tooa podsíť virtuální sítě Resource Manageru, která obsahuje jiné prostředky, hello nasazení se nezdaří.</span><span class="sxs-lookup"><span data-stu-id="258fa-121">If an attempt is made toodeploy an Azure Redis Cache tooa Resource Manager VNet tooa subnet that contains other resources, hello deployment fails.</span></span>
> 
> 

![Virtuální síť][redis-cache-vnet-ip]

> [!IMPORTANT]
> <span data-ttu-id="258fa-123">Azure si vyhrazuje některé IP adresy v rámci každé podsítě a tyto adresy nelze použít.</span><span class="sxs-lookup"><span data-stu-id="258fa-123">Azure reserves some IP addresses within each subnet, and these addresses can't be used.</span></span> <span data-ttu-id="258fa-124">Hello první a poslední IP adres podsítě hello jsou vyhrazené pro protokol shoda, společně s tři další adresy používané pro služby Azure.</span><span class="sxs-lookup"><span data-stu-id="258fa-124">hello first and last IP addresses of hello subnets are reserved for protocol conformance, along with three more addresses used for Azure services.</span></span> <span data-ttu-id="258fa-125">Další informace najdete v tématu [existují nějaká omezení na pomocí IP adresy v rámci těchto podsítí?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span><span class="sxs-lookup"><span data-stu-id="258fa-125">For more information, see [Are there any restrictions on using IP addresses within these subnets?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span></span>
> 
> <span data-ttu-id="258fa-126">Přidání toohello IP adresy používané hello infrastruktury virtuální sítě Azure každý Redis instance v hello podsíť používá dvě IP adresy na horizontální oddíl a jednu IP adresu další nástroje pro vyrovnávání zatížení hello.</span><span class="sxs-lookup"><span data-stu-id="258fa-126">In addition toohello IP addresses used by hello Azure VNET infrastructure, each Redis instance in hello subnet uses two IP addresses per shard and one additional IP address for hello load balancer.</span></span> <span data-ttu-id="258fa-127">Mezipaměť vypojené z clusteru se považuje za jeden horizontálního oddílu toohave.</span><span class="sxs-lookup"><span data-stu-id="258fa-127">A non-clustered cache is considered toohave one shard.</span></span>
> 
> 

<span data-ttu-id="258fa-128">Po vytvoření mezipaměti hello hello konfiguraci pro hello virtuální sítě můžete zobrazit kliknutím na **virtuální sítě** z hello **prostředků nabídky**.</span><span class="sxs-lookup"><span data-stu-id="258fa-128">After hello cache is created, you can view hello configuration for hello VNet by clicking **Virtual Network** from hello **Resource menu**.</span></span>

![Virtuální síť][redis-cache-vnet-info]

<span data-ttu-id="258fa-130">tooconnect tooyour Azure Redis cache instance při použití virtuální síť, zadejte název hostitele hello svojí mezipaměti hello připojovacího řetězce, jak je znázorněno v hello následující ukázka:</span><span class="sxs-lookup"><span data-stu-id="258fa-130">tooconnect tooyour Azure Redis cache instance when using a VNet, specify hello host name of your cache in hello connection string as shown in hello following example:</span></span>

    private static Lazy<ConnectionMultiplexer> lazyConnection = new Lazy<ConnectionMultiplexer>(() =>
    {
        return ConnectionMultiplexer.Connect("contoso5premium.redis.cache.windows.net,abortConnect=false,ssl=true,password=password");
    });

    public static ConnectionMultiplexer Connection
    {
        get
        {
            return lazyConnection.Value;
        }
    }

## <a name="azure-redis-cache-vnet-faq"></a><span data-ttu-id="258fa-131">VNet Azure Redis Cache – nejčastější dotazy</span><span class="sxs-lookup"><span data-stu-id="258fa-131">Azure Redis Cache VNet FAQ</span></span>
<span data-ttu-id="258fa-132">Hello následující seznam obsahuje odpovědi toocommonly kladené dotazy týkající se hello škálování Azure Redis Cache.</span><span class="sxs-lookup"><span data-stu-id="258fa-132">hello following list contains answers toocommonly asked questions about hello Azure Redis Cache scaling.</span></span>

* [<span data-ttu-id="258fa-133">Jaké jsou některé běžné chybné konfigurace problémy s Azure Redis Cache a virtuální sítě?</span><span class="sxs-lookup"><span data-stu-id="258fa-133">What are some common misconfiguration issues with Azure Redis Cache and VNets?</span></span>](#what-are-some-common-misconfiguration-issues-with-azure-redis-cache-and-vnets)
* [<span data-ttu-id="258fa-134">Jak můžete ověřit, že moje mezipaměti funguje ve virtuální síti?</span><span class="sxs-lookup"><span data-stu-id="258fa-134">How can I verify that my cache is working in a VNET?</span></span>](#how-can-i-verify-that-my-cache-is-working-in-a-vnet)
* [<span data-ttu-id="258fa-135">Můžete použít virtuální sítě s standardní nebo základní mezipaměti?</span><span class="sxs-lookup"><span data-stu-id="258fa-135">Can I use VNets with a standard or basic cache?</span></span>](#can-i-use-vnets-with-a-standard-or-basic-cache)
* [<span data-ttu-id="258fa-136">Proč vytvoření mezipaměti Redis selhání v některé podsítě a jiné ne?</span><span class="sxs-lookup"><span data-stu-id="258fa-136">Why does creating a Redis cache fail in some subnets but not others?</span></span>](#why-does-creating-a-redis-cache-fail-in-some-subnets-but-not-others)
* [<span data-ttu-id="258fa-137">Jaké jsou požadavky na místo na hello podsíť adres?</span><span class="sxs-lookup"><span data-stu-id="258fa-137">What are hello subnet address space requirements?</span></span>](#what-are-the-subnet-address-space-requirements)
* [<span data-ttu-id="258fa-138">Fungují všechny funkce mezipaměti při hostování mezipaměti ve virtuální síti?</span><span class="sxs-lookup"><span data-stu-id="258fa-138">Do all cache features work when hosting a cache in a VNET?</span></span>](#do-all-cache-features-work-when-hosting-a-cache-in-a-vnet)

## <a name="what-are-some-common-misconfiguration-issues-with-azure-redis-cache-and-vnets"></a><span data-ttu-id="258fa-139">Jaké jsou některé běžné chybné konfigurace problémy s Azure Redis Cache a virtuální sítě?</span><span class="sxs-lookup"><span data-stu-id="258fa-139">What are some common misconfiguration issues with Azure Redis Cache and VNets?</span></span>
<span data-ttu-id="258fa-140">Pokud Azure Redis Cache je hostovaná ve virtuální síti, se použijí hello porty hello následující tabulky.</span><span class="sxs-lookup"><span data-stu-id="258fa-140">When Azure Redis Cache is hosted in a VNet, hello ports in hello following tables are used.</span></span> 

>[!IMPORTANT]
><span data-ttu-id="258fa-141">Pokud jsou zablokované hello porty hello následující tabulky, mezipaměti hello nemusí správně fungovat.</span><span class="sxs-lookup"><span data-stu-id="258fa-141">If hello ports in hello following tables are blocked, hello cache may not function correctly.</span></span> <span data-ttu-id="258fa-142">Nejméně jeden z těchto portů blokované je hello nejběžnější chybné konfigurace problém při použití Azure Redis Cache ve virtuální síti.</span><span class="sxs-lookup"><span data-stu-id="258fa-142">Having one or more of these ports blocked is hello most common misconfiguration issue when using Azure Redis Cache in a VNet.</span></span>
> 
> 

- [<span data-ttu-id="258fa-143">Požadavky na odchozí port</span><span class="sxs-lookup"><span data-stu-id="258fa-143">Outbound port requirements</span></span>](#outbound-port-requirements)
- [<span data-ttu-id="258fa-144">Požadavky na portu pro příchozí spojení</span><span class="sxs-lookup"><span data-stu-id="258fa-144">Inbound port requirements</span></span>](#inbound-port-requirements)

### <a name="outbound-port-requirements"></a><span data-ttu-id="258fa-145">Požadavky na odchozí port</span><span class="sxs-lookup"><span data-stu-id="258fa-145">Outbound port requirements</span></span>

<span data-ttu-id="258fa-146">Existuj sedm požadavků odchozí port.</span><span class="sxs-lookup"><span data-stu-id="258fa-146">There are seven outbound port requirements.</span></span>

- <span data-ttu-id="258fa-147">V případě potřeby všechny toohello odchozí připojení, které internet můžete provedeny prostřednictvím klienta místní auditování zařízení.</span><span class="sxs-lookup"><span data-stu-id="258fa-147">If desired, all outbound connections toohello internet can be made through a client's on-premises auditing device.</span></span>
- <span data-ttu-id="258fa-148">Tři porty hello směrovat provoz tooAzure koncové body údržby Azure Storage a Azure DNS.</span><span class="sxs-lookup"><span data-stu-id="258fa-148">Three of hello ports route traffic tooAzure endpoints servicing Azure Storage and Azure DNS.</span></span>
- <span data-ttu-id="258fa-149">Hello zbývající rozsahy portů a pro interní komunikaci podsítě Redis.</span><span class="sxs-lookup"><span data-stu-id="258fa-149">hello remaining port ranges and for internal Redis subnet communications.</span></span> <span data-ttu-id="258fa-150">Pravidla NSG žádné podsítě jsou požadovány pro interní komunikaci podsítě Redis.</span><span class="sxs-lookup"><span data-stu-id="258fa-150">No subnet NSG rules are required for internal Redis subnet communications.</span></span>

| <span data-ttu-id="258fa-151">Port(y) pro</span><span class="sxs-lookup"><span data-stu-id="258fa-151">Port(s)</span></span> | <span data-ttu-id="258fa-152">Směr</span><span class="sxs-lookup"><span data-stu-id="258fa-152">Direction</span></span> | <span data-ttu-id="258fa-153">Přenosový protokol</span><span class="sxs-lookup"><span data-stu-id="258fa-153">Transport Protocol</span></span> | <span data-ttu-id="258fa-154">Účel</span><span class="sxs-lookup"><span data-stu-id="258fa-154">Purpose</span></span> | <span data-ttu-id="258fa-155">Místní IP</span><span class="sxs-lookup"><span data-stu-id="258fa-155">Local IP</span></span> | <span data-ttu-id="258fa-156">Vzdálené IP</span><span class="sxs-lookup"><span data-stu-id="258fa-156">Remote IP</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="258fa-157">80, 443</span><span class="sxs-lookup"><span data-stu-id="258fa-157">80, 443</span></span> |<span data-ttu-id="258fa-158">Odchozí</span><span class="sxs-lookup"><span data-stu-id="258fa-158">Outbound</span></span> |<span data-ttu-id="258fa-159">TCP</span><span class="sxs-lookup"><span data-stu-id="258fa-159">TCP</span></span> |<span data-ttu-id="258fa-160">Redis závislosti na Azure Storage nebo infrastruktury veřejných KLÍČŮ (Internet)</span><span class="sxs-lookup"><span data-stu-id="258fa-160">Redis dependencies on Azure Storage/PKI (Internet)</span></span> | <span data-ttu-id="258fa-161">(Redis podsíť)</span><span class="sxs-lookup"><span data-stu-id="258fa-161">(Redis subnet)</span></span> |* |
| <span data-ttu-id="258fa-162">53</span><span class="sxs-lookup"><span data-stu-id="258fa-162">53</span></span> |<span data-ttu-id="258fa-163">Odchozí</span><span class="sxs-lookup"><span data-stu-id="258fa-163">Outbound</span></span> |<span data-ttu-id="258fa-164">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="258fa-164">TCP/UDP</span></span> |<span data-ttu-id="258fa-165">Redis závislosti ve službě DNS (Internet nebo VNet)</span><span class="sxs-lookup"><span data-stu-id="258fa-165">Redis dependencies on DNS (Internet/VNet)</span></span> | <span data-ttu-id="258fa-166">(Redis podsíť)</span><span class="sxs-lookup"><span data-stu-id="258fa-166">(Redis subnet)</span></span> |* |
| <span data-ttu-id="258fa-167">8443</span><span class="sxs-lookup"><span data-stu-id="258fa-167">8443</span></span> |<span data-ttu-id="258fa-168">Odchozí</span><span class="sxs-lookup"><span data-stu-id="258fa-168">Outbound</span></span> |<span data-ttu-id="258fa-169">TCP</span><span class="sxs-lookup"><span data-stu-id="258fa-169">TCP</span></span> |<span data-ttu-id="258fa-170">Interní komunikaci pro Redis</span><span class="sxs-lookup"><span data-stu-id="258fa-170">Internal communications for Redis</span></span> | <span data-ttu-id="258fa-171">(Redis podsíť)</span><span class="sxs-lookup"><span data-stu-id="258fa-171">(Redis subnet)</span></span> | <span data-ttu-id="258fa-172">(Redis podsíť)</span><span class="sxs-lookup"><span data-stu-id="258fa-172">(Redis subnet)</span></span> |
| <span data-ttu-id="258fa-173">10221-10231</span><span class="sxs-lookup"><span data-stu-id="258fa-173">10221-10231</span></span> |<span data-ttu-id="258fa-174">Odchozí</span><span class="sxs-lookup"><span data-stu-id="258fa-174">Outbound</span></span> |<span data-ttu-id="258fa-175">TCP</span><span class="sxs-lookup"><span data-stu-id="258fa-175">TCP</span></span> |<span data-ttu-id="258fa-176">Interní komunikaci pro Redis</span><span class="sxs-lookup"><span data-stu-id="258fa-176">Internal communications for Redis</span></span> | <span data-ttu-id="258fa-177">(Redis podsíť)</span><span class="sxs-lookup"><span data-stu-id="258fa-177">(Redis subnet)</span></span> | <span data-ttu-id="258fa-178">(Redis podsíť)</span><span class="sxs-lookup"><span data-stu-id="258fa-178">(Redis subnet)</span></span> |
| <span data-ttu-id="258fa-179">20226</span><span class="sxs-lookup"><span data-stu-id="258fa-179">20226</span></span> |<span data-ttu-id="258fa-180">Odchozí</span><span class="sxs-lookup"><span data-stu-id="258fa-180">Outbound</span></span> |<span data-ttu-id="258fa-181">TCP</span><span class="sxs-lookup"><span data-stu-id="258fa-181">TCP</span></span> |<span data-ttu-id="258fa-182">Interní komunikaci pro Redis</span><span class="sxs-lookup"><span data-stu-id="258fa-182">Internal communications for Redis</span></span> | <span data-ttu-id="258fa-183">(Redis podsíť)</span><span class="sxs-lookup"><span data-stu-id="258fa-183">(Redis subnet)</span></span> |<span data-ttu-id="258fa-184">(Redis podsíť)</span><span class="sxs-lookup"><span data-stu-id="258fa-184">(Redis subnet)</span></span> |
| <span data-ttu-id="258fa-185">13000-13999</span><span class="sxs-lookup"><span data-stu-id="258fa-185">13000-13999</span></span> |<span data-ttu-id="258fa-186">Odchozí</span><span class="sxs-lookup"><span data-stu-id="258fa-186">Outbound</span></span> |<span data-ttu-id="258fa-187">TCP</span><span class="sxs-lookup"><span data-stu-id="258fa-187">TCP</span></span> |<span data-ttu-id="258fa-188">Interní komunikaci pro Redis</span><span class="sxs-lookup"><span data-stu-id="258fa-188">Internal communications for Redis</span></span> | <span data-ttu-id="258fa-189">(Redis podsíť)</span><span class="sxs-lookup"><span data-stu-id="258fa-189">(Redis subnet)</span></span> |<span data-ttu-id="258fa-190">(Redis podsíť)</span><span class="sxs-lookup"><span data-stu-id="258fa-190">(Redis subnet)</span></span> |
| <span data-ttu-id="258fa-191">15000-15999</span><span class="sxs-lookup"><span data-stu-id="258fa-191">15000-15999</span></span> |<span data-ttu-id="258fa-192">Odchozí</span><span class="sxs-lookup"><span data-stu-id="258fa-192">Outbound</span></span> |<span data-ttu-id="258fa-193">TCP</span><span class="sxs-lookup"><span data-stu-id="258fa-193">TCP</span></span> |<span data-ttu-id="258fa-194">Interní komunikaci pro Redis</span><span class="sxs-lookup"><span data-stu-id="258fa-194">Internal communications for Redis</span></span> | <span data-ttu-id="258fa-195">(Redis podsíť)</span><span class="sxs-lookup"><span data-stu-id="258fa-195">(Redis subnet)</span></span> |<span data-ttu-id="258fa-196">(Redis podsíť)</span><span class="sxs-lookup"><span data-stu-id="258fa-196">(Redis subnet)</span></span> |


### <a name="inbound-port-requirements"></a><span data-ttu-id="258fa-197">Požadavky na portu pro příchozí spojení</span><span class="sxs-lookup"><span data-stu-id="258fa-197">Inbound port requirements</span></span>

<span data-ttu-id="258fa-198">Nejsou osm požadavky rozsah portu pro příchozí spojení.</span><span class="sxs-lookup"><span data-stu-id="258fa-198">There are eight inbound port range requirements.</span></span> <span data-ttu-id="258fa-199">Příchozí požadavky do tohoto rozsahu buď jsou příchozí z jiné služby hostované v hello stejnou virtuální síť nebo interní toohello Redis podsíť komunikace.</span><span class="sxs-lookup"><span data-stu-id="258fa-199">Inbound requests in these ranges are either inbound from other services hosted in hello same VNET or internal toohello Redis subnet communications.</span></span>

| <span data-ttu-id="258fa-200">Port(y) pro</span><span class="sxs-lookup"><span data-stu-id="258fa-200">Port(s)</span></span> | <span data-ttu-id="258fa-201">Směr</span><span class="sxs-lookup"><span data-stu-id="258fa-201">Direction</span></span> | <span data-ttu-id="258fa-202">Přenosový protokol</span><span class="sxs-lookup"><span data-stu-id="258fa-202">Transport Protocol</span></span> | <span data-ttu-id="258fa-203">Účel</span><span class="sxs-lookup"><span data-stu-id="258fa-203">Purpose</span></span> | <span data-ttu-id="258fa-204">Místní IP</span><span class="sxs-lookup"><span data-stu-id="258fa-204">Local IP</span></span> | <span data-ttu-id="258fa-205">Vzdálené IP</span><span class="sxs-lookup"><span data-stu-id="258fa-205">Remote IP</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="258fa-206">6379, 6380</span><span class="sxs-lookup"><span data-stu-id="258fa-206">6379, 6380</span></span> |<span data-ttu-id="258fa-207">Příchozí</span><span class="sxs-lookup"><span data-stu-id="258fa-207">Inbound</span></span> |<span data-ttu-id="258fa-208">TCP</span><span class="sxs-lookup"><span data-stu-id="258fa-208">TCP</span></span> |<span data-ttu-id="258fa-209">Vyrovnávání zatížení Azure tooRedis komunikaci klienta,</span><span class="sxs-lookup"><span data-stu-id="258fa-209">Client communication tooRedis, Azure load balancing</span></span> | <span data-ttu-id="258fa-210">(Redis podsíť)</span><span class="sxs-lookup"><span data-stu-id="258fa-210">(Redis subnet)</span></span> |<span data-ttu-id="258fa-211">Virtuální síť, nástroj pro vyrovnávání zatížení Azure</span><span class="sxs-lookup"><span data-stu-id="258fa-211">Virtual Network, Azure Load Balancer</span></span> |
| <span data-ttu-id="258fa-212">8443</span><span class="sxs-lookup"><span data-stu-id="258fa-212">8443</span></span> |<span data-ttu-id="258fa-213">Příchozí</span><span class="sxs-lookup"><span data-stu-id="258fa-213">Inbound</span></span> |<span data-ttu-id="258fa-214">TCP</span><span class="sxs-lookup"><span data-stu-id="258fa-214">TCP</span></span> |<span data-ttu-id="258fa-215">Interní komunikaci pro Redis</span><span class="sxs-lookup"><span data-stu-id="258fa-215">Internal communications for Redis</span></span> | <span data-ttu-id="258fa-216">(Redis podsíť)</span><span class="sxs-lookup"><span data-stu-id="258fa-216">(Redis subnet)</span></span> |<span data-ttu-id="258fa-217">(Redis podsíť)</span><span class="sxs-lookup"><span data-stu-id="258fa-217">(Redis subnet)</span></span> |
| <span data-ttu-id="258fa-218">8500</span><span class="sxs-lookup"><span data-stu-id="258fa-218">8500</span></span> |<span data-ttu-id="258fa-219">Příchozí</span><span class="sxs-lookup"><span data-stu-id="258fa-219">Inbound</span></span> |<span data-ttu-id="258fa-220">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="258fa-220">TCP/UDP</span></span> |<span data-ttu-id="258fa-221">Vyrovnávání zatížení Azure</span><span class="sxs-lookup"><span data-stu-id="258fa-221">Azure load balancing</span></span> | <span data-ttu-id="258fa-222">(Redis podsíť)</span><span class="sxs-lookup"><span data-stu-id="258fa-222">(Redis subnet)</span></span> |<span data-ttu-id="258fa-223">Nástroj pro vyrovnávání zatížení Azure</span><span class="sxs-lookup"><span data-stu-id="258fa-223">Azure Load Balancer</span></span> |
| <span data-ttu-id="258fa-224">10221-10231</span><span class="sxs-lookup"><span data-stu-id="258fa-224">10221-10231</span></span> |<span data-ttu-id="258fa-225">Příchozí</span><span class="sxs-lookup"><span data-stu-id="258fa-225">Inbound</span></span> |<span data-ttu-id="258fa-226">TCP</span><span class="sxs-lookup"><span data-stu-id="258fa-226">TCP</span></span> |<span data-ttu-id="258fa-227">Interní komunikaci pro Redis</span><span class="sxs-lookup"><span data-stu-id="258fa-227">Internal communications for Redis</span></span> | <span data-ttu-id="258fa-228">(Redis podsíť)</span><span class="sxs-lookup"><span data-stu-id="258fa-228">(Redis subnet)</span></span> |<span data-ttu-id="258fa-229">(Redis podsíť), nástroj pro vyrovnávání zatížení Azure</span><span class="sxs-lookup"><span data-stu-id="258fa-229">(Redis subnet), Azure Load Balancer</span></span> |
| <span data-ttu-id="258fa-230">13000-13999</span><span class="sxs-lookup"><span data-stu-id="258fa-230">13000-13999</span></span> |<span data-ttu-id="258fa-231">Příchozí</span><span class="sxs-lookup"><span data-stu-id="258fa-231">Inbound</span></span> |<span data-ttu-id="258fa-232">TCP</span><span class="sxs-lookup"><span data-stu-id="258fa-232">TCP</span></span> |<span data-ttu-id="258fa-233">Klientské komunikace tooRedis clustery Vyrovnávání zatížení Azure</span><span class="sxs-lookup"><span data-stu-id="258fa-233">Client communication tooRedis Clusters, Azure load balancing</span></span> | <span data-ttu-id="258fa-234">(Redis podsíť)</span><span class="sxs-lookup"><span data-stu-id="258fa-234">(Redis subnet)</span></span> |<span data-ttu-id="258fa-235">Virtuální síť, nástroj pro vyrovnávání zatížení Azure</span><span class="sxs-lookup"><span data-stu-id="258fa-235">Virtual Network, Azure Load Balancer</span></span> |
| <span data-ttu-id="258fa-236">15000-15999</span><span class="sxs-lookup"><span data-stu-id="258fa-236">15000-15999</span></span> |<span data-ttu-id="258fa-237">Příchozí</span><span class="sxs-lookup"><span data-stu-id="258fa-237">Inbound</span></span> |<span data-ttu-id="258fa-238">TCP</span><span class="sxs-lookup"><span data-stu-id="258fa-238">TCP</span></span> |<span data-ttu-id="258fa-239">Vyrovnávání zatížení clusterů, Azure tooRedis komunikace klienta</span><span class="sxs-lookup"><span data-stu-id="258fa-239">Client communication tooRedis Clusters, Azure load Balancing</span></span> | <span data-ttu-id="258fa-240">(Redis podsíť)</span><span class="sxs-lookup"><span data-stu-id="258fa-240">(Redis subnet)</span></span> |<span data-ttu-id="258fa-241">Virtuální síť, nástroj pro vyrovnávání zatížení Azure</span><span class="sxs-lookup"><span data-stu-id="258fa-241">Virtual Network, Azure Load Balancer</span></span> |
| <span data-ttu-id="258fa-242">16001</span><span class="sxs-lookup"><span data-stu-id="258fa-242">16001</span></span> |<span data-ttu-id="258fa-243">Příchozí</span><span class="sxs-lookup"><span data-stu-id="258fa-243">Inbound</span></span> |<span data-ttu-id="258fa-244">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="258fa-244">TCP/UDP</span></span> |<span data-ttu-id="258fa-245">Vyrovnávání zatížení Azure</span><span class="sxs-lookup"><span data-stu-id="258fa-245">Azure load balancing</span></span> | <span data-ttu-id="258fa-246">(Redis podsíť)</span><span class="sxs-lookup"><span data-stu-id="258fa-246">(Redis subnet)</span></span> |<span data-ttu-id="258fa-247">Nástroj pro vyrovnávání zatížení Azure</span><span class="sxs-lookup"><span data-stu-id="258fa-247">Azure Load Balancer</span></span> |
| <span data-ttu-id="258fa-248">20226</span><span class="sxs-lookup"><span data-stu-id="258fa-248">20226</span></span> |<span data-ttu-id="258fa-249">Příchozí</span><span class="sxs-lookup"><span data-stu-id="258fa-249">Inbound</span></span> |<span data-ttu-id="258fa-250">TCP</span><span class="sxs-lookup"><span data-stu-id="258fa-250">TCP</span></span> |<span data-ttu-id="258fa-251">Interní komunikaci pro Redis</span><span class="sxs-lookup"><span data-stu-id="258fa-251">Internal communications for Redis</span></span> | <span data-ttu-id="258fa-252">(Redis podsíť)</span><span class="sxs-lookup"><span data-stu-id="258fa-252">(Redis subnet)</span></span> |<span data-ttu-id="258fa-253">(Redis podsíť)</span><span class="sxs-lookup"><span data-stu-id="258fa-253">(Redis subnet)</span></span> |

### <a name="additional-vnet-network-connectivity-requirements"></a><span data-ttu-id="258fa-254">Další požadavky na připojení sítě VNET</span><span class="sxs-lookup"><span data-stu-id="258fa-254">Additional VNET network connectivity requirements</span></span>

<span data-ttu-id="258fa-255">Existují požadavky na síťové připojení pro Azure Redis Cache, nemusí být splněny původně ve virtuální síti.</span><span class="sxs-lookup"><span data-stu-id="258fa-255">There are network connectivity requirements for Azure Redis Cache that may not be initially met in a virtual network.</span></span> <span data-ttu-id="258fa-256">Azure Redis Cache vyžaduje že všechny hello následující položky toofunction správně, pokud se používá v rámci virtuální sítě.</span><span class="sxs-lookup"><span data-stu-id="258fa-256">Azure Redis Cache requires all hello following items toofunction properly when used within a virtual network.</span></span>

* <span data-ttu-id="258fa-257">Odchozí připojení tooAzure úložiště koncových bodů sítě po celém světě.</span><span class="sxs-lookup"><span data-stu-id="258fa-257">Outbound network connectivity tooAzure Storage endpoints worldwide.</span></span> <span data-ttu-id="258fa-258">To zahrnuje koncové body, které jsou umístěné v hello stejné oblasti jako hello instanci Azure Redis Cache, stejně jako koncové body úložiště, které jsou umístěné v **jiných** oblastech Azure.</span><span class="sxs-lookup"><span data-stu-id="258fa-258">This includes endpoints located in hello same region as hello Azure Redis Cache instance, as well as storage endpoints located in **other** Azure regions.</span></span> <span data-ttu-id="258fa-259">Koncové body Azure úložiště vyřešit v rámci hello následující domény DNS: *table.core.windows.net*, *blob.core.windows.net*, *queue.core.windows.net*a *file.core.windows.net*.</span><span class="sxs-lookup"><span data-stu-id="258fa-259">Azure Storage endpoints resolve under hello following DNS domains: *table.core.windows.net*, *blob.core.windows.net*, *queue.core.windows.net*, and *file.core.windows.net*.</span></span> 
* <span data-ttu-id="258fa-260">Odchozí připojení k síti příliš*ocsp.msocsp.com*, *mscrl.microsoft.com*, a *crl.microsoft.com*. Toto připojení je potřebné toosupport SSL funkce.</span><span class="sxs-lookup"><span data-stu-id="258fa-260">Outbound network connectivity too*ocsp.msocsp.com*, *mscrl.microsoft.com*, and *crl.microsoft.com*. This connectivity is needed toosupport SSL functionality.</span></span>
* <span data-ttu-id="258fa-261">Hello konfiguraci DNS pro virtuální síť hello musí být schopen překladu hello koncové body a domény uvedený v hello starší body.</span><span class="sxs-lookup"><span data-stu-id="258fa-261">hello DNS configuration for hello virtual network must be capable of resolving all of hello endpoints and domains mentioned in hello earlier points.</span></span> <span data-ttu-id="258fa-262">Zajištěním platný infrastruktura DNS je nakonfigurován a udržovat hello virtuální sítě můžete splnit tyto požadavky na DNS.</span><span class="sxs-lookup"><span data-stu-id="258fa-262">These DNS requirements can be met by ensuring a valid DNS infrastructure is configured and maintained for hello virtual network.</span></span>
* <span data-ttu-id="258fa-263">Odchozí síťové připojení toohello následující Azure Monitoring koncových bodů, které řešení v části hello následující domény DNS: shoebox2 black.shoebox2.metrics.nsatc.net, severní prod2.prod2.metrics.nsatc.net azglobal-black.azglobal.metrics.nsatc.net, shoebox2-red.shoebox2.metrics.nsatc.net prod2.prod2.metrics.nsatc.net – východ, azglobal-red.azglobal.metrics.nsatc.net.</span><span class="sxs-lookup"><span data-stu-id="258fa-263">Outbound network connectivity toohello following Azure Monitoring endpoints, which resolve under hello following DNS domains: shoebox2-black.shoebox2.metrics.nsatc.net, north-prod2.prod2.metrics.nsatc.net, azglobal-black.azglobal.metrics.nsatc.net, shoebox2-red.shoebox2.metrics.nsatc.net, east-prod2.prod2.metrics.nsatc.net, azglobal-red.azglobal.metrics.nsatc.net.</span></span>

### <a name="how-can-i-verify-that-my-cache-is-working-in-a-vnet"></a><span data-ttu-id="258fa-264">Jak můžete ověřit, že moje mezipaměti funguje ve virtuální síti?</span><span class="sxs-lookup"><span data-stu-id="258fa-264">How can I verify that my cache is working in a VNET?</span></span>

>[!IMPORTANT]
><span data-ttu-id="258fa-265">Při připojování tooan instanci Azure Redis Cache, který je hostován ve virtuální síti, hello mezipaměti, které klienti musí být ve stejné virtuální síti, včetně všech testovací aplikace a diagnostické nástroje příkaz ping.</span><span class="sxs-lookup"><span data-stu-id="258fa-265">When connecting tooan Azure Redis Cache instance that is hosted in a VNET, your cache clients must be in hello same VNET, including any test applications or diagnostic pinging tools.</span></span>
>
>

<span data-ttu-id="258fa-266">Po nakonfigurování hello port požadavky popsané v předchozí části hello můžete ověřit, že mezipaměť funguje tak, že provedete následující kroky hello.</span><span class="sxs-lookup"><span data-stu-id="258fa-266">Once hello port requirements are configured as described in hello previous section, you can verify that your cache is working by performing hello following steps.</span></span>

- <span data-ttu-id="258fa-267">[Restartovat](cache-administration.md#reboot) všechny hello mezipaměti uzly.</span><span class="sxs-lookup"><span data-stu-id="258fa-267">[Reboot](cache-administration.md#reboot) all of hello cache nodes.</span></span> <span data-ttu-id="258fa-268">Podle potřeby všechny hello závislosti mezipaměti, není dosažitelná (jak je uvedeno v [příchozí požadavky na porty](cache-how-to-premium-vnet.md#inbound-port-requirements) a [odchozí port požadavky](cache-how-to-premium-vnet.md#outbound-port-requirements)), hello mezipaměť nebude možné toorestart úspěšně.</span><span class="sxs-lookup"><span data-stu-id="258fa-268">If all of hello required cache dependencies can't be reached (as documented in [Inbound port requirements](cache-how-to-premium-vnet.md#inbound-port-requirements) and [Outbound port requirements](cache-how-to-premium-vnet.md#outbound-port-requirements)), hello cache won't be able toorestart successfully.</span></span>
- <span data-ttu-id="258fa-269">Po restartování uzly mezipaměti hello (vykazované hello mezipaměti stav v hello portál Azure), můžete provést hello následující testy:</span><span class="sxs-lookup"><span data-stu-id="258fa-269">Once hello cache nodes have restarted (as reported by hello cache status in hello Azure portal), you can perform hello following tests:</span></span>
  - <span data-ttu-id="258fa-270">příkaz ping hello koncový bod mezipaměti (pomocí portu 6380) z počítače, který je v rámci hello stejnou virtuální síť jako hello mezipaměti, pomocí [tcping](https://www.elifulkerson.com/projects/tcping.php).</span><span class="sxs-lookup"><span data-stu-id="258fa-270">ping hello cache endpoint (using port 6380) from a machine that is within hello same VNET as hello cache, using [tcping](https://www.elifulkerson.com/projects/tcping.php).</span></span> <span data-ttu-id="258fa-271">Například:</span><span class="sxs-lookup"><span data-stu-id="258fa-271">For example:</span></span>
    
    `tcping.exe contosocache.redis.cache.windows.net 6380`
    
    <span data-ttu-id="258fa-272">Pokud hello `tcping` nástroj hlásí, že je otevřený hello port, hello mezipaměti je k dispozici pro připojení z klientů ve hello virtuální sítě.</span><span class="sxs-lookup"><span data-stu-id="258fa-272">If hello `tcping` tool reports that hello port is open, hello cache is available for connection from clients in hello VNET.</span></span>

  - <span data-ttu-id="258fa-273">Tootest jiný způsob, jak je toocreate testovacího mezipaměti klienta (které by mohly být jednoduchou konzolovou aplikaci pomocí StackExchange.Redis), připojuje toohello mezipaměti a přidá a načte některé položky z mezipaměti hello.</span><span class="sxs-lookup"><span data-stu-id="258fa-273">Another way tootest is toocreate a test cache client (which could be a simple console application using StackExchange.Redis) that connects toohello cache and adds and retrieves some items from hello cache.</span></span> <span data-ttu-id="258fa-274">Nainstalujte hello vzorku klientskou aplikaci na virtuální počítač, který je v hello stejnou virtuální síť jako hello mezipaměti a potom ho spusťte tooverify připojení toohello mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="258fa-274">Install hello sample client application onto a VM that is in hello same VNET as hello cache and run it tooverify connectivity toohello cache.</span></span>


### <a name="can-i-use-vnets-with-a-standard-or-basic-cache"></a><span data-ttu-id="258fa-275">Můžete použít virtuální sítě s standardní nebo základní mezipaměti?</span><span class="sxs-lookup"><span data-stu-id="258fa-275">Can I use VNets with a standard or basic cache?</span></span>
<span data-ttu-id="258fa-276">Virtuální sítě můžete použít pouze u prémiových mezipamětí.</span><span class="sxs-lookup"><span data-stu-id="258fa-276">VNets can only be used with premium caches.</span></span>

### <a name="why-does-creating-a-redis-cache-fail-in-some-subnets-but-not-others"></a><span data-ttu-id="258fa-277">Proč vytvoření mezipaměti Redis selhání v některé podsítě a jiné ne?</span><span class="sxs-lookup"><span data-stu-id="258fa-277">Why does creating a Redis cache fail in some subnets but not others?</span></span>
<span data-ttu-id="258fa-278">Pokud provádíte nasazení Azure Redis Cache tooa virtuální sítě Resource Manageru, hello mezipaměti musí být ve vyhrazené podsíť, která obsahuje jiný typ prostředku.</span><span class="sxs-lookup"><span data-stu-id="258fa-278">If you are deploying an Azure Redis Cache tooa Resource Manager VNet, hello cache must be in a dedicated subnet that contains no other resource type.</span></span> <span data-ttu-id="258fa-279">Pokud je proveden pokus o toodeploy Azure Redis Cache tooa podsíť virtuální sítě Resource Manageru, který obsahuje jiné prostředky, hello nasazení se nezdaří.</span><span class="sxs-lookup"><span data-stu-id="258fa-279">If an attempt is made toodeploy an Azure Redis Cache tooa Resource Manager VNet subnet that contains other resources, hello deployment fails.</span></span> <span data-ttu-id="258fa-280">Před vytvořením nové mezipaměti Redis, je nutné odstranit existující prostředky hello uvnitř hello podsítě.</span><span class="sxs-lookup"><span data-stu-id="258fa-280">You must delete hello existing resources inside hello subnet before you can create a new Redis cache.</span></span>

<span data-ttu-id="258fa-281">Můžete nasadit více typů z prostředků tooa klasické virtuální síti, dokud máte dost IP adres k dispozici.</span><span class="sxs-lookup"><span data-stu-id="258fa-281">You can deploy multiple types of resources tooa classic VNet as long as you have enough IP addresses available.</span></span>

### <a name="what-are-hello-subnet-address-space-requirements"></a><span data-ttu-id="258fa-282">Jaké jsou požadavky na místo na hello podsíť adres?</span><span class="sxs-lookup"><span data-stu-id="258fa-282">What are hello subnet address space requirements?</span></span>
<span data-ttu-id="258fa-283">Azure si vyhrazuje některé IP adresy v rámci každé podsítě a tyto adresy nelze použít.</span><span class="sxs-lookup"><span data-stu-id="258fa-283">Azure reserves some IP addresses within each subnet, and these addresses can't be used.</span></span> <span data-ttu-id="258fa-284">Hello první a poslední IP adres podsítě hello jsou vyhrazené pro protokol shoda, společně s tři další adresy používané pro služby Azure.</span><span class="sxs-lookup"><span data-stu-id="258fa-284">hello first and last IP addresses of hello subnets are reserved for protocol conformance, along with three more addresses used for Azure services.</span></span> <span data-ttu-id="258fa-285">Další informace najdete v tématu [existují nějaká omezení na pomocí IP adresy v rámci těchto podsítí?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span><span class="sxs-lookup"><span data-stu-id="258fa-285">For more information, see [Are there any restrictions on using IP addresses within these subnets?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span></span>

<span data-ttu-id="258fa-286">Přidání toohello IP adresy používané hello infrastruktury virtuální sítě Azure každý Redis instance v hello podsíť používá dvě IP adresy na horizontální oddíl a jednu IP adresu další nástroje pro vyrovnávání zatížení hello.</span><span class="sxs-lookup"><span data-stu-id="258fa-286">In addition toohello IP addresses used by hello Azure VNET infrastructure, each Redis instance in hello subnet uses two IP addresses per shard and one additional IP address for hello load balancer.</span></span> <span data-ttu-id="258fa-287">Mezipaměť vypojené z clusteru se považuje za jeden horizontálního oddílu toohave.</span><span class="sxs-lookup"><span data-stu-id="258fa-287">A non-clustered cache is considered toohave one shard.</span></span>

### <a name="do-all-cache-features-work-when-hosting-a-cache-in-a-vnet"></a><span data-ttu-id="258fa-288">Fungují všechny funkce mezipaměti při hostování mezipaměti ve virtuální síti?</span><span class="sxs-lookup"><span data-stu-id="258fa-288">Do all cache features work when hosting a cache in a VNET?</span></span>
<span data-ttu-id="258fa-289">Pokud vaše mezipaměť je součástí virtuální sítě, můžete přístup jenom pro klienty v hello virtuální síť hello mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="258fa-289">When your cache is part of a VNET, only clients in hello VNET can access hello cache.</span></span> <span data-ttu-id="258fa-290">V důsledku toho hello následující funkce správy mezipaměti nefungují v tuto chvíli.</span><span class="sxs-lookup"><span data-stu-id="258fa-290">As a result, hello following cache management features don't work at this time.</span></span>

* <span data-ttu-id="258fa-291">Konzola redis – vzhledem k tomu konzola Redis běží v prohlížeči místní, což je mimo hello virtuální sítě, se nemůže připojit tooyour mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="258fa-291">Redis Console - Because Redis Console runs in your local browser, which is outside hello VNET, it can't connect tooyour cache.</span></span>

## <a name="use-expressroute-with-azure-redis-cache"></a><span data-ttu-id="258fa-292">Pomocí ExpressRoute s Azure Redis Cache</span><span class="sxs-lookup"><span data-stu-id="258fa-292">Use ExpressRoute with Azure Redis Cache</span></span>
<span data-ttu-id="258fa-293">Zákazníci mohou připojit [Azure ExpressRoute](https://azure.microsoft.com/services/expressroute/) okruhu tootheir virtuální síťové infrastruktury, tak rozšířit jejich místní sítě tooAzure.</span><span class="sxs-lookup"><span data-stu-id="258fa-293">Customers can connect an [Azure ExpressRoute](https://azure.microsoft.com/services/expressroute/) circuit tootheir virtual network infrastructure, thus extending their on-premises network tooAzure.</span></span> 

<span data-ttu-id="258fa-294">Ve výchozím nastavení, nově vytvořený okruh ExpressRoute neprovádí vynucené tunelování (inzerování výchozí trasy, 0.0.0.0/0) na virtuální síť.</span><span class="sxs-lookup"><span data-stu-id="258fa-294">By default, a newly created ExpressRoute circuit does not perform forced tunneling (advertisement of a default route, 0.0.0.0/0) on a VNET.</span></span> <span data-ttu-id="258fa-295">V důsledku toho odchozí připojení k Internetu je povoleno přímo ze hello virtuální sítě a klientských aplikací jsou možné tooconnect tooother Azure včetně Azure Redis Cache koncové body.</span><span class="sxs-lookup"><span data-stu-id="258fa-295">As a result, outbound Internet connectivity is allowed directly from hello VNET and client applications are able tooconnect tooother Azure endpoints including Azure Redis Cache.</span></span>

<span data-ttu-id="258fa-296">Obvyklé konfigurace zákazníka je ale toouse vynuceného tunelování (Inzerovat výchozí trasu) který vynutí odchozí internetové přenosy tooinstead toku místně.</span><span class="sxs-lookup"><span data-stu-id="258fa-296">However a common customer configuration is toouse forced tunneling (advertise a default route) which forces outbound Internet traffic tooinstead flow on-premises.</span></span> <span data-ttu-id="258fa-297">Tento tok provozu rozdělí připojení s Azure Redis Cache, pokud je odchozí přenosy hello potom blokovaný místně, tak, aby hello instanci Azure Redis Cache není možné toocommunicate s jeho závislé součásti.</span><span class="sxs-lookup"><span data-stu-id="258fa-297">This traffic flow breaks connectivity with Azure Redis Cache if hello outbound traffic is then blocked on-premises such that hello Azure Redis Cache instance is not able toocommunicate with its dependencies.</span></span>

<span data-ttu-id="258fa-298">řešení Hello je toodefine jeden (nebo více) trasy definované uživatelem (udr) v podsíti hello, který obsahuje hello Azure Redis Cache.</span><span class="sxs-lookup"><span data-stu-id="258fa-298">hello solution is toodefine one (or more) user-defined routes (UDRs) on hello subnet that contains hello Azure Redis Cache.</span></span> <span data-ttu-id="258fa-299">UDR definuje tras konkrétní podsítě, které bude dodržení místo hello výchozí trasu.</span><span class="sxs-lookup"><span data-stu-id="258fa-299">A UDR defines subnet-specific routes that will be honored instead of hello default route.</span></span>

<span data-ttu-id="258fa-300">Pokud je to možné doporučujeme toouse hello následující konfigurace:</span><span class="sxs-lookup"><span data-stu-id="258fa-300">If possible, it is recommended toouse hello following configuration:</span></span>

* <span data-ttu-id="258fa-301">Konfigurace ExpressRoute Hello inzeruje 0.0.0.0/0 a ve výchozím nastavení vynucené tunelových propojení všechny odchozí přenosy na místě.</span><span class="sxs-lookup"><span data-stu-id="258fa-301">hello ExpressRoute configuration advertises 0.0.0.0/0 and by default force tunnels all outbound traffic on-premises.</span></span>
* <span data-ttu-id="258fa-302">Hello UDR použít toohello podsíť obsahující hello Azure Redis Cache definuje 0.0.0.0/0 s pracovní postup pro toohello provoz protokolu TCP/IP veřejného Internetu; například podle nastavení hello dalšího směrování too'Internet typu '.</span><span class="sxs-lookup"><span data-stu-id="258fa-302">hello UDR applied toohello subnet containing hello Azure Redis Cache defines 0.0.0.0/0 with a working route for TCP/IP traffic toohello public internet; for example by setting hello next hop type too'Internet'.</span></span>

<span data-ttu-id="258fa-303">Hello celkové požadavky tyto kroky je úrovni podsítě hello UDR má přednost před hello ExpressRoute vynuceného tunelování, čímž zajišťuje odchozí přístup k Internetu z hello Azure Redis Cache.</span><span class="sxs-lookup"><span data-stu-id="258fa-303">hello combined effect of these steps is that hello subnet level UDR takes precedence over hello ExpressRoute forced tunneling, thus ensuring outbound Internet access from hello Azure Redis Cache.</span></span>

<span data-ttu-id="258fa-304">Připojování tooan Azure Redis Cache instance z místní aplikace pomocí služby ExpressRoute není scénáři typické použití kvůli tooperformance důvodů (pro nejlepší výkon Azure Redis Cache musí být klienti ve hello stejné oblasti jako hello Azure Redis Cache).</span><span class="sxs-lookup"><span data-stu-id="258fa-304">Connecting tooan Azure Redis Cache instance from an on-premises application using ExpressRoute is not a typical usage scenario due tooperformance reasons (for best performance Azure Redis Cache clients should be in hello same region as hello Azure Redis Cache).</span></span>

>[!IMPORTANT] 
><span data-ttu-id="258fa-305">Hello trasy definované v UDR **musí** být dost konkrétní tootake přednost přes všechny trasy inzerované konfigurace ExpressRoute hello.</span><span class="sxs-lookup"><span data-stu-id="258fa-305">hello routes defined in a UDR **must** be specific enough tootake precedence over any routes advertised by hello ExpressRoute configuration.</span></span> <span data-ttu-id="258fa-306">Hello následující příklad používá rozsah adres široký 0.0.0.0/0 hello a jako takový se dá potenciálně omylem přepsat inzerování tras pomocí podrobnější rozsahy adres.</span><span class="sxs-lookup"><span data-stu-id="258fa-306">hello following example uses hello broad 0.0.0.0/0 address range, and as such can potentially be accidentally overridden by route advertisements using more specific address ranges.</span></span>

>[!WARNING]  
><span data-ttu-id="258fa-307">Azure Redis Cache není podporován s konfigurací ExpressRoute, **nesprávně Inzerovat trasy z hello cesty veřejného partnerského vztahu cesta toohello soukromého partnerského vztahu mezi**.</span><span class="sxs-lookup"><span data-stu-id="258fa-307">Azure Redis Cache is not supported with ExpressRoute configurations that **incorrectly cross-advertise routes from hello public peering path toohello private peering path**.</span></span> <span data-ttu-id="258fa-308">Konfigurace ExpressRoute, které mají veřejné partnerské vztahy nakonfigurované, obdrží inzerování trasy od společnosti Microsoft pro velké sady rozsahů adres Microsoft Azure IP.</span><span class="sxs-lookup"><span data-stu-id="258fa-308">ExpressRoute configurations that have public peering configured, receive route advertisements from Microsoft for a large set of Microsoft Azure IP address ranges.</span></span> <span data-ttu-id="258fa-309">Pokud tyto rozsahy adres nesprávně ohlášené mezi na hello cestou soukromého partnerského vztahu, hello výsledkem je, že jsou všechny odchozí síťových paketů z podsítě instanci Azure Redis Cache hello nesprávně tunelovým propojením force tooa zákazníka do místní sítě infrastruktura.</span><span class="sxs-lookup"><span data-stu-id="258fa-309">If these address ranges are incorrectly cross-advertised on hello private peering path, hello result is that all outbound network packets from hello Azure Redis Cache instance's subnet are incorrectly force-tunneled tooa customer's on-premises network infrastructure.</span></span> <span data-ttu-id="258fa-310">Tento tok sítě dělí Azure Redis Cache.</span><span class="sxs-lookup"><span data-stu-id="258fa-310">This network flow breaks Azure Redis Cache.</span></span> <span data-ttu-id="258fa-311">je ale problém toothis řešení Hello směrování mezi – reklamu toostop z hello cesty veřejného partnerského vztahu cesta toohello soukromého partnerského vztahu.</span><span class="sxs-lookup"><span data-stu-id="258fa-311">hello solution toothis problem is toostop cross-advertising routes from hello public peering path toohello private peering path.</span></span>


<span data-ttu-id="258fa-312">Základní informace o trasy definované uživatelem je k dispozici v tomto [přehled](../virtual-network/virtual-networks-udr-overview.md).</span><span class="sxs-lookup"><span data-stu-id="258fa-312">Background information on user-defined routes is available in this [overview](../virtual-network/virtual-networks-udr-overview.md).</span></span>

<span data-ttu-id="258fa-313">Další informace o ExpressRoute najdete v tématu [technický přehled ExpressRoute](../expressroute/expressroute-introduction.md).</span><span class="sxs-lookup"><span data-stu-id="258fa-313">For more information about ExpressRoute, see [ExpressRoute technical overview](../expressroute/expressroute-introduction.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="258fa-314">Další kroky</span><span class="sxs-lookup"><span data-stu-id="258fa-314">Next steps</span></span>
<span data-ttu-id="258fa-315">Zjistěte, jak toouse více premium mezipaměti funkce.</span><span class="sxs-lookup"><span data-stu-id="258fa-315">Learn how toouse more premium cache features.</span></span>

* [<span data-ttu-id="258fa-316">Úvod toohello Azure Redis Cache na úrovni Premium</span><span class="sxs-lookup"><span data-stu-id="258fa-316">Introduction toohello Azure Redis Cache Premium tier</span></span>](cache-premium-tier-intro.md)

<!-- IMAGES -->

[redis-cache-vnet]: ./media/cache-how-to-premium-vnet/redis-cache-vnet.png

[redis-cache-vnet-ip]: ./media/cache-how-to-premium-vnet/redis-cache-vnet-ip.png

[redis-cache-vnet-info]: ./media/cache-how-to-premium-vnet/redis-cache-vnet-info.png

