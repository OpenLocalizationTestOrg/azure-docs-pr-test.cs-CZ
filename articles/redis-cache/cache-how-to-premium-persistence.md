---
title: "Postup konfigurace trvalosti dat pro mezipaměť Azure Redis Cache Premium"
description: "Zjistěte, jak konfigurovat a spravovat vaše instance Azure Redis Cache Premium vrstvu trvalosti dat"
services: redis-cache
documentationcenter: 
author: steved0x
manager: douge
editor: 
ms.assetid: b01cf279-60a0-4711-8c5f-af22d9540d38
ms.service: cache
ms.workload: tbd
ms.tgt_pltfrm: cache-redis
ms.devlang: na
ms.topic: article
ms.date: 08/24/2017
ms.author: sdanie
ms.openlocfilehash: 638f0154d3a4fd091197a2da86374a053b31c4c0
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/29/2017
---
# <a name="how-to-configure-data-persistence-for-a-premium-azure-redis-cache"></a><span data-ttu-id="4abf1-103">Postup konfigurace trvalosti dat pro mezipaměť Azure Redis Cache Premium</span><span class="sxs-lookup"><span data-stu-id="4abf1-103">How to configure data persistence for a Premium Azure Redis Cache</span></span>
<span data-ttu-id="4abf1-104">Azure Redis Cache má jiný mezipaměti nabídky, které poskytují flexibilitu při výběru velikost mezipaměti a funkce, včetně funkce úrovně Premium, jako je clustering, trvalosti a podpory služby virtual network.</span><span class="sxs-lookup"><span data-stu-id="4abf1-104">Azure Redis Cache has different cache offerings which provide flexibility in the choice of cache size and features, including Premium tier features such as clustering, persistence, and virtual network support.</span></span> <span data-ttu-id="4abf1-105">Tento článek popisuje postup konfigurace trvalosti v instanci služby Azure Redis Cache premium.</span><span class="sxs-lookup"><span data-stu-id="4abf1-105">This article describes how to configure persistence in a premium Azure Redis Cache instance.</span></span>

<span data-ttu-id="4abf1-106">Informace o dalších funkcí mezipaměti premium najdete v tématu [Úvod do Azure Redis Cache Premium vrstvy](cache-premium-tier-intro.md).</span><span class="sxs-lookup"><span data-stu-id="4abf1-106">For information on other premium cache features, see [Introduction to the Azure Redis Cache Premium tier](cache-premium-tier-intro.md).</span></span>

## <a name="what-is-data-persistence"></a><span data-ttu-id="4abf1-107">Co je trvalosti dat?</span><span class="sxs-lookup"><span data-stu-id="4abf1-107">What is data persistence?</span></span>
<span data-ttu-id="4abf1-108">[Trvalost redis](https://redis.io/topics/persistence) umožňuje zachovat data uložená v Redis.</span><span class="sxs-lookup"><span data-stu-id="4abf1-108">[Redis persistence](https://redis.io/topics/persistence) allows you to persist data stored in Redis.</span></span> <span data-ttu-id="4abf1-109">Můžete také pořizovat snímky a zálohovat data, která budete moct načíst v případě selhání hardwaru.</span><span class="sxs-lookup"><span data-stu-id="4abf1-109">You can also take snapshots and back up the data, which you can load in case of a hardware failure.</span></span> <span data-ttu-id="4abf1-110">Toto je obrovskou výhodu přes úroveň Basic nebo Standard kde všechna data jsou uloženy v paměti a může být potenciální ztrátě dat v případě selhání, kde jsou uzly mezipaměti dolů.</span><span class="sxs-lookup"><span data-stu-id="4abf1-110">This is a huge advantage over Basic or Standard tier where all the data is stored in memory and there can be potential data loss in case of a failure where Cache nodes are down.</span></span> 

<span data-ttu-id="4abf1-111">Azure Redis Cache nabízí trvalosti Redis pomocí těchto modelů:</span><span class="sxs-lookup"><span data-stu-id="4abf1-111">Azure Redis Cache offers Redis persistence using the following models:</span></span>

* <span data-ttu-id="4abf1-112">**Trvalost RDB** -trvalost při RDB (databáze Redis) je nakonfigurován, Azure Redis Cache potrvají snímek mezipaměti Redis v Redis binární formát disku podle konfigurovat četnost zálohování.</span><span class="sxs-lookup"><span data-stu-id="4abf1-112">**RDB persistence** - When RDB (Redis database) persistence is configured, Azure Redis Cache persists a snapshot of the Redis cache in a Redis binary format to disk based on a configurable backup frequency.</span></span> <span data-ttu-id="4abf1-113">Pokud dojde k závažné události, zakazující primární server a repliky mezipaměti, do mezipaměti je znovu vytvořena, pomocí poslední snímek.</span><span class="sxs-lookup"><span data-stu-id="4abf1-113">If a catastrophic event occurs that disables both the primary and replica cache, the cache is reconstructed using the most recent snapshot.</span></span> <span data-ttu-id="4abf1-114">Další informace o [výhody](https://redis.io/topics/persistence#rdb-advantages) a [nevýhody](https://redis.io/topics/persistence#rdb-disadvantages) z trvalost RDB.</span><span class="sxs-lookup"><span data-stu-id="4abf1-114">Learn more about the [advantages](https://redis.io/topics/persistence#rdb-advantages) and [disadvantages](https://redis.io/topics/persistence#rdb-disadvantages) of RDB persistence.</span></span>
* <span data-ttu-id="4abf1-115">**Trvalost AOF** -trvalost při AOF (pouze připojit soubor) je nakonfigurován, Azure Redis Cache uloží každé operace zápisu do protokolu, který je uložený aspoň jednou za sekundu do účtu Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="4abf1-115">**AOF persistence** - When AOF (Append only file) persistence is configured, Azure Redis Cache saves every write operation to a log that is saved at least once per second into an Azure Storage account.</span></span> <span data-ttu-id="4abf1-116">Pokud dojde k závažné události, zakazující primární server a repliky mezipaměti, do mezipaměti je znovu vytvořena, pomocí operace uložené zápisu.</span><span class="sxs-lookup"><span data-stu-id="4abf1-116">If a catastrophic event occurs that disables both the primary and replica cache, the cache is reconstructed using the stored write operations.</span></span> <span data-ttu-id="4abf1-117">Další informace o [výhody](https://redis.io/topics/persistence#aof-advantages) a [nevýhody](https://redis.io/topics/persistence#aof-disadvantages) z AOF trvalost.</span><span class="sxs-lookup"><span data-stu-id="4abf1-117">Learn more about the [advantages](https://redis.io/topics/persistence#aof-advantages) and [disadvantages](https://redis.io/topics/persistence#aof-disadvantages) of AOF persistence.</span></span>

<span data-ttu-id="4abf1-118">Trvalost je nakonfigurovaný z **nová mezipaměť Redis** okno při vytvoření mezipaměti a na **prostředků nabídky** existující premium ukládá do mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="4abf1-118">Persistence is configured from the **New Redis Cache** blade during cache creation and on the **Resource menu** for existing premium caches.</span></span>

[!INCLUDE [redis-cache-create](../../includes/redis-cache-premium-create.md)]

<span data-ttu-id="4abf1-119">Jakmile je vybraná cenová úroveň premium, klikněte na možnost **trvalosti Redis**.</span><span class="sxs-lookup"><span data-stu-id="4abf1-119">Once a premium pricing tier is selected, click **Redis persistence**.</span></span>

![Trvalost redis][redis-cache-persistence]

<span data-ttu-id="4abf1-121">Kroky v následující části popisují postup konfigurace trvalosti Redis na nové mezipaměti premium.</span><span class="sxs-lookup"><span data-stu-id="4abf1-121">The steps in the next section describe how to configure Redis persistence on your new premium cache.</span></span> <span data-ttu-id="4abf1-122">Po nakonfigurování trvalosti Redis klikněte na tlačítko **vytvořit** k vytvoření nové mezipaměti premium s trvalosti Redis.</span><span class="sxs-lookup"><span data-stu-id="4abf1-122">Once Redis persistence is configured, click **Create** to create your new premium cache with Redis persistence.</span></span>

## <a name="enable-redis-persistence"></a><span data-ttu-id="4abf1-123">Povolit trvalost Redis</span><span class="sxs-lookup"><span data-stu-id="4abf1-123">Enable Redis persistence</span></span>

<span data-ttu-id="4abf1-124">Redis je povolena trvalost na **trvalosti dat Redis** okna tak, že buď zvolíte **RDB** nebo **AOF** trvalost.</span><span class="sxs-lookup"><span data-stu-id="4abf1-124">Redis persistence is enabled on the **Redis data persistence** blade by choosing either **RDB** or **AOF** persistence.</span></span> <span data-ttu-id="4abf1-125">U nových mezipamětí toto okno přistupuje během procesu vytváření mezipaměti, jak je popsáno v předchozí části.</span><span class="sxs-lookup"><span data-stu-id="4abf1-125">For new caches, this blade is accessed during the cache creation process, as described in the previous section.</span></span> <span data-ttu-id="4abf1-126">Pro existující mezipamětí **trvalosti dat Redis** okno je k němu přistupovat z **prostředků nabídky** ke svojí mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="4abf1-126">For existing caches, the **Redis data persistence** blade is accessed from the **Resource menu** for your cache.</span></span>

![Nastavení redis][redis-cache-settings]


## <a name="configure-rdb-persistence"></a><span data-ttu-id="4abf1-128">Konfigurace trvalosti RDB</span><span class="sxs-lookup"><span data-stu-id="4abf1-128">Configure RDB persistence</span></span>

<span data-ttu-id="4abf1-129">Chcete-li zapnout stálost RDB, klikněte na tlačítko **RDB**.</span><span class="sxs-lookup"><span data-stu-id="4abf1-129">To enable RDB persistence, click **RDB**.</span></span> <span data-ttu-id="4abf1-130">Chcete-li zakázat trvalost RDB na dříve povoleno premium mezipaměti, klikněte na tlačítko **zakázané**.</span><span class="sxs-lookup"><span data-stu-id="4abf1-130">To disable RDB persistence on a previously enabled premium cache, click **Disabled**.</span></span>

![RDB trvalosti redis][redis-cache-rdb-persistence]

<span data-ttu-id="4abf1-132">Pokud chcete nakonfigurovat interval zálohování, vyberte **četnost zálohování** z rozevíracího seznamu.</span><span class="sxs-lookup"><span data-stu-id="4abf1-132">To configure the backup interval, select a **Backup Frequency** from the drop-down list.</span></span> <span data-ttu-id="4abf1-133">Vybrat možnost **15 minut**, **30 minut**, **60 minut**, **6 hodin**, **12 hodin**a **24 hodin**.</span><span class="sxs-lookup"><span data-stu-id="4abf1-133">Choices include **15 Minutes**, **30 minutes**, **60 minutes**, **6 hours**, **12 hours**, and **24 hours**.</span></span> <span data-ttu-id="4abf1-134">Tento interval spustí počítání po úspěšném dokončení předchozí operace zálohování a po jeho uplynutí se zahájí novou zálohu.</span><span class="sxs-lookup"><span data-stu-id="4abf1-134">This interval starts counting down after the previous backup operation successfully completes and when it elapses a new backup is initiated.</span></span>

<span data-ttu-id="4abf1-135">Klikněte na tlačítko **účet úložiště** a vyberte účet úložiště, který chcete použít a vyberte buď **primární klíč** nebo **sekundární klíč** z **klíč úložiště** rozevíracího seznamu.</span><span class="sxs-lookup"><span data-stu-id="4abf1-135">Click **Storage Account** to select the storage account to use, and choose either the **Primary key** or **Secondary key** to use from the **Storage Key** drop-down.</span></span> <span data-ttu-id="4abf1-136">Musíte zvolit účet úložiště ve stejné oblasti jako do mezipaměti a **Storage úrovně Premium** účet je doporučená, protože úložiště premium je vyšší propustnost.</span><span class="sxs-lookup"><span data-stu-id="4abf1-136">You must choose a storage account in the same region as the cache, and a **Premium Storage** account is recommended because premium storage has higher throughput.</span></span> 

> [!IMPORTANT]
> <span data-ttu-id="4abf1-137">Pokud se znovu vygeneruje klíč úložiště pro váš účet trvalost, je nutné překonfigurovat požadovaný klíč **klíč úložiště** rozevíracího seznamu.</span><span class="sxs-lookup"><span data-stu-id="4abf1-137">If the storage key for your persistence account is regenerated, you must reconfigure the desired key from the **Storage Key** drop-down.</span></span>
> 
> 

<span data-ttu-id="4abf1-138">Klikněte na tlačítko **OK** trvalost konfiguraci uložíte.</span><span class="sxs-lookup"><span data-stu-id="4abf1-138">Click **OK** to save the persistence configuration.</span></span>

<span data-ttu-id="4abf1-139">Další zálohování (nebo první zálohy u nových mezipamětí) je zahájena po uplynutí intervalu četnost zálohování.</span><span class="sxs-lookup"><span data-stu-id="4abf1-139">The next backup (or first backup for new caches) is initiated once the backup frequency interval elapses.</span></span>

## <a name="configure-aof-persistence"></a><span data-ttu-id="4abf1-140">Konfigurace trvalosti AOF</span><span class="sxs-lookup"><span data-stu-id="4abf1-140">Configure AOF persistence</span></span>

<span data-ttu-id="4abf1-141">Chcete-li zapnout stálost AOF, klikněte na tlačítko **AOF**.</span><span class="sxs-lookup"><span data-stu-id="4abf1-141">To enable AOF persistence, click **AOF**.</span></span> <span data-ttu-id="4abf1-142">Chcete-li zakázat trvalost AOF na dříve povoleno premium mezipaměti, klikněte na tlačítko **zakázané**.</span><span class="sxs-lookup"><span data-stu-id="4abf1-142">To disable AOF persistence on a previously enabled premium cache, click **Disabled**.</span></span>

![AOF trvalosti redis][redis-cache-aof-persistence]

<span data-ttu-id="4abf1-144">Konfigurace trvalosti AOF, zadejte **první účet úložiště**.</span><span class="sxs-lookup"><span data-stu-id="4abf1-144">To configure AOF persistence, specify a **First Storage Account**.</span></span> <span data-ttu-id="4abf1-145">Tento účet úložiště musí být ve stejné oblasti jako do mezipaměti a **Storage úrovně Premium** účet je doporučená, protože úložiště premium je vyšší propustnost.</span><span class="sxs-lookup"><span data-stu-id="4abf1-145">This storage account must be in the same region as the cache, and a **Premium Storage** account is recommended because premium storage has higher throughput.</span></span> <span data-ttu-id="4abf1-146">Volitelně můžete nakonfigurovat účet úložiště s názvem **druhého účtu úložiště**.</span><span class="sxs-lookup"><span data-stu-id="4abf1-146">You can optionally configure an additional storage account named **Second Storage Account**.</span></span> <span data-ttu-id="4abf1-147">Pokud je nakonfigurovaný druhý účet úložiště, zapíšou se do této druhé účet úložiště zápisy do mezipaměti repliky.</span><span class="sxs-lookup"><span data-stu-id="4abf1-147">If a second storage account is configured, the writes to the replica cache are written to this second storage account.</span></span> <span data-ttu-id="4abf1-148">Pro každý účet úložiště zvolit buď **primární klíč** nebo **sekundární klíč** z **klíč úložiště** rozevíracího seznamu.</span><span class="sxs-lookup"><span data-stu-id="4abf1-148">For each configured storage account, choose either the **Primary key** or **Secondary key** to use from the **Storage Key** drop-down.</span></span> 

> [!IMPORTANT]
> <span data-ttu-id="4abf1-149">Pokud se znovu vygeneruje klíč úložiště pro váš účet trvalost, je nutné překonfigurovat požadovaný klíč **klíč úložiště** rozevíracího seznamu.</span><span class="sxs-lookup"><span data-stu-id="4abf1-149">If the storage key for your persistence account is regenerated, you must reconfigure the desired key from the **Storage Key** drop-down.</span></span>
> 
> 

<span data-ttu-id="4abf1-150">Když je povolena trvalost AOF, zápisu operace do mezipaměti se uloží do účtu úložiště určený (nebo účty, pokud jste nakonfigurovali druhého účtu úložiště).</span><span class="sxs-lookup"><span data-stu-id="4abf1-150">When AOF persistence is enabled, write operations to the cache are saved to the designated storage account (or accounts if you have configured a second storage account).</span></span> <span data-ttu-id="4abf1-151">V případě selhání závažné, která přebírá dolů primární server a repliky mezipaměť protokol uložené AOF slouží k opětovné sestavení mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="4abf1-151">In the event of a catastrophic failure that takes down both the primary and replica cache, the stored AOF log is used to rebuild the cache.</span></span>

## <a name="persistence-faq"></a><span data-ttu-id="4abf1-152">Trvalost – nejčastější dotazy</span><span class="sxs-lookup"><span data-stu-id="4abf1-152">Persistence FAQ</span></span>
<span data-ttu-id="4abf1-153">Následující seznam obsahuje odpovědi na nejčastější dotazy týkající se Azure Redis Cache trvalost.</span><span class="sxs-lookup"><span data-stu-id="4abf1-153">The following list contains answers to commonly asked questions about Azure Redis Cache persistence.</span></span>

* [<span data-ttu-id="4abf1-154">Můžete povolit trvalost na dříve vytvořenou mezipaměti?</span><span class="sxs-lookup"><span data-stu-id="4abf1-154">Can I enable persistence on a previously created cache?</span></span>](#can-i-enable-persistence-on-a-previously-created-cache)
* [<span data-ttu-id="4abf1-155">Můžete povolit trvalost AOF a RDB současně?</span><span class="sxs-lookup"><span data-stu-id="4abf1-155">Can I enable AOF and RDB persistence at the same time?</span></span>](#can-i-enable-aof-and-rdb-persistence-at-the-same-time)
* [<span data-ttu-id="4abf1-156">Zvolte trvalost modelu</span><span class="sxs-lookup"><span data-stu-id="4abf1-156">Which persistence model should I choose?</span></span>](#which-persistence-model-should-i-choose)
* [<span data-ttu-id="4abf1-157">Co se stane, pokud mají I škálovat na jinou velikost a je obnovit zálohu, která byla vytvořená před provedením operace škálování?</span><span class="sxs-lookup"><span data-stu-id="4abf1-157">What happens if I have scaled to a different size and a backup is restored that was made before the scaling operation?</span></span>](#what-happens-if-i-have-scaled-to-a-different-size-and-a-backup-is-restored-that-was-made-before-the-scaling-operation)


### <a name="rdb-persistence"></a><span data-ttu-id="4abf1-158">Trvalost RDB</span><span class="sxs-lookup"><span data-stu-id="4abf1-158">RDB persistence</span></span>
* [<span data-ttu-id="4abf1-159">Můžete změnit po vytvoření mezipaměti je četnost záloh RDB?</span><span class="sxs-lookup"><span data-stu-id="4abf1-159">Can I change the RDB backup frequency after I create the cache?</span></span>](#can-i-change-the-rdb-backup-frequency-after-i-create-the-cache)
* [<span data-ttu-id="4abf1-160">Proč Pokud četnost zálohování v RDB 60 minut je víc než 60 minut mezi zálohování?</span><span class="sxs-lookup"><span data-stu-id="4abf1-160">Why if I have an RDB backup frequency of 60 minutes there is more than 60 minutes between backups?</span></span>](#why-if-i-have-an-rdb-backup-frequency-of-60-minutes-there-is-more-than-60-minutes-between-backups)
* [<span data-ttu-id="4abf1-161">Co se stane starší zálohy RDB, když je proveden novou zálohu?</span><span class="sxs-lookup"><span data-stu-id="4abf1-161">What happens to the old RDB backups when a new backup is made?</span></span>](#what-happens-to-the-old-rdb-backups-when-a-new-backup-is-made)

### <a name="aof-persistence"></a><span data-ttu-id="4abf1-162">Trvalost AOF</span><span class="sxs-lookup"><span data-stu-id="4abf1-162">AOF persistence</span></span>
* [<span data-ttu-id="4abf1-163">Kdy je vhodné použít druhého účtu úložiště?</span><span class="sxs-lookup"><span data-stu-id="4abf1-163">When should I use a second storage account?</span></span>](#when-should-i-use-a-second-storage-account)
* [<span data-ttu-id="4abf1-164">Nemá vliv trvalost AOF v celé, latenci nebo výkonu Moje mezipaměti?</span><span class="sxs-lookup"><span data-stu-id="4abf1-164">Does AOF persistence affect throughout, latency, or performance of my cache?</span></span>](#does-aof-persistence-affect-throughout-latency-or-performance-of-my-cache)
* [<span data-ttu-id="4abf1-165">Jak můžete odebrat druhého účtu úložiště?</span><span class="sxs-lookup"><span data-stu-id="4abf1-165">How can I remove the second storage account?</span></span>](#how-can-i-remove-the-second-storage-account)
* [<span data-ttu-id="4abf1-166">Co je přepisování a jak se týká Moje mezipaměti?</span><span class="sxs-lookup"><span data-stu-id="4abf1-166">What is a rewrite and how does it affect my cache?</span></span>](#what-is-a-rewrite-and-how-does-it-affect-my-cache)
* [<span data-ttu-id="4abf1-167">Co lze očekávat při škálování mezipaměť s AOF povolené?</span><span class="sxs-lookup"><span data-stu-id="4abf1-167">What should I expect when scaling a cache with AOF enabled?</span></span>](#what-should-i-expect-when-scaling-a-cache-with-aof-enabled)
* [<span data-ttu-id="4abf1-168">Uspořádání AOF data v úložišti</span><span class="sxs-lookup"><span data-stu-id="4abf1-168">How is my AOF data organized in storage?</span></span>](#how-is-my-aof-data-organized-in-storage)


### <a name="can-i-enable-persistence-on-a-previously-created-cache"></a><span data-ttu-id="4abf1-169">Můžete povolit trvalost na dříve vytvořenou mezipaměti?</span><span class="sxs-lookup"><span data-stu-id="4abf1-169">Can I enable persistence on a previously created cache?</span></span>
<span data-ttu-id="4abf1-170">Ano, trvalosti Redis lze nakonfigurovat při vytváření mezipaměti i na existující prémiových mezipamětí.</span><span class="sxs-lookup"><span data-stu-id="4abf1-170">Yes, Redis persistence can be configured both at cache creation and on existing premium caches.</span></span>

### <a name="can-i-enable-aof-and-rdb-persistence-at-the-same-time"></a><span data-ttu-id="4abf1-171">Můžete povolit trvalost AOF a RDB současně?</span><span class="sxs-lookup"><span data-stu-id="4abf1-171">Can I enable AOF and RDB persistence at the same time?</span></span>

<span data-ttu-id="4abf1-172">Ne, můžete povolit pouze RDB nebo AOF, ale ne obojí ve stejnou dobu.</span><span class="sxs-lookup"><span data-stu-id="4abf1-172">No, you can enable only RDB or AOF, but not both at the same time.</span></span>

### <a name="which-persistence-model-should-i-choose"></a><span data-ttu-id="4abf1-173">Zvolte trvalost modelu</span><span class="sxs-lookup"><span data-stu-id="4abf1-173">Which persistence model should I choose?</span></span>

<span data-ttu-id="4abf1-174">Trvalost AOF uloží každém zápisu do protokolu, který má určitý dopad na propustnost, porovnat s trvalost RDB, které ukládá zálohování podle nakonfigurovaný interval zálohování s minimálním dopadem na výkon.</span><span class="sxs-lookup"><span data-stu-id="4abf1-174">AOF persistence saves every write to a log, which has some impact on throughput, compared with RDB persistence which saves backups based on the configured backup interval, with minimal impact on performance.</span></span> <span data-ttu-id="4abf1-175">Trvalost AOF zvolte, pokud vaše primární cílem je minimalizovat ztrátu dat a dokáže zpracovat pokles v propustnost pro mezipaměť.</span><span class="sxs-lookup"><span data-stu-id="4abf1-175">Choose AOF persistence if your primary goal is to minimize data loss, and you can handle a decrease in throughput for your cache.</span></span> <span data-ttu-id="4abf1-176">Pokud chcete zachovat optimální propustnosti v mezipaměti, ale stále chcete mechanismus pro obnovení dat, vyberte trvalost RDB.</span><span class="sxs-lookup"><span data-stu-id="4abf1-176">Choose RDB persistence if you wish to maintain optimal throughput on your cache, but still want a mechanism for data recovery.</span></span>

* <span data-ttu-id="4abf1-177">Další informace o [výhody](https://redis.io/topics/persistence#rdb-advantages) a [nevýhody](https://redis.io/topics/persistence#rdb-disadvantages) z trvalost RDB.</span><span class="sxs-lookup"><span data-stu-id="4abf1-177">Learn more about the [advantages](https://redis.io/topics/persistence#rdb-advantages) and [disadvantages](https://redis.io/topics/persistence#rdb-disadvantages) of RDB persistence.</span></span>
* <span data-ttu-id="4abf1-178">Další informace o [výhody](https://redis.io/topics/persistence#aof-advantages) a [nevýhody](https://redis.io/topics/persistence#aof-disadvantages) z AOF trvalost.</span><span class="sxs-lookup"><span data-stu-id="4abf1-178">Learn more about the [advantages](https://redis.io/topics/persistence#aof-advantages) and [disadvantages](https://redis.io/topics/persistence#aof-disadvantages) of AOF persistence.</span></span>

<span data-ttu-id="4abf1-179">Další informace o výkonu při použití AOF trvalosti najdete v tématu [AOF nemá vliv trvalost v celé, latenci nebo výkonu Moje mezipaměti?](#does-aof-persistence-affect-throughout-latency-or-performance-of-my-cache)</span><span class="sxs-lookup"><span data-stu-id="4abf1-179">For more information on performance when using AOF persistence, see [Does AOF persistence affect throughout, latency, or performance of my cache?](#does-aof-persistence-affect-throughout-latency-or-performance-of-my-cache)</span></span>

### <a name="what-happens-if-i-have-scaled-to-a-different-size-and-a-backup-is-restored-that-was-made-before-the-scaling-operation"></a><span data-ttu-id="4abf1-180">Co se stane, pokud mají I škálovat na jinou velikost a je obnovit zálohu, která byla vytvořená před provedením operace škálování?</span><span class="sxs-lookup"><span data-stu-id="4abf1-180">What happens if I have scaled to a different size and a backup is restored that was made before the scaling operation?</span></span>

<span data-ttu-id="4abf1-181">RDB a AOF trvalosti:</span><span class="sxs-lookup"><span data-stu-id="4abf1-181">For both RDB and AOF persistence:</span></span>

* <span data-ttu-id="4abf1-182">Pokud máte škálovat na větší velikost, neexistuje žádný vliv.</span><span class="sxs-lookup"><span data-stu-id="4abf1-182">If you have scaled to a larger size, there is no impact.</span></span>
* <span data-ttu-id="4abf1-183">Pokud máte škálovat na menší velikost, a máte vlastní [databáze](cache-configure.md#databases) nastavení, která je větší než [databáze limit](cache-configure.md#databases) pro novou velikost, není obnovit data v těchto databází.</span><span class="sxs-lookup"><span data-stu-id="4abf1-183">If you have scaled to a smaller size, and you have a custom [databases](cache-configure.md#databases) setting that is greater than the [databases limit](cache-configure.md#databases) for your new size, data in those databases isn't restored.</span></span> <span data-ttu-id="4abf1-184">Další informace najdete v tématu [je vlastní databází. nastavení ovlivněných během změny měřítka?](cache-how-to-scale.md#is-my-custom-databases-setting-affected-during-scaling)</span><span class="sxs-lookup"><span data-stu-id="4abf1-184">For more information, see [Is my custom databases setting affected during scaling?](cache-how-to-scale.md#is-my-custom-databases-setting-affected-during-scaling)</span></span>
* <span data-ttu-id="4abf1-185">Pokud máte škálovat na menší velikost a menší velikost pro uložení všech dat z poslední zálohy není dostatek místa, klíče bude vyloučena během procesu obnovení, obvykle pomocí [allkeys lru](http://redis.io/topics/lru-cache) zásady vyřazení.</span><span class="sxs-lookup"><span data-stu-id="4abf1-185">If you have scaled to a smaller size, and there isn't enough room in the smaller size to hold all of the data from the last backup, keys will be evicted during the restore process, typically using the [allkeys-lru](http://redis.io/topics/lru-cache) eviction policy.</span></span>

### <a name="can-i-change-the-rdb-backup-frequency-after-i-create-the-cache"></a><span data-ttu-id="4abf1-186">Můžete změnit po vytvoření mezipaměti je četnost záloh RDB?</span><span class="sxs-lookup"><span data-stu-id="4abf1-186">Can I change the RDB backup frequency after I create the cache?</span></span>
<span data-ttu-id="4abf1-187">Ano, můžete změnit četnost záloh pro trvalost RDB na **trvalosti dat Redis** okno.</span><span class="sxs-lookup"><span data-stu-id="4abf1-187">Yes, you can change the backup frequency for RDB persistence on the **Redis data persistence** blade.</span></span> <span data-ttu-id="4abf1-188">Pokyny najdete v tématu [konfigurace Redis trvalost](#configure-redis-persistence).</span><span class="sxs-lookup"><span data-stu-id="4abf1-188">For instructions, see [Configure Redis persistence](#configure-redis-persistence).</span></span>

### <a name="why-if-i-have-an-rdb-backup-frequency-of-60-minutes-there-is-more-than-60-minutes-between-backups"></a><span data-ttu-id="4abf1-189">Proč Pokud četnost zálohování v RDB 60 minut je víc než 60 minut mezi zálohování?</span><span class="sxs-lookup"><span data-stu-id="4abf1-189">Why if I have an RDB backup frequency of 60 minutes there is more than 60 minutes between backups?</span></span>
<span data-ttu-id="4abf1-190">Interval RDB trvalost četnost záloh se nespustí, dokud předchozí proces zálohování byla úspěšně dokončena.</span><span class="sxs-lookup"><span data-stu-id="4abf1-190">The RDB persistence backup frequency interval does not start until the previous backup process has completed successfully.</span></span> <span data-ttu-id="4abf1-191">Pokud je četnost záloh je 60 minut a trvá 15 minut pro proces zálohování úspěšně dokončit, další zálohování nezačne 75 minut po času zahájení z předchozí zálohy.</span><span class="sxs-lookup"><span data-stu-id="4abf1-191">If the backup frequency is 60 minutes and it takes a backup process 15 minutes to successfully complete, the next backup won't start until 75 minutes after the start time of the previous backup.</span></span>

### <a name="what-happens-to-the-old-rdb-backups-when-a-new-backup-is-made"></a><span data-ttu-id="4abf1-192">Co se stane starší zálohy RDB, když je proveden novou zálohu?</span><span class="sxs-lookup"><span data-stu-id="4abf1-192">What happens to the old RDB backups when a new backup is made?</span></span>
<span data-ttu-id="4abf1-193">Všechny zálohy trvalost RDB s výjimkou nejnovějšího se automaticky odstraní.</span><span class="sxs-lookup"><span data-stu-id="4abf1-193">All RDB persistence backups except for the most recent one are automatically deleted.</span></span> <span data-ttu-id="4abf1-194">Odstranění nemusí dojít okamžitě, ale nejsou starší zálohy trvalé bez omezení.</span><span class="sxs-lookup"><span data-stu-id="4abf1-194">This deletion may not happen immediately but older backups are not persisted indefinitely.</span></span>


### <a name="when-should-i-use-a-second-storage-account"></a><span data-ttu-id="4abf1-195">Kdy je vhodné použít druhého účtu úložiště?</span><span class="sxs-lookup"><span data-stu-id="4abf1-195">When should I use a second storage account?</span></span>

<span data-ttu-id="4abf1-196">AOF trvalosti měli použít druhý účet úložiště, pokud se domníváte, že máte vyšší než očekávaný množinové operace v mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="4abf1-196">You should use a second storage account for AOF persistence when you believe you have higher than expected set operations on the cache.</span></span>  <span data-ttu-id="4abf1-197">Nastavení účtu sekundární úložiště pomáhá zajistit, že mezipaměť nebude dosáhnout omezení šířky pásma úložiště.</span><span class="sxs-lookup"><span data-stu-id="4abf1-197">Setting up the secondary storage account helps ensure your cache doesn't reach storage bandwidth limits.</span></span>

### <a name="does-aof-persistence-affect-throughout-latency-or-performance-of-my-cache"></a><span data-ttu-id="4abf1-198">Nemá vliv trvalost AOF v celé, latenci nebo výkonu Moje mezipaměti?</span><span class="sxs-lookup"><span data-stu-id="4abf1-198">Does AOF persistence affect throughout, latency, or performance of my cache?</span></span>

<span data-ttu-id="4abf1-199">Trvalost AOF ovlivní propustnost podle přibližně 15 % – 20 % při mezipaměti je menší než maximální zatížení (procesoru a Server načíst i v části 90 %).</span><span class="sxs-lookup"><span data-stu-id="4abf1-199">AOF persistence affects throughput by about 15% – 20% when the cache is below maximum load (CPU and Server Load both under 90%).</span></span> <span data-ttu-id="4abf1-200">By neměl být problémy s latencí při mezipaměť je v rámci těchto mezních hodnot.</span><span class="sxs-lookup"><span data-stu-id="4abf1-200">There should not be latency issues when the cache is within these limits.</span></span> <span data-ttu-id="4abf1-201">Mezipaměti bude tyto limity však dříve dosáhnout s AOF povolena.</span><span class="sxs-lookup"><span data-stu-id="4abf1-201">However, the cache will reach these limits sooner with AOF enabled.</span></span>

### <a name="how-can-i-remove-the-second-storage-account"></a><span data-ttu-id="4abf1-202">Jak můžete odebrat druhého účtu úložiště?</span><span class="sxs-lookup"><span data-stu-id="4abf1-202">How can I remove the second storage account?</span></span>

<span data-ttu-id="4abf1-203">Můžete odebrat účet sekundární úložiště trvalosti AOF nastavením druhý účet úložiště, aby byla stejná jako první účet úložiště.</span><span class="sxs-lookup"><span data-stu-id="4abf1-203">You can remove the AOF persistence secondary storage account by setting the second storage account to be the same as the first storage account.</span></span> <span data-ttu-id="4abf1-204">Pokyny najdete v tématu [AOF konfigurace trvalosti](#configure-aof-persistence).</span><span class="sxs-lookup"><span data-stu-id="4abf1-204">For instructions, see [Configure AOF persistence](#configure-aof-persistence).</span></span>

### <a name="what-is-a-rewrite-and-how-does-it-affect-my-cache"></a><span data-ttu-id="4abf1-205">Co je přepisování a jak se týká Moje mezipaměti?</span><span class="sxs-lookup"><span data-stu-id="4abf1-205">What is a rewrite and how does it affect my cache?</span></span>

<span data-ttu-id="4abf1-206">Když se soubor AOF stane dostatečně velké na to, přepište je automaticky zařazeny do fronty v mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="4abf1-206">When the AOF file becomes large enough, a rewrite is automatically queued on the cache.</span></span> <span data-ttu-id="4abf1-207">Přepsání změní velikost souboru AOF s minimální sadu operací, které jsou nutné k vytvoření aktuální datové sady.</span><span class="sxs-lookup"><span data-stu-id="4abf1-207">The rewrite resizes the AOF file with the minimal set of operations needed to create the current data set.</span></span> <span data-ttu-id="4abf1-208">Během přepisů očekává dříve dosažení omezení výkonu, zejména při plánování práce s velkými datovými sadami.</span><span class="sxs-lookup"><span data-stu-id="4abf1-208">During rewrites, expect to reach performance limits sooner especially when dealing with large datasets.</span></span> <span data-ttu-id="4abf1-209">Přepisů docházet k méně často AOF souboru se změní na větší, ale bude trvat poměrně dlouhou dobu, kdy se stane.</span><span class="sxs-lookup"><span data-stu-id="4abf1-209">Rewrites occur less often as the AOF file becomes larger, but will take a significant amount of time when it happens.</span></span>

### <a name="what-should-i-expect-when-scaling-a-cache-with-aof-enabled"></a><span data-ttu-id="4abf1-210">Co lze očekávat při škálování mezipaměť s AOF povolené?</span><span class="sxs-lookup"><span data-stu-id="4abf1-210">What should I expect when scaling a cache with AOF enabled?</span></span>

<span data-ttu-id="4abf1-211">Pokud je soubor AOF v době škálování výrazně velký, pak očekávají, že se operace škálování trvá déle, než se očekávalo vzhledem k tomu, že se bude znovu načíst soubor po dokončení škálování.</span><span class="sxs-lookup"><span data-stu-id="4abf1-211">If the AOF file at the time of scaling is significantly large, then expect the scale operation to take longer than expected since it will be reloading the file after scaling has finished.</span></span>

<span data-ttu-id="4abf1-212">Další informace o škálování najdete v tématu [co se stane, když I mít škálovat na jinou velikost a je obnovit zálohu, která byla vytvořená před provedením operace škálování?](#what-happens-if-i-have-scaled-to-a-different-size-and-a-backup-is-restored-that-was-made-before-the-scaling-operation)</span><span class="sxs-lookup"><span data-stu-id="4abf1-212">For more information on scaling, see [What happens if I have scaled to a different size and a backup is restored that was made before the scaling operation?](#what-happens-if-i-have-scaled-to-a-different-size-and-a-backup-is-restored-that-was-made-before-the-scaling-operation)</span></span>

### <a name="how-is-my-aof-data-organized-in-storage"></a><span data-ttu-id="4abf1-213">Uspořádání AOF data v úložišti</span><span class="sxs-lookup"><span data-stu-id="4abf1-213">How is my AOF data organized in storage?</span></span>

<span data-ttu-id="4abf1-214">Data uložená v souborech AOF je rozdělen do více objekty BLOB stránky na uzel, pokud chcete zvýšit výkon při ukládání dat do úložiště.</span><span class="sxs-lookup"><span data-stu-id="4abf1-214">Data stored in AOF files is divided into multiple page blobs per node to increase performance of saving the data to storage.</span></span> <span data-ttu-id="4abf1-215">Následující tabulka zobrazuje, kolik objekty BLOB stránky se používají u jednotlivých cenových úrovní:</span><span class="sxs-lookup"><span data-stu-id="4abf1-215">The following table displays how many page blobs are used for each pricing tier:</span></span>

| <span data-ttu-id="4abf1-216">Úroveň Premium</span><span class="sxs-lookup"><span data-stu-id="4abf1-216">Premium tier</span></span> | <span data-ttu-id="4abf1-217">Objekty blob</span><span class="sxs-lookup"><span data-stu-id="4abf1-217">Blobs</span></span> |
|--------------|-------|
| <span data-ttu-id="4abf1-218">P1</span><span class="sxs-lookup"><span data-stu-id="4abf1-218">P1</span></span>           | <span data-ttu-id="4abf1-219">4 na horizontální oddíl</span><span class="sxs-lookup"><span data-stu-id="4abf1-219">4 per shard</span></span>    |
| <span data-ttu-id="4abf1-220">P2</span><span class="sxs-lookup"><span data-stu-id="4abf1-220">P2</span></span>           | <span data-ttu-id="4abf1-221">8 na horizontální oddíl</span><span class="sxs-lookup"><span data-stu-id="4abf1-221">8 per shard</span></span>    |
| <span data-ttu-id="4abf1-222">P3</span><span class="sxs-lookup"><span data-stu-id="4abf1-222">P3</span></span>           | <span data-ttu-id="4abf1-223">16 na horizontální oddíl</span><span class="sxs-lookup"><span data-stu-id="4abf1-223">16 per shard</span></span>   |
| <span data-ttu-id="4abf1-224">P4</span><span class="sxs-lookup"><span data-stu-id="4abf1-224">P4</span></span>           | <span data-ttu-id="4abf1-225">20 na horizontální oddíl</span><span class="sxs-lookup"><span data-stu-id="4abf1-225">20 per shard</span></span>   |

<span data-ttu-id="4abf1-226">Pokud je povoleno clustering, každý horizontálního oddílu v mezipaměti má vlastní sadu objektů BLOB stránky, jak je uvedeno v předchozí tabulce.</span><span class="sxs-lookup"><span data-stu-id="4abf1-226">When clustering is enabled, each shard in the cache has its own set of page blobs, as indicated in the previous table.</span></span> <span data-ttu-id="4abf1-227">Například P2 mezipaměť tři horizontálních oddílů rozděluje jeho AOF souboru na 24 objekty BLOB stránky (8 objekty BLOB na horizontální oddíl s 3 horizontálních oddílů).</span><span class="sxs-lookup"><span data-stu-id="4abf1-227">For example, a P2 cache with three shards distributes its AOF file across 24 page blobs (8 blobs per shard, with 3 shards).</span></span>

<span data-ttu-id="4abf1-228">Po přepsání dvě sady AOF soubory existují v úložišti.</span><span class="sxs-lookup"><span data-stu-id="4abf1-228">After a rewrite, two sets of AOF files exist in storage.</span></span> <span data-ttu-id="4abf1-229">Přepisů probíhat na pozadí a připojit k první sadu souborů, zatímco připojení množinové operace, které se odesílají do mezipaměti při přepsání v druhé sadě.</span><span class="sxs-lookup"><span data-stu-id="4abf1-229">Rewrites occur in the background and append to the first set of files, while set operations that are sent to the cache during the rewrite append to the second set.</span></span> <span data-ttu-id="4abf1-230">Zálohy se dočasně ukládají během přepisů v případě selhání, ale bude po dokončení přepište okamžitě odstraněna.</span><span class="sxs-lookup"><span data-stu-id="4abf1-230">A backup is temporarily stored during rewrites in case of failure, but is promptly deleted after a rewrite finishes.</span></span>


## <a name="next-steps"></a><span data-ttu-id="4abf1-231">Další kroky</span><span class="sxs-lookup"><span data-stu-id="4abf1-231">Next steps</span></span>
<span data-ttu-id="4abf1-232">Naučte se používat další funkce mezipaměti premium.</span><span class="sxs-lookup"><span data-stu-id="4abf1-232">Learn how to use more premium cache features.</span></span>

* [<span data-ttu-id="4abf1-233">Úvod do Azure Redis Cache na úrovni Premium</span><span class="sxs-lookup"><span data-stu-id="4abf1-233">Introduction to the Azure Redis Cache Premium tier</span></span>](cache-premium-tier-intro.md)

<!-- IMAGES -->

[redis-cache-premium-pricing-tier]: ./media/cache-how-to-premium-persistence/redis-cache-premium-pricing-tier.png

[redis-cache-persistence]: ./media/cache-how-to-premium-persistence/redis-cache-persistence.png

[redis-cache-rdb-persistence]: ./media/cache-how-to-premium-persistence/redis-cache-rdb-persistence.png

[redis-cache-aof-persistence]: ./media/cache-how-to-premium-persistence/redis-cache-aof-persistence.png

[redis-cache-settings]: ./media/cache-how-to-premium-persistence/redis-cache-settings.png
