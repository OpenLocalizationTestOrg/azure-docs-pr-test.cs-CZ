---
title: "službu s vysokou dostupností aaaDesign používání Azure SQL Database | Microsoft Docs"
description: "Další informace o návrhu aplikace pro používání Azure SQL Database služeb s vysokou dostupností."
keywords: "cloud zotavení po havárii, řešení zotavení po havárii, zálohování dat aplikace, geografická replikace, obchodní kontinuity plánování"
services: sql-database
documentationcenter: 
author: anosov1960
manager: jhubbard
editor: monicar
ms.assetid: e8a346ac-dd08-41e7-9685-46cebca04582
ms.service: sql-database
ms.custom: business continuity
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: data-management
ms.date: 04/21/2017
ms.author: sashan
ms.openlocfilehash: 815f754ba7014cd8a1108a2d84c2a8f71d7030a5
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="designing-highly-available-services-using-azure-sql-database"></a><span data-ttu-id="054d4-104">Navrhování služeb s vysokou dostupností pomocí Azure SQL Database</span><span class="sxs-lookup"><span data-stu-id="054d4-104">Designing highly available services using Azure SQL Database</span></span>

<span data-ttu-id="054d4-105">Při vytváření a nasazování služeb s vysokou dostupností v databázi SQL Azure, je použít [převzetí služeb při selhání skupiny a aktivní geografickou replikací](sql-database-geo-replication-overview.md) selhání tooregional tooprovide odolnost a závažné výpadky a povolit rychlé obnovení toohello sekundární databáze.</span><span class="sxs-lookup"><span data-stu-id="054d4-105">When building and deploying highly available services on Azure SQL Database, you use [failover groups and active geo-replication](sql-database-geo-replication-overview.md) tooprovide resilience tooregional failures and catastrophic outages and enable fast recovery toohello secondary databases.</span></span> <span data-ttu-id="054d4-106">Tento článek se zaměřuje na běžných vzorů aplikace a popisuje výhody hello a kompromis jednotlivých možností v závislosti na požadavcích nasazení hello aplikace, hello smlouvu o úrovni služeb cílíte, provoz latenci a náklady.</span><span class="sxs-lookup"><span data-stu-id="054d4-106">This article focuses on common application patterns and discusses hello benefits and trade-offs of each option depending on hello application deployment requirements, hello service level agreement you are targeting, traffic latency, and costs.</span></span> <span data-ttu-id="054d4-107">Informace o aktivní geografickou replikaci s elastické fondy najdete v tématu [strategie zotavení po havárii elastický fond](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span><span class="sxs-lookup"><span data-stu-id="054d4-107">For information about active geo-replication with Elastic Pools, see [Elastic Pool disaster recovery strategies](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span></span>

## <a name="design-pattern-1-active-passive-deployment-for-cloud-disaster-recovery-with-a-co-located-database"></a><span data-ttu-id="054d4-108">Vzor návrhu 1: nasazení aktivní – pasivní pro zotavení po havárii cloudu s společně umístěné databáze</span><span class="sxs-lookup"><span data-stu-id="054d4-108">Design pattern 1: Active-passive deployment for cloud disaster recovery with a co-located database</span></span>
<span data-ttu-id="054d4-109">Tato možnost je nejvhodnější pro aplikace s hello následující vlastnosti:</span><span class="sxs-lookup"><span data-stu-id="054d4-109">This option is best suited for applications with hello following characteristics:</span></span>

* <span data-ttu-id="054d4-110">Aktivní instance v jedné oblasti Azure</span><span class="sxs-lookup"><span data-stu-id="054d4-110">Active instance in a single Azure region</span></span>
* <span data-ttu-id="054d4-111">Silné závislost na toodata přístup pro čtení a zápis (RW)</span><span class="sxs-lookup"><span data-stu-id="054d4-111">Strong dependency on read-write (RW) access toodata</span></span>
* <span data-ttu-id="054d4-112">Připojení mezi oblastmi mezi hello webové aplikace a hello databáze není platný kvůli toolatency a provoz náklady</span><span class="sxs-lookup"><span data-stu-id="054d4-112">Cross-region connectivity between hello web application and hello database is not acceptable due toolatency and traffic cost</span></span>    

<span data-ttu-id="054d4-113">V takovém případě topologie nasazení aplikace hello je optimalizovaná pro zpracování místní havárie, při dopad na všechny součásti aplikace a potřebujete toofailover jako jednotku.</span><span class="sxs-lookup"><span data-stu-id="054d4-113">In this case, hello application deployment topology is optimized for handling regional disasters when all application components are impacted and need toofailover as a unit.</span></span> <span data-ttu-id="054d4-114">Geografická redundance hello aplikační logiku a hello databáze jsou replikované tooanother oblasti, ale nejsou použity pro zatížení aplikace hello za normálních podmínek hello.</span><span class="sxs-lookup"><span data-stu-id="054d4-114">For geographic redundancy, hello application logic and hello database are replicated tooanother region but they are not used for hello application workload under hello normal conditions.</span></span> <span data-ttu-id="054d4-115">aplikace Hello v sekundární oblasti hello by měl být nakonfigurovaný toouse připojovací řetězec toohello sekundární databáze SQL.</span><span class="sxs-lookup"><span data-stu-id="054d4-115">hello application in hello secondary region should be configured toouse a SQL connection string toohello secondary database.</span></span> <span data-ttu-id="054d4-116">Správce provozu je nastavený toouse [metody směrování převzetí služeb při selhání](../traffic-manager/traffic-manager-configure-failover-routing-method.md).</span><span class="sxs-lookup"><span data-stu-id="054d4-116">Traffic manager is set up toouse [failover routing method](../traffic-manager/traffic-manager-configure-failover-routing-method.md).</span></span>  

> [!NOTE]
> <span data-ttu-id="054d4-117">[Azure traffic Manageru](../traffic-manager/traffic-manager-overview.md) se používá v tomto článku obrázek pouze pro účely.</span><span class="sxs-lookup"><span data-stu-id="054d4-117">[Azure traffic manager](../traffic-manager/traffic-manager-overview.md) is used throughout this article for illustration purposes only.</span></span> <span data-ttu-id="054d4-118">Můžete použít jakéhokoli řešení vyrovnávání zatížení, které podporuje metodu směrování převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="054d4-118">You can use any load-balancing solution that supports failover routing method.</span></span>    
>

<span data-ttu-id="054d4-119">Hello následující diagram znázorňuje tuto konfiguraci před výpadku.</span><span class="sxs-lookup"><span data-stu-id="054d4-119">hello following diagram shows this configuration before an outage.</span></span>

![Konfigurace geografická replikace databáze SQL.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern1-1.png)

<span data-ttu-id="054d4-122">Po výpadku v primární oblasti hello služby SQL Database hello zjišťuje, tuto primární databázi hello není dostupný a aktivovat převzetí služeb při selhání toohello sekundární databáze na základě parametrů hello zásad hello automatické převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="054d4-122">After an outage in hello primary region, hello SQL Database service detects that hello primary database is not accessible and trigger a failover toohello secondary database based on hello parameters of hello automatic failover policy.</span></span> <span data-ttu-id="054d4-123">V závislosti na vaší smlouvě SLA aplikace můžete rozhodnout, tooconfigure a období odkladu mezi detekce hello hello výpadku a hello převzetí služeb při selhání sám sebe.</span><span class="sxs-lookup"><span data-stu-id="054d4-123">Depending on your application SLA, you can decide tooconfigure a grace period between hello detection of hello outage and hello failover itself.</span></span> <span data-ttu-id="054d4-124">Konfigurace období odkladu snižuje riziko hello data ztrátě toohello případy, kdy je závažné hello výpadku a dostupnosti v oblasti hello nelze obnovit rychle.</span><span class="sxs-lookup"><span data-stu-id="054d4-124">Configuring a grace period reduces hello risk of data loss toohello cases where hello outage is catastrophic and availability in hello region cannot be quickly restored.</span></span> <span data-ttu-id="054d4-125">Pokud převzetí služeb při selhání hello koncový bod je iniciovaná hello traffic Manageru před hello převzetí služeb při selhání skupiny aktivace hello převzetí služeb při selhání databáze hello, není možné tooreconnect toohello databáze hello webové aplikace.</span><span class="sxs-lookup"><span data-stu-id="054d4-125">If hello endpoint failover is initiated by hello traffic manager before hello failover group triggers hello failover of hello database, hello web application is not able tooreconnect toohello database.</span></span> <span data-ttu-id="054d4-126">Pokus o tooreconnect Hello aplikace automaticky úspěšné ihned po dokončení převzetí služeb při selhání hello databáze.</span><span class="sxs-lookup"><span data-stu-id="054d4-126">hello application’s attempt tooreconnect automatically succeeds as soon as hello database failover completes.</span></span> 

> [!NOTE]
> <span data-ttu-id="054d4-127">tooachieve plně koordinované převzetí služeb při selhání aplikace hello a hello databáze, doporučujeme navrhnout vlastní metoda monitorování a použít ruční převzetí služeb při selhání koncových bodů hello webové aplikace a hello databází.</span><span class="sxs-lookup"><span data-stu-id="054d4-127">tooachieve fully coordinated failover of hello application and hello databases, you should devise your own monitoring method and use manual failover of hello web application endpoints and hello databases.</span></span>
>

<span data-ttu-id="054d4-128">Po dokončení převzetí služeb při selhání hello koncových bodů aplikace hello i hello databázi aplikace hello znovu začít zpracovávat požadavky uživatelů hello v oblasti hello B a zůstane umístěné společně se službou hello databáze, protože hello primární databáze je nyní v oblast B. Tento scénář je znázorněn v následujícím diagramu hello.</span><span class="sxs-lookup"><span data-stu-id="054d4-128">After hello failover of both hello application’s endpoints and hello database completes, hello application will re-start processing hello user requests in hello region B and will remain co-located with hello database because hello primary database is now in region B. This scenario is illustrated in hello following diagram.</span></span> <span data-ttu-id="054d4-129">Ve všech diagramech plné čáry znamenat aktivních připojení, tečkovaná čáry označují pozastavenou připojení a zastavení přihlásí znamenat akce aktivační události.</span><span class="sxs-lookup"><span data-stu-id="054d4-129">In all diagrams, solid lines indicate active connections, dotted lines indicate suspended connections, and stop signs indicate action triggers.</span></span>

![Geografická replikace: Databáze toosecondary převzetí služeb při selhání.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern1-2.png)

<span data-ttu-id="054d4-132">V případě výpadku v sekundární oblasti hello hello odkaz replikace mezi hello primární a sekundární databáze hello je pozastaven, ale hello převzetí služeb při selhání není aktivována, protože není ovlivněná hello primární databáze.</span><span class="sxs-lookup"><span data-stu-id="054d4-132">If an outage happens in hello secondary region, hello replication link between hello primary and hello secondary database is suspended but hello failover is not triggered because hello primary database is not impacted.</span></span> <span data-ttu-id="054d4-133">dostupnost aplikace Hello není v tomto případě změnila, ale aplikace hello funguje zveřejněné a proto vyšší riziko v případě obou oblastí nezdaří za sebou.</span><span class="sxs-lookup"><span data-stu-id="054d4-133">hello application's availability is not changed in this case, but hello application operates exposed and therefore at higher risk in case both regions fail in succession.</span></span>

> [!NOTE]
> <span data-ttu-id="054d4-134">Pro zotavení po havárii doporučujeme hello konfigurace s oblastí tootwo omezené nasazení aplikace.</span><span class="sxs-lookup"><span data-stu-id="054d4-134">For disaster recovery we recommend hello configuration with application deployment limited tootwo regions.</span></span> <span data-ttu-id="054d4-135">Důvodem je, že většina z hello zeměpisných oblastí Azure mají pouze dvou oblastí.</span><span class="sxs-lookup"><span data-stu-id="054d4-135">This is because most of hello Azure geographies have only two regions.</span></span> <span data-ttu-id="054d4-136">Tato konfigurace nebude chránit vaše aplikace v případě selhání souběžných závažné obou oblastí.</span><span class="sxs-lookup"><span data-stu-id="054d4-136">This configuration will not protect your application from a simultaneous catastrophic failure of both regions.</span></span>  <span data-ttu-id="054d4-137">V nepravděpodobnému takové selhání, můžete obnovit vaše databáze v třetí oblast pomocí [geografické obnovení operace](sql-database-disaster-recovery.md#recover-using-geo-restore).</span><span class="sxs-lookup"><span data-stu-id="054d4-137">In an unlikely event of such a failure, you can recover your databases in a third region using [geo-restore operation](sql-database-disaster-recovery.md#recover-using-geo-restore).</span></span>
>

<span data-ttu-id="054d4-138">Po výpadku hello zmírnit, hello sekundární databáze bude automaticky znovu synchronizovat s hello primární.</span><span class="sxs-lookup"><span data-stu-id="054d4-138">Once hello outage is mitigated, hello secondary database will automatically re-synchronize with hello primary.</span></span> <span data-ttu-id="054d4-139">Během synchronizace může mít výkon hello primární mírně dopad v závislosti na hello množství dat, který potřebuje toobe synchronizované.</span><span class="sxs-lookup"><span data-stu-id="054d4-139">During synchronization, performance of hello primary could be slightly impacted depending on hello amount of data that needs toobe synchronized.</span></span> <span data-ttu-id="054d4-140">Hello následující diagram znázorňuje výpadku v sekundární oblasti hello.</span><span class="sxs-lookup"><span data-stu-id="054d4-140">hello following diagram illustrates an outage in hello secondary region.</span></span>

![Sekundární databáze synchronizována s primární.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern1-3.png)

<span data-ttu-id="054d4-143">klíč Hello **výhody** tohoto vzoru návrhu jsou:</span><span class="sxs-lookup"><span data-stu-id="054d4-143">hello key **advantages** of this design pattern are:</span></span>

* <span data-ttu-id="054d4-144">Hello stejné webové aplikace je nasazená tooboth oblastí bez jakékoli konfigurace specifické pro oblast a žádná další logiku tooreact toohello převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="054d4-144">hello same web application is deployed tooboth regions without any region-specific configuration and no additional logic tooreact toohello failover.</span></span> 
* <span data-ttu-id="054d4-145">výkon aplikace Hello nebude ovlivněné převzetí služeb při selhání jako hello webové aplikace a databáze hello jsou vždy společně umístěné.</span><span class="sxs-lookup"><span data-stu-id="054d4-145">hello application's performance is not impacted by failover as hello web application and hello database are always co-located.</span></span>

<span data-ttu-id="054d4-146">Hello hlavní **kompromis** je, že aplikace hello redundantní instance v sekundární oblasti hello se používá pouze pro zotavení po havárii.</span><span class="sxs-lookup"><span data-stu-id="054d4-146">hello main **tradeoff** is that hello redundant application instance in hello secondary region is only used for disaster recovery.</span></span>

## <a name="design-pattern-2-active-active-deployment-for-application-load-balancing"></a><span data-ttu-id="054d4-147">Vzor návrhu 2: nasazení aktivní aktivní pro vyrovnávání zatížení aplikace</span><span class="sxs-lookup"><span data-stu-id="054d4-147">Design pattern 2: Active-active deployment for application load balancing</span></span>
<span data-ttu-id="054d4-148">Tato možnost obnovení po havárii cloudu je nejvhodnější pro aplikace s hello následující vlastnosti:</span><span class="sxs-lookup"><span data-stu-id="054d4-148">This cloud disaster recovery option is best suited for applications with hello following characteristics:</span></span>

* <span data-ttu-id="054d4-149">Vysoký poměr databáze čte toowrites</span><span class="sxs-lookup"><span data-stu-id="054d4-149">High ratio of database reads toowrites</span></span>
* <span data-ttu-id="054d4-150">Databáze latence čtení je pro činnost koncového uživatele hello větší význam než latence zápisu u hello</span><span class="sxs-lookup"><span data-stu-id="054d4-150">Database read latency is more critical for hello end-user experience than hello write latency</span></span> 
* <span data-ttu-id="054d4-151">Jen pro čtení logiky je možné oddělit z logiku pro čtení a zápis pomocí různých připojovací řetězec</span><span class="sxs-lookup"><span data-stu-id="054d4-151">Read-only logic can be separated from read-write logic by using a different connection string</span></span>
* <span data-ttu-id="054d4-152">Jen pro čtení logiku nezávisí na data právě plně synchronizována s nejnovějšími aktualizacemi hello</span><span class="sxs-lookup"><span data-stu-id="054d4-152">Read-only logic does not depend on data being fully synchronized with hello latest updates</span></span>  

<span data-ttu-id="054d4-153">Pokud vaše aplikace mají tyto charakteristiky, Vyrovnávání zatížení připojení koncových uživatelů hello napříč více instancí aplikace v různých oblastech podstatně zlepšit hello celkové činnost koncového uživatele.</span><span class="sxs-lookup"><span data-stu-id="054d4-153">If your applications have these characteristics, load balancing hello end-user connections across multiple application instances in different regions can substantially improve hello overall end-user experience.</span></span> <span data-ttu-id="054d4-154">Dva oblastí hello měl by být vybrán jako hello pár zotavení po Havárii a hello převzetí služeb při selhání skupiny by měla obsahovat hello databáze v těchto oblastech.</span><span class="sxs-lookup"><span data-stu-id="054d4-154">Two of hello regions should be selected as hello DR pair and hello failover group should include hello databases in these regions.</span></span> <span data-ttu-id="054d4-155">tooimplement Vyrovnávání zatížení, každou oblast, musí mít aktivní instance aplikace hello hello pro čtení a zápis (RW) logiku připojené toohello naslouchací proces pro čtení a zápis koncový bod hello převzetí služeb při selhání skupiny.</span><span class="sxs-lookup"><span data-stu-id="054d4-155">tooimplement load-balancing, each region should have an active instance of hello application with hello read-write (RW) logic connected toohello read-write listener endpoint of hello failover group.</span></span> <span data-ttu-id="054d4-156">Zaručí, že převzetí hello bude automaticky v případě hello primární databáze je ovlivní případný výpadek.</span><span class="sxs-lookup"><span data-stu-id="054d4-156">It will guarantee that hello failover will be automatically initiated if hello primary database is impacted by an outage.</span></span> <span data-ttu-id="054d4-157">Hello jen pro čtení logiky (RO) ve webové aplikaci hello by měl připojit přímo toohello databáze v této oblasti.</span><span class="sxs-lookup"><span data-stu-id="054d4-157">hello read-only logic (RO) in hello web application should connect directly toohello database in that region.</span></span> <span data-ttu-id="054d4-158">Správce provozu by měly být nastavené toouse [směrování výkonu](../traffic-manager/traffic-manager-configure-performance-routing-method.md) s [koncový bod monitorování](../traffic-manager/traffic-manager-monitoring.md) povolená pro každou instanci aplikace.</span><span class="sxs-lookup"><span data-stu-id="054d4-158">Traffic manager should be set up toouse [performance routing](../traffic-manager/traffic-manager-configure-performance-routing-method.md) with [end-point monitoring](../traffic-manager/traffic-manager-monitoring.md) enabled for each application instance.</span></span>

<span data-ttu-id="054d4-159">Jako vzor #1 musíte zvážit nasazení podobné monitorování aplikací.</span><span class="sxs-lookup"><span data-stu-id="054d4-159">As in pattern #1, you should consider deploying a similar monitoring application.</span></span> <span data-ttu-id="054d4-160">Ale na rozdíl od vzoru #1 hello monitorování aplikace nebude zodpovědná za aktivaci hello koncový bod převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="054d4-160">But unlike pattern #1, hello monitoring application will not be responsible for triggering hello end-point failover.</span></span>

> [!NOTE]
> <span data-ttu-id="054d4-161">Tento vzor používá více než jedné sekundární databáze, pouze hello sekundární v oblasti B se použije pro převzetí služeb při selhání a musí být součástí skupiny hello převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="054d4-161">While this pattern uses more than one secondary database, only hello secondary in Region B  would be used for failover and should be part of hello failover group.</span></span>
>

<span data-ttu-id="054d4-162">Správce provozu musí být nakonfigurovaný pro výkon směrování toodirect hello uživatele připojení toohello aplikace instance nejbližší toohello zeměpisné umístění uživatele.</span><span class="sxs-lookup"><span data-stu-id="054d4-162">Traffic manager should be configured for performance routing toodirect hello user connections toohello application instance closest toohello user's geographic location.</span></span> <span data-ttu-id="054d4-163">Hello následující diagram znázorňuje tuto konfiguraci před výpadku.</span><span class="sxs-lookup"><span data-stu-id="054d4-163">hello following diagram illustrates this configuration before an outage.</span></span>

![Žádný výpadek: výkonu směrování toonearest aplikace.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern2-1.png)

<span data-ttu-id="054d4-166">Pokud v oblasti hello A je zjištěn výpadek databáze, hello převzetí služeb při selhání skupiny automaticky zahájit převzetí služeb při selhání hello primární databáze v sekundární oblasti A toohello v oblasti B. Hello naslouchací proces pro čtení a zápis koncový bod tooregion B se také automaticky aktualizuje, připojení pro čtení a zápis v hello webová aplikace nebude mít vliv.</span><span class="sxs-lookup"><span data-stu-id="054d4-166">If a database outage is detected in hello region A, hello failover group will automatically initiate failover of hello primary database in region A toohello secondary in region B. It will also automatically update hello read-write listener endpoint tooregion B so read-write connections in hello web application will not be impacted.</span></span> <span data-ttu-id="054d4-167">Správce provozu Hello offline koncový bod hello vyloučí je z hello směrovací tabulky, ale bude pokračovat směrování hello koncového uživatele provoz toohello zbývající online instance.</span><span class="sxs-lookup"><span data-stu-id="054d4-167">hello traffic manager will exclude hello offline end-point from hello routing table but will continue routing hello end-user traffic toohello remaining online instances.</span></span> <span data-ttu-id="054d4-168">Hello jen pro čtení připojovací řetězce SQL nebude mít vliv na jako budou vždy bod toohello databáze v hello stejné oblasti.</span><span class="sxs-lookup"><span data-stu-id="054d4-168">hello read-only SQL connection strings will not be impacted as they always point toohello database in hello same region.</span></span> 

<span data-ttu-id="054d4-169">Hello následující diagram znázorňuje hello novou konfiguraci po převzetí služeb při selhání hello.</span><span class="sxs-lookup"><span data-stu-id="054d4-169">hello following diagram illustrates hello new configuration after hello failover.</span></span>

![Konfigurace po převzetí služeb při selhání.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern2-2.png)

<span data-ttu-id="054d4-172">V případě výpadku v jednom z sekundární oblasti hello hello traffic Manageru se automaticky odeberou hello offline koncový bod v této oblasti z hello směrovací tabulky.</span><span class="sxs-lookup"><span data-stu-id="054d4-172">In case of an outage in one of hello secondary regions, hello traffic manager will automatically remove hello offline end-point in that region from hello routing table.</span></span> <span data-ttu-id="054d4-173">Hello replikace kanál toohello sekundární databáze v této oblasti bude pozastaveno.</span><span class="sxs-lookup"><span data-stu-id="054d4-173">hello replication channel toohello secondary database in that region will be suspended.</span></span> <span data-ttu-id="054d4-174">Protože zbývající oblasti hello získat další uživatelské provoz v tomto scénáři, bude ovlivněn výkon aplikace hello během výpadku hello.</span><span class="sxs-lookup"><span data-stu-id="054d4-174">Because hello remaining regions get additional user traffic in this scenario, hello application's performance will be impacted during hello outage.</span></span> <span data-ttu-id="054d4-175">Po výpadku hello zmírnit, hello sekundární databáze v oblasti ovlivněné hello okamžitě synchronizovány se hello primární.</span><span class="sxs-lookup"><span data-stu-id="054d4-175">Once hello outage is mitigated, hello secondary database in hello impacted region will be immediately synchronized with hello primary.</span></span> <span data-ttu-id="054d4-176">Během hello synchronizace výkon hello primární mírně ovlivní v závislosti na hello množství dat, který potřebuje toobe synchronizovány.</span><span class="sxs-lookup"><span data-stu-id="054d4-176">During hello synchronization performance of hello primary could be slightly impacted depending on hello amount of data that needs toobe synchronized.</span></span> <span data-ttu-id="054d4-177">Hello následující diagram znázorňuje výpadku v oblasti B.</span><span class="sxs-lookup"><span data-stu-id="054d4-177">hello following diagram illustrates an outage in region B.</span></span>

![Výpadek v sekundární oblasti.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern2-3.png)

<span data-ttu-id="054d4-180">klíč Hello **využít** tohoto návrhu vzor je, že je možné škálovat hello aplikace zatížení napříč více sekundárních tooachieve hello koncového uživatele optimální výkon.</span><span class="sxs-lookup"><span data-stu-id="054d4-180">hello key **advantage** of this design pattern is that you can scale hello application workload across multiple secondaries tooachieve hello optimal end-user performance.</span></span> <span data-ttu-id="054d4-181">Hello **kompromisy** této možnosti jsou:</span><span class="sxs-lookup"><span data-stu-id="054d4-181">hello **tradeoffs** of this option are:</span></span>

* <span data-ttu-id="054d4-182">Čtení a zápis připojení mezi instancemi aplikace hello a databáze mají různou latenci a náklady</span><span class="sxs-lookup"><span data-stu-id="054d4-182">Read-write connections between hello application instances and database have varying latency and cost</span></span>
* <span data-ttu-id="054d4-183">Během výpadku hello je ovlivněn výkon aplikace</span><span class="sxs-lookup"><span data-stu-id="054d4-183">Application performance is impacted during hello outage</span></span>

> [!NOTE]
> <span data-ttu-id="054d4-184">Podobný postup lze použít toooffload specializuje úlohy, jako například reporting úlohy, nástroje business intelligence nebo zálohování.</span><span class="sxs-lookup"><span data-stu-id="054d4-184">A similar approach can be used toooffload specialized workloads such as reporting jobs, business intelligence tools, or backups.</span></span> <span data-ttu-id="054d4-185">Obvykle se tyto úlohy spotřebovávat prostředky významné databáze proto doporučujeme vyhradit jeden hello sekundární databáze pro ně hello výkonu úrovně odpovídající toohello předpokládaného zatížení.</span><span class="sxs-lookup"><span data-stu-id="054d4-185">Typically, these workloads consume significant database resources therefore it is recommended that you designate one of hello secondary databases for them with hello performance level matched toohello anticipated workload.</span></span>
>

## <a name="design-pattern-3-active-passive-deployment-for-data-preservation"></a><span data-ttu-id="054d4-186">Vzor návrhu 3: nasazení aktivní – pasivní pro uchovávání dat</span><span class="sxs-lookup"><span data-stu-id="054d4-186">Design pattern 3: Active-passive deployment for data preservation</span></span>
<span data-ttu-id="054d4-187">Tato možnost je nejvhodnější pro aplikace s hello následující vlastnosti:</span><span class="sxs-lookup"><span data-stu-id="054d4-187">This option is best suited for applications with hello following characteristics:</span></span>

* <span data-ttu-id="054d4-188">Jakoukoli ztrátu dat, je vysoký obchodní riziko.</span><span class="sxs-lookup"><span data-stu-id="054d4-188">Any data loss is high business risk.</span></span> <span data-ttu-id="054d4-189">Hello databáze převzetí služeb při selhání můžete použít jako poslední možnost jen v případě výpadku hello je závažné.</span><span class="sxs-lookup"><span data-stu-id="054d4-189">hello database failover can only be used as a last resort if hello outage is catastrophic.</span></span>
* <span data-ttu-id="054d4-190">aplikace Hello podporuje jen pro čtení a čtení a zápis režimy operací a můžou fungovat v "režimu jen pro čtení" pro určitou dobu.</span><span class="sxs-lookup"><span data-stu-id="054d4-190">hello application supports read-only and read-write modes of operations and can operate in "read-only mode" for a period of time.</span></span>

<span data-ttu-id="054d4-191">V tomto vzoru aplikace hello přepínačů jen tooread režimu spouštění hello připojení pro čtení a zápis, dochází k chybám časového limitu.</span><span class="sxs-lookup"><span data-stu-id="054d4-191">In this pattern, hello application switches tooread-only mode when hello read-write connections start getting time-out errors.</span></span> <span data-ttu-id="054d4-192">Hello webové aplikace je nasazená tooboth oblasti a zahrnují koncového bodu připojení toohello naslouchací proces pro čtení a zápis a koncového bodu jen pro čtení naslouchací proces toohello jiné připojení.</span><span class="sxs-lookup"><span data-stu-id="054d4-192">hello Web Application is deployed tooboth regions and include a connection toohello read-write listener endpoint and different connection toohello read-only listener endpoint.</span></span> <span data-ttu-id="054d4-193">Hello Traffic manager by měly být nastavené toouse [směrování převzetí služeb při selhání](../traffic-manager/traffic-manager-configure-failover-routing-method.md) s [koncový bod monitorování](../traffic-manager/traffic-manager-monitoring.md) povolené pro koncový bod aplikace hello v každé oblasti.</span><span class="sxs-lookup"><span data-stu-id="054d4-193">hello Traffic manager should be set up toouse [failover routing](../traffic-manager/traffic-manager-configure-failover-routing-method.md) with [end-point monitoring](../traffic-manager/traffic-manager-monitoring.md) enabled for hello application endpoint in each region.</span></span>

<span data-ttu-id="054d4-194">Hello následující diagram znázorňuje tuto konfiguraci před výpadku.</span><span class="sxs-lookup"><span data-stu-id="054d4-194">hello following diagram illustrates this configuration before an outage.</span></span>

![Aktivní – pasivní nasazení před převzetí služeb při selhání.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern3-1.png)

<span data-ttu-id="054d4-197">Zjistí-li hello traffic Manageru tooregion selhání připojení A, automaticky nepřepne instanci aplikace na uživatele provoz toohello v oblasti B. Pomocí tohoto vzoru je důležité nastavit období odkladu hello s ztrátě tooa dostatečně vysoká hodnota dat, například 24 hodin.</span><span class="sxs-lookup"><span data-stu-id="054d4-197">When hello traffic manager detects a connectivity failure tooregion A, it automatically switches user traffic toohello application instance in region B. With this pattern, it is important that you set hello grace period with data loss tooa sufficiently high value, e.g. 24 hours.</span></span> <span data-ttu-id="054d4-198">Bude zajištěno, že ztráty dat je zabráníte zmírnit hello výpadku v této době.</span><span class="sxs-lookup"><span data-stu-id="054d4-198">It will ensure that data loss is prevented if hello outage is mitigated within that time.</span></span> <span data-ttu-id="054d4-199">Když je aktivován hello webové aplikace v oblasti hello B se spustí operace čtení a zápis hello selhání.</span><span class="sxs-lookup"><span data-stu-id="054d4-199">When hello Web application in hello region B is activated hello read-write operations will start failing.</span></span> <span data-ttu-id="054d4-200">V tomto okamžiku se musí přepnout toohello režimu jen pro čtení.</span><span class="sxs-lookup"><span data-stu-id="054d4-200">At that point, it should switch toohello read-only mode.</span></span> <span data-ttu-id="054d4-201">V tento režim hello požadavky budou automaticky směrované toohello sekundární databáze.</span><span class="sxs-lookup"><span data-stu-id="054d4-201">In this mode hello requests will be automatically routed toohello secondary database.</span></span> <span data-ttu-id="054d4-202">V případě závažného selhání hello hello nebude výpadku omezeny v období odkladu hello a převzetí služeb při selhání skupiny hello aktivuje hello převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="054d4-202">In hello case of a catastrophic failure hello outage will not be mitigated within hello grace period and hello failover group will trigger hello failover.</span></span> <span data-ttu-id="054d4-203">Po této hello bude k dispozici naslouchací proces pro čtení a zápis a hello volání tooit přestane selhání.</span><span class="sxs-lookup"><span data-stu-id="054d4-203">After that hello read-write listener will become available and hello calls tooit will stop failing.</span></span> <span data-ttu-id="054d4-204">Tento koncept je znázorněn podle hello následující diagram.</span><span class="sxs-lookup"><span data-stu-id="054d4-204">This is illustrated by hello following diagram.</span></span>

![Výpadek: Aplikace v režimu jen pro čtení.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern3-2.png)

<span data-ttu-id="054d4-207">Pokud v období odkladu hello zmírnit hello výpadku v hello primární oblasti, traffic Manageru zjistí hello obnovení připojení v primární oblasti hello a přepínače instanci aplikace na uživatele provoz back toohello v oblasti A. Tuto instanci aplikace obnoví a funguje v režimu pro čtení a zápis pomocí hello primární databáze v oblasti A.</span><span class="sxs-lookup"><span data-stu-id="054d4-207">If hello outage in hello primary region is mitigated within hello grace period, traffic manager detects hello restoration of connectivity in hello primary region and switches user traffic back toohello application instance in region A. That application instance resumes and operates in read-write mode using hello primary database in region A.</span></span>

<span data-ttu-id="054d4-208">V případě výpadku v oblasti hello B zjistí hello traffic Manageru hello selhání aplikace hello koncový bod v oblasti B a hello převzetí služeb při selhání skupiny přepínačů hello jen pro čtení naslouchací proces tooregion A. Tímto výpadkem neovlivní hello činnost koncového uživatele, ale primární databáze hello zveřejní během výpadku hello.</span><span class="sxs-lookup"><span data-stu-id="054d4-208">In case of an outage in hello region B, hello traffic manager detects hello failure of hello application end-point in region B and hello failover group switches hello read-only listener tooregion A. This outage does not impact hello end-user experience but hello primary database will be exposed during hello outage.</span></span> <span data-ttu-id="054d4-209">Tento koncept je znázorněn podle hello následující diagram.</span><span class="sxs-lookup"><span data-stu-id="054d4-209">This is illustrated by hello following diagram.</span></span>

![Výpadek: Sekundární databáze.](./media/sql-database-designing-cloud-solutions-for-disaster-recovery/pattern3-3.png)

<span data-ttu-id="054d4-212">Po výpadku hello zmírnit, hello sekundární databáze je okamžitě synchronizovány s hello primární a hello jen pro čtení listener je vypnuté back toohello sekundární databáze v oblasti B. Během synchronizace může mít výkon hello primární mírně dopad v závislosti na hello množství dat, který potřebuje toobe synchronizovány.</span><span class="sxs-lookup"><span data-stu-id="054d4-212">Once hello outage is mitigated, hello secondary database is immediately synchronized with hello primary and hello read-only listener is switched back toohello secondary database in region B. During synchronization performance of hello primary could be slightly impacted depending on hello amount of data that needs toobe synchronized.</span></span>

<span data-ttu-id="054d4-213">Tento vzor návrhu má několik **výhody**:</span><span class="sxs-lookup"><span data-stu-id="054d4-213">This design pattern has several **advantages**:</span></span>

* <span data-ttu-id="054d4-214">Ní nedochází ke ztrátě dat při hello dočasných výpadků.</span><span class="sxs-lookup"><span data-stu-id="054d4-214">It avoids data loss during hello temporary outages.</span></span>
* <span data-ttu-id="054d4-215">Výpadek závisí pouze na tom, jak rychle traffic Manageru zjistí hello chybu připojení, které je možné konfigurovat.</span><span class="sxs-lookup"><span data-stu-id="054d4-215">Downtime depends only on how quickly traffic manager detects hello connectivity failure, which is configurable.</span></span>

<span data-ttu-id="054d4-216">Hello **kompromis** je:</span><span class="sxs-lookup"><span data-stu-id="054d4-216">hello **tradeoff** is:</span></span>

* <span data-ttu-id="054d4-217">Aplikace musí být schopný toooperate v režimu jen pro čtení.</span><span class="sxs-lookup"><span data-stu-id="054d4-217">Application must be able toooperate in read-only mode.</span></span>

> [!NOTE]
> <span data-ttu-id="054d4-218">V případě výpadku trvalé služeb v oblasti hello ručně aktivovat převzetí služeb při selhání databáze a přijměte ztráty dat hello.</span><span class="sxs-lookup"><span data-stu-id="054d4-218">In case of a permanent service outage in hello region, you manually activate database failover and accept hello data loss.</span></span> <span data-ttu-id="054d4-219">aplikace Hello bude funkční v sekundární oblasti hello s databází toohello přístup pro čtení a zápis.</span><span class="sxs-lookup"><span data-stu-id="054d4-219">hello application will be functional in hello secondary region with read-write access toohello database.</span></span>
>

## <a name="business-continuity-planning-choose-an-application-design-for-cloud-disaster-recovery"></a><span data-ttu-id="054d4-220">Plánování kontinuity obchodních: Zvolte návrh aplikace pro zotavení po havárii cloudu</span><span class="sxs-lookup"><span data-stu-id="054d4-220">Business continuity planning: Choose an application design for cloud disaster recovery</span></span>
<span data-ttu-id="054d4-221">Strategie zotavení po havárii konkrétní cloudové můžete kombinovat nebo rozšířit tyto vzory návrhu toobest plnění hello potřebám vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="054d4-221">Your specific cloud disaster recovery strategy can combine or extend these design patterns toobest meet hello needs of your application.</span></span>  <span data-ttu-id="054d4-222">Jak už bylo zmíněno dříve, hello strategie, které zvolíte je založena na hello SLA chtít toooffer tooyour zákazníci a hello topologie nasazení aplikace.</span><span class="sxs-lookup"><span data-stu-id="054d4-222">As mentioned earlier, hello strategy you choose is based on hello SLA you want toooffer tooyour customers and hello application deployment topology.</span></span> <span data-ttu-id="054d4-223">toohelp Průvodce vaše rozhodnutí, hello následující tabulka porovnává možnosti hello na základě hello odhadované dat výpadku nebo obnovení cíl bodu (RPO) a obnovení odhadovanou dobu (Vložit).</span><span class="sxs-lookup"><span data-stu-id="054d4-223">toohelp guide your decision, hello following table compares hello choices based on hello estimated data loss or recovery point objective (RPO) and estimated recovery time (ERT).</span></span>

| <span data-ttu-id="054d4-224">vzor</span><span class="sxs-lookup"><span data-stu-id="054d4-224">Pattern</span></span> | <span data-ttu-id="054d4-225">PLÁNOVANÝ BOD OBNOVENÍ</span><span class="sxs-lookup"><span data-stu-id="054d4-225">RPO</span></span> | <span data-ttu-id="054d4-226">VLOŽIT</span><span class="sxs-lookup"><span data-stu-id="054d4-226">ERT</span></span> |
|:--- |:--- |:--- |
| <span data-ttu-id="054d4-227">Aktivní – pasivní nasazení pro zotavení po havárii s přístupem společně umístěné databáze</span><span class="sxs-lookup"><span data-stu-id="054d4-227">Active-passive deployment for disaster recovery with co-located database access</span></span> |<span data-ttu-id="054d4-228">Přístup pro čtení a zápis < 5 s</span><span class="sxs-lookup"><span data-stu-id="054d4-228">Read-write access < 5 sec</span></span> |<span data-ttu-id="054d4-229">Čas detekce selhání + TTL pro DNS</span><span class="sxs-lookup"><span data-stu-id="054d4-229">Failure detection time + DNS TTL</span></span> |
| <span data-ttu-id="054d4-230">Aktivní aktivní nasazení pro aplikaci služby Vyrovnávání zatížení</span><span class="sxs-lookup"><span data-stu-id="054d4-230">Active-active deployment for application load balancing</span></span> |<span data-ttu-id="054d4-231">Přístup pro čtení a zápis < 5 s</span><span class="sxs-lookup"><span data-stu-id="054d4-231">Read-write access < 5 sec</span></span> |<span data-ttu-id="054d4-232">Čas detekce selhání + TTL pro DNS</span><span class="sxs-lookup"><span data-stu-id="054d4-232">Failure detection time + DNS TTL</span></span> |
| <span data-ttu-id="054d4-233">Aktivní – pasivní nasazení pro uchovávání dat</span><span class="sxs-lookup"><span data-stu-id="054d4-233">Active-passive deployment for data preservation</span></span> |<span data-ttu-id="054d4-234">Jen pro čtení. < 5 s</span><span class="sxs-lookup"><span data-stu-id="054d4-234">Read-only access < 5 sec</span></span> | <span data-ttu-id="054d4-235">Jen pro čtení = 0</span><span class="sxs-lookup"><span data-stu-id="054d4-235">Read-only access = 0</span></span> |
||<span data-ttu-id="054d4-236">Přístup pro čtení a zápis = nula.</span><span class="sxs-lookup"><span data-stu-id="054d4-236">Read-write access = zero</span></span> | <span data-ttu-id="054d4-237">Přístup pro čtení a zápis = čas detekce selhání + období odkladu ztráty dat.</span><span class="sxs-lookup"><span data-stu-id="054d4-237">Read-write access = Failure detection time + grace period with data loss</span></span> |
|||

## <a name="next-steps"></a><span data-ttu-id="054d4-238">Další kroky</span><span class="sxs-lookup"><span data-stu-id="054d4-238">Next steps</span></span>
* <span data-ttu-id="054d4-239">toolearn o zálohování Azure SQL Database automatizované, najdete v části [automatizované zálohování SQL Database](sql-database-automated-backups.md)</span><span class="sxs-lookup"><span data-stu-id="054d4-239">toolearn about Azure SQL Database automated backups, see [SQL Database automated backups](sql-database-automated-backups.md)</span></span>
* <span data-ttu-id="054d4-240">Přehled kontinuity obchodních a scénářů najdete v tématu [obchodní kontinuity přehled](sql-database-business-continuity.md)</span><span class="sxs-lookup"><span data-stu-id="054d4-240">For a business continuity overview and scenarios, see [Business continuity overview](sql-database-business-continuity.md)</span></span>
* <span data-ttu-id="054d4-241">toolearn o použití automatizované zálohování pro obnovení, najdete v části [obnovit databázi ze zálohy spouštěná služba hello](sql-database-recovery-using-backups.md)</span><span class="sxs-lookup"><span data-stu-id="054d4-241">toolearn about using automated backups for recovery, see [restore a database from hello service-initiated backups](sql-database-recovery-using-backups.md)</span></span>
* <span data-ttu-id="054d4-242">toolearn o rychlejší možnosti obnovení, najdete v části [aktivní geografickou replikaci](sql-database-geo-replication-overview.md)</span><span class="sxs-lookup"><span data-stu-id="054d4-242">toolearn about faster recovery options, see [active geo-replication](sql-database-geo-replication-overview.md)</span></span>  
* <span data-ttu-id="054d4-243">toolearn o použití automatizované zálohování pro archivaci, najdete v části [kopírování databáze](sql-database-copy.md)</span><span class="sxs-lookup"><span data-stu-id="054d4-243">toolearn about using automated backups for archiving, see [database copy](sql-database-copy.md)</span></span>
* <span data-ttu-id="054d4-244">Informace o aktivní geografickou replikaci s elastické fondy najdete v tématu [strategie zotavení po havárii elastický fond](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span><span class="sxs-lookup"><span data-stu-id="054d4-244">For information about active geo-replication with Elastic Pools, see [Elastic Pool disaster recovery strategies](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span></span>
