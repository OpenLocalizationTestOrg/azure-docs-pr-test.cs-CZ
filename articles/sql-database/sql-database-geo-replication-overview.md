---
title: "Převzetí služeb při selhání skupiny a aktivní geografickou replikaci - Azure SQL Database | Microsoft Docs"
description: "Automatické převzetí služeb při selhání skupiny s aktivní geografickou replikací umožňuje nastavit 4 repliky databáze v některém z Azure datovými centry a autoomatically převzetí služeb při selhání v případě výpadku."
services: sql-database
documentationcenter: na
author: anosov1960
manager: jhubbard
editor: monicar
ms.assetid: 2a29f657-82fb-4283-9a83-e14a144bfd93
ms.service: sql-database
ms.custom: business continuity
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: NA
ms.date: 07/10/2017
ms.author: sashan
ms.openlocfilehash: 9a2171f59c6192115dc1820e7f033fd783c9e077
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/29/2017
---
# <a name="overview-failover-groups-and-active-geo-replication"></a><span data-ttu-id="70e6c-103">Přehled: Převzetí služeb při selhání skupiny a aktivní geografickou replikaci</span><span class="sxs-lookup"><span data-stu-id="70e6c-103">Overview: Failover groups and active geo-replication</span></span>
<span data-ttu-id="70e6c-104">Aktivní geografickou replikaci můžete nakonfigurovat až čtyři čitelný sekundární databáze v umístění center stejný nebo jiný dat (oblastí).</span><span class="sxs-lookup"><span data-stu-id="70e6c-104">Active geo-replication enables you to configure up to four readable secondary databases in the same or different data center locations (regions).</span></span> <span data-ttu-id="70e6c-105">Sekundární databáze jsou k dispozici pro dotazování a převzetí služeb při selhání v případě výpadku datacentra nebo neschopnost se připojit k primární databázi.</span><span class="sxs-lookup"><span data-stu-id="70e6c-105">Secondary databases are available for querying and for failover in the case of a data center outage or the inability to connect to the primary database.</span></span> <span data-ttu-id="70e6c-106">Převzetí služeb při selhání musí ručně zahájit aplikace uživatele.</span><span class="sxs-lookup"><span data-stu-id="70e6c-106">The failover must be initiated manually by the application of the user.</span></span> <span data-ttu-id="70e6c-107">Po převzetí služeb při selhání má nový primární koncový bod jiné připojení.</span><span class="sxs-lookup"><span data-stu-id="70e6c-107">After failover, the new primary has a different connection end-point.</span></span> 

> [!NOTE]
> <span data-ttu-id="70e6c-108">Aktivní geografickou replikací je k dispozici pro všechny databáze na všech úrovních služby ve všech oblastech.</span><span class="sxs-lookup"><span data-stu-id="70e6c-108">Active geo-replication is available for all databases in all service tiers in all regions.</span></span>
>  

<span data-ttu-id="70e6c-109">Automatické převzetí služeb při selhání skupiny Azure SQL Database (-preview) je navržená tak, aby automaticky spravovat relace geografická replikace, připojení a převzetí služeb při selhání ve velkém měřítku funkce SQL Database.</span><span class="sxs-lookup"><span data-stu-id="70e6c-109">Azure SQL Database auto-failover groups (in-preview) is a SQL Database feature designed to automatically manage geo-replication relationship, connectivity, and failover at scale.</span></span> <span data-ttu-id="70e6c-110">Pomocí něho zákazníků získáte možnost automaticky obnovit více souvisejících databáze v sekundární oblasti po závažné regionální chyby nebo další neplánované události, které dojít ke ztrátě úplné nebo částečné dostupnosti služby SQL Database v primární oblasti.</span><span class="sxs-lookup"><span data-stu-id="70e6c-110">With it, the customers gain the ability to automatically recover multiple related databases in the secondary region after catastrophic regional failures or other unplanned events that result in full or partial loss of the SQL Database service’s availability in the primary region.</span></span> <span data-ttu-id="70e6c-111">Kromě toho použitím čitelný sekundární databáze k přesměrování zpracování úlohy jen pro čtení.</span><span class="sxs-lookup"><span data-stu-id="70e6c-111">Additionally, they can use the readable secondary databases to offload read-only workloads.</span></span>  <span data-ttu-id="70e6c-112">Protože skupiny automatické převzetí služeb při selhání zahrnují více databází musí být nakonfigurované na primárním serveru.</span><span class="sxs-lookup"><span data-stu-id="70e6c-112">Because auto-failover groups involve multiple databases they must be configured on the primary server.</span></span> <span data-ttu-id="70e6c-113">Primární a sekundární servery musí být ve stejném předplatném.</span><span class="sxs-lookup"><span data-stu-id="70e6c-113">Both primary and secondary servers must be in the same subscription.</span></span> <span data-ttu-id="70e6c-114">Automatické převzetí služeb při selhání skupiny podporují replikace všech databází ve skupině jenom jedné sekundární server v jiné oblasti.</span><span class="sxs-lookup"><span data-stu-id="70e6c-114">Auto-failover groups support replication of all databases in the group to only one secondary server in a different region.</span></span> <span data-ttu-id="70e6c-115">Aktivní geografickou replikaci, bez skupiny automatické převzetí služeb při selhání umožňuje až 4 sekundární databáze v libovolné oblasti.</span><span class="sxs-lookup"><span data-stu-id="70e6c-115">Active geo-replication, without auto-failover groups, allows up to 4 secondaries in any region.</span></span>

<span data-ttu-id="70e6c-116">Pokud používáte aktivní geografickou replikaci a z některého důvodu vaše selže primární databáze nebo jednoduše do režimu offline, můžete spustit převzetí služeb při selhání k žádné ze sekundárních databází.</span><span class="sxs-lookup"><span data-stu-id="70e6c-116">If you are using active geo-replication and for any reason your primary database fails, or simply needs to be taken offline, you can initiate failover to any of your secondary databases.</span></span> <span data-ttu-id="70e6c-117">Při převzetí služeb při selhání se aktivuje na jednu sekundární databáze, všechny ostatní sekundární repliky jsou automaticky propojení se nový primární.</span><span class="sxs-lookup"><span data-stu-id="70e6c-117">When failover is activated to one of the secondary databases, all other secondaries are automatically linked to the new primary.</span></span> <span data-ttu-id="70e6c-118">Pokud používáte skupiny automatické převzetí služeb při selhání (v preview) ke správě obnovení databáze a všechny výpadek, který má dopad na jeden nebo několik databází ve výsledcích skupiny v automatické převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="70e6c-118">If you are using auto-failover groups (in-preview) to manage database recovery and any outage that impacts one or several of the databases in the group results in automatic failover.</span></span> <span data-ttu-id="70e6c-119">Můžete nakonfigurovat zásady automatické převzetí služeb při selhání, který bude nejlépe vyhovovat potřebám vaší aplikace, nebo můžete odhlásit a použít ruční aktivaci.</span><span class="sxs-lookup"><span data-stu-id="70e6c-119">You can configure the auto-failover policy that best meets your application needs, or you can opt out and use manual activation.</span></span> <span data-ttu-id="70e6c-120">Kromě toho skupiny automatické převzetí služeb při selhání (v preview) nabízí pro čtení a zápis a koncových bodů naslouchání jen pro čtení, které zůstanou beze změny během převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="70e6c-120">In addition, auto-failover groups (in-preview) provide read-write and read-only listener end-points that remain unchanged during failovers.</span></span> <span data-ttu-id="70e6c-121">Při použití aktivace ruční nebo automatické převzetí služeb při selhání, převzetí služeb při selhání primární přepne všechny sekundární databáze ve skupině.</span><span class="sxs-lookup"><span data-stu-id="70e6c-121">Whether you use manual or automatic failover activation, failover switches all secondary databases in the group to primary.</span></span> <span data-ttu-id="70e6c-122">Po dokončení převzetí služeb při selhání databázi se automaticky aktualizuje záznam DNS pro přesměrování koncových bodů pro novou oblast.</span><span class="sxs-lookup"><span data-stu-id="70e6c-122">After the database failover is completed, the DNS record is automatically updated to redirect the end-points to the new region.</span></span>

<span data-ttu-id="70e6c-123">Můžete spravovat replikace a převzetí služeb při selhání může jedna databáze nebo sada databází na serveru nebo ve fondu elastické databáze používá aktivní geografickou replikaci.</span><span class="sxs-lookup"><span data-stu-id="70e6c-123">You can manage replication and failover of an individual database or a set of databases on a server or in an elastic pool using active geo-replication.</span></span> <span data-ttu-id="70e6c-124">Můžete to, že pomocí [portál Azure](sql-database-geo-replication-portal.md), [prostředí PowerShell](sql-database-geo-replication-powershell.md), [Transact-SQL](sql-database-geo-replication-transact-sql.md), nebo [REST API](https://msdn.microsoft.com/library/azure/mt163685.aspx).</span><span class="sxs-lookup"><span data-stu-id="70e6c-124">You can do that using the [Azure portal](sql-database-geo-replication-portal.md), [PowerShell](sql-database-geo-replication-powershell.md), [Transact-SQL](sql-database-geo-replication-transact-sql.md), or the [REST API](https://msdn.microsoft.com/library/azure/mt163685.aspx).</span></span> <span data-ttu-id="70e6c-125">Po převzetí služeb při selhání Ujistěte se, že požadavky na ověřování pro server a databáze jsou nakonfigurovány na nový primární.</span><span class="sxs-lookup"><span data-stu-id="70e6c-125">After failover, ensure the authentication requirements for your server and database are configured on the new primary.</span></span> <span data-ttu-id="70e6c-126">Podrobnosti najdete v tématu [zabezpečení SQL Database po zotavení po havárii](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="70e6c-126">For details, see [SQL Database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span> <span data-ttu-id="70e6c-127">To platí i na aktivní skupiny geografická replikace a automatické převzetí služeb při selhání (v preview).</span><span class="sxs-lookup"><span data-stu-id="70e6c-127">This applies both to active geo-replication and auto-failover groups (in-preview).</span></span>

<span data-ttu-id="70e6c-128">Využívá aktivní geografickou replikací [Always On](https://docs.microsoft.com/sql/database-engine/availability-groups/windows/overview-of-always-on-availability-groups-sql-server) technologii SQL serveru na asynchronně replikovat potvrzené transakce v databázi primární na sekundární databázi pomocí číst izolaci snímku potvrdit (RCSI).</span><span class="sxs-lookup"><span data-stu-id="70e6c-128">Active geo-replication leverages the [Always On](https://docs.microsoft.com/sql/database-engine/availability-groups/windows/overview-of-always-on-availability-groups-sql-server) technology of SQL Server to asynchronously replicate committed transactions on the primary database to a secondary database using read committed snapshot isolation (RCSI).</span></span> <span data-ttu-id="70e6c-129">Automatické převzetí služeb při selhání skupiny poskytují sémantiku skupiny nad aktivní geografickou replikaci, ale se používá stejný mechanismus asynchronní replikaci.</span><span class="sxs-lookup"><span data-stu-id="70e6c-129">Auto-failover groups provide the group semantics on top of active geo-replication but the same asynchronous replication mechanism is used.</span></span> <span data-ttu-id="70e6c-130">V libovolném časovém okamžiku sekundární databáze může být mírně za primární databázi, sekundární data záruku, že se nikdy mít částečné transakce.</span><span class="sxs-lookup"><span data-stu-id="70e6c-130">While at any given point, the secondary database might be slightly behind the primary database, the secondary data is guaranteed to never have partial transactions.</span></span> <span data-ttu-id="70e6c-131">Mezi oblastmi redundance umožňuje aplikacím rychle zotavit trvalé ztrátě celého datového centra nebo částí datacentru způsobené přírodní katastrofy, lidské chyby závažné nebo škodlivý jednání.</span><span class="sxs-lookup"><span data-stu-id="70e6c-131">Cross-region redundancy enables applications to quickly recover from a permanent loss of an entire datacenter or parts of a datacenter caused by natural disasters, catastrophic human errors, or malicious acts.</span></span> <span data-ttu-id="70e6c-132">Konkrétní data plánovaný bod obnovení naleznete na adrese [přehled kontinuity podnikových procesů](sql-database-business-continuity.md).</span><span class="sxs-lookup"><span data-stu-id="70e6c-132">The specific RPO data can be found at [Overview of Business Continuity](sql-database-business-continuity.md).</span></span>

<span data-ttu-id="70e6c-133">Následující obrázek znázorňuje příklad aktivní geografickou replikací nakonfigurované s primární v oblasti severní jihu USA a sekundární v oblasti jihu USA.</span><span class="sxs-lookup"><span data-stu-id="70e6c-133">The following figure shows an example of active geo-replication configured with a primary in the North Central US region and secondary in the South Central US region.</span></span>

![geografická replikace relace](./media/sql-database-active-geo-replication/geo-replication-relationship.png)

<span data-ttu-id="70e6c-135">Protože jsou čitelný sekundární databáze, můžete použít k přesměrování zpracování úlohy jen pro čtení, například úlohy sestav.</span><span class="sxs-lookup"><span data-stu-id="70e6c-135">Because the secondary databases are readable, they can be used to offload read-only workloads such as reporting jobs.</span></span> <span data-ttu-id="70e6c-136">Pokud používáte aktivní geografickou replikaci, je možné vytvořit sekundární databázi ve stejné oblasti s primární, ale nezvyšuje aplikace odolnost proti závažné selhání.</span><span class="sxs-lookup"><span data-stu-id="70e6c-136">If you are using active geo-replication, it is possible to create the secondary database in the same region with the primary, but it does not increase the application's resilience to catastrophic failures.</span></span> <span data-ttu-id="70e6c-137">Pokud používáte skupiny automatické převzetí služeb při selhání (v preview), je vždy vytvořit sekundární databáze v jiné oblasti.</span><span class="sxs-lookup"><span data-stu-id="70e6c-137">If you are using auto-failover groups (in-preview), your secondary database is always created in a different region.</span></span>

<span data-ttu-id="70e6c-138">Kromě po havárii obnovení aktivní geografickou replikaci lze použít v následujících scénářích:</span><span class="sxs-lookup"><span data-stu-id="70e6c-138">In addition to disaster recovery active geo-replication can be used in the following scenarios:</span></span>

* <span data-ttu-id="70e6c-139">**Migrace databáze**: aktivní geografickou replikaci můžete použít k migraci databáze z jednoho serveru na jiný online s minimální výpadky.</span><span class="sxs-lookup"><span data-stu-id="70e6c-139">**Database migration**: You can use active geo-replication to migrate a database from one server to another online with minimum downtime.</span></span>
* <span data-ttu-id="70e6c-140">**Upgrady aplikací**: můžete vytvořit další sekundární jako kopii back selhání během upgradů aplikací.</span><span class="sxs-lookup"><span data-stu-id="70e6c-140">**Application upgrades**: You can create an extra secondary as a fail back copy during application upgrades.</span></span>

<span data-ttu-id="70e6c-141">Přidání redundance databáze mezi datovými centry je zajistit skutečné provozní kontinuitu pouze část řešení.</span><span class="sxs-lookup"><span data-stu-id="70e6c-141">To achieve real business continuity, adding database redundancy between datacenters is only part of the solution.</span></span> <span data-ttu-id="70e6c-142">Aplikaci (služba) na kompletní obnovení po závažné chybě vyžaduje obnovení všechny součásti, které tvoří službu a všechny závislé služby.</span><span class="sxs-lookup"><span data-stu-id="70e6c-142">Recovering an application (service) end-to-end after a catastrophic failure requires recovery of all components that constitute the service and any dependent services.</span></span> <span data-ttu-id="70e6c-143">Všechny tyto komponenty příklady klientský software (například prohlížeč s vlastní JavaScript), webové servery front-end, úložiště a DNS.</span><span class="sxs-lookup"><span data-stu-id="70e6c-143">Examples of these components include the client software (for example, a browser with a custom JavaScript), web front ends, storage, and DNS.</span></span> <span data-ttu-id="70e6c-144">Je důležité, aby všechny součásti jsou odolné vůči selhání stejné a bude k dispozici v rámci cíli času obnovení (RTO) vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="70e6c-144">It is critical that all components are resilient to the same failures and become available within the recovery time objective (RTO) of your application.</span></span> <span data-ttu-id="70e6c-145">Proto musíte určit všechny závislé služby a porozumět záruky a možnosti, které poskytují.</span><span class="sxs-lookup"><span data-stu-id="70e6c-145">Therefore, you need to identify all dependent services and understand the guarantees and capabilities they provide.</span></span> <span data-ttu-id="70e6c-146">Pak musíte provést odpovídající kroky zajistit, aby funkcí služby během převzetí služeb při selhání služeb, na kterých závisí.</span><span class="sxs-lookup"><span data-stu-id="70e6c-146">Then, you must take adequate steps to ensure that your service functions during the failover of the services on which it depends.</span></span> <span data-ttu-id="70e6c-147">Další informace o návrhu řešení pro zotavení po havárii, najdete v části [návrhu cloudové řešení pro obnovení po havárii pomocí aktivní geografickou replikaci](sql-database-designing-cloud-solutions-for-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="70e6c-147">For more information about designing solutions for disaster recovery, see [Designing Cloud Solutions for Disaster Recovery Using active geo-replication](sql-database-designing-cloud-solutions-for-disaster-recovery.md).</span></span>

## <a name="active-geo-replication-capabilities"></a><span data-ttu-id="70e6c-148">Možnosti aktivní geografickou replikaci</span><span class="sxs-lookup"><span data-stu-id="70e6c-148">Active geo-replication capabilities</span></span>
<span data-ttu-id="70e6c-149">Tato funkce aktivní geografickou replikací poskytuje následující základní možnosti:</span><span class="sxs-lookup"><span data-stu-id="70e6c-149">The active geo-replication feature provides the following essential capabilities:</span></span>
* <span data-ttu-id="70e6c-150">**Automatické asynchronní replikaci**: přidáním k existující databázi lze vytvořit pouze sekundární databáze.</span><span class="sxs-lookup"><span data-stu-id="70e6c-150">**Automatic Asynchronous Replication**: You can only create a secondary database by adding to an existing database.</span></span> <span data-ttu-id="70e6c-151">Sekundární lze vytvořit v jakékoli serveru Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="70e6c-151">The secondary can be created in any Azure SQL Database server.</span></span> <span data-ttu-id="70e6c-152">Po vytvoření se zobrazí v sekundární databázi daty zkopírovanými z primární databáze.</span><span class="sxs-lookup"><span data-stu-id="70e6c-152">Once created, the secondary database is populated with the data copied from the primary database.</span></span> <span data-ttu-id="70e6c-153">Tento proces se označuje jako synchronizace replik indexů.</span><span class="sxs-lookup"><span data-stu-id="70e6c-153">This process is known as seeding.</span></span> <span data-ttu-id="70e6c-154">Po sekundární databáze byla vytvořena a nasadí, aktualizace primární databázi se asynchronně replikují do sekundární databáze automaticky.</span><span class="sxs-lookup"><span data-stu-id="70e6c-154">After secondary database has been created and seeded, updates to the primary database are asynchronously replicated to the secondary database automatically.</span></span> <span data-ttu-id="70e6c-155">Asynchronní replikaci znamená, že transakce jsou potvrzeno u primární databázi, předtím, než se replikují do sekundární databáze.</span><span class="sxs-lookup"><span data-stu-id="70e6c-155">Asynchronous replication means that transactions are committed on the primary database before they are replicated to the secondary database.</span></span> 
* <span data-ttu-id="70e6c-156">**Čitelný sekundární databáze**: aplikace, můžete přístup k sekundární databázi operacím jen pro čtení pomocí objekty zabezpečení stejný nebo jiný používá pro přístup k primární databázi.</span><span class="sxs-lookup"><span data-stu-id="70e6c-156">**Readable secondary databases**: An application can access a secondary database for read-only operations using the same or different security principals used for accessing the primary database.</span></span> <span data-ttu-id="70e6c-157">Sekundární databáze v režimu izolace snímku zajistit replikaci aktualizací primární (protokol opětovného přehrání) není zpožděn dotazy spouštěné na sekundárním fungovat.</span><span class="sxs-lookup"><span data-stu-id="70e6c-157">The secondary databases operate in snapshot isolation mode to ensure replication of the updates of the primary (log replay) is not delayed by queries executed on the secondary.</span></span>

   > [!NOTE]
   > <span data-ttu-id="70e6c-158">Protokol opětovného přehrání je zpožděno v sekundární databázi. Pokud existují aktualizace schémat, které přijímá z primární, které vyžadují zámek schématu v sekundární databázi.</span><span class="sxs-lookup"><span data-stu-id="70e6c-158">The log replay is delayed on the secondary database if there are schema updates that it is receiving from the Primary that require a schema lock on the secondary database.</span></span> 
   > 

* <span data-ttu-id="70e6c-159">**Více čitelný sekundární repliky**: dvě nebo více sekundárních databází zvýšit redundance a úroveň ochrany pro primární databáze a aplikace.</span><span class="sxs-lookup"><span data-stu-id="70e6c-159">**Multiple readable secondaries**: Two or more secondary databases increase redundancy and level of protection for the primary database and application.</span></span> <span data-ttu-id="70e6c-160">Existuje více sekundární databáze, i nadále aplikace chráněn, i když dojde k selhání jednoho sekundární databáze.</span><span class="sxs-lookup"><span data-stu-id="70e6c-160">If multiple secondary databases exist, the application remains protected even if one of the secondary databases fails.</span></span> <span data-ttu-id="70e6c-161">Pokud existuje pouze jedna sekundární databáze, a se nezdaří, aplikace je vystaven vyšší riziko teprve po vytvoření nové sekundární databáze.</span><span class="sxs-lookup"><span data-stu-id="70e6c-161">If there is only one secondary database, and it fails, the application is exposed to higher risk until a new secondary database is created.</span></span>

   > [!NOTE]
   > <span data-ttu-id="70e6c-162">Pokud používáte aktivní geografickou replikací sestavení globálně distribuované aplikace a muset poskytnout přístup jen pro čtení k datům v oblastech více než 4, můžete vytvořit sekundární sekundární (Tento proces se označuje jako řetězení).</span><span class="sxs-lookup"><span data-stu-id="70e6c-162">If you are using active geo-replication to build a globally distributed application and need to provide read-only access to data in more than 4 regions, you can create secondary of a secondary (a process known as chaining).</span></span> <span data-ttu-id="70e6c-163">Tímto způsobem můžete dosáhnout prakticky neomezené škálování replikace databáze.</span><span class="sxs-lookup"><span data-stu-id="70e6c-163">This way you can achieve virtually unlimited scale of database replication.</span></span> <span data-ttu-id="70e6c-164">Kromě toho řetězení snižuje zatížení replikace z primární databáze.</span><span class="sxs-lookup"><span data-stu-id="70e6c-164">In addition, chaining reduces the overhead of replication from the primary database.</span></span> <span data-ttu-id="70e6c-165">O kompromisu je prodleva vyšší replikace na listu většinu sekundární databáze.</span><span class="sxs-lookup"><span data-stu-id="70e6c-165">The trade-off is the increased replication lag on the leaf-most secondary databases.</span></span> <span data-ttu-id="70e6c-166">.</span><span class="sxs-lookup"><span data-stu-id="70e6c-166">.</span></span> 
   >

* <span data-ttu-id="70e6c-167">**Podpora fondu elastické databáze**: aktivní geografickou replikací je možné nakonfigurovat pro všechny databáze v každém elastického fondu.</span><span class="sxs-lookup"><span data-stu-id="70e6c-167">**Support of elastic pool databases**: Active geo-replication can be configured for any database in any elastic pool.</span></span> <span data-ttu-id="70e6c-168">Sekundární databáze může být v jiném elastického fondu.</span><span class="sxs-lookup"><span data-stu-id="70e6c-168">The secondary database can be in another elastic pool.</span></span> <span data-ttu-id="70e6c-169">Pro normální databáze lze sekundární elastický fond a naopak naopak tak dlouho, dokud úrovně služeb jsou stejné.</span><span class="sxs-lookup"><span data-stu-id="70e6c-169">For regular databases, the secondary can be an elastic pool and vice versa as long as the service tiers are the same.</span></span> 
* <span data-ttu-id="70e6c-170">**Úroveň výkonu konfigurovat sekundární databáze**: sekundární databáze se dají vytvořit s nižší úroveň výkonu než primární.</span><span class="sxs-lookup"><span data-stu-id="70e6c-170">**Configurable performance level of the secondary database**: A secondary database can be created with lower performance level than the primary.</span></span> <span data-ttu-id="70e6c-171">Primární i sekundární databáze musí mít stejnou vrstvu služeb.</span><span class="sxs-lookup"><span data-stu-id="70e6c-171">Both primary and secondary databases are required to have the same service tier.</span></span> <span data-ttu-id="70e6c-172">Tato možnost není doporučeno pro aplikace s aktivitou write vysoké databáze, protože vyšší replikace funkce lag zvyšuje riziko ztráty významné dat po selhání.</span><span class="sxs-lookup"><span data-stu-id="70e6c-172">This option is not recommended for applications with high database write activity because the increased replication lag increases the risk of substantial data loss after a failover.</span></span> <span data-ttu-id="70e6c-173">Kromě toho po převzetí služeb při selhání aplikace je ovlivněn výkon dokud nový primární je upgrade na vyšší úroveň výkonu.</span><span class="sxs-lookup"><span data-stu-id="70e6c-173">In addition, after failover the application’s performance is impacted until the new primary is upgraded to a higher performance level.</span></span> <span data-ttu-id="70e6c-174">Graf procento vstupně-výstupní operace protokolu na portál Azure poskytuje vhodný způsob, jak odhad úrovně výkonu minimální sekundární, který je požadován pro udržení zatížení replikace.</span><span class="sxs-lookup"><span data-stu-id="70e6c-174">The log IO percentage chart on Azure portal provides a good way to estimate the minimal performance level of the secondary that is required to sustain the replication load.</span></span> <span data-ttu-id="70e6c-175">Například, pokud je primární databáze P6 (1 000 DTU) a protokol vstupně-výstupní operace v procentech je 50 % sekundární musí být alespoň P4 (500 DTU).</span><span class="sxs-lookup"><span data-stu-id="70e6c-175">For example, if your Primary database is P6 (1000 DTU) and its log IO percent is 50% the secondary needs to be at least P4 (500 DTU).</span></span> <span data-ttu-id="70e6c-176">Můžete také načíst data protokolu vstupně-výstupní operace s využitím [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) nebo [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx) databáze zobrazení.</span><span class="sxs-lookup"><span data-stu-id="70e6c-176">You can also retrieve the log IO data using [sys.resource_stats](https://msdn.microsoft.com/library/dn269979.aspx) or [sys.dm_db_resource_stats](https://msdn.microsoft.com/library/dn800981.aspx) database views.</span></span>  <span data-ttu-id="70e6c-177">Další informace o úrovně výkonu databáze SQL najdete v tématu [výkon a možnosti databáze SQL](sql-database-service-tiers.md).</span><span class="sxs-lookup"><span data-stu-id="70e6c-177">For more information on the SQL Database performance levels, see [SQL Database options and performance](sql-database-service-tiers.md).</span></span> 
* <span data-ttu-id="70e6c-178">**Uživatelem řízená převzetí služeb při selhání a navrácení služeb po obnovení**: sekundární databáze je explicitně možné přepnout do primární role kdykoli aplikace nebo uživatele.</span><span class="sxs-lookup"><span data-stu-id="70e6c-178">**User-controlled failover and failback**: A secondary database can explicitly be switched to the primary role at any time by the application or the user.</span></span> <span data-ttu-id="70e6c-179">Během výpadku skutečné možnost "neplánované" by měl použít, která okamžitě zvýší úroveň sekundárního jako primární.</span><span class="sxs-lookup"><span data-stu-id="70e6c-179">During a real outage the “unplanned” option should be used, which immediately promotes a secondary to be the primary.</span></span> <span data-ttu-id="70e6c-180">Při selhání primární obnoví a opět k dispozici, systém automaticky označí jako sekundární obnovené primární a převeďte ho do aktuální s nový primární.</span><span class="sxs-lookup"><span data-stu-id="70e6c-180">When the failed primary recovers and is available again, the system automatically marks the recovered primary as a secondary and bring it up-to-date with the new primary.</span></span> <span data-ttu-id="70e6c-181">Vzhledem k asynchronní povaze replikace malé množství dat může dojít ke ztrátě během neplánované převzetí služeb při selhání před replikuje nejnovější změny sekundární selže primární.</span><span class="sxs-lookup"><span data-stu-id="70e6c-181">Due to the asynchronous nature of replication, a small amount of data can be lost during unplanned failovers if a primary fails before it replicates the most recent changes to the secondary.</span></span> <span data-ttu-id="70e6c-182">Při selhání primárního serveru s více sekundárních systém automaticky změní konfiguraci relace replikace a propojuje zbývající sekundární repliky na nově propagovaných primární bez nutnosti zásahu uživatele.</span><span class="sxs-lookup"><span data-stu-id="70e6c-182">When a primary with multiple secondaries fails over, the system automatically reconfigures the replication relationships and links the remaining secondaries to the newly promoted primary without requiring any user intervention.</span></span> <span data-ttu-id="70e6c-183">Jakmile se výpadek, která způsobila, že převzetí služeb při selhání zmírnit, může být žádoucí návrat aplikace na primární oblasti.</span><span class="sxs-lookup"><span data-stu-id="70e6c-183">After the outage that caused the failover is mitigated, it may be desirable to return the application to the primary region.</span></span> <span data-ttu-id="70e6c-184">Kvůli tomu by měla být volána příkaz převzetí služeb při selhání s parametrem "plánované".</span><span class="sxs-lookup"><span data-stu-id="70e6c-184">To do that, the failover command should be invoked with the “planned” option.</span></span> 
* <span data-ttu-id="70e6c-185">**Udržování synchronizace přihlašovacích údajů a pravidel brány firewall**: doporučujeme používat [databáze pravidla brány firewall](sql-database-firewall-configure.md) pro geograficky replikované databáze, takže tato pravidla je možné replikovat s databází a zkontrolujte všechny sekundární databáze stejná pravidla brány firewall jako primární.</span><span class="sxs-lookup"><span data-stu-id="70e6c-185">**Keeping credentials and firewall rules in sync**: We recommend using [database firewall rules](sql-database-firewall-configure.md) for geo-replicated databases so these rules can be replicated with the database to ensure all secondary databases have the same firewall rules as the primary.</span></span> <span data-ttu-id="70e6c-186">Tento přístup eliminuje potřebu zákazníkům ručně konfigurovat a spravovat pravidla brány firewall na servery, které hostují jak primární a sekundární databáze.</span><span class="sxs-lookup"><span data-stu-id="70e6c-186">This approach eliminates the need for customers to manually configure and maintain firewall rules on servers hosting both the primary and secondary databases.</span></span> <span data-ttu-id="70e6c-187">Podobně [obsažené uživatelů databáze](sql-database-manage-logins.md) pro data přístup zajišťuje primární i sekundární databáze mají vždy stejné přihlašovací údaje uživatele, takže během převzetí služeb při selhání není k dispozici žádné přerušení z důvodu neshody s jména a hesla.</span><span class="sxs-lookup"><span data-stu-id="70e6c-187">Similarly, using [contained database users](sql-database-manage-logins.md) for data access ensures both primary and secondary databases always have the same user credentials so during a failover, there is no disruptions due to mismatches with logins and passwords.</span></span> <span data-ttu-id="70e6c-188">Po přidání [Azure Active Directory](../active-directory/active-directory-whatis.md), zákazníků můžete spravovat přístup uživatelů k primární i sekundární databáze a odstraňuje potřebu správy pověření v databázích úplně.</span><span class="sxs-lookup"><span data-stu-id="70e6c-188">With the addition of [Azure Active Directory](../active-directory/active-directory-whatis.md), customers can manage user access to both primary and secondary databases and eliminating the need for managing credentials in databases altogether.</span></span>

## <a name="auto-failover-group-capabilities"></a><span data-ttu-id="70e6c-189">Možnosti skupiny-automatické převzetí služeb při selhání</span><span class="sxs-lookup"><span data-stu-id="70e6c-189">Auto-failover group capabilities</span></span>

<span data-ttu-id="70e6c-190">Funkce skupiny-automatické převzetí služeb při selhání poskytuje výkonné abstrakce aktivní geografickou replikací podporou úrovně replikační skupiny a automatické převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="70e6c-190">Auto-failover groups feature provides a powerful abstraction of active geo-replication by supporting group level replication and automatic failover.</span></span> <span data-ttu-id="70e6c-191">Kromě toho se odeberou nezbytné, chcete-li změnit připojovací řetězec SQL po převzetí služeb při selhání tím, že poskytuje další naslouchací proces koncových bodů.</span><span class="sxs-lookup"><span data-stu-id="70e6c-191">In addition, it removes the necessity to change the SQL connection string after failover by providing the additional listener end-points.</span></span> 

* <span data-ttu-id="70e6c-192">**Převzetí služeb při selhání skupiny**: jednu nebo více skupin převzetí služeb při selhání můžete vytvořit mezi dvěma servery v různých oblastech (primární a sekundární servery).</span><span class="sxs-lookup"><span data-stu-id="70e6c-192">**Failover group**: One or many failover groups can be created between two servers in different regions (primary and secondary servers).</span></span> <span data-ttu-id="70e6c-193">Každá skupina může obsahovat jednu nebo několik databází, které se obnoví jako jednotku, v případě, že všechny nebo některé primární databáze k dispozici z důvodu výpadku v primární oblasti.</span><span class="sxs-lookup"><span data-stu-id="70e6c-193">Each group can include one or several databases that are recovered as a unit in case all or some primary databases become unavailable due to an outage in the primary region.</span></span>  
* <span data-ttu-id="70e6c-194">**Primární server**: server, který je hostitelem primární databází ve skupině převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="70e6c-194">**Primary server**: A server that hosts the primary databases in the failover group.</span></span>
* <span data-ttu-id="70e6c-195">**Sekundární server**: server, který je hostitelem sekundární databází ve skupině převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="70e6c-195">**Secondary server**: A server that hosts the secondary databases in the failover group.</span></span> <span data-ttu-id="70e6c-196">Sekundární server nemůže být ve stejné oblasti jako primární server.</span><span class="sxs-lookup"><span data-stu-id="70e6c-196">The secondary server cannot be in the same region as the primary server.</span></span>
* <span data-ttu-id="70e6c-197">**Přidávání databází do převzetí služeb při selhání skupiny**: několik databází v rámci serveru nebo fondu elastické databáze můžete vložit do stejné skupiny převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="70e6c-197">**Adding databases to failover group**: You can put several databases within a server or within an elastic pool into the same failover group.</span></span> <span data-ttu-id="70e6c-198">Pokud přidáte samostatná databáze ke skupině, automaticky vytvoří sekundární databáze pomocí stejného vydání a úroveň výkonu.</span><span class="sxs-lookup"><span data-stu-id="70e6c-198">If you add a standalone database to the group, it automatically creates a secondary database using the same edition and performance level.</span></span> <span data-ttu-id="70e6c-199">Pokud je primární databází v elastickém fondu, sekundární je automaticky vytvořen ve elastický fond se stejným názvem.</span><span class="sxs-lookup"><span data-stu-id="70e6c-199">If the primary database is in an elastic pool, the secondary is automatically created in the elastic pool with the same name.</span></span> <span data-ttu-id="70e6c-200">Pokud přidáte databázi, která už má sekundární databáze v sekundárním serveru, geografická replikace zdědí skupině.</span><span class="sxs-lookup"><span data-stu-id="70e6c-200">If you add a database that already has a secondary database in the secondary server, that geo-replication is inherited by the group.</span></span>

   > [!NOTE]
   > <span data-ttu-id="70e6c-201">Při přidávání databázi, která už má sekundární databáze na serveru, který není součástí skupiny převzetí služeb při selhání, se vytvoří nový sekundární v sekundárním serveru.</span><span class="sxs-lookup"><span data-stu-id="70e6c-201">When adding a database that already has a secondary database in a server that is not part of the failover group, a new secondary is created in the secondary server.</span></span> 
   >

* <span data-ttu-id="70e6c-202">**Naslouchací proces pro čtení a zápis převzetí služeb při selhání skupiny**: záznam DNS CNAME je vytvořen jako  **&lt;název skupiny pro převzetí služeb při selhání&gt;. database.windows.net** který odkazuje na adresu URL aktuální primární server.</span><span class="sxs-lookup"><span data-stu-id="70e6c-202">**Failover group read-write listener**: A DNS CNAME record formed as **&lt;failover-group-name&gt;.database.windows.net** that points to the current primary server URL.</span></span> <span data-ttu-id="70e6c-203">To umožňuje aplikacím SQL pro čtení a zápis se transparentně znovu připojit k primární databázi, když se změní primární po převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="70e6c-203">It allows the read-write SQL applications to transparently reconnect to the primary database when the primary changes after failover.</span></span> 
* <span data-ttu-id="70e6c-204">**Převzetí služeb při selhání jen pro čtení naslouchací proces skupiny**: záznam DNS CNAME je vytvořen jako  **&lt;název skupiny pro převzetí služeb při selhání&gt;. secondary.database.windows.net** který odkazuje na adresu URL na sekundární server.</span><span class="sxs-lookup"><span data-stu-id="70e6c-204">**Failover group read-only listener**: A DNS CNAME record formed as **&lt;failover-group-name&gt;.secondary.database.windows.net** that points to the secondary server’s URL.</span></span> <span data-ttu-id="70e6c-205">To umožňuje aplikacím SQL jen pro čtení transparentně připojit k sekundární databázi pomocí zadaného pravidla Vyrovnávání zatížení.</span><span class="sxs-lookup"><span data-stu-id="70e6c-205">It allows the read-only SQL applications to transparently connect to the secondary database using the specified load-balancing rules.</span></span> <span data-ttu-id="70e6c-206">Volitelně můžete zadat, pokud chcete jen pro čtení provozu, který se automaticky znovu směrovanou na primární server, když sekundární server není k dispozici.</span><span class="sxs-lookup"><span data-stu-id="70e6c-206">Optionally you can specify if you want the read-only traffic to be automatically re-directed to the primary server when the secondary server is not available.</span></span>
* <span data-ttu-id="70e6c-207">**Zásady automatické převzetí služeb při selhání**: ve výchozím nastavení je skupině převzetí služeb při selhání nakonfigurovaná pomocí zásad automatické převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="70e6c-207">**Automatic failover policy**: By default, the failover group is configured with an automatic failover policy.</span></span> <span data-ttu-id="70e6c-208">Systém se aktivuje převzetí služeb při selhání při selhání je zjištěna.</span><span class="sxs-lookup"><span data-stu-id="70e6c-208">The system triggers failover as soon as the failure is detected.</span></span> <span data-ttu-id="70e6c-209">Pokud chcete řídit pracovní postup převzetí služeb při selhání z aplikace, můžete vypnout automatické převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="70e6c-209">If you want to control the failover workflow from the application, you can turn off automatic failover.</span></span> 
* <span data-ttu-id="70e6c-210">**Ruční převzetí služeb při selhání**: převzetí služeb při selhání můžete spustit ručně kdykoli bez ohledu na konfiguraci automatického převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="70e6c-210">**Manual failover**: You can initiate failover manually at any time regardless of the automatic failover configuration.</span></span> <span data-ttu-id="70e6c-211">Pokud zásady automatické převzetí služeb při selhání není nakonfigurované ruční převzetí služeb při selhání bude potřeba k obnovení databází ve skupině pro převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="70e6c-211">If automatic failover policy is not configured manual failover is required to recover databases in the failover group.</span></span> <span data-ttu-id="70e6c-212">Můžete zahájit vynucené nebo popisný převzetí služeb při selhání (úplná synchronizace dat).</span><span class="sxs-lookup"><span data-stu-id="70e6c-212">You can initiate forced or friendly failover (with full data synchronization).</span></span> <span data-ttu-id="70e6c-213">K tomu může přemístit na primární oblasti aktivního serveru.</span><span class="sxs-lookup"><span data-stu-id="70e6c-213">The latter could be used to relocate the active server to the primary region.</span></span> <span data-ttu-id="70e6c-214">Po dokončení převzetí služeb při selhání se automaticky aktualizují záznamy DNS zajistit připojení ke správnému serveru.</span><span class="sxs-lookup"><span data-stu-id="70e6c-214">When failover is completed the DNS records are automatically updated to ensure connectivity to the correct server.</span></span>
* <span data-ttu-id="70e6c-215">**Období odkladu ztráty dat.**: protože primárních a sekundárních databází se synchronizují pomocí asynchronní replikaci převzetí služeb při selhání může dojít ke ztrátě dat.</span><span class="sxs-lookup"><span data-stu-id="70e6c-215">**Grace period with data loss**: Because the primary and secondary databases are synchronized using asynchronous replication the failover may result in data loss.</span></span> <span data-ttu-id="70e6c-216">Zásady automatické převzetí služeb při selhání tak, aby odrážela vaší aplikace odolnost proti ztrátě dat můžete přizpůsobit.</span><span class="sxs-lookup"><span data-stu-id="70e6c-216">You can customize the automatic failover policy to reflect your application’s tolerance to data loss.</span></span> <span data-ttu-id="70e6c-217">Nakonfigurováním **GracePeriodWithDataLossHours**, můžete řídit, jak dlouho systém čekat před zahájením převzetí služeb při selhání, který je nejspíš ztrátě dat výsledek.</span><span class="sxs-lookup"><span data-stu-id="70e6c-217">By configuring **GracePeriodWithDataLossHours**, you can control how long the system waits before initiating the failover that is likely to result data loss.</span></span> 

   > [!NOTE]
   > <span data-ttu-id="70e6c-218">Když systém zjistí, že je stále online databází ve skupině (například se výpadek pouze ovlivněn rovině řízení služby), okamžitě bez ohledu na hodnotu, která nastavuje aktivujepřevzetíslužebpřiselháníseúplnásynchronizacedat(popisnýpřevzetíslužebpřiselhání) **GracePeriodWithDataLossHours**.</span><span class="sxs-lookup"><span data-stu-id="70e6c-218">When system detects that the databases in the group are still online (for example, the outage only impacted the service control plane), it immediately activates the failover with full data synchronization (friendly failover) regardless of the value set by **GracePeriodWithDataLossHours**.</span></span> <span data-ttu-id="70e6c-219">To zaručuje, že nedochází ke ztrátě dat během obnovení.</span><span class="sxs-lookup"><span data-stu-id="70e6c-219">This behavior ensures that there is no data loss during the recovery.</span></span> <span data-ttu-id="70e6c-220">Období odkladu se projeví pouze v případě, že popisný převzetí služeb při selhání není možné.</span><span class="sxs-lookup"><span data-stu-id="70e6c-220">The grace period takes effect only when a friendly failover is not possible.</span></span> <span data-ttu-id="70e6c-221">Pokud se výpadek zmírnit před vypršení časového limitu, není aktivována převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="70e6c-221">If the outage is mitigated before the grace period expires, the failover is not activated.</span></span>
   >

* <span data-ttu-id="70e6c-222">**Více skupin převzetí služeb při selhání**: můžete nakonfigurovat více skupin převzetí služeb při selhání pro stejného páru serverů k řízení rozsahu převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="70e6c-222">**Multiple failover groups**: You can configure multiple failover groups for the same pair of servers to control the scale of failovers.</span></span> <span data-ttu-id="70e6c-223">Každá skupina převezme nezávisle.</span><span class="sxs-lookup"><span data-stu-id="70e6c-223">Each group fails over independently.</span></span> <span data-ttu-id="70e6c-224">Pokud vaše aplikace víceklientské používá elastické fondy, můžete tato funkce kombinovat primární a sekundární databáze v každém fondu.</span><span class="sxs-lookup"><span data-stu-id="70e6c-224">If your multi-tenant application uses elastic pools, you can use this capability to mix primary and secondary databases in each pool.</span></span> <span data-ttu-id="70e6c-225">Tímto způsobem můžete snížit dopad výpadku na polovinu ze klienty.</span><span class="sxs-lookup"><span data-stu-id="70e6c-225">This way you can reduce the impact of an outage to only half of the tenants.</span></span>

## <a name="best-practices-of-building-highly-available-service"></a><span data-ttu-id="70e6c-226">Osvědčené postupy vytváření službu s vysokou dostupností</span><span class="sxs-lookup"><span data-stu-id="70e6c-226">Best practices of building highly available service</span></span>

<span data-ttu-id="70e6c-227">K vytvoření vysoce dostupnou službu, která používá databázi Azure SQL zákazníci měli postupujte podle následujících pokynů:</span><span class="sxs-lookup"><span data-stu-id="70e6c-227">To build a highly available service that uses Azure SQL database the customers should follow these guidelines:</span></span>
- <span data-ttu-id="70e6c-228">**Použití převzetí služeb při selhání skupiny**: jednu nebo více skupin převzetí služeb při selhání můžete vytvořit mezi dvěma servery v různých oblastech (primární a sekundární servery).</span><span class="sxs-lookup"><span data-stu-id="70e6c-228">**Use failover group**: One or many failover groups can be created between two servers in different regions (primary and secondary servers).</span></span> <span data-ttu-id="70e6c-229">Každá skupina může obsahovat jednu nebo několik databází, které se obnoví jako jednotku, v případě, že všechny nebo některé primární databáze k dispozici z důvodu výpadku v primární oblasti.</span><span class="sxs-lookup"><span data-stu-id="70e6c-229">Each group can include one or several databases that are recovered as a unit in case all or some primary databases become unavailable due to an outage in the primary region.</span></span> <span data-ttu-id="70e6c-230">Skupina převzetí služeb při selhání vytvoří geograficky sekundární databáze se stejný cíl služby jako primární.</span><span class="sxs-lookup"><span data-stu-id="70e6c-230">The failover group creates geo-secondary database with the same service objective as the primary.</span></span> <span data-ttu-id="70e6c-231">Pokud přidáte na existující geografická replikace vztah ke skupině převzetí služeb při selhání zkontrolujte, že geo sekundární je nakonfigurovaná s stejné cíle na úrovni služby jako primární.</span><span class="sxs-lookup"><span data-stu-id="70e6c-231">If you add an existing geo-replication relationship to the failover group make sure the geo-secondary is configured with the same service level objective as the primary.</span></span>
- <span data-ttu-id="70e6c-232">**Použijte naslouchací proces pro čtení a zápis pro pracovní vytížení OLTP**: při provádění operace použití OLTP  **&lt;název skupiny pro převzetí služeb při selhání&gt;. database.windows.net** jako server adresy URL a připojení se automaticky přesměruje na primární.</span><span class="sxs-lookup"><span data-stu-id="70e6c-232">**Use read-write listener for OLTP workload**: When performing OLTP operations use **&lt;failover-group-name&gt;.database.windows.net** as the server URL and the connections will be automatically directed to the primary.</span></span> <span data-ttu-id="70e6c-233">Tato adresa URL nedojde ke změně po převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="70e6c-233">This URL will not change after the failover.</span></span>  
<span data-ttu-id="70e6c-234">Všimněte si, že že převzetí služeb při selhání zahrnuje aktualizace, které se DNS záznam, připojení klienta bude přesměrován na nový primární pouze po aktualizovat mezipaměť DNS klienta.</span><span class="sxs-lookup"><span data-stu-id="70e6c-234">Note the failover involves updating the DNS record so the client connections will be redirected to the new primary only after the client DNS cache is refreshed.</span></span>
- <span data-ttu-id="70e6c-235">**Použijte jen pro čtení naslouchací proces pro pracovní vytížení jen pro čtení**: Pokud máte logicky izolované jen pro čtení zatížení, která je odolný vůči chybám pro určité typu prošlostí dat, sekundární databázi můžete v aplikaci.</span><span class="sxs-lookup"><span data-stu-id="70e6c-235">**Use read-only listener for read-only workload**: If you have a logically isolated read-only workload that is tolerant to certain staleness of data, you can use the secondary database in the application.</span></span> <span data-ttu-id="70e6c-236">Použijte jen pro čtení relací  **&lt;název skupiny pro převzetí služeb při selhání&gt;. secondary.database.windows.net** jako server adresy URL a připojení automaticky přesměrováni na sekundární.</span><span class="sxs-lookup"><span data-stu-id="70e6c-236">For read-only sessions use **&lt;failover-group-name&gt;.secondary.database.windows.net** as the server URL and the connection will be automatically directed to the secondary.</span></span> <span data-ttu-id="70e6c-237">Dále je doporučeno, abyste určili v připojovacím řetězci číst záměr pomocí **ApplicationIntent = jen pro čtení**.</span><span class="sxs-lookup"><span data-stu-id="70e6c-237">It is also recommended that you indicate in connection string read intent by using **ApplicationIntent=ReadOnly**.</span></span> 
- <span data-ttu-id="70e6c-238">**Připravit pro snížení výkonu**: SQL rozhodovací převzetí služeb při selhání je nezávislé na zbytek dalších služeb používaných nebo aplikace.</span><span class="sxs-lookup"><span data-stu-id="70e6c-238">**Be prepared for perf degradation**: SQL failover decision is independent from the rest of the application or other services used.</span></span> <span data-ttu-id="70e6c-239">Aplikace může být "smíšený" s některé součásti v jedné oblasti a některé v jiném.</span><span class="sxs-lookup"><span data-stu-id="70e6c-239">The application may be “mixed” with some components in one region and some in another.</span></span> <span data-ttu-id="70e6c-240">Abyste se vyhnuli snížení výkonu, zajistěte nasazení redundantní aplikace v oblasti zotavení po Havárii a postupujte podle pokynů v tomto článku.</span><span class="sxs-lookup"><span data-stu-id="70e6c-240">To avoid the degradation, ensure the redundant application deployment in the DR region and follow the guidelines in this article.</span></span>  
<span data-ttu-id="70e6c-241">Poznámka: v oblasti zotavení po Havárii aplikace nebude muset použít jiné připojovací řetězec.</span><span class="sxs-lookup"><span data-stu-id="70e6c-241">Note the application in the DR region does not have to use a different connection string.</span></span>  
- <span data-ttu-id="70e6c-242">**Připravit na ztrátu dat**: Pokud je zjištěn výpadek, SQL automaticky aktivuje převzetí služeb při selhání pro čtení a zápis, pokud je nulové ztráty dat na našem známo.</span><span class="sxs-lookup"><span data-stu-id="70e6c-242">**Prepare for data loss**: If an outage is detected, SQL automatically triggers read-write failover if there is zero data loss to the best of our knowledge.</span></span> <span data-ttu-id="70e6c-243">V opačném čeká po dobu určenou ve **GracePeriodWithDataLossHours**.</span><span class="sxs-lookup"><span data-stu-id="70e6c-243">Otherwise, it waits for the period you specified by **GracePeriodWithDataLossHours**.</span></span> <span data-ttu-id="70e6c-244">Pokud jste zadali **GracePeriodWithDataLossHours**, připravit ztráty dat.</span><span class="sxs-lookup"><span data-stu-id="70e6c-244">If you specified **GracePeriodWithDataLossHours**, be prepared for data loss.</span></span> <span data-ttu-id="70e6c-245">Obecně platí během výpadky, Azure upřednostňuje dostupnost.</span><span class="sxs-lookup"><span data-stu-id="70e6c-245">In general, during outages, Azure favors availability.</span></span> <span data-ttu-id="70e6c-246">Pokud nechcete ztrátě dat, nezapomeňte nastavit **GracePeriodWithDataLossHours** na dostatečně velký počet, jako je například 24 hodin.</span><span class="sxs-lookup"><span data-stu-id="70e6c-246">If you cannot afford data loss, make sure to set **GracePeriodWithDataLossHours** to a sufficiently large number, such as 24 hours.</span></span> 


## <a name="upgrading-or-downgrading-a-primary-database"></a><span data-ttu-id="70e6c-247">Upgrade nebo přechod na starší verzi primární databáze</span><span class="sxs-lookup"><span data-stu-id="70e6c-247">Upgrading or downgrading a primary database</span></span>
<span data-ttu-id="70e6c-248">Můžete upgradovat nebo starší verzi primární databázi na jiný výkonu úroveň (v rámci stejné služby vrstvě) bez odpojení žádné sekundární databáze.</span><span class="sxs-lookup"><span data-stu-id="70e6c-248">You can upgrade or downgrade a primary database to a different performance level (within the same service tier) without disconnecting any secondary databases.</span></span> <span data-ttu-id="70e6c-249">Při upgradu, doporučujeme nejprve upgradovat sekundární databáze a pak upgradovat primární.</span><span class="sxs-lookup"><span data-stu-id="70e6c-249">When upgrading, we recommend that you upgrade the secondary database first, and then upgrade the primary.</span></span> <span data-ttu-id="70e6c-250">Když přechod na starší verzi, změnit pořadí: nejdřív se downgradovat primární a poté downgradovat sekundární.</span><span class="sxs-lookup"><span data-stu-id="70e6c-250">When downgrading, reverse the order: downgrade the primary first, and then downgrade the secondary.</span></span> <span data-ttu-id="70e6c-251">Když upgradujete nebo starší verzi databáze do jiné služby vrstvy se vynucuje tohoto doporučení.</span><span class="sxs-lookup"><span data-stu-id="70e6c-251">When you upgrade or downgrade the database to a different service tier this recommendation is enforced.</span></span> 

> [!NOTE]
> <span data-ttu-id="70e6c-252">Pokud jste vytvořili sekundární databáze v rámci konfigurace skupiny převzetí služeb při selhání se nedoporučuje na starší verzi sekundární databázi.</span><span class="sxs-lookup"><span data-stu-id="70e6c-252">If you created secondary database as part of the failover group configuration it is not recommended to downgrade the secondary database.</span></span> <span data-ttu-id="70e6c-253">To je potřeba zajistit, že datové vrstvy má dostatečnou kapacitu pro zpracování běžné zatížení po aktivaci převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="70e6c-253">This is to ensure your data tier has sufficient capacity to process your regular workload after failover is activated.</span></span> 
>

## <a name="preventing-the-loss-of-critical-data"></a><span data-ttu-id="70e6c-254">Zabránění ztrátě důležitých dat</span><span class="sxs-lookup"><span data-stu-id="70e6c-254">Preventing the loss of critical data</span></span>
<span data-ttu-id="70e6c-255">Z důvodu vysoké latenci sítě WAN průběžná kopie používá mechanismus asynchronní replikaci.</span><span class="sxs-lookup"><span data-stu-id="70e6c-255">Due to the high latency of wide area networks, continuous copy uses an asynchronous replication mechanism.</span></span> <span data-ttu-id="70e6c-256">Asynchronní replikaci lze ztrátu dat nevyhnutelné když dojde k chybě.</span><span class="sxs-lookup"><span data-stu-id="70e6c-256">Asynchronous replication makes some data loss unavoidable if a failure occurs.</span></span> <span data-ttu-id="70e6c-257">Nedošlo ke ztrátě dat však mohou vyžadovat některé aplikace.</span><span class="sxs-lookup"><span data-stu-id="70e6c-257">However, some applications may require no data loss.</span></span> <span data-ttu-id="70e6c-258">Chcete-li chránit tyto důležité aktualizace, vývojář aplikací zavolat [uložená procedura sp_wait_for_database_copy_sync](https://msdn.microsoft.com/library/dn467644.aspx) postup systému ihned po potvrzení transakce.</span><span class="sxs-lookup"><span data-stu-id="70e6c-258">To protect these critical updates, an application developer can call the [sp_wait_for_database_copy_sync](https://msdn.microsoft.com/library/dn467644.aspx) system procedure immediately after committing the transaction.</span></span> <span data-ttu-id="70e6c-259">Volání metody **uložená procedura sp_wait_for_database_copy_sync** blokuje volající vlákno, dokud poslední potvrzené transakce bylo přeneseno do sekundární databáze.</span><span class="sxs-lookup"><span data-stu-id="70e6c-259">Calling **sp_wait_for_database_copy_sync** blocks the calling thread until the last committed transaction has been transmitted to the secondary database.</span></span> <span data-ttu-id="70e6c-260">Však není čekat na přenášená transakce přehrány a potvrzeno u sekundární.</span><span class="sxs-lookup"><span data-stu-id="70e6c-260">However, it does not wait for the transmitted transactions to be replayed and committed on the secondary.</span></span> <span data-ttu-id="70e6c-261">**uložená procedura sp_wait_for_database_copy_sync** je vymezen na určité průběžná kopie odkaz.</span><span class="sxs-lookup"><span data-stu-id="70e6c-261">**sp_wait_for_database_copy_sync** is scoped to a specific continuous copy link.</span></span> <span data-ttu-id="70e6c-262">Tento postup můžete volat každý uživatel s právy k připojení k primární databázi.</span><span class="sxs-lookup"><span data-stu-id="70e6c-262">Any user with the connection rights to the primary database can call this procedure.</span></span>

> [!NOTE]
> <span data-ttu-id="70e6c-263">**uložená procedura sp_wait_for_database_copy_sync** zabrání ztrátě dat. po převzetí služeb při selhání, ale jeho nebude zaručit úplnou synchronizaci pro přístup pro čtení.</span><span class="sxs-lookup"><span data-stu-id="70e6c-263">**sp_wait_for_database_copy_sync** will prevent data loss after failover, but it will not guarantee full synchronization for read access.</span></span> <span data-ttu-id="70e6c-264">Zpoždění způsobené **uložená procedura sp_wait_for_database_copy_sync** volání procedur může být významný a závisí na velikosti transakčního protokolu v době volání.</span><span class="sxs-lookup"><span data-stu-id="70e6c-264">The delay caused by a **sp_wait_for_database_copy_sync** procedure call can be significant and depends on the size of the transaction log at the time of the call.</span></span> 
> 

## <a name="programmatically-managing-failover-groups-and-active-geo-replication"></a><span data-ttu-id="70e6c-265">Prostřednictvím kódu programu Správa skupin převzetí služeb při selhání a aktivní geografickou replikaci</span><span class="sxs-lookup"><span data-stu-id="70e6c-265">Programmatically managing failover groups and active geo-replication</span></span>
<span data-ttu-id="70e6c-266">Jak je popsáno dříve, skupiny automatické převzetí služeb při selhání (v preview) a aktivní geografickou replikaci lze spravovat také programově pomocí Azure PowerShell a rozhraní REST API.</span><span class="sxs-lookup"><span data-stu-id="70e6c-266">As discussed previously, auto-failover groups (in-preview) and active geo-replication can also be managed programmatically using Azure PowerShell and the REST API.</span></span> <span data-ttu-id="70e6c-267">Následující tabulky popisují sadu příkazů, které jsou k dispozici.</span><span class="sxs-lookup"><span data-stu-id="70e6c-267">The following tables describe the set of commands available.</span></span>

<span data-ttu-id="70e6c-268">**Rozhraní API Azure Resource Manager a na základě rolí zabezpečení**: aktivní geografickou replikací zahrnuje sadu rozhraní API Správce Azure Resource Manager pro správu, včetně [Azure SQL Database REST API](https://docs.microsoft.com/rest/api/sql/) a [Azure Rutiny prostředí PowerShell](https://docs.microsoft.com/powershell/azure/overview).</span><span class="sxs-lookup"><span data-stu-id="70e6c-268">**Azure Resource Manager API and role-based security**: Active geo-replication includes a set of Azure Resource Manager APIs for management, including the [Azure SQL Database REST API](https://docs.microsoft.com/rest/api/sql/) and [Azure PowerShell cmdlets](https://docs.microsoft.com/powershell/azure/overview).</span></span> <span data-ttu-id="70e6c-269">Tato rozhraní API vyžadují použití skupin prostředků a podporují zabezpečení na základě role (RBAC).</span><span class="sxs-lookup"><span data-stu-id="70e6c-269">These APIs require the use of resource groups and support role-based security (RBAC).</span></span> <span data-ttu-id="70e6c-270">Další informace o tom, jak implementovat přístup rolí najdete v tématu [řízení přístupu](../active-directory/role-based-access-control-what-is.md).</span><span class="sxs-lookup"><span data-stu-id="70e6c-270">For more information on how to implement access roles, see [Azure Role-Based Access Control](../active-directory/role-based-access-control-what-is.md).</span></span>

> [!NOTE]
> <span data-ttu-id="70e6c-271">Mnoho nových funkcí aktivní geografickou replikaci podporují jenom pomocí [Azure Resource Manager](../azure-resource-manager/resource-group-overview.md) na základě [REST API služby Azure SQL](https://msdn.microsoft.com/library/azure/mt163571.aspx) a [rutiny prostředí PowerShell databáze SQL Azure](https://msdn.microsoft.com/library/azure/mt574084.aspx).</span><span class="sxs-lookup"><span data-stu-id="70e6c-271">Many new features of active geo-replication are only supported using [Azure Resource Manager](../azure-resource-manager/resource-group-overview.md) based [Azure SQL REST API](https://msdn.microsoft.com/library/azure/mt163571.aspx) and [Azure SQL Database PowerShell cmdlets](https://msdn.microsoft.com/library/azure/mt574084.aspx).</span></span> <span data-ttu-id="70e6c-272">[(Klasické) rozhraní API REST](https://msdn.microsoft.com/library/azure/dn505719.aspx) a [rutiny Azure SQL Database (klasické)](https://msdn.microsoft.com/library/azure/dn546723.aspx) jsou podporované pro zpětnou kompatibilitu, takže se nedoporučuje používat rozhraní API založené na Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="70e6c-272">The [(classic) REST API](https://msdn.microsoft.com/library/azure/dn505719.aspx) and [Azure SQL Database (classic) cmdlets](https://msdn.microsoft.com/library/azure/dn546723.aspx) are supported for backward compatibility so using the Azure Resource Manager-based APIs are recommended.</span></span> 
> 

## <a name="manage-sql-database-failover-using-using-transact-sql"></a><span data-ttu-id="70e6c-273">Spravovat SQL databáze převzetí služeb při selhání pomocí jazyka Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="70e6c-273">Manage SQL database failover using using Transact-SQL</span></span>

| <span data-ttu-id="70e6c-274">Příkaz</span><span class="sxs-lookup"><span data-stu-id="70e6c-274">Command</span></span> | <span data-ttu-id="70e6c-275">Popis</span><span class="sxs-lookup"><span data-stu-id="70e6c-275">Description</span></span> |
| --- | --- |
| [<span data-ttu-id="70e6c-276">Příkaz ALTER DATABASE (databáze Azure SQL)</span><span class="sxs-lookup"><span data-stu-id="70e6c-276">ALTER DATABASE (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/mt574871.aspx) |<span data-ttu-id="70e6c-277">Přidat sekundární SERVER ON argument použít k vytvoření sekundární databáze pro stávající databáze a spustí replikaci dat</span><span class="sxs-lookup"><span data-stu-id="70e6c-277">Use ADD SECONDARY ON SERVER argument to create a secondary database for an existing database and starts data replication</span></span> |
| [<span data-ttu-id="70e6c-278">Příkaz ALTER DATABASE (databáze Azure SQL)</span><span class="sxs-lookup"><span data-stu-id="70e6c-278">ALTER DATABASE (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/mt574871.aspx) |<span data-ttu-id="70e6c-279">Pomocí funkce převzetí služeb při selhání nebo FORCE_FAILOVER_ALLOW_DATA_LOSS přepínač sekundární databáze, která bude primární k zahájení převzetí služeb při selhání</span><span class="sxs-lookup"><span data-stu-id="70e6c-279">Use FAILOVER or FORCE_FAILOVER_ALLOW_DATA_LOSS to switch a secondary database to be primary to initiate failover</span></span> |
| [<span data-ttu-id="70e6c-280">Příkaz ALTER DATABASE (databáze Azure SQL)</span><span class="sxs-lookup"><span data-stu-id="70e6c-280">ALTER DATABASE (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/mt574871.aspx) |<span data-ttu-id="70e6c-281">Odebrat sekundární SERVER ON použijte k ukončení replikaci dat mezi SQL Database a zadaný sekundární databázi.</span><span class="sxs-lookup"><span data-stu-id="70e6c-281">Use REMOVE SECONDARY ON SERVER to terminate a data replication between a SQL Database and the specified secondary database.</span></span> |
| [<span data-ttu-id="70e6c-282">Sys.geo_replication_links (Azure SQL Database)</span><span class="sxs-lookup"><span data-stu-id="70e6c-282">sys.geo_replication_links (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/mt575501.aspx) |<span data-ttu-id="70e6c-283">Vrátí informace o všechna existující replikační připojení pro každou databázi na logického serveru Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="70e6c-283">Returns information about all existing replication links for each database on the Azure SQL Database logical server.</span></span> |
| [<span data-ttu-id="70e6c-284">Sys.dm_geo_replication_link_status (Azure SQL Database)</span><span class="sxs-lookup"><span data-stu-id="70e6c-284">sys.dm_geo_replication_link_status (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/mt575504.aspx) |<span data-ttu-id="70e6c-285">Získá čas poslední replikace, poslední replikace funkce lag a další informace o propojení replikace pro danou databázi SQL.</span><span class="sxs-lookup"><span data-stu-id="70e6c-285">Gets the last replication time, last replication lag, and other information about the replication link for a given SQL database.</span></span> |
| [<span data-ttu-id="70e6c-286">Sys.dm_operation_status (Azure SQL Database)</span><span class="sxs-lookup"><span data-stu-id="70e6c-286">sys.dm_operation_status (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/dn270022.aspx) |<span data-ttu-id="70e6c-287">Zobrazuje stav pro všechny databázové operace, včetně stav odkazů replikace.</span><span class="sxs-lookup"><span data-stu-id="70e6c-287">Shows the status for all database operations including the status of the replication links.</span></span> |
| [<span data-ttu-id="70e6c-288">uložená procedura sp_wait_for_database_copy_sync (Azure SQL Database)</span><span class="sxs-lookup"><span data-stu-id="70e6c-288">sp_wait_for_database_copy_sync (Azure SQL Database)</span></span>](https://msdn.microsoft.com/library/dn467644.aspx) |<span data-ttu-id="70e6c-289">způsobí, že aplikace počkejte, dokud všechny potvrzené transakce jsou replikována a potvrzena aktivní sekundární databáze.</span><span class="sxs-lookup"><span data-stu-id="70e6c-289">causes the application to wait until all committed transactions are replicated and acknowledged by the active secondary database.</span></span> |
|  | |

## <a name="manage-sql-database-failover-using-using-powershell"></a><span data-ttu-id="70e6c-290">Spravovat SQL databáze převzetí služeb při selhání pomocí pomocí prostředí PowerShell</span><span class="sxs-lookup"><span data-stu-id="70e6c-290">Manage SQL database failover using using PowerShell</span></span>

| <span data-ttu-id="70e6c-291">Rutina</span><span class="sxs-lookup"><span data-stu-id="70e6c-291">Cmdlet</span></span> | <span data-ttu-id="70e6c-292">Popis</span><span class="sxs-lookup"><span data-stu-id="70e6c-292">Description</span></span> |
| --- | --- |
| [<span data-ttu-id="70e6c-293">Get-AzureRmSqlDatabase</span><span class="sxs-lookup"><span data-stu-id="70e6c-293">Get-AzureRmSqlDatabase</span></span>](/powershell/module/azurerm.sql/get-azurermsqldatabase) |<span data-ttu-id="70e6c-294">Získá jednu nebo více databází.</span><span class="sxs-lookup"><span data-stu-id="70e6c-294">Gets one or more databases.</span></span> |
| [<span data-ttu-id="70e6c-295">Nové AzureRmSqlDatabaseSecondary</span><span class="sxs-lookup"><span data-stu-id="70e6c-295">New-AzureRmSqlDatabaseSecondary</span></span>](/powershell/module/azurerm.sql/new-azurermsqldatabasesecondary) |<span data-ttu-id="70e6c-296">Sekundární databáze pro databázi vytvoří a spustí replikaci dat.</span><span class="sxs-lookup"><span data-stu-id="70e6c-296">Creates a secondary database for an existing database and starts data replication.</span></span> |
| [<span data-ttu-id="70e6c-297">Set-AzureRmSqlDatabaseSecondary</span><span class="sxs-lookup"><span data-stu-id="70e6c-297">Set-AzureRmSqlDatabaseSecondary</span></span>](/powershell/module/azurerm.sql/set-azurermsqldatabasesecondary) |<span data-ttu-id="70e6c-298">Přepne sekundární databáze, která bude primární k zahájení převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="70e6c-298">Switches a secondary database to be primary to initiate failover.</span></span> |
| [<span data-ttu-id="70e6c-299">Odebrat AzureRmSqlDatabaseSecondary</span><span class="sxs-lookup"><span data-stu-id="70e6c-299">Remove-AzureRmSqlDatabaseSecondary</span></span>](/powershell/module/azurerm.sql/remove-azurermsqldatabasesecondary) |<span data-ttu-id="70e6c-300">Ukončí replikaci dat mezi SQL Database a zadaný sekundární databázi.</span><span class="sxs-lookup"><span data-stu-id="70e6c-300">Terminates data replication between a SQL Database and the specified secondary database.</span></span> |
| [<span data-ttu-id="70e6c-301">Get-AzureRmSqlDatabaseReplicationLink</span><span class="sxs-lookup"><span data-stu-id="70e6c-301">Get-AzureRmSqlDatabaseReplicationLink</span></span>](/powershell/module/azurerm.sql/get-azurermsqldatabasereplicationlink) |<span data-ttu-id="70e6c-302">Získá odkazy geografická replikace mezi Azure SQL Database a skupinu prostředků nebo SQL Server.</span><span class="sxs-lookup"><span data-stu-id="70e6c-302">Gets the geo-replication links between an Azure SQL Database and a resource group or SQL Server.</span></span> |
| [<span data-ttu-id="70e6c-303">Nové AzureRmSqlDatabaseFailoverGroup</span><span class="sxs-lookup"><span data-stu-id="70e6c-303">New-AzureRmSqlDatabaseFailoverGroup</span></span>](/powershell/module/azurerm.sql/set-azurermsqldatabasefailovergroup) |   <span data-ttu-id="70e6c-304">Tento příkaz vytvoří skupinu převzetí služeb při selhání a zaregistruje ho na primární a sekundární servery</span><span class="sxs-lookup"><span data-stu-id="70e6c-304">This command creates a failover group and registers it on both primary and secondary servers</span></span>|
| [<span data-ttu-id="70e6c-305">Odebrat AzureRmSqlDatabaseFailoverGroup</span><span class="sxs-lookup"><span data-stu-id="70e6c-305">Remove-AzureRmSqlDatabaseFailoverGroup</span></span>](/powershell/module/azurerm.sql/remove-azurermsqldatabasefailovergroup) | <span data-ttu-id="70e6c-306">Odebere skupinu převzetí služeb při selhání ze serveru a odstraní všechny sekundární databáze zahrnuté skupině</span><span class="sxs-lookup"><span data-stu-id="70e6c-306">Removes the failover group from the server and deletes all secondary databases included the group</span></span> |
| [<span data-ttu-id="70e6c-307">Get-AzureRmSqlDatabaseFailoverGroup</span><span class="sxs-lookup"><span data-stu-id="70e6c-307">Get-AzureRmSqlDatabaseFailoverGroup</span></span>](/powershell/module/azurerm.sql/get-azurermsqldatabasefailovergroup) | <span data-ttu-id="70e6c-308">Načte konfiguraci skupiny převzetí služeb při selhání</span><span class="sxs-lookup"><span data-stu-id="70e6c-308">Retrieves the failover group configuration</span></span> |
| [<span data-ttu-id="70e6c-309">Set-AzureRmSqlDatabaseFailoverGroup</span><span class="sxs-lookup"><span data-stu-id="70e6c-309">Set-AzureRmSqlDatabaseFailoverGroup</span></span>](/powershell/module/azurerm.sql/set-azurermsqldatabasefailovergroup) |   <span data-ttu-id="70e6c-310">Upraví konfiguraci převzetí služeb při selhání skupiny</span><span class="sxs-lookup"><span data-stu-id="70e6c-310">Modifies the configuration of the failover group</span></span> |
| [<span data-ttu-id="70e6c-311">Přepínač AzureRMSqlDatabaseFailoverGroup</span><span class="sxs-lookup"><span data-stu-id="70e6c-311">Switch-AzureRMSqlDatabaseFailoverGroup</span></span>](/powershell/module/azurerm.sql/switch-azurermsqldatabasefailovergroup) | <span data-ttu-id="70e6c-312">Aktivační události převzetí služeb při selhání skupiny převzetí služeb při selhání na sekundární server</span><span class="sxs-lookup"><span data-stu-id="70e6c-312">Triggers failover of the failover group to the secondary server</span></span> |
|  | |

> [!IMPORTANT]
> <span data-ttu-id="70e6c-313">Ukázkové skripty, najdete v části [konfigurace a převzetí služeb při selhání jedné databáze používá aktivní geografickou replikaci](scripts/sql-database-setup-geodr-and-failover-database-powershell.md), [konfigurace a převzetí služeb při selhání ve fondu databáze používá aktivní geografickou replikaci](scripts/sql-database-setup-geodr-and-failover-pool-powershell.md), a [Konfigurace a převzetí služeb při selhání převzetí služeb při selhání skupiny pro jednu databázi (preview)] (skripty nebo sql-database-setup-geodr-failover-database-failover-skupin-powershell.md.</span><span class="sxs-lookup"><span data-stu-id="70e6c-313">For sample scripts, see [Configure and failover a single database using active geo-replication](scripts/sql-database-setup-geodr-and-failover-database-powershell.md), [Configure and failover a pooled database using active geo-replication](scripts/sql-database-setup-geodr-and-failover-pool-powershell.md), and  [Configure and failover a failover group for a single database (preview)](scripts/sql-database-setup-geodr-failover-database-failover-group-powershell.md.</span></span>
>

## <a name="manage-sql-database-failover-using-the-rest-api"></a><span data-ttu-id="70e6c-314">Správa SQL databáze převzetí služeb při selhání pomocí rozhraní REST API</span><span class="sxs-lookup"><span data-stu-id="70e6c-314">Manage SQL database failover using the REST API</span></span>
| <span data-ttu-id="70e6c-315">Rozhraní API</span><span class="sxs-lookup"><span data-stu-id="70e6c-315">API</span></span> | <span data-ttu-id="70e6c-316">Popis</span><span class="sxs-lookup"><span data-stu-id="70e6c-316">Description</span></span> |
| --- | --- |
| [<span data-ttu-id="70e6c-317">Vytvoření nebo aktualizace databáze (createMode = obnovit)</span><span class="sxs-lookup"><span data-stu-id="70e6c-317">Create or Update Database (createMode=Restore)</span></span>](/rest/api/sql/Databases/CreateOrUpdate) |<span data-ttu-id="70e6c-318">Vytvoří, aktualizuje nebo obnoví primární nebo sekundární databáze.</span><span class="sxs-lookup"><span data-stu-id="70e6c-318">Creates, updates, or restores a primary or a secondary database.</span></span> |
| [<span data-ttu-id="70e6c-319">Získat vytvořit nebo aktualizovat stav databáze</span><span class="sxs-lookup"><span data-stu-id="70e6c-319">Get Create or Update Database Status</span></span>](/rest/api/sql/Databases/CreateOrUpdate) |<span data-ttu-id="70e6c-320">Vrátí stav během operace vytvoření.</span><span class="sxs-lookup"><span data-stu-id="70e6c-320">Returns the status during a create operation.</span></span> |
| [<span data-ttu-id="70e6c-321">Nastavit sekundární databáze jako primární (plánované převzetí služeb při selhání)</span><span class="sxs-lookup"><span data-stu-id="70e6c-321">Set Secondary Database as Primary (Planned Failover)</span></span>](https://docs.microsoft.com/rest/api/sql/replicationlinkss#ReplicationLinks_Failover) |<span data-ttu-id="70e6c-322">Nastaví které repliky databáze je primární podle převzetí služeb při selhání z aktuální primární repliku databáze.</span><span class="sxs-lookup"><span data-stu-id="70e6c-322">Sets which replica database is primary by failing over from the current primary replica database.</span></span> |
| [<span data-ttu-id="70e6c-323">Nastavit sekundární databáze jako primární (neplánované převzetí služeb při selhání)</span><span class="sxs-lookup"><span data-stu-id="70e6c-323">Set Secondary Database as Primary (Unplanned Failover)</span></span>](https://docs.microsoft.com/rest/api/sql/replicationlinks#ReplicationLinks_FailoverAllowDataLoss) |<span data-ttu-id="70e6c-324">Nastaví které repliky databáze je primární podle převzetí služeb při selhání z aktuální primární repliku databáze.</span><span class="sxs-lookup"><span data-stu-id="70e6c-324">Sets which replica database is primary by failing over from the current primary replica database.</span></span> <span data-ttu-id="70e6c-325">Tato operace může způsobit ztrátu dat.</span><span class="sxs-lookup"><span data-stu-id="70e6c-325">This operation might result in data loss.</span></span> |
| [<span data-ttu-id="70e6c-326">Získání odkazu replikace</span><span class="sxs-lookup"><span data-stu-id="70e6c-326">Get Replication Link</span></span>](/rest/api/sql/replicationlinks/get) |<span data-ttu-id="70e6c-327">Získá konkrétní replikace odkaz pro danou databázi SQL ve spolupráci se geografická replikace.</span><span class="sxs-lookup"><span data-stu-id="70e6c-327">Gets a specific replication link for a given SQL database in a geo-replication partnership.</span></span> <span data-ttu-id="70e6c-328">Načítá informace zobrazené v zobrazení katalogu sys.geo_replication_links.</span><span class="sxs-lookup"><span data-stu-id="70e6c-328">It retrieves the information visible in the sys.geo_replication_links catalog view.</span></span> |
| [<span data-ttu-id="70e6c-329">Propojení replikace - seznamu databáze</span><span class="sxs-lookup"><span data-stu-id="70e6c-329">Replication Links - List By Database</span></span>](/rest/api/sql/replicationlinks/listbydatabase) | <span data-ttu-id="70e6c-330">Získá všechny odkazy replikace pro danou databázi SQL ve spolupráci se geografická replikace.</span><span class="sxs-lookup"><span data-stu-id="70e6c-330">Gets all replication links for a given SQL database in a geo-replication partnership.</span></span> <span data-ttu-id="70e6c-331">Načítá informace zobrazené v zobrazení katalogu sys.geo_replication_links.</span><span class="sxs-lookup"><span data-stu-id="70e6c-331">It retrieves the information visible in the sys.geo_replication_links catalog view.</span></span> |
| [<span data-ttu-id="70e6c-332">Odstranit propojení replikace</span><span class="sxs-lookup"><span data-stu-id="70e6c-332">Delete Replication Link</span></span>](/rest/api/sql/databases/delete) | <span data-ttu-id="70e6c-333">Odstraní propojení replikace databáze.</span><span class="sxs-lookup"><span data-stu-id="70e6c-333">Deletes a database replication link.</span></span> <span data-ttu-id="70e6c-334">Nelze provést během převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="70e6c-334">Cannot be done during failover.</span></span> |
| <span data-ttu-id="70e6c-335">[Vytvořit nebo aktualizovat skupinu převzetí služeb při selhání] / rest/api/sql nebo failovergroups/createorupdate)</span><span class="sxs-lookup"><span data-stu-id="70e6c-335">[Create or Update Failover Group]/rest/api/sql/failovergroups/createorupdate)</span></span> | <span data-ttu-id="70e6c-336">Vytvoří nebo aktualizuje skupinu převzetí služeb při selhání</span><span class="sxs-lookup"><span data-stu-id="70e6c-336">Creates or updates a failover group</span></span> |
| [<span data-ttu-id="70e6c-337">Odstranit skupinu převzetí služeb při selhání</span><span class="sxs-lookup"><span data-stu-id="70e6c-337">Delete Failover Group</span></span>](/rest/api/sql/failovergroups/delete) | <span data-ttu-id="70e6c-338">Odebere skupinu převzetí služeb při selhání ze serveru</span><span class="sxs-lookup"><span data-stu-id="70e6c-338">Removes the failover group from the server</span></span> |
| [<span data-ttu-id="70e6c-339">Převzetí služeb při selhání (plánovaná)</span><span class="sxs-lookup"><span data-stu-id="70e6c-339">Failover (Planned)</span></span>](/rest/api/sql/failovergroups/failover) | <span data-ttu-id="70e6c-340">Selhání se z aktuální primárního serveru na tento server.</span><span class="sxs-lookup"><span data-stu-id="70e6c-340">Fails over from the current primary server to this server.</span></span> |
| [<span data-ttu-id="70e6c-341">Vynucené převzetí služeb při selhání povolit ztrátě dat.</span><span class="sxs-lookup"><span data-stu-id="70e6c-341">Force Failover Allow Data Loss</span></span>](/rest/api/sql/failovergroups/forcefailoverallowdataloss) |<span data-ttu-id="70e6c-342">přes ails z aktuální primárního serveru na tomto serveru.</span><span class="sxs-lookup"><span data-stu-id="70e6c-342">ails over from the current primary server to this server.</span></span> <span data-ttu-id="70e6c-343">Tato operace může způsobit ztrátu dat.</span><span class="sxs-lookup"><span data-stu-id="70e6c-343">This operation might result in data loss.</span></span> |
| [<span data-ttu-id="70e6c-344">Get převzetí služeb při selhání skupiny</span><span class="sxs-lookup"><span data-stu-id="70e6c-344">Get Failover Group</span></span>](/rest/api/sql/failovergroups/get) | <span data-ttu-id="70e6c-345">Načte skupinu převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="70e6c-345">Gets a failover group.</span></span> |
| [<span data-ttu-id="70e6c-346">Seznam skupin převzetí služeb při selhání serverem</span><span class="sxs-lookup"><span data-stu-id="70e6c-346">List Failover Groups By Server</span></span>](/rest/api/sql/failovergroups/listbyserver) | <span data-ttu-id="70e6c-347">Seznam skupin převzetí služeb při selhání na serveru.</span><span class="sxs-lookup"><span data-stu-id="70e6c-347">Lists the failover groups in a server.</span></span> |
| [<span data-ttu-id="70e6c-348">Převzetí služeb při selhání skupiny aktualizací</span><span class="sxs-lookup"><span data-stu-id="70e6c-348">Update Failover Group</span></span>](/rest/api/sql/failovergroups/update) | <span data-ttu-id="70e6c-349">Aktualizuje skupinu převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="70e6c-349">Updates a failover group.</span></span> |
|  | |

## <a name="next-steps"></a><span data-ttu-id="70e6c-350">Další kroky</span><span class="sxs-lookup"><span data-stu-id="70e6c-350">Next steps</span></span>
* <span data-ttu-id="70e6c-351">Ukázkové skripty najdete v části:</span><span class="sxs-lookup"><span data-stu-id="70e6c-351">For sample scripts, see:</span></span>
   - [<span data-ttu-id="70e6c-352">Konfigurace a převzetí služeb při selhání jedné databáze používá aktivní geografickou replikaci</span><span class="sxs-lookup"><span data-stu-id="70e6c-352">Configure and failover a single database using active geo-replication</span></span>](scripts/sql-database-setup-geodr-and-failover-database-powershell.md)
   - [<span data-ttu-id="70e6c-353">Konfigurace a převzetí služeb při selhání ve fondu databáze používá aktivní geografickou replikaci</span><span class="sxs-lookup"><span data-stu-id="70e6c-353">Configure and failover a pooled database using active geo-replication</span></span>](scripts/sql-database-setup-geodr-and-failover-pool-powershell.md)
   - [<span data-ttu-id="70e6c-354">Konfigurace a převzetí služeb při selhání a převzetí služeb při selhání skupiny pro jednu databázi (preview)</span><span class="sxs-lookup"><span data-stu-id="70e6c-354">Configure and failover a failover group for a single database (preview)</span></span>](scripts/sql-database-setup-geodr-failover-database-failover-group-powershell.md)
* <span data-ttu-id="70e6c-355">Přehled kontinuity obchodních a scénářů najdete v tématu [obchodní kontinuity přehled](sql-database-business-continuity.md)</span><span class="sxs-lookup"><span data-stu-id="70e6c-355">For a business continuity overview and scenarios, see [Business continuity overview](sql-database-business-continuity.md)</span></span>
* <span data-ttu-id="70e6c-356">Další informace o Azure SQL Database automatizované zálohování najdete v tématu [automatizované zálohování SQL Database](sql-database-automated-backups.md).</span><span class="sxs-lookup"><span data-stu-id="70e6c-356">To learn about Azure SQL Database automated backups, see [SQL Database automated backups](sql-database-automated-backups.md).</span></span>
* <span data-ttu-id="70e6c-357">Další informace o použití automatizované zálohování pro obnovení, najdete v části [obnovit databázi ze zálohy spouštěná služba](sql-database-recovery-using-backups.md).</span><span class="sxs-lookup"><span data-stu-id="70e6c-357">To learn about using automated backups for recovery, see [Restore a database from the service-initiated backups](sql-database-recovery-using-backups.md).</span></span>
* <span data-ttu-id="70e6c-358">Další informace o požadavky na ověřování pro nové primární server a databáze najdete v tématu [zabezpečení SQL Database po zotavení po havárii](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="70e6c-358">To learn about authentication requirements for a new primary server and database, see [SQL Database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>

