---
title: "výkon aaaMonitor mnoho databází Azure SQL v aplikaci SaaS víceklientské | Microsoft Docs"
description: "Sledování a správa výkonu databáze a fondy v aplikaci Azure SQL Database Wingtip SaaS hello"
keywords: kurz k sql database
services: sql-database
documentationcenter: 
author: stevestein
manager: craigg
editor: 
ms.assetid: 
ms.service: sql-database
ms.custom: scale out apps
ms.workload: data-management
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/26/2017
ms.author: sstein
ms.openlocfilehash: f0d7ba456c485b7de249a56abac3cf4be3857285
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="monitor-performance-of-hello-wingtip-saas-application"></a><span data-ttu-id="2da6c-104">Sledování výkonu hello Wingtip SaaS aplikace</span><span class="sxs-lookup"><span data-stu-id="2da6c-104">Monitor performance of hello Wingtip SaaS application</span></span>

<span data-ttu-id="2da6c-105">V tomto kurzu jsou prozkoumali několik klíčových scénářů správy používány aplikací SaaS.</span><span class="sxs-lookup"><span data-stu-id="2da6c-105">In this tutorial, several key performance management scenarios used in SaaS applications are explored.</span></span> <span data-ttu-id="2da6c-106">Použití aktivitu zatížení generátor toosimulate ve všech databází klienta, hello integrované monitorování a výstrah funkce SQL Database a elastické fondy je ukázán.</span><span class="sxs-lookup"><span data-stu-id="2da6c-106">Using a load generator toosimulate activity across all tenant databases, hello built-in monitoring and alerting features of SQL Database and elastic pools are demonstrated.</span></span>

<span data-ttu-id="2da6c-107">aplikace Wingtip SaaS Hello používá klienta jeden datový model, kde každý místo (klient) má své vlastní databázi.</span><span class="sxs-lookup"><span data-stu-id="2da6c-107">hello Wingtip SaaS app uses a single-tenant data model, where each venue (tenant) has their own database.</span></span> <span data-ttu-id="2da6c-108">Mnoho aplikací SaaS, jako je hello očekává, že vzor zatížení klienta je nepředvídatelným a ojediněle.</span><span class="sxs-lookup"><span data-stu-id="2da6c-108">Like many SaaS applications, hello anticipated tenant workload pattern is unpredictable and sporadic.</span></span> <span data-ttu-id="2da6c-109">Jinými slovy to znamená, že prodej lístků může probíhat kdykoli.</span><span class="sxs-lookup"><span data-stu-id="2da6c-109">In other words, ticket sales may occur at any time.</span></span> <span data-ttu-id="2da6c-110">tootake výhodou tohoto vzoru typické databáze využití, klienta, které databáze jsou nasazeny do fondů elastické databáze.</span><span class="sxs-lookup"><span data-stu-id="2da6c-110">tootake advantage of this typical database usage pattern, tenant databases are deployed into elastic database pools.</span></span> <span data-ttu-id="2da6c-111">Elastické fondy optimalizovat náklady hello řešení sdílení prostředků mezi mnoha databázemi.</span><span class="sxs-lookup"><span data-stu-id="2da6c-111">Elastic pools optimize hello cost of a solution by sharing resources across many databases.</span></span> <span data-ttu-id="2da6c-112">U tohoto typu vzor je důležité toomonitor databáze a tooensure využití prostředků fondu, který načítá se to bude přiměřeně rovnoměrně mezi fondy.</span><span class="sxs-lookup"><span data-stu-id="2da6c-112">With this type of pattern, it's important toomonitor database and pool resource usage tooensure that loads are reasonably balanced across pools.</span></span> <span data-ttu-id="2da6c-113">Musíte taky tooensure splnit jednotlivé databáze s dostatkem prostředků a že nejsou stiskne fondy jejich [eDTU](sql-database-what-is-a-dtu.md) omezení.</span><span class="sxs-lookup"><span data-stu-id="2da6c-113">You also need tooensure that individual databases have adequate resources, and that pools are not hitting their [eDTU](sql-database-what-is-a-dtu.md) limits.</span></span> <span data-ttu-id="2da6c-114">V tomto kurzu jsou zde popsány toomonitor způsoby a spravovat databáze a fondy a jak tootake opravné akce v odpovědi toovariations v zatížení.</span><span class="sxs-lookup"><span data-stu-id="2da6c-114">This tutorial explores ways toomonitor and manage databases and pools, and how tootake corrective action in response toovariations in workload.</span></span>

<span data-ttu-id="2da6c-115">V tomto kurzu se naučíte:</span><span class="sxs-lookup"><span data-stu-id="2da6c-115">In this tutorial you learn how to:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="2da6c-116">Simulovat využití v databázích hello klienta spuštěním generátor zadaný zatížení</span><span class="sxs-lookup"><span data-stu-id="2da6c-116">Simulate usage on hello tenant databases by running a provided load generator</span></span>
> * <span data-ttu-id="2da6c-117">Databáze monitorování hello klienta jako jejich reagovat toohello zvýšení zatížení</span><span class="sxs-lookup"><span data-stu-id="2da6c-117">Monitor hello tenant databases as they respond toohello increase in load</span></span>
> * <span data-ttu-id="2da6c-118">Škálování hello elastického fondu v odpovědi toohello databáze zvýšené zatížení</span><span class="sxs-lookup"><span data-stu-id="2da6c-118">Scale up hello Elastic pool in response toohello increased database load</span></span>
> * <span data-ttu-id="2da6c-119">Zřídit aktivitu databáze služby druhý elastický fond tooload zůstatek</span><span class="sxs-lookup"><span data-stu-id="2da6c-119">Provision a second Elastic pool tooload balance database activity</span></span>


<span data-ttu-id="2da6c-120">toocomplete dokončení tohoto kurzu, ujistěte se, hello následující požadavky:</span><span class="sxs-lookup"><span data-stu-id="2da6c-120">toocomplete this tutorial, make sure hello following prerequisites are completed:</span></span>

* <span data-ttu-id="2da6c-121">Hello Wingtip SaaS aplikace je nasazená.</span><span class="sxs-lookup"><span data-stu-id="2da6c-121">hello Wingtip SaaS app is deployed.</span></span> <span data-ttu-id="2da6c-122">toodeploy za méně než pět minut, najdete v části [nasazení a seznamte se s hello Wingtip SaaS aplikace](sql-database-saas-tutorial.md)</span><span class="sxs-lookup"><span data-stu-id="2da6c-122">toodeploy in less than five minutes, see [Deploy and explore hello Wingtip SaaS application](sql-database-saas-tutorial.md)</span></span>
* <span data-ttu-id="2da6c-123">Je nainstalované prostředí Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2da6c-123">Azure PowerShell is installed.</span></span> <span data-ttu-id="2da6c-124">Podrobnosti najdete v článku [Začínáme s prostředím Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps).</span><span class="sxs-lookup"><span data-stu-id="2da6c-124">For details, see [Getting started with Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span></span>

## <a name="introduction-toosaas-performance-management-patterns"></a><span data-ttu-id="2da6c-125">Vzory správy výkonu tooSaaS Úvod</span><span class="sxs-lookup"><span data-stu-id="2da6c-125">Introduction tooSaaS performance management patterns</span></span>

<span data-ttu-id="2da6c-126">Správa výkonu databáze se skládá z kompilování a analýza dat výkonu a pak reaktivní toothis dat úpravou parametrů toomaintain přijatelnou dobu odezvy pro vaši aplikaci.</span><span class="sxs-lookup"><span data-stu-id="2da6c-126">Managing database performance consists of compiling and analyzing performance data, and then reacting toothis data by adjusting parameters toomaintain an acceptable response time for your application.</span></span> <span data-ttu-id="2da6c-127">Při hostování více klientů, fondy elastické databáze jsou nákladově efektivní způsob tooprovide a spravovat prostředky pro skupinu databází s nepředvídatelným úlohy.</span><span class="sxs-lookup"><span data-stu-id="2da6c-127">When hosting multiple tenants, Elastic database pools are a cost-effective way tooprovide and manage resources for a group of databases with unpredictable workloads.</span></span> <span data-ttu-id="2da6c-128">Při určitých vzorcích úloh může být správa ve fondu užitečná pro pouhé dvě databáze S3.</span><span class="sxs-lookup"><span data-stu-id="2da6c-128">With certain workload patterns, as few as two S3 databases can benefit from being managed in a pool.</span></span>

![média](./media/sql-database-saas-tutorial-performance-monitoring/app-diagram.png)

<span data-ttu-id="2da6c-130">Fondy a hello databází ve fondech, by měla být monitorovaná tooensure, které zůstanou v rámci přijatelné rozsahů výkonu.</span><span class="sxs-lookup"><span data-stu-id="2da6c-130">Pools, and hello databases in pools, should be monitored tooensure they stay within acceptable ranges of performance.</span></span> <span data-ttu-id="2da6c-131">Vyladění konfigurace fondu hello toomeet hello potřebám hello agregační zatížení všech databází, zajistíte, že Edtu fondu hello jsou vhodné pro hello celkové zatížení.</span><span class="sxs-lookup"><span data-stu-id="2da6c-131">Tune hello pool configuration toomeet hello needs of hello aggregate workload of all databases, ensuring that hello pool eDTUs are appropriate for hello overall workload.</span></span> <span data-ttu-id="2da6c-132">Upravte hello jednotlivé databáze min a -database max eDTU hodnoty tooappropriate hodnoty pro vaše konkrétní požadavky aplikací.</span><span class="sxs-lookup"><span data-stu-id="2da6c-132">Adjust hello per-database min and per-database max eDTU values tooappropriate values for your specific application requirements.</span></span>

### <a name="performance-management-strategies"></a><span data-ttu-id="2da6c-133">Strategie výkonu aplikací</span><span class="sxs-lookup"><span data-stu-id="2da6c-133">Performance management strategies</span></span>

* <span data-ttu-id="2da6c-134">tooavoid s toomanually monitorování výkonu, je příliš co nejúčinnější**nastavit výstrahy, které aktivují, když databáze nebo fondy Stray Zbloudilá mimo normální rozsahy**.</span><span class="sxs-lookup"><span data-stu-id="2da6c-134">tooavoid having toomanually monitor performance, it’s most effective too**set alerts that trigger when databases or pools stray out of normal ranges**.</span></span>
* <span data-ttu-id="2da6c-135">hello toorespond tooshort termín kolísání hello úroveň agregační výkonu fondu, **úroveň eDTU fondu je možné rozšířit nahoru nebo dolů**.</span><span class="sxs-lookup"><span data-stu-id="2da6c-135">toorespond tooshort-term fluctuations in hello aggregate performance level of a pool, hello **pool eDTU level can be scaled up or down**.</span></span> <span data-ttu-id="2da6c-136">Pokud dojde k této kolísání na základě pravidelných nebo předvídatelný **škálování hello fond může být naplánované toooccur automaticky**.</span><span class="sxs-lookup"><span data-stu-id="2da6c-136">If this fluctuation occurs on a regular or predictable basis, **scaling hello pool can be scheduled toooccur automatically**.</span></span> <span data-ttu-id="2da6c-137">Pokud například víte, že je úloha malého rozsahu, třeba přes noc nebo o víkendech, můžete vertikálně snížit kapacitu.</span><span class="sxs-lookup"><span data-stu-id="2da6c-137">For example, scale down when you know your workload is light, maybe overnight, or during weekends.</span></span>
* <span data-ttu-id="2da6c-138">toorespond toolonger termín kolísání nebo změny v hello počet databází, **jednotlivé databáze lze přesunout do jiných fondů**.</span><span class="sxs-lookup"><span data-stu-id="2da6c-138">toorespond toolonger-term fluctuations, or changes in hello number of databases, **individual databases can be moved into other pools**.</span></span>
* <span data-ttu-id="2da6c-139">termín tooshort toorespond nárůstu *jednotlivých* zatížení databáze **jednotlivé databáze může být převzaté z fondu a přiřazení úroveň výkonu jednotlivých**.</span><span class="sxs-lookup"><span data-stu-id="2da6c-139">toorespond tooshort term increases in *individual* database load **individual databases can be taken out of a pool and assigned an individual performance level**.</span></span> <span data-ttu-id="2da6c-140">Jakmile se snižuje zatížení hello, hello databáze můžete vracen toohello fondu.</span><span class="sxs-lookup"><span data-stu-id="2da6c-140">Once hello load is reduced, hello database can then be returned toohello pool.</span></span> <span data-ttu-id="2da6c-141">Když je znám předem, databáze se dají přesunout pre-emptively, že databáze hello tooensure vždy má hello prostředky, které potřebuje a tooavoid dopad na jiné databáze ve fondu hello.</span><span class="sxs-lookup"><span data-stu-id="2da6c-141">When this is known in advance, databases can be moved pre-emptively tooensure hello database always has hello resources it needs, and tooavoid impact on other databases in hello pool.</span></span> <span data-ttu-id="2da6c-142">Pokud tento požadavek je předvídatelný, jako je místo, má expresní prodeje lístků oblíbených události, může toto chování správy integrovaná do aplikace hello.</span><span class="sxs-lookup"><span data-stu-id="2da6c-142">If this requirement is predictable, such as a venue experiencing a rush of ticket sales for a popular event, then this management behavior can be integrated into hello application.</span></span>

<span data-ttu-id="2da6c-143">Hello [portál Azure](https://portal.azure.com) poskytuje integrované monitorování a výstrahy na nejvíce zdrojů.</span><span class="sxs-lookup"><span data-stu-id="2da6c-143">hello [Azure portal](https://portal.azure.com) provides built-in monitoring and alerting on most resources.</span></span> <span data-ttu-id="2da6c-144">Ve službě SQL Database je monitorování a upozorňování k dispozici v databázích a fondech.</span><span class="sxs-lookup"><span data-stu-id="2da6c-144">For SQL Database, monitoring and alerting is available on databases and pools.</span></span> <span data-ttu-id="2da6c-145">Toto integrované monitorování a výstrah je konkrétní prostředky, takže je vhodné toouse pro malý počet prostředků, ale není možnost je užitečná při práci s množství prostředků.</span><span class="sxs-lookup"><span data-stu-id="2da6c-145">This built-in monitoring and alerting is resource-specific, so it's convenient toouse for small numbers of resources, but is not very convenient when working with many resources.</span></span>

<span data-ttu-id="2da6c-146">Pro rozsáhlé scénáře, kde pracujete s mnoha reources [analýzy protokolů (OMS)](sql-database-saas-tutorial-log-analytics.md) lze použít.</span><span class="sxs-lookup"><span data-stu-id="2da6c-146">For high-volume scenarios where you're working with many reources, [Log Analytics (OMS)](sql-database-saas-tutorial-log-analytics.md) can be used.</span></span> <span data-ttu-id="2da6c-147">Toto je samostatný služba Azure, která nabízí v porovnání s emitovaného diagnostické protokoly a telemetrie získané v pracovním prostoru analýzy protokolů analýzy.</span><span class="sxs-lookup"><span data-stu-id="2da6c-147">This is a separate Azure service that provides analytics over emitted diagnostic logs and telemetry gathered in a log analytics workspace.</span></span> <span data-ttu-id="2da6c-148">Analýzy protokolů můžete shromažďovat telemetrická data z mnoha služeb a být použité tooquery a nastavit výstrahy.</span><span class="sxs-lookup"><span data-stu-id="2da6c-148">Log Analytics can collect telemetry from many services and be used tooquery and set alerts.</span></span>

## <a name="get-hello-wingtip-application-source-code-and-scripts"></a><span data-ttu-id="2da6c-149">Zdrojový kód hello Wingtip aplikace a skripty</span><span class="sxs-lookup"><span data-stu-id="2da6c-149">Get hello Wingtip application source code and scripts</span></span>

<span data-ttu-id="2da6c-150">Hello Wingtip SaaS skripty a zdrojový kód aplikace jsou k dispozici v hello [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) úložiště github.</span><span class="sxs-lookup"><span data-stu-id="2da6c-150">hello Wingtip SaaS scripts and application source code are available in hello [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) github repo.</span></span> <span data-ttu-id="2da6c-151">[Kroky toodownload hello Wingtip SaaS skripty](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span><span class="sxs-lookup"><span data-stu-id="2da6c-151">[Steps toodownload hello Wingtip SaaS scripts](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span></span>

## <a name="provision-additional-tenants"></a><span data-ttu-id="2da6c-152">Zřízení dalších tenantů</span><span class="sxs-lookup"><span data-stu-id="2da6c-152">Provision additional tenants</span></span>

<span data-ttu-id="2da6c-153">Fondy mohou být nákladově efektivní s pouze dvěma databázemi S3, hello další databáze, které jsou v hello fondu hello cenově výhodnější stane hello průměrování vliv.</span><span class="sxs-lookup"><span data-stu-id="2da6c-153">While pools can be cost-effective with just two S3 databases, hello more databases that are in hello pool hello more cost-effective hello averaging effect becomes.</span></span> <span data-ttu-id="2da6c-154">Pro zajištění správného porozumění fungování monitorování a správy výkonu na škále vyžaduje tento kurz, abyste měli nasazených nejméně 20 databází.</span><span class="sxs-lookup"><span data-stu-id="2da6c-154">For a good understanding of how performance monitoring and management works at scale, this tutorial requires you have at least 20 databases deployed.</span></span>

<span data-ttu-id="2da6c-155">Pokud už zřízené dávky klienty v předchozí kurzu, přeskočte toohello [simulovat využití na všechny databáze klienta](#simulate-usage-on-all-tenant-databases) části.</span><span class="sxs-lookup"><span data-stu-id="2da6c-155">If you already provisioned a batch of tenants in a prior tutorial, skip toohello [Simulate usage on all tenant databases](#simulate-usage-on-all-tenant-databases) section.</span></span>

1. <span data-ttu-id="2da6c-156">Otevřete... \\Learning moduly\\sledování výkonu a správy\\*ukázku PerformanceMonitoringAndManagement.ps1* v hello *prostředí PowerShell ISE*.</span><span class="sxs-lookup"><span data-stu-id="2da6c-156">Open …\\Learning Modules\\Performance Monitoring and Management\\*Demo-PerformanceMonitoringAndManagement.ps1* in hello *PowerShell ISE*.</span></span> <span data-ttu-id="2da6c-157">Tento skript nechte otevřený, protože během tohoto kurzu budete spouštět několik scénářů.</span><span class="sxs-lookup"><span data-stu-id="2da6c-157">Keep this script open as you'll run several scenarios during this tutorial.</span></span>
1. <span data-ttu-id="2da6c-158">Nastavte **$DemoScenario** = **1**, **Zřízení dávky tenantů**</span><span class="sxs-lookup"><span data-stu-id="2da6c-158">Set **$DemoScenario** = **1**, **Provision a batch of tenants**</span></span>
1. <span data-ttu-id="2da6c-159">Stiskněte klávesu **F5** toorun hello skriptu.</span><span class="sxs-lookup"><span data-stu-id="2da6c-159">Press **F5** toorun hello script.</span></span>

<span data-ttu-id="2da6c-160">skript Hello nasadí 17 klientů v méně než pět minut.</span><span class="sxs-lookup"><span data-stu-id="2da6c-160">hello script will deploy 17 tenants in less than five minutes.</span></span>

<span data-ttu-id="2da6c-161">Hello *New-TenantBatch* skript používá sadu vnořené nebo propojené [Resource Manager](../azure-resource-manager/index.md) šablony, které vytvoření dávky klientů, který ve výchozím nastavení zkopíruje databáze hello **basetenantdb** na hello katalogu serveru toocreate hello nové klienta databáze, pak zaregistruje v katalogu hello a nakonec je inicializuje hello klientovi název a místo typu.</span><span class="sxs-lookup"><span data-stu-id="2da6c-161">hello *New-TenantBatch* script uses a nested or linked set of [Resource Manager](../azure-resource-manager/index.md) templates that create a batch of tenants, which by default copies hello database **basetenantdb** on hello catalog server toocreate hello new tenant databases, then registers these in hello catalog, and finally initializes them with hello tenant name and venue type.</span></span> <span data-ttu-id="2da6c-162">To je konzistentní způsob hello aplikace hello zřídí nového klienta.</span><span class="sxs-lookup"><span data-stu-id="2da6c-162">This is consistent with hello way hello app provisions a new tenant.</span></span> <span data-ttu-id="2da6c-163">Veškeré změny provedené příliš*basetenantdb* jsou použité tooany nové klienty zřízený po tomto datu.</span><span class="sxs-lookup"><span data-stu-id="2da6c-163">Any changes made too*basetenantdb* are applied tooany new tenants provisioned thereafter.</span></span> <span data-ttu-id="2da6c-164">V tématu hello [Správa schématu kurzu](sql-database-saas-tutorial-schema-management.md) toosee jak změní schéma toomake příliš*existující* klienta databáze (včetně hello *basetenantdb* databáze).</span><span class="sxs-lookup"><span data-stu-id="2da6c-164">See hello [Schema Management tutorial](sql-database-saas-tutorial-schema-management.md) toosee how toomake schema changes too*existing* tenant databases (including hello *basetenantdb* database).</span></span>

## <a name="simulate-usage-on-all-tenant-databases"></a><span data-ttu-id="2da6c-165">Simulace využití ve všech databázích tenantů</span><span class="sxs-lookup"><span data-stu-id="2da6c-165">Simulate usage on all tenant databases</span></span>

<span data-ttu-id="2da6c-166">Hello *ukázku PerformanceMonitoringAndManagement.ps1* je skript zadaný, který simuluje zatížení spuštěným pro všechny databáze klienta.</span><span class="sxs-lookup"><span data-stu-id="2da6c-166">hello *Demo-PerformanceMonitoringAndManagement.ps1* script is provided that simulates a workload running against all tenant databases.</span></span> <span data-ttu-id="2da6c-167">Hello zatížení je generována pomocí jednoho z dostupných zatížení scénářů hello:</span><span class="sxs-lookup"><span data-stu-id="2da6c-167">hello load is generated using one of hello available load scenarios:</span></span>

| <span data-ttu-id="2da6c-168">Ukázka</span><span class="sxs-lookup"><span data-stu-id="2da6c-168">Demo</span></span> | <span data-ttu-id="2da6c-169">Scénář</span><span class="sxs-lookup"><span data-stu-id="2da6c-169">Scenario</span></span> |
|:--|:--|
| <span data-ttu-id="2da6c-170">2</span><span class="sxs-lookup"><span data-stu-id="2da6c-170">2</span></span> | <span data-ttu-id="2da6c-171">Generování normální intenzity zatížení (asi 40 DTU)</span><span class="sxs-lookup"><span data-stu-id="2da6c-171">Generate normal intensity load (approx. 40 DTU)</span></span> |
| <span data-ttu-id="2da6c-172">3</span><span class="sxs-lookup"><span data-stu-id="2da6c-172">3</span></span> | <span data-ttu-id="2da6c-173">Generování zatížení s delšími a častějšími nárůsty zatížení na databázi</span><span class="sxs-lookup"><span data-stu-id="2da6c-173">Generate load with longer and more frequent bursts per database</span></span>|
| <span data-ttu-id="2da6c-174">4</span><span class="sxs-lookup"><span data-stu-id="2da6c-174">4</span></span> | <span data-ttu-id="2da6c-175">Generování zatížení s vyššími nárůsty DTU na databázi (přibližně 80 DTU)</span><span class="sxs-lookup"><span data-stu-id="2da6c-175">Generate load with higher DTU bursts per database (approx. 80 DTU)</span></span>|
| <span data-ttu-id="2da6c-176">5</span><span class="sxs-lookup"><span data-stu-id="2da6c-176">5</span></span> | <span data-ttu-id="2da6c-177">Generování normálního a vysokého zatížení v jednom tenantovi (přibližně 95 DTU)</span><span class="sxs-lookup"><span data-stu-id="2da6c-177">Generate a normal load plus a high load on a single tenant (approx. 95 DTU)</span></span>|
| <span data-ttu-id="2da6c-178">6</span><span class="sxs-lookup"><span data-stu-id="2da6c-178">6</span></span> | <span data-ttu-id="2da6c-179">Generování nevyváženého zatížení mezi více fondy</span><span class="sxs-lookup"><span data-stu-id="2da6c-179">Generate unbalanced load across multiple pools</span></span>|

<span data-ttu-id="2da6c-180">Generátor zatížení Hello se vztahuje *syntetické* jen procesoru zatížení tooevery klienta databáze.</span><span class="sxs-lookup"><span data-stu-id="2da6c-180">hello load generator applies a *synthetic* CPU-only load tooevery tenant database.</span></span> <span data-ttu-id="2da6c-181">Generátor Hello spustí úlohu pro každého klienta databáze, která volá uložené procedury pravidelně který generuje hello zatížení.</span><span class="sxs-lookup"><span data-stu-id="2da6c-181">hello generator starts a job for each tenant database, which calls a stored procedure periodically that generates hello load.</span></span> <span data-ttu-id="2da6c-182">mezi všechny databáze, simulaci aktivity nepředvídatelným klienta jsou nastaveny úrovně zatížení Hello (v Edtu), doba trvání a intervaly.</span><span class="sxs-lookup"><span data-stu-id="2da6c-182">hello load levels (in eDTUs), duration, and intervals are varied across all databases, simulating unpredictable tenant activity.</span></span>

1. <span data-ttu-id="2da6c-183">Otevřete... \\Learning moduly\\sledování výkonu a správy\\*ukázku PerformanceMonitoringAndManagement.ps1* v hello *prostředí PowerShell ISE*.</span><span class="sxs-lookup"><span data-stu-id="2da6c-183">Open …\\Learning Modules\\Performance Monitoring and Management\\*Demo-PerformanceMonitoringAndManagement.ps1* in hello *PowerShell ISE*.</span></span> <span data-ttu-id="2da6c-184">Tento skript nechte otevřený, protože během tohoto kurzu budete spouštět několik scénářů.</span><span class="sxs-lookup"><span data-stu-id="2da6c-184">Keep this script open as you'll run several scenarios during this tutorial.</span></span>
1. <span data-ttu-id="2da6c-185">Nastavit **$DemoScenario** = **2**, *generování normální intenzitou zatížení*.</span><span class="sxs-lookup"><span data-stu-id="2da6c-185">Set **$DemoScenario** = **2**, *Generate normal intensity load*.</span></span>
1. <span data-ttu-id="2da6c-186">Stiskněte klávesu **F5** tooapply tooall zatížení databáze klienta.</span><span class="sxs-lookup"><span data-stu-id="2da6c-186">Press **F5** tooapply a load tooall your tenant databases.</span></span>

<span data-ttu-id="2da6c-187">Adresář Wingtip je aplikace SaaS a hello reálného zatížení aplikace SaaS je obvykle ojediněle a nepředvídatelným.</span><span class="sxs-lookup"><span data-stu-id="2da6c-187">Wingtip is a SaaS app, and hello real-world load on a SaaS app is typically sporadic and unpredictable.</span></span> <span data-ttu-id="2da6c-188">toosimulate to hello zatížení generátor vytváří náhodnou zatížení rozložené mezi všechny klienty.</span><span class="sxs-lookup"><span data-stu-id="2da6c-188">toosimulate this, hello load generator produces a randomized load distributed across all tenants.</span></span> <span data-ttu-id="2da6c-189">Několik minut, je potřeba pro tooemerge vzor zatížení hello, takže spustit hello zatížení generátor pro 3 až 5 minut před pokusem o toomonitor hello zatížení v následující části hello.</span><span class="sxs-lookup"><span data-stu-id="2da6c-189">Several minutes are needed for hello load pattern tooemerge, so run hello load generator for 3-5 minutes before attempting toomonitor hello load in hello following sections.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="2da6c-190">Generátor zatížení Hello běží jako řadu úloh v místní relace prostředí PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2da6c-190">hello load generator is running as a series of jobs in your local PowerShell session.</span></span> <span data-ttu-id="2da6c-191">Zachovat hello *ukázku PerformanceMonitoringAndManagement.ps1* otevřenou kartou!</span><span class="sxs-lookup"><span data-stu-id="2da6c-191">Keep hello *Demo-PerformanceMonitoringAndManagement.ps1* tab open!</span></span> <span data-ttu-id="2da6c-192">Pokud zavřete kartu hello nebo pozastavit váš počítač, generátor zatížení hello se zastaví.</span><span class="sxs-lookup"><span data-stu-id="2da6c-192">If you close hello tab, or suspend your machine, hello load generator stops.</span></span> <span data-ttu-id="2da6c-193">Generátor Hello zatížení zůstává ve *vyvolání úlohy* stavu, kde vygeneruje zatížení žádné nové klienty, které jsou zřízené po spuštění generátor hello.</span><span class="sxs-lookup"><span data-stu-id="2da6c-193">hello load generator remains in a *job-invoking* state where it generates load on any new tenants that are provisioned after hello generator is started.</span></span> <span data-ttu-id="2da6c-194">Použití *Ctrl-C* toostop vyvolání nové úlohy a ukončení hello skriptu.</span><span class="sxs-lookup"><span data-stu-id="2da6c-194">Use *Ctrl-C* toostop invoking new jobs and exit hello script.</span></span> <span data-ttu-id="2da6c-195">Generátor zatížení Hello bude toorun, ale jenom na stávající klienty.</span><span class="sxs-lookup"><span data-stu-id="2da6c-195">hello load generator will continue toorun, but only on existing tenants.</span></span>

## <a name="monitor-resource-usage-using-hello-azure-portal"></a><span data-ttu-id="2da6c-196">Sledování využití prostředků pomocí hello portálu Azure</span><span class="sxs-lookup"><span data-stu-id="2da6c-196">Monitor resource usage using hello Azure portal</span></span>

<span data-ttu-id="2da6c-197">využití prostředků hello toomonitor, která způsobují hello načíst aplikovány, otevřete hello portálu toohello fond, který obsahuje hello klienta databází:</span><span class="sxs-lookup"><span data-stu-id="2da6c-197">toomonitor hello resource usage that results from hello load being applied, open hello portal toohello pool containing hello tenant databases:</span></span>

1. <span data-ttu-id="2da6c-198">Otevřete hello [portál Azure](https://portal.azure.com) a procházet toohello *tenants1 -&lt;uživatele&gt;*  serveru.</span><span class="sxs-lookup"><span data-stu-id="2da6c-198">Open hello [Azure portal](https://portal.azure.com) and browse toohello *tenants1-&lt;USER&gt;* server.</span></span>
1. <span data-ttu-id="2da6c-199">Přejděte dolů na elastické fondy a klikněte na **Pool1**.</span><span class="sxs-lookup"><span data-stu-id="2da6c-199">Scroll down and locate elastic pools and click **Pool1**.</span></span> <span data-ttu-id="2da6c-200">Tento fond obsahuje všechny databáze klienta hello dosud vytvořili.</span><span class="sxs-lookup"><span data-stu-id="2da6c-200">This pool contains all hello tenant databases created so far.</span></span>

<span data-ttu-id="2da6c-201">Sledovat hello **elastického fondu monitorování** a **elastické databáze monitorování** grafy.</span><span class="sxs-lookup"><span data-stu-id="2da6c-201">Observe hello **Elastic pool monitoring** and **Elastic database monitoring** charts.</span></span>

<span data-ttu-id="2da6c-202">Hello využití prostředků fondu je hello agregační databáze využití pro všechny databáze ve fondu hello.</span><span class="sxs-lookup"><span data-stu-id="2da6c-202">hello pool's resource utilization is hello aggregate database utilization for all databases in hello pool.</span></span> <span data-ttu-id="2da6c-203">Hello databáze graf znázorňuje hello pět nejprodávanějších databází:</span><span class="sxs-lookup"><span data-stu-id="2da6c-203">hello database chart shows hello five hottest databases:</span></span>

![](./media/sql-database-saas-tutorial-performance-monitoring/pool1.png)

<span data-ttu-id="2da6c-204">Vzhledem k tomu, že existují další databáze ve fondu hello nad rámec hello nejvyšší pět, využití fondu hello zobrazuje aktivity, která se neodrazí v hello nejvyšší pět databáze grafu.</span><span class="sxs-lookup"><span data-stu-id="2da6c-204">Because there are additional databases in hello pool beyond hello top five, hello pool utilization shows activity that is not reflected in hello top five databases chart.</span></span> <span data-ttu-id="2da6c-205">Další podrobnosti získáte kliknutím na **využití prostředků databáze**:</span><span class="sxs-lookup"><span data-stu-id="2da6c-205">For additional details, click **Database Resource Utilization**:</span></span>

![](./media/sql-database-saas-tutorial-performance-monitoring/database-utilization.png)


## <a name="set-performance-alerts-on-hello-pool"></a><span data-ttu-id="2da6c-206">Nastavit výstrahy výkonu u fondu hello</span><span class="sxs-lookup"><span data-stu-id="2da6c-206">Set performance alerts on hello pool</span></span>

<span data-ttu-id="2da6c-207">Nastavit výstrahy na hello fondu, která aktivuje na \>75 % využití následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="2da6c-207">Set an alert on hello pool that triggers on \>75% utilization as follows:</span></span>

1. <span data-ttu-id="2da6c-208">Otevřete *Pool1* (na hello *tenants1 -\<uživatele\>*  serveru) v hello [portál Azure](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="2da6c-208">Open *Pool1* (on hello *tenants1-\<user\>* server) in hello [Azure portal](https://portal.azure.com).</span></span>
1. <span data-ttu-id="2da6c-209">Klikněte na **Pravidla výstrah** a potom na **+ Přidat výstrahu**:</span><span class="sxs-lookup"><span data-stu-id="2da6c-209">Click **Alert Rules**, and then click **+ Add alert**:</span></span>

   ![přidání výstrahy](media/sql-database-saas-tutorial-performance-monitoring/add-alert.png)

1. <span data-ttu-id="2da6c-211">Zadejte název, například **High DTU**,</span><span class="sxs-lookup"><span data-stu-id="2da6c-211">Provide a name, such as **High DTU**,</span></span>
1. <span data-ttu-id="2da6c-212">Nastavte hello následující hodnoty:</span><span class="sxs-lookup"><span data-stu-id="2da6c-212">Set hello following values:</span></span>
   * <span data-ttu-id="2da6c-213">**Metrika = procento eDTU**</span><span class="sxs-lookup"><span data-stu-id="2da6c-213">**Metric = eDTU percentage**</span></span>
   * <span data-ttu-id="2da6c-214">**Podmínka = je větší než**.</span><span class="sxs-lookup"><span data-stu-id="2da6c-214">**Condition = greater than**.</span></span>
   * <span data-ttu-id="2da6c-215">**Prahová hodnota = 75**.</span><span class="sxs-lookup"><span data-stu-id="2da6c-215">**Threshold = 75**.</span></span>
   * <span data-ttu-id="2da6c-216">**Období = přes hello posledních 30 minut**.</span><span class="sxs-lookup"><span data-stu-id="2da6c-216">**Period = Over hello last 30 minutes**.</span></span>
1. <span data-ttu-id="2da6c-217">Přidat e-mailovou adresu toohello *další správce email(s)* pole a klikněte na tlačítko **OK**.</span><span class="sxs-lookup"><span data-stu-id="2da6c-217">Add an email address toohello *Additional administrator email(s)* box and click **OK**.</span></span>

   ![nastavení upozornění](media/sql-database-saas-tutorial-performance-monitoring/alert-rule.png)


## <a name="scale-up-a-busy-pool"></a><span data-ttu-id="2da6c-219">Vertikální navýšení kapacity zaneprázdněného fondu</span><span class="sxs-lookup"><span data-stu-id="2da6c-219">Scale up a busy pool</span></span>

<span data-ttu-id="2da6c-220">Úroveň agregační zatížení hello zvyšuje v bodě toohello fondu, maxes out hello fondu a dosáhne využití eDTU 100 %, pak jednotlivé databáze ovlivňuje výkon, potenciálně zpomalení odezvy dotazů pro všechny databáze ve fondu hello.</span><span class="sxs-lookup"><span data-stu-id="2da6c-220">If hello aggregate load level increases on a pool toohello point that it maxes out hello pool and reaches 100% eDTU usage, then individual database performance is affected, potentially slowing query response times for all databases in hello pool.</span></span>

<span data-ttu-id="2da6c-221">**Krátkodobý**, zvažte vertikálním navýšení kapacity hello fondu tooprovide další prostředky, nebo odebráním databází z fondu hello (jejich přesunutí tooother fondy, nebo mimo hello fondu tooa samostatnou službu úroveň).</span><span class="sxs-lookup"><span data-stu-id="2da6c-221">**Short term**, consider scaling up hello pool tooprovide additional resources, or removing databases from hello pool (moving them tooother pools, or out of hello pool tooa stand-alone service tier).</span></span>

<span data-ttu-id="2da6c-222">**Dlouhodobější**, zvažte optimalizaci dotazů nebo index výkonu databáze tooimprove využití.</span><span class="sxs-lookup"><span data-stu-id="2da6c-222">**Longer term**, consider optimizing queries or index usage tooimprove database performance.</span></span> <span data-ttu-id="2da6c-223">V závislosti na hello tooperformance citlivosti aplikačním vydává jeho osvědčených postupů tooscale fond si před dosažením využití eDTU 100 %.</span><span class="sxs-lookup"><span data-stu-id="2da6c-223">Depending on hello application's sensitivity tooperformance issues its best practice tooscale a pool up before it reaches 100% eDTU usage.</span></span> <span data-ttu-id="2da6c-224">Použití výstrah toowarn můžete předem.</span><span class="sxs-lookup"><span data-stu-id="2da6c-224">Use an alert toowarn you in advance.</span></span>

<span data-ttu-id="2da6c-225">Můžete simulovat zaneprázdněn fondu většího zatížení hello vyprodukované generátor hello.</span><span class="sxs-lookup"><span data-stu-id="2da6c-225">You can simulate a busy pool by increasing hello load produced by hello generator.</span></span> <span data-ttu-id="2da6c-226">Což hello databáze tooburst častěji a pro delší a roste hello agregační zatížení ve fondu hello beze změny hello požadavky jednotlivých databází hello.</span><span class="sxs-lookup"><span data-stu-id="2da6c-226">Causing hello databases tooburst more frequently, and for longer, increasing hello aggregate load on hello pool without changing hello requirements of hello individual databases.</span></span> <span data-ttu-id="2da6c-227">Vertikálním navýšení kapacity fondu hello se provádí snadno hello portálu nebo z prostředí PowerShell.</span><span class="sxs-lookup"><span data-stu-id="2da6c-227">Scaling up hello pool is easily done in hello portal or from PowerShell.</span></span> <span data-ttu-id="2da6c-228">Tento postup používá portál hello.</span><span class="sxs-lookup"><span data-stu-id="2da6c-228">This exercise uses hello portal.</span></span>

1. <span data-ttu-id="2da6c-229">Nastavit *$DemoScenario* = **3**, _generování zatížení s delší a častější shluky na databázi_ tooincrease hello intenzitou hello agregační zatížení fond Hello beze změny zátěž ve špičce hello vyžadovanou každou databázi.</span><span class="sxs-lookup"><span data-stu-id="2da6c-229">Set *$DemoScenario* = **3**, _Generate load with longer and more frequent bursts per database_ tooincrease hello intensity of hello aggregate load on hello pool without changing hello peak load required by each database.</span></span>
1. <span data-ttu-id="2da6c-230">Stiskněte klávesu **F5** tooapply tooall zatížení databáze klienta.</span><span class="sxs-lookup"><span data-stu-id="2da6c-230">Press **F5** tooapply a load tooall your tenant databases.</span></span>

1. <span data-ttu-id="2da6c-231">Přejděte příliš**Pool1** v hello portálu Azure.</span><span class="sxs-lookup"><span data-stu-id="2da6c-231">Go too**Pool1** in hello Azure portal.</span></span>

<span data-ttu-id="2da6c-232">Monitorování hello vyšší využití eDTU fondu v horní grafu hello.</span><span class="sxs-lookup"><span data-stu-id="2da6c-232">Monitor hello increased pool eDTU usage on hello upper chart.</span></span> <span data-ttu-id="2da6c-233">Trvá několik minut hello nové vyšší zatížení tookick, ale měli byste vidět rychle začít toohit maximální využití fondu hello a jako zatížení hello steadies hello nové vzoru, rychle přetížení hello fondu.</span><span class="sxs-lookup"><span data-stu-id="2da6c-233">It takes a few minutes for hello new higher load tookick in, but you should quickly see hello pool start toohit max utilization, and as hello load steadies into hello new pattern, it rapidly overloads hello pool.</span></span>

1. <span data-ttu-id="2da6c-234">Klikněte na tlačítko tooscale až hello fondu, **konfigurace fondu** hello horní části hello **Pool1** stránky.</span><span class="sxs-lookup"><span data-stu-id="2da6c-234">tooscale up hello pool, click **Configure pool** at hello top of hello **Pool1** page.</span></span>
1. <span data-ttu-id="2da6c-235">Upravit hello **eDTU fondu** nastavení příliš**100**.</span><span class="sxs-lookup"><span data-stu-id="2da6c-235">Adjust hello **Pool eDTU** setting too**100**.</span></span> <span data-ttu-id="2da6c-236">Změna eDTU fondu hello nezmění nastavení pro jednotlivé databáze hello, (což je stále 50 eDTU max na databázi).</span><span class="sxs-lookup"><span data-stu-id="2da6c-236">Changing hello pool eDTU does not change hello per-database settings (which is still 50 eDTU max per database).</span></span> <span data-ttu-id="2da6c-237">Nastavení pro jednotlivé databáze hello uvidíte na pravé straně hello hello **konfigurace fondu** stránky.</span><span class="sxs-lookup"><span data-stu-id="2da6c-237">You can see hello per-database settings on hello right side of hello **Configure pool** page.</span></span>
1. <span data-ttu-id="2da6c-238">Klikněte na tlačítko **Uložit** toosubmit hello požadavek tooscale hello fondu.</span><span class="sxs-lookup"><span data-stu-id="2da6c-238">Click **Save** toosubmit hello request tooscale hello pool.</span></span>

<span data-ttu-id="2da6c-239">Přejděte zpět příliš**Pool1** > **přehled** tooview hello monitorování grafy.</span><span class="sxs-lookup"><span data-stu-id="2da6c-239">Go back too**Pool1** > **Overview** tooview hello monitoring charts.</span></span> <span data-ttu-id="2da6c-240">Sledování účinku hello hello fondu poskytování více prostředků (i když několik databází a náhodnou zatížení není vždy snadno toosee jednoznačně dokud nespustíte nějakou dobu).</span><span class="sxs-lookup"><span data-stu-id="2da6c-240">Monitor hello effect of providing hello pool with more resources (although with few databases and a randomized load it’s not always easy toosee conclusively until you run for some time).</span></span> <span data-ttu-id="2da6c-241">Když se díváte hello grafy opatřeny Pamatujte, že 100 % na horním hello teď grafu představuje 100 Edtu, při na hello nižší grafu 100 %, je stále 50 Edtu jako hello jednotlivé databáze maximální je stále 50 Edtu.</span><span class="sxs-lookup"><span data-stu-id="2da6c-241">While you are looking at hello charts bear in mind that 100% on hello upper chart now represents 100 eDTUs, while on hello lower chart 100% is still 50 eDTUs as hello per-database max is still 50 eDTUs.</span></span>

<span data-ttu-id="2da6c-242">Databáze zůstat online a plně dostupné v celém procesu hello.</span><span class="sxs-lookup"><span data-stu-id="2da6c-242">Databases remain online and fully available throughout hello process.</span></span> <span data-ttu-id="2da6c-243">V hello poslední chvíli jako každou databázi je připraven toobe povolit nové eDTU fondu hello žádné aktivní připojení jsou přerušená.</span><span class="sxs-lookup"><span data-stu-id="2da6c-243">At hello last moment as each database is ready toobe enabled with hello new pool eDTU, any active connections are broken.</span></span> <span data-ttu-id="2da6c-244">Kód aplikace vždy budou zasílány připojení tooretry vyřadit a tak se znovu připojit databázi toohello ve vertikálním navýšením kapacity fondu hello.</span><span class="sxs-lookup"><span data-stu-id="2da6c-244">Application code should always be written tooretry dropped connections, and so will reconnect toohello database in hello scaled-up pool.</span></span>

## <a name="load-balance-between-pools"></a><span data-ttu-id="2da6c-245">Vyrovnávání zatížení mezi fondy</span><span class="sxs-lookup"><span data-stu-id="2da6c-245">Load balance between pools</span></span>

<span data-ttu-id="2da6c-246">Alternativní tooscaling až hello fondu, vytvořte druhý fond a přesunutí databází do ní toobalance hello zatížení mezi hello dvou fondů.</span><span class="sxs-lookup"><span data-stu-id="2da6c-246">As an alternative tooscaling up hello pool, create a second pool and move databases into it toobalance hello load between hello two pools.</span></span> <span data-ttu-id="2da6c-247">toodo, které tento nový fond hello se musí vytvořit na stejném serveru jako hello hello nejdřív.</span><span class="sxs-lookup"><span data-stu-id="2da6c-247">toodo this hello new pool must be created on hello same server as hello first.</span></span>

1. <span data-ttu-id="2da6c-248">V hello [portál Azure](https://portal.azure.com), otevřete hello **tenants1 -&lt;uživatele&gt;**  serveru.</span><span class="sxs-lookup"><span data-stu-id="2da6c-248">In hello [Azure portal](https://portal.azure.com), open hello **tenants1-&lt;USER&gt;** server.</span></span>
1. <span data-ttu-id="2da6c-249">Klikněte na tlačítko **+ nový fond** toocreate fondu na aktuální server hello.</span><span class="sxs-lookup"><span data-stu-id="2da6c-249">Click **+ New pool** toocreate a pool on hello current server.</span></span>
1. <span data-ttu-id="2da6c-250">Na hello **fond elastické databáze** šablony:</span><span class="sxs-lookup"><span data-stu-id="2da6c-250">On hello **Elastic database pool** template:</span></span>

    1. <span data-ttu-id="2da6c-251">Nastavit **název** příliš*Pool2*.</span><span class="sxs-lookup"><span data-stu-id="2da6c-251">Set **Name** too*Pool2*.</span></span>
    1. <span data-ttu-id="2da6c-252">Nechte hello cenová úroveň jako **standardní fond**.</span><span class="sxs-lookup"><span data-stu-id="2da6c-252">Leave hello pricing tier as **Standard Pool**.</span></span>
    1. <span data-ttu-id="2da6c-253">Klikněte na **Konfigurovat fond**</span><span class="sxs-lookup"><span data-stu-id="2da6c-253">Click **Configure pool**,</span></span>
    1. <span data-ttu-id="2da6c-254">Nastavit **eDTU fondu** příliš*50 eDTU*.</span><span class="sxs-lookup"><span data-stu-id="2da6c-254">Set **Pool eDTU** too*50 eDTU*.</span></span>
    1. <span data-ttu-id="2da6c-255">Klikněte na tlačítko **přidat databáze** toosee seznam databází na serveru hello, který jde přidat příliš*Pool2*.</span><span class="sxs-lookup"><span data-stu-id="2da6c-255">Click **Add databases** toosee a list of databases on hello server that can be added too*Pool2*.</span></span>
    1. <span data-ttu-id="2da6c-256">Vyberte všechny toomove 10 databáze tyto toohello nový fond a pak klikněte na tlačítko **vyberte**.</span><span class="sxs-lookup"><span data-stu-id="2da6c-256">Select any 10 databases toomove these toohello new pool, and then click **Select**.</span></span> <span data-ttu-id="2da6c-257">Pokud jste byla spuštěna hello zatížení generátor, hello služby již ví, že váš profil výkonu vyžaduje fond větší než velikost 50 eDTU hello výchozí a doporučuje od 100 nastavení eDTU.</span><span class="sxs-lookup"><span data-stu-id="2da6c-257">If you've been running hello load generator, hello service already knows that your performance profile requires a larger pool than hello default 50 eDTU size and recommends starting with a 100 eDTU setting.</span></span>

    ![Doporučení](media/sql-database-saas-tutorial-performance-monitoring/configure-pool.png)

    1. <span data-ttu-id="2da6c-259">V tomto kurzu ponechte výchozí hello 50 Edtu a klikněte na tlačítko **vyberte** znovu.</span><span class="sxs-lookup"><span data-stu-id="2da6c-259">For this tutorial, leave hello default at 50 eDTUs, and click **Select** again.</span></span>
    1. <span data-ttu-id="2da6c-260">Vyberte **OK** hello hello toocreate nový fond a toomove vybrané databáze do ní.</span><span class="sxs-lookup"><span data-stu-id="2da6c-260">Select **OK** toocreate hello new pool and toomove hello selected databases into it.</span></span>

<span data-ttu-id="2da6c-261">Vytvoření fondu hello a přesunutí databází hello trvá několik minut.</span><span class="sxs-lookup"><span data-stu-id="2da6c-261">Creating hello pool and moving hello databases takes a few minutes.</span></span> <span data-ttu-id="2da6c-262">Jak je, že zůstat online a plně dostupné až hello velmi poslední chvíli přesunu databází, okamžiku jsou uzavřeny žádné otevřené připojení.</span><span class="sxs-lookup"><span data-stu-id="2da6c-262">As databases are moved they remain online and fully accessible until hello very last moment, at which point any open connections are closed.</span></span> <span data-ttu-id="2da6c-263">Tak dlouho, dokud máte některé logika opakovaných pokusů, klienti pak připojí toohello databáze v hello nový fond.</span><span class="sxs-lookup"><span data-stu-id="2da6c-263">As long as you have some retry logic, clients will then connect toohello database in hello new pool.</span></span>

<span data-ttu-id="2da6c-264">Procházet příliš**Pool2** (na hello *tenants1* serveru) tooopen hello fondu a sledovat jeho výkon.</span><span class="sxs-lookup"><span data-stu-id="2da6c-264">Browse too**Pool2** (on hello *tenants1* server) tooopen hello pool and monitor its performance.</span></span> <span data-ttu-id="2da6c-265">Pokud ho nevidíte, počkejte zřizování nový fond toocomplete hello.</span><span class="sxs-lookup"><span data-stu-id="2da6c-265">If you don't see it, wait for provisioning of hello new pool toocomplete.</span></span>

<span data-ttu-id="2da6c-266">Nyní uvidíte že využití prostředků na *Pool1* klesla a že *Pool2* je nyní podobně načtena.</span><span class="sxs-lookup"><span data-stu-id="2da6c-266">You now see that resource usage on *Pool1* has dropped and that *Pool2* is now similarly loaded.</span></span>

## <a name="manage-performance-of-a-single-database"></a><span data-ttu-id="2da6c-267">Správa výkonu služby jedné databáze</span><span class="sxs-lookup"><span data-stu-id="2da6c-267">Manage performance of a single database</span></span>

<span data-ttu-id="2da6c-268">Pokud jedné databáze ve fondu vyskytne dlouhodobě vysoké zatížení, v závislosti na konfiguraci fondu hello, může mívají toodominate hello prostředky ve fondu hello a mít vliv na jiné databáze.</span><span class="sxs-lookup"><span data-stu-id="2da6c-268">If a single database in a pool experiences a sustained high load, depending on hello pool configuration, it may tend toodominate hello resources in hello pool and impact other databases.</span></span> <span data-ttu-id="2da6c-269">Pokud aktivita hello pravděpodobně toocontinue nějakou dobu, může hello databáze dočasně přesunout mimo hello fondu.</span><span class="sxs-lookup"><span data-stu-id="2da6c-269">If hello activity is likely toocontinue for some time, hello database can be temporarily moved out of hello pool.</span></span> <span data-ttu-id="2da6c-270">To umožňuje hello databáze toohave hello další prostředky, které potřebuje a izoluje od hello jiné databáze.</span><span class="sxs-lookup"><span data-stu-id="2da6c-270">This allows hello database toohave hello extra resources it needs, and isolates it from hello other databases.</span></span>

<span data-ttu-id="2da6c-271">Toto cvičení simuluje hello účinku Hall vzájemné součinnosti Contoso zaznamenat vysokého zatížení při lístků, přejděte na prodej pro oblíbené vzájemné součinnosti.</span><span class="sxs-lookup"><span data-stu-id="2da6c-271">This exercise simulates hello effect of Contoso Concert Hall experiencing a high load when tickets go on sale for a popular concert.</span></span>

1. <span data-ttu-id="2da6c-272">Otevřete hello... \\ *Ukázku PerformanceMonitoringAndManagement.ps1* skriptu.</span><span class="sxs-lookup"><span data-stu-id="2da6c-272">Open hello …\\*Demo-PerformanceMonitoringAndManagement.ps1* script.</span></span>
1. <span data-ttu-id="2da6c-273">Nastavte **$DemoScenario = 5, Generování normálního a vysokého zatížení v jednom tenantovi (přibližně 95 DTU).**</span><span class="sxs-lookup"><span data-stu-id="2da6c-273">Set **$DemoScenario = 5, Generate a normal load plus a high load on a single tenant (approx. 95 DTU).**</span></span>
1. <span data-ttu-id="2da6c-274">Nastavte **$SingleTenantDatabaseName = contosoconcerthall**</span><span class="sxs-lookup"><span data-stu-id="2da6c-274">Set **$SingleTenantDatabaseName = contosoconcerthall**</span></span>
1. <span data-ttu-id="2da6c-275">Spuštění pomocí skriptu hello **F5**.</span><span class="sxs-lookup"><span data-stu-id="2da6c-275">Execute hello script using **F5**.</span></span>


1. <span data-ttu-id="2da6c-276">V hello [portál Azure](https://portal.azure.com) otevřete **Pool1**.</span><span class="sxs-lookup"><span data-stu-id="2da6c-276">In hello [Azure portal](https://portal.azure.com) open **Pool1**.</span></span>
1. <span data-ttu-id="2da6c-277">Zkontrolujte hello **elastického fondu monitorování** grafu a vyhledejte hello vyšší využití eDTU fondu.</span><span class="sxs-lookup"><span data-stu-id="2da6c-277">Inspect hello **Elastic pool monitoring** chart and look for hello increased pool eDTU usage.</span></span> <span data-ttu-id="2da6c-278">Po minutu nebo dvě hello vyšší zatížení by se měl spustit tookick v a rychle byste měli vidět, že fond hello dotkne využití 100 %.</span><span class="sxs-lookup"><span data-stu-id="2da6c-278">After a minute or two, hello higher load should start tookick in, and you should quickly see that hello pool hits 100% utilization.</span></span>
1. <span data-ttu-id="2da6c-279">Zkontrolujte hello **elastické databáze monitorování** zobrazení, která zobrazuje hello nejprodávanějších databází v hello poslední hodinu.</span><span class="sxs-lookup"><span data-stu-id="2da6c-279">Inspect hello **Elastic database monitoring** display which shows hello hottest databases in hello past hour.</span></span> <span data-ttu-id="2da6c-280">Hello *contosoconcerthall* databáze mají brzy zobrazit jako jeden z pěti hello nejprodávanějších databáze.</span><span class="sxs-lookup"><span data-stu-id="2da6c-280">hello *contosoconcerthall* database should soon appear as one of hello five hottest databases.</span></span>
1. <span data-ttu-id="2da6c-281">**Klikněte na monitorování elastické databáze hello** **grafu** a otevře se hello **využití prostředků databáze** stránky, kde můžete sledovat některé z databází hello.</span><span class="sxs-lookup"><span data-stu-id="2da6c-281">**Click on hello Elastic database monitoring** **chart** and it opens hello **Database Resource Utilization** page where you can monitor any of hello databases.</span></span> <span data-ttu-id="2da6c-282">Díky tomu můžete izolovat hello zobrazení pro hello *contosoconcerthall* databáze.</span><span class="sxs-lookup"><span data-stu-id="2da6c-282">This lets you isolate hello display for hello *contosoconcerthall* database.</span></span>
1. <span data-ttu-id="2da6c-283">Ze seznamu hello databáze, klikněte na tlačítko **contosoconcerthall**.</span><span class="sxs-lookup"><span data-stu-id="2da6c-283">From hello list of databases, click **contosoconcerthall**.</span></span>
1. <span data-ttu-id="2da6c-284">Klikněte na tlačítko **cenová úroveň (škálování Dtu)** tooopen hello **konfigurace výkonu** stránky, kde můžete nastavit úroveň samostatné výkonu pro databázi hello.</span><span class="sxs-lookup"><span data-stu-id="2da6c-284">Click **Pricing Tier (scale DTUs)** tooopen hello **Configure performance** page where you can set a stand-alone performance level for hello database.</span></span>
1. <span data-ttu-id="2da6c-285">Klikněte na hello **standardní** kartě Možnosti škálování hello tooopen ve standardní vrstvě hello.</span><span class="sxs-lookup"><span data-stu-id="2da6c-285">Click on hello **Standard** tab tooopen hello scale options in hello Standard tier.</span></span>
1. <span data-ttu-id="2da6c-286">Vysuňte hello **DTU posuvníku** tooright tooselect **100** Dtu.</span><span class="sxs-lookup"><span data-stu-id="2da6c-286">Slide hello **DTU slider** tooright tooselect **100** DTUs.</span></span> <span data-ttu-id="2da6c-287">Poznámka: odpovídá cíl služby toohello, **S3**.</span><span class="sxs-lookup"><span data-stu-id="2da6c-287">Note this corresponds toohello service objective, **S3**.</span></span>
1. <span data-ttu-id="2da6c-288">Klikněte na tlačítko **použít** toomove hello databáze mimo hello fondu a nastavte jej *úrovně Standard S3* databáze.</span><span class="sxs-lookup"><span data-stu-id="2da6c-288">Click **Apply** toomove hello database out of hello pool and make it a *Standard S3* database.</span></span>
1. <span data-ttu-id="2da6c-289">Škálování po dokončení, monitorování hello vliv na hello contosoconcerthall databáze a Pool1 v elastickém fondu a databáze oknech hello.</span><span class="sxs-lookup"><span data-stu-id="2da6c-289">Once scaling is complete, monitor hello effect on hello contosoconcerthall database and Pool1 on hello elastic pool and database blades.</span></span>

<span data-ttu-id="2da6c-290">Jakmile subvence hello vysokým zatížením hello contosoconcerthall databáze by měl neprodleně vrátí toohello fondu tooreduce jeho náklady.</span><span class="sxs-lookup"><span data-stu-id="2da6c-290">Once hello high load on hello contosoconcerthall database subsides you should promptly return it toohello pool tooreduce its cost.</span></span> <span data-ttu-id="2da6c-291">Pokud je při tom nejasné po který se stane, můžete nastavit upozornění na hello databáze, se aktivuje při jeho využití v jednotkách DTU klesne pod hello jednotlivé databáze ve fondu hello maximální.</span><span class="sxs-lookup"><span data-stu-id="2da6c-291">If it’s unclear when that will happen you could set an alert on hello database that will trigger when its DTU usage drops below hello per-database max on hello pool.</span></span> <span data-ttu-id="2da6c-292">Přesunutí databáze do fondu je popsáno v cvičení 5.</span><span class="sxs-lookup"><span data-stu-id="2da6c-292">Moving a database into a pool is described in exercise 5.</span></span>

## <a name="other-performance-management-patterns"></a><span data-ttu-id="2da6c-293">Další vzorce správy výkonu</span><span class="sxs-lookup"><span data-stu-id="2da6c-293">Other Performance Management Patterns</span></span>

<span data-ttu-id="2da6c-294">**Preemptivní škálování** v výše uvedeného cvičení hello, kde jste prozkoumali jak tooscale izolované databáze, budete vědět, které toolook databáze pro.</span><span class="sxs-lookup"><span data-stu-id="2da6c-294">**Pre-emptive scaling** In hello exercise above where you explored how tooscale an isolated database, you knew which database toolook for.</span></span> <span data-ttu-id="2da6c-295">Pokud hello správu Contoso vzájemné součinnosti Hall měl informován Wingtips hello brzké prodej lístků, databáze hello přesunuta mimo hello fondu pre-emptively.</span><span class="sxs-lookup"><span data-stu-id="2da6c-295">If hello management of Contoso Concert Hall had informed Wingtips of hello impending ticket sale, hello database could have been moved out of hello pool pre-emptively.</span></span> <span data-ttu-id="2da6c-296">Jinak by pravděpodobně mít vyžadovala výstrahu na fond hello nebo hello databáze toospot co se děje.</span><span class="sxs-lookup"><span data-stu-id="2da6c-296">Otherwise, it would likely have required an alert on hello pool or hello database toospot what was happening.</span></span> <span data-ttu-id="2da6c-297">Chcete nebude toolearn informace z hello jiných klientů v hello fondu nesouhlasících z snížení výkonu.</span><span class="sxs-lookup"><span data-stu-id="2da6c-297">You wouldn’t want toolearn about this from hello other tenants in hello pool complaining of degraded performance.</span></span> <span data-ttu-id="2da6c-298">A pokud hello klienta můžete odhadnout, jak dlouho budou potřebovat další prostředky, můžete nastavení databáze Azure Automation runbook toomove hello mimo hello fondu a pak znovu zpět na definovaný plán.</span><span class="sxs-lookup"><span data-stu-id="2da6c-298">And if hello tenant can predict how long they will need additional resources you can set up an Azure Automation runbook toomove hello database out of hello pool and then back in again on a defined schedule.</span></span>

<span data-ttu-id="2da6c-299">**Samoobslužná služba klienta škálování** škálování je úloha snadno vytvořit prostřednictvím rozhraní API pro správu hello, a proto snadno vytvářet hello možnost databáze klienta tooscale do své aplikace na straně klienta a nabízet ho jako součást služby SaaS.</span><span class="sxs-lookup"><span data-stu-id="2da6c-299">**Tenant self-service scaling** Because scaling is a task easily called via hello management API, you can easily build hello ability tooscale tenant databases into your tenant-facing application, and offer it as a feature of your SaaS service.</span></span> <span data-ttu-id="2da6c-300">Například umožnit klientům self-administer škálování nahoru a dolů, případně přímo spojeny fakturace tootheir!</span><span class="sxs-lookup"><span data-stu-id="2da6c-300">For example, let tenants self-administer scaling up and down, perhaps linked directly tootheir billing!</span></span>

<span data-ttu-id="2da6c-301">**Škálování fondu nahoru a dolů na vzorce používání toomatch plán**</span><span class="sxs-lookup"><span data-stu-id="2da6c-301">**Scaling a pool up and down on a schedule toomatch usage patterns**</span></span>

<span data-ttu-id="2da6c-302">Použití agregační klienta odpovídá vzorce používání předvídatelné, můžete použít Azure Automation tooscale fond nahoru a dolů podle plánu.</span><span class="sxs-lookup"><span data-stu-id="2da6c-302">Where aggregate tenant usage follows predictable usage patterns, you can use Azure Automation tooscale a pool up and down on a schedule.</span></span> <span data-ttu-id="2da6c-303">Můžete například snížit kapacitu fondu po 6. hodině večer a navýšit před 6. hodinou ráno ve dnech, kdy víte, že existuje pokles požadavků na prostředky.</span><span class="sxs-lookup"><span data-stu-id="2da6c-303">For example, scale a pool down after 6pm and up again before 6am on weekdays when you know there is a drop in resource requirements.</span></span>



## <a name="next-steps"></a><span data-ttu-id="2da6c-304">Další kroky</span><span class="sxs-lookup"><span data-stu-id="2da6c-304">Next steps</span></span>

<span data-ttu-id="2da6c-305">V tomto kurzu se naučíte:</span><span class="sxs-lookup"><span data-stu-id="2da6c-305">In this tutorial you learn how to:</span></span>

> [!div class="checklist"]
> * <span data-ttu-id="2da6c-306">Simulovat využití v databázích hello klienta spuštěním generátor zadaný zatížení</span><span class="sxs-lookup"><span data-stu-id="2da6c-306">Simulate usage on hello tenant databases by running a provided load generator</span></span>
> * <span data-ttu-id="2da6c-307">Databáze monitorování hello klienta jako jejich reagovat toohello zvýšení zatížení</span><span class="sxs-lookup"><span data-stu-id="2da6c-307">Monitor hello tenant databases as they respond toohello increase in load</span></span>
> * <span data-ttu-id="2da6c-308">Škálování hello elastického fondu v odpovědi toohello databáze zvýšené zatížení</span><span class="sxs-lookup"><span data-stu-id="2da6c-308">Scale up hello Elastic pool in response toohello increased database load</span></span>
> * <span data-ttu-id="2da6c-309">Zřídit druhý elastický fond tooload vyrovnávání hello databáze aktivitu</span><span class="sxs-lookup"><span data-stu-id="2da6c-309">Provision a second Elastic pool tooload balance hello database activity</span></span>

[<span data-ttu-id="2da6c-310">Kurz Obnovení jednoho tenanta</span><span class="sxs-lookup"><span data-stu-id="2da6c-310">Restore a single tenant tutorial</span></span>](sql-database-saas-tutorial-restore-single-tenant.md)


## <a name="additional-resources"></a><span data-ttu-id="2da6c-311">Další zdroje</span><span class="sxs-lookup"><span data-stu-id="2da6c-311">Additional resources</span></span>

* <span data-ttu-id="2da6c-312">Další [návodů, které stavějí hello nasazení Wingtip SaaS aplikace](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span><span class="sxs-lookup"><span data-stu-id="2da6c-312">Additional [tutorials that build upon hello Wingtip SaaS application deployment](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span></span>
* [<span data-ttu-id="2da6c-313">Elastické fondy SQL</span><span class="sxs-lookup"><span data-stu-id="2da6c-313">SQL Elastic pools</span></span>](sql-database-elastic-pool.md)
* [<span data-ttu-id="2da6c-314">Azure Automation</span><span class="sxs-lookup"><span data-stu-id="2da6c-314">Azure automation</span></span>](../automation/automation-intro.md)
* <span data-ttu-id="2da6c-315">[Log Analytics](sql-database-saas-tutorial-log-analytics.md) – kurz Nastavení a používání Log Analytics</span><span class="sxs-lookup"><span data-stu-id="2da6c-315">[Log Analytics](sql-database-saas-tutorial-log-analytics.md) - Setting up and using Log Analytics tutorial</span></span>
