---
title: aaaCopy Azure SQL database | Microsoft Docs
description: "Vytvořte kopii databáze Azure SQL"
services: sql-database
documentationcenter: 
author: CarlRabeler
manager: jhubbard
editor: 
ms.assetid: 5aaf6bcd-3839-49b5-8c77-cbdf786e359b
ms.service: sql-database
ms.custom: load & move data
ms.devlang: NA
ms.date: 06/15/2017
ms.author: carlrab
ms.workload: data-management
ms.topic: article
ms.tgt_pltfrm: NA
ms.openlocfilehash: 64a297d819d6da89600fda60abe8394ae405abfe
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="copy-an-azure-sql-database"></a><span data-ttu-id="f1b1a-103">Kopírování databáze Azure SQL</span><span class="sxs-lookup"><span data-stu-id="f1b1a-103">Copy an Azure SQL database</span></span>

<span data-ttu-id="f1b1a-104">Databáze SQL Azure poskytuje několik metod pro vytváření stavu transakční konzistence kopie stávající Azure SQL databáze na buď hello stejný server nebo jiný server.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-104">Azure SQL Database provides several methods for creating a transactionally consistent copy of an existing Azure SQL database on either hello same server or a different server.</span></span> <span data-ttu-id="f1b1a-105">Můžete kopírovat databázi SQL s využitím hello portálu Azure, PowerShell nebo T-SQL.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-105">You can copy a SQL database by using hello Azure portal, PowerShell, or T-SQL.</span></span> 

## <a name="overview"></a><span data-ttu-id="f1b1a-106">Přehled</span><span class="sxs-lookup"><span data-stu-id="f1b1a-106">Overview</span></span>

<span data-ttu-id="f1b1a-107">Kopie databáze je snímek hello zdrojové databáze od hello čas požadavku kopírování hello.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-107">A database copy is a snapshot of hello source database as of hello time of hello copy request.</span></span> <span data-ttu-id="f1b1a-108">Můžete vybrat hello stejný server nebo jiný server, její úroveň služby a výkonu úroveň nebo úroveň různých výkonu v rámci hello stejné služby vrstvě (edice).</span><span class="sxs-lookup"><span data-stu-id="f1b1a-108">You can select hello same server or a different server, its service tier and performance level, or a different performance level within hello same service tier (edition).</span></span> <span data-ttu-id="f1b1a-109">Po dokončení kopírování hello stane plně funkční, nezávislé databáze.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-109">After hello copy is complete, it becomes a fully functional, independent database.</span></span> <span data-ttu-id="f1b1a-110">V tomto okamžiku můžete upgradovat nebo starší verzi tooany edition.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-110">At this point, you can upgrade or downgrade it tooany edition.</span></span> <span data-ttu-id="f1b1a-111">Hello přihlášení, uživatele a oprávnění lze spravovat nezávisle.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-111">hello logins, users, and permissions can be managed independently.</span></span>  

## <a name="logins-in-hello-database-copy"></a><span data-ttu-id="f1b1a-112">Přihlášení v kopii databáze hello</span><span class="sxs-lookup"><span data-stu-id="f1b1a-112">Logins in hello database copy</span></span>

<span data-ttu-id="f1b1a-113">Při kopírování databáze toohello stejného logického serveru, hello stejné přihlášení lze použít v obou databází.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-113">When you copy a database toohello same logical server, hello same logins can be used on both databases.</span></span> <span data-ttu-id="f1b1a-114">objekt, že používáte toocopy hello databázi Hello zabezpečení se změní na vlastníka databáze hello na hello novou databázi.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-114">hello security principal you use toocopy hello database becomes hello database owner on hello new database.</span></span> <span data-ttu-id="f1b1a-115">Všichni uživatelé databáze, oprávnění k nim a jejich zabezpečení, které jsou identifikátory (SID) zkopírovat toohello kopie databáze.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-115">All database users, their permissions, and their security identifiers (SIDs) are copied toohello database copy.</span></span>  

<span data-ttu-id="f1b1a-116">Při kopírování databáze tooa jiný logický server objektu na nový server hello hello zabezpečení se změní na vlastníka databáze hello na hello novou databázi.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-116">When you copy a database tooa different logical server, hello security principal on hello new server becomes hello database owner on hello new database.</span></span> <span data-ttu-id="f1b1a-117">Pokud používáte [obsažené uživatelů databáze](sql-database-manage-logins.md) pro přístup k datům, zajistěte, aby obě hello primární a sekundární databáze mají vždycky hello okamžitě přístup stejné pověření uživatele, který po hello kopie dokončeno, bude její stejné hello přihlašovací údaje.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-117">If you use [contained database users](sql-database-manage-logins.md) for data access, ensure that both hello primary and secondary databases always have hello same user credentials, so that after hello copy is complete you can immediately access it with hello same credentials.</span></span> 

<span data-ttu-id="f1b1a-118">Pokud používáte [Azure Active Directory](../active-directory/active-directory-whatis.md), můžete zcela eliminovat potřebu hello správy přihlašovací údaje v hello kopírování.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-118">If you use [Azure Active Directory](../active-directory/active-directory-whatis.md), you can completely eliminate hello need for managing credentials in hello copy.</span></span> <span data-ttu-id="f1b1a-119">Ale při kopírování hello databáze tooa nový server, přístup na základě přihlášení hello nemusí fungovat, protože hello přihlášení nejsou k dispozici na nový server hello.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-119">However, when you copy hello database tooa new server, hello login-based access might not work, because hello logins do not exist on hello new server.</span></span> <span data-ttu-id="f1b1a-120">toolearn o správě přihlášení při kopírování databáze tooa jiný logický server, najdete v části [jak toomanage Azure SQL databáze zabezpečení po zotavení po havárii](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="f1b1a-120">toolearn about managing logins when you copy a database tooa different logical server, see [How toomanage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span> 

<span data-ttu-id="f1b1a-121">Po úspěšném provedení hello kopírování a předtím, než jsou přemapování jiných uživatelů, hello přihlášení, která iniciovala hello kopírování, hello vlastníka databáze, mohou přihlašovat pouze toohello novou databázi.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-121">After hello copying succeeds and before other users are remapped, only hello login that initiated hello copying, hello database owner, can log in toohello new database.</span></span> <span data-ttu-id="f1b1a-122">najdete v části tooresolve přihlášení po dokončení operace kopírování hello [vyřešit přihlášení](#resolve-logins).</span><span class="sxs-lookup"><span data-stu-id="f1b1a-122">tooresolve logins after hello copying operation is complete, see [Resolve logins](#resolve-logins).</span></span>

## <a name="copy-a-database-by-using-hello-azure-portal"></a><span data-ttu-id="f1b1a-123">Kopírovat databázi pomocí hello portálu Azure</span><span class="sxs-lookup"><span data-stu-id="f1b1a-123">Copy a database by using hello Azure portal</span></span>

<span data-ttu-id="f1b1a-124">toocopy databáze pomocí hello portál Azure, otevřete hello stránky pro vaši databázi a potom klikněte na **kopie**.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-124">toocopy a database by using hello Azure portal, open hello page for your database, and then click **Copy**.</span></span> 

   ![Kopie databáze](./media/sql-database-copy/database-copy.png)

## <a name="copy-a-database-by-using-powershell"></a><span data-ttu-id="f1b1a-126">Kopírování databáze pomocí prostředí PowerShell</span><span class="sxs-lookup"><span data-stu-id="f1b1a-126">Copy a database by using PowerShell</span></span>

<span data-ttu-id="f1b1a-127">toocopy databáze pomocí prostředí PowerShell, použijte hello [New-AzureRmSqlDatabaseCopy](/powershell/module/azurerm.sql/new-azurermsqldatabasecopy) rutiny.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-127">toocopy a database by using PowerShell, use hello [New-AzureRmSqlDatabaseCopy](/powershell/module/azurerm.sql/new-azurermsqldatabasecopy) cmdlet.</span></span> 

```PowerShell
New-AzureRmSqlDatabaseCopy -ResourceGroupName "myResourceGroup" `
    -ServerName $sourceserver `
    -DatabaseName "MySampleDatabase" `
    -CopyResourceGroupName "myResourceGroup" `
    -CopyServerName $targetserver `
    -CopyDatabaseName "CopyOfMySampleDatabase"
```

<span data-ttu-id="f1b1a-128">Pro dokončení ukázkový skript, najdete v části [zkopírujte nový server databáze tooa](scripts/sql-database-copy-database-to-new-server-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="f1b1a-128">For a complete sample script, see [Copy a database tooa new server](scripts/sql-database-copy-database-to-new-server-powershell.md).</span></span>

## <a name="copy-a-database-by-using-transact-sql"></a><span data-ttu-id="f1b1a-129">Kopírovat databázi pomocí jazyka Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="f1b1a-129">Copy a database by using Transact-SQL</span></span>

<span data-ttu-id="f1b1a-130">Přihlaste se toohello hlavní databáze s hello hlavní přihlášení na úrovni serveru nebo hello přihlášení, které vytvořil hello databázi chcete toocopy.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-130">Log in toohello master database with hello server-level principal login or hello login that created hello database you want toocopy.</span></span> <span data-ttu-id="f1b1a-131">Pro databázi kopírování toosucceed přihlášení, které nejsou hlavním přihlášením na úrovni serveru hello musí být členy role dbmanager hello.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-131">For database copying toosucceed, logins that are not hello server-level principal must be members of hello dbmanager role.</span></span> <span data-ttu-id="f1b1a-132">Další informace o připojování toohello serveru a přihlášení najdete v tématu [spravovat přihlášení](sql-database-manage-logins.md).</span><span class="sxs-lookup"><span data-stu-id="f1b1a-132">For more information about logins and connecting toohello server, see [Manage logins](sql-database-manage-logins.md).</span></span>

<span data-ttu-id="f1b1a-133">Spusťte kopírování hello zdrojová databáze s hello [CREATE DATABASE](https://msdn.microsoft.com/library/ms176061.aspx) příkaz.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-133">Start copying hello source database with hello [CREATE DATABASE](https://msdn.microsoft.com/library/ms176061.aspx) statement.</span></span> <span data-ttu-id="f1b1a-134">Provádění tohoto příkaz zahájí proces kopírování databáze hello.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-134">Executing this statement initiates hello database copying process.</span></span> <span data-ttu-id="f1b1a-135">Vzhledem k tomu, že asynchronní proces kopírování databáze je, vrátí hello příkaz CREATE DATABASE před dokončením kopírování databáze hello.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-135">Because copying a database is an asynchronous process, hello CREATE DATABASE statement returns before hello database copying is complete.</span></span>

### <a name="copy-a-sql-database-toohello-same-server"></a><span data-ttu-id="f1b1a-136">Zkopírujte toohello databáze SQL stejný server</span><span class="sxs-lookup"><span data-stu-id="f1b1a-136">Copy a SQL database toohello same server</span></span>
<span data-ttu-id="f1b1a-137">Přihlaste se toohello hlavní databáze s hello hlavní přihlášení na úrovni serveru nebo hello přihlášení, které vytvořil hello databázi chcete toocopy.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-137">Log in toohello master database with hello server-level principal login or hello login that created hello database you want toocopy.</span></span> <span data-ttu-id="f1b1a-138">Pro databázi kopírování toosucceed přihlášení, které nejsou hlavním přihlášením na úrovni serveru hello musí být členy role dbmanager hello.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-138">For database copying toosucceed, logins that are not hello server-level principal must be members of hello dbmanager role.</span></span>

<span data-ttu-id="f1b1a-139">Tento příkaz zkopíruje Database1 tooa novou databázi s názvem Database2 na hello stejný server.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-139">This command copies Database1 tooa new database named Database2 on hello same server.</span></span> <span data-ttu-id="f1b1a-140">V závislosti na velikosti hello vaší databáze může trvat hello kopírování operace některé toocomplete čas.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-140">Depending on hello size of your database, hello copying operation might take some time toocomplete.</span></span>

    -- Execute on hello master database.
    -- Start copying.
    CREATE DATABASE Database1_copy AS COPY OF Database1;

### <a name="copy-a-sql-database-tooa-different-server"></a><span data-ttu-id="f1b1a-141">Zkopírujte jiný server SQL databáze tooa</span><span class="sxs-lookup"><span data-stu-id="f1b1a-141">Copy a SQL database tooa different server</span></span>

<span data-ttu-id="f1b1a-142">Přihlaste se toohello hlavní databáze hello cílového serveru, kde je toobe vytvoření nové databáze hello hello databázového serveru SQL.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-142">Log in toohello master database of hello destination server, hello SQL database server where hello new database is toobe created.</span></span> <span data-ttu-id="f1b1a-143">Pomocí přihlášení, která má jako vlastníka databáze hello hello zdrojové databáze na serveru databáze SQL zdroje hello hello stejné jméno a heslo.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-143">Use a login that has hello same name and password as hello database owner of hello source database on hello source SQL database server.</span></span> <span data-ttu-id="f1b1a-144">Hello přihlášení na cílovém serveru hello musí také být členem hello dbmanager role nebo hello hlavní přihlášení na úrovni serveru.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-144">hello login on hello destination server must also be a member of hello dbmanager role or be hello server-level principal login.</span></span>

<span data-ttu-id="f1b1a-145">Tento příkaz kopií Database1 server1 tooa novou databázi s názvem Database2 na serveru2.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-145">This command copies Database1 on server1 tooa new database named Database2 on server2.</span></span> <span data-ttu-id="f1b1a-146">V závislosti na velikosti hello vaší databáze může trvat hello kopírování operace některé toocomplete čas.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-146">Depending on hello size of your database, hello copying operation might take some time toocomplete.</span></span>

    -- Execute on hello master database of hello target server (server2)
    -- Start copying from Server1 tooServer2
    CREATE DATABASE Database1_copy AS COPY OF server1.Database1;


### <a name="monitor-hello-progress-of-hello-copying-operation"></a><span data-ttu-id="f1b1a-147">Monitorovat průběh hello hello operace kopírování</span><span class="sxs-lookup"><span data-stu-id="f1b1a-147">Monitor hello progress of hello copying operation</span></span>

<span data-ttu-id="f1b1a-148">Sledování procesu kopírování hello pomocí dotazu na zobrazení zobrazení sys.databases a sys.dm_database_copies hello.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-148">Monitor hello copying process by querying hello sys.databases and sys.dm_database_copies views.</span></span> <span data-ttu-id="f1b1a-149">Při kopírování hello probíhá, hello **state_desc** sloupec hello zobrazení sys.databases zobrazení pro novou databázi hello je nastaven příliš**kopírování**.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-149">While hello copying is in progress, hello **state_desc** column of hello sys.databases view for hello new database is set too**COPYING**.</span></span>

* <span data-ttu-id="f1b1a-150">V případě selhání kopírování hello hello **state_desc** sloupec hello zobrazení sys.databases zobrazení pro novou databázi hello je nastaven příliš**podezření**.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-150">If hello copying fails, hello **state_desc** column of hello sys.databases view for hello new database is set too**SUSPECT**.</span></span> <span data-ttu-id="f1b1a-151">Provést hello příkaz DROP hello novou databázi a opakujte akci později.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-151">Execute hello DROP statement on hello new database, and try again later.</span></span>
* <span data-ttu-id="f1b1a-152">Pokud kopírování hello úspěšné, hello **state_desc** sloupec hello zobrazení sys.databases zobrazení pro novou databázi hello je nastaven příliš**ONLINE**.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-152">If hello copying succeeds, hello **state_desc** column of hello sys.databases view for hello new database is set too**ONLINE**.</span></span> <span data-ttu-id="f1b1a-153">kopírování Hello je dokončena a novou databázi hello je standardní databázi, která lze změnit nezávislé hello zdrojové databáze.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-153">hello copying is complete, and hello new database is a regular database that can be changed independent of hello source database.</span></span>

> [!NOTE]
> <span data-ttu-id="f1b1a-154">Pokud se rozhodnete toocancel hello kopírování během probíhající, provést hello [příkazu DROP DATABASE](https://msdn.microsoft.com/library/ms178613.aspx) příkaz na hello novou databázi.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-154">If you decide toocancel hello copying while it is in progress, execute hello [DROP DATABASE](https://msdn.microsoft.com/library/ms178613.aspx) statement on hello new database.</span></span> <span data-ttu-id="f1b1a-155">Alternativně provádění příkazu DROP DATABASE hello ve zdrojové databázi hello zruší také hello kopírování procesu.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-155">Alternatively, executing hello DROP DATABASE statement on hello source database also cancels hello copying process.</span></span>
> 

## <a name="resolve-logins"></a><span data-ttu-id="f1b1a-156">Vyřešení přihlášení</span><span class="sxs-lookup"><span data-stu-id="f1b1a-156">Resolve logins</span></span>

<span data-ttu-id="f1b1a-157">Po online na cílovém serveru hello hello novou databázi, použijte hello [ALTER USER](https://msdn.microsoft.com/library/ms176060.aspx) příkaz tooremap hello uživatele z hello nové databáze toologins na cílovém serveru hello.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-157">After hello new database is online on hello destination server, use hello [ALTER USER](https://msdn.microsoft.com/library/ms176060.aspx) statement tooremap hello users from hello new database toologins on hello destination server.</span></span> <span data-ttu-id="f1b1a-158">tooresolve osamocené uživatele, najdete v části [řešení potíží s osamocených uživatelů](https://msdn.microsoft.com/library/ms175475.aspx).</span><span class="sxs-lookup"><span data-stu-id="f1b1a-158">tooresolve orphaned users, see [Troubleshoot Orphaned Users](https://msdn.microsoft.com/library/ms175475.aspx).</span></span> <span data-ttu-id="f1b1a-159">Viz také [jak toomanage Azure SQL databáze zabezpečení po zotavení po havárii](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="f1b1a-159">See also [How toomanage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>

<span data-ttu-id="f1b1a-160">Všichni uživatelé v hello novou databázi zachovat hello oprávnění, která měly v hello zdrojové databáze.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-160">All users in hello new database retain hello permissions that they had in hello source database.</span></span> <span data-ttu-id="f1b1a-161">Hello uživatel, který zahájil kopie databáze hello se změní na vlastníka databáze hello hello nové databáze a je přiřazen nový identifikátor zabezpečení (SID).</span><span class="sxs-lookup"><span data-stu-id="f1b1a-161">hello user who initiated hello database copy becomes hello database owner of hello new database and is assigned a new security identifier (SID).</span></span> <span data-ttu-id="f1b1a-162">Po úspěšném provedení hello kopírování a předtím, než jsou přemapování jiných uživatelů, hello přihlášení, která iniciovala hello kopírování, hello vlastníka databáze, mohou přihlašovat pouze toohello novou databázi.</span><span class="sxs-lookup"><span data-stu-id="f1b1a-162">After hello copying succeeds and before other users are remapped, only hello login that initiated hello copying, hello database owner, can log in toohello new database.</span></span>

<span data-ttu-id="f1b1a-163">toolearn o správě uživatelů a přihlášení při kopírování databáze tooa jiný logický server, najdete v části [jak toomanage Azure SQL databáze zabezpečení po zotavení po havárii](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="f1b1a-163">toolearn about managing users and logins when you copy a database tooa different logical server, see [How toomanage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="f1b1a-164">Další kroky</span><span class="sxs-lookup"><span data-stu-id="f1b1a-164">Next steps</span></span>

* <span data-ttu-id="f1b1a-165">Informace o přihlášení, naleznete v části [spravovat přihlášení](sql-database-manage-logins.md) a [jak toomanage Azure SQL databáze zabezpečení po zotavení po havárii](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="f1b1a-165">For information about logins, see [Manage logins](sql-database-manage-logins.md) and [How toomanage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>
* <span data-ttu-id="f1b1a-166">tooexport databáze, najdete v části [exportovat hello databáze tooa souboru BACPAC](sql-database-export.md).</span><span class="sxs-lookup"><span data-stu-id="f1b1a-166">tooexport a database, see [Export hello database tooa BACPAC](sql-database-export.md).</span></span>
