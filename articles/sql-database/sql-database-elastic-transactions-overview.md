---
title: "Distribuované transakce v cloudových databázích"
description: "Přehled transakcí elastické databáze s databází Azure SQL"
services: sql-database
documentationcenter: 
author: torsteng
manager: jhubbard
editor: torsteng
ms.assetid: e14df7a3-7788-4cfb-bcd1-7ad6433ef1f9
ms.service: sql-database
ms.custom: scale out apps
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: sql-database
ms.date: 05/27/2016
ms.author: torsteng
ms.openlocfilehash: f7f1ad3f1933b39a0030a784cae40521254037d6
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 07/11/2017
---
# <a name="distributed-transactions-across-cloud-databases"></a><span data-ttu-id="87add-103">Distribuované transakce v cloudových databázích</span><span class="sxs-lookup"><span data-stu-id="87add-103">Distributed transactions across cloud databases</span></span>
<span data-ttu-id="87add-104">Transakcí elastické databáze pro Azure SQL Database (databáze SQL) umožňují spustit transakce, které jsou rozmístěny v několika databází v databázi SQL.</span><span class="sxs-lookup"><span data-stu-id="87add-104">Elastic database transactions for Azure SQL Database (SQL DB) allow you to run transactions that span several databases in SQL DB.</span></span> <span data-ttu-id="87add-105">Jsou k dispozici pro aplikace .NET pomocí rozhraní ADO .NET transakcí elastické databáze pro databázi SQL a integrovat známé programování pomocí prostředí [System.Transaction](https://msdn.microsoft.com/library/system.transactions.aspx) třídy.</span><span class="sxs-lookup"><span data-stu-id="87add-105">Elastic database transactions for SQL DB are available for .NET applications using ADO .NET and integrate with the familiar programming experience using the [System.Transaction](https://msdn.microsoft.com/library/system.transactions.aspx) classes.</span></span> <span data-ttu-id="87add-106">Pokud chcete získat knihovny, přečtěte si téma [rozhraní .NET Framework 4.6.1 (Webová instalační služba)](https://www.microsoft.com/download/details.aspx?id=49981).</span><span class="sxs-lookup"><span data-stu-id="87add-106">To get the library, see [.NET Framework 4.6.1 (Web Installer)](https://www.microsoft.com/download/details.aspx?id=49981).</span></span>

<span data-ttu-id="87add-107">Místní takové situaci většinou vyžaduje systémem Microsoft Distributed Transaction Coordinator služba MSDTC ().</span><span class="sxs-lookup"><span data-stu-id="87add-107">On premises, such a scenario usually required running Microsoft Distributed Transaction Coordinator (MSDTC).</span></span> <span data-ttu-id="87add-108">Vzhledem k tomu, že služby MS DTC není k dispozici pro aplikaci platforma jako služba v Azure, možnost koordinovat distribuované transakce, nyní přímo integrovány do databáze SQL.</span><span class="sxs-lookup"><span data-stu-id="87add-108">Since MSDTC is not available for Platform-as-a-Service application in Azure, the ability to coordinate distributed transactions has now been directly integrated into SQL DB.</span></span> <span data-ttu-id="87add-109">Aplikace se můžou připojit k jakékoli databázi SQL ke spuštění distribuovaných transakcí a jedna z databází se transparentně koordinovat distribuované transakce, jak je znázorněno na následujícím obrázku.</span><span class="sxs-lookup"><span data-stu-id="87add-109">Applications can connect to any SQL Database to launch distributed transactions, and one of the databases will transparently coordinate the distributed transaction, as shown in the following figure.</span></span> 

  ![<span data-ttu-id="87add-110">Distribuovaná transakce s Azure SQL Database pomocí transakcí elastické databáze</span><span class="sxs-lookup"><span data-stu-id="87add-110">Distributed transactions with Azure SQL Database using elastic database transactions</span></span> ][1]

## <a name="common-scenarios"></a><span data-ttu-id="87add-111">Obvyklé scénáře</span><span class="sxs-lookup"><span data-stu-id="87add-111">Common scenarios</span></span>
<span data-ttu-id="87add-112">Transakcí elastické databáze pro databázi SQL umožňuje aplikacím atomic měnit data uložená v několika různých databází SQL.</span><span class="sxs-lookup"><span data-stu-id="87add-112">Elastic database transactions for SQL DB enable applications to make atomic changes to data stored in several different SQL Databases.</span></span> <span data-ttu-id="87add-113">Ve verzi preview se zaměřuje na straně klienta vývoj prostředí v C# a rozhraní .NET.</span><span class="sxs-lookup"><span data-stu-id="87add-113">The preview focuses on client-side development experiences in C# and .NET.</span></span> <span data-ttu-id="87add-114">Na straně serveru zkušenosti s používáním T-SQL je naplánován na pozdější dobu.</span><span class="sxs-lookup"><span data-stu-id="87add-114">A server-side experience using T-SQL is planned for a later time.</span></span>  
<span data-ttu-id="87add-115">Transakcí elastické databáze cílem následující scénáře:</span><span class="sxs-lookup"><span data-stu-id="87add-115">Elastic database transactions targets the following scenarios:</span></span>

* <span data-ttu-id="87add-116">Více databázových aplikací v Azure: Tento scénář je dat svisle rozděleného mezi několika databází v databázi SQL tak, že různé druhy dat jsou umístěné na různých databází.</span><span class="sxs-lookup"><span data-stu-id="87add-116">Multi-database applications in Azure: With this scenario, data is vertically partitioned across several databases in SQL DB such that different kinds of data reside on different databases.</span></span> <span data-ttu-id="87add-117">Některé operace vyžadují změny dat, který je uložen ve dvou nebo více databází.</span><span class="sxs-lookup"><span data-stu-id="87add-117">Some operations require changes to data which is kept in two or more databases.</span></span> <span data-ttu-id="87add-118">Aplikace používá pro koordinaci změny napříč databáze a ujistěte se, nedělitelnost transakcí elastické databáze.</span><span class="sxs-lookup"><span data-stu-id="87add-118">The application uses elastic database transactions to coordinate the changes across databases and ensure atomicity.</span></span>
* <span data-ttu-id="87add-119">Horizontálně dělené databázové aplikace v Azure: Tento scénář Datová vrstva používá [klientské knihovny pro elastické databáze](sql-database-elastic-database-client-library.md) nebo samoobslužné-horizontálního dělení do vodorovně oddílu data mezi mnoha databázemi v databázi SQL.</span><span class="sxs-lookup"><span data-stu-id="87add-119">Sharded database applications in Azure: With this scenario, the data tier uses the [Elastic Database client library](sql-database-elastic-database-client-library.md) or self-sharding to horizontally partition the data across many databases in SQL DB.</span></span> <span data-ttu-id="87add-120">Jeden případ použití viditelného je potřeba provést atomic změny pro horizontálně dělenou víceklientské aplikace v případě, že změny span klientů.</span><span class="sxs-lookup"><span data-stu-id="87add-120">One prominent use case is the need to perform atomic changes for a sharded multi-tenant application when changes span tenants.</span></span> <span data-ttu-id="87add-121">Představte si například přenos z jednoho klienta do jiné, oba umístěný na různých databází.</span><span class="sxs-lookup"><span data-stu-id="87add-121">Think for instance of a transfer from one tenant to another, both residing on different databases.</span></span> <span data-ttu-id="87add-122">Druhém případě je podrobných horizontálního dělení zohlednit požadavků na kapacitu pro velké klienta, který naopak obvykle znamená, že některé atomická operace se musí Roztáhnout přes několik databází použitých pro stejné klienta.</span><span class="sxs-lookup"><span data-stu-id="87add-122">A second case is fine-grained sharding to accommodate capacity needs for a large tenant which in turn typically implies that some atomic operations needs to stretch across several databases used for the same tenant.</span></span> <span data-ttu-id="87add-123">Třetí případem je atomic aktualizace referenční data, která se replikují mezi databázemi.</span><span class="sxs-lookup"><span data-stu-id="87add-123">A third case is atomic updates to reference data that are replicated across databases.</span></span> <span data-ttu-id="87add-124">Operace Atomic, zpracovaných, podle těchto zásad můžete nyní koordinované napříč několika databází pomocí verze preview.</span><span class="sxs-lookup"><span data-stu-id="87add-124">Atomic, transacted, operations along these lines can now be coordinated across several databases using the preview.</span></span>
  <span data-ttu-id="87add-125">Transakcí elastické databáze pomocí dvojfázového zápisu transakce nedělitelnost mezi databázemi.</span><span class="sxs-lookup"><span data-stu-id="87add-125">Elastic database transactions use two-phase commit to ensure transaction atomicity across databases.</span></span> <span data-ttu-id="87add-126">Je vhodné pro transakce zahrnující méně než 100 databáze v době v rámci jedné transakce.</span><span class="sxs-lookup"><span data-stu-id="87add-126">It is a good fit for transactions that involve less than 100 databases at a time within a single transaction.</span></span> <span data-ttu-id="87add-127">Tato omezení nejsou vynucena, ale jeden očekávat výkon a úspěšnost pro elastické databáze transakce snížení při překročení těchto mezních hodnot.</span><span class="sxs-lookup"><span data-stu-id="87add-127">These limits are not enforced, but one should expect performance and success rates for elastic database transactions to suffer when exceeding these limits.</span></span>

## <a name="installation-and-migration"></a><span data-ttu-id="87add-128">Instalace a migrace</span><span class="sxs-lookup"><span data-stu-id="87add-128">Installation and migration</span></span>
<span data-ttu-id="87add-129">Možnosti pro elastické databáze transakce v databázi SQL je zajišťována prostřednictvím aktualizace na knihovny .NET System.Data.dll a System.Transactions.dll.</span><span class="sxs-lookup"><span data-stu-id="87add-129">The capabilities for elastic database transactions in SQL DB are provided through updates to the .NET libraries System.Data.dll and System.Transactions.dll.</span></span> <span data-ttu-id="87add-130">Knihovny DLL Ujistěte se, že tento dvojfázového zápisu se používá tam, kde je to nezbytné pro zajištění Nedělitelnost.</span><span class="sxs-lookup"><span data-stu-id="87add-130">The DLLs ensure that two-phase commit is used where necessary to ensure atomicity.</span></span> <span data-ttu-id="87add-131">Chcete-li začít vyvíjet aplikace, které používají transakcí elastické databáze, nainstalovat [rozhraní .NET Framework 4.6.1](https://www.microsoft.com/download/details.aspx?id=49981) nebo novější.</span><span class="sxs-lookup"><span data-stu-id="87add-131">To start developing applications using elastic database transactions, install [.NET Framework 4.6.1](https://www.microsoft.com/download/details.aspx?id=49981) or a later version.</span></span> <span data-ttu-id="87add-132">Při spuštění ve starší verzi rozhraní .NET Framework, transakce se nepodaří povýšit na distribuovanou transakci a k výjimce.</span><span class="sxs-lookup"><span data-stu-id="87add-132">When running on an earlier version of the .NET framework, transactions will fail to promote to a distributed transaction and an exception will be raised.</span></span>

<span data-ttu-id="87add-133">Po instalaci můžete distribuované transakce rozhraní API v System.Transactions – s připojením k databázi SQL.</span><span class="sxs-lookup"><span data-stu-id="87add-133">After installation, you can use the distributed transaction APIs in System.Transactions with connections to SQL DB.</span></span> <span data-ttu-id="87add-134">Pokud máte existující služby MSDTC aplikací pomocí těchto rozhraní API, po instalaci 4.6.1 jednoduše sestavit vaší stávající aplikace pro 4.6 rozhraní .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="87add-134">If you have existing MSDTC applications using these APIs, simply rebuild your existing applications for .NET 4.6 after installing the 4.6.1 Framework.</span></span> <span data-ttu-id="87add-135">Pokud projekty cílí na .NET 4.6, automaticky použijí aktualizované knihovny DLL z nové verze Framework a nyní úspěšné distribuované transakce, které volání rozhraní API v kombinaci s připojení k databázi SQL.</span><span class="sxs-lookup"><span data-stu-id="87add-135">If your projects target .NET 4.6, they will automatically use the updated DLLs from the new Framework version and distributed transaction API calls in combination with connections to SQL DB will now succeed.</span></span>

<span data-ttu-id="87add-136">Mějte na paměti, že transakcí elastické databáze nevyžadují instalaci služby MSDTC.</span><span class="sxs-lookup"><span data-stu-id="87add-136">Remember that elastic database transactions do not require installing MSDTC.</span></span> <span data-ttu-id="87add-137">Místo toho transakcí elastické databáze jsou spravovány přímo a v databázi SQL.</span><span class="sxs-lookup"><span data-stu-id="87add-137">Instead, elastic database transactions are directly managed by and within SQL DB.</span></span> <span data-ttu-id="87add-138">To výrazně zjednodušuje scénářích cloudu, protože nasazení služby MS DTC není potřeba pomocí distribuovaných transakcí v databázi SQL.</span><span class="sxs-lookup"><span data-stu-id="87add-138">This significantly simplifies cloud scenarios since a deployment of MSDTC is not necessary to use distributed transactions with SQL DB.</span></span> <span data-ttu-id="87add-139">Oddíl 4 podrobněji vysvětluje, jak nasadit transakcí elastické databáze a vyžaduje rozhraní .NET framework společně s cloudové aplikace do Azure.</span><span class="sxs-lookup"><span data-stu-id="87add-139">Section 4 explains in more detail how to deploy elastic database transactions and the required .NET framework together with your cloud applications to Azure.</span></span>

## <a name="development-experience"></a><span data-ttu-id="87add-140">Vývojové prostředí</span><span class="sxs-lookup"><span data-stu-id="87add-140">Development experience</span></span>
### <a name="multi-database-applications"></a><span data-ttu-id="87add-141">Více databázové aplikace</span><span class="sxs-lookup"><span data-stu-id="87add-141">Multi-database applications</span></span>
<span data-ttu-id="87add-142">Následující vzorový kód používá známé programovací prostředí s .NET System.Transactions.</span><span class="sxs-lookup"><span data-stu-id="87add-142">The following sample code uses the familiar programming experience with .NET System.Transactions.</span></span> <span data-ttu-id="87add-143">Třída TransactionScope vytváří ambientní transakce v rozhraní .NET.</span><span class="sxs-lookup"><span data-stu-id="87add-143">The TransactionScope class establishes an ambient transaction in .NET.</span></span> <span data-ttu-id="87add-144">("Vedlejším transakcí" je ten, který je umístěn v aktuální vlákno.) Všechna připojení otevřené v rámci v objektu TransactionScope účastnit transakce.</span><span class="sxs-lookup"><span data-stu-id="87add-144">(An “ambient transaction” is one that lives in the current thread.) All connections opened within the TransactionScope participate in the transaction.</span></span> <span data-ttu-id="87add-145">Jestliže se účastní různých databází, transakce se automaticky se zvýšenými oprávněními na distribuovanou transakci.</span><span class="sxs-lookup"><span data-stu-id="87add-145">If different databases participate, the transaction is automatically elevated to a distributed transaction.</span></span> <span data-ttu-id="87add-146">Výsledek transakce je řízena nastavením oboru k dokončení znamenat potvrzení.</span><span class="sxs-lookup"><span data-stu-id="87add-146">The outcome of the transaction is controlled by setting the scope to complete to indicate a commit.</span></span>

    using (var scope = new TransactionScope())
    {
        using (var conn1 = new SqlConnection(connStrDb1))
        {
            conn1.Open();
            SqlCommand cmd1 = conn1.CreateCommand();
            cmd1.CommandText = string.Format("insert into T1 values(1)");
            cmd1.ExecuteNonQuery();
        }

        using (var conn2 = new SqlConnection(connStrDb2))
        {
            conn2.Open();
            var cmd2 = conn2.CreateCommand();
            cmd2.CommandText = string.Format("insert into T2 values(2)");
            cmd2.ExecuteNonQuery();
        }

        scope.Complete();
    }

### <a name="sharded-database-applications"></a><span data-ttu-id="87add-147">Horizontálně dělené databázové aplikace</span><span class="sxs-lookup"><span data-stu-id="87add-147">Sharded database applications</span></span>
<span data-ttu-id="87add-148">Transakcí elastické databáze pro databázi SQL také podporují koordinace distribuované transakce, kde používáte metodu OpenConnectionForKey Klientská knihovna pro elastické databáze k otevření připojení pro škálovaný dat vrstvy.</span><span class="sxs-lookup"><span data-stu-id="87add-148">Elastic database transactions for SQL DB also support coordinating distributed transactions where you use the OpenConnectionForKey method of the elastic database client library to open connections for a scaled out data tier.</span></span> <span data-ttu-id="87add-149">Vezměte v úvahu případy, kdy potřebujete zaručit transakční konzistence na změny napříč několika různých horizontálního dělení hodnoty klíče.</span><span class="sxs-lookup"><span data-stu-id="87add-149">Consider cases where you need to guarantee transactional consistency for changes across several different sharding key values.</span></span> <span data-ttu-id="87add-150">Připojení k horizontálních oddílů hostování různých horizontálního dělení hodnoty klíče jsou zprostředkované pomocí OpenConnectionForKey.</span><span class="sxs-lookup"><span data-stu-id="87add-150">Connections to the shards hosting the different sharding key values are brokered using OpenConnectionForKey.</span></span> <span data-ttu-id="87add-151">V případě Obecné může být připojení do různých horizontálních oddílů tak, že zajistíte transakční záruky vyžaduje distribuované transakce.</span><span class="sxs-lookup"><span data-stu-id="87add-151">In the general case, the connections can be to different shards such that ensuring transactional guarantees requires a distributed transaction.</span></span> <span data-ttu-id="87add-152">Následující příklad kódu ukazuje tento přístup.</span><span class="sxs-lookup"><span data-stu-id="87add-152">The following code sample illustrates this approach.</span></span> <span data-ttu-id="87add-153">Předpokládá, že proměnné s názvem shardmap se používá k reprezentování mapu horizontálního oddílu z klientské knihovny pro elastické databáze:</span><span class="sxs-lookup"><span data-stu-id="87add-153">It assumes that a variable called shardmap is used to represent a shard map from the elastic database client library:</span></span>

    using (var scope = new TransactionScope())
    {
        using (var conn1 = shardmap.OpenConnectionForKey(tenantId1, credentialsStr))
        {
            conn1.Open();
            SqlCommand cmd1 = conn1.CreateCommand();
            cmd1.CommandText = string.Format("insert into T1 values(1)");
            cmd1.ExecuteNonQuery();
        }

        using (var conn2 = shardmap.OpenConnectionForKey(tenantId2, credentialsStr))
        {
            conn2.Open();
            var cmd2 = conn2.CreateCommand();
            cmd2.CommandText = string.Format("insert into T1 values(2)");
            cmd2.ExecuteNonQuery();
        }

        scope.Complete();
    }


## <a name="net-installation-for-azure-cloud-services"></a><span data-ttu-id="87add-154">Instalace rozhraní .NET pro Azure Cloud Services</span><span class="sxs-lookup"><span data-stu-id="87add-154">.NET installation for Azure Cloud Services</span></span>
<span data-ttu-id="87add-155">Azure poskytuje několik nabídky k hostování aplikací založených na rozhraní .NET.</span><span class="sxs-lookup"><span data-stu-id="87add-155">Azure provides several offerings to host .NET applications.</span></span> <span data-ttu-id="87add-156">Porovnání různé nabídky jsou k dispozici v [porovnání služby Azure App Service, cloudové služby a virtuální počítače](../app-service-web/choose-web-site-cloud-service-vm.md).</span><span class="sxs-lookup"><span data-stu-id="87add-156">A comparison of the different offerings is available in [Azure App Service, Cloud Services, and Virtual Machines comparison](../app-service-web/choose-web-site-cloud-service-vm.md).</span></span> <span data-ttu-id="87add-157">Pokud hostovaný operační systém nabídky je menší než .NET 4.6.1 vyžaduje pro elastické transakce, budete muset upgradovat hostovaný operační systém na 4.6.1.</span><span class="sxs-lookup"><span data-stu-id="87add-157">If the guest OS of the offering is smaller than .NET 4.6.1 required for elastic transactions, you need to upgrade the guest OS to 4.6.1.</span></span> 

<span data-ttu-id="87add-158">Pro aplikační služby Azure nejsou aktuálně podporované upgrady hostovaný operační systém.</span><span class="sxs-lookup"><span data-stu-id="87add-158">For Azure App Services, upgrades to the guest OS are currently not supported.</span></span> <span data-ttu-id="87add-159">Pro virtuální počítače Azure, jednoduše Přihlaste se k virtuálnímu počítači a spusťte instalační program pro nejnovější rozhraní .NET framework.</span><span class="sxs-lookup"><span data-stu-id="87add-159">For Azure Virtual Machines, simply log into the VM and run the installer for the latest .NET framework.</span></span> <span data-ttu-id="87add-160">Azure Cloud Services musíte zahrnout instalaci novější verze rozhraní .NET do spuštění úlohy nasazení.</span><span class="sxs-lookup"><span data-stu-id="87add-160">For Azure Cloud Services, you need to include the installation of a newer .NET version into the startup tasks of your deployment.</span></span> <span data-ttu-id="87add-161">Principy a postupy popsané v [nainstalovat rozhraní .NET v roli služby Cloud](../cloud-services/cloud-services-dotnet-install-dotnet.md).</span><span class="sxs-lookup"><span data-stu-id="87add-161">The concepts and steps are documented in [Install .NET on a Cloud Service Role](../cloud-services/cloud-services-dotnet-install-dotnet.md).</span></span>  

<span data-ttu-id="87add-162">Všimněte si, že instalační program pro .NET 4.6.1 může vyžadovat další dočasné úložiště během procesu samozaváděcí na cloudové služby Azure než instalační program pro .NET 4.6.</span><span class="sxs-lookup"><span data-stu-id="87add-162">Note that the installer for .NET 4.6.1 may require more temporary storage during the bootstrapping process on Azure cloud services than the installer for .NET 4.6.</span></span> <span data-ttu-id="87add-163">Chcete-li zajistit úspěšnou instalaci, je potřeba zvýšit dočasné úložiště pro cloudové služby Azure v souboru ServiceDefinition.csdef v části LocalResources a nastavení prostředí spuštění úkolu, jak znázorňuje následující ukázka:</span><span class="sxs-lookup"><span data-stu-id="87add-163">To ensure a successful installation, you need to increase temporary storage for your Azure cloud service in your ServiceDefinition.csdef file in the LocalResources section and the environment settings of your startup task, as shown in the following sample:</span></span>

    <LocalResources>
    ...
        <LocalStorage name="TEMP" sizeInMB="5000" cleanOnRoleRecycle="false" />
        <LocalStorage name="TMP" sizeInMB="5000" cleanOnRoleRecycle="false" />
    </LocalResources>
    <Startup>
        <Task commandLine="install.cmd" executionContext="elevated" taskType="simple">
            <Environment>
        ...
                <Variable name="TEMP">
                    <RoleInstanceValue xpath="/RoleEnvironment/CurrentInstance/LocalResources/LocalResource[@name='TEMP']/@path" />
                </Variable>
                <Variable name="TMP">
                    <RoleInstanceValue xpath="/RoleEnvironment/CurrentInstance/LocalResources/LocalResource[@name='TMP']/@path" />
                </Variable>
            </Environment>
        </Task>
    </Startup>

## <a name="transactions-across-multiple-servers"></a><span data-ttu-id="87add-164">Transakce na více serverech</span><span class="sxs-lookup"><span data-stu-id="87add-164">Transactions across multiple servers</span></span>
<span data-ttu-id="87add-165">Transakce elastické databáze jsou podporovány na různé servery logické ve službě Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="87add-165">Elastic database transactions are supported across different logical servers in Azure SQL Database.</span></span> <span data-ttu-id="87add-166">Pokud transakce kříží hranice logického serveru, zúčastněných serverů nejprve je třeba zadat do vztahu vzájemné komunikaci.</span><span class="sxs-lookup"><span data-stu-id="87add-166">When transactions cross logical server boundaries, the participating servers first need to be entered into a mutual communication relationship.</span></span> <span data-ttu-id="87add-167">Po vytvoření relace komunikace, všechny databáze v některém ze dvou serverů účastnit elastické transakcí s databází z druhý server.</span><span class="sxs-lookup"><span data-stu-id="87add-167">Once the communication relationship has been established, any database in any of the two servers can participate in elastic transactions with databases from the other server.</span></span> <span data-ttu-id="87add-168">Vztah komunikace s transakcemi pokrývání uzlů více než dva logické servery, musí být nastavené pro jakýkoli pár logické servery.</span><span class="sxs-lookup"><span data-stu-id="87add-168">With transactions spanning more than two logical servers, a communication relationship needs to be in place for any pair of logical servers.</span></span>

<span data-ttu-id="87add-169">Správa vztahů komunikaci mezi servery pro transakcí elastické databáze pomocí následující rutiny prostředí PowerShell:</span><span class="sxs-lookup"><span data-stu-id="87add-169">Use the following PowerShell cmdlets to manage cross-server communication relationships for elastic database transactions:</span></span>

* <span data-ttu-id="87add-170">**Nové AzureRmSqlServerCommunicationLink**: tuto rutinu použijte k vytvoření nového vztahu komunikace mezi dvěma logické servery v databázi SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="87add-170">**New-AzureRmSqlServerCommunicationLink**: Use this cmdlet to create a new communication relationship between two logical servers in Azure SQL DB.</span></span> <span data-ttu-id="87add-171">Relace je symetrický, což znamená, že oba servery můžete zahájit transakce s druhý server.</span><span class="sxs-lookup"><span data-stu-id="87add-171">The relationship is symmetric which means both servers can initiate transactions with the other server.</span></span>
* <span data-ttu-id="87add-172">**Get-AzureRmSqlServerCommunicationLink**: tuto rutinu použijte k načtení existující komunikace vztahy a jejich vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="87add-172">**Get-AzureRmSqlServerCommunicationLink**: Use this cmdlet to retrieve existing communication relationships and their properties.</span></span>
* <span data-ttu-id="87add-173">**Odebrat AzureRmSqlServerCommunicationLink**: pomocí této rutiny odeberte existující relaci komunikace.</span><span class="sxs-lookup"><span data-stu-id="87add-173">**Remove-AzureRmSqlServerCommunicationLink**: Use this cmdlet to remove an existing communication relationship.</span></span> 

## <a name="monitoring-transaction-status"></a><span data-ttu-id="87add-174">Monitorování stavu transakce</span><span class="sxs-lookup"><span data-stu-id="87add-174">Monitoring transaction status</span></span>
<span data-ttu-id="87add-175">Monitorování stavu a průběhu transakcí probíhající elastické databáze pomocí zobrazení dynamické správy (zobrazení dynamické správy) v databázi SQL.</span><span class="sxs-lookup"><span data-stu-id="87add-175">Use Dynamic Management Views (DMVs) in SQL DB to monitor status and progress of your ongoing elastic database transactions.</span></span> <span data-ttu-id="87add-176">Všechny zobrazení dynamické správy související s transakce jsou relevantní pro distribuované transakce v databázi SQL.</span><span class="sxs-lookup"><span data-stu-id="87add-176">All DMVs related to transactions are relevant for distributed transactions in SQL DB.</span></span> <span data-ttu-id="87add-177">Můžete najít odpovídající seznamu zobrazení dynamické správy zde: [transakce související dynamické správy zobrazení a funkce (Transact-SQL)](https://msdn.microsoft.com/library/ms178621.aspx).</span><span class="sxs-lookup"><span data-stu-id="87add-177">You can find the corresponding list of DMVs here: [Transaction Related Dynamic Management Views and Functions (Transact-SQL)](https://msdn.microsoft.com/library/ms178621.aspx).</span></span>

<span data-ttu-id="87add-178">Tato zobrazení dynamické správy jsou obzvláště užitečná:</span><span class="sxs-lookup"><span data-stu-id="87add-178">These DMVs are particularly useful:</span></span>

* <span data-ttu-id="87add-179">**Sys.DM\_tran\_active\_transakce**: uvádí aktuálně aktivních transakcí a jejich stav.</span><span class="sxs-lookup"><span data-stu-id="87add-179">**sys.dm\_tran\_active\_transactions**: Lists currently active transactions and their status.</span></span> <span data-ttu-id="87add-180">Sloupec UOW (jednotka práce) můžete určit jiné podřízené transakcí, které patří do stejné distribuované transakce.</span><span class="sxs-lookup"><span data-stu-id="87add-180">The UOW (Unit Of Work) column can identify the different child transactions that belong to the same distributed transaction.</span></span> <span data-ttu-id="87add-181">Všechny transakce v rámci stejné distribuované transakce provádění stejnou hodnotu parametru UOW.</span><span class="sxs-lookup"><span data-stu-id="87add-181">All transactions within the same distributed transaction carry the same UOW value.</span></span> <span data-ttu-id="87add-182">Najdete v článku [DMV dokumentaci](https://msdn.microsoft.com/library/ms174302.aspx) další podrobnosti.</span><span class="sxs-lookup"><span data-stu-id="87add-182">See the [DMV documentation](https://msdn.microsoft.com/library/ms174302.aspx) for more details.</span></span>
* <span data-ttu-id="87add-183">**Sys.DM\_tran\_databáze\_transakce**: poskytuje další informace o transakcích, jako je například umístění transakce v protokolu.</span><span class="sxs-lookup"><span data-stu-id="87add-183">**sys.dm\_tran\_database\_transactions**: Provides additional information about transactions, such as placement of the transaction in the log.</span></span> <span data-ttu-id="87add-184">Najdete v článku [DMV dokumentaci](https://msdn.microsoft.com/library/ms186957.aspx) další podrobnosti.</span><span class="sxs-lookup"><span data-stu-id="87add-184">See the [DMV documentation](https://msdn.microsoft.com/library/ms186957.aspx) for more details.</span></span>
* <span data-ttu-id="87add-185">**Sys.DM\_tran\_zámky**: poskytuje informace o zámky, které jsou aktuálně uložené probíhající transakce.</span><span class="sxs-lookup"><span data-stu-id="87add-185">**sys.dm\_tran\_locks**: Provides information about the locks that are currently held by ongoing transactions.</span></span> <span data-ttu-id="87add-186">Najdete v článku [DMV dokumentaci](https://msdn.microsoft.com/library/ms190345.aspx) další podrobnosti.</span><span class="sxs-lookup"><span data-stu-id="87add-186">See the [DMV documentation](https://msdn.microsoft.com/library/ms190345.aspx) for more details.</span></span>

## <a name="limitations"></a><span data-ttu-id="87add-187">Omezení</span><span class="sxs-lookup"><span data-stu-id="87add-187">Limitations</span></span>
<span data-ttu-id="87add-188">Pro elastické databáze transakce v databázi SQL aktuálně platí následující omezení:</span><span class="sxs-lookup"><span data-stu-id="87add-188">The following limitations currently apply to elastic database transactions in SQL DB:</span></span>

* <span data-ttu-id="87add-189">Jsou podporovány pouze transakce napříč databázemi v databázi SQL.</span><span class="sxs-lookup"><span data-stu-id="87add-189">Only transactions across databases in SQL DB are supported.</span></span> <span data-ttu-id="87add-190">Další [X / otevřete XA](https://en.wikipedia.org/wiki/X/Open_XA) zprostředkovatelé prostředků a databáze mimo SQL DB nemůže se podílet na transakcí elastické databáze.</span><span class="sxs-lookup"><span data-stu-id="87add-190">Other [X/Open XA](https://en.wikipedia.org/wiki/X/Open_XA) resource providers and databases outside of SQL DB cannot participate in elastic database transactions.</span></span> <span data-ttu-id="87add-191">To znamená, že transakcí elastické databáze nelze roztáhnout na místní systém SQL Server a databáze SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="87add-191">That means that elastic database transactions cannot stretch across on premises SQL Server and Azure SQL Databases.</span></span> <span data-ttu-id="87add-192">Pro distribuované transakce místně nadále používat služby MS DTC.</span><span class="sxs-lookup"><span data-stu-id="87add-192">For distributed transactions on premises, continue to use MSDTC.</span></span> 
* <span data-ttu-id="87add-193">Jsou podporovány pouze klienta koordinované transakce z aplikace .NET.</span><span class="sxs-lookup"><span data-stu-id="87add-193">Only client-coordinated transactions from a .NET application are supported.</span></span> <span data-ttu-id="87add-194">Podpora serverové T-SQL, jako je například začít DISTRIBUOVANÝCH transakcí je plánované, ale ještě není k dispozici.</span><span class="sxs-lookup"><span data-stu-id="87add-194">Server-side support for T-SQL such as BEGIN DISTRIBUTED TRANSACTION is planned, but not yet available.</span></span> 
* <span data-ttu-id="87add-195">Transakce ve službách WCF nejsou podporovány.</span><span class="sxs-lookup"><span data-stu-id="87add-195">Transactions across WCF services are not supported.</span></span> <span data-ttu-id="87add-196">Například máte metodu služby WCF, které provádí transakce.</span><span class="sxs-lookup"><span data-stu-id="87add-196">For example, you have a WCF service method that executes a transaction.</span></span> <span data-ttu-id="87add-197">Jako zachytávají v oboru transakce se nezdaří [System.ServiceModel.ProtocolException](https://msdn.microsoft.com/library/system.servicemodel.protocolexception).</span><span class="sxs-lookup"><span data-stu-id="87add-197">Enclosing the call within a transaction scope will fail as a [System.ServiceModel.ProtocolException](https://msdn.microsoft.com/library/system.servicemodel.protocolexception).</span></span>

## <a name="next-steps"></a><span data-ttu-id="87add-198">Další kroky</span><span class="sxs-lookup"><span data-stu-id="87add-198">Next steps</span></span>
<span data-ttu-id="87add-199">Máte dotazy, kontaktujte nás na [fórum SQL Database](http://social.msdn.microsoft.com/forums/azure/home?forum=ssdsgetstarted) a pro žádosti o funkce, přidejte je do [fóru pro zpětnou vazbu SQL Database](https://feedback.azure.com/forums/217321-sql-database/).</span><span class="sxs-lookup"><span data-stu-id="87add-199">For questions, please reach out to us on the [SQL Database forum](http://social.msdn.microsoft.com/forums/azure/home?forum=ssdsgetstarted) and for feature requests, please add them to the [SQL Database feedback forum](https://feedback.azure.com/forums/217321-sql-database/).</span></span>

<!--Image references-->
[1]: ./media/sql-database-elastic-transactions-overview/distributed-transactions.png



