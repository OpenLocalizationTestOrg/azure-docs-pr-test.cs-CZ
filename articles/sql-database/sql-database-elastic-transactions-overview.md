---
title: "aaaDistributed transakce napříč databázemi cloudu"
description: "Přehled transakcí elastické databáze s databází Azure SQL"
services: sql-database
documentationcenter: 
author: torsteng
manager: jhubbard
editor: torsteng
ms.assetid: e14df7a3-7788-4cfb-bcd1-7ad6433ef1f9
ms.service: sql-database
ms.custom: scale out apps
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: sql-database
ms.date: 05/27/2016
ms.author: torsteng
ms.openlocfilehash: 9a18f2749108d337bf115b3dc21dd0c7828dd9c2
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="distributed-transactions-across-cloud-databases"></a><span data-ttu-id="8848a-103">Distribuované transakce v cloudových databázích</span><span class="sxs-lookup"><span data-stu-id="8848a-103">Distributed transactions across cloud databases</span></span>
<span data-ttu-id="8848a-104">Transakcí elastické databáze pro Azure SQL Database (databáze SQL) umožňují toorun transakcí, které jsou rozmístěny v několika databází v databázi SQL.</span><span class="sxs-lookup"><span data-stu-id="8848a-104">Elastic database transactions for Azure SQL Database (SQL DB) allow you toorun transactions that span several databases in SQL DB.</span></span> <span data-ttu-id="8848a-105">Jsou k dispozici pro aplikace .NET pomocí rozhraní ADO .NET transakcí elastické databáze pro databázi SQL a integrovat hello známé programovací prostředí pomocí hello [System.Transaction](https://msdn.microsoft.com/library/system.transactions.aspx) třídy.</span><span class="sxs-lookup"><span data-stu-id="8848a-105">Elastic database transactions for SQL DB are available for .NET applications using ADO .NET and integrate with hello familiar programming experience using hello [System.Transaction](https://msdn.microsoft.com/library/system.transactions.aspx) classes.</span></span> <span data-ttu-id="8848a-106">tooget hello knihovně, najdete v části [rozhraní .NET Framework 4.6.1 (Webová instalační služba)](https://www.microsoft.com/download/details.aspx?id=49981).</span><span class="sxs-lookup"><span data-stu-id="8848a-106">tooget hello library, see [.NET Framework 4.6.1 (Web Installer)](https://www.microsoft.com/download/details.aspx?id=49981).</span></span>

<span data-ttu-id="8848a-107">Místní takové situaci většinou vyžaduje systémem Microsoft Distributed Transaction Coordinator služba MSDTC ().</span><span class="sxs-lookup"><span data-stu-id="8848a-107">On premises, such a scenario usually required running Microsoft Distributed Transaction Coordinator (MSDTC).</span></span> <span data-ttu-id="8848a-108">Vzhledem k tomu, že služby MS DTC není k dispozici pro aplikaci platforma jako služba v Azure, hello možnost toocoordinate distribuované transakce nyní přímo integrovány do databáze SQL.</span><span class="sxs-lookup"><span data-stu-id="8848a-108">Since MSDTC is not available for Platform-as-a-Service application in Azure, hello ability toocoordinate distributed transactions has now been directly integrated into SQL DB.</span></span> <span data-ttu-id="8848a-109">Aplikace se můžou připojit tooany SQL Database toolaunch distribuovaných transakcí a jedné z databází hello se transparentně koordinaci hello distribuované transakce, jak ukazuje následující obrázek hello.</span><span class="sxs-lookup"><span data-stu-id="8848a-109">Applications can connect tooany SQL Database toolaunch distributed transactions, and one of hello databases will transparently coordinate hello distributed transaction, as shown in hello following figure.</span></span> 

  ![<span data-ttu-id="8848a-110">Distribuovaná transakce s Azure SQL Database pomocí transakcí elastické databáze</span><span class="sxs-lookup"><span data-stu-id="8848a-110">Distributed transactions with Azure SQL Database using elastic database transactions</span></span> ][1]

## <a name="common-scenarios"></a><span data-ttu-id="8848a-111">Obvyklé scénáře</span><span class="sxs-lookup"><span data-stu-id="8848a-111">Common scenarios</span></span>
<span data-ttu-id="8848a-112">Transakcí elastické databáze pro databázi SQL povolte aplikace toomake atomic změny toodata uložené v několika různých databází SQL.</span><span class="sxs-lookup"><span data-stu-id="8848a-112">Elastic database transactions for SQL DB enable applications toomake atomic changes toodata stored in several different SQL Databases.</span></span> <span data-ttu-id="8848a-113">Hello preview se zaměřuje na straně klienta vývoj prostředí v C# a rozhraní .NET.</span><span class="sxs-lookup"><span data-stu-id="8848a-113">hello preview focuses on client-side development experiences in C# and .NET.</span></span> <span data-ttu-id="8848a-114">Na straně serveru zkušenosti s používáním T-SQL je naplánován na pozdější dobu.</span><span class="sxs-lookup"><span data-stu-id="8848a-114">A server-side experience using T-SQL is planned for a later time.</span></span>  
<span data-ttu-id="8848a-115">Cíle hello transakcí elastické databáze následující scénáře:</span><span class="sxs-lookup"><span data-stu-id="8848a-115">Elastic database transactions targets hello following scenarios:</span></span>

* <span data-ttu-id="8848a-116">Více databázových aplikací v Azure: Tento scénář je dat svisle rozděleného mezi několika databází v databázi SQL tak, že různé druhy dat jsou umístěné na různých databází.</span><span class="sxs-lookup"><span data-stu-id="8848a-116">Multi-database applications in Azure: With this scenario, data is vertically partitioned across several databases in SQL DB such that different kinds of data reside on different databases.</span></span> <span data-ttu-id="8848a-117">Některé operace vyžadují změny toodata, který je uložen ve dvou nebo více databází.</span><span class="sxs-lookup"><span data-stu-id="8848a-117">Some operations require changes toodata which is kept in two or more databases.</span></span> <span data-ttu-id="8848a-118">aplikace Hello používá změny hello toocoordinate transakcí elastické databáze mezi databázemi a zkontrolujte nedělitelnost.</span><span class="sxs-lookup"><span data-stu-id="8848a-118">hello application uses elastic database transactions toocoordinate hello changes across databases and ensure atomicity.</span></span>
* <span data-ttu-id="8848a-119">Horizontálně dělené databázové aplikace v Azure: Tento scénář hello Datová vrstva používá hello [klientské knihovny pro elastické databáze](sql-database-elastic-database-client-library.md) nebo samoobslužné-horizontálního dělení toohorizontally oddílu hello data mezi mnoha databázemi v databázi SQL.</span><span class="sxs-lookup"><span data-stu-id="8848a-119">Sharded database applications in Azure: With this scenario, hello data tier uses hello [Elastic Database client library](sql-database-elastic-database-client-library.md) or self-sharding toohorizontally partition hello data across many databases in SQL DB.</span></span> <span data-ttu-id="8848a-120">Jeden případ použití viditelného je hello nutné tooperform atomic změny pro horizontálně dělenou víceklientské aplikace při změny span klientů.</span><span class="sxs-lookup"><span data-stu-id="8848a-120">One prominent use case is hello need tooperform atomic changes for a sharded multi-tenant application when changes span tenants.</span></span> <span data-ttu-id="8848a-121">Představte si například přenos z jednoho klienta tooanother, oba umístěný na různých databází.</span><span class="sxs-lookup"><span data-stu-id="8848a-121">Think for instance of a transfer from one tenant tooanother, both residing on different databases.</span></span> <span data-ttu-id="8848a-122">Druhém případě je podrobných horizontálního dělení tooaccommodate požadavků na kapacitu pro velké klienta, který naopak obvykle znamená, že některé toostretch potřebám atomické operací napříč několika databází použitých pro hello, stejné klienta.</span><span class="sxs-lookup"><span data-stu-id="8848a-122">A second case is fine-grained sharding tooaccommodate capacity needs for a large tenant which in turn typically implies that some atomic operations needs toostretch across several databases used for hello same tenant.</span></span> <span data-ttu-id="8848a-123">Třetí případem je atomic aktualizace tooreference data, která se replikují mezi databázemi.</span><span class="sxs-lookup"><span data-stu-id="8848a-123">A third case is atomic updates tooreference data that are replicated across databases.</span></span> <span data-ttu-id="8848a-124">Operace Atomic, zpracovaných, podle těchto zásad můžete nyní koordinované napříč několika databází pomocí hello preview.</span><span class="sxs-lookup"><span data-stu-id="8848a-124">Atomic, transacted, operations along these lines can now be coordinated across several databases using hello preview.</span></span>
  <span data-ttu-id="8848a-125">Transakcí elastické databáze pomocí dvoufázový zápis tooensure transakce nedělitelnost mezi databázemi.</span><span class="sxs-lookup"><span data-stu-id="8848a-125">Elastic database transactions use two-phase commit tooensure transaction atomicity across databases.</span></span> <span data-ttu-id="8848a-126">Je vhodné pro transakce zahrnující méně než 100 databáze v době v rámci jedné transakce.</span><span class="sxs-lookup"><span data-stu-id="8848a-126">It is a good fit for transactions that involve less than 100 databases at a time within a single transaction.</span></span> <span data-ttu-id="8848a-127">Tato omezení nejsou vynucena, ale jeden by měl očekávat výkon a úspěšnost pro toosuffer transakcí elastické databáze při překročení těchto mezních hodnot.</span><span class="sxs-lookup"><span data-stu-id="8848a-127">These limits are not enforced, but one should expect performance and success rates for elastic database transactions toosuffer when exceeding these limits.</span></span>

## <a name="installation-and-migration"></a><span data-ttu-id="8848a-128">Instalace a migrace</span><span class="sxs-lookup"><span data-stu-id="8848a-128">Installation and migration</span></span>
<span data-ttu-id="8848a-129">prostřednictvím aktualizace knihovny .NET toohello System.Data.dll a System.Transactions.dll dostupné Hello funkce pro elastické databáze transakce v databázi SQL.</span><span class="sxs-lookup"><span data-stu-id="8848a-129">hello capabilities for elastic database transactions in SQL DB are provided through updates toohello .NET libraries System.Data.dll and System.Transactions.dll.</span></span> <span data-ttu-id="8848a-130">Hello knihovny DLL Ujistěte se, že dvojfázového zápisu se používá potřeby tooensure nedělitelnost.</span><span class="sxs-lookup"><span data-stu-id="8848a-130">hello DLLs ensure that two-phase commit is used where necessary tooensure atomicity.</span></span> <span data-ttu-id="8848a-131">vývoj aplikací toostart použití transakcí elastické databáze, nainstalujte [rozhraní .NET Framework 4.6.1](https://www.microsoft.com/download/details.aspx?id=49981) nebo novější.</span><span class="sxs-lookup"><span data-stu-id="8848a-131">toostart developing applications using elastic database transactions, install [.NET Framework 4.6.1](https://www.microsoft.com/download/details.aspx?id=49981) or a later version.</span></span> <span data-ttu-id="8848a-132">Při spuštění na dřívější verzi rozhraní .NET framework hello, transakce se nepodaří toopromote tooa distribuované transakce a k výjimce.</span><span class="sxs-lookup"><span data-stu-id="8848a-132">When running on an earlier version of hello .NET framework, transactions will fail toopromote tooa distributed transaction and an exception will be raised.</span></span>

<span data-ttu-id="8848a-133">Po instalaci můžete hello distribuované transakce rozhraní API v System.Transactions – s tooSQL připojení databáze.</span><span class="sxs-lookup"><span data-stu-id="8848a-133">After installation, you can use hello distributed transaction APIs in System.Transactions with connections tooSQL DB.</span></span> <span data-ttu-id="8848a-134">Pokud máte existující služby MSDTC aplikací pomocí těchto rozhraní API, po instalaci hello 4.6.1 jednoduše Sestavit vaše stávající aplikace pro 4.6 rozhraní .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="8848a-134">If you have existing MSDTC applications using these APIs, simply rebuild your existing applications for .NET 4.6 after installing hello 4.6.1 Framework.</span></span> <span data-ttu-id="8848a-135">Pokud projekty cílí na .NET 4.6, automaticky použijí hello aktualizovat knihovny DLL z nové verze Framework hello a distribuované transakce volání rozhraní API v kombinaci s tooSQL připojení, které teď bude úspěšné DB.</span><span class="sxs-lookup"><span data-stu-id="8848a-135">If your projects target .NET 4.6, they will automatically use hello updated DLLs from hello new Framework version and distributed transaction API calls in combination with connections tooSQL DB will now succeed.</span></span>

<span data-ttu-id="8848a-136">Mějte na paměti, že transakcí elastické databáze nevyžadují instalaci služby MSDTC.</span><span class="sxs-lookup"><span data-stu-id="8848a-136">Remember that elastic database transactions do not require installing MSDTC.</span></span> <span data-ttu-id="8848a-137">Místo toho transakcí elastické databáze jsou spravovány přímo a v databázi SQL.</span><span class="sxs-lookup"><span data-stu-id="8848a-137">Instead, elastic database transactions are directly managed by and within SQL DB.</span></span> <span data-ttu-id="8848a-138">To výrazně zjednodušuje scénářích cloudu, protože nasazení služby MS DTC není nutné toouse distribuované transakce s databázi SQL.</span><span class="sxs-lookup"><span data-stu-id="8848a-138">This significantly simplifies cloud scenarios since a deployment of MSDTC is not necessary toouse distributed transactions with SQL DB.</span></span> <span data-ttu-id="8848a-139">Oddíl 4 podrobněji vysvětluje, jak toodeploy transakcí elastické databáze a hello vyžaduje rozhraní .NET framework společně s tooAzure vaší cloudové aplikace.</span><span class="sxs-lookup"><span data-stu-id="8848a-139">Section 4 explains in more detail how toodeploy elastic database transactions and hello required .NET framework together with your cloud applications tooAzure.</span></span>

## <a name="development-experience"></a><span data-ttu-id="8848a-140">Vývojové prostředí</span><span class="sxs-lookup"><span data-stu-id="8848a-140">Development experience</span></span>
### <a name="multi-database-applications"></a><span data-ttu-id="8848a-141">Více databázové aplikace</span><span class="sxs-lookup"><span data-stu-id="8848a-141">Multi-database applications</span></span>
<span data-ttu-id="8848a-142">Hello následující vzorový kód používá programovací prostředí hello obeznámeni s System.Transactions – rozhraní .NET.</span><span class="sxs-lookup"><span data-stu-id="8848a-142">hello following sample code uses hello familiar programming experience with .NET System.Transactions.</span></span> <span data-ttu-id="8848a-143">Hello TransactionScope třída vytváří ambientní transakce v rozhraní .NET.</span><span class="sxs-lookup"><span data-stu-id="8848a-143">hello TransactionScope class establishes an ambient transaction in .NET.</span></span> <span data-ttu-id="8848a-144">("Vedlejším transakcí" je ten, který je umístěn v aktuální vlákno hello.) Všechna připojení otevřené v rámci hello TransactionScope účastnit hello transakce.</span><span class="sxs-lookup"><span data-stu-id="8848a-144">(An “ambient transaction” is one that lives in hello current thread.) All connections opened within hello TransactionScope participate in hello transaction.</span></span> <span data-ttu-id="8848a-145">Jestliže se účastní různých databází, hello transakce je automaticky zvýšenými tooa distribuované transakce.</span><span class="sxs-lookup"><span data-stu-id="8848a-145">If different databases participate, hello transaction is automatically elevated tooa distributed transaction.</span></span> <span data-ttu-id="8848a-146">výsledek Hello hello transakce je řízena nastavením hello oboru toocomplete tooindicate potvrzení.</span><span class="sxs-lookup"><span data-stu-id="8848a-146">hello outcome of hello transaction is controlled by setting hello scope toocomplete tooindicate a commit.</span></span>

    using (var scope = new TransactionScope())
    {
        using (var conn1 = new SqlConnection(connStrDb1))
        {
            conn1.Open();
            SqlCommand cmd1 = conn1.CreateCommand();
            cmd1.CommandText = string.Format("insert into T1 values(1)");
            cmd1.ExecuteNonQuery();
        }

        using (var conn2 = new SqlConnection(connStrDb2))
        {
            conn2.Open();
            var cmd2 = conn2.CreateCommand();
            cmd2.CommandText = string.Format("insert into T2 values(2)");
            cmd2.ExecuteNonQuery();
        }

        scope.Complete();
    }

### <a name="sharded-database-applications"></a><span data-ttu-id="8848a-147">Horizontálně dělené databázové aplikace</span><span class="sxs-lookup"><span data-stu-id="8848a-147">Sharded database applications</span></span>
<span data-ttu-id="8848a-148">Transakcí elastické databáze pro databázi SQL také podporují koordinace distribuované transakce, kde použijete metodu OpenConnectionForKey hello hello elastické databáze klienta knihovny tooopen připojení pro škálovaný datové vrstvy.</span><span class="sxs-lookup"><span data-stu-id="8848a-148">Elastic database transactions for SQL DB also support coordinating distributed transactions where you use hello OpenConnectionForKey method of hello elastic database client library tooopen connections for a scaled out data tier.</span></span> <span data-ttu-id="8848a-149">Vezměte v úvahu případech, kde je nutné tooguarantee transakční konzistence na změny napříč několika různých horizontálního dělení hodnoty klíče.</span><span class="sxs-lookup"><span data-stu-id="8848a-149">Consider cases where you need tooguarantee transactional consistency for changes across several different sharding key values.</span></span> <span data-ttu-id="8848a-150">Připojení toohello horizontálních oddílů hostování hello různých horizontálního dělení klíčové hodnoty jsou zprostředkované pomocí OpenConnectionForKey.</span><span class="sxs-lookup"><span data-stu-id="8848a-150">Connections toohello shards hosting hello different sharding key values are brokered using OpenConnectionForKey.</span></span> <span data-ttu-id="8848a-151">V případě obecné hello hello připojení může být horizontálních oddílů toodifferent tak, že zajistíte transakční záruky vyžaduje distribuované transakce.</span><span class="sxs-lookup"><span data-stu-id="8848a-151">In hello general case, hello connections can be toodifferent shards such that ensuring transactional guarantees requires a distributed transaction.</span></span> <span data-ttu-id="8848a-152">Následující ukázka kódu Hello ukazuje tento přístup.</span><span class="sxs-lookup"><span data-stu-id="8848a-152">hello following code sample illustrates this approach.</span></span> <span data-ttu-id="8848a-153">Se předpokládá, že se proměnné s názvem shardmap použité toorepresent horizontálního oddílu namapujte hello klientské knihovny pro elastické databáze:</span><span class="sxs-lookup"><span data-stu-id="8848a-153">It assumes that a variable called shardmap is used toorepresent a shard map from hello elastic database client library:</span></span>

    using (var scope = new TransactionScope())
    {
        using (var conn1 = shardmap.OpenConnectionForKey(tenantId1, credentialsStr))
        {
            conn1.Open();
            SqlCommand cmd1 = conn1.CreateCommand();
            cmd1.CommandText = string.Format("insert into T1 values(1)");
            cmd1.ExecuteNonQuery();
        }

        using (var conn2 = shardmap.OpenConnectionForKey(tenantId2, credentialsStr))
        {
            conn2.Open();
            var cmd2 = conn2.CreateCommand();
            cmd2.CommandText = string.Format("insert into T1 values(2)");
            cmd2.ExecuteNonQuery();
        }

        scope.Complete();
    }


## <a name="net-installation-for-azure-cloud-services"></a><span data-ttu-id="8848a-154">Instalace rozhraní .NET pro Azure Cloud Services</span><span class="sxs-lookup"><span data-stu-id="8848a-154">.NET installation for Azure Cloud Services</span></span>
<span data-ttu-id="8848a-155">Azure poskytuje několik nabídek toohost aplikací .NET.</span><span class="sxs-lookup"><span data-stu-id="8848a-155">Azure provides several offerings toohost .NET applications.</span></span> <span data-ttu-id="8848a-156">Porovnání hello různé nabídky jsou k dispozici v [porovnání služby Azure App Service, cloudové služby a virtuální počítače](../app-service-web/choose-web-site-cloud-service-vm.md).</span><span class="sxs-lookup"><span data-stu-id="8848a-156">A comparison of hello different offerings is available in [Azure App Service, Cloud Services, and Virtual Machines comparison](../app-service-web/choose-web-site-cloud-service-vm.md).</span></span> <span data-ttu-id="8848a-157">Pokud hello hostovaný operační systém nabídky hello je menší než .NET 4.6.1 vyžaduje pro elastické transakce, je třeba tooupgrade hello hostovaného operačního systému too4.6.1.</span><span class="sxs-lookup"><span data-stu-id="8848a-157">If hello guest OS of hello offering is smaller than .NET 4.6.1 required for elastic transactions, you need tooupgrade hello guest OS too4.6.1.</span></span> 

<span data-ttu-id="8848a-158">Aplikační služby Azure provede upgrade hostované toohello OS nejsou aktuálně podporovány.</span><span class="sxs-lookup"><span data-stu-id="8848a-158">For Azure App Services, upgrades toohello guest OS are currently not supported.</span></span> <span data-ttu-id="8848a-159">Pro virtuální počítače Azure, jednoduše přihlaste hello virtuální počítač a spusťte instalační program hello hello nejnovější rozhraní .NET framework.</span><span class="sxs-lookup"><span data-stu-id="8848a-159">For Azure Virtual Machines, simply log into hello VM and run hello installer for hello latest .NET framework.</span></span> <span data-ttu-id="8848a-160">Pro Azure Cloud Services budete potřebovat tooinclude hello instalaci novější verze rozhraní .NET do hello spuštění úlohy nasazení.</span><span class="sxs-lookup"><span data-stu-id="8848a-160">For Azure Cloud Services, you need tooinclude hello installation of a newer .NET version into hello startup tasks of your deployment.</span></span> <span data-ttu-id="8848a-161">Koncepty Hello a kroky popsané v [nainstalovat rozhraní .NET v roli služby Cloud](../cloud-services/cloud-services-dotnet-install-dotnet.md).</span><span class="sxs-lookup"><span data-stu-id="8848a-161">hello concepts and steps are documented in [Install .NET on a Cloud Service Role](../cloud-services/cloud-services-dotnet-install-dotnet.md).</span></span>  

<span data-ttu-id="8848a-162">Všimněte si, že hello instalační program pro .NET 4.6.1 může vyžadovat další dočasné úložiště během zavádění procesu v cloudových služeb Azure, než instalační program pro .NET 4.6 hello hello.</span><span class="sxs-lookup"><span data-stu-id="8848a-162">Note that hello installer for .NET 4.6.1 may require more temporary storage during hello bootstrapping process on Azure cloud services than hello installer for .NET 4.6.</span></span> <span data-ttu-id="8848a-163">tooensure úspěšnou instalaci, musíte tooincrease dočasné úložiště pro cloudové služby Azure v souboru ServiceDefinition.csdef v části LocalResources hello a nastavení prostředí hello spuštění úkolu, jak je znázorněno v následující hello Ukázka:</span><span class="sxs-lookup"><span data-stu-id="8848a-163">tooensure a successful installation, you need tooincrease temporary storage for your Azure cloud service in your ServiceDefinition.csdef file in hello LocalResources section and hello environment settings of your startup task, as shown in hello following sample:</span></span>

    <LocalResources>
    ...
        <LocalStorage name="TEMP" sizeInMB="5000" cleanOnRoleRecycle="false" />
        <LocalStorage name="TMP" sizeInMB="5000" cleanOnRoleRecycle="false" />
    </LocalResources>
    <Startup>
        <Task commandLine="install.cmd" executionContext="elevated" taskType="simple">
            <Environment>
        ...
                <Variable name="TEMP">
                    <RoleInstanceValue xpath="/RoleEnvironment/CurrentInstance/LocalResources/LocalResource[@name='TEMP']/@path" />
                </Variable>
                <Variable name="TMP">
                    <RoleInstanceValue xpath="/RoleEnvironment/CurrentInstance/LocalResources/LocalResource[@name='TMP']/@path" />
                </Variable>
            </Environment>
        </Task>
    </Startup>

## <a name="transactions-across-multiple-servers"></a><span data-ttu-id="8848a-164">Transakce na více serverech</span><span class="sxs-lookup"><span data-stu-id="8848a-164">Transactions across multiple servers</span></span>
<span data-ttu-id="8848a-165">Transakce elastické databáze jsou podporovány na různé servery logické ve službě Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="8848a-165">Elastic database transactions are supported across different logical servers in Azure SQL Database.</span></span> <span data-ttu-id="8848a-166">Pokud transakce kříží hranice logického serveru, nejprve zúčastněných serverů hello toobe vloženy do vztahu vzájemné komunikaci.</span><span class="sxs-lookup"><span data-stu-id="8848a-166">When transactions cross logical server boundaries, hello participating servers first need toobe entered into a mutual communication relationship.</span></span> <span data-ttu-id="8848a-167">Po vytvoření relace hello komunikace, všechny databáze v některém z hello dva servery mohl účastnit elastické transakcí s databází z hello jiný server.</span><span class="sxs-lookup"><span data-stu-id="8848a-167">Once hello communication relationship has been established, any database in any of hello two servers can participate in elastic transactions with databases from hello other server.</span></span> <span data-ttu-id="8848a-168">S transakcemi pokrývání uzlů více než dva logické servery vztahu komunikace pro jakýkoli pár logické servery potřebuje toobe na místě.</span><span class="sxs-lookup"><span data-stu-id="8848a-168">With transactions spanning more than two logical servers, a communication relationship needs toobe in place for any pair of logical servers.</span></span>

<span data-ttu-id="8848a-169">Použijte hello následující rutiny prostředí PowerShell toomanage komunikaci mezi servery vztahy transakcí elastické databáze:</span><span class="sxs-lookup"><span data-stu-id="8848a-169">Use hello following PowerShell cmdlets toomanage cross-server communication relationships for elastic database transactions:</span></span>

* <span data-ttu-id="8848a-170">**Nové AzureRmSqlServerCommunicationLink**: pomocí této rutiny toocreate nový vztah komunikaci mezi dvěma logické servery v databázi SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="8848a-170">**New-AzureRmSqlServerCommunicationLink**: Use this cmdlet toocreate a new communication relationship between two logical servers in Azure SQL DB.</span></span> <span data-ttu-id="8848a-171">Hello relace je symetrický, což znamená, že oba servery můžete zahájit transakce s hello jiný server.</span><span class="sxs-lookup"><span data-stu-id="8848a-171">hello relationship is symmetric which means both servers can initiate transactions with hello other server.</span></span>
* <span data-ttu-id="8848a-172">**Get-AzureRmSqlServerCommunicationLink**: pomocí této rutiny tooretrieve stávající komunikace vztahy a jejich vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="8848a-172">**Get-AzureRmSqlServerCommunicationLink**: Use this cmdlet tooretrieve existing communication relationships and their properties.</span></span>
* <span data-ttu-id="8848a-173">**Odebrat AzureRmSqlServerCommunicationLink**: pomocí této rutiny tooremove existující relaci komunikace.</span><span class="sxs-lookup"><span data-stu-id="8848a-173">**Remove-AzureRmSqlServerCommunicationLink**: Use this cmdlet tooremove an existing communication relationship.</span></span> 

## <a name="monitoring-transaction-status"></a><span data-ttu-id="8848a-174">Monitorování stavu transakce</span><span class="sxs-lookup"><span data-stu-id="8848a-174">Monitoring transaction status</span></span>
<span data-ttu-id="8848a-175">Pomocí zobrazení dynamické správy (zobrazení dynamické správy) v databázi SQL toomonitor stav a průběh transakcí probíhající elastické databáze.</span><span class="sxs-lookup"><span data-stu-id="8848a-175">Use Dynamic Management Views (DMVs) in SQL DB toomonitor status and progress of your ongoing elastic database transactions.</span></span> <span data-ttu-id="8848a-176">Všechny související tootransactions zobrazení dynamické správy jsou relevantní pro distribuované transakce v databázi SQL.</span><span class="sxs-lookup"><span data-stu-id="8848a-176">All DMVs related tootransactions are relevant for distributed transactions in SQL DB.</span></span> <span data-ttu-id="8848a-177">Můžete najít hello odpovídající seznam zobrazení dynamické správy zde: [transakce související dynamické správy zobrazení a funkce (Transact-SQL)](https://msdn.microsoft.com/library/ms178621.aspx).</span><span class="sxs-lookup"><span data-stu-id="8848a-177">You can find hello corresponding list of DMVs here: [Transaction Related Dynamic Management Views and Functions (Transact-SQL)](https://msdn.microsoft.com/library/ms178621.aspx).</span></span>

<span data-ttu-id="8848a-178">Tato zobrazení dynamické správy jsou obzvláště užitečná:</span><span class="sxs-lookup"><span data-stu-id="8848a-178">These DMVs are particularly useful:</span></span>

* <span data-ttu-id="8848a-179">**Sys.DM\_tran\_active\_transakce**: uvádí aktuálně aktivních transakcí a jejich stav.</span><span class="sxs-lookup"><span data-stu-id="8848a-179">**sys.dm\_tran\_active\_transactions**: Lists currently active transactions and their status.</span></span> <span data-ttu-id="8848a-180">Hello sloupec UOW (jednotka práce) lze identifikovat hello jiné podřízené transakcí, které patří toohello stejné distribuované transakce.</span><span class="sxs-lookup"><span data-stu-id="8848a-180">hello UOW (Unit Of Work) column can identify hello different child transactions that belong toohello same distributed transaction.</span></span> <span data-ttu-id="8848a-181">Všechny transakce v rámci stejné distribuované transakce provádění hello hello stejnou hodnotu parametru UOW.</span><span class="sxs-lookup"><span data-stu-id="8848a-181">All transactions within hello same distributed transaction carry hello same UOW value.</span></span> <span data-ttu-id="8848a-182">V tématu hello [DMV dokumentaci](https://msdn.microsoft.com/library/ms174302.aspx) další podrobnosti.</span><span class="sxs-lookup"><span data-stu-id="8848a-182">See hello [DMV documentation](https://msdn.microsoft.com/library/ms174302.aspx) for more details.</span></span>
* <span data-ttu-id="8848a-183">**Sys.DM\_tran\_databáze\_transakce**: poskytuje další informace o transakcích, jako je například umístění hello transakce v protokolu hello.</span><span class="sxs-lookup"><span data-stu-id="8848a-183">**sys.dm\_tran\_database\_transactions**: Provides additional information about transactions, such as placement of hello transaction in hello log.</span></span> <span data-ttu-id="8848a-184">V tématu hello [DMV dokumentaci](https://msdn.microsoft.com/library/ms186957.aspx) další podrobnosti.</span><span class="sxs-lookup"><span data-stu-id="8848a-184">See hello [DMV documentation](https://msdn.microsoft.com/library/ms186957.aspx) for more details.</span></span>
* <span data-ttu-id="8848a-185">**Sys.DM\_tran\_zámky**: poskytuje informace o hello zámky, které jsou aktuálně uložené probíhající transakce.</span><span class="sxs-lookup"><span data-stu-id="8848a-185">**sys.dm\_tran\_locks**: Provides information about hello locks that are currently held by ongoing transactions.</span></span> <span data-ttu-id="8848a-186">V tématu hello [DMV dokumentaci](https://msdn.microsoft.com/library/ms190345.aspx) další podrobnosti.</span><span class="sxs-lookup"><span data-stu-id="8848a-186">See hello [DMV documentation](https://msdn.microsoft.com/library/ms190345.aspx) for more details.</span></span>

## <a name="limitations"></a><span data-ttu-id="8848a-187">Omezení</span><span class="sxs-lookup"><span data-stu-id="8848a-187">Limitations</span></span>
<span data-ttu-id="8848a-188">Hello aktuálně následující omezení platí tooelastic databázové transakce v databázi SQL:</span><span class="sxs-lookup"><span data-stu-id="8848a-188">hello following limitations currently apply tooelastic database transactions in SQL DB:</span></span>

* <span data-ttu-id="8848a-189">Jsou podporovány pouze transakce napříč databázemi v databázi SQL.</span><span class="sxs-lookup"><span data-stu-id="8848a-189">Only transactions across databases in SQL DB are supported.</span></span> <span data-ttu-id="8848a-190">Další [X / otevřete XA](https://en.wikipedia.org/wiki/X/Open_XA) zprostředkovatelé prostředků a databáze mimo SQL DB nemůže se podílet na transakcí elastické databáze.</span><span class="sxs-lookup"><span data-stu-id="8848a-190">Other [X/Open XA](https://en.wikipedia.org/wiki/X/Open_XA) resource providers and databases outside of SQL DB cannot participate in elastic database transactions.</span></span> <span data-ttu-id="8848a-191">To znamená, že transakcí elastické databáze nelze roztáhnout na místní systém SQL Server a databáze SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="8848a-191">That means that elastic database transactions cannot stretch across on premises SQL Server and Azure SQL Databases.</span></span> <span data-ttu-id="8848a-192">Pro distribuované transakce místně pokračujte toouse služba MSDTC.</span><span class="sxs-lookup"><span data-stu-id="8848a-192">For distributed transactions on premises, continue toouse MSDTC.</span></span> 
* <span data-ttu-id="8848a-193">Jsou podporovány pouze klienta koordinované transakce z aplikace .NET.</span><span class="sxs-lookup"><span data-stu-id="8848a-193">Only client-coordinated transactions from a .NET application are supported.</span></span> <span data-ttu-id="8848a-194">Podpora serverové T-SQL, jako je například začít DISTRIBUOVANÝCH transakcí je plánované, ale ještě není k dispozici.</span><span class="sxs-lookup"><span data-stu-id="8848a-194">Server-side support for T-SQL such as BEGIN DISTRIBUTED TRANSACTION is planned, but not yet available.</span></span> 
* <span data-ttu-id="8848a-195">Transakce ve službách WCF nejsou podporovány.</span><span class="sxs-lookup"><span data-stu-id="8848a-195">Transactions across WCF services are not supported.</span></span> <span data-ttu-id="8848a-196">Například máte metodu služby WCF, které provádí transakce.</span><span class="sxs-lookup"><span data-stu-id="8848a-196">For example, you have a WCF service method that executes a transaction.</span></span> <span data-ttu-id="8848a-197">Jako uzavření hello volání v oboru transakce se nezdaří [System.ServiceModel.ProtocolException](https://msdn.microsoft.com/library/system.servicemodel.protocolexception).</span><span class="sxs-lookup"><span data-stu-id="8848a-197">Enclosing hello call within a transaction scope will fail as a [System.ServiceModel.ProtocolException](https://msdn.microsoft.com/library/system.servicemodel.protocolexception).</span></span>

## <a name="next-steps"></a><span data-ttu-id="8848a-198">Další kroky</span><span class="sxs-lookup"><span data-stu-id="8848a-198">Next steps</span></span>
<span data-ttu-id="8848a-199">Máte dotazy, kontaktujte toous na hello [SQL Database fórum](http://social.msdn.microsoft.com/forums/azure/home?forum=ssdsgetstarted) a pro žádosti o funkce, přidejte je toohello [fóru pro zpětnou vazbu SQL Database](https://feedback.azure.com/forums/217321-sql-database/).</span><span class="sxs-lookup"><span data-stu-id="8848a-199">For questions, please reach out toous on hello [SQL Database forum](http://social.msdn.microsoft.com/forums/azure/home?forum=ssdsgetstarted) and for feature requests, please add them toohello [SQL Database feedback forum](https://feedback.azure.com/forums/217321-sql-database/).</span></span>

<!--Image references-->
[1]: ./media/sql-database-elastic-transactions-overview/distributed-transactions.png



