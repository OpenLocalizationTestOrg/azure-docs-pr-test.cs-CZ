---
title: "aaaMoving data mezi databázemi upraveným cloudu | Microsoft Docs"
description: "Vysvětluje, jak toomanipulate horizontálních oddílů a přesunutí dat prostřednictvím automatických hostované služby pomocí Elastická databáze rozhraní API."
services: sql-database
documentationcenter: 
manager: jhubbard
author: ddove
ms.assetid: 204fd902-0397-4185-985a-dea3ed7c7d9f
ms.service: sql-database
ms.custom: scale out apps
ms.workload: sql-database
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 10/24/2016
ms.author: ddove
ms.openlocfilehash: 629dee06e22609e9b61edf93ba5c38d997132d8c
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="moving-data-between-scaled-out-cloud-databases"></a><span data-ttu-id="e9c6a-103">Přesun dat mezi cloudovými databázemi s horizontálním navýšením kapacity</span><span class="sxs-lookup"><span data-stu-id="e9c6a-103">Moving data between scaled-out cloud databases</span></span>
<span data-ttu-id="e9c6a-104">Pokud jste Software jako služba developer a najednou aplikace zde nevyskytlo strávíte vyžádání, je třeba tooaccommodate hello růstu.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-104">If you are a Software as a Service developer, and suddenly your app undergoes tremendous demand, you need tooaccommodate hello growth.</span></span> <span data-ttu-id="e9c6a-105">Proto můžete přidat další databáze (horizontálních oddílů).</span><span class="sxs-lookup"><span data-stu-id="e9c6a-105">So you add more databases (shards).</span></span> <span data-ttu-id="e9c6a-106">Jak opětovné distribuci hello data toohello nové databáze a to bez přerušení hello integritu dat?</span><span class="sxs-lookup"><span data-stu-id="e9c6a-106">How do you redistribute hello data toohello new databases without disrupting hello data integrity?</span></span> <span data-ttu-id="e9c6a-107">Použití hello **nástroji pro sloučení rozdělení** toomove data z omezené databáze toohello nové databáze.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-107">Use hello **split-merge tool** toomove data from constrained databases toohello new databases.</span></span>  

<span data-ttu-id="e9c6a-108">Hello rozdělení sloučení nástroj spouští jako Azure webové služby.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-108">hello split-merge tool runs as an Azure web service.</span></span> <span data-ttu-id="e9c6a-109">Správce nebo vývojáře používá hello nástroj toomove shardlets (data z horizontálního oddílu) mezi různých databází (horizontálních oddílů).</span><span class="sxs-lookup"><span data-stu-id="e9c6a-109">An administrator or developer uses hello tool toomove shardlets (data from a shard) between different databases (shards).</span></span> <span data-ttu-id="e9c6a-110">Nástroj Hello používá metadata databáze služby toomaintain hello horizontálního oddílu mapy správy a zajistit konzistentní mapování.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-110">hello tool uses shard map management toomaintain hello service metadata database, and ensure consistent mappings.</span></span>

![Přehled][1]

## <a name="download"></a><span data-ttu-id="e9c6a-112">Ke stažení</span><span class="sxs-lookup"><span data-stu-id="e9c6a-112">Download</span></span>
[<span data-ttu-id="e9c6a-113">Microsoft.Azure.SqlDatabase.ElasticScale.Service.SplitMerge</span><span class="sxs-lookup"><span data-stu-id="e9c6a-113">Microsoft.Azure.SqlDatabase.ElasticScale.Service.SplitMerge</span></span>](http://www.nuget.org/packages/Microsoft.Azure.SqlDatabase.ElasticScale.Service.SplitMerge/)

## <a name="documentation"></a><span data-ttu-id="e9c6a-114">Dokumentace</span><span class="sxs-lookup"><span data-stu-id="e9c6a-114">Documentation</span></span>
1. [<span data-ttu-id="e9c6a-115">Kurz nástroje elastické databáze rozdělení sloučení</span><span class="sxs-lookup"><span data-stu-id="e9c6a-115">Elastic database Split-Merge tool tutorial</span></span>](sql-database-elastic-scale-configure-deploy-split-and-merge.md)
2. [<span data-ttu-id="e9c6a-116">Konfigurace zabezpečení rozdělení sloučení</span><span class="sxs-lookup"><span data-stu-id="e9c6a-116">Split-Merge security configuration</span></span>](sql-database-elastic-scale-split-merge-security-configuration.md)
3. [<span data-ttu-id="e9c6a-117">Aspekty zabezpečení rozdělení sloučení</span><span class="sxs-lookup"><span data-stu-id="e9c6a-117">Split-merge security considerations</span></span>](sql-database-elastic-scale-split-merge-security-configuration.md)
4. [<span data-ttu-id="e9c6a-118">Správa mapování horizontálních oddílů</span><span class="sxs-lookup"><span data-stu-id="e9c6a-118">Shard map management</span></span>](sql-database-elastic-scale-shard-map-management.md)
5. [<span data-ttu-id="e9c6a-119">Migrovat existující databáze tooscale na více systémů</span><span class="sxs-lookup"><span data-stu-id="e9c6a-119">Migrate existing databases tooscale-out</span></span>](sql-database-elastic-convert-to-use-elastic-tools.md)
6. [<span data-ttu-id="e9c6a-120">Nástroje elastické databáze</span><span class="sxs-lookup"><span data-stu-id="e9c6a-120">Elastic database tools</span></span>](sql-database-elastic-scale-introduction.md)
7. [<span data-ttu-id="e9c6a-121">Glosář nástroje elastické databáze</span><span class="sxs-lookup"><span data-stu-id="e9c6a-121">Elastic Database tools glossary</span></span>](sql-database-elastic-scale-glossary.md)

## <a name="why-use-hello-split-merge-tool"></a><span data-ttu-id="e9c6a-122">Proč používat nástroj rozdělení sloučení hello?</span><span class="sxs-lookup"><span data-stu-id="e9c6a-122">Why use hello split-merge tool?</span></span>
<span data-ttu-id="e9c6a-123">**Flexibilita**</span><span class="sxs-lookup"><span data-stu-id="e9c6a-123">**Flexibility**</span></span>

<span data-ttu-id="e9c6a-124">Aplikace potřebují toostretch flexibilně mimo hranice hello služby jedné databáze Azure SQL DB.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-124">Applications need toostretch flexibly beyond hello limits of a single Azure SQL DB database.</span></span> <span data-ttu-id="e9c6a-125">Použijte hello nástroj toomove data jako potřebné toonew databáze při zachování integrity.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-125">Use hello tool toomove data as needed toonew databases while retaining integrity.</span></span>

<span data-ttu-id="e9c6a-126">**Rozdělení toogrow**</span><span class="sxs-lookup"><span data-stu-id="e9c6a-126">**Split toogrow**</span></span> 

<span data-ttu-id="e9c6a-127">Je třeba tooincrease celkové kapacity toohandle výrazný růst.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-127">You need tooincrease overall capacity toohandle explosive growth.</span></span> <span data-ttu-id="e9c6a-128">toodo tedy vytvořit další kapacitu, horizontálního dělení hello dat a rozděluje mezi přírůstkově více databází, dokud se splnění požadavků na kapacitu.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-128">toodo so, create additional capacity by sharding hello data and by distributing it across incrementally more databases until capacity needs are fulfilled.</span></span> <span data-ttu-id="e9c6a-129">Toto je typickým příkladem hello 'rozdělení' funkce.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-129">This is a prime example of hello ‘split’ feature.</span></span> 

<span data-ttu-id="e9c6a-130">**Sloučení tooshrink**</span><span class="sxs-lookup"><span data-stu-id="e9c6a-130">**Merge tooshrink**</span></span>

<span data-ttu-id="e9c6a-131">Kapacita musí zmenšit z důvodu toohello sezónní povahy firmy.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-131">Capacity needs shrink due toohello seasonal nature of a business.</span></span> <span data-ttu-id="e9c6a-132">nástroj umožňuje Hello snižovat toofewer jednotek škálování, když obchodní zpomalí.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-132">hello tool lets you scale down toofewer scale units when business slows.</span></span> <span data-ttu-id="e9c6a-133">funkce "sloučení" Hello v hello elastické škálování rozdělení sloučení služby obsahuje tento požadavek.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-133">hello ‘merge’ feature in hello Elastic Scale split-merge Service covers this requirement.</span></span> 

<span data-ttu-id="e9c6a-134">**Spravovat hotspotům přesunutím shardlets**</span><span class="sxs-lookup"><span data-stu-id="e9c6a-134">**Manage hotspots by moving shardlets**</span></span>

<span data-ttu-id="e9c6a-135">S více klienty na databázi může hello přidělení shardlets tooshards vést toocapacity kritická místa na některé horizontálních oddílů.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-135">With multiple tenants per database, hello allocation of shardlets tooshards can lead toocapacity bottlenecks on some shards.</span></span> <span data-ttu-id="e9c6a-136">To vyžaduje znovu přidělování shardlets nebo přesunutí zaneprázdněn shardlets toonew nebo méně využívané horizontálních oddílů.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-136">This requires re-allocating shardlets or moving busy shardlets toonew or less utilized shards.</span></span> 

## <a name="concepts--key-features"></a><span data-ttu-id="e9c6a-137">Koncepty & klíčové funkce</span><span class="sxs-lookup"><span data-stu-id="e9c6a-137">Concepts & key features</span></span>
<span data-ttu-id="e9c6a-138">**Zákazník hostované služby**</span><span class="sxs-lookup"><span data-stu-id="e9c6a-138">**Customer-hosted services**</span></span>

<span data-ttu-id="e9c6a-139">rozdělení korespondence Hello je dodávána jako zákazník hostované služby.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-139">hello split-merge is delivered as a customer-hosted service.</span></span> <span data-ttu-id="e9c6a-140">Musíte nasadit a hostování hello služby v rámci vašeho předplatného Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-140">You must deploy and host hello service in your Microsoft Azure subscription.</span></span> <span data-ttu-id="e9c6a-141">Hello balíček, který si stáhnout z NuGet obsahuje toocomplete šablony konfigurace s hello informace pro konkrétní nasazení.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-141">hello package you download from NuGet contains a configuration template toocomplete with hello information for your specific deployment.</span></span> <span data-ttu-id="e9c6a-142">V tématu hello [rozdělení sloučení kurzu](sql-database-elastic-scale-configure-deploy-split-and-merge.md) podrobnosti.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-142">See hello [split-merge tutorial](sql-database-elastic-scale-configure-deploy-split-and-merge.md) for details.</span></span> <span data-ttu-id="e9c6a-143">Vzhledem k tomu, že služba hello běží ve vašem předplatném Azure, můžete řídit a nakonfigurovat většinu aspektů zabezpečení služby hello.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-143">Since hello service runs in your Azure subscription, you can control and configure most security aspects of hello service.</span></span> <span data-ttu-id="e9c6a-144">Hello výchozí šablony zahrnuje tooconfigure hello možností protokolu SSL, ověřování na základě certifikátu klienta, šifrování pro uložené přihlašovací údaje, DoS ochrana a omezení IP adres.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-144">hello default template includes hello options tooconfigure SSL, certificate-based client authentication, encryption for stored credentials, DoS guarding and IP restrictions.</span></span> <span data-ttu-id="e9c6a-145">Další informace naleznete na hello aspekty zabezpečení v následujícím dokumentu hello [konfigurace zabezpečení rozdělení sloučení](sql-database-elastic-scale-split-merge-security-configuration.md).</span><span class="sxs-lookup"><span data-stu-id="e9c6a-145">You can find more information on hello security aspects in hello following document [split-merge security configuration](sql-database-elastic-scale-split-merge-security-configuration.md).</span></span>

<span data-ttu-id="e9c6a-146">Výchozí Hello nasadit service běží s jeden pracovní proces a jednu webovou roli.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-146">hello default deployed service runs with one worker and one web role.</span></span> <span data-ttu-id="e9c6a-147">Každá velikost virtuální počítač A1 hello používá ve službě Azure Cloud Services.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-147">Each uses hello A1 VM size in Azure Cloud Services.</span></span> <span data-ttu-id="e9c6a-148">Když tato nastavení nelze upravit, při nasazování balíčku hello, můžete je změnit po úspěšné nasazení ve hello spuštění cloudové služby (prostřednictvím hello portál Azure).</span><span class="sxs-lookup"><span data-stu-id="e9c6a-148">While you cannot modify these settings when deploying hello package, you could change them after a successful deployment in hello running cloud service, (through hello Azure portal).</span></span> <span data-ttu-id="e9c6a-149">Poznámka: Tato role pracovního procesu hello musí být nakonfigurované pro více než jednu instanci technických důvodů.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-149">Note that hello worker role must not be configured for more than a single instance for technical reasons.</span></span> 

<span data-ttu-id="e9c6a-150">**Mapa integrace horizontálního oddílu**</span><span class="sxs-lookup"><span data-stu-id="e9c6a-150">**Shard map integration**</span></span>

<span data-ttu-id="e9c6a-151">Hello rozdělení sloučení služba komunikuje s hello mapy horizontálního oddílu aplikace hello.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-151">hello split-merge service interacts with hello shard map of hello application.</span></span> <span data-ttu-id="e9c6a-152">Pokud používáte hello rozdělení sloučení služby toosplit nebo rozsahy sloučení nebo toomove shardlets mezi horizontálních oddílů, hello služby automaticky udržuje hello horizontálního oddílu mapy až toodate.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-152">When using hello split-merge service toosplit or merge ranges or toomove shardlets between shards, hello service automatically keeps hello shard map up toodate.</span></span> <span data-ttu-id="e9c6a-153">toodo tedy hello služby připojí toohello horizontálního oddílu mapa správce databáze aplikace hello a udržuje rozsahy a mapování průběh rozdělení nebo sloučení nebo přesunutí požadavky.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-153">toodo so, hello service connects toohello shard map manager database of hello application and maintains ranges and mappings as split/merge/move requests progress.</span></span> <span data-ttu-id="e9c6a-154">To zajišťuje, že hello horizontálního oddílu mapy vždy uvede aktuální zobrazení při operace sloučení rozdělení se děje.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-154">This ensures that hello shard map always presents an up-to-date view when split-merge operations are going on.</span></span> <span data-ttu-id="e9c6a-155">Rozdělení, sloučení a shardlet přesun operace jsou implementované přesunutím dávky shardlets z hello zdroj horizontálního oddílu toohello cíl horizontálních.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-155">Split, merge and shardlet movement operations are implemented by moving a batch of shardlets from hello source shard toohello target shard.</span></span> <span data-ttu-id="e9c6a-156">Během hello shardlet přesun operaci hello shardlets subjektu toohello aktuální batch jsou označeny jako offline v mapě hello horizontálního oddílu a nejsou k dispozici pro závislé na data směrování připojení pomocí hello **OpenConnectionForKey** rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-156">During hello shardlet movement operation hello shardlets subject toohello current batch are marked as offline in hello shard map and are unavailable for data-dependent routing connections using hello **OpenConnectionForKey** API.</span></span> 

<span data-ttu-id="e9c6a-157">**Konzistentní shardlet připojení**</span><span class="sxs-lookup"><span data-stu-id="e9c6a-157">**Consistent shardlet connections**</span></span>

<span data-ttu-id="e9c6a-158">Při přesunu dat pro novou dávku shardlets, jsou všechny zadané mapování horizontálních závislé na data směrování připojení toohello horizontálního oddílu ukládání hello shardlet borné a následné připojení z mapování horizontálních hello toohello rozhraní API jsou zablokované tyto shardlets při Přesun dat Hello probíhá v pořadí tooavoid nekonzistence.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-158">When data movement starts for a new batch of shardlets, any shard-map provided data-dependent routing connections toohello shard storing hello shardlet are killed and subsequent connections from hello shard map APIs toohello these shardlets are blocked while hello data movement is in progress in order tooavoid inconsistencies.</span></span> <span data-ttu-id="e9c6a-159">Připojení tooother shardlets na hello stejné ID horizontálního oddílu také získat ukončeny, ale bude úspěšné znovu okamžitě při opakování.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-159">Connections tooother shardlets on hello same shard will also get killed, but will succeed again immediately on retry.</span></span> <span data-ttu-id="e9c6a-160">Po přesunutí hello batch hello shardlets jsou označeny online znovu pro cíl hello horizontálního oddílu a hello zdrojová data se odebral ze horizontálních zdroj hello.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-160">Once hello batch is moved, hello shardlets are marked online again for hello target shard and hello source data is removed from hello source shard.</span></span> <span data-ttu-id="e9c6a-161">Služba Hello projde tyto kroky pro každou dávku, dokud všechny shardlets byly přesunuty.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-161">hello service goes through these steps for every batch until all shardlets have been moved.</span></span> <span data-ttu-id="e9c6a-162">To povede operace kill připojení tooseveral průběhu hello hello dokončení rozdělení nebo sloučení nebo přesunutí operace.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-162">This will lead tooseveral connection kill operations during hello course of hello complete split/merge/move operation.</span></span>  

<span data-ttu-id="e9c6a-163">**Správa shardlet dostupnosti**</span><span class="sxs-lookup"><span data-stu-id="e9c6a-163">**Managing shardlet availability**</span></span>

<span data-ttu-id="e9c6a-164">Omezení připojení hello ukončení toohello aktuální dávku shardlets, jak je popsáno výše omezuje hello oboru nedostupnosti tooone dávku shardlets najednou.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-164">Limiting hello connection killing toohello current batch of shardlets as discussed above restricts hello scope of unavailability tooone batch of shardlets at a time.</span></span> <span data-ttu-id="e9c6a-165">Toto je upřednostňovaný přes přístup kde hello dokončení horizontálního oddílu by zůstat offline pro všechny její shardlets průběhu hello operace rozdělení nebo sloučení.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-165">This is preferred over an approach where hello complete shard would remain offline for all its shardlets during hello course of a split or merge operation.</span></span> <span data-ttu-id="e9c6a-166">Hello velikost dávky, definován jako hello počet jedinečných shardlets toomove současně, je parametr konfigurace.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-166">hello size of a batch, defined as hello number of distinct shardlets toomove at a time, is a configuration parameter.</span></span> <span data-ttu-id="e9c6a-167">Může být definováno pro každou operaci rozdělení a merge v závislosti na potřebách dostupnosti a výkonu aplikace hello.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-167">It can be defined for each split and merge operation depending on hello application’s availability and performance needs.</span></span> <span data-ttu-id="e9c6a-168">Všimněte si, že hello rozsah, který se v mapě horizontálního oddílu hello zamykají může být větší než zadaná velikost dávky hello.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-168">Note that hello range that is being locked in hello shard map may be larger than hello batch size specified.</span></span> <span data-ttu-id="e9c6a-169">Je to proto, že služba hello vybere hello rozsah velikost tak, aby hello skutečný počet horizontálního dělení hodnoty klíče v datech hello přibližně odpovídá velikost dávky hello.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-169">This is because hello service picks hello range size such that hello actual number of sharding key values in hello data approximately matches hello batch size.</span></span> <span data-ttu-id="e9c6a-170">Toto je důležité tooremember konkrétně pro klíče řídce vyplněná horizontálního dělení.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-170">This is important tooremember in particular for sparsely populated sharding keys.</span></span> 

<span data-ttu-id="e9c6a-171">**Metadata úložiště**</span><span class="sxs-lookup"><span data-stu-id="e9c6a-171">**Metadata storage**</span></span>

<span data-ttu-id="e9c6a-172">Služba rozdělení sloučení Hello používá databázi toomaintain, jeho stav a tookeep protokolů při zpracování požadavku.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-172">hello split-merge service uses a database toomaintain its status and tookeep logs during request processing.</span></span> <span data-ttu-id="e9c6a-173">Hello uživatel vytvoří tato databáze v rámci svého předplatného a poskytuje hello připojovací řetězec pro ho v konfiguračním souboru hello pro nasazení služby hello.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-173">hello user creates this database in their subscription and provides hello connection string for it in hello configuration file for hello service deployment.</span></span> <span data-ttu-id="e9c6a-174">Správci z hello uživatele organizaci se může připojit i toothis databáze tooreview požadavek průběh a tooinvestigate podrobné informace o potenciální chyby.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-174">Administrators from hello user’s organization can also connect toothis database tooreview request progress and tooinvestigate detailed information regarding potential failures.</span></span>

<span data-ttu-id="e9c6a-175">**Sledování horizontálního dělení**</span><span class="sxs-lookup"><span data-stu-id="e9c6a-175">**Sharding-awareness**</span></span>

<span data-ttu-id="e9c6a-176">Hello rozdělení sloučení služby rozlišuje (1) horizontálně dělené tabulky, (2) referenční tabulky a (3) normální tabulky.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-176">hello split-merge service differentiates between (1) sharded tables, (2) reference tables, and (3) normal tables.</span></span> <span data-ttu-id="e9c6a-177">Hello sémantika rozdělení nebo sloučení nebo přesunutí operace závisí na typu hello tabulky hello používá a jsou definovány takto:</span><span class="sxs-lookup"><span data-stu-id="e9c6a-177">hello semantics of a split/merge/move operation depend on hello type of hello table used and are defined as follows:</span></span> 

* <span data-ttu-id="e9c6a-178">**Horizontálně dělené tabulky**: operace přesunutí, sloučení a rozdělení přesunout shardlets z horizontálních tootarget zdroje.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-178">**Sharded tables**: Split, merge, and move operations move shardlets from source tootarget shard.</span></span> <span data-ttu-id="e9c6a-179">Po úspěšném dokončení hello celkové požadavků, tyto shardlets již neexistují u zdroje hello.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-179">After successful completion of hello overall request, those shardlets are no longer present on hello source.</span></span> <span data-ttu-id="e9c6a-180">Upozorňujeme, že hello cílové tabulky potřebovat tooexist na cílový hello horizontálního oddílu a nesmí obsahovat data v předchozí tooprocessing hello cílový rozsah hello operace.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-180">Note that hello target tables need tooexist on hello target shard and must not contain data in hello target range prior tooprocessing of hello operation.</span></span> 
* <span data-ttu-id="e9c6a-181">**Referenční tabulky**: referenční tabulky, rozdělení hello sloučení a přesunout operace kopírování dat hello z horizontálního hello zdroj toohello cílového oddílu.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-181">**Reference tables**: For reference tables, hello split, merge and move operations copy hello data from hello source toohello target shard.</span></span> <span data-ttu-id="e9c6a-182">Upozorňujeme však, že žádné změny dojít na hello horizontálního oddílu cíl pro danou tabulku, pokud všechny řádky, se již nachází v této tabulce na cíli hello.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-182">Note, however, that no changes occur on hello target shard for a given table if any row is already present in this table on hello target.</span></span> <span data-ttu-id="e9c6a-183">Tabulka Hello má toobe prázdná pro všechny referenční tabulky kopie operaci tooget zpracovat.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-183">hello table has toobe empty for any reference table copy operation tooget processed.</span></span>
* <span data-ttu-id="e9c6a-184">**Ostatní tabulky**: ostatní tabulky mohou existovat na hello zdroj nebo cíl hello operace rozdělení a merge.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-184">**Other Tables**: Other tables can be present on either hello source or hello target of a split and merge operation.</span></span> <span data-ttu-id="e9c6a-185">Služba rozdělení sloučení Hello ignoruje tyto tabulky pro všechny přesuny dat nebo operace kopírování.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-185">hello split-merge service disregards these tables for any data movement or copy operations.</span></span> <span data-ttu-id="e9c6a-186">Upozorňujeme však, že může narušovat tyto operace v případě omezení.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-186">Note, however, that they can interfere with these operations in case of constraints.</span></span>

<span data-ttu-id="e9c6a-187">Hello informace na odkaz oproti horizontálně dělené tabulky jsou poskytovány hello **SchemaInfo** rozhraní API na mapě hello horizontálního oddílu.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-187">hello information on reference vs. sharded tables is provided by hello **SchemaInfo** APIs on hello shard map.</span></span> <span data-ttu-id="e9c6a-188">Hello následující příklad ukazuje použití hello tato rozhraní API na danou horizontálních mapy manager objekt smm:</span><span class="sxs-lookup"><span data-stu-id="e9c6a-188">hello following example illustrates hello use of these APIs on a given shard map manager object smm:</span></span> 

    // Create hello schema annotations 
    SchemaInfo schemaInfo = new SchemaInfo(); 

    // Reference tables 
    schemaInfo.Add(new ReferenceTableInfo("dbo", "region")); 
    schemaInfo.Add(new ReferenceTableInfo("dbo", "nation")); 

    // Sharded tables 
    schemaInfo.Add(new ShardedTableInfo("dbo", "customer", "C_CUSTKEY")); 
    schemaInfo.Add(new ShardedTableInfo("dbo", "orders", "O_CUSTKEY")); 

    // Publish 
    smm.GetSchemaInfoCollection().Add(Configuration.ShardMapName, schemaInfo); 

<span data-ttu-id="e9c6a-189">Hello tabulky 'region' a 'výhod, jsou definovány jako referenční tabulky a se zkopírují s operacemi rozdělení nebo sloučení nebo přesunutí.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-189">hello tables ‘region’ and ‘nation’ are defined as reference tables and will be copied with split/merge/move operations.</span></span> <span data-ttu-id="e9c6a-190">"zákazník" a "objednávky, pak jsou definovány jako horizontálně dělené tabulky.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-190">‘customer’ and ‘orders’ in turn are defined as sharded tables.</span></span> <span data-ttu-id="e9c6a-191">C_CUSTKEY a O_CUSTKEY slouží jako klíč hello horizontálního dělení.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-191">C_CUSTKEY and O_CUSTKEY serve as hello sharding key.</span></span> 

<span data-ttu-id="e9c6a-192">**Referenční integrita**</span><span class="sxs-lookup"><span data-stu-id="e9c6a-192">**Referential Integrity**</span></span>

<span data-ttu-id="e9c6a-193">Služba rozdělení sloučení Hello analyzuje závislosti mezi tabulkami a využívá operace hello toostage relace cizích klíčů primární klíč pro přesun referenční tabulky a shardlets.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-193">hello split-merge service analyzes dependencies between tables and uses foreign key-primary key relationships toostage hello operations for moving reference tables and shardlets.</span></span> <span data-ttu-id="e9c6a-194">Obecně platí referenční tabulky se zkopírují první v pořadí závislostí, pak shardlets zkopírují v pořadí podle jejich závislosti v rámci každé dávky.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-194">In general, reference tables are copied first in dependency order, then shardlets are copied in order of their dependencies within each batch.</span></span> <span data-ttu-id="e9c6a-195">To je nezbytné, aby Primárníklíč-Cizíklíč omezení horizontálních cíl hello se uplatní jako dorazí hello nová data.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-195">This is necessary so that FK-PK constraints on hello target shard are honored as hello new data arrives.</span></span> 

<span data-ttu-id="e9c6a-196">**Konzistence mapy horizontálního oddílu a případné dokončení**</span><span class="sxs-lookup"><span data-stu-id="e9c6a-196">**Shard Map Consistency and Eventual Completion**</span></span>

<span data-ttu-id="e9c6a-197">V hello přítomnost chyb služba rozdělení sloučení hello obnoví operations po všech výpadku a má za cíl toocomplete žádné v žádostech o průběhu.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-197">In hello presence of failures, hello split-merge service resumes operations after any outage and aims toocomplete any in progress requests.</span></span> <span data-ttu-id="e9c6a-198">Však může existovat neopravitelné situacích, například hello cíl horizontálních dojde ke ztrátě nebo ohrožení zabezpečení nad rámec opravit.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-198">However, there may be unrecoverable situations, e.g., when hello target shard is lost or compromised beyond repair.</span></span> <span data-ttu-id="e9c6a-199">Za těchto okolností může některé shardlets, které se měly přesunout toobe stále tooreside na horizontálních zdroj hello.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-199">Under those circumstances, some shardlets that were supposed toobe moved may continue tooreside on hello source shard.</span></span> <span data-ttu-id="e9c6a-200">Hello služby zajišťuje mapování shardlet jsou po úspěšně zkopírovaný toohello cíl hello potřebná data jenom aktualizaci.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-200">hello service ensures that shardlet mappings are only updated after hello necessary data has been successfully copied toohello target.</span></span> <span data-ttu-id="e9c6a-201">Shardlets se odstraní pouze na zdroji hello, poté zkopírovat všechny, svá data byla úspěšně toohello cíl a odpovídající mapování hello bylo úspěšně aktualizováno.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-201">Shardlets are only deleted on hello source once all their data has been copied toohello target and hello corresponding mappings have been updated successfully.</span></span> <span data-ttu-id="e9c6a-202">operace odstranění Hello se stane hello pozadí při hello rozsah již je online na horizontálního hello cílového oddílu.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-202">hello deletion operation happens in hello background while hello range is already online on hello target shard.</span></span> <span data-ttu-id="e9c6a-203">Hello rozdělení sloučení služby vždy zajišťuje správnost mapování hello uložené v mapě hello horizontálního oddílu.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-203">hello split-merge service always ensures correctness of hello mappings stored in hello shard map.</span></span>

## <a name="hello-split-merge-user-interface"></a><span data-ttu-id="e9c6a-204">Hello sloučení rozdělení uživatelské rozhraní</span><span class="sxs-lookup"><span data-stu-id="e9c6a-204">hello split-merge user interface</span></span>
<span data-ttu-id="e9c6a-205">balíček služby rozdělení sloučení Hello zahrnuje roli pracovního procesu a webové role.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-205">hello split-merge service package includes a worker role and a web role.</span></span> <span data-ttu-id="e9c6a-206">Hello webové role je použité toosubmit rozdělení sloučení požadavky interaktivní způsobem.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-206">hello web role is used toosubmit split-merge requests in an interactive way.</span></span> <span data-ttu-id="e9c6a-207">hlavní součásti Hello hello uživatelského rozhraní jsou následující:</span><span class="sxs-lookup"><span data-stu-id="e9c6a-207">hello main components of hello user interface are as follows:</span></span>

* <span data-ttu-id="e9c6a-208">Typ operace: typ operace hello je přepínač, který řídí hello druh operace provádí hello služby pro tento požadavek.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-208">Operation Type: hello operation type is a radio button that controls hello kind of operation performed by hello service for this request.</span></span> <span data-ttu-id="e9c6a-209">Můžete zvolit hello rozdělení, sloučení a přesunout scénáře.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-209">You can choose between hello split, merge and move scenarios.</span></span> <span data-ttu-id="e9c6a-210">Můžete také zrušit dříve odeslaný operaci.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-210">You can also cancel a previously submitted operation.</span></span> <span data-ttu-id="e9c6a-211">Můžete použít rozdělení, sloučení a přesunout požadavky pro rozsah horizontálního oddílu mapy.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-211">You can use split, merge and move requests for range shard maps.</span></span> <span data-ttu-id="e9c6a-212">Seznam horizontálních mapuje pouze operace přesunutí podpory.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-212">List shard maps only support move operations.</span></span>
* <span data-ttu-id="e9c6a-213">Mapování horizontálních: hello další části žádost parametry titulní informace o mapování horizontálních hello a hostování mapu horizontálního oddílu hello databáze.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-213">Shard Map: hello next section of request parameters cover information about hello shard map and hello database hosting your shard map.</span></span> <span data-ttu-id="e9c6a-214">Konkrétně potřebujete název hello tooprovide hello serveru Azure SQL Database a hostování hello shardmap databáze, přihlašovací údaje tooconnect toohello horizontálních mapovat databázi a nakonec hello název mapování horizontálních hello.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-214">In particular, you need tooprovide hello name of hello Azure SQL Database server and database hosting hello shardmap, credentials tooconnect toohello shard map database, and finally hello name of hello shard map.</span></span> <span data-ttu-id="e9c6a-215">V současné době operaci hello přijímá pouze jedinou sadu pověření.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-215">Currently, hello operation only accepts a single set of credentials.</span></span> <span data-ttu-id="e9c6a-216">Tyto přihlašovací údaje musí dostatečná oprávnění toohave tooperform změny toohello horizontálního oddílu mapy, jakož i toohello uživatelská data na hello horizontálních oddílů.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-216">These credentials need toohave sufficient permissions tooperform changes toohello shard map as well as toohello user data on hello shards.</span></span>
* <span data-ttu-id="e9c6a-217">Rozsah zdrojových (rozdělení a sloučení): operace rozdělení a sloučení zpracovává rozsah pomocí klíče vysoké a nízké.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-217">Source Range (split and merge): A split and merge operation processes a range using its low and high key.</span></span> <span data-ttu-id="e9c6a-218">toospecify operace s bez vazby vysoká hodnota klíče, zaškrtněte políčko "vysoká hodnota klíče je maximální" hello a hello vysoké klíčové pole ponechte prázdné.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-218">toospecify an operation with an unbounded high key value, check hello “High key is max” check box and leave hello high key field empty.</span></span> <span data-ttu-id="e9c6a-219">Hello rozsah hodnoty klíče, které zadáte do tooprecisely nutné neodpovídá mapování a jeho hranice na mapě horizontálního oddílu.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-219">hello range key values that you specify do not need tooprecisely match a mapping and its boundaries in your shard map.</span></span> <span data-ttu-id="e9c6a-220">Pokud nezadáte vůbec žádné hranice rozsahu hello služby automaticky odvození hello nejbližší rozsahu.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-220">If you do not specify any range boundaries at all hello service will infer hello closest range for you automatically.</span></span> <span data-ttu-id="e9c6a-221">Pomocí hello GetMappings.ps1 PowerShell skriptu tooretrieve hello aktuální mapování v mapě dané horizontálního oddílu.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-221">You can use hello GetMappings.ps1 PowerShell script tooretrieve hello current mappings in a given shard map.</span></span>
* <span data-ttu-id="e9c6a-222">Rozdělení zdroj chování (rozdělení): pro rozdělení operace definovat rozsah zdrojových hello bodu toosplit hello.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-222">Split Source Behavior (split): For split operations, define hello point toosplit hello source range.</span></span> <span data-ttu-id="e9c6a-223">To provedete zadáním hello horizontálního dělení klíč, kterou má hello rozdělení toooccur.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-223">You do this by providing hello sharding key where you want hello split toooccur.</span></span> <span data-ttu-id="e9c6a-224">Přepínač použít hello zadejte, zda chcete hello dolní části toomove hello rozsah (s výjimkou hello rozdělení klíč), nebo jestli chcete toomove hello horní části (včetně klíče rozdělení hello).</span><span class="sxs-lookup"><span data-stu-id="e9c6a-224">Use hello radio button specify whether you want hello lower part of hello range (excluding hello split key) toomove, or whether you want hello upper part toomove (including hello split key).</span></span>
* <span data-ttu-id="e9c6a-225">Zdroj Shardlet (přesunout): přesunout operace se liší od rozdělení nebo sloučení operace jako zdroj rozsah toodescribe hello nevyžadují.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-225">Source Shardlet (move): Move operations are different from split or merge operations as they do not require a range toodescribe hello source.</span></span> <span data-ttu-id="e9c6a-226">Zdroj pro přesun je jednoduše identifikována hodnota klíče horizontálního dělení hello plánování toomove.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-226">A source for move is simply identified by hello sharding key value that you plan toomove.</span></span>
* <span data-ttu-id="e9c6a-227">Cíl horizontálního oddílu (rozdělení): po hello informace jste zadali na hello zdroj rozdělení operaci, musíte toodefine místo, kam chcete zkopírovat hello data toobe tooby poskytnete hello databázi Azure SQL serveru a název databáze pro cíl hello.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-227">Target Shard (split): Once you have provided hello information on hello source of your split operation, you need toodefine where you want hello data toobe copied tooby providing hello Azure SQL Db server and database name for hello target.</span></span>
* <span data-ttu-id="e9c6a-228">Cílový rozsah (sloučení): operace sloučení přesunout shardlets tooan stávající ID horizontálního oddílu.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-228">Target Range (merge): Merge operations move shardlets tooan existing shard.</span></span> <span data-ttu-id="e9c6a-229">Tím, že poskytuje hello rozsah hranice hello existující oblast, která má být toomerge s identifikujete hello existující horizontálního oddílu.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-229">You identify hello existing shard by providing hello range boundaries of hello existing range that you want toomerge with.</span></span>
* <span data-ttu-id="e9c6a-230">Velikost dávky: ovládací prvky velikost dávky hello hello počet shardlets, která přejde do režimu offline v době při přesunu dat hello.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-230">Batch Size: hello batch size controls hello number of shardlets that will go offline at a time during hello data movement.</span></span> <span data-ttu-id="e9c6a-231">Toto je celočíselná hodnota, kde můžete použít nižší hodnoty po citlivé toolong doby výpadku pro shardlets.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-231">This is an integer value where you can use smaller values when you are sensitive toolong periods of downtime for shardlets.</span></span> <span data-ttu-id="e9c6a-232">Vyšší hodnoty zvýší hello čas, který je daný shardlet offline však může zvýšit výkon.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-232">Larger values will increase hello time that a given shardlet is offline but may improve performance.</span></span>
* <span data-ttu-id="e9c6a-233">Id operace (zrušit): Pokud máte probíhající operace, která již nepotřebujete, můžete operaci hello zrušit zadáním jeho ID operace v tomto poli.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-233">Operation Id (Cancel): If you have an ongoing operation that is no longer needed, you can cancel hello operation by providing its operation ID in this field.</span></span> <span data-ttu-id="e9c6a-234">ID operace hello můžete načíst z hello požadavek stav tabulky (viz oddíl 8.1) nebo z výstupu hello hello webového prohlížeče, kde jste odeslali žádost o hello.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-234">You can retrieve hello operation ID from hello request status table (see Section 8.1) or from hello output in hello web browser where you submitted hello request.</span></span>

## <a name="requirements-and-limitations"></a><span data-ttu-id="e9c6a-235">Požadavky a omezení</span><span class="sxs-lookup"><span data-stu-id="e9c6a-235">Requirements and Limitations</span></span>
<span data-ttu-id="e9c6a-236">Hello aktuální implementace služby rozdělení sloučení hello je subjektu toohello následující požadavky a omezení:</span><span class="sxs-lookup"><span data-stu-id="e9c6a-236">hello current implementation of hello split-merge service is subject toohello following requirements and limitations:</span></span> 

* <span data-ttu-id="e9c6a-237">horizontálních oddílů Hello potřebovat tooexist a zaregistrovat v mapě horizontálního oddílu hello před provedením operace sloučení rozdělení na těchto horizontálních oddílů.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-237">hello shards need tooexist and be registered in hello shard map before a split-merge operation on these shards can be performed.</span></span> 
* <span data-ttu-id="e9c6a-238">Služba Hello nevytváří tabulky a všechny další objekty databáze automaticky v rámci jeho operací.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-238">hello service does not create tables or any other database objects automatically as part of its operations.</span></span> <span data-ttu-id="e9c6a-239">To znamená, které hello schématu pro všechny horizontálně dělené tabulky a odkazy na tabulky, třeba tooexist na hello cíl horizontálního oddílu předchozí tooany rozdělení nebo sloučení nebo přesunutí operaci.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-239">This means that hello schema for all sharded tables and reference tables need tooexist on hello target shard prior tooany split/merge/move operation.</span></span> <span data-ttu-id="e9c6a-240">Horizontálně dělené tabulky jsou zejména požadované toobe v rozsahu hello, kde jsou nové shardlets toobe přidat operací rozdělení nebo sloučení nebo přesunutí prázdné.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-240">Sharded tables in particular are required toobe empty in hello range where new shardlets are toobe added by a split/merge/move operation.</span></span> <span data-ttu-id="e9c6a-241">Jinak hodnota hello se nezdaří kontrolu konzistence počáteční hello horizontálního hello cílového oddílu.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-241">Otherwise, hello operation will fail hello initial consistency check on hello target shard.</span></span> <span data-ttu-id="e9c6a-242">Všimněte si, že referenční data zkopírován pouze pokud hello Referenční tabulka prázdná a že nejsou žádné konzistence také zaručuje s ohledem tooother zápisu souběžných operací na hello referenční tabulky.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-242">Also note that reference data is only copied if hello reference table is empty and that there are no consistency guarantees with regard tooother concurrent write operations on hello reference tables.</span></span> <span data-ttu-id="e9c6a-243">Doporučujeme toto: při spuštění operace rozdělení nebo sloučení, žádné jiné operace zápisu provést změny toohello referenční tabulky.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-243">We recommend this: when running split/merge operations, no other write operations make changes toohello reference tables.</span></span>
* <span data-ttu-id="e9c6a-244">Služba Hello spoléhá na řádek identity vytvořit jedinečný index nebo klíč, který zahrnuje hello horizontálního dělení klíče tooimprove výkon a spolehlivost pro velké shardlets.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-244">hello service relies on row identity established by a unique index or key that includes hello sharding key tooimprove performance and reliability for large shardlets.</span></span> <span data-ttu-id="e9c6a-245">To umožňuje hello služby toomove dat na i podrobnější než právě hello horizontálního dělení hodnotu klíče.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-245">This allows hello service toomove data at an even finer granularity than just hello sharding key value.</span></span> <span data-ttu-id="e9c6a-246">To pomáhá tooreduce hello maximální množství místa protokolu a zámky, které jsou požadovány během operace hello.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-246">This helps tooreduce hello maximum amount of log space and locks that are required during hello operation.</span></span> <span data-ttu-id="e9c6a-247">Můžete vytvořit jedinečný index nebo primární klíč, včetně hello horizontálního dělení klíče v dané tabulce, pokud chcete, aby toouse této tabulky s rozdělení nebo sloučení nebo přesunutí požadavky.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-247">Consider creating a unique index or a primary key including hello sharding key on a given table if you want toouse that table with split/merge/move requests.</span></span> <span data-ttu-id="e9c6a-248">Z důvodů výkonu hello horizontálního dělení klíč by měl být hello počáteční sloupec v hello klíč nebo hello index.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-248">For performance reasons, hello sharding key should be hello leading column in hello key or hello index.</span></span>
* <span data-ttu-id="e9c6a-249">Během hello během zpracování požadavku může být některá data shardlet přítomen hello zdroj a cíl hello horizontálního oddílu.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-249">During hello course of request processing, some shardlet data may be present both on hello source and hello target shard.</span></span> <span data-ttu-id="e9c6a-250">Toto je nezbytné tooprotect proti selhání během pohybu shardlet hello.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-250">This is necessary tooprotect against failures during hello shardlet movement.</span></span> <span data-ttu-id="e9c6a-251">Hello integrace rozdělení sloučení s hello horizontálního oddílu mapy zajistí, že připojení prostřednictvím hello dat závislé směrování rozhraní API pomocí hello **OpenConnectionForKey** metoda na mapě hello horizontálního oddílu nejsou vidět všechny nekonzistentní zprostředkující stavy.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-251">hello integration of split-merge with hello shard map ensures that connections through hello data dependent routing APIs using hello **OpenConnectionForKey** method on hello shard map do not see any inconsistent intermediate states.</span></span> <span data-ttu-id="e9c6a-252">Ale při připojování toohello zdroj nebo hello cíle horizontálních oddílů bez použití hello **OpenConnectionForKey** metoda, nekonzistentní zprostředkující stavy může být viditelné, pokud se děje rozdělení nebo sloučení nebo přesunutí požadavky.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-252">However, when connecting toohello source or hello target shards without using hello **OpenConnectionForKey** method, inconsistent intermediate states might be visible when split/merge/move requests are going on.</span></span> <span data-ttu-id="e9c6a-253">Tato připojení může zobrazovat částečné nebo duplicitní výsledky v závislosti na hello časování nebo hello horizontálního oddílu Základní hello připojení.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-253">These connections may show partial or duplicate results depending on hello timing or hello shard underlying hello connection.</span></span> <span data-ttu-id="e9c6a-254">Toto omezení aktuálně zahrnuje hello připojení elastické škálování Shard více – dotazy.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-254">This limitation currently includes hello connections made by Elastic Scale Multi-Shard-Queries.</span></span>
* <span data-ttu-id="e9c6a-255">Hello databázi metadat pro službu hello rozdělení sloučení nesmí sdílet mezi různé role.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-255">hello metadata database for hello split-merge service must not be shared between different roles.</span></span> <span data-ttu-id="e9c6a-256">Například role hello rozdělení sloučení službu v pracovní potřebám toopoint tooa rozdílná metadata databáze než hello produkční role.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-256">For example, a role of hello split-merge service running in staging needs toopoint tooa different metadata database than hello production role.</span></span>

## <a name="billing"></a><span data-ttu-id="e9c6a-257">Fakturace</span><span class="sxs-lookup"><span data-stu-id="e9c6a-257">Billing</span></span>
<span data-ttu-id="e9c6a-258">Služba Hello rozdělení sloučení běží jako cloudová služba v rámci vašeho předplatného Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-258">hello split-merge service runs as a cloud service in your Microsoft Azure subscription.</span></span> <span data-ttu-id="e9c6a-259">Proto pro cloudové služby poplatky za instance tooyour služby hello.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-259">Therefore charges for cloud services apply tooyour instance of hello service.</span></span> <span data-ttu-id="e9c6a-260">Pokud provádíte často rozdělení nebo sloučení nebo přesunutí operace, doporučujeme že odstranit rozdělení sloučení cloudové služby.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-260">Unless you frequently perform split/merge/move operations, we recommend you delete your split-merge cloud service.</span></span> <span data-ttu-id="e9c6a-261">Která šetří náklady pro spuštění nebo nasazena instance služby cloudu.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-261">That saves costs for running or deployed cloud service instances.</span></span> <span data-ttu-id="e9c6a-262">Můžete znovu nasadit a spustit konfiguraci snadno spustitelného kdykoli budete potřebovat tooperform rozdělení nebo sloučení operace.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-262">You can re-deploy and start your readily runnable configuration whenever you need tooperform split or merge operations.</span></span> 

## <a name="monitoring"></a><span data-ttu-id="e9c6a-263">Monitorování</span><span class="sxs-lookup"><span data-stu-id="e9c6a-263">Monitoring</span></span>
### <a name="status-tables"></a><span data-ttu-id="e9c6a-264">Stav tabulky</span><span class="sxs-lookup"><span data-stu-id="e9c6a-264">Status tables</span></span>
<span data-ttu-id="e9c6a-265">Hello rozdělení sloučení služba poskytuje hello **stavem** tabulky v databázi úložiště hello metadat pro sledování dokončené a probíhající požadavků.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-265">hello split-merge Service provides hello **RequestStatus** table in hello metadata store database for monitoring of completed and ongoing requests.</span></span> <span data-ttu-id="e9c6a-266">Hello tabulka obsahuje řádek pro každý požadavek sloučení rozdělení, která byla odeslaná toothis instanci služby rozdělení sloučení hello.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-266">hello table lists a row for each split-merge request that has been submitted toothis instance of hello split-merge service.</span></span> <span data-ttu-id="e9c6a-267">Nabízí následující informace pro každý požadavek hello:</span><span class="sxs-lookup"><span data-stu-id="e9c6a-267">It gives hello following information for each request:</span></span>

* <span data-ttu-id="e9c6a-268">**Časové razítko**: hello čas a datum, když požadavek hello.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-268">**Timestamp**: hello time and date when hello request was started.</span></span>
* <span data-ttu-id="e9c6a-269">**OperationId**: A identifikátor GUID, který jedinečně identifikuje hello požadavku.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-269">**OperationId**: A GUID that uniquely identifies hello request.</span></span> <span data-ttu-id="e9c6a-270">Tento požadavek může být také použít toocancel hello operace, i když je stále probíhající.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-270">This request can also be used toocancel hello operation while it is still ongoing.</span></span>
* <span data-ttu-id="e9c6a-271">**Stav**: hello aktuální stav žádosti hello.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-271">**Status**: hello current state of hello request.</span></span> <span data-ttu-id="e9c6a-272">Probíhající požadavky také vypíše hello aktuální fáze, ve které hello je požadavek.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-272">For ongoing requests, it also lists hello current phase in which hello request is.</span></span>
* <span data-ttu-id="e9c6a-273">**CancelRequest**: Příznak určující, zda text hello požadavek byl zrušen.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-273">**CancelRequest**: A flag that indicates whether hello request has been cancelled.</span></span>
* <span data-ttu-id="e9c6a-274">**Průběh**: procento odhad dokončení operace hello.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-274">**Progress**: A percentage estimate of completion for hello operation.</span></span> <span data-ttu-id="e9c6a-275">Hodnotu 50 označuje, že operace hello je přibližně 50 % dokončení.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-275">A value of 50 indicates that hello operation is approximately 50% complete.</span></span>
* <span data-ttu-id="e9c6a-276">**Podrobnosti o**: hodnota ve formátu XML, která poskytuje podrobnější sestava průběhu.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-276">**Details**: An XML value that provides a more detailed progress report.</span></span> <span data-ttu-id="e9c6a-277">Sestava průběhu Hello je pravidelně aktualizovat, protože sady řádků se zkopírují ze zdroje tootarget.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-277">hello progress report is periodically updated as sets of rows are copied from source tootarget.</span></span> <span data-ttu-id="e9c6a-278">V případě selhání nebo výjimky tento sloupec také obsahuje podrobnější informace o selhání hello.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-278">In case of failures or exceptions, this column also includes more detailed information about hello failure.</span></span>

### <a name="azure-diagnostics"></a><span data-ttu-id="e9c6a-279">Diagnostika Azure</span><span class="sxs-lookup"><span data-stu-id="e9c6a-279">Azure Diagnostics</span></span>
<span data-ttu-id="e9c6a-280">Služba rozdělení sloučení Hello používá Azure Diagnostics podle Azure SDK 2.5 pro monitorování a Diagnostika.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-280">hello split-merge service uses Azure Diagnostics based on Azure SDK 2.5 for monitoring and diagnostics.</span></span> <span data-ttu-id="e9c6a-281">Jak je popsáno v tomto poli se řídit konfigurace diagnostiky hello: [povolení diagnostiky Azure Cloud Services a virtuálních počítačů](../cloud-services/cloud-services-dotnet-diagnostics.md).</span><span class="sxs-lookup"><span data-stu-id="e9c6a-281">You control hello diagnostics configuration as explained here: [Enabling Diagnostics in Azure Cloud Services and Virtual Machines](../cloud-services/cloud-services-dotnet-diagnostics.md).</span></span> <span data-ttu-id="e9c6a-282">Hello balíček ke stažení obsahuje dvě konfigurace diagnostiky – jeden pro hello webovou roli a jeden pro roli pracovního procesu hello.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-282">hello download package includes two diagnostics configurations - one for hello web role and one for hello worker role.</span></span> <span data-ttu-id="e9c6a-283">Tyto konfigurace diagnostiky pro službu hello postupujte podle pokynů hello od [základy cloudové služby ve službě Microsoft Azure](https://code.msdn.microsoft.com/windowsazure/Cloud-Service-Fundamentals-4ca72649).</span><span class="sxs-lookup"><span data-stu-id="e9c6a-283">These diagnostics configurations for hello service follow hello guidance from [Cloud Service Fundamentals in Microsoft Azure](https://code.msdn.microsoft.com/windowsazure/Cloud-Service-Fundamentals-4ca72649).</span></span> <span data-ttu-id="e9c6a-284">Obsahuje hello Definice toolog čítače výkonu, protokoly služby IIS, protokoly událostí systému Windows a protokoly událostí aplikace rozdělení sloučení.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-284">It includes hello definitions toolog Performance Counters, IIS logs, Windows Event Logs, and split-merge application event logs.</span></span> 

## <a name="deploy-diagnostics"></a><span data-ttu-id="e9c6a-285">Nasazení diagnostiky</span><span class="sxs-lookup"><span data-stu-id="e9c6a-285">Deploy Diagnostics</span></span>
<span data-ttu-id="e9c6a-286">tooenable monitorování a Diagnostika pomocí hello konfigurace diagnostiky pro webové a pracovní role hello poskytované hello balíček NuGet, spusťte následující příkazy pomocí Azure PowerShell hello:</span><span class="sxs-lookup"><span data-stu-id="e9c6a-286">tooenable monitoring and diagnostics using hello diagnostic configuration for hello web and worker roles provided by hello NuGet package, run hello following commands using Azure PowerShell:</span></span> 

    $storage_name = "<YourAzureStorageAccount>" 

    $key = "<YourAzureStorageAccountKey" 

    $storageContext = New-AzureStorageContext -StorageAccountName $storage_name -StorageAccountKey $key  


    $config_path = "<YourFilePath>\SplitMergeWebContent.diagnostics.xml" 

    $service_name = "<YourCloudServiceName>" 

    Set-AzureServiceDiagnosticsExtension -StorageContext $storageContext -DiagnosticsConfigurationPath $config_path -ServiceName $service_name -Slot Production -Role "SplitMergeWeb" 


    $config_path = "<YourFilePath>\SplitMergeWorkerContent.diagnostics.xml" 

    $service_name = "<YourCloudServiceName>" 

    Set-AzureServiceDiagnosticsExtension -StorageContext $storageContext -DiagnosticsConfigurationPath $config_path -ServiceName $service_name -Slot Production -Role "SplitMergeWorker" 

<span data-ttu-id="e9c6a-287">Můžete najít další informace o tooconfigure a nasadit nastavení diagnostiky zde: [povolení diagnostiky Azure Cloud Services a virtuálních počítačů](../cloud-services/cloud-services-dotnet-diagnostics.md).</span><span class="sxs-lookup"><span data-stu-id="e9c6a-287">You can find more information on how tooconfigure and deploy diagnostics settings here: [Enabling Diagnostics in Azure Cloud Services and Virtual Machines](../cloud-services/cloud-services-dotnet-diagnostics.md).</span></span> 

## <a name="retrieve-diagnostics"></a><span data-ttu-id="e9c6a-288">Načtení diagnostiky</span><span class="sxs-lookup"><span data-stu-id="e9c6a-288">Retrieve diagnostics</span></span>
<span data-ttu-id="e9c6a-289">Můžete snadno přístup k vaší diagnostiky z hello Průzkumníka serveru Visual Studia v hello Azure části stromu Průzkumníka serveru hello.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-289">You can easily access your diagnostics from hello Visual Studio Server Explorer in hello Azure part of hello Server Explorer tree.</span></span> <span data-ttu-id="e9c6a-290">Otevřete Visual Studio instance a v řádku nabídek hello klikněte na zobrazení a Průzkumníka serveru.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-290">Open a Visual Studio instance, and in hello menu bar click View, and Server Explorer.</span></span> <span data-ttu-id="e9c6a-291">Klikněte na tlačítko hello Azure – ikona tooconnect tooyour předplatného Azure.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-291">Click hello Azure icon tooconnect tooyour Azure subscription.</span></span> <span data-ttu-id="e9c6a-292">Pak přejděte tooAzure -> úložiště -> <your storage account> -> WADLogsTable-tabulky >.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-292">Then navigate tooAzure -> Storage -> <your storage account> -> Tables -> WADLogsTable.</span></span> <span data-ttu-id="e9c6a-293">Další informace najdete v tématu [procházení prostředků úložiště pomocí Průzkumníka serveru](http://msdn.microsoft.com/library/azure/ff683677.aspx).</span><span class="sxs-lookup"><span data-stu-id="e9c6a-293">For more information, see [Browsing Storage Resources with Server Explorer](http://msdn.microsoft.com/library/azure/ff683677.aspx).</span></span> 

![WADLogsTable][2]

<span data-ttu-id="e9c6a-295">Hello WADLogsTable zvýrazněných v předchozí obrázek hello obsahuje hello podrobné události z protokolu aplikace hello rozdělení sloučení služby.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-295">hello WADLogsTable highlighted in hello figure above contains hello detailed events from hello split-merge service’s application log.</span></span> <span data-ttu-id="e9c6a-296">Všimněte si, že hello výchozí konfigurace hello Stáhnout balíček byla zaměřena produkčním nasazení.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-296">Note that hello default configuration of hello downloaded package is geared towards a production deployment.</span></span> <span data-ttu-id="e9c6a-297">Hello interval, kdy jsou protokoly a čítače načtený z instance služby hello je proto velké (5 minut).</span><span class="sxs-lookup"><span data-stu-id="e9c6a-297">Therefore hello interval at which logs and counters are pulled from hello service instances is large (5 minutes).</span></span> <span data-ttu-id="e9c6a-298">Pro testovací a vývojové musí nižší interval hello úpravou hello nastavení diagnostiky webové hello nebo tooyour role pracovního procesu hello.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-298">For test and development, lower hello interval by adjusting hello diagnostics settings of hello web or hello worker role tooyour needs.</span></span> <span data-ttu-id="e9c6a-299">Klikněte pravým tlačítkem na roli hello v hello Průzkumníka serveru Visual Studia (viz výše) a upravte hello přenosu období v dialogovém okně hello nastavení konfigurace diagnostiky hello:</span><span class="sxs-lookup"><span data-stu-id="e9c6a-299">Right-click on hello role in hello Visual Studio Server Explorer (see above) and then adjust hello Transfer Period in hello dialog for hello Diagnostics configuration settings:</span></span> 

![Konfigurace][3]

## <a name="performance"></a><span data-ttu-id="e9c6a-301">Výkon</span><span class="sxs-lookup"><span data-stu-id="e9c6a-301">Performance</span></span>
<span data-ttu-id="e9c6a-302">Obecně platí je lepší výkon toobe od hello vyšší, očekává více úrovní služeb původce ve službě Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-302">In general, better performance is toobe expected from hello higher, more performant service tiers in Azure SQL Database.</span></span> <span data-ttu-id="e9c6a-303">Vyšší vstupně-výstupní operace, procesoru a paměti přidělení pro vyšší úrovně služeb hello těžit hello hromadné kopírování a odstraňte operace, které hello používá služba rozdělení sloučení.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-303">Higher IO, CPU and memory allocations for hello higher service tiers benefit hello bulk copy and delete operations that hello split-merge service uses.</span></span> <span data-ttu-id="e9c6a-304">Z tohoto důvodu zvýšit úroveň služby hello jen pro tyto databáze definované, omezenou dobu.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-304">For that reason, increase hello service tier just for those databases for a defined, limited period of time.</span></span>

<span data-ttu-id="e9c6a-305">Služba Hello také provádí ověření dotazů v rámci jeho běžných operací.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-305">hello service also performs validation queries as part of its normal operations.</span></span> <span data-ttu-id="e9c6a-306">Tyto dotazy ověření zkontrolujte neočekávané přítomnosti dat v rozsahu cílového hello a zajistilo, že všechny operace rozdělení nebo sloučení nebo přesunutí spuštění z konzistentním stavu.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-306">These validation queries check for unexpected presence of data in hello target range and ensure that any split/merge/move operation starts from a consistent state.</span></span> <span data-ttu-id="e9c6a-307">Všechny tyto dotazy fungovat přes horizontálního dělení rozsahy klíčů definované hello rozsah hello operace a velikost dávky hello zadaný jako součást definice hello žádosti.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-307">These queries all work over sharding key ranges defined by hello scope of hello operation and hello batch size provided as part of hello request definition.</span></span> <span data-ttu-id="e9c6a-308">Tyto dotazy se nejlépe provést, pokud indexu je přítomen, se hello horizontálního dělení klíč jako hello počáteční sloupec.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-308">These queries perform best when an index is present that has hello sharding key as hello leading column.</span></span> 

<span data-ttu-id="e9c6a-309">Vlastnost jedinečnosti klíčem hello horizontálního dělení jako počáteční sloupec hello kromě toho vám umožní hello služby toouse optimalizované přístup, který omezuje spotřeby prostředků z hlediska místa protokolu a paměti.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-309">In addition, a uniqueness property with hello sharding key as hello leading column will allow hello service toouse an optimized approach that limits resource consumption in terms of log space and memory.</span></span> <span data-ttu-id="e9c6a-310">Tato vlastnost jedinečnosti je požadovaná toomove velikostí velkých objemů dat (obvykle vyšší než 1GB).</span><span class="sxs-lookup"><span data-stu-id="e9c6a-310">This uniqueness property is required toomove large data sizes (typically above 1GB).</span></span> 

## <a name="how-tooupgrade"></a><span data-ttu-id="e9c6a-311">Jak tooupgrade</span><span class="sxs-lookup"><span data-stu-id="e9c6a-311">How tooupgrade</span></span>
1. <span data-ttu-id="e9c6a-312">Postupujte podle kroků hello v [nasazení služby rozdělení sloučení](sql-database-elastic-scale-configure-deploy-split-and-merge.md).</span><span class="sxs-lookup"><span data-stu-id="e9c6a-312">Follow hello steps in [Deploy a split-merge service](sql-database-elastic-scale-configure-deploy-split-and-merge.md).</span></span>
2. <span data-ttu-id="e9c6a-313">Změňte cloudu konfigurační soubor služby pro nasazení rozdělení sloučení tooreflect hello nové konfigurace parametry.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-313">Change your cloud service configuration file for your split-merge deployment tooreflect hello new configuration parameters.</span></span> <span data-ttu-id="e9c6a-314">Nový požadovaný parametr je hello informace o hello certifikát použitý k šifrování.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-314">A new required parameter is hello information about hello certificate used for encryption.</span></span> <span data-ttu-id="e9c6a-315">Snadný způsob toodo jde toocompare hello nový konfigurační soubor šablony ze stažení hello proti vaší stávající konfigurace.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-315">An easy way toodo this is toocompare hello new configuration template file from hello download against your existing configuration.</span></span> <span data-ttu-id="e9c6a-316">Ujistěte se, že přidáte hello nastavení "DataEncryptionPrimaryCertificateThumbprint" a "DataEncryptionPrimary" hello webové a roli pracovního procesu hello.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-316">Make sure you add hello settings for “DataEncryptionPrimaryCertificateThumbprint” and “DataEncryptionPrimary” for both hello web and hello worker role.</span></span>
3. <span data-ttu-id="e9c6a-317">Před nasazením aktualizace tooAzure hello, ověřte, že všechny operace právě probíhající rozdělení sloučení byl dokončen.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-317">Before deploying hello update tooAzure, ensure that all currently running split-merge operations have finished.</span></span> <span data-ttu-id="e9c6a-318">Snadno to provedete pomocí dotazu hello stavem a PendingWorkflows tabulky v databázi metadat sloučení rozdělení hello probíhající požadavkům.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-318">You can easily do this by querying hello RequestStatus and PendingWorkflows tables in hello split-merge metadata database for ongoing requests.</span></span>
4. <span data-ttu-id="e9c6a-319">Aktualizujte stávající nasazení cloudové služby pro rozdělení sloučení vašeho předplatného Azure s hello nový balíček a konfiguračním souboru aktualizované služby.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-319">Update your existing cloud service deployment for split-merge in your Azure subscription with hello new package and your updated service configuration file.</span></span>

<span data-ttu-id="e9c6a-320">Není nutné tooprovision novou databázi metadat pro tooupgrade rozdělení sloučení.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-320">You do not need tooprovision a new metadata database for split-merge tooupgrade.</span></span> <span data-ttu-id="e9c6a-321">Nová verze Hello automaticky upgraduje vaše stávající databáze toohello nové verze metadat.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-321">hello new version will automatically upgrade your existing metadata database toohello new version.</span></span> 

## <a name="best-practices--troubleshooting"></a><span data-ttu-id="e9c6a-322">Osvědčené postupy a řešení potíží</span><span class="sxs-lookup"><span data-stu-id="e9c6a-322">Best practices & troubleshooting</span></span>
* <span data-ttu-id="e9c6a-323">Definování testovacím klientem a vykonávat vaše nejdůležitější rozdělení nebo sloučení nebo přesunutí operace s testovacím klientem hello napříč několika horizontálních oddílů.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-323">Define a test tenant and exercise your most important split/merge/move operations with hello test tenant across several shards.</span></span> <span data-ttu-id="e9c6a-324">Zkontrolujte, že všechna metadata správně definován v mapě horizontálního oddílu a že hello operace není v rozporu omezení nebo cizí klíče.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-324">Ensure that all metadata is defined correctly in your shard map and that hello operations do not violate constraints or foreign keys.</span></span>
* <span data-ttu-id="e9c6a-325">Velikost dat klienta testovací hello zachovat výše hello maximální velikost dat klientovi největší tooensure nejsou zjištění velikost dat souvisejících s problémy.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-325">Keep hello test tenant data size above hello maximum data size of your largest tenant tooensure you are not encountering data size related issues.</span></span> <span data-ttu-id="e9c6a-326">To vám usnadní vyhodnocení na hello čas potřebný toomove jednoho klienta kolem horní mez.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-326">This helps you assess an upper bound on hello time it takes toomove a single tenant around.</span></span> 
* <span data-ttu-id="e9c6a-327">Ujistěte se, že schéma umožňuje odstranění.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-327">Make sure that your schema allows deletions.</span></span> <span data-ttu-id="e9c6a-328">Služba rozdělení sloučení Hello vyžaduje hello možnost tooremove data ze zdroje horizontálních hello po hello data byla úspěšně zkopírovaný toohello cíl.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-328">hello split-merge service requires hello ability tooremove data from hello source shard once hello data has been successfully copied toohello target.</span></span> <span data-ttu-id="e9c6a-329">Například **odstranit aktivační události** můžete zabránit odstraňování hello dat na zdroji hello hello služby a může způsobit toofail operace.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-329">For example, **delete triggers** can prevent hello service from deleting hello data on hello source and may cause operations toofail.</span></span>
* <span data-ttu-id="e9c6a-330">Hello horizontálního dělení klíč by měl být hello počáteční sloupec ve vaší primární klíč nebo jedinečný index definice.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-330">hello sharding key should be hello leading column in your primary key or unique index definition.</span></span> <span data-ttu-id="e9c6a-331">Zajistí hello nejlepší výkon pro hello rozdělení nebo sloučení ověření dotazů a pro hello skutečná data přesouvání a odstranění operací, které pracují vždy se rozsahy klíčů horizontálního dělení.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-331">That ensures hello best performance for hello split or merge validation queries, and for hello actual data movement and deletion operations which always operate on sharding key ranges.</span></span>
* <span data-ttu-id="e9c6a-332">Společně umístit služby rozdělení sloučení v oblasti a data center hello kde jsou umístěny databáze.</span><span class="sxs-lookup"><span data-stu-id="e9c6a-332">Collocate your split-merge service in hello region and data center where your databases reside.</span></span> 

[!INCLUDE [elastic-scale-include](../../includes/elastic-scale-include.md)]

<!--Anchors-->
<!--Image references-->
[1]:./media/sql-database-elastic-scale-overview-split-and-merge/split-merge-overview.png
[2]:./media/sql-database-elastic-scale-overview-split-and-merge/diagnostics.png
[3]:./media/sql-database-elastic-scale-overview-split-and-merge/diagnostics-config.png

