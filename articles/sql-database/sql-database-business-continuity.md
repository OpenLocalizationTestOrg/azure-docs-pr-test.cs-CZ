---
title: "aaaCloud provozní kontinuitu – obnovení databáze – databáze SQL | Microsoft Docs"
description: "Zjistěte, jak Azure SQL Database podporuje provozní kontinuitu v cloudu a obnovení databází a jak pomáhá udržovat klíčové cloudové aplikace v chodu."
keywords: "provozní kontinuita, provozní kontinuita v cloudu, zotavení databáze po havárii, obnovení databáze"
services: sql-database
documentationcenter: 
author: anosov1960
manager: jhubbard
editor: 
ms.assetid: 18e5d3f1-bfe5-4089-b6fd-76988ab29822
ms.service: sql-database
ms.custom: business continuity
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 05/15/2017
ms.author: sashan
ms.openlocfilehash: c9a6ff86fbbc04ce839a4fca79594b573b71644c
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="overview-of-business-continuity-with-azure-sql-database"></a><span data-ttu-id="16233-104">Přehled provozní kontinuity se službou Azure SQL Database</span><span class="sxs-lookup"><span data-stu-id="16233-104">Overview of business continuity with Azure SQL Database</span></span>

<span data-ttu-id="16233-105">Tento přehled popisuje hello možnosti, které poskytuje Azure SQL Database pro provozní kontinuitu a zotavení po havárii.</span><span class="sxs-lookup"><span data-stu-id="16233-105">This overview describes hello capabilities that Azure SQL Database provides for business continuity and disaster recovery.</span></span> <span data-ttu-id="16233-106">Další informace o možnostech, doporučení a kurzy pro obnovení z rušivý událostí, které může dojít ke ztrátě dat nebo způsobit, že vaše databáze a aplikace toobecome není k dispozici.</span><span class="sxs-lookup"><span data-stu-id="16233-106">Learn about options, recommendations, and tutorials for recovering from disruptive events that could cause data loss or cause your database and application toobecome unavailable.</span></span> <span data-ttu-id="16233-107">Jaké toodo informace, pokud uživatele nebo aplikace chyba ovlivňuje integritu dat, oblast Azure má výpadek nebo pokud vaše aplikace vyžaduje údržby.</span><span class="sxs-lookup"><span data-stu-id="16233-107">Learn what toodo when a user or application error affects data integrity, an Azure region has an outage, or your application requires maintenance.</span></span>

## <a name="sql-database-features-that-you-can-use-tooprovide-business-continuity"></a><span data-ttu-id="16233-108">Funkce databáze SQL, které můžete použít tooprovide kontinuity podnikových procesů</span><span class="sxs-lookup"><span data-stu-id="16233-108">SQL Database features that you can use tooprovide business continuity</span></span>

<span data-ttu-id="16233-109">SQL Database poskytuje řadu funkcí provozní kontinuity, včetně automatizovaných záloh a volitelné replikace databáze.</span><span class="sxs-lookup"><span data-stu-id="16233-109">SQL Database provides several business continuity features, including automated backups and optional database replication.</span></span> <span data-ttu-id="16233-110">Každá má jiné vlastnosti ohledně odhadovaného času obnovení (ERT) a potenciální ztráty dat posledních transakcí.</span><span class="sxs-lookup"><span data-stu-id="16233-110">Each has different characteristics for estimated recovery time (ERT) and potential data loss for recent transactions.</span></span> <span data-ttu-id="16233-111">Jakmile tyto možnosti pochopíte, můžete si mezi nimi vybírat a ve většině scénářů je spolu kombinovat a používat pro různé scénáře.</span><span class="sxs-lookup"><span data-stu-id="16233-111">Once you understand these options, you can choose among them - and, in most scenarios, use them together for different scenarios.</span></span> <span data-ttu-id="16233-112">Když budete vyvíjet plánu pro kontinuitu podnikových, je nutné toounderstand hello maximální přijatelnou dobu, než aplikace hello plně obnoví po nepříjemným událostem hello – to je cíli času obnovení (RTO).</span><span class="sxs-lookup"><span data-stu-id="16233-112">As you develop your business continuity plan, you need toounderstand hello maximum acceptable time before hello application fully recovers after hello disruptive event - this is your recovery time objective (RTO).</span></span> <span data-ttu-id="16233-113">Musíte taky toounderstand hello maximální množství nejnovější data aktualizací (časový interval) hello aplikace může tolerovat ke ztrátám při obnovování po nepříjemným událostem hello – to je cíl bodu obnovení (RPO).</span><span class="sxs-lookup"><span data-stu-id="16233-113">You also need toounderstand hello maximum amount of recent data updates (time interval) hello application can tolerate losing when recovering after hello disruptive event - this is your recovery point objective (RPO).</span></span>

<span data-ttu-id="16233-114">Následující tabulka porovnává Hello hello vložit a plánovaný bod obnovení pro hello tři nejběžnější scénářů.</span><span class="sxs-lookup"><span data-stu-id="16233-114">hello following table compares hello ERT and RPO for hello three most common scenarios.</span></span>

| <span data-ttu-id="16233-115">Schopnost</span><span class="sxs-lookup"><span data-stu-id="16233-115">Capability</span></span> | <span data-ttu-id="16233-116">Úroveň Basic</span><span class="sxs-lookup"><span data-stu-id="16233-116">Basic tier</span></span> | <span data-ttu-id="16233-117">Úroveň Standard</span><span class="sxs-lookup"><span data-stu-id="16233-117">Standard tier</span></span> | <span data-ttu-id="16233-118">Úroveň Premium</span><span class="sxs-lookup"><span data-stu-id="16233-118">Premium tier</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="16233-119">Obnovení k určitému bodu v čase ze zálohy</span><span class="sxs-lookup"><span data-stu-id="16233-119">Point in Time Restore from backup</span></span> |<span data-ttu-id="16233-120">Libovolný bod obnovení do 7 dní</span><span class="sxs-lookup"><span data-stu-id="16233-120">Any restore point within 7 days</span></span> |<span data-ttu-id="16233-121">Libovolný bod obnovení do 35 dní</span><span class="sxs-lookup"><span data-stu-id="16233-121">Any restore point within 35 days</span></span> |<span data-ttu-id="16233-122">Libovolný bod obnovení do 35 dní</span><span class="sxs-lookup"><span data-stu-id="16233-122">Any restore point within 35 days</span></span> |
| <span data-ttu-id="16233-123">Geografické obnovení ze zálohy geograficky replikované</span><span class="sxs-lookup"><span data-stu-id="16233-123">Geo-restore from geo-replicated backups</span></span> |<span data-ttu-id="16233-124">ERT < 12 h, RPO < 1 h</span><span class="sxs-lookup"><span data-stu-id="16233-124">ERT < 12h, RPO < 1h</span></span> |<span data-ttu-id="16233-125">ERT < 12 h, RPO < 1 h</span><span class="sxs-lookup"><span data-stu-id="16233-125">ERT < 12h, RPO < 1h</span></span> |<span data-ttu-id="16233-126">ERT < 12 h, RPO < 1 h</span><span class="sxs-lookup"><span data-stu-id="16233-126">ERT < 12h, RPO < 1h</span></span> |
| <span data-ttu-id="16233-127">Obnovení z úložiště záloh Azure Backup Vault</span><span class="sxs-lookup"><span data-stu-id="16233-127">Restore from Azure Backup Vault</span></span> |<span data-ttu-id="16233-128">ERT < 12 h, RPO < 1 týden</span><span class="sxs-lookup"><span data-stu-id="16233-128">ERT < 12h, RPO < 1 wk</span></span> |<span data-ttu-id="16233-129">ERT < 12 h, RPO < 1 týden</span><span class="sxs-lookup"><span data-stu-id="16233-129">ERT < 12h, RPO < 1 wk</span></span> |<span data-ttu-id="16233-130">ERT < 12 h, RPO < 1 týden</span><span class="sxs-lookup"><span data-stu-id="16233-130">ERT < 12h, RPO < 1 wk</span></span> |
| <span data-ttu-id="16233-131">Aktivní geografickou replikaci</span><span class="sxs-lookup"><span data-stu-id="16233-131">Active geo-replication</span></span> |<span data-ttu-id="16233-132">ERT < 30 s, RPO < 5 s</span><span class="sxs-lookup"><span data-stu-id="16233-132">ERT < 30s, RPO < 5s</span></span> |<span data-ttu-id="16233-133">ERT < 30 s, RPO < 5 s</span><span class="sxs-lookup"><span data-stu-id="16233-133">ERT < 30s, RPO < 5s</span></span> |<span data-ttu-id="16233-134">ERT < 30 s, RPO < 5 s</span><span class="sxs-lookup"><span data-stu-id="16233-134">ERT < 30s, RPO < 5s</span></span> |

### <a name="use-database-backups-toorecover-a-database"></a><span data-ttu-id="16233-135">Použít databázi toorecover zálohování databáze</span><span class="sxs-lookup"><span data-stu-id="16233-135">Use database backups toorecover a database</span></span>

<span data-ttu-id="16233-136">SQL Database automaticky provede kombinaci databáze úplné zálohování každý týden, databáze rozdílové zálohy každou hodinu a transakce protokolu zálohování každých pět – deset minut tooprotect vaši firmu před ztrátou data.</span><span class="sxs-lookup"><span data-stu-id="16233-136">SQL Database automatically performs a combination of full database backups weekly, differential database backups hourly, and transaction log backups every five - ten minutes tooprotect your business from data loss.</span></span> <span data-ttu-id="16233-137">Tyto zálohy se ukládají v geograficky redundantní úložiště pro 35 dní u databází v hello Standard a Premium úrovně služeb a pro databáze na úrovních základní služby hello 7 dní.</span><span class="sxs-lookup"><span data-stu-id="16233-137">These backups are stored in geo-redundant storage for 35 days for databases in hello Standard and Premium service tiers and 7 days for databases in hello Basic service tier.</span></span> <span data-ttu-id="16233-138">Další informace najdete v tématu [úrovních služeb](sql-database-service-tiers.md).</span><span class="sxs-lookup"><span data-stu-id="16233-138">For more information, see [service tiers](sql-database-service-tiers.md).</span></span> <span data-ttu-id="16233-139">Doba uchování hello vaší vrstvy služby nesplňuje požadavky vaší organizace, můžete zvýšit období uchování hello [Změna úrovně služby hello](sql-database-service-tiers.md).</span><span class="sxs-lookup"><span data-stu-id="16233-139">If hello retention period for your service tier does not meet your business requirements, you can increase hello retention period by [changing hello service tier](sql-database-service-tiers.md).</span></span> <span data-ttu-id="16233-140">Hello databáze úplné a rozdílové zálohy jsou také replikované tooa [spárované datového centra](../best-practices-availability-paired-regions.md) pro ochranu proti výpadku datacentra.</span><span class="sxs-lookup"><span data-stu-id="16233-140">hello full and differential database backups are also replicated tooa [paired data center](../best-practices-availability-paired-regions.md) for protection against a data center outage.</span></span> <span data-ttu-id="16233-141">Další informace najdete v tématu [automatické zálohování databází](sql-database-automated-backups.md).</span><span class="sxs-lookup"><span data-stu-id="16233-141">For more information, see [automatic database backups](sql-database-automated-backups.md).</span></span>

<span data-ttu-id="16233-142">Pokud doba uchování předdefinované hello není dostatečná pro aplikaci, můžete ji rozšířit tak, že nakonfigurujete zásady dlouhodobé uchovávání informací databáze.</span><span class="sxs-lookup"><span data-stu-id="16233-142">If hello built-in retention period is not sufficient for your application, you can extend it by configuring a database long-term retention policy.</span></span> <span data-ttu-id="16233-143">Další informace najdete v tématu [dlouhodobé uchovávání](sql-database-long-term-retention.md).</span><span class="sxs-lookup"><span data-stu-id="16233-143">For more information, see [long-term retention](sql-database-long-term-retention.md).</span></span>

<span data-ttu-id="16233-144">Můžete použít tyto databáze automatické zálohování toorecover databáze z různých rušivý událostí, jak v rámci datového centra a tooanother datového centra.</span><span class="sxs-lookup"><span data-stu-id="16233-144">You can use these automatic database backups toorecover a database from various disruptive events, both within your data center and tooanother data center.</span></span> <span data-ttu-id="16233-145">Pomocí automatické zálohování databází, hello odhadovaný čas obnovení závisí na několika faktorech včetně hello celkový počet databází obnovování hello stejné oblasti v hello stejný čas, hello velikost databáze, hello velikosti protokolu transakcí a šířku pásma sítě.</span><span class="sxs-lookup"><span data-stu-id="16233-145">Using automatic database backups, hello estimated time of recovery depends on several factors including hello total number of databases recovering in hello same region at hello same time, hello database size, hello transaction log size, and network bandwidth.</span></span> <span data-ttu-id="16233-146">Doba obnovení Hello je obvykle menší než 12 hodin.</span><span class="sxs-lookup"><span data-stu-id="16233-146">hello recovery time is usually less than 12 hours.</span></span> <span data-ttu-id="16233-147">Při obnovování tooanother datové oblasti, hello potenciální ztrátě dat je omezená too1 hodinu a hello geograficky redundantní úložiště záloh hodinové rozdílové databáze.</span><span class="sxs-lookup"><span data-stu-id="16233-147">When recovering tooanother data region, hello potential data loss is limited too1 hour by hello geo-redundant storage of hourly differential database backups.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="16233-148">pomocí toorecover automatizované zálohování, musíte být členem role Přispěvatel SQL Server hello nebo vlastník předplatného hello – viz [RBAC: předdefinované role](../active-directory/role-based-access-built-in-roles.md).</span><span class="sxs-lookup"><span data-stu-id="16233-148">toorecover using automated backups, you must be a member of hello SQL Server Contributor role or hello subscription owner - see [RBAC: Built-in roles](../active-directory/role-based-access-built-in-roles.md).</span></span> <span data-ttu-id="16233-149">Můžete ho obnovit pomocí hello portálu Azure, PowerShell nebo hello REST API.</span><span class="sxs-lookup"><span data-stu-id="16233-149">You can recover using hello Azure portal, PowerShell, or hello REST API.</span></span> <span data-ttu-id="16233-150">Nelze použít jazyk Transact-SQL.</span><span class="sxs-lookup"><span data-stu-id="16233-150">You cannot use Transact-SQL.</span></span>
>

<span data-ttu-id="16233-151">Automatizované zálohování použijte pro zajištění provozní kontinuity a jako mechanismus obnovení, pokud vaše aplikace:</span><span class="sxs-lookup"><span data-stu-id="16233-151">Use automated backups as your business continuity and recovery mechanism if your application:</span></span>

* <span data-ttu-id="16233-152">Není považována za klíčovou.</span><span class="sxs-lookup"><span data-stu-id="16233-152">Is not considered mission critical.</span></span>
* <span data-ttu-id="16233-153">Nemá vazbu SLA - výpadek 24 hodin nebo již nemá za následek finanční odpovědnosti.</span><span class="sxs-lookup"><span data-stu-id="16233-153">Doesn't have a binding SLA - a downtime of 24 hours or longer does not result in financial liability.</span></span>
* <span data-ttu-id="16233-154">S nízkou rychlostí změny dat (nízkou transakce za hodinu) a ke ztrátě až tooan je hodina změny přijatelné únikem.</span><span class="sxs-lookup"><span data-stu-id="16233-154">Has a low rate of data change (low transactions per hour) and losing up tooan hour of change is an acceptable data loss.</span></span>
* <span data-ttu-id="16233-155">Je citlivá na změny nákladů.</span><span class="sxs-lookup"><span data-stu-id="16233-155">Is cost sensitive.</span></span>

<span data-ttu-id="16233-156">Pokud potřebujete rychlejší obnovení, použijte [aktivní geografickou replikací](sql-database-geo-replication-overview.md) (popsané dále).</span><span class="sxs-lookup"><span data-stu-id="16233-156">If you need faster recovery, use [active geo-replication](sql-database-geo-replication-overview.md) (discussed next).</span></span> <span data-ttu-id="16233-157">Pokud potřebujete toobe možné toorecover data z období starší než 35 dní, použijte [dlouhodobé uchovávání záloh](sql-database-long-term-retention.md).</span><span class="sxs-lookup"><span data-stu-id="16233-157">If you need toobe able toorecover data from a period older than 35 days, use [long-term backup retention](sql-database-long-term-retention.md).</span></span> 

### <a name="use-active-geo-replication-and-auto-failover-groups-in-preview-tooreduce-recovery-time-and-limit-data-loss-associated-with-a-recovery"></a><span data-ttu-id="16233-158">Použít active geografická replikace a automatické převzetí služeb při selhání skupiny (v preview) tooreduce obnovení čas a omezení ztrátě dat přidružené k obnovení</span><span class="sxs-lookup"><span data-stu-id="16233-158">Use active geo-replication and auto-failover groups (in-preview) tooreduce recovery time and limit data loss associated with a recovery</span></span>

<span data-ttu-id="16233-159">Kromě toho toousing zálohy databáze pro databázi obnovení, pokud dojde k přerušení obchodní, můžete použít [aktivní geografickou replikací](sql-database-geo-replication-overview.md) tooconfigure databáze toohave až toofour čitelný sekundární databáze v oblastech hello z vaší volba.</span><span class="sxs-lookup"><span data-stu-id="16233-159">In addition toousing database backups for database recovery if a business disruption occurs, you can use [active geo-replication](sql-database-geo-replication-overview.md) tooconfigure a database toohave up toofour readable secondary databases in hello regions of your choice.</span></span> <span data-ttu-id="16233-160">Tyto sekundární databáze jsou synchronizovány s databází primární hello pomocí mechanismus asynchronní replikaci.</span><span class="sxs-lookup"><span data-stu-id="16233-160">These secondary databases are kept synchronized with hello primary database using an asynchronous replication mechanism.</span></span> <span data-ttu-id="16233-161">Tato funkce je použité tooprotect proti přerušení obchodní, pokud dojde k výpadku datacentra nebo během upgradu aplikace.</span><span class="sxs-lookup"><span data-stu-id="16233-161">This feature is used tooprotect against business disruption if a data center outage occurs or during an application upgrade.</span></span> <span data-ttu-id="16233-162">Aktivní geografickou replikací může být také použít tooprovide lepší výkon dotazů pro uživatele toogeographically rozmístěnými dotazy jen pro čtení.</span><span class="sxs-lookup"><span data-stu-id="16233-162">Active geo-replication can also be used tooprovide better query performance for read-only queries toogeographically dispersed users.</span></span>

<span data-ttu-id="16233-163">automatizované tooenable a transparentní převzetí služeb při selhání by měl uspořádání geograficky replikované databáze do skupiny pomocí hello [-automatické převzetí služeb při selhání skupiny](sql-database-geo-replication-overview.md) funkce SQL Database (-preview).</span><span class="sxs-lookup"><span data-stu-id="16233-163">tooenable automated and transparent failover you should organize your geo-replicated databases into groups using hello [auto-failover group](sql-database-geo-replication-overview.md) feature of SQL Database (in-preview).</span></span>

<span data-ttu-id="16233-164">Pokud primární databáze hello neočekávaně přejde do režimu offline nebo potřebujete tootake ho do offline režimu pro údržbu aktivity, můžete rychle podporovat primární sekundární toobecome hello (také nazývané převzetí služeb při selhání) a nakonfigurovat aplikace tooconnect toohello povýší primární.</span><span class="sxs-lookup"><span data-stu-id="16233-164">If hello primary database goes offline unexpectedly or you need tootake it offline for maintenance activities, you can quickly promote a secondary toobecome hello primary (also called a failover) and configure applications tooconnect toohello promoted primary.</span></span> <span data-ttu-id="16233-165">Pokud vaše aplikace se připojuje toohello databází pomocí naslouchací proces skupiny hello převzetí služeb při selhání, nepotřebujete konfigurace o řetězce připojení SQL hello toochange po převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="16233-165">If your application is connecting toohello databases using hello failover group listener, you don’t need toochange hello SQL connection string configuration after failover.</span></span> <span data-ttu-id="16233-166">U plánovaného převzetí služeb při selhání nedojde ke ztrátě dat.</span><span class="sxs-lookup"><span data-stu-id="16233-166">With a planned failover, there is no data loss.</span></span> <span data-ttu-id="16233-167">S neplánované převzetí služeb při selhání může být některé malé množství ztráty dat pro velmi poslední transakce z důvodu toohello povaze asynchronní replikaci.</span><span class="sxs-lookup"><span data-stu-id="16233-167">With an unplanned failover, there may be some small amount of data loss for very recent transactions due toohello nature of asynchronous replication.</span></span> <span data-ttu-id="16233-168">Použití skupin automatické převzetí služeb při selhání (v preview), můžete přizpůsobit hello převzetí služeb při selhání zásad toominimize hello potenciální ztrátě dat.</span><span class="sxs-lookup"><span data-stu-id="16233-168">Using auto-failover groups (in-preview), you can customize hello failover policy toominimize hello potential data loss.</span></span> <span data-ttu-id="16233-169">Po selhání můžete později navrácení služeb po obnovení – přejde do režimu online podle plánu tooa nebo když hello datového centra.</span><span class="sxs-lookup"><span data-stu-id="16233-169">After a failover, you can later failback - either according tooa plan or when hello data center comes back online.</span></span> <span data-ttu-id="16233-170">Ve všech případech se uživatelé prostředí malé množství výpadek je potřeba tooreconnect.</span><span class="sxs-lookup"><span data-stu-id="16233-170">In all cases, users experience a small amount of downtime and need tooreconnect.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="16233-171">toouse aktivní geografickou replikaci a skupiny automatické převzetí služeb při selhání (v preview), musíte buď být hello vlastník předplatného nebo mít oprávnění správce v systému SQL Server.</span><span class="sxs-lookup"><span data-stu-id="16233-171">toouse active geo-replication and auto-failover groups (in-preview), you must either be hello subscription owner or have administrative permissions in SQL Server.</span></span> <span data-ttu-id="16233-172">Můžete nakonfigurovat a převzít pomocí hello portál Azure, prostředí PowerShell nebo hello REST API pomocí oprávnění předplatného Azure nebo pomocí jazyka Transact-SQL s oprávněními systému SQL Server.</span><span class="sxs-lookup"><span data-stu-id="16233-172">You can configure and fail over using hello Azure portal, PowerShell, or hello REST API using Azure subscription permissions or using Transact-SQL with SQL Server permissions.</span></span>
> 

<span data-ttu-id="16233-173">Použijte active geografická replikace a automatické převzetí služeb při selhání skupiny (ve verzi preview), pokud vaše aplikace splňuje některé z těchto kritérií:</span><span class="sxs-lookup"><span data-stu-id="16233-173">Use active geo-replication and auto-failover groups (in preview) if your application meets any of these criteria:</span></span>

* <span data-ttu-id="16233-174">Je zvlášť důležitá.</span><span class="sxs-lookup"><span data-stu-id="16233-174">Is mission critical.</span></span>
* <span data-ttu-id="16233-175">Má smlouvu SLA, která nepovoluje výpadek delší než 24 hodin.</span><span class="sxs-lookup"><span data-stu-id="16233-175">Has a service level agreement (SLA) that does not allow for 24 hours or more of downtime.</span></span>
* <span data-ttu-id="16233-176">Výpadek může mít za následek finanční odpovědnosti.</span><span class="sxs-lookup"><span data-stu-id="16233-176">Downtime may result in financial liability.</span></span>
* <span data-ttu-id="16233-177">Pracuje s vysokou mírou změn dat a ztráta dat za jednu hodinu je nepřijatelná.</span><span class="sxs-lookup"><span data-stu-id="16233-177">Has a high rate of data change is high and losing an hour of data is not acceptable.</span></span>
* <span data-ttu-id="16233-178">Hello další náklady na aktivní geografickou replikací je nižší než hello potenciální finanční odpovědnosti a přidružené ke ztrátě firmy.</span><span class="sxs-lookup"><span data-stu-id="16233-178">hello additional cost of active geo-replication is lower than hello potential financial liability and associated loss of business.</span></span>

>
> [!VIDEO https://channel9.msdn.com/Blogs/Azure/Azure-SQL-Database-protecting-important-DBs-from-regional-disasters-is-easy/player]
>

## <a name="recover-a-database-after-a-user-or-application-error"></a><span data-ttu-id="16233-179">Obnovení databáze po chybě uživatele nebo aplikace</span><span class="sxs-lookup"><span data-stu-id="16233-179">Recover a database after a user or application error</span></span>
<span data-ttu-id="16233-180">* Nikdo není dokonalý!</span><span class="sxs-lookup"><span data-stu-id="16233-180">*No one is perfect!</span></span> <span data-ttu-id="16233-181">Uživatel může omylem odstranit některá data, nedopatřením smazat důležitou tabulku nebo dokonce smazat celou databázi.</span><span class="sxs-lookup"><span data-stu-id="16233-181">A user might accidentally delete some data, inadvertently drop an important table, or even drop an entire database.</span></span> <span data-ttu-id="16233-182">Nebo aplikace omylem přepsat dobrých dat s chybná data z důvodu tooan aplikace vadou.</span><span class="sxs-lookup"><span data-stu-id="16233-182">Or, an application might accidentally overwrite good data with bad data due tooan application defect.</span></span>

<span data-ttu-id="16233-183">V takovém scénáři máte následující možnosti obnovení.</span><span class="sxs-lookup"><span data-stu-id="16233-183">In this scenario, these are your recovery options.</span></span>

### <a name="perform-a-point-in-time-restore"></a><span data-ttu-id="16233-184">Obnovení k určitému bodu v čase</span><span class="sxs-lookup"><span data-stu-id="16233-184">Perform a point-in-time restore</span></span>
<span data-ttu-id="16233-185">Hello automatizované zálohování toorecover kopii vaší databáze tooa známé dobré bodu v čase, můžete použít za předpokladu, že čas je v rámci doby uchování databáze hello.</span><span class="sxs-lookup"><span data-stu-id="16233-185">You can use hello automated backups toorecover a copy of your database tooa known good point in time, provided that time is within hello database retention period.</span></span> <span data-ttu-id="16233-186">Po obnovení databáze hello, můžete nahradit původní databáze hello hello obnovit databáze nebo zkopírování dat hello potřeby z hello obnovit data do původní databáze hello.</span><span class="sxs-lookup"><span data-stu-id="16233-186">After hello database is restored, you can either replace hello original database with hello restored database or copy hello needed data from hello restored data into hello original database.</span></span> <span data-ttu-id="16233-187">Pokud hello databáze používá aktivní geografickou replikaci, doporučujeme kopírování dat vyžaduje hello z kopie hello obnovení do původní databáze hello.</span><span class="sxs-lookup"><span data-stu-id="16233-187">If hello database uses active geo-replication, we recommend copying hello required data from hello restored copy into hello original database.</span></span> <span data-ttu-id="16233-188">Pokud je původní databáze hello nahradit hello obnovit databázi, potřebujete tooreconfigure a poté proveďte opakovanou synchronizaci aktivní geografickou replikaci (který může trvat poměrně nějakou dobu pro velké databáze).</span><span class="sxs-lookup"><span data-stu-id="16233-188">If you replace hello original database with hello restored database, you need tooreconfigure and resynchronize active geo-replication (which can take quite some time for a large database).</span></span>

<span data-ttu-id="16233-189">Další informace a podrobné pokyny k obnovení databáze tooa časovému současně pomocí hello portál Azure nebo pomocí prostředí PowerShell, najdete v tématu [obnovení bodu v čase](sql-database-recovery-using-backups.md#point-in-time-restore).</span><span class="sxs-lookup"><span data-stu-id="16233-189">For more information and for detailed steps for restoring a database tooa point in time using hello Azure portal or using PowerShell, see [point-in-time restore](sql-database-recovery-using-backups.md#point-in-time-restore).</span></span> <span data-ttu-id="16233-190">Obnovení nelze provést pomocí jazyka Transact-SQL.</span><span class="sxs-lookup"><span data-stu-id="16233-190">You cannot recover using Transact-SQL.</span></span>

### <a name="restore-a-deleted-database"></a><span data-ttu-id="16233-191">Obnovení odstraněné databáze</span><span class="sxs-lookup"><span data-stu-id="16233-191">Restore a deleted database</span></span>
<span data-ttu-id="16233-192">Pokud hello databáze, se odstraní, ale nebyl odstraněn hello logického serveru, můžete obnovit hello odstranit databázi toohello bodu, kdy byla odstraněna.</span><span class="sxs-lookup"><span data-stu-id="16233-192">If hello database is deleted but hello logical server has not been deleted, you can restore hello deleted database toohello point at which it was deleted.</span></span> <span data-ttu-id="16233-193">Tím se obnoví toohello zálohování databáze stejný logický SQL server, ze kterého byla odstraněna.</span><span class="sxs-lookup"><span data-stu-id="16233-193">This restores a database backup toohello same logical SQL server from which it was deleted.</span></span> <span data-ttu-id="16233-194">Můžete obnovit pomocí hello původní název nebo zadejte nový název nebo hello obnovit databázi.</span><span class="sxs-lookup"><span data-stu-id="16233-194">You can restore it using hello original name or provide a new name or hello restored database.</span></span>

<span data-ttu-id="16233-195">Další informace a podrobné pokyny k obnovení odstraněné databáze hello pomocí portálu Azure nebo pomocí prostředí PowerShell, najdete v části [obnovit odstraněnou databázi](sql-database-recovery-using-backups.md#deleted-database-restore).</span><span class="sxs-lookup"><span data-stu-id="16233-195">For more information and for detailed steps for restoring a deleted database using hello Azure portal or using PowerShell, see [restore a deleted database](sql-database-recovery-using-backups.md#deleted-database-restore).</span></span> <span data-ttu-id="16233-196">Obnovení nelze provést pomocí jazyka Transact-SQL.</span><span class="sxs-lookup"><span data-stu-id="16233-196">You cannot restore using Transact-SQL.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="16233-197">Je-li logický server hello odstraněna, nelze obnovit odstraněnou databázi.</span><span class="sxs-lookup"><span data-stu-id="16233-197">If hello logical server is deleted, you cannot recover a deleted database.</span></span>
>
>

### <a name="restore-from-azure-backup-vault"></a><span data-ttu-id="16233-198">Obnovení z úložiště záloh Azure Backup Vault</span><span class="sxs-lookup"><span data-stu-id="16233-198">Restore from Azure Backup Vault</span></span>
<span data-ttu-id="16233-199">Pokud došlo k chybě hello ztráty dat mimo hello aktuální dobu uchování pro automatizované zálohování a je databáze nakonfigurovaná pro dlouhodobé uchovávání, můžete obnovit ze zálohy týdně v trezoru zálohování Azure tooa novou databázi.</span><span class="sxs-lookup"><span data-stu-id="16233-199">If hello data loss occurred outside hello current retention period for automated backups and your database is configured for long-term retention, you can restore from a weekly backup in Azure Backup Vault tooa new database.</span></span> <span data-ttu-id="16233-200">V tomto okamžiku můžete nahradit původní databáze hello hello obnovit databáze nebo zkopírování dat hello potřeby z hello obnovit databázi do původní databáze hello.</span><span class="sxs-lookup"><span data-stu-id="16233-200">At this point, you can either replace hello original database with hello restored database or copy hello needed data from hello restored database into hello original database.</span></span> <span data-ttu-id="16233-201">Pokud potřebujete tooretrieve starší verzi upgradu databáze před tooa hlavní aplikace, splnit žádost od auditory nebo právní pořadí, že můžete vytvořit databázi pomocí úplné zálohy uložené v hello úložiště záloh Azure.</span><span class="sxs-lookup"><span data-stu-id="16233-201">If you need tooretrieve an old version of your database prior tooa major application upgrade, satisfy a request from auditors or a legal order, you can create a database using a full backup saved in hello Azure Backup Vault.</span></span>  <span data-ttu-id="16233-202">Další informace najdete v tématu [Dlouhodobé uchovávání](sql-database-long-term-retention.md).</span><span class="sxs-lookup"><span data-stu-id="16233-202">For more information, see [Long-term retention](sql-database-long-term-retention.md).</span></span>

## <a name="recover-a-database-tooanother-region-from-an-azure-regional-data-center-outage"></a><span data-ttu-id="16233-203">Obnovení databáze tooanother oblast výpadku center Azure místní data</span><span class="sxs-lookup"><span data-stu-id="16233-203">Recover a database tooanother region from an Azure regional data center outage</span></span>
<!-- Explain this scenario -->

<span data-ttu-id="16233-204">Přestože je taková situace výjimečná, i u datového centra Azure může dojít k výpadku.</span><span class="sxs-lookup"><span data-stu-id="16233-204">Although rare, an Azure data center can have an outage.</span></span> <span data-ttu-id="16233-205">Při výpadku dojde k narušení provozu, které může trvat jen několik minut nebo až několik hodin.</span><span class="sxs-lookup"><span data-stu-id="16233-205">When an outage occurs, it causes a business disruption that might only last a few minutes or might last for hours.</span></span>

* <span data-ttu-id="16233-206">Jednou z možností je toowait pro vaši databázi toocome zpět do režimu online při hello data center výpadku.</span><span class="sxs-lookup"><span data-stu-id="16233-206">One option is toowait for your database toocome back online when hello data center outage is over.</span></span> <span data-ttu-id="16233-207">Tento postup funguje pro aplikace, které si může dovolit toohave hello databázi do režimu offline.</span><span class="sxs-lookup"><span data-stu-id="16233-207">This works for applications that can afford toohave hello database offline.</span></span> <span data-ttu-id="16233-208">Například vývojový projekt nebo bezplatnou zkušební verzi nepotřebujete toowork na neustále.</span><span class="sxs-lookup"><span data-stu-id="16233-208">For example, a development project or free trial you don't need toowork on constantly.</span></span> <span data-ttu-id="16233-209">Je-li v datovém centru k výpadku, si nejste jisti, jak dlouho může poslední hello výpadku, proto tato možnost funguje jenom v případě nepotřebujete databáze nějakou dobu.</span><span class="sxs-lookup"><span data-stu-id="16233-209">When a data center has an outage, you do not know how long hello outage might last, so this option only works if you don't need your database for a while.</span></span>
* <span data-ttu-id="16233-210">Další možností je selhání tooeither přes tooanother datové oblasti, pokud používáte aktivní geografickou replikaci nebo hello obnovit databázi pomocí zálohy geograficky redundantní databáze (geografické obnovení).</span><span class="sxs-lookup"><span data-stu-id="16233-210">Another option is tooeither fail over tooanother data region if you are using active geo-replication or hello recover a database using geo-redundant database backups (geo-restore).</span></span> <span data-ttu-id="16233-211">Převzetí služeb při selhání trvá jenom pár sekund, při obnovení databáze ze zálohy trvá hodin.</span><span class="sxs-lookup"><span data-stu-id="16233-211">Failover takes only a few seconds while database recovery from backups takes hours.</span></span>

<span data-ttu-id="16233-212">Při provedení akce, jak dlouho trvá jste toorecover a kolik ztrátě dat, která vám vznikne závisí na tom, jak se rozhodnete toouse tyto funkce kontinuity obchodních ve vaší aplikaci.</span><span class="sxs-lookup"><span data-stu-id="16233-212">When you take action, how long it takes you toorecover, and how much data loss you incur depends upon how you decide toouse these business continuity features in your application.</span></span> <span data-ttu-id="16233-213">Skutečně můžete se rozhodnout toouse kombinaci zálohy databáze a aktivní geografickou replikací v závislosti na požadavcích vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="16233-213">Indeed, you may choose toouse a combination of database backups and active geo-replication depending upon your application requirements.</span></span> <span data-ttu-id="16233-214">Diskuzi o aspektech návrhu aplikací pro samostatné databáze a pro elastické fondy pomocí těchto funkcí provozní kontinuity najdete v tématech [Návrh aplikace pro zotavení po havárii cloudu](sql-database-designing-cloud-solutions-for-disaster-recovery.md) a [Strategie zotavení po havárii elastických fondů](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span><span class="sxs-lookup"><span data-stu-id="16233-214">For a discussion of application design considerations for stand-alone databases and for elastic pools using these business continuity features, see [Design an application for cloud disaster recovery](sql-database-designing-cloud-solutions-for-disaster-recovery.md) and [Elastic Pool disaster recovery strategies](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span></span>

<span data-ttu-id="16233-215">Hello následující části obsahují základní informace o toorecover kroky hello pomocí zálohy databáze nebo aktivní geografickou replikací.</span><span class="sxs-lookup"><span data-stu-id="16233-215">hello following sections provide an overview of hello steps toorecover using either database backups or active geo-replication.</span></span> <span data-ttu-id="16233-216">Podrobné kroky, včetně plánování požadavky, postup obnovení post a informace o tom, jak toosimulate výpadku tooperform zotavení po havárii zobrazit další podrobnosti najdete v tématu [obnovení databáze serveru SQL výpadku](sql-database-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="16233-216">For detailed steps including planning requirements, post recovery steps, and information about how toosimulate an outage tooperform a disaster recovery drill, see [Recover a SQL Database from an outage](sql-database-disaster-recovery.md).</span></span>

### <a name="prepare-for-an-outage"></a><span data-ttu-id="16233-217">Příprava na výpadek</span><span class="sxs-lookup"><span data-stu-id="16233-217">Prepare for an outage</span></span>
<span data-ttu-id="16233-218">Bez ohledu na to hello firmy kontinuity funkce, kterou používáte musíte:</span><span class="sxs-lookup"><span data-stu-id="16233-218">Regardless of hello business continuity feature you use, you must:</span></span>

* <span data-ttu-id="16233-219">Identifikovat a připravit cílový server hello, včetně pravidel brány firewall na úrovni serveru, přihlášení a oprávnění na úrovni hlavní databázi.</span><span class="sxs-lookup"><span data-stu-id="16233-219">Identify and prepare hello target server, including server-level firewall rules, logins, and master database level permissions.</span></span>
* <span data-ttu-id="16233-220">Určit, jak tooredirect klientů a klienta aplikace toohello nový server</span><span class="sxs-lookup"><span data-stu-id="16233-220">Determine how tooredirect clients and client applications toohello new server</span></span>
* <span data-ttu-id="16233-221">Zdokumentovat další závislosti, například nastavení auditování a výstrahy</span><span class="sxs-lookup"><span data-stu-id="16233-221">Document other dependencies, such as auditing settings and alerts</span></span>

<span data-ttu-id="16233-222">Pokud není připravíte správně, přináší aplikace online po převzetí služeb při selhání nebo obnovení databáze bude vyžadovat čas navíc a pravděpodobně také vyžadují, řešení potíží s v době přízvuk - chybný kombinaci.</span><span class="sxs-lookup"><span data-stu-id="16233-222">If you do not prepare properly, bringing your applications online after a failover or a database recovery takes additional time and likely also require troubleshooting at a time of stress - a bad combination.</span></span>

### <a name="fail-over-tooa-geo-replicated-secondary-database"></a><span data-ttu-id="16233-223">Selhání tooa geograficky replikované sekundární databáze</span><span class="sxs-lookup"><span data-stu-id="16233-223">Fail over tooa geo-replicated secondary database</span></span>
<span data-ttu-id="16233-224">Pokud se používá aktivní geografickou replikaci a skupiny automatické převzetí služeb při selhání (v preview) jako váš mechanismus obnovení, můžete nakonfigurovat zásady pro automatické převzetí služeb při selhání nebo použít [ruční převzetí služeb při selhání](sql-database-disaster-recovery.md#fail-over-to-geo-replicated-secondary-database).</span><span class="sxs-lookup"><span data-stu-id="16233-224">If you are using active geo-replication and auto-failover groups (in-preview) as your recovery mechanism, you can configure an automatic failover policy or use [manual failover](sql-database-disaster-recovery.md#fail-over-to-geo-replicated-secondary-database).</span></span> <span data-ttu-id="16233-225">Po zahájení hello převzetí služeb při selhání příčiny hello sekundární toobecome hello nové primární a připravené toorecord nové transakce a reagovat tooqueries - s minimálními ztrátami dat hello dat, ještě nebyl replikován.</span><span class="sxs-lookup"><span data-stu-id="16233-225">Once initiated, hello failover causes hello secondary toobecome hello new primary and ready toorecord new transactions and respond tooqueries - with minimal data loss for hello data not yet replicated.</span></span> <span data-ttu-id="16233-226">Informace o navrhování hello proces převzetí služeb při selhání najdete v tématu [návrhu aplikace pro zotavení po havárii cloudu](sql-database-designing-cloud-solutions-for-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="16233-226">For information on designing hello failover process, see [Design an application for cloud disaster recovery](sql-database-designing-cloud-solutions-for-disaster-recovery.md).</span></span>

> [!NOTE]
> <span data-ttu-id="16233-227">Pokud hello datového centra přejde do režimu online původní základní barvy hello automaticky znovu připojit toohello nový primární a sekundární databáze je k.</span><span class="sxs-lookup"><span data-stu-id="16233-227">When hello data center comes back online hello old primaries automatically reconnect toohello new primary and become secondary databases.</span></span> <span data-ttu-id="16233-228">Pokud potřebujete toorelocate hello primární back toohello původní oblast, můžete spustit plánované převzetí služeb při selhání ručně (navrácení služeb po obnovení).</span><span class="sxs-lookup"><span data-stu-id="16233-228">If you need toorelocate hello primary back toohello original region, you can initiate a planned failover manually (failback).</span></span> 
> 

### <a name="perform-a-geo-restore"></a><span data-ttu-id="16233-229">Provedení geografické obnovení</span><span class="sxs-lookup"><span data-stu-id="16233-229">Perform a geo-restore</span></span>
<span data-ttu-id="16233-230">Pokud používáte automatizované zálohování s replikací geograficky redundantní úložiště jako váš mechanismus obnovení [zahájení obnovení databáze pomocí geografické obnovení](sql-database-disaster-recovery.md#recover-using-geo-restore).</span><span class="sxs-lookup"><span data-stu-id="16233-230">If you are using automated backups with geo-redundant storage replication as your recovery mechanism, [initiate a database recovery using geo-restore](sql-database-disaster-recovery.md#recover-using-geo-restore).</span></span> <span data-ttu-id="16233-231">Obnovení obvykle probíhá v rámci 12 hodin – ztráty dat až hodinu tooone určen při hello poslední hodinové rozdílové zálohy s přijatých a replikované.</span><span class="sxs-lookup"><span data-stu-id="16233-231">Recovery usually takes place within 12 hours - with data loss of up tooone hour determined by when hello last hourly differential backup with taken and replicated.</span></span> <span data-ttu-id="16233-232">Dokud se nedokončí obnovení hello, hello databáze je nelze toorecord jakékoli transakce nebo reagovat tooany dotazy.</span><span class="sxs-lookup"><span data-stu-id="16233-232">Until hello recovery completes, hello database is unable toorecord any transactions or respond tooany queries.</span></span> <span data-ttu-id="16233-233">Když to obnoví databázi toohello poslední dostupný bod v čase, obnovení hello geograficky sekundární tooany bodu v čase není aktuálně podporován.</span><span class="sxs-lookup"><span data-stu-id="16233-233">While this restores a database toohello last available point in time, restoring hello geo-secondary tooany point in time is not currently supported.</span></span>

> [!NOTE]
> <span data-ttu-id="16233-234">Pokud hello datového centra přejde do režimu online, před přepnutím aplikace přes toohello obnovené databáze, můžete zrušit hello obnovení.</span><span class="sxs-lookup"><span data-stu-id="16233-234">If hello data center comes back online before you switch your application over toohello recovered database, you can cancel hello recovery.</span></span>  
>
>

### <a name="perform-post-failover--recovery-tasks"></a><span data-ttu-id="16233-235">Provedení úloh po převzetí služeb při selhání nebo obnovení</span><span class="sxs-lookup"><span data-stu-id="16233-235">Perform post failover / recovery tasks</span></span>
<span data-ttu-id="16233-236">Po obnovení z buď mechanismus obnovení je třeba provést hello po další úkoly předtím, než uživatelé a aplikace jsou, zálohování a spuštění:</span><span class="sxs-lookup"><span data-stu-id="16233-236">After recovery from either recovery mechanism, you must perform hello following additional tasks before your users and applications are back up and running:</span></span>

* <span data-ttu-id="16233-237">Přesměrovat klienty a klienta aplikace toohello nový server a obnovené databáze</span><span class="sxs-lookup"><span data-stu-id="16233-237">Redirect clients and client applications toohello new server and restored database</span></span>
* <span data-ttu-id="16233-238">Ujistěte se, pravidla brány firewall na příslušné úrovni serveru jsou nastavené pro tooconnect uživatelé (nebo použijte [brány firewall úroveň databáze](sql-database-firewall-configure.md#creating-and-managing-firewall-rules))</span><span class="sxs-lookup"><span data-stu-id="16233-238">Ensure appropriate server-level firewall rules are in place for users tooconnect (or use [database-level firewalls](sql-database-firewall-configure.md#creating-and-managing-firewall-rules))</span></span>
* <span data-ttu-id="16233-239">Ujistěte se, že se používají odpovídající přihlášení a oprávnění na úrovni hlavní databáze (nebo použijte [obsažené uživatelé](https://msdn.microsoft.com/library/ff929188.aspx))</span><span class="sxs-lookup"><span data-stu-id="16233-239">Ensure appropriate logins and master database level permissions are in place (or use [contained users](https://msdn.microsoft.com/library/ff929188.aspx))</span></span>
* <span data-ttu-id="16233-240">Podle potřeby nakonfigurujte auditování.</span><span class="sxs-lookup"><span data-stu-id="16233-240">Configure auditing, as appropriate</span></span>
* <span data-ttu-id="16233-241">Podle potřeby nakonfigurujte výstrahy.</span><span class="sxs-lookup"><span data-stu-id="16233-241">Configure alerts, as appropriate</span></span>

## <a name="upgrade-an-application-with-minimal-downtime"></a><span data-ttu-id="16233-242">Upgrade aplikace s minimálními výpadky</span><span class="sxs-lookup"><span data-stu-id="16233-242">Upgrade an application with minimal downtime</span></span>
<span data-ttu-id="16233-243">Někdy aplikace musí být převedeno do režimu offline z důvodu plánované údržby, jako je například upgradu aplikace.</span><span class="sxs-lookup"><span data-stu-id="16233-243">Sometimes an application must be taken offline because of planned maintenance such as an application upgrade.</span></span> <span data-ttu-id="16233-244">[Spravovat aplikace upgrady](sql-database-manage-application-rolling-upgrade.md) popisuje, jak tooenable aktivní geografickou replikací toouse vrácení upgrady odstávka cloudové aplikace toominimize během upgradu a zadejte cestu obnovení, pokud dojde k chybě.</span><span class="sxs-lookup"><span data-stu-id="16233-244">[Manage application upgrades](sql-database-manage-application-rolling-upgrade.md) describes how toouse active geo-replication tooenable rolling upgrades of your cloud application toominimize downtime during upgrades and provide a recovery path if something goes wrong.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="16233-245">Další kroky</span><span class="sxs-lookup"><span data-stu-id="16233-245">Next steps</span></span>
<span data-ttu-id="16233-246">Diskuzi o aspektech návrhu aplikací pro samostatné databáze a pro elastické fondy najdete v tématech [Návrh aplikace pro zotavení po havárii cloudu](sql-database-designing-cloud-solutions-for-disaster-recovery.md) a [Strategie zotavení po havárii elastických fondů](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span><span class="sxs-lookup"><span data-stu-id="16233-246">For a discussion of application design considerations for stand-alone databases and for elastic pools, see [Design an application for cloud disaster recovery](sql-database-designing-cloud-solutions-for-disaster-recovery.md) and [Elastic Pool disaster recovery strategies](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span></span>
