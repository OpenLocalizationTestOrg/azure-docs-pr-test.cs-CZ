---
title: "Provozní kontinuita v cloudu – obnovení databází – SQL Database | Dokumentace Microsoftu"
description: "Zjistěte, jak Azure SQL Database podporuje provozní kontinuitu v cloudu a obnovení databází a jak pomáhá udržovat klíčové cloudové aplikace v chodu."
keywords: "provozní kontinuita, provozní kontinuita v cloudu, zotavení databáze po havárii, obnovení databáze"
services: sql-database
documentationcenter: 
author: anosov1960
manager: jhubbard
editor: 
ms.assetid: 18e5d3f1-bfe5-4089-b6fd-76988ab29822
ms.service: sql-database
ms.custom: business continuity
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 05/15/2017
ms.author: sashan
ms.openlocfilehash: cc93ee34a37a4a8688fa2eca338126c13b9940c0
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/29/2017
---
# <a name="overview-of-business-continuity-with-azure-sql-database"></a><span data-ttu-id="59097-104">Přehled provozní kontinuity se službou Azure SQL Database</span><span class="sxs-lookup"><span data-stu-id="59097-104">Overview of business continuity with Azure SQL Database</span></span>

<span data-ttu-id="59097-105">Tento přehled popisuje možnosti, které služba Azure SQL Database nabízí pro zajištění provozní kontinuity a zotavení po havárii.</span><span class="sxs-lookup"><span data-stu-id="59097-105">This overview describes the capabilities that Azure SQL Database provides for business continuity and disaster recovery.</span></span> <span data-ttu-id="59097-106">Další informace o možnostech, doporučení a kurzy pro obnovení z rušivý událostí, které může dojít ke ztrátě dat nebo způsobit, že databáze a aplikace k dispozici.</span><span class="sxs-lookup"><span data-stu-id="59097-106">Learn about options, recommendations, and tutorials for recovering from disruptive events that could cause data loss or cause your database and application to become unavailable.</span></span> <span data-ttu-id="59097-107">Zjistěte, co dělat, pokud uživatele nebo aplikace chyba ovlivňuje integritu dat, oblast Azure má výpadek nebo pokud vaše aplikace vyžaduje údržby.</span><span class="sxs-lookup"><span data-stu-id="59097-107">Learn what to do when a user or application error affects data integrity, an Azure region has an outage, or your application requires maintenance.</span></span>

## <a name="sql-database-features-that-you-can-use-to-provide-business-continuity"></a><span data-ttu-id="59097-108">Funkce služby SQL Database, pomocí kterých můžete zajistit provozní kontinuitu</span><span class="sxs-lookup"><span data-stu-id="59097-108">SQL Database features that you can use to provide business continuity</span></span>

<span data-ttu-id="59097-109">SQL Database poskytuje řadu funkcí provozní kontinuity, včetně automatizovaných záloh a volitelné replikace databáze.</span><span class="sxs-lookup"><span data-stu-id="59097-109">SQL Database provides several business continuity features, including automated backups and optional database replication.</span></span> <span data-ttu-id="59097-110">Každá má jiné vlastnosti ohledně odhadovaného času obnovení (ERT) a potenciální ztráty dat posledních transakcí.</span><span class="sxs-lookup"><span data-stu-id="59097-110">Each has different characteristics for estimated recovery time (ERT) and potential data loss for recent transactions.</span></span> <span data-ttu-id="59097-111">Jakmile tyto možnosti pochopíte, můžete si mezi nimi vybírat a ve většině scénářů je spolu kombinovat a používat pro různé scénáře.</span><span class="sxs-lookup"><span data-stu-id="59097-111">Once you understand these options, you can choose among them - and, in most scenarios, use them together for different scenarios.</span></span> <span data-ttu-id="59097-112">Při vývoji plánu provozní kontinuity musíte pochopit maximální přijatelnou dobu úplného obnovení aplikace po ničivé události – to je vaše plánovaná doba obnovení (RTO).</span><span class="sxs-lookup"><span data-stu-id="59097-112">As you develop your business continuity plan, you need to understand the maximum acceptable time before the application fully recovers after the disruptive event - this is your recovery time objective (RTO).</span></span> <span data-ttu-id="59097-113">Také musíte porozumět maximální objem dat poslední aktualizace (časový interval) aplikace může tolerovat ztráty při obnovování po nepříjemným událostem – to je cíl bodu obnovení (RPO).</span><span class="sxs-lookup"><span data-stu-id="59097-113">You also need to understand the maximum amount of recent data updates (time interval) the application can tolerate losing when recovering after the disruptive event - this is your recovery point objective (RPO).</span></span>

<span data-ttu-id="59097-114">Následující tabulka porovnává ERT a RPO pro tři nejběžnější scénáře.</span><span class="sxs-lookup"><span data-stu-id="59097-114">The following table compares the ERT and RPO for the three most common scenarios.</span></span>

| <span data-ttu-id="59097-115">Schopnost</span><span class="sxs-lookup"><span data-stu-id="59097-115">Capability</span></span> | <span data-ttu-id="59097-116">Úroveň Basic</span><span class="sxs-lookup"><span data-stu-id="59097-116">Basic tier</span></span> | <span data-ttu-id="59097-117">Úroveň Standard</span><span class="sxs-lookup"><span data-stu-id="59097-117">Standard tier</span></span> | <span data-ttu-id="59097-118">Úroveň Premium</span><span class="sxs-lookup"><span data-stu-id="59097-118">Premium tier</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="59097-119">Obnovení k určitému bodu v čase ze zálohy</span><span class="sxs-lookup"><span data-stu-id="59097-119">Point in Time Restore from backup</span></span> |<span data-ttu-id="59097-120">Libovolný bod obnovení do 7 dní</span><span class="sxs-lookup"><span data-stu-id="59097-120">Any restore point within 7 days</span></span> |<span data-ttu-id="59097-121">Libovolný bod obnovení do 35 dní</span><span class="sxs-lookup"><span data-stu-id="59097-121">Any restore point within 35 days</span></span> |<span data-ttu-id="59097-122">Libovolný bod obnovení do 35 dní</span><span class="sxs-lookup"><span data-stu-id="59097-122">Any restore point within 35 days</span></span> |
| <span data-ttu-id="59097-123">Geografické obnovení ze zálohy geograficky replikované</span><span class="sxs-lookup"><span data-stu-id="59097-123">Geo-restore from geo-replicated backups</span></span> |<span data-ttu-id="59097-124">ERT < 12 h, RPO < 1 h</span><span class="sxs-lookup"><span data-stu-id="59097-124">ERT < 12h, RPO < 1h</span></span> |<span data-ttu-id="59097-125">ERT < 12 h, RPO < 1 h</span><span class="sxs-lookup"><span data-stu-id="59097-125">ERT < 12h, RPO < 1h</span></span> |<span data-ttu-id="59097-126">ERT < 12 h, RPO < 1 h</span><span class="sxs-lookup"><span data-stu-id="59097-126">ERT < 12h, RPO < 1h</span></span> |
| <span data-ttu-id="59097-127">Obnovení z úložiště záloh Azure Backup Vault</span><span class="sxs-lookup"><span data-stu-id="59097-127">Restore from Azure Backup Vault</span></span> |<span data-ttu-id="59097-128">ERT < 12 h, RPO < 1 týden</span><span class="sxs-lookup"><span data-stu-id="59097-128">ERT < 12h, RPO < 1 wk</span></span> |<span data-ttu-id="59097-129">ERT < 12 h, RPO < 1 týden</span><span class="sxs-lookup"><span data-stu-id="59097-129">ERT < 12h, RPO < 1 wk</span></span> |<span data-ttu-id="59097-130">ERT < 12 h, RPO < 1 týden</span><span class="sxs-lookup"><span data-stu-id="59097-130">ERT < 12h, RPO < 1 wk</span></span> |
| <span data-ttu-id="59097-131">Aktivní geografickou replikaci</span><span class="sxs-lookup"><span data-stu-id="59097-131">Active geo-replication</span></span> |<span data-ttu-id="59097-132">ERT < 30 s, RPO < 5 s</span><span class="sxs-lookup"><span data-stu-id="59097-132">ERT < 30s, RPO < 5s</span></span> |<span data-ttu-id="59097-133">ERT < 30 s, RPO < 5 s</span><span class="sxs-lookup"><span data-stu-id="59097-133">ERT < 30s, RPO < 5s</span></span> |<span data-ttu-id="59097-134">ERT < 30 s, RPO < 5 s</span><span class="sxs-lookup"><span data-stu-id="59097-134">ERT < 30s, RPO < 5s</span></span> |

### <a name="use-database-backups-to-recover-a-database"></a><span data-ttu-id="59097-135">Obnovení databáze pomocí záloh databáze</span><span class="sxs-lookup"><span data-stu-id="59097-135">Use database backups to recover a database</span></span>

<span data-ttu-id="59097-136">SQL Database automaticky provede kombinaci databáze úplné zálohování každý týden, databáze rozdílové zálohy každou hodinu a transakce protokolu zálohování každých pět - deset minut chránit vaši firmu před ztrátou dat.</span><span class="sxs-lookup"><span data-stu-id="59097-136">SQL Database automatically performs a combination of full database backups weekly, differential database backups hourly, and transaction log backups every five - ten minutes to protect your business from data loss.</span></span> <span data-ttu-id="59097-137">Tyto zálohy se ukládají v geograficky redundantní úložiště 35 dní pro databáze v úrovně služeb Standard a Premium a pro databáze ve vrstvě služeb základní 7 dní.</span><span class="sxs-lookup"><span data-stu-id="59097-137">These backups are stored in geo-redundant storage for 35 days for databases in the Standard and Premium service tiers and 7 days for databases in the Basic service tier.</span></span> <span data-ttu-id="59097-138">Další informace najdete v tématu [úrovních služeb](sql-database-service-tiers.md).</span><span class="sxs-lookup"><span data-stu-id="59097-138">For more information, see [service tiers](sql-database-service-tiers.md).</span></span> <span data-ttu-id="59097-139">Pokud doba uchovávání vaší úrovně služby nevyhovuje požadavkům vaší organizace, můžete dobu uchovávání prodloužit [změnou úrovně služby](sql-database-service-tiers.md).</span><span class="sxs-lookup"><span data-stu-id="59097-139">If the retention period for your service tier does not meet your business requirements, you can increase the retention period by [changing the service tier](sql-database-service-tiers.md).</span></span> <span data-ttu-id="59097-140">Pro zajištění ochrany před výpadkem datového centra se úplné a rozdílové zálohy databáze také replikují do [spárovaného datového centra](../best-practices-availability-paired-regions.md).</span><span class="sxs-lookup"><span data-stu-id="59097-140">The full and differential database backups are also replicated to a [paired data center](../best-practices-availability-paired-regions.md) for protection against a data center outage.</span></span> <span data-ttu-id="59097-141">Další informace najdete v tématu [automatické zálohování databází](sql-database-automated-backups.md).</span><span class="sxs-lookup"><span data-stu-id="59097-141">For more information, see [automatic database backups](sql-database-automated-backups.md).</span></span>

<span data-ttu-id="59097-142">Pokud doba uchování předdefinované není dostatečná pro aplikaci, můžete ji rozšířit tak, že nakonfigurujete zásady dlouhodobé uchovávání informací databáze.</span><span class="sxs-lookup"><span data-stu-id="59097-142">If the built-in retention period is not sufficient for your application, you can extend it by configuring a database long-term retention policy.</span></span> <span data-ttu-id="59097-143">Další informace najdete v tématu [dlouhodobé uchovávání](sql-database-long-term-retention.md).</span><span class="sxs-lookup"><span data-stu-id="59097-143">For more information, see [long-term retention](sql-database-long-term-retention.md).</span></span>

<span data-ttu-id="59097-144">Tyto automatické zálohy databáze můžete použít k obnovení databáze po různých ničivých událostech, a to jak v rámci vašeho datového centra, tak do jiného datového centra.</span><span class="sxs-lookup"><span data-stu-id="59097-144">You can use these automatic database backups to recover a database from various disruptive events, both within your data center and to another data center.</span></span> <span data-ttu-id="59097-145">Při použití automatických záloh databáze závisí odhadovaný čas obnovení na několika faktorech. Patří mezi ně celkový počet obnovovaných databází ve stejném regionu a ve stejnou dobu, velikost databáze, velikost protokolu transakcí a šířka pásma sítě.</span><span class="sxs-lookup"><span data-stu-id="59097-145">Using automatic database backups, the estimated time of recovery depends on several factors including the total number of databases recovering in the same region at the same time, the database size, the transaction log size, and network bandwidth.</span></span> <span data-ttu-id="59097-146">Doba obnovení je obvykle menší než 12 hodin.</span><span class="sxs-lookup"><span data-stu-id="59097-146">The recovery time is usually less than 12 hours.</span></span> <span data-ttu-id="59097-147">Při obnovování do jiné oblasti dat je potenciální ztráta dat omezena na 1 hodinu díky geograficky redundantnímu úložišti s rozdílovými zálohami prováděnými každou hodinu.</span><span class="sxs-lookup"><span data-stu-id="59097-147">When recovering to another data region, the potential data loss is limited to 1 hour by the geo-redundant storage of hourly differential database backups.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="59097-148">Pokud chcete provést obnovení pomocí automatizovaného zálohování, musíte být členem role Přispěvatel SQL Serveru nebo vlastník předplatného – viz [RBAC: Předdefinované role](../active-directory/role-based-access-built-in-roles.md).</span><span class="sxs-lookup"><span data-stu-id="59097-148">To recover using automated backups, you must be a member of the SQL Server Contributor role or the subscription owner - see [RBAC: Built-in roles](../active-directory/role-based-access-built-in-roles.md).</span></span> <span data-ttu-id="59097-149">Obnovení můžete provést pomocí webu Azure Portal, prostředí PowerShell nebo rozhraní REST API.</span><span class="sxs-lookup"><span data-stu-id="59097-149">You can recover using the Azure portal, PowerShell, or the REST API.</span></span> <span data-ttu-id="59097-150">Nelze použít jazyk Transact-SQL.</span><span class="sxs-lookup"><span data-stu-id="59097-150">You cannot use Transact-SQL.</span></span>
>

<span data-ttu-id="59097-151">Automatizované zálohování použijte pro zajištění provozní kontinuity a jako mechanismus obnovení, pokud vaše aplikace:</span><span class="sxs-lookup"><span data-stu-id="59097-151">Use automated backups as your business continuity and recovery mechanism if your application:</span></span>

* <span data-ttu-id="59097-152">Není považována za klíčovou.</span><span class="sxs-lookup"><span data-stu-id="59097-152">Is not considered mission critical.</span></span>
* <span data-ttu-id="59097-153">Nemá vazbu SLA - výpadek 24 hodin nebo již nemá za následek finanční odpovědnosti.</span><span class="sxs-lookup"><span data-stu-id="59097-153">Doesn't have a binding SLA - a downtime of 24 hours or longer does not result in financial liability.</span></span>
* <span data-ttu-id="59097-154">Pracuje s nízkou mírou změn dat (málo transakcí za hodinu) a ztráta změn provedených během až jedné hodiny je přijatelnou ztrátou dat.</span><span class="sxs-lookup"><span data-stu-id="59097-154">Has a low rate of data change (low transactions per hour) and losing up to an hour of change is an acceptable data loss.</span></span>
* <span data-ttu-id="59097-155">Je citlivá na změny nákladů.</span><span class="sxs-lookup"><span data-stu-id="59097-155">Is cost sensitive.</span></span>

<span data-ttu-id="59097-156">Pokud potřebujete rychlejší obnovení, použijte [aktivní geografickou replikací](sql-database-geo-replication-overview.md) (popsané dále).</span><span class="sxs-lookup"><span data-stu-id="59097-156">If you need faster recovery, use [active geo-replication](sql-database-geo-replication-overview.md) (discussed next).</span></span> <span data-ttu-id="59097-157">Pokud potřebujete mít možnost obnovit data z období starší než 35 dní, použijte [dlouhodobé uchovávání záloh](sql-database-long-term-retention.md).</span><span class="sxs-lookup"><span data-stu-id="59097-157">If you need to be able to recover data from a period older than 35 days, use [long-term backup retention](sql-database-long-term-retention.md).</span></span> 

### <a name="use-active-geo-replication-and-auto-failover-groups-in-preview-to-reduce-recovery-time-and-limit-data-loss-associated-with-a-recovery"></a><span data-ttu-id="59097-158">Pomocí aktivní geografickou replikaci a automatické převzetí služeb při selhání skupiny (v preview) můžete zkrátit čas obnovení a omezit ztrátě dat, které jsou přidružené k obnovení</span><span class="sxs-lookup"><span data-stu-id="59097-158">Use active geo-replication and auto-failover groups (in-preview) to reduce recovery time and limit data loss associated with a recovery</span></span>

<span data-ttu-id="59097-159">Kromě použití zálohy databáze pro obnovení databáze, pokud dojde k přerušení obchodní, můžete použít [aktivní geografickou replikací](sql-database-geo-replication-overview.md) nakonfigurovat databázi mít až čtyři čitelný sekundární databáze v oblastech podle svého výběru.</span><span class="sxs-lookup"><span data-stu-id="59097-159">In addition to using database backups for database recovery if a business disruption occurs, you can use [active geo-replication](sql-database-geo-replication-overview.md) to configure a database to have up to four readable secondary databases in the regions of your choice.</span></span> <span data-ttu-id="59097-160">Tyto sekundární databáze jsou synchronizovány s primární databází pomocí mechanismu asynchronní replikace.</span><span class="sxs-lookup"><span data-stu-id="59097-160">These secondary databases are kept synchronized with the primary database using an asynchronous replication mechanism.</span></span> <span data-ttu-id="59097-161">Tato funkce slouží k ochraně proti přerušení obchodní, pokud dojde k výpadku datacentra nebo během upgradu aplikace.</span><span class="sxs-lookup"><span data-stu-id="59097-161">This feature is used to protect against business disruption if a data center outage occurs or during an application upgrade.</span></span> <span data-ttu-id="59097-162">Aktivní geografickou replikaci lze také geograficky rozmístěné uživatelům poskytovat lepší výkon dotazů pro dotazy jen pro čtení.</span><span class="sxs-lookup"><span data-stu-id="59097-162">Active geo-replication can also be used to provide better query performance for read-only queries to geographically dispersed users.</span></span>

<span data-ttu-id="59097-163">Pokud chcete povolit automatické a transparentní převzetí služeb při selhání by měl uspořádání geograficky replikované databáze do skupiny pomocí [-automatické převzetí služeb při selhání skupiny](sql-database-geo-replication-overview.md) funkce SQL Database (-preview).</span><span class="sxs-lookup"><span data-stu-id="59097-163">To enable automated and transparent failover you should organize your geo-replicated databases into groups using the [auto-failover group](sql-database-geo-replication-overview.md) feature of SQL Database (in-preview).</span></span>

<span data-ttu-id="59097-164">Pokud primární databáze neočekávaně přejde do režimu offline nebo je potřeba vzít do offline režimu pro údržbu aktivity, můžete rychle zvýšit úroveň sekundárního stane primárním serverem (také nazývané převzetí služeb při selhání) a konfigurace aplikací pro připojení k propagovaných primární.</span><span class="sxs-lookup"><span data-stu-id="59097-164">If the primary database goes offline unexpectedly or you need to take it offline for maintenance activities, you can quickly promote a secondary to become the primary (also called a failover) and configure applications to connect to the promoted primary.</span></span> <span data-ttu-id="59097-165">Pokud vaše aplikace se připojuje k databázím pomocí naslouchacího procesu skupiny převzetí služeb při selhání, nemusíte měnit konfiguraci řetězce připojení SQL po převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="59097-165">If your application is connecting to the databases using the failover group listener, you don’t need to change the SQL connection string configuration after failover.</span></span> <span data-ttu-id="59097-166">U plánovaného převzetí služeb při selhání nedojde ke ztrátě dat.</span><span class="sxs-lookup"><span data-stu-id="59097-166">With a planned failover, there is no data loss.</span></span> <span data-ttu-id="59097-167">V případě neplánovaného převzetí služeb při selhání může kvůli povaze asynchronní replikace dojít ke ztrátě menšího množství dat u posledních transakcí.</span><span class="sxs-lookup"><span data-stu-id="59097-167">With an unplanned failover, there may be some small amount of data loss for very recent transactions due to the nature of asynchronous replication.</span></span> <span data-ttu-id="59097-168">Použití skupin automatické převzetí služeb při selhání (v preview), můžete upravit zásady převzetí služeb při selhání tak, aby potenciální ztráty dat co nejmenší.</span><span class="sxs-lookup"><span data-stu-id="59097-168">Using auto-failover groups (in-preview), you can customize the failover policy to minimize the potential data loss.</span></span> <span data-ttu-id="59097-169">Po převzetí služeb při selhání můžete později provést navrácení služeb po obnovení – buď podle plánu, nebo když se datové centrum vrátí do režimu online.</span><span class="sxs-lookup"><span data-stu-id="59097-169">After a failover, you can later failback - either according to a plan or when the data center comes back online.</span></span> <span data-ttu-id="59097-170">Ve všech případech se uživatelé setkají s krátkým výpadkem a budou se muset znovu připojit.</span><span class="sxs-lookup"><span data-stu-id="59097-170">In all cases, users experience a small amount of downtime and need to reconnect.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="59097-171">Používání aktivní geografické replikace a skupiny automatické převzetí služeb při selhání (v preview), musíte být vlastníkem předplatného nebo mít oprávnění správce v systému SQL Server.</span><span class="sxs-lookup"><span data-stu-id="59097-171">To use active geo-replication and auto-failover groups (in-preview), you must either be the subscription owner or have administrative permissions in SQL Server.</span></span> <span data-ttu-id="59097-172">Můžete nakonfigurovat a převzít služby Azure pomocí portálu, prostředí PowerShell nebo rozhraní REST API pomocí oprávnění předplatného Azure nebo pomocí jazyka Transact-SQL s oprávněními systému SQL Server.</span><span class="sxs-lookup"><span data-stu-id="59097-172">You can configure and fail over using the Azure portal, PowerShell, or the REST API using Azure subscription permissions or using Transact-SQL with SQL Server permissions.</span></span>
> 

<span data-ttu-id="59097-173">Použijte active geografická replikace a automatické převzetí služeb při selhání skupiny (ve verzi preview), pokud vaše aplikace splňuje některé z těchto kritérií:</span><span class="sxs-lookup"><span data-stu-id="59097-173">Use active geo-replication and auto-failover groups (in preview) if your application meets any of these criteria:</span></span>

* <span data-ttu-id="59097-174">Je zvlášť důležitá.</span><span class="sxs-lookup"><span data-stu-id="59097-174">Is mission critical.</span></span>
* <span data-ttu-id="59097-175">Má smlouvu SLA, která nepovoluje výpadek delší než 24 hodin.</span><span class="sxs-lookup"><span data-stu-id="59097-175">Has a service level agreement (SLA) that does not allow for 24 hours or more of downtime.</span></span>
* <span data-ttu-id="59097-176">Výpadek může mít za následek finanční odpovědnosti.</span><span class="sxs-lookup"><span data-stu-id="59097-176">Downtime may result in financial liability.</span></span>
* <span data-ttu-id="59097-177">Pracuje s vysokou mírou změn dat a ztráta dat za jednu hodinu je nepřijatelná.</span><span class="sxs-lookup"><span data-stu-id="59097-177">Has a high rate of data change is high and losing an hour of data is not acceptable.</span></span>
* <span data-ttu-id="59097-178">Další náklady na aktivní geografickou replikaci jsou nižší než potenciální finanční závazky a související ztráta podnikání.</span><span class="sxs-lookup"><span data-stu-id="59097-178">The additional cost of active geo-replication is lower than the potential financial liability and associated loss of business.</span></span>

>
> [!VIDEO https://channel9.msdn.com/Blogs/Azure/Azure-SQL-Database-protecting-important-DBs-from-regional-disasters-is-easy/player]
>

## <a name="recover-a-database-after-a-user-or-application-error"></a><span data-ttu-id="59097-179">Obnovení databáze po chybě uživatele nebo aplikace</span><span class="sxs-lookup"><span data-stu-id="59097-179">Recover a database after a user or application error</span></span>
<span data-ttu-id="59097-180">* Nikdo není dokonalý!</span><span class="sxs-lookup"><span data-stu-id="59097-180">*No one is perfect!</span></span> <span data-ttu-id="59097-181">Uživatel může omylem odstranit některá data, nedopatřením smazat důležitou tabulku nebo dokonce smazat celou databázi.</span><span class="sxs-lookup"><span data-stu-id="59097-181">A user might accidentally delete some data, inadvertently drop an important table, or even drop an entire database.</span></span> <span data-ttu-id="59097-182">Nebo může aplikace kvůli vadě náhodou přepsat dobrá data chybnými daty.</span><span class="sxs-lookup"><span data-stu-id="59097-182">Or, an application might accidentally overwrite good data with bad data due to an application defect.</span></span>

<span data-ttu-id="59097-183">V takovém scénáři máte následující možnosti obnovení.</span><span class="sxs-lookup"><span data-stu-id="59097-183">In this scenario, these are your recovery options.</span></span>

### <a name="perform-a-point-in-time-restore"></a><span data-ttu-id="59097-184">Obnovení k určitému bodu v čase</span><span class="sxs-lookup"><span data-stu-id="59097-184">Perform a point-in-time restore</span></span>
<span data-ttu-id="59097-185">Pomocí automatizovaného zálohování můžete obnovit kopii databáze do známého bodu v čase, kdy byla v pořádku, za předpokladu, že čas spadá do doby uchovávání databáze.</span><span class="sxs-lookup"><span data-stu-id="59097-185">You can use the automated backups to recover a copy of your database to a known good point in time, provided that time is within the database retention period.</span></span> <span data-ttu-id="59097-186">Po obnovení databáze můžete původní databázi nahradit obnovenou databází nebo zkopírovat potřebná data z obnovené databáze do původní databáze.</span><span class="sxs-lookup"><span data-stu-id="59097-186">After the database is restored, you can either replace the original database with the restored database or copy the needed data from the restored data into the original database.</span></span> <span data-ttu-id="59097-187">Pokud se databáze používá aktivní geografickou replikaci, doporučujeme kopírování požadovaná data z obnovené kopie do původní databáze.</span><span class="sxs-lookup"><span data-stu-id="59097-187">If the database uses active geo-replication, we recommend copying the required data from the restored copy into the original database.</span></span> <span data-ttu-id="59097-188">Pokud je původní databáze nahradit obnovenou databázi, budete muset překonfigurovat a poté opakujte synchronizaci aktivní geografickou replikaci (který může trvat poměrně nějakou dobu pro velké databáze).</span><span class="sxs-lookup"><span data-stu-id="59097-188">If you replace the original database with the restored database, you need to reconfigure and resynchronize active geo-replication (which can take quite some time for a large database).</span></span>

<span data-ttu-id="59097-189">Další informace a podrobné pokyny k obnovení databáze do určitého bodu v čase pomocí webu Azure Portal nebo prostředí PowerShell najdete v části [Obnovení k určitému bodu v čase](sql-database-recovery-using-backups.md#point-in-time-restore).</span><span class="sxs-lookup"><span data-stu-id="59097-189">For more information and for detailed steps for restoring a database to a point in time using the Azure portal or using PowerShell, see [point-in-time restore](sql-database-recovery-using-backups.md#point-in-time-restore).</span></span> <span data-ttu-id="59097-190">Obnovení nelze provést pomocí jazyka Transact-SQL.</span><span class="sxs-lookup"><span data-stu-id="59097-190">You cannot recover using Transact-SQL.</span></span>

### <a name="restore-a-deleted-database"></a><span data-ttu-id="59097-191">Obnovení odstraněné databáze</span><span class="sxs-lookup"><span data-stu-id="59097-191">Restore a deleted database</span></span>
<span data-ttu-id="59097-192">Pokud se odstraní databáze, ale neodstraní se logický server, můžete odstraněnou databázi obnovit do bodu, kdy byla odstraněna.</span><span class="sxs-lookup"><span data-stu-id="59097-192">If the database is deleted but the logical server has not been deleted, you can restore the deleted database to the point at which it was deleted.</span></span> <span data-ttu-id="59097-193">Tak se záloha databáze obnoví do stejného logického serveru SQL, ze kterého byla odstraněna.</span><span class="sxs-lookup"><span data-stu-id="59097-193">This restores a database backup to the same logical SQL server from which it was deleted.</span></span> <span data-ttu-id="59097-194">Můžete ji obnovit s použitím původního názvu nebo pro obnovenou databázi zadat nový název.</span><span class="sxs-lookup"><span data-stu-id="59097-194">You can restore it using the original name or provide a new name or the restored database.</span></span>

<span data-ttu-id="59097-195">Další informace a podrobné pokyny k obnovení odstraněné databáze pomocí webu Azure Portal nebo prostředí PowerShell najdete v části [Obnovení odstraněné databáze](sql-database-recovery-using-backups.md#deleted-database-restore).</span><span class="sxs-lookup"><span data-stu-id="59097-195">For more information and for detailed steps for restoring a deleted database using the Azure portal or using PowerShell, see [restore a deleted database](sql-database-recovery-using-backups.md#deleted-database-restore).</span></span> <span data-ttu-id="59097-196">Obnovení nelze provést pomocí jazyka Transact-SQL.</span><span class="sxs-lookup"><span data-stu-id="59097-196">You cannot restore using Transact-SQL.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="59097-197">Pokud byl odstraněn logický server, není možné obnovit odstraněnou databázi.</span><span class="sxs-lookup"><span data-stu-id="59097-197">If the logical server is deleted, you cannot recover a deleted database.</span></span>
>
>

### <a name="restore-from-azure-backup-vault"></a><span data-ttu-id="59097-198">Obnovení z úložiště záloh Azure Backup Vault</span><span class="sxs-lookup"><span data-stu-id="59097-198">Restore from Azure Backup Vault</span></span>
<span data-ttu-id="59097-199">Pokud došlo k chybě ztrátou dat mimo aktuální dobu uchování pro automatizované zálohování a je databáze nakonfigurovaná pro dlouhodobé uchovávání, můžete obnovit ze zálohy týdně v trezoru zálohování Azure pro novou databázi.</span><span class="sxs-lookup"><span data-stu-id="59097-199">If the data loss occurred outside the current retention period for automated backups and your database is configured for long-term retention, you can restore from a weekly backup in Azure Backup Vault to a new database.</span></span> <span data-ttu-id="59097-200">V tuto chvíli můžete původní databázi nahradit obnovenou databází nebo zkopírovat potřebná data z obnovené databáze do původní databáze.</span><span class="sxs-lookup"><span data-stu-id="59097-200">At this point, you can either replace the original database with the restored database or copy the needed data from the restored database into the original database.</span></span> <span data-ttu-id="59097-201">Pokud budete potřebovat načíst starší verzi databáze před upgradem hlavní aplikace, splnit žádost od auditory nebo právní pořadí, že můžete vytvořit databázi pomocí úplné zálohy uložené v trezoru zálohování Azure.</span><span class="sxs-lookup"><span data-stu-id="59097-201">If you need to retrieve an old version of your database prior to a major application upgrade, satisfy a request from auditors or a legal order, you can create a database using a full backup saved in the Azure Backup Vault.</span></span>  <span data-ttu-id="59097-202">Další informace najdete v tématu [Dlouhodobé uchovávání](sql-database-long-term-retention.md).</span><span class="sxs-lookup"><span data-stu-id="59097-202">For more information, see [Long-term retention](sql-database-long-term-retention.md).</span></span>

## <a name="recover-a-database-to-another-region-from-an-azure-regional-data-center-outage"></a><span data-ttu-id="59097-203">Obnovení databáze do jiné oblasti po výpadku regionálního datového centra Azure</span><span class="sxs-lookup"><span data-stu-id="59097-203">Recover a database to another region from an Azure regional data center outage</span></span>
<!-- Explain this scenario -->

<span data-ttu-id="59097-204">Přestože je taková situace výjimečná, i u datového centra Azure může dojít k výpadku.</span><span class="sxs-lookup"><span data-stu-id="59097-204">Although rare, an Azure data center can have an outage.</span></span> <span data-ttu-id="59097-205">Při výpadku dojde k narušení provozu, které může trvat jen několik minut nebo až několik hodin.</span><span class="sxs-lookup"><span data-stu-id="59097-205">When an outage occurs, it causes a business disruption that might only last a few minutes or might last for hours.</span></span>

* <span data-ttu-id="59097-206">Jednou z možností je počkat, až výpadek skončí a databáze se vrátí do režimu online.</span><span class="sxs-lookup"><span data-stu-id="59097-206">One option is to wait for your database to come back online when the data center outage is over.</span></span> <span data-ttu-id="59097-207">Tento postup funguje pro aplikace, které si mohou dovolit mít databázi v režimu offline.</span><span class="sxs-lookup"><span data-stu-id="59097-207">This works for applications that can afford to have the database offline.</span></span> <span data-ttu-id="59097-208">Například vývojový projekt nebo bezplatná zkušební verze, na které nemusíte neustále pracovat.</span><span class="sxs-lookup"><span data-stu-id="59097-208">For example, a development project or free trial you don't need to work on constantly.</span></span> <span data-ttu-id="59097-209">Je-li v datovém centru k výpadku, si nejste jisti, jak dlouho může poslední se výpadek, tak tato možnost funguje jenom v případě nepotřebujete databáze nějakou dobu.</span><span class="sxs-lookup"><span data-stu-id="59097-209">When a data center has an outage, you do not know how long the outage might last, so this option only works if you don't need your database for a while.</span></span>
* <span data-ttu-id="59097-210">Další možností je buď selhání přes na jiné datové oblasti používáte-li aktivní geografickou replikaci nebo obnovit databázi pomocí zálohy geograficky redundantní databáze (geografické obnovení).</span><span class="sxs-lookup"><span data-stu-id="59097-210">Another option is to either fail over to another data region if you are using active geo-replication or the recover a database using geo-redundant database backups (geo-restore).</span></span> <span data-ttu-id="59097-211">Převzetí služeb při selhání trvá jenom pár sekund, při obnovení databáze ze zálohy trvá hodin.</span><span class="sxs-lookup"><span data-stu-id="59097-211">Failover takes only a few seconds while database recovery from backups takes hours.</span></span>

<span data-ttu-id="59097-212">Po provedení akce, jak dlouho trvalo obnovit a kolik ztráty dat platit závisí na tom, jak se rozhodnete použít tyto funkce kontinuity obchodních v aplikaci.</span><span class="sxs-lookup"><span data-stu-id="59097-212">When you take action, how long it takes you to recover, and how much data loss you incur depends upon how you decide to use these business continuity features in your application.</span></span> <span data-ttu-id="59097-213">Ve skutečnosti můžete použít kombinaci zálohy databáze a aktivní geografickou replikací v závislosti na požadavcích vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="59097-213">Indeed, you may choose to use a combination of database backups and active geo-replication depending upon your application requirements.</span></span> <span data-ttu-id="59097-214">Diskuzi o aspektech návrhu aplikací pro samostatné databáze a pro elastické fondy pomocí těchto funkcí provozní kontinuity najdete v tématech [Návrh aplikace pro zotavení po havárii cloudu](sql-database-designing-cloud-solutions-for-disaster-recovery.md) a [Strategie zotavení po havárii elastických fondů](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span><span class="sxs-lookup"><span data-stu-id="59097-214">For a discussion of application design considerations for stand-alone databases and for elastic pools using these business continuity features, see [Design an application for cloud disaster recovery](sql-database-designing-cloud-solutions-for-disaster-recovery.md) and [Elastic Pool disaster recovery strategies](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span></span>

<span data-ttu-id="59097-215">Následující části obsahují základní informace o postup obnovit pomocí zálohy databáze nebo aktivní geografickou replikací.</span><span class="sxs-lookup"><span data-stu-id="59097-215">The following sections provide an overview of the steps to recover using either database backups or active geo-replication.</span></span> <span data-ttu-id="59097-216">Podrobné pokyny, včetně plánování požadavky, postup obnovení post a informace o tom, jak simulovat výpadku provádět postupu zotavení po havárii, najdete v části [obnovení databáze serveru SQL výpadku](sql-database-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="59097-216">For detailed steps including planning requirements, post recovery steps, and information about how to simulate an outage to perform a disaster recovery drill, see [Recover a SQL Database from an outage](sql-database-disaster-recovery.md).</span></span>

### <a name="prepare-for-an-outage"></a><span data-ttu-id="59097-217">Příprava na výpadek</span><span class="sxs-lookup"><span data-stu-id="59097-217">Prepare for an outage</span></span>
<span data-ttu-id="59097-218">Bez ohledu na funkce provozní kontinuity, které používáte, musíte:</span><span class="sxs-lookup"><span data-stu-id="59097-218">Regardless of the business continuity feature you use, you must:</span></span>

* <span data-ttu-id="59097-219">Určit a připravit cílový server, včetně pravidel brány firewall na úrovni serveru, přihlášení a oprávnění na úrovni hlavní databáze</span><span class="sxs-lookup"><span data-stu-id="59097-219">Identify and prepare the target server, including server-level firewall rules, logins, and master database level permissions.</span></span>
* <span data-ttu-id="59097-220">Určit, jak přesměrovat klienty a klientské aplikace na nový server</span><span class="sxs-lookup"><span data-stu-id="59097-220">Determine how to redirect clients and client applications to the new server</span></span>
* <span data-ttu-id="59097-221">Zdokumentovat další závislosti, například nastavení auditování a výstrahy</span><span class="sxs-lookup"><span data-stu-id="59097-221">Document other dependencies, such as auditing settings and alerts</span></span>

<span data-ttu-id="59097-222">Pokud není připravíte správně, přináší aplikace online po převzetí služeb při selhání nebo obnovení databáze bude vyžadovat čas navíc a pravděpodobně také vyžadují, řešení potíží s v době přízvuk - chybný kombinaci.</span><span class="sxs-lookup"><span data-stu-id="59097-222">If you do not prepare properly, bringing your applications online after a failover or a database recovery takes additional time and likely also require troubleshooting at a time of stress - a bad combination.</span></span>

### <a name="fail-over-to-a-geo-replicated-secondary-database"></a><span data-ttu-id="59097-223">Převzetí služeb při selhání do geograficky replikované sekundární databáze</span><span class="sxs-lookup"><span data-stu-id="59097-223">Fail over to a geo-replicated secondary database</span></span>
<span data-ttu-id="59097-224">Pokud se používá aktivní geografickou replikaci a skupiny automatické převzetí služeb při selhání (v preview) jako váš mechanismus obnovení, můžete nakonfigurovat zásady pro automatické převzetí služeb při selhání nebo použít [ruční převzetí služeb při selhání](sql-database-disaster-recovery.md#fail-over-to-geo-replicated-secondary-database).</span><span class="sxs-lookup"><span data-stu-id="59097-224">If you are using active geo-replication and auto-failover groups (in-preview) as your recovery mechanism, you can configure an automatic failover policy or use [manual failover](sql-database-disaster-recovery.md#fail-over-to-geo-replicated-secondary-database).</span></span> <span data-ttu-id="59097-225">Po zahájení převzetí způsobí, že sekundární stane nový primární a připravené k záznamu nové transakce a reagovat na dotazy – s minimálními ztrátami dat dat, ještě nebyl replikován.</span><span class="sxs-lookup"><span data-stu-id="59097-225">Once initiated, the failover causes the secondary to become the new primary and ready to record new transactions and respond to queries - with minimal data loss for the data not yet replicated.</span></span> <span data-ttu-id="59097-226">Informace o navrhování proces převzetí služeb při selhání najdete v tématu [návrhu aplikace pro zotavení po havárii cloudu](sql-database-designing-cloud-solutions-for-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="59097-226">For information on designing the failover process, see [Design an application for cloud disaster recovery](sql-database-designing-cloud-solutions-for-disaster-recovery.md).</span></span>

> [!NOTE]
> <span data-ttu-id="59097-227">Pokud datové centrum přejde do režimu online původní základní barvy automaticky znovu připojit k nové primární a sekundární databáze je k.</span><span class="sxs-lookup"><span data-stu-id="59097-227">When the data center comes back online the old primaries automatically reconnect to the new primary and become secondary databases.</span></span> <span data-ttu-id="59097-228">Pokud potřebujete přemístit primární zpět na původní oblast, můžete spustit plánované převzetí služeb při selhání ručně (navrácení služeb po obnovení).</span><span class="sxs-lookup"><span data-stu-id="59097-228">If you need to relocate the primary back to the original region, you can initiate a planned failover manually (failback).</span></span> 
> 

### <a name="perform-a-geo-restore"></a><span data-ttu-id="59097-229">Provedení geografické obnovení</span><span class="sxs-lookup"><span data-stu-id="59097-229">Perform a geo-restore</span></span>
<span data-ttu-id="59097-230">Pokud používáte automatizované zálohování s replikací geograficky redundantní úložiště jako váš mechanismus obnovení [zahájení obnovení databáze pomocí geografické obnovení](sql-database-disaster-recovery.md#recover-using-geo-restore).</span><span class="sxs-lookup"><span data-stu-id="59097-230">If you are using automated backups with geo-redundant storage replication as your recovery mechanism, [initiate a database recovery using geo-restore](sql-database-disaster-recovery.md#recover-using-geo-restore).</span></span> <span data-ttu-id="59097-231">K obnovení obvykle dojde během 12 hodin – se ztrátou dat až za jednu hodinu v závislosti na času pořízení a replikace poslední hodinové rozdílové zálohy.</span><span class="sxs-lookup"><span data-stu-id="59097-231">Recovery usually takes place within 12 hours - with data loss of up to one hour determined by when the last hourly differential backup with taken and replicated.</span></span> <span data-ttu-id="59097-232">Dokud se obnovení nedokončí, databáze není schopná zaznamenávat žádné transakce ani reagovat na dotazy.</span><span class="sxs-lookup"><span data-stu-id="59097-232">Until the recovery completes, the database is unable to record any transactions or respond to any queries.</span></span> <span data-ttu-id="59097-233">Při tím se obnoví databázi na poslední dostupný bod v čase, obnovení sekundární geograficky do libovolného bodu v čase není aktuálně podporován.</span><span class="sxs-lookup"><span data-stu-id="59097-233">While this restores a database to the last available point in time, restoring the geo-secondary to any point in time is not currently supported.</span></span>

> [!NOTE]
> <span data-ttu-id="59097-234">Pokud datové centrum přejde do režimu online, před přepnutím aplikace do obnovené databáze, můžete zrušit obnovení.</span><span class="sxs-lookup"><span data-stu-id="59097-234">If the data center comes back online before you switch your application over to the recovered database, you can cancel the recovery.</span></span>  
>
>

### <a name="perform-post-failover--recovery-tasks"></a><span data-ttu-id="59097-235">Provedení úloh po převzetí služeb při selhání nebo obnovení</span><span class="sxs-lookup"><span data-stu-id="59097-235">Perform post failover / recovery tasks</span></span>
<span data-ttu-id="59097-236">Po obnovení s použitím libovolného mechanismu musíte provést následující dodatečné úlohy, abyste pro uživatele zprovoznili své aplikace:</span><span class="sxs-lookup"><span data-stu-id="59097-236">After recovery from either recovery mechanism, you must perform the following additional tasks before your users and applications are back up and running:</span></span>

* <span data-ttu-id="59097-237">Přesměrujte klienty a klientské aplikace na nový server a obnovenou databázi.</span><span class="sxs-lookup"><span data-stu-id="59097-237">Redirect clients and client applications to the new server and restored database</span></span>
* <span data-ttu-id="59097-238">Ujistěte se, že platí odpovídající pravidla brány firewall na úrovni serveru, aby se uživatelé mohli připojit (nebo použijte [brány firewall na úrovni databáze](sql-database-firewall-configure.md#creating-and-managing-firewall-rules)).</span><span class="sxs-lookup"><span data-stu-id="59097-238">Ensure appropriate server-level firewall rules are in place for users to connect (or use [database-level firewalls](sql-database-firewall-configure.md#creating-and-managing-firewall-rules))</span></span>
* <span data-ttu-id="59097-239">Ujistěte se, že se používají odpovídající přihlášení a oprávnění na úrovni hlavní databáze (nebo použijte [obsažené uživatelé](https://msdn.microsoft.com/library/ff929188.aspx))</span><span class="sxs-lookup"><span data-stu-id="59097-239">Ensure appropriate logins and master database level permissions are in place (or use [contained users](https://msdn.microsoft.com/library/ff929188.aspx))</span></span>
* <span data-ttu-id="59097-240">Podle potřeby nakonfigurujte auditování.</span><span class="sxs-lookup"><span data-stu-id="59097-240">Configure auditing, as appropriate</span></span>
* <span data-ttu-id="59097-241">Podle potřeby nakonfigurujte výstrahy.</span><span class="sxs-lookup"><span data-stu-id="59097-241">Configure alerts, as appropriate</span></span>

## <a name="upgrade-an-application-with-minimal-downtime"></a><span data-ttu-id="59097-242">Upgrade aplikace s minimálními výpadky</span><span class="sxs-lookup"><span data-stu-id="59097-242">Upgrade an application with minimal downtime</span></span>
<span data-ttu-id="59097-243">Někdy aplikace musí být převedeno do režimu offline z důvodu plánované údržby, jako je například upgradu aplikace.</span><span class="sxs-lookup"><span data-stu-id="59097-243">Sometimes an application must be taken offline because of planned maintenance such as an application upgrade.</span></span> <span data-ttu-id="59097-244">[Spravovat aplikace upgrady](sql-database-manage-application-rolling-upgrade.md) popisuje, jak pomocí aktivní geografickou replikaci můžete povolit postupné upgrady vaší cloudové aplikace minimalizovat prostoje při upgradech a zadejte cestu obnovení, pokud dojde k chybě.</span><span class="sxs-lookup"><span data-stu-id="59097-244">[Manage application upgrades](sql-database-manage-application-rolling-upgrade.md) describes how to use active geo-replication to enable rolling upgrades of your cloud application to minimize downtime during upgrades and provide a recovery path if something goes wrong.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="59097-245">Další kroky</span><span class="sxs-lookup"><span data-stu-id="59097-245">Next steps</span></span>
<span data-ttu-id="59097-246">Diskuzi o aspektech návrhu aplikací pro samostatné databáze a pro elastické fondy najdete v tématech [Návrh aplikace pro zotavení po havárii cloudu](sql-database-designing-cloud-solutions-for-disaster-recovery.md) a [Strategie zotavení po havárii elastických fondů](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span><span class="sxs-lookup"><span data-stu-id="59097-246">For a discussion of application design considerations for stand-alone databases and for elastic pools, see [Design an application for cloud disaster recovery](sql-database-designing-cloud-solutions-for-disaster-recovery.md) and [Elastic Pool disaster recovery strategies](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span></span>
