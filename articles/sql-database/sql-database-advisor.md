---
title: "doporučení aaaPerformance – Azure SQL Database | Microsoft Docs"
description: "Hello Azure SQL Database nabízí doporučení pro vaše databáze SQL, který může zlepšit výkon aktuální dotaz."
services: sql-database
documentationcenter: 
author: stevestein
manager: jhubbard
editor: monicar
ms.assetid: 1db441ff-58f5-45da-8d38-b54dc2aa6145
ms.service: sql-database
ms.custom: monitor & tune
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-management
ms.date: 07/05/2017
ms.author: sstein
ms.openlocfilehash: 77db338a0a395aec78c9e02849ae5ba4f2d01680
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="performance-recommendations"></a><span data-ttu-id="f4e9f-103">Doporučení výkonu</span><span class="sxs-lookup"><span data-stu-id="f4e9f-103">Performance recommendations</span></span>

<span data-ttu-id="f4e9f-104">Azure SQL Database zjišťuje a přizpůsobuje s vaší aplikací a poskytuje přizpůsobené doporučení, takže se budete toomaximize hello výkon vaší databáze SQL.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-104">Azure SQL Database learns and adapts with your application and provides customized recommendations enabling you toomaximize hello performance of your SQL databases.</span></span> <span data-ttu-id="f4e9f-105">Výkon se nepřetržitě hodnotí analýzou historie využití vaší databáze SQL.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-105">Your performance is continuously assessed by analyzing your SQL Database usage history.</span></span> <span data-ttu-id="f4e9f-106">Hello doporučení, které jsou k dispozici jsou založené na vzor jedinečný zatížení databáze a zvýšit jeho výkon.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-106">hello recommendations that are provided are based on a database unique workload pattern and help improve its performance.</span></span>

> [!NOTE]
> <span data-ttu-id="f4e9f-107">Doporučený způsob použití doporučení je v databázi povolíte, automatické ladění'.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-107">Recommended way of using recommendations is by enabling ‘Automatic tuning’ on your database.</span></span> <span data-ttu-id="f4e9f-108">Podrobnosti najdete v tématu [automatické ladění](sql-database-automatic-tuning.md).</span><span class="sxs-lookup"><span data-stu-id="f4e9f-108">For details, see [Automatic tuning](sql-database-automatic-tuning.md).</span></span>
>

## <a name="create-index-recommendations"></a><span data-ttu-id="f4e9f-109">Vytvoření doporučení indexu</span><span class="sxs-lookup"><span data-stu-id="f4e9f-109">Create index recommendations</span></span>
<span data-ttu-id="f4e9f-110">Azure SQL Database nepřetržitě monitoruje hello dotazy spouštěna a identifikuje hello indexy, které může zlepšit výkon hello.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-110">Azure SQL Database continuously monitors hello queries being executed and identifies hello indexes that could improve hello performance.</span></span> <span data-ttu-id="f4e9f-111">Po dostatek spolehlivosti, určité index chybí, nový **vytvořit index** doporučení se vytvoří.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-111">Once enough confidence is built that a certain index is missing, a new **Create index** recommendation will be created.</span></span> <span data-ttu-id="f4e9f-112">Azure SQL Database sestavení spolehlivosti odhadem výkonu nárůst hello indexu by přepněte prostřednictvím čas.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-112">Azure SQL Database builds confidence by estimating performance gain hello index would bring through time.</span></span> <span data-ttu-id="f4e9f-113">V závislosti na hello odhadované zvýšení výkonu je zde uvedena doporučení, která jsou klasifikovány jako Vysoká, střední nebo Nízká.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-113">Depending on hello estimated performance gain, recommendations are categorized as High, Medium,  or Low.</span></span> 

<span data-ttu-id="f4e9f-114">Indexy vytvořené pomocí doporučení jsou vždy označeny jako auto_created indexy.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-114">Indexes created using recommendations are always flagged as auto_created indexes.</span></span> <span data-ttu-id="f4e9f-115">Uvidíte, jaké indexy jsou auto_created prohlížením sys.indexes zobrazení.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-115">You can see which indexes are auto_created by looking at sys.indexes view.</span></span> <span data-ttu-id="f4e9f-116">Automaticky vytvořit indexy neblokovat příkazy ALTER nebo přejmenovat.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-116">Auto created indexes don’t block ALTER/RENAME commands.</span></span> <span data-ttu-id="f4e9f-117">Pokud se pokusíte toodrop hello sloupec, který má automaticky vytvořit index nad ním, předá příkaz hello a hello automaticky vytvořit index je vyřadit pomocí příkazu hello také.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-117">If you try toodrop hello column that has an auto created index over it, hello command passes and hello auto created index is dropped with hello command as well.</span></span> <span data-ttu-id="f4e9f-118">Příkaz ALTER/přejmenování hello na sloupce, které jsou indexované by bloku obyčejné indexy.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-118">Regular indexes would block hello ALTER/RENAME command on columns that are indexed.</span></span>

<span data-ttu-id="f4e9f-119">Po vytvoření hello doporučení indexu se použije, Azure SQL Database se porovná výkonu dotazů hello hello základní výkon.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-119">Once hello create index recommendation is applied, Azure SQL Database will compare performance of hello queries with hello baseline performance.</span></span> <span data-ttu-id="f4e9f-120">Pokud nový index uvést do režimu vylepšení výkonu hello, doporučení se označilo jako úspěšné a dopad sestava bude k dispozici.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-120">If new index brought improvements in hello performance, recommendation will be flagged as successful and impact report will be available.</span></span> <span data-ttu-id="f4e9f-121">V případě, že hello index nebylo přineste hello výhody, ji budou automaticky zrušeny.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-121">In case hello index didn’t bring hello benefits, it will be automatically reverted.</span></span> <span data-ttu-id="f4e9f-122">Tímto způsobem Azure SQL Database zajišťuje, že pomocí doporučení bude pouze zlepšit výkon databáze hello.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-122">This way Azure SQL Database ensures that using recommendations will only improve hello database performance.</span></span>

<span data-ttu-id="f4e9f-123">Všechny **vytvořit index** doporučení obsahuje regrese zásadu, která nebude povolovat použití hello doporučení, pokud využití DTU databáze nebo fond hello byla vyšší než 80 % v posledních 20 minut nebo pokud hello úložiště je více než 90 % využití.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-123">Any **Create index** recommendation has a back off policy that won’t allow applying hello recommendation if hello database or pool DTU usage was above 80% in last 20 minutes or if hello storage is above 90% of usage.</span></span> <span data-ttu-id="f4e9f-124">V takovém případě bude odložit hello doporučení.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-124">In this case, hello recommendation will be postponed.</span></span>

## <a name="drop-index-recommendations"></a><span data-ttu-id="f4e9f-125">Doporučení k odstranění indexu</span><span class="sxs-lookup"><span data-stu-id="f4e9f-125">Drop index recommendations</span></span>
<span data-ttu-id="f4e9f-126">Kromě toho toodetecting chybí index, Azure SQL Database průběžně analyzuje hello výkon stávající indexy.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-126">In addition toodetecting a missing index, Azure SQL Database continuously analyzes hello performance of existing indexes.</span></span> <span data-ttu-id="f4e9f-127">Pokud se nepoužívá index, bude Azure SQL Database doporučujeme jej vyřadíte.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-127">If index is not used, Azure SQL Database will recommend dropping it.</span></span> <span data-ttu-id="f4e9f-128">Vyřazení indexu se doporučuje ve dvou případech:</span><span class="sxs-lookup"><span data-stu-id="f4e9f-128">Dropping an index is recommended in two cases:</span></span>
* <span data-ttu-id="f4e9f-129">Index je duplicitní s jiným indexem (stejná indexována a zahrnuté sloupce, schéma oddílu a filtry)</span><span class="sxs-lookup"><span data-stu-id="f4e9f-129">Index is a duplicate of another index (same indexed and included column, partition schema, and filters)</span></span>
* <span data-ttu-id="f4e9f-130">Index se nepoužívá po delší dobu (93 dny)</span><span class="sxs-lookup"><span data-stu-id="f4e9f-130">Index is unused for a prolonged period (93 days)</span></span>

<span data-ttu-id="f4e9f-131">Doporučení k odstranění indexu také projít hello ověření po implementaci.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-131">Drop index recommendations also go through hello verification after implementation.</span></span> <span data-ttu-id="f4e9f-132">Pokud vyšší výkon hello hello dopad sestavy je k dispozici.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-132">If hello performance is improved hello impact report will be available.</span></span> <span data-ttu-id="f4e9f-133">V případě, že se detekuje snížení výkonu, budou vráceny doporučení.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-133">In case performance degradation is detected, recommendation will be reverted.</span></span>


## <a name="parameterize-queries-recommendations"></a><span data-ttu-id="f4e9f-134">Parametrizace doporučení dotazy</span><span class="sxs-lookup"><span data-stu-id="f4e9f-134">Parameterize queries recommendations</span></span>
<span data-ttu-id="f4e9f-135">**Parametrizace dotazy** doporučení se zobrazí, když máte jeden nebo více dotazů, které jsou neustále překompilovat, ale nebudete mít hello stejný plán spuštění dotazu.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-135">**Parameterize queries** recommendations appear when you have one or more queries that are constantly being recompiled but end up with hello same query execution plan.</span></span> <span data-ttu-id="f4e9f-136">Tato podmínka otevře tooapply možnost vynutit Parametrizace, což vám umožní plány dotazů toobe do mezipaměti a opakovaně používat ve hello budoucí zvýšení výkonu a snížení využití prostředků.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-136">This condition opens up an opportunity tooapply forced parameterization, which will allow query plans toobe cached and reused in hello future improving performance and reducing resource usage.</span></span> 

<span data-ttu-id="f4e9f-137">Každý dotaz původně vydaný pro SQL Server musí toobe zkompilovat toogenerate plán spuštění.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-137">Every query issued against SQL Server initially needs toobe compiled toogenerate an execution plan.</span></span> <span data-ttu-id="f4e9f-138">Každý generovaného plán se přidá toohello mezipaměti plánu a následné spuštění služby hello stejný dotaz můžete opakovaně použít tento plán z mezipaměti hello, což eliminuje potřebu hello další kompilace.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-138">Each generated plan is added toohello plan cache and subsequent executions of hello same query can reuse this plan from hello cache, eliminating hello need for additional compilation.</span></span> 

<span data-ttu-id="f4e9f-139">Aplikace, které odesílají dotazy, které obsahují hodnoty parametry, může způsobit tooa zatížení, které pro každý dotaz s jiným parametrem hodnotami plán spuštění hello kompiluje znovu.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-139">Applications that send queries, which include non-parameterized values, can lead tooa performance overhead, where for every such query with different parameter values hello execution plan is compiled again.</span></span> <span data-ttu-id="f4e9f-140">V mnoha případech hello stejné dotazy s jiným parametrem, který generování hodnoty hello stejné provádění plánů, ale tyto plány jsou stále samostatně přidat toohello mezipaměti plánu.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-140">In many cases hello same queries with different parameter values generate hello same execution plans, but these plans are still separately added toohello plan cache.</span></span> <span data-ttu-id="f4e9f-141">Nutnosti rekompilace provádění plány pomocí databáze prostředků, zvýšit hello trvání čas a přetečení hello plán dotazu, že příčinou mezipaměti plány toobe vyřazování z mezipaměti hello.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-141">Recompiling execution plans use database resources, increase hello query duration time and overflow hello plan cache causing plans toobe evicted from hello cache.</span></span> <span data-ttu-id="f4e9f-142">Toto chování systému SQL Server může být změněna nastavením hello vynutit Parametrizace možnost v databázi hello.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-142">This behavior of SQL Server can be altered by setting hello forced parameterization option on hello database.</span></span> 

<span data-ttu-id="f4e9f-143">toohelp odhad hello dopad toto doporučení, které jsou k dispozici s porovnání mezi skutečné procesoru hello využití a hello předpokládané využití procesoru (jako v případě, že bylo použito hello doporučení).</span><span class="sxs-lookup"><span data-stu-id="f4e9f-143">toohelp you estimate hello impact of this recommendation, you are provided with a comparison between hello actual CPU usage and hello projected CPU usage (as if hello recommendation was applied).</span></span> <span data-ttu-id="f4e9f-144">Kromě tooCPU úspory, doba trvání vašeho dotazu zkracuje dobu hello stráví v kompilaci.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-144">In addition tooCPU savings, your query duration decreases for hello time spent in compilation.</span></span> <span data-ttu-id="f4e9f-145">Také bude mnohem menší nároky na mezipaměti plánu, což většina hello plány toostay v mezipaměti a znovu použít.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-145">There will also be much less overhead on plan cache, allowing majority of hello plans toostay in cache and be reused.</span></span> <span data-ttu-id="f4e9f-146">Toto doporučení můžete použít snadno a rychle kliknutím na hello **použít** příkaz.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-146">You can apply this recommendation quickly and easily by clicking on hello **Apply** command.</span></span> 

<span data-ttu-id="f4e9f-147">Když použijete toto doporučení, zapne vynucené Parametrizace minut ve vaší databázi a začne hello monitorování proces, který přibližně trvá po dobu 24 hodin.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-147">Once you apply this recommendation, it will enable forced parameterization within minutes on your database and it starts hello monitoring process which approximately lasts for 24 hours.</span></span> <span data-ttu-id="f4e9f-148">Po uplynutí této doby budete mít možnost toosee hello ověření sestavu, která ukazuje využití procesoru vaší databáze 24 hodin, než se a po použití hello doporučení.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-148">After this period, you will be able toosee hello validation report that shows CPU usage of your database 24 hours before and after hello recommendation has been applied.</span></span> <span data-ttu-id="f4e9f-149">Poradce pro funkci SQL Database má bezpečnostní mechanismus, který automaticky vrátí doporučení hello použije v případě, že byla zjištěna snížení výkonu.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-149">SQL Database Advisor has a safety mechanism that automatically reverts hello applied recommendation in case a performance regression has been detected.</span></span>

## <a name="fix-schema-issues-recommendations"></a><span data-ttu-id="f4e9f-150">Opravte problémy doporučení schématu</span><span class="sxs-lookup"><span data-stu-id="f4e9f-150">Fix schema issues recommendations</span></span>
<span data-ttu-id="f4e9f-151">**Opravte problémy schématu** doporučení se zobrazí při hello služba SQL Database oznámení anomálií hello počet chyby související s schématu SQL aktivit ve vaší databázi SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-151">**Fix schema issues** recommendations appear when hello SQL Database service notices an anomaly in hello number of schema-related SQL errors happening on your Azure SQL Database.</span></span> <span data-ttu-id="f4e9f-152">Toto doporučení se obvykle zobrazují, když databáze dojde více schématu související chyby (neplatný název sloupce, neplatný název objektu atd.) v rámci hodiny.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-152">This recommendation typically appears when your database encounters multiple schema-related errors (invalid column name, invalid object name, etc.) within an hour.</span></span>

<span data-ttu-id="f4e9f-153">"Schématu problémy" jsou třídou chyby syntaxe v systému SQL Server, které dojít v případě, že nejsou zarovnány hello Definice dotazu SQL hello a hello definice schématu databáze hello.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-153">“Schema issues” are a class of syntax errors in SQL Server that happen when hello definition of hello SQL query and hello definition of hello database schema are not aligned.</span></span> <span data-ttu-id="f4e9f-154">Například jeden ze sloupců hello očekávanou hello dotazu může být chybějící v cílové tabulce hello nebo naopak.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-154">For example, one of hello columns expected by hello query may be missing in hello target table, or vice versa.</span></span> 

<span data-ttu-id="f4e9f-155">"Opravit problém schématu" doporučení se zobrazí, když služba Azure SQL Database oznámení anomálií hello počet chyby související s schématu SQL aktivit ve vaší databázi SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-155">“Fix schema issue” recommendation appears when Azure SQL Database service notices an anomaly in hello number of schema-related SQL errors happening on your Azure SQL Database.</span></span> <span data-ttu-id="f4e9f-156">Následující tabulka ukazuje hello chyby, které jsou problémy související tooschema Hello:</span><span class="sxs-lookup"><span data-stu-id="f4e9f-156">hello following table shows hello errors that are related tooschema issues:</span></span>

| <span data-ttu-id="f4e9f-157">Kód chyby SQL</span><span class="sxs-lookup"><span data-stu-id="f4e9f-157">SQL Error Code</span></span> | <span data-ttu-id="f4e9f-158">Zpráva</span><span class="sxs-lookup"><span data-stu-id="f4e9f-158">Message</span></span> |
| --- | --- |
| <span data-ttu-id="f4e9f-159">201</span><span class="sxs-lookup"><span data-stu-id="f4e9f-159">201</span></span> |<span data-ttu-id="f4e9f-160">Procedura nebo funkce,*'očekává parametr'*', která nebyla zadána.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-160">Procedure or function '*' expects parameter '*', which was not supplied.</span></span> |
| <span data-ttu-id="f4e9f-161">207</span><span class="sxs-lookup"><span data-stu-id="f4e9f-161">207</span></span> |<span data-ttu-id="f4e9f-162">Neplatný název sloupce ' *'.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-162">Invalid column name '*'.</span></span> |
| <span data-ttu-id="f4e9f-163">208</span><span class="sxs-lookup"><span data-stu-id="f4e9f-163">208</span></span> |<span data-ttu-id="f4e9f-164">Neplatný název objektu ' *'.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-164">Invalid object name '*'.</span></span> |
| <span data-ttu-id="f4e9f-165">213</span><span class="sxs-lookup"><span data-stu-id="f4e9f-165">213</span></span> |<span data-ttu-id="f4e9f-166">Název sloupce nebo počet zadaných hodnot neodpovídá definici tabulky.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-166">Column name or number of supplied values does not match table definition.</span></span> |
| <span data-ttu-id="f4e9f-167">2812</span><span class="sxs-lookup"><span data-stu-id="f4e9f-167">2812</span></span> |<span data-ttu-id="f4e9f-168">Nelze nalézt uloženou proceduru ' *'.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-168">Could not find stored procedure '*'.</span></span> |
| <span data-ttu-id="f4e9f-169">8144</span><span class="sxs-lookup"><span data-stu-id="f4e9f-169">8144</span></span> |<span data-ttu-id="f4e9f-170">Procedura nebo funkce * má příliš mnoho zadaných argumentů.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-170">Procedure or function * has too many arguments specified.</span></span> |

## <a name="next-steps"></a><span data-ttu-id="f4e9f-171">Další kroky</span><span class="sxs-lookup"><span data-stu-id="f4e9f-171">Next steps</span></span>
<span data-ttu-id="f4e9f-172">Sledovat vaše doporučení a pokračovat tooapply je toorefine výkonu.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-172">Monitor your recommendations and continue tooapply them toorefine performance.</span></span> <span data-ttu-id="f4e9f-173">Databázové úlohy jsou dynamické a průběžně změnu.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-173">Database workloads are dynamic and change continuously.</span></span> <span data-ttu-id="f4e9f-174">Databáze SQL advisor pokračuje toomonitor a poskytovat doporučení, které může zlepšit výkon vaší databáze.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-174">SQL Database advisor continues toomonitor and provide recommendations that can potentially improve your database's performance.</span></span> 

* <span data-ttu-id="f4e9f-175">V tématu [výkonu doporučení v hello portál Azure](sql-database-advisor-portal.md) kroky jak hello toouse výkonu doporučení v portálu Azure.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-175">See [Performance recommendations in hello Azure portal](sql-database-advisor-portal.md) for steps on how toouse performance recommendations in hello Azure portal.</span></span>
* <span data-ttu-id="f4e9f-176">V tématu [Query Performance Insight](sql-database-query-performance.md) toolearn o a zobrazení hello vlivu na výkon nejčastějších dotazů.</span><span class="sxs-lookup"><span data-stu-id="f4e9f-176">See [Query Performance Insights](sql-database-query-performance.md) toolearn about and view hello performance impact of your top queries.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="f4e9f-177">Další zdroje</span><span class="sxs-lookup"><span data-stu-id="f4e9f-177">Additional resources</span></span>
* [<span data-ttu-id="f4e9f-178">Úložiště dotazů</span><span class="sxs-lookup"><span data-stu-id="f4e9f-178">Query Store</span></span>](https://msdn.microsoft.com/library/dn817826.aspx)
* [<span data-ttu-id="f4e9f-179">VYTVOŘENÍ INDEXU</span><span class="sxs-lookup"><span data-stu-id="f4e9f-179">CREATE INDEX</span></span>](https://msdn.microsoft.com/library/ms188783.aspx)
* [<span data-ttu-id="f4e9f-180">Řízení přístupu na základě rolí</span><span class="sxs-lookup"><span data-stu-id="f4e9f-180">Role-based access control</span></span>](../active-directory/role-based-access-control-what-is.md)

