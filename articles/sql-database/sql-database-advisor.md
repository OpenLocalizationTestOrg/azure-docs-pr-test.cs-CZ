---
title: "Výkon doporučení – Azure SQL Database | Microsoft Docs"
description: "Databáze SQL Azure poskytuje doporučení pro vaše databáze SQL, který může zlepšit výkon aktuální dotaz."
services: sql-database
documentationcenter: 
author: stevestein
manager: jhubbard
editor: monicar
ms.assetid: 1db441ff-58f5-45da-8d38-b54dc2aa6145
ms.service: sql-database
ms.custom: monitor & tune
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-management
ms.date: 07/05/2017
ms.author: sstein
ms.openlocfilehash: 357a25a665894c86ddb0f93beeb4dd59d8837489
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 07/11/2017
---
# <a name="performance-recommendations"></a><span data-ttu-id="a1705-103">Doporučení výkonu</span><span class="sxs-lookup"><span data-stu-id="a1705-103">Performance recommendations</span></span>

<span data-ttu-id="a1705-104">Azure SQL Database zjišťuje a přizpůsobuje s vaší aplikací a poskytuje přizpůsobené doporučení umožňuje maximalizovat výkon vaší databáze SQL.</span><span class="sxs-lookup"><span data-stu-id="a1705-104">Azure SQL Database learns and adapts with your application and provides customized recommendations enabling you to maximize the performance of your SQL databases.</span></span> <span data-ttu-id="a1705-105">Výkon se nepřetržitě hodnotí analýzou historie využití vaší databáze SQL.</span><span class="sxs-lookup"><span data-stu-id="a1705-105">Your performance is continuously assessed by analyzing your SQL Database usage history.</span></span> <span data-ttu-id="a1705-106">Doporučení, které jsou k dispozici jsou založené na vzor jedinečný zatížení databáze a zvýšit jeho výkon.</span><span class="sxs-lookup"><span data-stu-id="a1705-106">The recommendations that are provided are based on a database unique workload pattern and help improve its performance.</span></span>

> [!NOTE]
> <span data-ttu-id="a1705-107">Doporučený způsob použití doporučení je v databázi povolíte, automatické ladění'.</span><span class="sxs-lookup"><span data-stu-id="a1705-107">Recommended way of using recommendations is by enabling ‘Automatic tuning’ on your database.</span></span> <span data-ttu-id="a1705-108">Podrobnosti najdete v tématu [automatické ladění](sql-database-automatic-tuning.md).</span><span class="sxs-lookup"><span data-stu-id="a1705-108">For details, see [Automatic tuning](sql-database-automatic-tuning.md).</span></span>
>

## <a name="create-index-recommendations"></a><span data-ttu-id="a1705-109">Vytvoření doporučení indexu</span><span class="sxs-lookup"><span data-stu-id="a1705-109">Create index recommendations</span></span>
<span data-ttu-id="a1705-110">Azure SQL Database nepřetržitě monitoruje spouštění dotazů a identifikuje indexy, které může zlepšit výkon.</span><span class="sxs-lookup"><span data-stu-id="a1705-110">Azure SQL Database continuously monitors the queries being executed and identifies the indexes that could improve the performance.</span></span> <span data-ttu-id="a1705-111">Po dostatek spolehlivosti, určité index chybí, nový **vytvořit index** doporučení se vytvoří.</span><span class="sxs-lookup"><span data-stu-id="a1705-111">Once enough confidence is built that a certain index is missing, a new **Create index** recommendation will be created.</span></span> <span data-ttu-id="a1705-112">Databáze SQL Azure vytvoří spolehlivosti odhadem zvýšení výkonu, které by index uvést prostřednictvím čas.</span><span class="sxs-lookup"><span data-stu-id="a1705-112">Azure SQL Database builds confidence by estimating performance gain the index would bring through time.</span></span> <span data-ttu-id="a1705-113">V závislosti na odhadované výkonnější doporučení jsou klasifikovány jako Vysoká, střední nebo Nízká.</span><span class="sxs-lookup"><span data-stu-id="a1705-113">Depending on the estimated performance gain, recommendations are categorized as High, Medium,  or Low.</span></span> 

<span data-ttu-id="a1705-114">Indexy vytvořené pomocí doporučení jsou vždy označeny jako auto_created indexy.</span><span class="sxs-lookup"><span data-stu-id="a1705-114">Indexes created using recommendations are always flagged as auto_created indexes.</span></span> <span data-ttu-id="a1705-115">Uvidíte, jaké indexy jsou auto_created prohlížením sys.indexes zobrazení.</span><span class="sxs-lookup"><span data-stu-id="a1705-115">You can see which indexes are auto_created by looking at sys.indexes view.</span></span> <span data-ttu-id="a1705-116">Automaticky vytvořit indexy neblokovat příkazy ALTER nebo přejmenovat.</span><span class="sxs-lookup"><span data-stu-id="a1705-116">Auto created indexes don’t block ALTER/RENAME commands.</span></span> <span data-ttu-id="a1705-117">Pokud se pokusíte vyřadit sloupec, který se má automaticky vytvořit index nad ním, předá příkazu a automaticky vytvořit index je vyřadit pomocí příkazu také.</span><span class="sxs-lookup"><span data-stu-id="a1705-117">If you try to drop the column that has an auto created index over it, the command passes and the auto created index is dropped with the command as well.</span></span> <span data-ttu-id="a1705-118">Příkaz ALTER/přejmenování na sloupce, které jsou indexované by blokovat obyčejné indexy.</span><span class="sxs-lookup"><span data-stu-id="a1705-118">Regular indexes would block the ALTER/RENAME command on columns that are indexed.</span></span>

<span data-ttu-id="a1705-119">Po vytvoření doporučení indexu bude Azure SQL Database porovnejte výkon dotazů s základní výkon.</span><span class="sxs-lookup"><span data-stu-id="a1705-119">Once the create index recommendation is applied, Azure SQL Database will compare performance of the queries with the baseline performance.</span></span> <span data-ttu-id="a1705-120">Pokud nový index uvést do režimu vylepšení výkonu, doporučení se označilo jako úspěšné a dopad sestava bude k dispozici.</span><span class="sxs-lookup"><span data-stu-id="a1705-120">If new index brought improvements in the performance, recommendation will be flagged as successful and impact report will be available.</span></span> <span data-ttu-id="a1705-121">V případě, že index nebylo přineste výhody, ji budou automaticky zrušeny.</span><span class="sxs-lookup"><span data-stu-id="a1705-121">In case the index didn’t bring the benefits, it will be automatically reverted.</span></span> <span data-ttu-id="a1705-122">Tímto způsobem Azure SQL Database zajišťuje, že pomocí doporučení budou pouze zlepšit výkon databáze.</span><span class="sxs-lookup"><span data-stu-id="a1705-122">This way Azure SQL Database ensures that using recommendations will only improve the database performance.</span></span>

<span data-ttu-id="a1705-123">Všechny **vytvořit index** doporučení obsahuje regrese zásadu, která nebude povolovat použití doporučení, pokud využití v jednotkách DTU databáze nebo fondu byla vyšší než 80 % v posledních 20 minut nebo pokud úložiště je více než 90 % využití.</span><span class="sxs-lookup"><span data-stu-id="a1705-123">Any **Create index** recommendation has a back off policy that won’t allow applying the recommendation if the database or pool DTU usage was above 80% in last 20 minutes or if the storage is above 90% of usage.</span></span> <span data-ttu-id="a1705-124">V takovém případě bude odložit doporučení.</span><span class="sxs-lookup"><span data-stu-id="a1705-124">In this case, the recommendation will be postponed.</span></span>

## <a name="drop-index-recommendations"></a><span data-ttu-id="a1705-125">Doporučení k odstranění indexu</span><span class="sxs-lookup"><span data-stu-id="a1705-125">Drop index recommendations</span></span>
<span data-ttu-id="a1705-126">Kromě zjišťování chybí index, Azure SQL Database průběžně analyzuje výkon stávající indexy.</span><span class="sxs-lookup"><span data-stu-id="a1705-126">In addition to detecting a missing index, Azure SQL Database continuously analyzes the performance of existing indexes.</span></span> <span data-ttu-id="a1705-127">Pokud se nepoužívá index, bude Azure SQL Database doporučujeme jej vyřadíte.</span><span class="sxs-lookup"><span data-stu-id="a1705-127">If index is not used, Azure SQL Database will recommend dropping it.</span></span> <span data-ttu-id="a1705-128">Vyřazení indexu se doporučuje ve dvou případech:</span><span class="sxs-lookup"><span data-stu-id="a1705-128">Dropping an index is recommended in two cases:</span></span>
* <span data-ttu-id="a1705-129">Index je duplicitní s jiným indexem (stejná indexována a zahrnuté sloupce, schéma oddílu a filtry)</span><span class="sxs-lookup"><span data-stu-id="a1705-129">Index is a duplicate of another index (same indexed and included column, partition schema, and filters)</span></span>
* <span data-ttu-id="a1705-130">Index se nepoužívá po delší dobu (93 dny)</span><span class="sxs-lookup"><span data-stu-id="a1705-130">Index is unused for a prolonged period (93 days)</span></span>

<span data-ttu-id="a1705-131">Doporučení k odstranění indexu také projít ověření po implementaci.</span><span class="sxs-lookup"><span data-stu-id="a1705-131">Drop index recommendations also go through the verification after implementation.</span></span> <span data-ttu-id="a1705-132">Pokud lepší výkon dopad sestavy je k dispozici.</span><span class="sxs-lookup"><span data-stu-id="a1705-132">If the performance is improved the impact report will be available.</span></span> <span data-ttu-id="a1705-133">V případě, že se detekuje snížení výkonu, budou vráceny doporučení.</span><span class="sxs-lookup"><span data-stu-id="a1705-133">In case performance degradation is detected, recommendation will be reverted.</span></span>


## <a name="parameterize-queries-recommendations"></a><span data-ttu-id="a1705-134">Parametrizace doporučení dotazy</span><span class="sxs-lookup"><span data-stu-id="a1705-134">Parameterize queries recommendations</span></span>
<span data-ttu-id="a1705-135">**Parametrizace dotazy** doporučení se zobrazí, když máte jeden nebo více dotazů, které jsou neustále probíhá překompilovat, ale end až s stejný plán spuštění dotazu.</span><span class="sxs-lookup"><span data-stu-id="a1705-135">**Parameterize queries** recommendations appear when you have one or more queries that are constantly being recompiled but end up with the same query execution plan.</span></span> <span data-ttu-id="a1705-136">Tato podmínka otevře možnost použít vynucené Parametrizace, což vám umožní plány dotazů do mezipaměti a opakovaně v budoucí zvýšení výkonu a snížení využití prostředků.</span><span class="sxs-lookup"><span data-stu-id="a1705-136">This condition opens up an opportunity to apply forced parameterization, which will allow query plans to be cached and reused in the future improving performance and reducing resource usage.</span></span> 

<span data-ttu-id="a1705-137">Každý dotaz původně vydaný pro SQL Server musí být zkompilovány Generovat plán spuštění.</span><span class="sxs-lookup"><span data-stu-id="a1705-137">Every query issued against SQL Server initially needs to be compiled to generate an execution plan.</span></span> <span data-ttu-id="a1705-138">Každý generovaného plán je přidán do mezipaměti plánu a dalších spuštěních stejný dotaz můžete opakovaně použít tento plán z mezipaměti, což eliminuje potřebu další kompilace.</span><span class="sxs-lookup"><span data-stu-id="a1705-138">Each generated plan is added to the plan cache and subsequent executions of the same query can reuse this plan from the cache, eliminating the need for additional compilation.</span></span> 

<span data-ttu-id="a1705-139">Aplikace, které odesílají dotazy, které obsahují hodnoty parametry, může vést k zatížení, které pro každý dotaz s jiným parametrem hodnotami plán spuštění kompiluje znovu.</span><span class="sxs-lookup"><span data-stu-id="a1705-139">Applications that send queries, which include non-parameterized values, can lead to a performance overhead, where for every such query with different parameter values the execution plan is compiled again.</span></span> <span data-ttu-id="a1705-140">V mnoha případech stejné dotazy s jiným parametrem hodnoty generovat stejný provádění plánů, ale tyto plány jsou stále samostatně přidaných do mezipaměti v plánu.</span><span class="sxs-lookup"><span data-stu-id="a1705-140">In many cases the same queries with different parameter values generate the same execution plans, but these plans are still separately added to the plan cache.</span></span> <span data-ttu-id="a1705-141">Nutnosti rekompilace plány provádění používat prostředky databáze, zvýšit dotaz doba trvání a přetečení mezipaměti plánu způsobuje plány k vyloučení z mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="a1705-141">Recompiling execution plans use database resources, increase the query duration time and overflow the plan cache causing plans to be evicted from the cache.</span></span> <span data-ttu-id="a1705-142">Toto chování systému SQL Server může být změněna nastavením možnost vynucené Parametrizace v databázi.</span><span class="sxs-lookup"><span data-stu-id="a1705-142">This behavior of SQL Server can be altered by setting the forced parameterization option on the database.</span></span> 

<span data-ttu-id="a1705-143">Chcete-li odhadnout dopad toto doporučení, jsou k dispozici srovnání skutečné využití procesoru a předpokládané využití procesoru (jako v případě, že bylo použito doporučení).</span><span class="sxs-lookup"><span data-stu-id="a1705-143">To help you estimate the impact of this recommendation, you are provided with a comparison between the actual CPU usage and the projected CPU usage (as if the recommendation was applied).</span></span> <span data-ttu-id="a1705-144">Kromě úspory využití procesoru zkracuje doba trvání vašeho dotazu pro čas strávený v kompilaci.</span><span class="sxs-lookup"><span data-stu-id="a1705-144">In addition to CPU savings, your query duration decreases for the time spent in compilation.</span></span> <span data-ttu-id="a1705-145">Také bude mnohem menší nároky na mezipaměti plánu, povolení Většina plánů zůstanou v mezipaměti a znovu použít.</span><span class="sxs-lookup"><span data-stu-id="a1705-145">There will also be much less overhead on plan cache, allowing majority of the plans to stay in cache and be reused.</span></span> <span data-ttu-id="a1705-146">Toto doporučení můžete použít snadno a rychle kliknutím na **použít** příkaz.</span><span class="sxs-lookup"><span data-stu-id="a1705-146">You can apply this recommendation quickly and easily by clicking on the **Apply** command.</span></span> 

<span data-ttu-id="a1705-147">Když použijete toto doporučení, zapne vynucené Parametrizace minut ve vaší databázi a začne monitorování procesu, který přibližně trvá po dobu 24 hodin.</span><span class="sxs-lookup"><span data-stu-id="a1705-147">Once you apply this recommendation, it will enable forced parameterization within minutes on your database and it starts the monitoring process which approximately lasts for 24 hours.</span></span> <span data-ttu-id="a1705-148">Po uplynutí této doby bude moci zobrazit sestavy ověření, který ukazuje využití procesoru vaší databáze, 24 hodin před a po použití doporučení.</span><span class="sxs-lookup"><span data-stu-id="a1705-148">After this period, you will be able to see the validation report that shows CPU usage of your database 24 hours before and after the recommendation has been applied.</span></span> <span data-ttu-id="a1705-149">Poradce pro funkci SQL Database má bezpečnostní mechanismus, který automaticky vrátí použité doporučení v případě, že byla zjištěna snížení výkonu.</span><span class="sxs-lookup"><span data-stu-id="a1705-149">SQL Database Advisor has a safety mechanism that automatically reverts the applied recommendation in case a performance regression has been detected.</span></span>

## <a name="fix-schema-issues-recommendations"></a><span data-ttu-id="a1705-150">Opravte problémy doporučení schématu</span><span class="sxs-lookup"><span data-stu-id="a1705-150">Fix schema issues recommendations</span></span>
<span data-ttu-id="a1705-151">**Opravte problémy schématu** doporučení se zobrazí, pokud služba SQL Database oznámení anomálií v počtu chyby související s schématu SQL aktivit ve vaší databázi SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="a1705-151">**Fix schema issues** recommendations appear when the SQL Database service notices an anomaly in the number of schema-related SQL errors happening on your Azure SQL Database.</span></span> <span data-ttu-id="a1705-152">Toto doporučení se obvykle zobrazují, když databáze dojde více schématu související chyby (neplatný název sloupce, neplatný název objektu atd.) v rámci hodiny.</span><span class="sxs-lookup"><span data-stu-id="a1705-152">This recommendation typically appears when your database encounters multiple schema-related errors (invalid column name, invalid object name, etc.) within an hour.</span></span>

<span data-ttu-id="a1705-153">"Schématu problémy" jsou třídou chyby syntaxe v systému SQL Server, které dojít v případě, že definice schématu databáze a definice dotazu SQL nejsou zarovnány.</span><span class="sxs-lookup"><span data-stu-id="a1705-153">“Schema issues” are a class of syntax errors in SQL Server that happen when the definition of the SQL query and the definition of the database schema are not aligned.</span></span> <span data-ttu-id="a1705-154">Například jeden ze sloupců očekávanou dotazu může být chybějící v cílové tabulce, nebo naopak.</span><span class="sxs-lookup"><span data-stu-id="a1705-154">For example, one of the columns expected by the query may be missing in the target table, or vice versa.</span></span> 

<span data-ttu-id="a1705-155">"Opravit problém schématu" doporučení se zobrazí, když služba Azure SQL Database oznámení anomálií v počtu chyby související s schématu SQL aktivit ve vaší databázi SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="a1705-155">“Fix schema issue” recommendation appears when Azure SQL Database service notices an anomaly in the number of schema-related SQL errors happening on your Azure SQL Database.</span></span> <span data-ttu-id="a1705-156">Následující tabulka obsahuje chyby, které souvisí s problémy schématu:</span><span class="sxs-lookup"><span data-stu-id="a1705-156">The following table shows the errors that are related to schema issues:</span></span>

| <span data-ttu-id="a1705-157">Kód chyby SQL</span><span class="sxs-lookup"><span data-stu-id="a1705-157">SQL Error Code</span></span> | <span data-ttu-id="a1705-158">Zpráva</span><span class="sxs-lookup"><span data-stu-id="a1705-158">Message</span></span> |
| --- | --- |
| <span data-ttu-id="a1705-159">201</span><span class="sxs-lookup"><span data-stu-id="a1705-159">201</span></span> |<span data-ttu-id="a1705-160">Procedura nebo funkce,*'očekává parametr'*', která nebyla zadána.</span><span class="sxs-lookup"><span data-stu-id="a1705-160">Procedure or function '*' expects parameter '*', which was not supplied.</span></span> |
| <span data-ttu-id="a1705-161">207</span><span class="sxs-lookup"><span data-stu-id="a1705-161">207</span></span> |<span data-ttu-id="a1705-162">Neplatný název sloupce ' *'.</span><span class="sxs-lookup"><span data-stu-id="a1705-162">Invalid column name '*'.</span></span> |
| <span data-ttu-id="a1705-163">208</span><span class="sxs-lookup"><span data-stu-id="a1705-163">208</span></span> |<span data-ttu-id="a1705-164">Neplatný název objektu ' *'.</span><span class="sxs-lookup"><span data-stu-id="a1705-164">Invalid object name '*'.</span></span> |
| <span data-ttu-id="a1705-165">213</span><span class="sxs-lookup"><span data-stu-id="a1705-165">213</span></span> |<span data-ttu-id="a1705-166">Název sloupce nebo počet zadaných hodnot neodpovídá definici tabulky.</span><span class="sxs-lookup"><span data-stu-id="a1705-166">Column name or number of supplied values does not match table definition.</span></span> |
| <span data-ttu-id="a1705-167">2812</span><span class="sxs-lookup"><span data-stu-id="a1705-167">2812</span></span> |<span data-ttu-id="a1705-168">Nelze nalézt uloženou proceduru ' *'.</span><span class="sxs-lookup"><span data-stu-id="a1705-168">Could not find stored procedure '*'.</span></span> |
| <span data-ttu-id="a1705-169">8144</span><span class="sxs-lookup"><span data-stu-id="a1705-169">8144</span></span> |<span data-ttu-id="a1705-170">Procedura nebo funkce * má příliš mnoho zadaných argumentů.</span><span class="sxs-lookup"><span data-stu-id="a1705-170">Procedure or function * has too many arguments specified.</span></span> |

## <a name="next-steps"></a><span data-ttu-id="a1705-171">Další kroky</span><span class="sxs-lookup"><span data-stu-id="a1705-171">Next steps</span></span>
<span data-ttu-id="a1705-172">Sledovat vaše doporučení a pokračuje v používání jejich Upřesnit výkonu.</span><span class="sxs-lookup"><span data-stu-id="a1705-172">Monitor your recommendations and continue to apply them to refine performance.</span></span> <span data-ttu-id="a1705-173">Databázové úlohy jsou dynamické a průběžně změnu.</span><span class="sxs-lookup"><span data-stu-id="a1705-173">Database workloads are dynamic and change continuously.</span></span> <span data-ttu-id="a1705-174">Poradce pro SQL Database i nadále monitorovat a poskytovat doporučení, které může zlepšit výkon vaší databáze.</span><span class="sxs-lookup"><span data-stu-id="a1705-174">SQL Database advisor continues to monitor and provide recommendations that can potentially improve your database's performance.</span></span> 

* <span data-ttu-id="a1705-175">V tématu [doporučení výkonu na portálu Azure](sql-database-advisor-portal.md) pokyny o tom, jak používat doporučení výkonu na portálu Azure.</span><span class="sxs-lookup"><span data-stu-id="a1705-175">See [Performance recommendations in the Azure portal](sql-database-advisor-portal.md) for steps on how to use performance recommendations in the Azure portal.</span></span>
* <span data-ttu-id="a1705-176">V tématu [Query Performance Insight](sql-database-query-performance.md) a další informace o zobrazení dopad na výkon nejčastějších dotazů.</span><span class="sxs-lookup"><span data-stu-id="a1705-176">See [Query Performance Insights](sql-database-query-performance.md) to learn about and view the performance impact of your top queries.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="a1705-177">Další zdroje</span><span class="sxs-lookup"><span data-stu-id="a1705-177">Additional resources</span></span>
* [<span data-ttu-id="a1705-178">Úložiště dotazů</span><span class="sxs-lookup"><span data-stu-id="a1705-178">Query Store</span></span>](https://msdn.microsoft.com/library/dn817826.aspx)
* [<span data-ttu-id="a1705-179">VYTVOŘENÍ INDEXU</span><span class="sxs-lookup"><span data-stu-id="a1705-179">CREATE INDEX</span></span>](https://msdn.microsoft.com/library/ms188783.aspx)
* [<span data-ttu-id="a1705-180">Řízení přístupu na základě rolí</span><span class="sxs-lookup"><span data-stu-id="a1705-180">Role-based access control</span></span>](../active-directory/role-based-access-control-what-is.md)

