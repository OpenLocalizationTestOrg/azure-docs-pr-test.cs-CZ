---
title: "aaaTroubleshoot pomalé zálohování souborů a složek ve službě Azure Backup | Microsoft Docs"
description: "Poskytuje řešení potíží s pokyny toohelp diagnostikovat hello příčinu problémů s výkonem Azure Backup"
services: backup
documentationcenter: 
author: genlin
manager: cshepard
editor: 
ms.assetid: e379180a-db13-4e0c-90e4-28e5dd6f5b14
ms.service: backup
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/13/2017
ms.author: genli
ms.openlocfilehash: 21d79bbd03c2706bc43fcc7c14020cffd6b919c7
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="troubleshoot-slow-backup-of-files-and-folders-in-azure-backup"></a><span data-ttu-id="2f338-103">Řešení potíží s pomalým zálohováním souborů a složek ve službě Azure Backup</span><span class="sxs-lookup"><span data-stu-id="2f338-103">Troubleshoot slow backup of files and folders in Azure Backup</span></span>
<span data-ttu-id="2f338-104">Tento článek obsahuje pokyny k odstraňování problémů toohelp, můžete diagnostikovat, aby hello příčinu pomalý výkon zálohování pro soubory a složky, pokud používáte Azure Backup.</span><span class="sxs-lookup"><span data-stu-id="2f338-104">This article provides troubleshooting guidance toohelp you diagnose hello cause of slow backup performance for files and folders when you're using Azure Backup.</span></span> <span data-ttu-id="2f338-105">Pokud používáte Azure Backup agent tooback hello soubory, proces zálohování hello může trvat déle než obvykle.</span><span class="sxs-lookup"><span data-stu-id="2f338-105">When you use hello Azure Backup agent tooback up files, hello backup process might take longer than expected.</span></span> <span data-ttu-id="2f338-106">Toto zpoždění může být způsobena jednou nebo více hello následující:</span><span class="sxs-lookup"><span data-stu-id="2f338-106">This delay might be caused by one or more of hello following:</span></span>

* [<span data-ttu-id="2f338-107">Existují kritické hello počítače, který se záloha.</span><span class="sxs-lookup"><span data-stu-id="2f338-107">There are performance bottlenecks on hello computer that’s being backed up.</span></span>](#cause1)
* [<span data-ttu-id="2f338-108">Jiný proces nebo antivirový software narušuje hello proces zálohování Azure.</span><span class="sxs-lookup"><span data-stu-id="2f338-108">Another process or antivirus software is interfering with hello Azure Backup process.</span></span>](#cause2)
* [<span data-ttu-id="2f338-109">agent zálohování Hello je spuštěn na virtuální počítač Azure (VM).</span><span class="sxs-lookup"><span data-stu-id="2f338-109">hello Backup agent is running on an Azure virtual machine (VM).</span></span>](#cause3)  
* [<span data-ttu-id="2f338-110">Zálohujete velký počet (miliony) soubory.</span><span class="sxs-lookup"><span data-stu-id="2f338-110">You're backing up a large number (millions) of files.</span></span>](#cause4)

<span data-ttu-id="2f338-111">Než začnete, řešení potíží, doporučujeme stáhnout a nainstalovat hello [nejnovější verze agenta Azure Backup](http://aka.ms/azurebackup_agent).</span><span class="sxs-lookup"><span data-stu-id="2f338-111">Before you start troubleshooting issues, we recommend that you download and install hello [latest Azure Backup agent](http://aka.ms/azurebackup_agent).</span></span> <span data-ttu-id="2f338-112">Jsme usnadnění časté aktualizace toohello zálohování agenta toofix různé problémy, přidat funkce a zlepšení výkonu.</span><span class="sxs-lookup"><span data-stu-id="2f338-112">We make frequent updates toohello Backup agent toofix various issues, add features, and improve performance.</span></span>

<span data-ttu-id="2f338-113">Také důrazně doporučujeme, abyste si prošli hello [nejčastější dotazy týkající se služby Azure Backup](backup-azure-backup-faq.md) toomake, zda nejsou některé běžné problémy s konfigurací hello vyskytují.</span><span class="sxs-lookup"><span data-stu-id="2f338-113">We also strongly recommend that you review hello [Azure Backup service FAQ](backup-azure-backup-faq.md) toomake sure you're not experiencing any of hello common configuration issues.</span></span>

[!INCLUDE [support-disclaimer](../../includes/support-disclaimer.md)]

<a id="cause1"></a>

## <a name="cause-performance-bottlenecks-on-hello-computer"></a><span data-ttu-id="2f338-114">Příčina: Kritické body v počítači hello</span><span class="sxs-lookup"><span data-stu-id="2f338-114">Cause: Performance bottlenecks on hello computer</span></span>
<span data-ttu-id="2f338-115">Kritická místa hello počítače, který je zálohovaných může způsobit zpoždění.</span><span class="sxs-lookup"><span data-stu-id="2f338-115">Bottlenecks on hello computer that's being backed up can cause delays.</span></span> <span data-ttu-id="2f338-116">Například hello počítače možnost tooread nebo zápisu toodisk nebo dostupnou šířku pásma toosend data přes síť hello mohou způsobit kritická místa.</span><span class="sxs-lookup"><span data-stu-id="2f338-116">For example, hello computer's ability tooread or write toodisk, or available bandwidth toosend data over hello network, can cause bottlenecks.</span></span>

<span data-ttu-id="2f338-117">Systém Windows nabízí integrované nástroj, který se nazývá [sledování výkonu](https://technet.microsoft.com/magazine/2008.08.pulse.aspx) toodetect (Perfmon) tyto kritická místa.</span><span class="sxs-lookup"><span data-stu-id="2f338-117">Windows provides a built-in tool that's called [Performance Monitor](https://technet.microsoft.com/magazine/2008.08.pulse.aspx) (Perfmon) toodetect these bottlenecks.</span></span>

<span data-ttu-id="2f338-118">Tady jsou některé čítače výkonu a rozsahy, které může být užitečné při diagnostikování kritická místa pro optimální zálohy.</span><span class="sxs-lookup"><span data-stu-id="2f338-118">Here are some performance counters and ranges that can be helpful in diagnosing bottlenecks for optimal backups.</span></span>

| <span data-ttu-id="2f338-119">Čítač</span><span class="sxs-lookup"><span data-stu-id="2f338-119">Counter</span></span> | <span data-ttu-id="2f338-120">Status</span><span class="sxs-lookup"><span data-stu-id="2f338-120">Status</span></span> |
| --- | --- |
| <span data-ttu-id="2f338-121">Logický Disk (fyzického disku)--% nečinnosti</span><span class="sxs-lookup"><span data-stu-id="2f338-121">Logical Disk(Physical Disk)--%idle</span></span> |<span data-ttu-id="2f338-122">• 100 % nečinnosti too50 % nečinnosti = stavu v pořádku</span><span class="sxs-lookup"><span data-stu-id="2f338-122">• 100% idle too50% idle = Healthy</span></span></br><span data-ttu-id="2f338-123">• 49 % nečinnosti too20 % nečinnosti = upozornění nebo monitorování</span><span class="sxs-lookup"><span data-stu-id="2f338-123">• 49% idle too20% idle = Warning or Monitor</span></span></br><span data-ttu-id="2f338-124">• nečinnosti too0 19 % % nečinnosti = kritický nebo mimo specifikace</span><span class="sxs-lookup"><span data-stu-id="2f338-124">• 19% idle too0% idle = Critical or Out of Spec</span></span> |
| <span data-ttu-id="2f338-125">Logický Disk (fyzického disku)--% střední Doba disku čtení nebo zápisu</span><span class="sxs-lookup"><span data-stu-id="2f338-125">Logical Disk(Physical Disk)--%Avg. Disk Sec Read or Write</span></span> |<span data-ttu-id="2f338-126">• 0,001 ms too0.015 ms = stavu v pořádku</span><span class="sxs-lookup"><span data-stu-id="2f338-126">• 0.001 ms too0.015 ms  = Healthy</span></span></br><span data-ttu-id="2f338-127">• 0,015 ms too0.025 ms = upozornění nebo monitorování</span><span class="sxs-lookup"><span data-stu-id="2f338-127">• 0.015 ms too0.025 ms = Warning or Monitor</span></span></br><span data-ttu-id="2f338-128">• 0.026 ms nebo již = kritický nebo mimo specifikace</span><span class="sxs-lookup"><span data-stu-id="2f338-128">• 0.026 ms or longer = Critical or Out of Spec</span></span> |
| <span data-ttu-id="2f338-129">Logický Disk (fyzického disku)--aktuální délka fronty disku (pro všechny instance)</span><span class="sxs-lookup"><span data-stu-id="2f338-129">Logical Disk(Physical Disk)--Current Disk Queue Length (for all instances)</span></span> |<span data-ttu-id="2f338-130">80 požadavků po dobu více než 6 minut</span><span class="sxs-lookup"><span data-stu-id="2f338-130">80 requests for more than 6 minutes</span></span> |
| <span data-ttu-id="2f338-131">Paměť – bajty stránkovaného fondu jiný</span><span class="sxs-lookup"><span data-stu-id="2f338-131">Memory--Pool Non Paged Bytes</span></span> |<span data-ttu-id="2f338-132">• Méně než 60 % fondu spotřebované = stavu v pořádku</span><span class="sxs-lookup"><span data-stu-id="2f338-132">• Less than 60% of pool consumed = Healthy</span></span><br><span data-ttu-id="2f338-133">• 61 % too80 % fondu spotřebované = upozornění nebo monitorování</span><span class="sxs-lookup"><span data-stu-id="2f338-133">• 61% too80% of pool consumed = Warning or Monitor</span></span></br><span data-ttu-id="2f338-134">• Větší než 80 % fondu spotřebované = kritický nebo mimo specifikace</span><span class="sxs-lookup"><span data-stu-id="2f338-134">• Greater than 80% pool consumed = Critical or Out of Spec</span></span> |
| <span data-ttu-id="2f338-135">Paměť – bajty stránkovaného fondu</span><span class="sxs-lookup"><span data-stu-id="2f338-135">Memory--Pool Paged Bytes</span></span> |<span data-ttu-id="2f338-136">• Méně než 60 % fondu spotřebované = stavu v pořádku</span><span class="sxs-lookup"><span data-stu-id="2f338-136">• Less than 60% of pool consumed = Healthy</span></span></br><span data-ttu-id="2f338-137">• 61 % too80 % fondu spotřebované = upozornění nebo monitorování</span><span class="sxs-lookup"><span data-stu-id="2f338-137">• 61% too80% of pool consumed = Warning or Monitor</span></span></br><span data-ttu-id="2f338-138">• Větší než 80 % fondu spotřebované = kritický nebo mimo specifikace</span><span class="sxs-lookup"><span data-stu-id="2f338-138">• Greater than 80% pool consumed = Critical or Out of Spec</span></span> |
| <span data-ttu-id="2f338-139">Paměť – dostupný počet megabajtů</span><span class="sxs-lookup"><span data-stu-id="2f338-139">Memory--Available Megabytes</span></span> |<span data-ttu-id="2f338-140">• 50 % volné paměti k dispozici nebo více = stavu v pořádku</span><span class="sxs-lookup"><span data-stu-id="2f338-140">• 50% of free memory available or more = Healthy</span></span></br><span data-ttu-id="2f338-141">• 25 % volné paměti k dispozici = monitorování</span><span class="sxs-lookup"><span data-stu-id="2f338-141">• 25% of free memory available = Monitor</span></span></br><span data-ttu-id="2f338-142">• 10 % volné paměti k dispozici = upozornění</span><span class="sxs-lookup"><span data-stu-id="2f338-142">• 10% of free memory available = Warning</span></span></br><span data-ttu-id="2f338-143">• Méně než 100 MB nebo 5 % volné paměti k dispozici = kritický nebo mimo specifikace</span><span class="sxs-lookup"><span data-stu-id="2f338-143">• Less than 100 MB or 5% of free memory available = Critical or Out of Spec</span></span> |
| <span data-ttu-id="2f338-144">Procesor –\%času procesoru (všechny instance)</span><span class="sxs-lookup"><span data-stu-id="2f338-144">Processor--\%Processor Time (all instances)</span></span> |<span data-ttu-id="2f338-145">• Méně než 60 % spotřebované = stavu v pořádku</span><span class="sxs-lookup"><span data-stu-id="2f338-145">• Less than 60% consumed = Healthy</span></span></br><span data-ttu-id="2f338-146">• 61 % too90 % spotřebované = monitorování nebo upozornění</span><span class="sxs-lookup"><span data-stu-id="2f338-146">• 61% too90% consumed = Monitor or Caution</span></span></br><span data-ttu-id="2f338-147">• 91 % too100 % spotřebované = kritický</span><span class="sxs-lookup"><span data-stu-id="2f338-147">• 91% too100% consumed = Critical</span></span> |

> [!NOTE]
> <span data-ttu-id="2f338-148">Pokud zjistíte, že je infrastruktura hello hello který, doporučujeme, aby defragmentaci disku hello pravidelně pro lepší výkon.</span><span class="sxs-lookup"><span data-stu-id="2f338-148">If you determine that hello infrastructure is hello culprit, we recommend that you defragment hello disks regularly for better performance.</span></span>
>
>

<a id="cause2"></a>

## <a name="cause-another-process-or-antivirus-software-interfering-with-azure-backup"></a><span data-ttu-id="2f338-149">Příčina: Jiného procesu nebo antivirový software zasahovala do činnosti Azure Backup</span><span class="sxs-lookup"><span data-stu-id="2f338-149">Cause: Another process or antivirus software interfering with Azure Backup</span></span>
<span data-ttu-id="2f338-150">Jsme viděli několik instancí, kde jiné procesy v systému Windows hello negativně ovlivňovat výkon hello proces agenta Azure Backup.</span><span class="sxs-lookup"><span data-stu-id="2f338-150">We've seen several instances where other processes in hello Windows system have negatively affected performance of hello Azure Backup agent process.</span></span> <span data-ttu-id="2f338-151">Například pokud používáte agenta Azure Backup hello i jiný program tooback zálohovat data, nebo pokud je spuštěn antivirový software a má zámku na soubory toobe zálohovat, hello více uzamčení souborů může způsobit kolizí.</span><span class="sxs-lookup"><span data-stu-id="2f338-151">For example, if you use both hello Azure Backup agent and another program tooback up data, or if antivirus software is running and has a lock on files toobe backed up, hello multiple locks on files might cause contention.</span></span> <span data-ttu-id="2f338-152">V takovém případě hello zálohování může selhat nebo hello úlohy může trvat déle, než se očekávalo.</span><span class="sxs-lookup"><span data-stu-id="2f338-152">In this situation, hello backup might fail, or hello job might take longer than expected.</span></span>

<span data-ttu-id="2f338-153">Hello nejlepší doporučení v tomto scénáři se tooturn vypnout hello jiných toosee zálohovacího programu, jestli hello čas zálohování pro agenta Azure Backup hello změny.</span><span class="sxs-lookup"><span data-stu-id="2f338-153">hello best recommendation in this scenario is tooturn off hello other backup program toosee whether hello backup time for hello Azure Backup agent changes.</span></span> <span data-ttu-id="2f338-154">Obvykle, a ujistěte se, že nejsou spuštěné několik úloh zálohování na hello současně je dostatečná tooprevent je ze které mají vliv na sebe navzájem.</span><span class="sxs-lookup"><span data-stu-id="2f338-154">Usually, making sure that multiple backup jobs are not running at hello same time is sufficient tooprevent them from affecting each other.</span></span>

<span data-ttu-id="2f338-155">Pro antivirové programy, doporučujeme, abyste vyloučili hello následující soubory a umístění:</span><span class="sxs-lookup"><span data-stu-id="2f338-155">For antivirus programs, we recommend that you exclude hello following files and locations:</span></span>

* <span data-ttu-id="2f338-156">C:\Program Files\Microsoft Azure Recovery Services Agent\bin\cbengine.exe jako proces</span><span class="sxs-lookup"><span data-stu-id="2f338-156">C:\Program Files\Microsoft Azure Recovery Services Agent\bin\cbengine.exe as a process</span></span>
* <span data-ttu-id="2f338-157">Složky C:\Program Files\Microsoft Azure Recovery Services Agent\\</span><span class="sxs-lookup"><span data-stu-id="2f338-157">C:\Program Files\Microsoft Azure Recovery Services Agent\ folders</span></span>
* <span data-ttu-id="2f338-158">Cesta k pomocnému umístění (Pokud nepoužíváte hello standardní umístění)</span><span class="sxs-lookup"><span data-stu-id="2f338-158">Scratch location (if you're not using hello standard location)</span></span>

<a id="cause3"></a>

## <a name="cause-backup-agent-running-on-an-azure-virtual-machine"></a><span data-ttu-id="2f338-159">Příčina: Zálohování agenta spuštěného na virtuální počítač Azure</span><span class="sxs-lookup"><span data-stu-id="2f338-159">Cause: Backup agent running on an Azure virtual machine</span></span>
<span data-ttu-id="2f338-160">Pokud používáte hello Backup agent na virtuálním počítači, bude výkon nižší než při jeho spuštění na fyzickém počítači.</span><span class="sxs-lookup"><span data-stu-id="2f338-160">If you're running hello Backup agent on a VM, performance will be slower than when you run it on a physical machine.</span></span> <span data-ttu-id="2f338-161">Očekává se z důvodu omezení tooIOPS.</span><span class="sxs-lookup"><span data-stu-id="2f338-161">This is expected due tooIOPS limitations.</span></span>  <span data-ttu-id="2f338-162">Však můžete optimalizovat výkon hello přepínání hello datové jednotky, které jsou zálohované tooAzure Storage úrovně Premium.</span><span class="sxs-lookup"><span data-stu-id="2f338-162">However, you can optimize hello performance by switching hello data drives that are being backed up tooAzure Premium Storage.</span></span> <span data-ttu-id="2f338-163">Pracujeme na řešení tohoto problému, a oprava hello bude k dispozici v budoucí verzi.</span><span class="sxs-lookup"><span data-stu-id="2f338-163">We're working on fixing this issue, and hello fix will be available in a future release.</span></span>

<a id="cause4"></a>

## <a name="cause-backing-up-a-large-number-millions-of-files"></a><span data-ttu-id="2f338-164">Příčina: Zálohování velký počet (miliony) souborů</span><span class="sxs-lookup"><span data-stu-id="2f338-164">Cause: Backing up a large number (millions) of files</span></span>
<span data-ttu-id="2f338-165">Přesunutí velký objem dat bude trvat déle než přesouvání menší objem dat.</span><span class="sxs-lookup"><span data-stu-id="2f338-165">Moving a large volume of data will take longer than moving a smaller volume of data.</span></span> <span data-ttu-id="2f338-166">V některých případech je čas zálohování související toonot pouze hello velikost hello data, ale také počet hello soubory nebo složky.</span><span class="sxs-lookup"><span data-stu-id="2f338-166">In some cases, backup time is related toonot only hello size of hello data, but also hello number of files or folders.</span></span> <span data-ttu-id="2f338-167">To platí hlavně při milióny malých souborů (několik tooa bajtů několika kilobajtů) jsou zálohovány.</span><span class="sxs-lookup"><span data-stu-id="2f338-167">This is especially true when millions of small files (a few bytes tooa few kilobytes) are being backed up.</span></span>

<span data-ttu-id="2f338-168">K tomuto chování dochází, protože když jste zálohování dat hello a přesunutím tooAzure, Azure je současně katalogizaci vaše soubory.</span><span class="sxs-lookup"><span data-stu-id="2f338-168">This behavior occurs because while you're backing up hello data and moving it tooAzure, Azure is simultaneously cataloging your files.</span></span> <span data-ttu-id="2f338-169">V některých scénářích výjimečných hello katalogu operace může trvat déle než obvykle.</span><span class="sxs-lookup"><span data-stu-id="2f338-169">In some rare scenarios, hello catalog operation might take longer than expected.</span></span>

<span data-ttu-id="2f338-170">Hello následující ukazatele vám může pomoct pochopit hello problémová místa a odpovídajícím způsobem pracovat na hello další kroky:</span><span class="sxs-lookup"><span data-stu-id="2f338-170">hello following indicators can help you understand hello bottleneck and accordingly work on hello next steps:</span></span>

* <span data-ttu-id="2f338-171">**Uživatelské rozhraní se zobrazuje průběh pro přenos dat hello**.</span><span class="sxs-lookup"><span data-stu-id="2f338-171">**UI is showing progress for hello data transfer**.</span></span> <span data-ttu-id="2f338-172">stále probíhá přenosu dat Hello.</span><span class="sxs-lookup"><span data-stu-id="2f338-172">hello data is still being transferred.</span></span> <span data-ttu-id="2f338-173">Hello šířku pásma sítě nebo hello velikost dat může být příčinou zpoždění.</span><span class="sxs-lookup"><span data-stu-id="2f338-173">hello network bandwidth or hello size of data might be causing delays.</span></span>
* <span data-ttu-id="2f338-174">**Uživatelského rozhraní není zobrazující průběh pro přenos dat hello**.</span><span class="sxs-lookup"><span data-stu-id="2f338-174">**UI is not showing progress for hello data transfer**.</span></span> <span data-ttu-id="2f338-175">Otevřete hello protokoly umístěné v C:\Microsoft Azure Recovery Services Agent\Temp a zkontrolujte hello FileProvider::EndData položku v protokolech hello.</span><span class="sxs-lookup"><span data-stu-id="2f338-175">Open hello logs located at C:\Microsoft Azure Recovery Services Agent\Temp, and then check for hello FileProvider::EndData entry in hello logs.</span></span> <span data-ttu-id="2f338-176">Tato položka označuje, že dokončení přenosu dat hello probíhá operace katalogu hello.</span><span class="sxs-lookup"><span data-stu-id="2f338-176">This entry signifies that hello data transfer finished and hello catalog operation is happening.</span></span> <span data-ttu-id="2f338-177">Nemáte zrušení úloh zálohování hello.</span><span class="sxs-lookup"><span data-stu-id="2f338-177">Don't cancel hello backup jobs.</span></span> <span data-ttu-id="2f338-178">Místo toho počkejte trochu déle toofinish operaci katalogu hello.</span><span class="sxs-lookup"><span data-stu-id="2f338-178">Instead, wait a little longer for hello catalog operation toofinish.</span></span> <span data-ttu-id="2f338-179">Pokud hello potíže potrvají, obraťte se na [podporu Azure](https://portal.azure.com/#create/Microsoft.Support).</span><span class="sxs-lookup"><span data-stu-id="2f338-179">If hello problem persists, contact [Azure support](https://portal.azure.com/#create/Microsoft.Support).</span></span>
