---
title: "Řešení potíží s pomalým zálohování souborů a složek ve službě Azure Backup | Microsoft Docs"
description: "Poskytuje pokyny k odstraňování problémů při určování příčin problémů s výkonem Azure Backup"
services: backup
documentationcenter: 
author: genlin
manager: cshepard
editor: 
ms.assetid: e379180a-db13-4e0c-90e4-28e5dd6f5b14
ms.service: backup
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/13/2017
ms.author: genli
ms.openlocfilehash: 1688846957df3fbf0df747a6cd2a94b481d851b4
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 07/11/2017
---
# <a name="troubleshoot-slow-backup-of-files-and-folders-in-azure-backup"></a><span data-ttu-id="5b757-103">Řešení potíží s pomalým zálohováním souborů a složek ve službě Azure Backup</span><span class="sxs-lookup"><span data-stu-id="5b757-103">Troubleshoot slow backup of files and folders in Azure Backup</span></span>
<span data-ttu-id="5b757-104">Tento článek obsahuje pokyny k odstraňování problémů při diagnostice příčinu pomalý výkon zálohování pro soubory a složky, pokud používáte Azure Backup.</span><span class="sxs-lookup"><span data-stu-id="5b757-104">This article provides troubleshooting guidance to help you diagnose the cause of slow backup performance for files and folders when you're using Azure Backup.</span></span> <span data-ttu-id="5b757-105">Pokud používáte Azure Backup agent k zálohování souborů, proces zálohování může trvat déle než obvykle.</span><span class="sxs-lookup"><span data-stu-id="5b757-105">When you use the Azure Backup agent to back up files, the backup process might take longer than expected.</span></span> <span data-ttu-id="5b757-106">Toto zpoždění může být způsobena jednou nebo více z následujících akcí:</span><span class="sxs-lookup"><span data-stu-id="5b757-106">This delay might be caused by one or more of the following:</span></span>

* [<span data-ttu-id="5b757-107">V počítači, který je zálohovaných existují kritické.</span><span class="sxs-lookup"><span data-stu-id="5b757-107">There are performance bottlenecks on the computer that’s being backed up.</span></span>](#cause1)
* [<span data-ttu-id="5b757-108">Jiný proces nebo antivirový software narušuje proces zálohování Azure.</span><span class="sxs-lookup"><span data-stu-id="5b757-108">Another process or antivirus software is interfering with the Azure Backup process.</span></span>](#cause2)
* [<span data-ttu-id="5b757-109">Agent zálohování je spuštěn na virtuální počítač Azure (VM).</span><span class="sxs-lookup"><span data-stu-id="5b757-109">The Backup agent is running on an Azure virtual machine (VM).</span></span>](#cause3)  
* [<span data-ttu-id="5b757-110">Zálohujete velký počet (miliony) soubory.</span><span class="sxs-lookup"><span data-stu-id="5b757-110">You're backing up a large number (millions) of files.</span></span>](#cause4)

<span data-ttu-id="5b757-111">Než začnete, řešení potíží, doporučujeme stáhnout a nainstalovat [nejnovější verze agenta Azure Backup](http://aka.ms/azurebackup_agent).</span><span class="sxs-lookup"><span data-stu-id="5b757-111">Before you start troubleshooting issues, we recommend that you download and install the [latest Azure Backup agent](http://aka.ms/azurebackup_agent).</span></span> <span data-ttu-id="5b757-112">Provedeme časté aktualizace agenta zálohování různé problémy, přidat funkce, a zlepšit výkon.</span><span class="sxs-lookup"><span data-stu-id="5b757-112">We make frequent updates to the Backup agent to fix various issues, add features, and improve performance.</span></span>

<span data-ttu-id="5b757-113">Také důrazně doporučujeme, abyste si prošli [nejčastější dotazy týkající se služby Azure Backup](backup-azure-backup-faq.md) a ujistěte se, nejsou některé běžné problémy s konfigurací vyskytují.</span><span class="sxs-lookup"><span data-stu-id="5b757-113">We also strongly recommend that you review the [Azure Backup service FAQ](backup-azure-backup-faq.md) to make sure you're not experiencing any of the common configuration issues.</span></span>

[!INCLUDE [support-disclaimer](../../includes/support-disclaimer.md)]

<a id="cause1"></a>

## <a name="cause-performance-bottlenecks-on-the-computer"></a><span data-ttu-id="5b757-114">Příčina: Kritické body v počítači</span><span class="sxs-lookup"><span data-stu-id="5b757-114">Cause: Performance bottlenecks on the computer</span></span>
<span data-ttu-id="5b757-115">Kritická místa v počítači, který je zálohovaných může způsobit zpoždění.</span><span class="sxs-lookup"><span data-stu-id="5b757-115">Bottlenecks on the computer that's being backed up can cause delays.</span></span> <span data-ttu-id="5b757-116">Například počítači umožňuje čtení nebo zápisu na disk nebo dostupnou šířku pásma k odesílání dat přes síť, může způsobit kritická místa.</span><span class="sxs-lookup"><span data-stu-id="5b757-116">For example, the computer's ability to read or write to disk, or available bandwidth to send data over the network, can cause bottlenecks.</span></span>

<span data-ttu-id="5b757-117">Systém Windows nabízí integrované nástroj, který se nazývá [sledování výkonu](https://technet.microsoft.com/magazine/2008.08.pulse.aspx) (Perfmon) ke zjištění těchto kritická místa.</span><span class="sxs-lookup"><span data-stu-id="5b757-117">Windows provides a built-in tool that's called [Performance Monitor](https://technet.microsoft.com/magazine/2008.08.pulse.aspx) (Perfmon) to detect these bottlenecks.</span></span>

<span data-ttu-id="5b757-118">Tady jsou některé čítače výkonu a rozsahy, které může být užitečné při diagnostikování kritická místa pro optimální zálohy.</span><span class="sxs-lookup"><span data-stu-id="5b757-118">Here are some performance counters and ranges that can be helpful in diagnosing bottlenecks for optimal backups.</span></span>

| <span data-ttu-id="5b757-119">Čítač</span><span class="sxs-lookup"><span data-stu-id="5b757-119">Counter</span></span> | <span data-ttu-id="5b757-120">Status</span><span class="sxs-lookup"><span data-stu-id="5b757-120">Status</span></span> |
| --- | --- |
| <span data-ttu-id="5b757-121">Logický Disk (fyzického disku)--% nečinnosti</span><span class="sxs-lookup"><span data-stu-id="5b757-121">Logical Disk(Physical Disk)--%idle</span></span> |<span data-ttu-id="5b757-122">• 100 % nečinnosti na 50 % nečinnosti = stavu v pořádku</span><span class="sxs-lookup"><span data-stu-id="5b757-122">• 100% idle to 50% idle = Healthy</span></span></br><span data-ttu-id="5b757-123">• 49 % nečinnosti 20 % nečinnosti = upozornění nebo monitorování</span><span class="sxs-lookup"><span data-stu-id="5b757-123">• 49% idle to 20% idle = Warning or Monitor</span></span></br><span data-ttu-id="5b757-124">• 19 % nečinnosti 0 % nečinnosti = kritický nebo mimo specifikace</span><span class="sxs-lookup"><span data-stu-id="5b757-124">• 19% idle to 0% idle = Critical or Out of Spec</span></span> |
| <span data-ttu-id="5b757-125">Logický Disk (fyzického disku)--% střední</span><span class="sxs-lookup"><span data-stu-id="5b757-125">Logical Disk(Physical Disk)--%Avg.</span></span> <span data-ttu-id="5b757-126">Doba disku čtení nebo zápisu</span><span class="sxs-lookup"><span data-stu-id="5b757-126">Disk Sec Read or Write</span></span> |<span data-ttu-id="5b757-127">• 0,001 ms k 0,015 ms = stavu v pořádku</span><span class="sxs-lookup"><span data-stu-id="5b757-127">• 0.001 ms to 0.015 ms  = Healthy</span></span></br><span data-ttu-id="5b757-128">• 0,015 ms na 0,025 ms = upozornění nebo monitorování</span><span class="sxs-lookup"><span data-stu-id="5b757-128">• 0.015 ms to 0.025 ms = Warning or Monitor</span></span></br><span data-ttu-id="5b757-129">• 0.026 ms nebo již = kritický nebo mimo specifikace</span><span class="sxs-lookup"><span data-stu-id="5b757-129">• 0.026 ms or longer = Critical or Out of Spec</span></span> |
| <span data-ttu-id="5b757-130">Logický Disk (fyzického disku)--aktuální délka fronty disku (pro všechny instance)</span><span class="sxs-lookup"><span data-stu-id="5b757-130">Logical Disk(Physical Disk)--Current Disk Queue Length (for all instances)</span></span> |<span data-ttu-id="5b757-131">80 požadavků po dobu více než 6 minut</span><span class="sxs-lookup"><span data-stu-id="5b757-131">80 requests for more than 6 minutes</span></span> |
| <span data-ttu-id="5b757-132">Paměť – bajty stránkovaného fondu jiný</span><span class="sxs-lookup"><span data-stu-id="5b757-132">Memory--Pool Non Paged Bytes</span></span> |<span data-ttu-id="5b757-133">• Méně než 60 % fondu spotřebované = stavu v pořádku</span><span class="sxs-lookup"><span data-stu-id="5b757-133">• Less than 60% of pool consumed = Healthy</span></span><br><span data-ttu-id="5b757-134">• 61 % až 80 % fondu spotřebované = upozornění nebo monitorování</span><span class="sxs-lookup"><span data-stu-id="5b757-134">• 61% to 80% of pool consumed = Warning or Monitor</span></span></br><span data-ttu-id="5b757-135">• Větší než 80 % fondu spotřebované = kritický nebo mimo specifikace</span><span class="sxs-lookup"><span data-stu-id="5b757-135">• Greater than 80% pool consumed = Critical or Out of Spec</span></span> |
| <span data-ttu-id="5b757-136">Paměť – bajty stránkovaného fondu</span><span class="sxs-lookup"><span data-stu-id="5b757-136">Memory--Pool Paged Bytes</span></span> |<span data-ttu-id="5b757-137">• Méně než 60 % fondu spotřebované = stavu v pořádku</span><span class="sxs-lookup"><span data-stu-id="5b757-137">• Less than 60% of pool consumed = Healthy</span></span></br><span data-ttu-id="5b757-138">• 61 % až 80 % fondu spotřebované = upozornění nebo monitorování</span><span class="sxs-lookup"><span data-stu-id="5b757-138">• 61% to 80% of pool consumed = Warning or Monitor</span></span></br><span data-ttu-id="5b757-139">• Větší než 80 % fondu spotřebované = kritický nebo mimo specifikace</span><span class="sxs-lookup"><span data-stu-id="5b757-139">• Greater than 80% pool consumed = Critical or Out of Spec</span></span> |
| <span data-ttu-id="5b757-140">Paměť – dostupný počet megabajtů</span><span class="sxs-lookup"><span data-stu-id="5b757-140">Memory--Available Megabytes</span></span> |<span data-ttu-id="5b757-141">• 50 % volné paměti k dispozici nebo více = stavu v pořádku</span><span class="sxs-lookup"><span data-stu-id="5b757-141">• 50% of free memory available or more = Healthy</span></span></br><span data-ttu-id="5b757-142">• 25 % volné paměti k dispozici = monitorování</span><span class="sxs-lookup"><span data-stu-id="5b757-142">• 25% of free memory available = Monitor</span></span></br><span data-ttu-id="5b757-143">• 10 % volné paměti k dispozici = upozornění</span><span class="sxs-lookup"><span data-stu-id="5b757-143">• 10% of free memory available = Warning</span></span></br><span data-ttu-id="5b757-144">• Méně než 100 MB nebo 5 % volné paměti k dispozici = kritický nebo mimo specifikace</span><span class="sxs-lookup"><span data-stu-id="5b757-144">• Less than 100 MB or 5% of free memory available = Critical or Out of Spec</span></span> |
| <span data-ttu-id="5b757-145">Procesor –\%času procesoru (všechny instance)</span><span class="sxs-lookup"><span data-stu-id="5b757-145">Processor--\%Processor Time (all instances)</span></span> |<span data-ttu-id="5b757-146">• Méně než 60 % spotřebované = stavu v pořádku</span><span class="sxs-lookup"><span data-stu-id="5b757-146">• Less than 60% consumed = Healthy</span></span></br><span data-ttu-id="5b757-147">• 61 % až 90 % spotřebované = monitorování nebo upozornění</span><span class="sxs-lookup"><span data-stu-id="5b757-147">• 61% to 90% consumed = Monitor or Caution</span></span></br><span data-ttu-id="5b757-148">• 91 až 100 % spotřebované = kritický</span><span class="sxs-lookup"><span data-stu-id="5b757-148">• 91% to 100% consumed = Critical</span></span> |

> [!NOTE]
> <span data-ttu-id="5b757-149">Pokud zjistíte, že infrastruktury který, doporučujeme defragmentaci disky pravidelně pro lepší výkon.</span><span class="sxs-lookup"><span data-stu-id="5b757-149">If you determine that the infrastructure is the culprit, we recommend that you defragment the disks regularly for better performance.</span></span>
>
>

<a id="cause2"></a>

## <a name="cause-another-process-or-antivirus-software-interfering-with-azure-backup"></a><span data-ttu-id="5b757-150">Příčina: Jiného procesu nebo antivirový software zasahovala do činnosti Azure Backup</span><span class="sxs-lookup"><span data-stu-id="5b757-150">Cause: Another process or antivirus software interfering with Azure Backup</span></span>
<span data-ttu-id="5b757-151">Jsme viděli několik instancí, kde jiné procesy v systému Windows negativně ovlivňovat výkon proces agenta Azure Backup.</span><span class="sxs-lookup"><span data-stu-id="5b757-151">We've seen several instances where other processes in the Windows system have negatively affected performance of the Azure Backup agent process.</span></span> <span data-ttu-id="5b757-152">Například pokud používáte agenta Azure Backup a jinou aplikací zálohování dat, nebo pokud antivirový software běží a má zámek na soubory zálohovat, násobek zamkne na souborů může způsobit kolizí.</span><span class="sxs-lookup"><span data-stu-id="5b757-152">For example, if you use both the Azure Backup agent and another program to back up data, or if antivirus software is running and has a lock on files to be backed up, the multiple locks on files might cause contention.</span></span> <span data-ttu-id="5b757-153">V této situaci může dojít k selhání zálohování nebo úlohy může trvat déle, než se očekávalo.</span><span class="sxs-lookup"><span data-stu-id="5b757-153">In this situation, the backup might fail, or the job might take longer than expected.</span></span>

<span data-ttu-id="5b757-154">Nejlepší doporučení v tomto scénáři je vypnout jinou zálohování aplikaci a zkontrolujte, zda změnil čas zálohování pro Azure Backup agent.</span><span class="sxs-lookup"><span data-stu-id="5b757-154">The best recommendation in this scenario is to turn off the other backup program to see whether the backup time for the Azure Backup agent changes.</span></span> <span data-ttu-id="5b757-155">A ujistěte se, že několik úloh zálohování nejsou spuštěné ve stejnou dobu je obvykle, aby s nimi neovlivňovaly navzájem dostatečná.</span><span class="sxs-lookup"><span data-stu-id="5b757-155">Usually, making sure that multiple backup jobs are not running at the same time is sufficient to prevent them from affecting each other.</span></span>

<span data-ttu-id="5b757-156">Pro antivirové programy doporučujeme, abyste vyloučili následující soubory a umístění:</span><span class="sxs-lookup"><span data-stu-id="5b757-156">For antivirus programs, we recommend that you exclude the following files and locations:</span></span>

* <span data-ttu-id="5b757-157">C:\Program Files\Microsoft Azure Recovery Services Agent\bin\cbengine.exe jako proces</span><span class="sxs-lookup"><span data-stu-id="5b757-157">C:\Program Files\Microsoft Azure Recovery Services Agent\bin\cbengine.exe as a process</span></span>
* <span data-ttu-id="5b757-158">Složky C:\Program Files\Microsoft Azure Recovery Services Agent\\</span><span class="sxs-lookup"><span data-stu-id="5b757-158">C:\Program Files\Microsoft Azure Recovery Services Agent\ folders</span></span>
* <span data-ttu-id="5b757-159">Cesta k pomocnému umístění (Pokud nepoužíváte standardní umístění)</span><span class="sxs-lookup"><span data-stu-id="5b757-159">Scratch location (if you're not using the standard location)</span></span>

<a id="cause3"></a>

## <a name="cause-backup-agent-running-on-an-azure-virtual-machine"></a><span data-ttu-id="5b757-160">Příčina: Zálohování agenta spuštěného na virtuální počítač Azure</span><span class="sxs-lookup"><span data-stu-id="5b757-160">Cause: Backup agent running on an Azure virtual machine</span></span>
<span data-ttu-id="5b757-161">Pokud používáte agenta zálohování na virtuálním počítači, bude výkon nižší než při jeho spuštění na fyzickém počítači.</span><span class="sxs-lookup"><span data-stu-id="5b757-161">If you're running the Backup agent on a VM, performance will be slower than when you run it on a physical machine.</span></span> <span data-ttu-id="5b757-162">Očekává se z důvodu omezení IOPS.</span><span class="sxs-lookup"><span data-stu-id="5b757-162">This is expected due to IOPS limitations.</span></span>  <span data-ttu-id="5b757-163">Však můžete optimalizovat výkon přepínání datových jednotkách, které jsou zálohovány do služby Azure Premium Storage.</span><span class="sxs-lookup"><span data-stu-id="5b757-163">However, you can optimize the performance by switching the data drives that are being backed up to Azure Premium Storage.</span></span> <span data-ttu-id="5b757-164">Pracujeme na řešení tohoto problému a opravu bude k dispozici v budoucí verzi.</span><span class="sxs-lookup"><span data-stu-id="5b757-164">We're working on fixing this issue, and the fix will be available in a future release.</span></span>

<a id="cause4"></a>

## <a name="cause-backing-up-a-large-number-millions-of-files"></a><span data-ttu-id="5b757-165">Příčina: Zálohování velký počet (miliony) souborů</span><span class="sxs-lookup"><span data-stu-id="5b757-165">Cause: Backing up a large number (millions) of files</span></span>
<span data-ttu-id="5b757-166">Přesunutí velký objem dat bude trvat déle než přesouvání menší objem dat.</span><span class="sxs-lookup"><span data-stu-id="5b757-166">Moving a large volume of data will take longer than moving a smaller volume of data.</span></span> <span data-ttu-id="5b757-167">V některých případech se týká čas zálohování nejen velikost dat, ale také počet soubory nebo složky.</span><span class="sxs-lookup"><span data-stu-id="5b757-167">In some cases, backup time is related to not only the size of the data, but also the number of files or folders.</span></span> <span data-ttu-id="5b757-168">To platí hlavně když probíhá zálohování milióny malých souborů (několik bajty k několika kilobajtů).</span><span class="sxs-lookup"><span data-stu-id="5b757-168">This is especially true when millions of small files (a few bytes to a few kilobytes) are being backed up.</span></span>

<span data-ttu-id="5b757-169">K tomuto chování dochází, protože když jste zálohování dat a ani ji přesunout do Azure, Azure je současně katalogizaci vaše soubory.</span><span class="sxs-lookup"><span data-stu-id="5b757-169">This behavior occurs because while you're backing up the data and moving it to Azure, Azure is simultaneously cataloging your files.</span></span> <span data-ttu-id="5b757-170">V některých scénářích výjimečných operace katalogu může trvat déle než obvykle.</span><span class="sxs-lookup"><span data-stu-id="5b757-170">In some rare scenarios, the catalog operation might take longer than expected.</span></span>

<span data-ttu-id="5b757-171">Následující ukazatele vám může pomoct pochopit kritická místa a odpovídajícím způsobem pracovat na další kroky:</span><span class="sxs-lookup"><span data-stu-id="5b757-171">The following indicators can help you understand the bottleneck and accordingly work on the next steps:</span></span>

* <span data-ttu-id="5b757-172">**Uživatelské rozhraní se zobrazuje průběh pro přenos dat**.</span><span class="sxs-lookup"><span data-stu-id="5b757-172">**UI is showing progress for the data transfer**.</span></span> <span data-ttu-id="5b757-173">Data se stále přenosu.</span><span class="sxs-lookup"><span data-stu-id="5b757-173">The data is still being transferred.</span></span> <span data-ttu-id="5b757-174">Šířku pásma sítě nebo velikosti dat může být příčinou zpoždění.</span><span class="sxs-lookup"><span data-stu-id="5b757-174">The network bandwidth or the size of data might be causing delays.</span></span>
* <span data-ttu-id="5b757-175">**Uživatelského rozhraní není zobrazující průběh pro přenos dat**.</span><span class="sxs-lookup"><span data-stu-id="5b757-175">**UI is not showing progress for the data transfer**.</span></span> <span data-ttu-id="5b757-176">Otevřete protokoly umístěnými na C:\Microsoft Azure Recovery Services Agent\Temp a pak vyhledejte položku FileProvider::EndData v protokolech.</span><span class="sxs-lookup"><span data-stu-id="5b757-176">Open the logs located at C:\Microsoft Azure Recovery Services Agent\Temp, and then check for the FileProvider::EndData entry in the logs.</span></span> <span data-ttu-id="5b757-177">Tato položka označuje, že přenos dat bylo dokončeno probíhá operace katalogu.</span><span class="sxs-lookup"><span data-stu-id="5b757-177">This entry signifies that the data transfer finished and the catalog operation is happening.</span></span> <span data-ttu-id="5b757-178">Nemáte zrušení úloh zálohování.</span><span class="sxs-lookup"><span data-stu-id="5b757-178">Don't cancel the backup jobs.</span></span> <span data-ttu-id="5b757-179">Místo toho počkejte trochu déle na dokončení operace katalogu.</span><span class="sxs-lookup"><span data-stu-id="5b757-179">Instead, wait a little longer for the catalog operation to finish.</span></span> <span data-ttu-id="5b757-180">Pokud potíže potrvají, obraťte se na [podporu Azure](https://portal.azure.com/#create/Microsoft.Support).</span><span class="sxs-lookup"><span data-stu-id="5b757-180">If the problem persists, contact [Azure support](https://portal.azure.com/#create/Microsoft.Support).</span></span>
