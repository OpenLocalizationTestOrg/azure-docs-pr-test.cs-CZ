---
title: "aaaPlanning infrastruktury zálohování virtuálních počítačů v Azure | Microsoft Docs"
description: "Je důležité zvážit při plánování tooback až virtuálních počítačů v Azure"
services: backup
documentationcenter: 
author: markgalioto
manager: carmonm
editor: 
keywords: "zálohování virtuálních počítačů, zálohování virtuálních počítačů"
ms.assetid: 19d2cf82-1f60-43e1-b089-9238042887a9
ms.service: backup
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 7/18/2017
ms.author: markgal;trinadhk
ms.openlocfilehash: d11982431610000293038ee6aa7df8e7bc2d8b70
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="plan-your-vm-backup-infrastructure-in-azure"></a><span data-ttu-id="4f81a-104">Plánování infrastruktury zálohování virtuálních počítačů v Azure</span><span class="sxs-lookup"><span data-stu-id="4f81a-104">Plan your VM backup infrastructure in Azure</span></span>
<span data-ttu-id="4f81a-105">Tento článek obsahuje výkonu a prostředků návrhy toohelp plánování vaší infrastruktury zálohování virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="4f81a-105">This article provides performance and resource suggestions toohelp you plan your VM backup infrastructure.</span></span> <span data-ttu-id="4f81a-106">Definuje také klíčových aspektů služby zálohování hello; Tyto aspekty může být velmi důležité při určování vaší architektury plánování kapacity a plánování.</span><span class="sxs-lookup"><span data-stu-id="4f81a-106">It also defines key aspects of hello Backup service; these aspects can be critical in determining your architecture, capacity planning, and scheduling.</span></span> <span data-ttu-id="4f81a-107">Pokud jste [připravit vaše prostředí](backup-azure-vms-prepare.md), je dalším krokem hello plánování před zahájením [tooback až virtuálních počítačů](backup-azure-vms.md).</span><span class="sxs-lookup"><span data-stu-id="4f81a-107">If you've [prepared your environment](backup-azure-vms-prepare.md), planning is hello next step before you begin [tooback up VMs](backup-azure-vms.md).</span></span> <span data-ttu-id="4f81a-108">Pokud potřebujete další informace o virtuálních počítačích Azure, najdete v části hello [virtuální počítače dokumentaci](https://azure.microsoft.com/documentation/services/virtual-machines/).</span><span class="sxs-lookup"><span data-stu-id="4f81a-108">If you need more information about Azure virtual machines, see hello [Virtual Machines documentation](https://azure.microsoft.com/documentation/services/virtual-machines/).</span></span>

## <a name="how-does-azure-back-up-virtual-machines"></a><span data-ttu-id="4f81a-109">Jak funguje Azure zálohuje virtuální počítače?</span><span class="sxs-lookup"><span data-stu-id="4f81a-109">How does Azure back up virtual machines?</span></span>
<span data-ttu-id="4f81a-110">V případě hello služba Azure Backup zahájí během hello naplánované úlohy zálohování, aktivuje hello rozšíření zálohování tootake snímku v daném okamžiku.</span><span class="sxs-lookup"><span data-stu-id="4f81a-110">When hello Azure Backup service initiates a backup job at hello scheduled time, it triggers hello backup extension tootake a point-in-time snapshot.</span></span> <span data-ttu-id="4f81a-111">Hello služby Azure Backup používá hello _VMSnapshot_ rozšíření v systému Windows a hello _VMSnapshotLinux_ rozšíření v systému Linux.</span><span class="sxs-lookup"><span data-stu-id="4f81a-111">hello Azure Backup service uses hello _VMSnapshot_ extension in Windows, and hello _VMSnapshotLinux_ extension in Linux.</span></span> <span data-ttu-id="4f81a-112">rozšíření Hello je nainstalován během hello první zálohování virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="4f81a-112">hello extension is installed during hello first VM backup.</span></span> <span data-ttu-id="4f81a-113">rozšíření hello tooinstall, musí být spuštěna hello virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="4f81a-113">tooinstall hello extension, hello VM must be running.</span></span> <span data-ttu-id="4f81a-114">Pokud hello virtuální počítač není spuštěný, hello služby zálohování pořídí snímek hello základní úložiště (protože žádné zápisy aplikace dochází při hello zastavení virtuálního počítače).</span><span class="sxs-lookup"><span data-stu-id="4f81a-114">If hello VM is not running, hello Backup service takes a snapshot of hello underlying storage (since no application writes occur while hello VM is stopped).</span></span>

<span data-ttu-id="4f81a-115">Při pořizování snímku virtuálních počítačů Windows, služba Backup hello koordinuje pomocí služby Stínová kopie svazku (VSS) tooget hello konzistentního snímku disky hello virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="4f81a-115">When taking a snapshot of Windows VMs, hello Backup service coordinates with hello Volume Shadow Copy Service (VSS) tooget a consistent snapshot of hello virtual machine's disks.</span></span> <span data-ttu-id="4f81a-116">Pokud zálohujete virtuální počítače s Linuxem, můžete napsat vlastní vlastní skripty tooensure konzistence při pořizování snímku virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="4f81a-116">If you're backing up Linux VMs, you can write your own custom scripts tooensure consistency when taking a VM snapshot.</span></span> <span data-ttu-id="4f81a-117">Podrobnosti o vyvolání tyto skripty jsou uvedeny dále v tomto článku.</span><span class="sxs-lookup"><span data-stu-id="4f81a-117">Details on invoking these scripts are provided later in this article.</span></span>

<span data-ttu-id="4f81a-118">Jakmile hello služby Azure Backup používá hello snímku, je hello data přenášená toohello trezoru.</span><span class="sxs-lookup"><span data-stu-id="4f81a-118">Once hello Azure Backup service takes hello snapshot, hello data is transferred toohello vault.</span></span> <span data-ttu-id="4f81a-119">toomaximize efektivitu, služba hello identifikuje a přenáší pouze hello bloky dat, které se změnily od hello předchozí zálohy.</span><span class="sxs-lookup"><span data-stu-id="4f81a-119">toomaximize efficiency, hello service identifies and transfers only hello blocks of data that have changed since hello previous backup.</span></span>

![Architektura zálohování virtuálního počítače Azure](./media/backup-azure-vms-introduction/vmbackup-architecture.png)

<span data-ttu-id="4f81a-121">Po dokončení přenosu dat hello hello snímek odebrán a vytvoří bod obnovení.</span><span class="sxs-lookup"><span data-stu-id="4f81a-121">When hello data transfer is complete, hello snapshot is removed and a recovery point is created.</span></span>

> [!NOTE]
> 1. <span data-ttu-id="4f81a-122">Během procesu zálohování hello Azure Backup neobsahuje hello dočasné disk připojený toohello virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="4f81a-122">During hello backup process, Azure Backup doesn't include hello temporary disk attached toohello virtual machine.</span></span> <span data-ttu-id="4f81a-123">Další informace najdete v tématu hello blog na [dočasné úložiště](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/).</span><span class="sxs-lookup"><span data-stu-id="4f81a-123">For more information, see hello blog on [temporary storage](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/).</span></span>
> 2. <span data-ttu-id="4f81a-124">Vzhledem k tomu, že Azure Backup používá úroveň úložiště snímků a přenosy, které snímku toovault, neměňte hello klíče účtu úložiště, až do dokončení úlohy zálohování hello.</span><span class="sxs-lookup"><span data-stu-id="4f81a-124">Since Azure Backup takes a storage-level snapshot and transfers that snapshot toovault, do not change hello storage account keys until hello backup job finishes.</span></span>
> 3. <span data-ttu-id="4f81a-125">U virtuálních počítačů premium jsme zkopírujte hello snímku toostorage účtu.</span><span class="sxs-lookup"><span data-stu-id="4f81a-125">For premium VMs, we copy hello snapshot toostorage account.</span></span> <span data-ttu-id="4f81a-126">Toto je toomake jistotu, že služba Azure Backup získá dostatečná IOPS pro přenos dat toovault.</span><span class="sxs-lookup"><span data-stu-id="4f81a-126">This is toomake sure that Azure Backup service gets sufficient IOPS for transferring data toovault.</span></span> <span data-ttu-id="4f81a-127">Tato další kopie úložiště je účtovat podle hello přidělené velikost virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="4f81a-127">This additional copy of storage is charged as per hello VM allocated size.</span></span> 
>

### <a name="data-consistency"></a><span data-ttu-id="4f81a-128">Konzistence dat</span><span class="sxs-lookup"><span data-stu-id="4f81a-128">Data consistency</span></span>
<span data-ttu-id="4f81a-129">Zálohování a obnovení důležitá obchodní data ztěžuje hello skutečnost, že při hello aplikace, které vytvářejí hello dat běží, je třeba zálohovat důležitá obchodní data.</span><span class="sxs-lookup"><span data-stu-id="4f81a-129">Backing up and restoring business critical data is complicated by hello fact that business critical data must be backed up while hello applications that produce hello data are running.</span></span> <span data-ttu-id="4f81a-130">tooaddress se Azure Backup podporuje zálohování konzistentní s aplikací pro Windows a virtuální počítače s Linuxem</span><span class="sxs-lookup"><span data-stu-id="4f81a-130">tooaddress this, Azure Backup supports application-consistent backups for both Windows and Linux VMs</span></span>
#### <a name="windows-vm"></a><span data-ttu-id="4f81a-131">Virtuální počítač s Windows</span><span class="sxs-lookup"><span data-stu-id="4f81a-131">Windows VM</span></span>
<span data-ttu-id="4f81a-132">Zálohování Azure trvá úplné zálohování VSS na virtuálních počítačích systému Windows (Další informace o [úplné zálohování VSS](http://blogs.technet.com/b/filecab/archive/2008/05/21/what-is-the-difference-between-vss-full-backup-and-vss-copy-backup-in-windows-server-2008.aspx)).</span><span class="sxs-lookup"><span data-stu-id="4f81a-132">Azure Backup takes VSS full backups on Windows VMs (read more about [VSS full backup](http://blogs.technet.com/b/filecab/archive/2008/05/21/what-is-the-difference-between-vss-full-backup-and-vss-copy-backup-in-windows-server-2008.aspx)).</span></span> <span data-ttu-id="4f81a-133">tooenable kopie zálohy VSS, hello následující sadě toobe potřebám klíče registru na hello virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="4f81a-133">tooenable VSS copy backups, hello following registry key needs toobe set on hello VM.</span></span>

```
[HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\BCDRAGENT]
"USEVSSCOPYBACKUP"="TRUE"
```

#### <a name="linux-vms"></a><span data-ttu-id="4f81a-134">Virtuální počítače s Linuxem</span><span class="sxs-lookup"><span data-stu-id="4f81a-134">Linux VMs</span></span>
<span data-ttu-id="4f81a-135">Azure Backup poskytuje skriptovací rozhraní.</span><span class="sxs-lookup"><span data-stu-id="4f81a-135">Azure Backup provides a scripting framework.</span></span> <span data-ttu-id="4f81a-136">konzistence aplikací tooensure při zálohování virtuálních počítačů Linux, vytvořte vlastní skripty před a po skripty, které řídí hello zálohování workflow a prostředí.</span><span class="sxs-lookup"><span data-stu-id="4f81a-136">tooensure application consistency when backing up Linux VMs, create custom pre-scripts and post-scripts that control hello backup workflow and environment.</span></span> <span data-ttu-id="4f81a-137">Zálohování Azure vyvolá hello předběžné skript před přepnutím hello snímku virtuálního počítače a vyvolá hello po skript po dokončení hello úlohu snímku virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="4f81a-137">Azure Backup invokes hello pre-script before taking hello VM snapshot and invokes hello post-script once hello VM snapshot job completes.</span></span> <span data-ttu-id="4f81a-138">Další podrobnosti najdete v tématu [konzistentní zálohování virtuálních počítačů aplikace pomocí skriptů před a po skript](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span><span class="sxs-lookup"><span data-stu-id="4f81a-138">For more details, see [application consistent VM backups using pre-script and post-script](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span></span>
> [!NOTE]
> <span data-ttu-id="4f81a-139">Zálohování Azure pouze vyvolá hello zapsána zákazníka před a po skripty.</span><span class="sxs-lookup"><span data-stu-id="4f81a-139">Azure Backup only invokes hello customer-written pre- and post-scripts.</span></span> <span data-ttu-id="4f81a-140">Pokud skript hello před a po skripty spustí úspěšně, Azure Backup označí bod obnovení hello jako aplikace konzistentní.</span><span class="sxs-lookup"><span data-stu-id="4f81a-140">If hello pre-script and post-scripts execute successfully, Azure Backup marks hello recovery point as application consistent.</span></span> <span data-ttu-id="4f81a-141">Hello zákazníka je však nakonec odpovědné za konzistence aplikace hello při použití vlastních skriptů.</span><span class="sxs-lookup"><span data-stu-id="4f81a-141">However, hello customer is ultimately responsible for hello application consistency when using custom scripts.</span></span>
>


<span data-ttu-id="4f81a-142">Tato tabulka vysvětluje hello typy konzistence a hello podmínky, že k nim dojde v části během zálohování virtuálních počítačů Azure a obnovit postupy.</span><span class="sxs-lookup"><span data-stu-id="4f81a-142">This table explains hello types of consistency and hello conditions that they occur under during Azure VM backup and restore procedures.</span></span>

| <span data-ttu-id="4f81a-143">Konzistence</span><span class="sxs-lookup"><span data-stu-id="4f81a-143">Consistency</span></span> | <span data-ttu-id="4f81a-144">Na základě služby Stínová kopie svazku</span><span class="sxs-lookup"><span data-stu-id="4f81a-144">VSS-based</span></span> | <span data-ttu-id="4f81a-145">Vysvětlení a podrobnosti</span><span class="sxs-lookup"><span data-stu-id="4f81a-145">Explanation and details</span></span> |
| --- | --- | --- |
| <span data-ttu-id="4f81a-146">Konzistentnost aplikací</span><span class="sxs-lookup"><span data-stu-id="4f81a-146">Application consistency</span></span> |<span data-ttu-id="4f81a-147">Ano pro Windows</span><span class="sxs-lookup"><span data-stu-id="4f81a-147">Yes for Windows</span></span>|<span data-ttu-id="4f81a-148">Aplikace konzistence je ideální pro úlohy, protože zajišťuje, že:</span><span class="sxs-lookup"><span data-stu-id="4f81a-148">Application consistency is ideal for workloads as it ensures that:</span></span><ol><li> <span data-ttu-id="4f81a-149">Hello virtuálních počítačů *spustí*.</span><span class="sxs-lookup"><span data-stu-id="4f81a-149">hello VM *boots up*.</span></span> <li><span data-ttu-id="4f81a-150">Je *žádné poškození*.</span><span class="sxs-lookup"><span data-stu-id="4f81a-150">There is *no corruption*.</span></span> <li><span data-ttu-id="4f81a-151">Je *nedošlo ke ztrátě dat*.</span><span class="sxs-lookup"><span data-stu-id="4f81a-151">There is *no data loss*.</span></span><li> <span data-ttu-id="4f81a-152">Hello data je konzistentní toohello aplikace, která používá hello data podle zahrnující aplikace hello během hello zálohy – pomocí služby Stínová kopie svazku nebo předzálohovacího nebo pozálohovacího skriptu.</span><span class="sxs-lookup"><span data-stu-id="4f81a-152">hello data is consistent toohello application that uses hello data, by involving hello application at hello time of backup--using VSS or pre/post script.</span></span></ol> <li><span data-ttu-id="4f81a-153">*Virtuální počítače Windows*-úlohy nejvíce Microsoft mají zapisovače služby Stínová kopie svazku, které provádějí akce určeného pro konkrétní úlohy související toodata konzistence.</span><span class="sxs-lookup"><span data-stu-id="4f81a-153">*Windows VMs*- Most Microsoft workloads have VSS writers that do workload-specific actions related toodata consistency.</span></span> <span data-ttu-id="4f81a-154">Například Microsoft SQL Server obsahuje zapisovač VSS, které zajišťuje, aby správně provést hello zápisy toohello transakční protokol a databáze hello.</span><span class="sxs-lookup"><span data-stu-id="4f81a-154">For example, Microsoft SQL Server has a VSS writer that ensures that hello writes toohello transaction log file and hello database are done correctly.</span></span> <span data-ttu-id="4f81a-155">Pro zálohování virtuálního počítače Windows Azure, toocreate bod obnovení konzistentních s aplikací musí rozšíření zálohování hello vyvolání hello VSS pracovního postupu a dokončete ji před přepnutím hello snímku virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="4f81a-155">For Azure Windows VM backups, toocreate an application-consistent recovery point, hello backup extension must invoke hello VSS workflow and complete it before taking hello VM snapshot.</span></span> <span data-ttu-id="4f81a-156">Pro toobe snímku hello v virtuálního počítače Azure přesné musíte dokončit také zapisovače VSS hello všech aplikací virtuálního počítače Azure.</span><span class="sxs-lookup"><span data-stu-id="4f81a-156">For hello Azure VM snapshot toobe accurate, hello VSS writers of all Azure VM applications must complete as well.</span></span> <span data-ttu-id="4f81a-157">(Další hello [Základy služby Stínová kopie svazku](http://blogs.technet.com/b/josebda/archive/2007/10/10/the-basics-of-the-volume-shadow-copy-service-vss.aspx) a podrobné informace o hello podrobnosti o [jak to funguje](https://technet.microsoft.com/library/cc785914%28v=ws.10%29.aspx)).</span><span class="sxs-lookup"><span data-stu-id="4f81a-157">(Learn hello [basics of VSS](http://blogs.technet.com/b/josebda/archive/2007/10/10/the-basics-of-the-volume-shadow-copy-service-vss.aspx) and dive deep into hello details of [how it works](https://technet.microsoft.com/library/cc785914%28v=ws.10%29.aspx)).</span></span> </li> <li> <span data-ttu-id="4f81a-158">*Virtuální počítače s Linuxem*– zákazníci mohou spouštět [konzistence aplikací vlastní skript před a po skript tooensure](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span><span class="sxs-lookup"><span data-stu-id="4f81a-158">*Linux VMs*- Customers can execute [custom pre-script and post-script tooensure application consistency](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span></span> </li> |
| <span data-ttu-id="4f81a-159">Konzistence systému souborů</span><span class="sxs-lookup"><span data-stu-id="4f81a-159">File-system consistency</span></span> |<span data-ttu-id="4f81a-160">Ano – pro počítače se systémem Windows</span><span class="sxs-lookup"><span data-stu-id="4f81a-160">Yes - for Windows-based computers</span></span> |<span data-ttu-id="4f81a-161">Existují dva scénáře, kde může být bod obnovení hello *systému souborů konzistentní*:</span><span class="sxs-lookup"><span data-stu-id="4f81a-161">There are two scenarios where hello recovery point can be *file-system consistent*:</span></span><ul><li><span data-ttu-id="4f81a-162">Zálohování virtuálních počítačů Linux v Azure, bez vedlejší script nebo po script nebo pokud vedlejší script nebo po script se nezdařilo.</span><span class="sxs-lookup"><span data-stu-id="4f81a-162">Backups of Linux VMs in Azure, without pre-script/post-script or if pre-script/post-script failed.</span></span> <li><span data-ttu-id="4f81a-163">Chyba služby Stínová kopie svazku během zálohování pro virtuální počítače Windows v Azure.</span><span class="sxs-lookup"><span data-stu-id="4f81a-163">VSS failure during backup for Windows VMs in Azure.</span></span></li></ul> <span data-ttu-id="4f81a-164">V obou těchto případech je hello nejlepší, kterou lze provést tooensure který:</span><span class="sxs-lookup"><span data-stu-id="4f81a-164">In both these cases, hello best that can be done is tooensure that:</span></span> <ol><li> <span data-ttu-id="4f81a-165">Hello virtuálních počítačů *spustí*.</span><span class="sxs-lookup"><span data-stu-id="4f81a-165">hello VM *boots up*.</span></span> <li><span data-ttu-id="4f81a-166">Je *žádné poškození*.</span><span class="sxs-lookup"><span data-stu-id="4f81a-166">There is *no corruption*.</span></span><li><span data-ttu-id="4f81a-167">Je *nedošlo ke ztrátě dat*.</span><span class="sxs-lookup"><span data-stu-id="4f81a-167">There is *no data loss*.</span></span></ol> <span data-ttu-id="4f81a-168">Aplikace potřebují mechanismus tooimplement vlastní "oprava up" hello obnovit data.</span><span class="sxs-lookup"><span data-stu-id="4f81a-168">Applications need tooimplement their own "fix-up" mechanism on hello restored data.</span></span> |
| <span data-ttu-id="4f81a-169">Konzistence havárií</span><span class="sxs-lookup"><span data-stu-id="4f81a-169">Crash consistency</span></span> |<span data-ttu-id="4f81a-170">Ne</span><span class="sxs-lookup"><span data-stu-id="4f81a-170">No</span></span> |<span data-ttu-id="4f81a-171">Tato situace je ekvivalentní tooa virtuální počítač má "selhání" (prostřednictvím buď logicky nebo pevné resetování).</span><span class="sxs-lookup"><span data-stu-id="4f81a-171">This situation is equivalent tooa virtual machine experiencing a "crash" (through either a soft or hard reset).</span></span> <span data-ttu-id="4f81a-172">Konzistence havárií obvykle dojde, když v době zálohování hello je vypnutý hello virtuální počítač Azure.</span><span class="sxs-lookup"><span data-stu-id="4f81a-172">Crash consistency typically happens when hello Azure virtual machine is shut down at hello time of backup.</span></span> <span data-ttu-id="4f81a-173">Bod obnovení konzistentní při selhání obsahuje žádné záruky ohledně hello konzistence dat hello střední hello úložiště – buď z hlediska hello hello operačního systému nebo aplikace hello.</span><span class="sxs-lookup"><span data-stu-id="4f81a-173">A crash-consistent recovery point provides no guarantees around hello consistency of hello data on hello storage medium--either from hello perspective of hello operating system or hello application.</span></span> <span data-ttu-id="4f81a-174">Jediná hello data, která již existuje na disku hello v době zálohování hello je zaznamenat a zálohovat.</span><span class="sxs-lookup"><span data-stu-id="4f81a-174">Only hello data that already exists on hello disk at hello time of backup is captured and backed up.</span></span> <br/> <br/> <span data-ttu-id="4f81a-175">Když dochází obvykle žádné záruky, hello jednotlivými spuštěními operačního systému, za nímž následuje kontrolu disku postupu, jako je nástroj chkdsk, toofix všechny chyby poškození.</span><span class="sxs-lookup"><span data-stu-id="4f81a-175">While there are no guarantees, usually, hello operating system boots, followed by disk-checking procedure, like chkdsk, toofix any corruption errors.</span></span> <span data-ttu-id="4f81a-176">Data v paměti ani zápisů, které nebyly přenášená toohello disku se ztratí.</span><span class="sxs-lookup"><span data-stu-id="4f81a-176">Any in-memory data or writes that have not been transferred toohello disk are lost.</span></span> <span data-ttu-id="4f81a-177">aplikace Hello se obvykle následuje s vlastní mechanismus ověřování v případě, že data vrácení musí toobe Hotovo.</span><span class="sxs-lookup"><span data-stu-id="4f81a-177">hello application typically follows with its own verification mechanism in case data rollback needs toobe done.</span></span> <br><br><span data-ttu-id="4f81a-178">Například pokud hello transakční protokol obsahuje položky, které se nenacházejí v databázi hello, pak hello databázový software nepodporuje vrácení zpět. dokud hello dat je konzistentní.</span><span class="sxs-lookup"><span data-stu-id="4f81a-178">As an example, if hello transaction log has entries that are not present in hello database, then hello database software does a rollback until hello data is consistent.</span></span> <span data-ttu-id="4f81a-179">Když dat je rozdělena mezi více virtuálních disků (např. rozložené svazky), poskytuje bod konzistentní při selhání obnovení žádné záruky hello správnost údajů hello.</span><span class="sxs-lookup"><span data-stu-id="4f81a-179">When data is spread across multiple virtual disks (like spanned volumes), a crash-consistent recovery point provides no guarantees for hello correctness of hello data.</span></span> |

## <a name="performance-and-resource-utilization"></a><span data-ttu-id="4f81a-180">Výkon a využití prostředků</span><span class="sxs-lookup"><span data-stu-id="4f81a-180">Performance and resource utilization</span></span>
<span data-ttu-id="4f81a-181">Jako zálohovací software, který je nasazený na místě měli byste naplánovat kapacitu a využití prostředků musí při zálohování virtuálních počítačů v Azure.</span><span class="sxs-lookup"><span data-stu-id="4f81a-181">Like backup software that is deployed on-premises, you should plan for capacity and resource utilization needs when backing up VMs in Azure.</span></span> <span data-ttu-id="4f81a-182">Hello [Azure Storage omezuje](../azure-subscription-service-limits.md#storage-limits) definovat, jak toostructure virtuálních počítačů nasazení tooget maximální výkon s minimální vliv toorunning úlohy.</span><span class="sxs-lookup"><span data-stu-id="4f81a-182">hello [Azure Storage limits](../azure-subscription-service-limits.md#storage-limits) define how toostructure VM deployments tooget maximum performance with minimum impact toorunning workloads.</span></span>

<span data-ttu-id="4f81a-183">Věnovat pozornost toohello, který omezuje následující Azure Storage při plánování výkonu zálohování:</span><span class="sxs-lookup"><span data-stu-id="4f81a-183">Pay attention toohello following Azure Storage limits when planning backup performance:</span></span>

* <span data-ttu-id="4f81a-184">Maximální počet odchozí na účet úložiště</span><span class="sxs-lookup"><span data-stu-id="4f81a-184">Max egress per storage account</span></span>
* <span data-ttu-id="4f81a-185">Rychlost celkový počet požadavků na účet úložiště</span><span class="sxs-lookup"><span data-stu-id="4f81a-185">Total request rate per storage account</span></span>

### <a name="storage-account-limits"></a><span data-ttu-id="4f81a-186">Limity účtu úložiště</span><span class="sxs-lookup"><span data-stu-id="4f81a-186">Storage account limits</span></span>
<span data-ttu-id="4f81a-187">Zálohovaná data zkopírovat z účtu úložiště, přidá toohello vstupně výstupních operací za sekundu (IOPS) a odchozí (nebo propustnost) metriky hello účtu úložiště.</span><span class="sxs-lookup"><span data-stu-id="4f81a-187">Backup data copied from a storage account, adds toohello input/output operations per second (IOPS) and egress (or throughput) metrics of hello storage account.</span></span> <span data-ttu-id="4f81a-188">Na hello stejný čas, virtuální počítače spotřebovávají také IOPS a propustnosti.</span><span class="sxs-lookup"><span data-stu-id="4f81a-188">At hello same time, virtual machines are also consuming IOPS and throughput.</span></span> <span data-ttu-id="4f81a-189">cílem Hello je tooensure zálohování a přenosy dat virtuálních počítačů nepřekračují omezení účtu úložiště.</span><span class="sxs-lookup"><span data-stu-id="4f81a-189">hello goal is tooensure Backup and virtual machine traffic don't exceed your storage account limits.</span></span>

### <a name="number-of-disks"></a><span data-ttu-id="4f81a-190">Počet disků</span><span class="sxs-lookup"><span data-stu-id="4f81a-190">Number of disks</span></span>
<span data-ttu-id="4f81a-191">proces zálohování Hello pokusí provést co nejrychleji toocomplete úlohu zálohování.</span><span class="sxs-lookup"><span data-stu-id="4f81a-191">hello backup process tries toocomplete a backup job as quickly as possible.</span></span> <span data-ttu-id="4f81a-192">Při tom spotřebuje množství prostředků, jak je to možné.</span><span class="sxs-lookup"><span data-stu-id="4f81a-192">In doing so, it consumes as many resources as it can.</span></span> <span data-ttu-id="4f81a-193">Však mají omezenou všechny vstupně-výstupních operací hello *propustnost cíl pro jeden objekt Blob*, což může mít 60 MB za sekundu.</span><span class="sxs-lookup"><span data-stu-id="4f81a-193">However, all I/O operations are limited by hello *Target Throughput for Single Blob*, which has a limit of 60 MB per second.</span></span> <span data-ttu-id="4f81a-194">V toomaximize pokusu o jeho rychlost hello proces zálohování se pokusí tooback až všechny disky Virtuálního počítače hello *paralelně*.</span><span class="sxs-lookup"><span data-stu-id="4f81a-194">In an attempt toomaximize its speed, hello backup process tries tooback up each of hello VM's disks *in parallel*.</span></span> <span data-ttu-id="4f81a-195">Pokud virtuální počítač má čtyři disky, služba hello pokusí o tooback všechny čtyři disky paralelně.</span><span class="sxs-lookup"><span data-stu-id="4f81a-195">If a VM has four disks, hello service attempts tooback up all four disks in parallel.</span></span> <span data-ttu-id="4f81a-196">Hello **počet disků** zálohovaných, je hello nejdůležitějším faktorem při určování provoz zálohování účet úložiště.</span><span class="sxs-lookup"><span data-stu-id="4f81a-196">hello **number of disks** being backed up, is hello most important factor in determining storage account backup traffic.</span></span>

### <a name="backup-schedule"></a><span data-ttu-id="4f81a-197">Plán zálohování</span><span class="sxs-lookup"><span data-stu-id="4f81a-197">Backup schedule</span></span>
<span data-ttu-id="4f81a-198">Dodatečný faktor, který má dopad na výkon je hello **plán zálohování**.</span><span class="sxs-lookup"><span data-stu-id="4f81a-198">An additional factor that impacts performance is hello **backup schedule**.</span></span> <span data-ttu-id="4f81a-199">Pokud nakonfigurujete hello zásady tak, že všechny virtuální počítače jsou zálohovány v hello stejný čas, jste naplánovali papír provoz.</span><span class="sxs-lookup"><span data-stu-id="4f81a-199">If you configure hello policies so all VMs are backed up at hello same time, you have scheduled a traffic jam.</span></span> <span data-ttu-id="4f81a-200">proces zálohování Hello pokusí tooback všechny disky paralelně.</span><span class="sxs-lookup"><span data-stu-id="4f81a-200">hello backup process attempts tooback up all disks in parallel.</span></span> <span data-ttu-id="4f81a-201">provoz zálohování tooreduce hello z účtu úložiště, zálohování různých virtuálních počítačů v jiné době hello den s bez překrytí.</span><span class="sxs-lookup"><span data-stu-id="4f81a-201">tooreduce hello backup traffic from a storage account, back up different VMs at different time of hello day, with no overlap.</span></span>

## <a name="capacity-planning"></a><span data-ttu-id="4f81a-202">Plánování kapacity</span><span class="sxs-lookup"><span data-stu-id="4f81a-202">Capacity planning</span></span>
<span data-ttu-id="4f81a-203">Předchozí faktory hello uvedení společně, potřebujete tooplan pro potřeby využití účtu úložiště hello.</span><span class="sxs-lookup"><span data-stu-id="4f81a-203">Putting hello previous factors together, you need tooplan for hello storage account usage needs.</span></span> <span data-ttu-id="4f81a-204">Stáhnout hello [Excelová tabulka pro plánování kapacity služby zálohování virtuálních počítačů](https://gallery.technet.microsoft.com/Azure-Backup-Storage-a46d7e33) toosee hello dopad disku a plán zálohování volby.</span><span class="sxs-lookup"><span data-stu-id="4f81a-204">Download hello [VM backup capacity planning Excel spreadsheet](https://gallery.technet.microsoft.com/Azure-Backup-Storage-a46d7e33) toosee hello impact of your disk and backup schedule choices.</span></span>

### <a name="backup-throughput"></a><span data-ttu-id="4f81a-205">Zálohování propustnost</span><span class="sxs-lookup"><span data-stu-id="4f81a-205">Backup throughput</span></span>
<span data-ttu-id="4f81a-206">Pro každý disk zálohovaných Azure Backup přečte hello bloky na disku hello a ukládá jenom hello změněná data (přírůstkové zálohování).</span><span class="sxs-lookup"><span data-stu-id="4f81a-206">For each disk being backed up, Azure Backup reads hello blocks on hello disk and stores only hello changed data (incremental backup).</span></span> <span data-ttu-id="4f81a-207">Hello následující tabulka uvádí hello průměrné zálohování služby propustnost hodnoty.</span><span class="sxs-lookup"><span data-stu-id="4f81a-207">hello following table shows hello average Backup service throughput values.</span></span> <span data-ttu-id="4f81a-208">Pomocí hello následující data, můžete odhadnout, že hello množství času potřebné tooback až disk na danou velikost.</span><span class="sxs-lookup"><span data-stu-id="4f81a-208">Using hello following data, you can estimate hello amount of time needed tooback up a disk of a given size.</span></span>

| <span data-ttu-id="4f81a-209">Operace zálohování</span><span class="sxs-lookup"><span data-stu-id="4f81a-209">Backup operation</span></span> | <span data-ttu-id="4f81a-210">Nejlepší možný propustnost</span><span class="sxs-lookup"><span data-stu-id="4f81a-210">Best-case throughput</span></span> |
| --- | --- |
| <span data-ttu-id="4f81a-211">Prvotní zálohování</span><span class="sxs-lookup"><span data-stu-id="4f81a-211">Initial backup</span></span> |<span data-ttu-id="4f81a-212">160 MB/s</span><span class="sxs-lookup"><span data-stu-id="4f81a-212">160 Mbps</span></span> |
| <span data-ttu-id="4f81a-213">Přírůstkové zálohování (DR)</span><span class="sxs-lookup"><span data-stu-id="4f81a-213">Incremental backup (DR)</span></span> |<span data-ttu-id="4f81a-214">640 MB/s</span><span class="sxs-lookup"><span data-stu-id="4f81a-214">640 Mbps</span></span> <br><br> <span data-ttu-id="4f81a-215">Propustnost vyřazuje výrazně změnu hello data (vyžadující toobe zálohovat) jsou rozptýlená v rámci hello disku.</span><span class="sxs-lookup"><span data-stu-id="4f81a-215">Throughput drops significantly if hello changed data (that needs toobe backed up) is dispersed across hello disk.</span></span>|

## <a name="total-vm-backup-time"></a><span data-ttu-id="4f81a-216">Celkový čas zálohování virtuálních počítačů</span><span class="sxs-lookup"><span data-stu-id="4f81a-216">Total VM backup time</span></span>
<span data-ttu-id="4f81a-217">Při čtení a kopírování dat, je většina čas zálohování hello stráví, jiné operace přispívat toohello celkový čas potřebný tooback si virtuální počítač:</span><span class="sxs-lookup"><span data-stu-id="4f81a-217">While most of hello backup time is spent reading and copying data, other operations contribute toohello total time needed tooback up a VM:</span></span>

* <span data-ttu-id="4f81a-218">Doba potřebná příliš[instalovat nebo aktualizovat rozšíření zálohování hello](backup-azure-vms.md).</span><span class="sxs-lookup"><span data-stu-id="4f81a-218">Time needed too[install or update hello backup extension](backup-azure-vms.md).</span></span>
* <span data-ttu-id="4f81a-219">Čas snímek, což je hello doba tootrigger snímku.</span><span class="sxs-lookup"><span data-stu-id="4f81a-219">Snapshot time, which is hello time taken tootrigger a snapshot.</span></span> <span data-ttu-id="4f81a-220">Snímky jsou spouštěná zavřít toohello naplánovaný čas zálohování.</span><span class="sxs-lookup"><span data-stu-id="4f81a-220">Snapshots are triggered close toohello scheduled backup time.</span></span>
* <span data-ttu-id="4f81a-221">Doba čekání ve frontě.</span><span class="sxs-lookup"><span data-stu-id="4f81a-221">Queue wait time.</span></span> <span data-ttu-id="4f81a-222">Vzhledem k tomu, že služba zálohování hello zpracovává záloh z více zákazníků, kopírování zálohovaná data ze zálohy snímku toohello nebo služeb zotavení trezoru nemusí spustit okamžitě.</span><span class="sxs-lookup"><span data-stu-id="4f81a-222">Since hello Backup service is processing backups from multiple customers, copying backup data from snapshot toohello backup or Recovery Services vault might not start immediately.</span></span> <span data-ttu-id="4f81a-223">Časů zátěž ve špičce lze hello čekání roztáhnout tooeight hodin z důvodu toohello počet záloh zpracovává.</span><span class="sxs-lookup"><span data-stu-id="4f81a-223">In times of peak load, hello wait can stretch up tooeight hours due toohello number of backups being processed.</span></span> <span data-ttu-id="4f81a-224">Hello celkový počet virtuálních počítačů čas zálohování je však méně než 24 hodin pro denní zásady zálohování.</span><span class="sxs-lookup"><span data-stu-id="4f81a-224">However, hello total VM backup time is less than 24 hours for daily backup policies.</span></span>
* <span data-ttu-id="4f81a-225">Doba přenosu dat, čas potřebný pro zálohování služby toocompute hello přírůstkové změny z předchozí zálohy a přenos tyto změny toovault úložiště.</span><span class="sxs-lookup"><span data-stu-id="4f81a-225">Data transfer time, time needed for backup service toocompute hello incremental changes from previous backup and transfer those changes toovault storage.</span></span>

### <a name="why-am-i-observing-longer12-hours-backup-time"></a><span data-ttu-id="4f81a-226">Proč se sledování longer(>12 hours) zálohování čas?</span><span class="sxs-lookup"><span data-stu-id="4f81a-226">Why am I observing longer(>12 hours) backup time?</span></span>
<span data-ttu-id="4f81a-227">Zálohování se skládá ze dvou fází: pořizování snímků a přenosu hello snímky toohello trezoru.</span><span class="sxs-lookup"><span data-stu-id="4f81a-227">Backup consists of two phases: taking snapshots and transferring hello snapshots toohello vault.</span></span> <span data-ttu-id="4f81a-228">Hello služby zálohování optimalizuje úložiště.</span><span class="sxs-lookup"><span data-stu-id="4f81a-228">hello Backup service optimizes for storage.</span></span> <span data-ttu-id="4f81a-229">Při přenosu hello snímek dat tooa trezoru, převede služba hello z předchozího snímku hello pouze přírůstkové změny.</span><span class="sxs-lookup"><span data-stu-id="4f81a-229">When transferring hello snapshot data tooa vault, hello service only transfers incremental changes from hello previous snapshot.</span></span>  <span data-ttu-id="4f81a-230">přírůstkové změny hello toodetermine hello služby vypočítá kontrolního součtu hello hello bloků.</span><span class="sxs-lookup"><span data-stu-id="4f81a-230">toodetermine hello incremental changes, hello service computes hello checksum of hello blocks.</span></span> <span data-ttu-id="4f81a-231">Pokud dojde ke změně blok, hello bloku je označený bloku toobe, odeslané toohello trezoru.</span><span class="sxs-lookup"><span data-stu-id="4f81a-231">If a block is changed, hello block is identified as a block toobe sent toohello vault.</span></span> <span data-ttu-id="4f81a-232">Cvičení služby hello další do každé hello identifikaci bloky, hledá tootransfer data hello toominimize příležitosti.</span><span class="sxs-lookup"><span data-stu-id="4f81a-232">Then hello service drills further into each of hello identified blocks, looking for opportunities toominimize hello data tootransfer.</span></span> <span data-ttu-id="4f81a-233">Po vyhodnocení všechny změněné bloky, služba hello spojí hello změny a odešle je toohello trezoru.</span><span class="sxs-lookup"><span data-stu-id="4f81a-233">After evaluating all changed blocks, hello service coalesces hello changes and sends them toohello vault.</span></span> <span data-ttu-id="4f81a-234">V některých starších verzí aplikací nejsou malé, fragmentovaných zápisy optimální pro úložiště.</span><span class="sxs-lookup"><span data-stu-id="4f81a-234">In some legacy applications, small, fragmented writes are not optimal for storage.</span></span> <span data-ttu-id="4f81a-235">Pokud snímek hello obsahuje mnoho malých, fragmentovaných zápisy, služba hello stráví další čas zpracování dat hello zapsaných aplikace hello.</span><span class="sxs-lookup"><span data-stu-id="4f81a-235">If hello snapshot contains many small, fragmented writes, hello service spends additional time processing hello data written by hello applications.</span></span> <span data-ttu-id="4f81a-236">Hello doporučená bloku zápisu aplikace ze služby Azure, pro aplikace spuštěné v hello virtuálních počítačů, je minimálně 8 KB.</span><span class="sxs-lookup"><span data-stu-id="4f81a-236">hello recommended application write block from Azure, for applications running inside hello VM, is a minimum of 8 KB.</span></span> <span data-ttu-id="4f81a-237">Pokud vaše aplikace používá blok menší než 8 KB, se provádí výkon zálohování.</span><span class="sxs-lookup"><span data-stu-id="4f81a-237">If your application uses a block of less than 8 KB, backup performance is effected.</span></span> <span data-ttu-id="4f81a-238">Pomoc s optimalizací výkonu zálohování tooimprove aplikací najdete v tématu [ladění aplikací pro optimální výkon s Azure storage](../storage/common/storage-premium-storage-performance.md).</span><span class="sxs-lookup"><span data-stu-id="4f81a-238">For help with tuning your application tooimprove backup performance, see [Tuning applications for optimal performance with Azure storage](../storage/common/storage-premium-storage-performance.md).</span></span> <span data-ttu-id="4f81a-239">I když hello článek na výkon zálohování používá příklady úložiště Premium, je použít u standardního úložiště disky hello pokyny.</span><span class="sxs-lookup"><span data-stu-id="4f81a-239">Though hello article on backup performance uses Premium storage examples, hello guidance is applicable for Standard storage disks.</span></span>

## <a name="total-restore-time"></a><span data-ttu-id="4f81a-240">Celkový počet obnovení čas</span><span class="sxs-lookup"><span data-stu-id="4f81a-240">Total restore time</span></span>
<span data-ttu-id="4f81a-241">Operace obnovení se skládá z dvě hlavní dílčí úlohy: kopírování dat zpět z účtu úložiště hello trezoru toohello vybrali zákazníka a vytváření hello virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="4f81a-241">A restore operation consists of two main sub tasks: Copying data back from hello vault toohello chosen customer storage account, and creating hello virtual machine.</span></span> <span data-ttu-id="4f81a-242">Kopírování dat zpět z trezoru hello závisí na zálohování hello uložení interně v Azure a kde je uložen účet úložiště zákazníka hello.</span><span class="sxs-lookup"><span data-stu-id="4f81a-242">Copying data back from hello vault depends on where hello backups are stored internally in Azure, and where hello customer storage account is stored.</span></span> <span data-ttu-id="4f81a-243">Doba trvání toocopy dat závisí na:</span><span class="sxs-lookup"><span data-stu-id="4f81a-243">Time taken toocopy data depends upon:</span></span>
* <span data-ttu-id="4f81a-244">Fronty čekací dobu – od zpracuje služba hello obnovení úlohy z víc zákazníků na hello současně, žádosti o obnovení jsou umístit do fronty.</span><span class="sxs-lookup"><span data-stu-id="4f81a-244">Queue wait time - Since hello service processes restore jobs from multiple customers at hello same time, restore requests are put in a queue.</span></span>
* <span data-ttu-id="4f81a-245">Kopírování dat time – Data budou zkopírována z účtu úložiště hello trezoru toohello zákazníka.</span><span class="sxs-lookup"><span data-stu-id="4f81a-245">Data copy time - Data is copied from hello vault toohello customer storage account.</span></span> <span data-ttu-id="4f81a-246">Obnovení doba závisí na IOPS a propustnost služby Azure Backup získá hello vybraný účet úložiště zákazníka.</span><span class="sxs-lookup"><span data-stu-id="4f81a-246">Restore time depends on IOPS and throughput Azure Backup service gets on hello selected customer storage account.</span></span> <span data-ttu-id="4f81a-247">tooreduce hello kopírování času během procesu obnovení hello, vyberte účet úložiště s jinými aplikace zápisů a čtení není načtená.</span><span class="sxs-lookup"><span data-stu-id="4f81a-247">tooreduce hello copying time during hello restore process, select a storage account not loaded with other application writes and reads.</span></span>

## <a name="best-practices"></a><span data-ttu-id="4f81a-248">Osvědčené postupy</span><span class="sxs-lookup"><span data-stu-id="4f81a-248">Best practices</span></span>
<span data-ttu-id="4f81a-249">Doporučujeme následující tyto postupy při konfiguraci zálohování pro virtuální počítače:</span><span class="sxs-lookup"><span data-stu-id="4f81a-249">We suggest following these practices while configuring backups for virtual machines:</span></span>

* <span data-ttu-id="4f81a-250">Nemáte naplánovat víc než 10 klasické virtuální počítače z hello stejné cloudové služby tooback v hello stejnou dobu.</span><span class="sxs-lookup"><span data-stu-id="4f81a-250">Don't schedule more than 10 classic VMs from hello same cloud service tooback up at hello same time.</span></span> <span data-ttu-id="4f81a-251">Pokud chcete tooback se víc virtuálních počítačů z stejné cloudové služby, odstupňování časů zahájení zálohování hello o hodinu.</span><span class="sxs-lookup"><span data-stu-id="4f81a-251">If you want tooback up multiple VMs from same cloud service, stagger hello backup start times by an hour.</span></span>
* <span data-ttu-id="4f81a-252">Neplánujte víc než 40 tooback virtuální počítače až na hello stejnou dobu.</span><span class="sxs-lookup"><span data-stu-id="4f81a-252">Do not schedule more than 40 VMs tooback up at hello same time.</span></span>
* <span data-ttu-id="4f81a-253">Plánování zálohování virtuálních počítačů v době mimo špičku.</span><span class="sxs-lookup"><span data-stu-id="4f81a-253">Schedule VM backups during non-peak hours.</span></span> <span data-ttu-id="4f81a-254">Tento způsob hello služby Backup používá IOPS pro přenos dat z trezoru toohello hello zákazníka úložiště účtu.</span><span class="sxs-lookup"><span data-stu-id="4f81a-254">This way hello Backup service uses IOPS for transferring data from hello customer storage account toohello vault.</span></span>
* <span data-ttu-id="4f81a-255">Ujistěte se, že je zásada na virtuálních počítačích rozloženy jiným účtům úložiště.</span><span class="sxs-lookup"><span data-stu-id="4f81a-255">Make sure that a policy is applied on VMs spread across different storage accounts.</span></span> <span data-ttu-id="4f81a-256">Doporučujeme více než 20 celkový disky z jednoho úložiště účtu chráněn hello stejný plán zálohování.</span><span class="sxs-lookup"><span data-stu-id="4f81a-256">We suggest no more than 20 total disks from a single storage account be protected by hello same backup schedule.</span></span> <span data-ttu-id="4f81a-257">Pokud máte větší než 20 disky v účtu úložiště, šíří tyto virtuální počítače napříč více tooget zásady hello požadované IOPS během fáze přenos hello hello proces zálohování.</span><span class="sxs-lookup"><span data-stu-id="4f81a-257">If you have greater than 20 disks in a storage account, spread those VMs across multiple policies tooget hello required IOPS during hello transfer phase of hello backup process.</span></span>
* <span data-ttu-id="4f81a-258">Neobnovujte systémem prémiový účet úložiště toosame úložiště virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="4f81a-258">Do not restore a VM running on Premium storage toosame storage account.</span></span> <span data-ttu-id="4f81a-259">Pokud proces operaci obnovení hello se shoduje s hello operaci zálohování, snižuje hello k dispozici IOPS pro zálohování.</span><span class="sxs-lookup"><span data-stu-id="4f81a-259">If hello restore operation process coincides with hello backup operation, it reduces hello available IOPS for backup.</span></span>
* <span data-ttu-id="4f81a-260">Pro zálohování virtuálních počítačů Premium Ujistěte se, tento účet úložiště, hostitelé prémiové disky má alespoň 50 % volného místa pro přípravu snímek pro úspěšnou zálohu.</span><span class="sxs-lookup"><span data-stu-id="4f81a-260">For Premium VM backup, ensure that storage account that hosts premium disks has atleast 50% free space for staging snapshot for a successful backup.</span></span> 
* <span data-ttu-id="4f81a-261">Ujistěte se, že danou verzi jazyka python na virtuální počítače s Linuxem povolené pro zálohování je 2.7</span><span class="sxs-lookup"><span data-stu-id="4f81a-261">Make sure that python version on Linux VMs enabled for backup is 2.7</span></span>

## <a name="data-encryption"></a><span data-ttu-id="4f81a-262">Šifrování dat</span><span class="sxs-lookup"><span data-stu-id="4f81a-262">Data encryption</span></span>
<span data-ttu-id="4f81a-263">Zálohování Azure data jako součást procesu zálohování hello nešifruje.</span><span class="sxs-lookup"><span data-stu-id="4f81a-263">Azure Backup does not encrypt data as a part of hello backup process.</span></span> <span data-ttu-id="4f81a-264">Ale můžete šifrovat data v rámci hello virtuálních počítačů a zálohování hello chráněných dat bezproblémově (Další informace o [zálohování šifrovaná data](backup-azure-vms-encryption.md)).</span><span class="sxs-lookup"><span data-stu-id="4f81a-264">However, you can encrypt data within hello VM and back up hello protected data seamlessly (read more about [backup of encrypted data](backup-azure-vms-encryption.md)).</span></span>

## <a name="calculating-hello-cost-of-protected-instances"></a><span data-ttu-id="4f81a-265">Výpočet nákladů hello chráněné instance</span><span class="sxs-lookup"><span data-stu-id="4f81a-265">Calculating hello cost of protected instances</span></span>
<span data-ttu-id="4f81a-266">Azure virtuální počítače, které jsou zálohovány pomocí Azure Backup jsou příliš předmět[cenách zálohování Azure](https://azure.microsoft.com/pricing/details/backup/).</span><span class="sxs-lookup"><span data-stu-id="4f81a-266">Azure virtual machines that are backed up through Azure Backup are subject too[Azure Backup pricing](https://azure.microsoft.com/pricing/details/backup/).</span></span> <span data-ttu-id="4f81a-267">Hello chráněné instance výpočtu je založena na hello *skutečné* velikost hello virtuální počítač, který je součtem hello všechna data hello ve virtuálním počítači hello – s výjimkou hello "prostředků disku."</span><span class="sxs-lookup"><span data-stu-id="4f81a-267">hello Protected Instances calculation is based on hello *actual* size of hello virtual machine, which is hello sum of all hello data in hello virtual machine--excluding hello “resource disk.”</span></span>

<span data-ttu-id="4f81a-268">Ceny pro zálohování virtuálních počítačů je *není* na základě velikosti hello maximální podporované pro každý virtuální počítač datového disku připojené toohello.</span><span class="sxs-lookup"><span data-stu-id="4f81a-268">Pricing for backing up VMs is *not* based on hello maximum supported size for each data disk attached toohello virtual machine.</span></span> <span data-ttu-id="4f81a-269">Ceny vychází hello dat uložených v hello datový disk.</span><span class="sxs-lookup"><span data-stu-id="4f81a-269">Pricing is based on hello actual data stored in hello data disk.</span></span> <span data-ttu-id="4f81a-270">Podobně faktury hello úložiště záloh podle hello množství dat, který je uložený ve službě Azure Backup, tedy součet hello hello skutečných dat v každém bodu obnovení.</span><span class="sxs-lookup"><span data-stu-id="4f81a-270">Similarly, hello backup storage bill is based on hello amount of data that is stored in Azure Backup, which is hello sum of hello actual data in each recovery point.</span></span>

<span data-ttu-id="4f81a-271">Například využít A2 standardní velikosti virtuálního počítače, který má dva dalších datových disků s maximální velikost 1 TB.</span><span class="sxs-lookup"><span data-stu-id="4f81a-271">For example, take an A2 Standard-sized virtual machine that has two additional data disks with a maximum size of 1 TB each.</span></span> <span data-ttu-id="4f81a-272">Hello následující tabulka poskytuje hello dat uložených na každý z těchto disků:</span><span class="sxs-lookup"><span data-stu-id="4f81a-272">hello following table gives hello actual data stored on each of these disks:</span></span>

| <span data-ttu-id="4f81a-273">Typ disku</span><span class="sxs-lookup"><span data-stu-id="4f81a-273">Disk type</span></span> | <span data-ttu-id="4f81a-274">Maximální velikost</span><span class="sxs-lookup"><span data-stu-id="4f81a-274">Max size</span></span> | <span data-ttu-id="4f81a-275">Skutečná data obsažená</span><span class="sxs-lookup"><span data-stu-id="4f81a-275">Actual data present</span></span> |
| --- | --- | --- |
| <span data-ttu-id="4f81a-276">Disk operačním systému</span><span class="sxs-lookup"><span data-stu-id="4f81a-276">Operating system disk</span></span> |<span data-ttu-id="4f81a-277">1023 GB</span><span class="sxs-lookup"><span data-stu-id="4f81a-277">1023 GB</span></span> |<span data-ttu-id="4f81a-278">17 GB</span><span class="sxs-lookup"><span data-stu-id="4f81a-278">17 GB</span></span> |
| <span data-ttu-id="4f81a-279">Místní disk nebo prostředek disku</span><span class="sxs-lookup"><span data-stu-id="4f81a-279">Local disk / Resource disk</span></span> |<span data-ttu-id="4f81a-280">135 GB</span><span class="sxs-lookup"><span data-stu-id="4f81a-280">135 GB</span></span> |<span data-ttu-id="4f81a-281">5 GB (pro zálohování není součástí)</span><span class="sxs-lookup"><span data-stu-id="4f81a-281">5 GB (not included for backup)</span></span> |
| <span data-ttu-id="4f81a-282">Datový disk 1</span><span class="sxs-lookup"><span data-stu-id="4f81a-282">Data disk 1</span></span> |<span data-ttu-id="4f81a-283">1023 GB</span><span class="sxs-lookup"><span data-stu-id="4f81a-283">1023 GB</span></span> |<span data-ttu-id="4f81a-284">30 GB</span><span class="sxs-lookup"><span data-stu-id="4f81a-284">30 GB</span></span> |
| <span data-ttu-id="4f81a-285">Datový disk 2</span><span class="sxs-lookup"><span data-stu-id="4f81a-285">Data disk 2</span></span> |<span data-ttu-id="4f81a-286">1023 GB</span><span class="sxs-lookup"><span data-stu-id="4f81a-286">1023 GB</span></span> |<span data-ttu-id="4f81a-287">0 GB</span><span class="sxs-lookup"><span data-stu-id="4f81a-287">0 GB</span></span> |

<span data-ttu-id="4f81a-288">Hello *skutečné* velikost hello virtuálního počítače v tomto případě je 17 GB + 30 GB + 0 GB = 47 GB.</span><span class="sxs-lookup"><span data-stu-id="4f81a-288">hello *actual* size of hello virtual machine in this case is 17 GB + 30 GB + 0 GB = 47 GB.</span></span> <span data-ttu-id="4f81a-289">Tato velikost chráněné Instance (47 GB) se změní na hello základ pro hello měsíčních nákladů.</span><span class="sxs-lookup"><span data-stu-id="4f81a-289">This Protected Instance size (47 GB) becomes hello basis for hello monthly bill.</span></span> <span data-ttu-id="4f81a-290">Jako hello roste množství dat v hello virtuálního počítače, velikost chráněné Instance hello použitý pro změny fakturace odpovídajícím způsobem.</span><span class="sxs-lookup"><span data-stu-id="4f81a-290">As hello amount of data in hello virtual machine grows, hello Protected Instance size used for billing changes accordingly.</span></span>

<span data-ttu-id="4f81a-291">Fakturace se nespustí, dokud se nedokončí hello první úspěšné zálohy.</span><span class="sxs-lookup"><span data-stu-id="4f81a-291">Billing does not start until hello first successful backup completes.</span></span> <span data-ttu-id="4f81a-292">V tomto okamžiku začne hello fakturace pro úložiště a chráněné instance.</span><span class="sxs-lookup"><span data-stu-id="4f81a-292">At this point, hello billing for both Storage and Protected Instances begins.</span></span> <span data-ttu-id="4f81a-293">Fakturace pokračuje, dokud je *žádné zálohování dat uložených v trezoru* hello virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="4f81a-293">Billing continues as long as there is *any backup data stored in a vault* for hello virtual machine.</span></span> <span data-ttu-id="4f81a-294">Pokud zastavíte ochranu na virtuálním počítači hello, ale v trezoru zálohování dat virtuálního počítače existuje, bude pokračovat fakturace.</span><span class="sxs-lookup"><span data-stu-id="4f81a-294">If you stop protection on hello virtual machine, but virtual machine backup data exists in a vault, billing continues.</span></span>

<span data-ttu-id="4f81a-295">Fakturace zastaví zadaný virtuální počítač jenom v případě, že hello ochrana je zastavena *a* veškerá zálohovaná data se odstraní.</span><span class="sxs-lookup"><span data-stu-id="4f81a-295">Billing for a specified virtual machine stops only if hello protection is stopped *and* all backup data is deleted.</span></span> <span data-ttu-id="4f81a-296">Při zastavení ochrany a neexistují žádné aktivní úlohy zálohování, hello velikost zálohy virtuálního počítače poslední úspěšné hello změní velikost chráněné Instance hello používá pro hello měsíčních nákladů.</span><span class="sxs-lookup"><span data-stu-id="4f81a-296">When protection stops and there are no active backup jobs, hello size of hello last successful VM backup becomes hello Protected Instance size used for hello monthly bill.</span></span>

## <a name="questions"></a><span data-ttu-id="4f81a-297">Máte dotazy?</span><span class="sxs-lookup"><span data-stu-id="4f81a-297">Questions?</span></span>
<span data-ttu-id="4f81a-298">Pokud máte otázky, nebo pokud se některé funkce, které byste chtěli toosee zahrnuty, [pošlete nám svůj názor](http://aka.ms/azurebackup_feedback).</span><span class="sxs-lookup"><span data-stu-id="4f81a-298">If you have questions, or if there is any feature that you would like toosee included, [send us feedback](http://aka.ms/azurebackup_feedback).</span></span>

## <a name="next-steps"></a><span data-ttu-id="4f81a-299">Další kroky</span><span class="sxs-lookup"><span data-stu-id="4f81a-299">Next steps</span></span>
* [<span data-ttu-id="4f81a-300">Zálohování virtuálních počítačů</span><span class="sxs-lookup"><span data-stu-id="4f81a-300">Back up virtual machines</span></span>](backup-azure-vms.md)
* [<span data-ttu-id="4f81a-301">Správa zálohování virtuálních počítačů</span><span class="sxs-lookup"><span data-stu-id="4f81a-301">Manage virtual machine backup</span></span>](backup-azure-manage-vms.md)
* [<span data-ttu-id="4f81a-302">Obnovení virtuálních počítačů</span><span class="sxs-lookup"><span data-stu-id="4f81a-302">Restore virtual machines</span></span>](backup-azure-restore-vms.md)
* [<span data-ttu-id="4f81a-303">Řešení problémů zálohování virtuálních počítačů</span><span class="sxs-lookup"><span data-stu-id="4f81a-303">Troubleshoot VM backup issues</span></span>](backup-azure-vms-troubleshoot.md)
