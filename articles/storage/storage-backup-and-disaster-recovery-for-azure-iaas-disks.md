---
title: "aaaBackup a zotavení po havárii pro disky Azure IaaS | Microsoft Docs"
description: "V tomto článku vysvětlíme, jak tooplan pro zálohování a obnovení po havárii (DR) IaaS virtuálních počítačů (VM) a disky v Azure. Tento dokument popisuje spravované i nespravované disky"
services: storage
cloud: Azure
documentationcenter: na
author: luywang
manager: kavithag
ms.assetid: 
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/19/2017
ms.author: luywang
ms.openlocfilehash: 17c697bc411fb47c4b7483b59829af1c40732ac1
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="backup-and-disaster-recovery-for-azure-iaas-disks"></a><span data-ttu-id="8f8f2-104">Zálohování a zotavení po havárii pro disky Azure IaaS</span><span class="sxs-lookup"><span data-stu-id="8f8f2-104">Backup and disaster recovery for Azure IaaS disks</span></span>

<span data-ttu-id="8f8f2-105">V tomto článku vysvětlíme, jak tooplan pro zálohování a obnovení po havárii (DR) IaaS virtuálních počítačů (VM) a disky v Azure.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-105">In this article, we will explain how tooplan for Backup and Disaster Recovery (DR) of IaaS virtual machines (VMs) and Disks in Azure.</span></span> <span data-ttu-id="8f8f2-106">Tento dokument popisuje spravované i nespravované disky.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-106">This document covers both Managed and Unmanaged Disks.</span></span>

<span data-ttu-id="8f8f2-107">Nejprve budeme mluvit o hello předdefinované odolnost proti chybám možnosti v hello platformy Azure, které pomáhají chránit proti místní selhání.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-107">We’ll first talk about hello built-in fault tolerance capabilities in hello Azure platform which help guard against local failures.</span></span> <span data-ttu-id="8f8f2-108">Potom probereme scénáře po havárii hello předmětem není plně hello integrované funkce, která je hlavní téma hello řešený v tomto dokumentu.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-108">We’ll then discuss hello disaster scenarios not fully covered by hello built-in capabilities, which is hello main topic addressed by this document.</span></span> <span data-ttu-id="8f8f2-109">Ukážeme vám také několik příkladů zatížení scénáře, kde může použít různé aspekty zálohování a zotavení po Havárii.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-109">We’ll also show several examples of workload scenarios where different Backup and DR considerations may apply.</span></span> <span data-ttu-id="8f8f2-110">Potom: přečtěte možná řešení pro zotavení po Havárii disků IaaS.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-110">We’ll then review possible solutions for DR of IaaS Disks.</span></span> 

## <a name="introduction"></a><span data-ttu-id="8f8f2-111">Úvod</span><span class="sxs-lookup"><span data-stu-id="8f8f2-111">Introduction</span></span>

<span data-ttu-id="8f8f2-112">Hello platformy Azure používá různé metody pro redundanci a odolnost proti chybám toohelp chránit zákazníkům selhání lokalizované hardwaru, které se můžou vyskytnout.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-112">hello Azure platform uses various methods for redundancy and fault tolerance toohelp protect customers from localized hardware failures that can occur.</span></span> <span data-ttu-id="8f8f2-113">Místní selhání mohou obsahovat problémy s počítačem serveru úložiště Azure, která ukládá část dat hello pro virtuální disk nebo selhání SSD nebo pevný disk na tomto serveru.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-113">Local failures may include problems with an Azure storage server machine that stores part of hello data for a virtual disk or failures of an SSD or HDD on that server.</span></span> <span data-ttu-id="8f8f2-114">Takové selhání součásti izolované hardwaru může dojít během normálních operací a platforma hello je navrženou toobe odolné toothese selhání.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-114">Such isolated hardware component failures can happen during normal operations and hello platform is designed toobe resilient toothese failures.</span></span> <span data-ttu-id="8f8f2-115">Hlavní havárie může způsobit selhání nebo inaccessibility velkého počtu serverů úložiště nebo celého datového centra.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-115">Major disasters can result in failures or inaccessibility of a large numbers of storage servers or a whole datacenter.</span></span> <span data-ttu-id="8f8f2-116">Při z lokálních selhání jsou obvykle chráněné virtuální počítače a disky, další kroky jsou nezbytné tooprotect úlohu z celou oblast závažné chyby (například významnější havárie) ovlivňující virtuálních počítačů a disků.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-116">While your VMs and disks are normally protected from localized failures, additional steps are necessary tooprotect your workload from region-wide catastrophic failures (such as a major disaster) that can affect your VM and disks.</span></span>

<span data-ttu-id="8f8f2-117">Kromě toho toohello možnost selhání platformy, hello zákaznické aplikaci nebo dat může dojít k problémům.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-117">In addition toohello possibility of platform failures, problems with hello customer application or data can occur.</span></span> <span data-ttu-id="8f8f2-118">Nová verze aplikace může být například nechtěně narušující, toohello data změny.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-118">For example, a new version of your application may inadvertently make a breaking change toohello data.</span></span> <span data-ttu-id="8f8f2-119">V takovém případě můžete aplikace hello toorevert a hello data tooa předchozí verze obsahující hello posledního známého stavu.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-119">In that case, you may want toorevert hello application and hello data tooa prior version containing hello last known good state.</span></span> <span data-ttu-id="8f8f2-120">To vyžaduje údržbu pravidelných záloh.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-120">This requires maintaining regular backups.</span></span>

<span data-ttu-id="8f8f2-121">Místní zotavení po havárii musí zálohování virtuálních počítačů IaaS jiné oblasti disky tooa vaše.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-121">For regional disaster recovery, you must backup your IaaS VM disks tooa different region.</span></span> 

<span data-ttu-id="8f8f2-122">Předtím, než se podíváme na možnosti zálohování a zotavení po Havárii, můžeme recap několik metod k dispozici pro zpracování lokálních selhání.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-122">Before we look at Backup and DR options, let’s recap a few methods available for handling localized failures.</span></span>

### <a name="azure-iaas-resiliency"></a><span data-ttu-id="8f8f2-123">Odolnost proti chybám Azure IaaS</span><span class="sxs-lookup"><span data-stu-id="8f8f2-123">Azure IaaS Resiliency</span></span>

<span data-ttu-id="8f8f2-124">*Odolnost proti chybám* odkazuje toohello tolerance pro běžné chyby, ke kterým došlo v hardwarové součásti.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-124">*Resiliency* refers toohello tolerance for normal failures that occur in hardware components.</span></span> <span data-ttu-id="8f8f2-125">Odolnost proti chybám hello možnost toorecover selhání a pokračovat toofunction.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-125">Resiliency is hello ability toorecover from failures and continue toofunction.</span></span> <span data-ttu-id="8f8f2-126">Nejedná se o zamezení selhání, ale neodpovídá toofailures způsobem, který zabraňuje výpadku nebo ztráty dat.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-126">It's not about avoiding failures, but responding toofailures in a way that avoids downtime or data loss.</span></span> <span data-ttu-id="8f8f2-127">cílem Hello odolnosti je tooreturn hello aplikace tooa plně funkční stavu selhání.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-127">hello goal of resiliency is tooreturn hello application tooa fully functioning state following a failure.</span></span> <span data-ttu-id="8f8f2-128">Azure virtuální počítače a disky jsou navržené toobe odolné toocommon hardwaru chyb.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-128">Azure Virtual Machines and Disks are designed toobe resilient toocommon hardware faults.</span></span> <span data-ttu-id="8f8f2-129">Dejte nám podívejte, jak Platforma Azure IaaS hello poskytuje tuto odolnost proti chybám.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-129">Let us look at how hello Azure IaaS platform provides this resiliency.</span></span>

<span data-ttu-id="8f8f2-130">Virtuální počítač se skládá ze dvou částí především: (1) A výpočetní server a (2) hello trvalé disky.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-130">A virtual machine consists mainly of two parts: (1) A compute server, and (2) hello persistent disks.</span></span> <span data-ttu-id="8f8f2-131">Obě ovlivnit hello odolnost proti chybám virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-131">Both affect hello fault tolerance of a virtual machine.</span></span>

<span data-ttu-id="8f8f2-132">Pokud hello výpočtů Azure hostitelský server, kde virtuální počítač dojde k selhání hardwaru, (což je taková situace vzácná), Azure je navrženou tooautomatically obnovení hello virtuálních počítačů na jiný server.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-132">If hello Azure compute host server that houses your VM experiences a hardware failure (which is rare), Azure is designed tooautomatically restore hello VM on another server.</span></span> <span data-ttu-id="8f8f2-133">V takovém případě si všimnete restart a hello virtuálních počítačů bude zálohovat po určité době.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-133">If this happens, you will experience a reboot, and hello VM will be back up after some time.</span></span> <span data-ttu-id="8f8f2-134">Azure automaticky zjišťuje takové selhání hardwaru a provede obnovení toohelp ujistěte hello zákazníka virtuálních počítačů bude k dispozici co nejdříve.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-134">Azure automatically detects such hardware failures and executes recoveries toohelp ensure hello customer VM will be available as soon as possible.</span></span>

<span data-ttu-id="8f8f2-135">Týkající se disků IaaS odolnost dat je důležité pro platformu hello trvalého úložiště.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-135">Regarding IaaS disks, durability of data is critical for hello persistent storage platform.</span></span> <span data-ttu-id="8f8f2-136">Zákazníci, Azure mají důležitých podnikových aplikací běžících na IaaS a jsou závislé na hello trvalost dat hello.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-136">Azure customers have important business applications running on IaaS and they depend on hello persistence of hello data.</span></span> <span data-ttu-id="8f8f2-137">Ochrana Azure návrhy pro tyto disky IaaS s tři redundantní kopie dat uložených místně, poskytuje vysokou odolnost proti selhání místní.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-137">Azure designs protection for these IaaS disks with three redundant copies of data stored locally, providing high durability against local failures.</span></span> <span data-ttu-id="8f8f2-138">Pokud jeden z hello hardwarové součásti, které obsahuje váš disk selže, virtuální počítač není ovlivněná protože nejsou k dispozici dva další kopie toosupport disku požadavky.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-138">If one of hello hardware components that holds your disk fails, your VM is not impacted because there are two additional copies toosupport disk requests.</span></span> <span data-ttu-id="8f8f2-139">Funguje bez problémů, i v případě selžou dva různé hardwarové komponenty podpora disk v hello stejné (což by bylo velmi výjimečných).</span><span class="sxs-lookup"><span data-stu-id="8f8f2-139">It works fine even if two different hardware components supporting a disk fail at hello same time (which would be very rare).</span></span> <span data-ttu-id="8f8f2-140">toohelp zkontrolujte uchováváme vždy tři repliky, služby Azure Storage hello automaticky vytvoří novou kopii dat na pozadí hello, pokud některý z tři kopie hello nedostupný.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-140">toohelp ensure we always maintain three replicas, hello Azure Storage service automatically spawns a new copy of data in hello background if one of hello three copies becomes unavailable.</span></span> <span data-ttu-id="8f8f2-141">Proto by neměl být nezbytné toouse RAID s Azure disky pro odolnost proti chybám.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-141">Therefore, it should not be necessary toouse RAID with Azure disks for fault tolerance.</span></span> <span data-ttu-id="8f8f2-142">Jednoduché RAID 0 konfigurace by mělo být dostatečné pro prokládání disky hello, pokud nezbytné toocreate větší svazky.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-142">A simple RAID 0 configuration should be sufficient for striping hello disks if necessary toocreate larger volumes.</span></span>

<span data-ttu-id="8f8f2-143">Z důvodu této architektuře **Azure má doručit konzistentně podnikové úrovni odolnost pro IaaS disky s špičkový NULOVÉ % [rozpočítat na roční období míra selhání](https://en.wikipedia.org/wiki/Annualized_failure_rate).**</span><span class="sxs-lookup"><span data-stu-id="8f8f2-143">Because of this architecture, **Azure has consistently delivered enterprise-grade durability for IaaS disks, with an industry-leading ZERO % [Annualized Failure Rate](https://en.wikipedia.org/wiki/Annualized_failure_rate).**</span></span>

<span data-ttu-id="8f8f2-144">Lokalizované hardwaru chyb na hello výpočetní hostitele nebo v úložišti hello platformy můžete někdy za následek dočasné nedostupnosti pro hello virtuálních počítačů, které se vztahuje hello [smlouva Azure SLA](https://azure.microsoft.com/support/legal/sla/virtual-machines/) dostupnosti virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-144">Localized hardware faults on hello compute host or in hello storage platform can sometimes result in temporary unavailability for hello VM which is covered by hello [Azure SLA](https://azure.microsoft.com/support/legal/sla/virtual-machines/) for VM Availability.</span></span> <span data-ttu-id="8f8f2-145">Azure poskytuje špičkový SLA pro jedné instance virtuálních počítačů, které použijte disky úložiště Premium.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-145">Azure also provides an industry-leading SLA for single VM instances that use Premium Storage disks.</span></span>

<span data-ttu-id="8f8f2-146">toosafeguard úlohy aplikací z výpadek kvůli dočasné nedostupnosti toohello na disk nebo virtuální počítač, můžete využít zákazníci [skupiny dostupnosti](../virtual-machines/windows/manage-availability.md).</span><span class="sxs-lookup"><span data-stu-id="8f8f2-146">toosafeguard application workloads from downtime due toohello temporary unavailability of a disk or VM, customers can leverage [Availability Sets](../virtual-machines/windows/manage-availability.md).</span></span> <span data-ttu-id="8f8f2-147">Dvě nebo více virtuálních počítačů v nastavení dostupnosti poskytuje redundanci pro aplikaci hello.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-147">Two or more virtual machines in an availability set provides redundancy for hello application.</span></span> <span data-ttu-id="8f8f2-148">Azure potom vytvoří tyto virtuální počítače a disky v doménách selhání samostatné s různé součásti napájení, sítě a serveru.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-148">Azure then creates these VMs and disks in separate fault domains with different power, network, and server components.</span></span> <span data-ttu-id="8f8f2-149">Proto selhání lokalizované hardwaru obvykle neovlivní více virtuálních počítačů v hello nastavit na hello stejnou dobu, tím vysokou dostupnost pro vaši aplikaci.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-149">Thus, localized hardware failures typically do not affect multiple VMs in hello set at hello same time, providing high availability for your application.</span></span> <span data-ttu-id="8f8f2-150">Předpokládá se, že s dostupností toouse vhodné nastavuje, když se vyžaduje vysoká dostupnost.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-150">It is considered a good practice toouse availability sets when high availability is required.</span></span> <span data-ttu-id="8f8f2-151">Další informace najdete v tématu aspekty hello zotavení po havárii, jsou popsané dál.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-151">For more information, see hello Disaster Recovery aspects detailed below.</span></span>

### <a name="backup-and-disaster-recovery"></a><span data-ttu-id="8f8f2-152">Zálohování a zotavení po havárii</span><span class="sxs-lookup"><span data-stu-id="8f8f2-152">Backup and Disaster Recovery</span></span>

<span data-ttu-id="8f8f2-153">Zotavení po havárii (DR) je možnost toorecover hello z výjimečných ale hlavní incidenty:-pouze dočasné, celou škálování selhání, jako je například přerušení služby, které ovlivňuje celou oblast.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-153">Disaster recovery (DR) is hello ability toorecover from rare but major incidents: non-transient, wide-scale failures, such as service disruption that affects an entire region.</span></span> <span data-ttu-id="8f8f2-154">Zotavení po havárii zahrnuje zálohování dat a archivaci a může zahrnovat ruční zásah, například obnovit databázi ze zálohy.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-154">Disaster recovery includes data backup and archiving, and may include manual intervention, such as restoring a database from backup.</span></span>

<span data-ttu-id="8f8f2-155">Hello platformy Azure integrovanou ochranu proti selhání lokalizované nemusí chránit plně hello virtuálních počítačů/disků v případě hello hlavní katastrofy, které může způsobit výpadky ve velkém měřítku.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-155">hello Azure platform’s built-in protection against localized failures may not fully protect hello VMs/disks in hello case of major disasters which can cause large-scale outages.</span></span> <span data-ttu-id="8f8f2-156">To zahrnuje závažné události, jako je například datové centrum, se setkají hurikán, zemětřesení, ještě efektivněji nebo selhání jednotky hardwaru velkém měřítku.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-156">This includes catastrophic events such as a data center being hit by a hurricane, earthquake, fire, or large scale hardware unit failures.</span></span> <span data-ttu-id="8f8f2-157">Kromě toho může dojít k selhání kvůli potížím s tooapplication nebo data.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-157">In addition, you may encounter failures due tooapplication or data issues.</span></span>

<span data-ttu-id="8f8f2-158">toohelp chránit vaše úlohy IaaS z výpadky, měli byste naplánovat obnovu tooenable redundance a zálohování.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-158">toohelp protect your IaaS workloads from outages, you should plan for redundancy and backups tooenable recovery.</span></span> <span data-ttu-id="8f8f2-159">Pro zotavení po havárii měli byste naplánovat redundance a zálohování v jiném geografické umístění mimo hello primární lokality.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-159">For disaster recovery, you should plan redundancy and backup in a different geographic location away from hello primary site.</span></span> <span data-ttu-id="8f8f2-160">To pomáhá zajistit zálohování nemá vliv hello stejnou událost, která původně dopad hello virtuálního počítače nebo disků.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-160">This helps ensure your backup is not affected by hello same event that originally impacted hello VM or disks.</span></span> <span data-ttu-id="8f8f2-161">Další informace najdete v tématu [zotavení po havárii pro aplikace vytvořené v Azure](https://docs.microsoft.com/azure/architecture/resiliency/disaster-recovery-azure-applications).</span><span class="sxs-lookup"><span data-stu-id="8f8f2-161">For more information, see [Disaster Recovery for Applications built on Azure](https://docs.microsoft.com/azure/architecture/resiliency/disaster-recovery-azure-applications).</span></span>

<span data-ttu-id="8f8f2-162">Důležité informace o vaší zotavení po Havárii může zahrnovat hello následující aspekty:</span><span class="sxs-lookup"><span data-stu-id="8f8f2-162">Your DR considerations may include hello following aspects:</span></span>

1. <span data-ttu-id="8f8f2-163">Vysoké dostupnosti (HA) je schopnost hello toocontinue hello aplikace spuštěna v dobrém stavu, bez významné výpadky.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-163">High Availability (HA) is hello ability of hello application toocontinue running in a healthy state, without significant downtime.</span></span> <span data-ttu-id="8f8f2-164">Podle "stavu v pořádku," jsme znamená hello aplikace reaguje, a uživatelé můžou připojit toohello aplikace a pracovat s ním.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-164">By "healthy state," we mean hello application is responsive, and users can connect toohello application and interact with it.</span></span> <span data-ttu-id="8f8f2-165">Některé důležité aplikace a databáze může být k dispozici požadované toobe vždy, i v případě, že tam jsou chyby v platformě hello.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-165">Certain mission-critical applications and databases may be required toobe available always, even when there are failures in hello platform.</span></span> <span data-ttu-id="8f8f2-166">Pro tyto úlohy pravděpodobně bude třeba tooplan redundance pro hello aplikace a také hello data.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-166">For these workloads, you may need tooplan redundancy for hello application as well as hello data.</span></span>

2. <span data-ttu-id="8f8f2-167">Odolnost data: V některých případech hlavní pozornost hello je zajistit, že uchování dat hello hello v případě havárie.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-167">Data Durability: In some cases, hello main consideration is ensuring hello data is preserved in hello case of a disaster.</span></span> <span data-ttu-id="8f8f2-168">Proto může být nutné zálohování dat v jiné lokalitě.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-168">Therefore, you may need a backup of your data in a different site.</span></span> <span data-ttu-id="8f8f2-169">Pro taková zatížení možná nebudete potřebovat úplné redundance pro hello aplikaci, ale pravidelné zálohy disků hello.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-169">For such workloads, you may not need full redundancy for hello application, but a regular backup of hello disks.</span></span>

## <a name="backup-and-dr-scenarios"></a><span data-ttu-id="8f8f2-170">Zálohování a zotavení po Havárii scénáře</span><span class="sxs-lookup"><span data-stu-id="8f8f2-170">Backup and DR Scenarios</span></span>

<span data-ttu-id="8f8f2-171">Podívejme se na několik typické příklady hello aspekty pro plánování zotavení po havárii a scénáře zatížení aplikací.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-171">Let’s look at a few typical examples of application workload scenarios and hello considerations for planning Disaster Recovery.</span></span>

### <a name="scenario-1-major-database-solutions"></a><span data-ttu-id="8f8f2-172">Scénář 1: Hlavní databáze řešení</span><span class="sxs-lookup"><span data-stu-id="8f8f2-172">Scenario 1: Major Database Solutions</span></span>

<span data-ttu-id="8f8f2-173">Vezměte v úvahu produkční databázový server jako SQL Server nebo Oracle, který podporuje vysokou dostupnost.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-173">Consider a production database server like SQL Server or Oracle that can support High Availability.</span></span> <span data-ttu-id="8f8f2-174">Kritický produkční aplikace a uživatelé závisí na tuto databázi.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-174">Critical production applications and users depend on this database.</span></span> <span data-ttu-id="8f8f2-175">Hello plánu zotavení po havárii pro tento systém může být nutné toosupport hello následující požadavky:</span><span class="sxs-lookup"><span data-stu-id="8f8f2-175">hello Disaster Recovery plan for this system may need toosupport hello following requirements:</span></span>

1. <span data-ttu-id="8f8f2-176">Data musí být chráněný a obnovitelný.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-176">Data must be protected and recoverable.</span></span>
2.  <span data-ttu-id="8f8f2-177">Server musí být k dispozici pro použití.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-177">Server must be available for use.</span></span>

<span data-ttu-id="8f8f2-178">Může to vyžadovat zachování repliky databáze hello v jiné oblasti jako záložní.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-178">This may require maintaining a replica of hello database in a different region as a backup.</span></span> <span data-ttu-id="8f8f2-179">Hello řešení může v závislosti na požadavcích hello pro dostupnost serveru a obnovení dat, v rozsahu od aktivní-aktivní nebo aktivní – pasivní repliky lokality tooperiodic offline zálohování dat hello.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-179">Depending on hello requirements for server availability and data recovery, hello solution could range from an Active-Active or Active-Passive replica site tooperiodic offline backups of hello data.</span></span> <span data-ttu-id="8f8f2-180">Relační databáze jako je například SQL Server a Oracle poskytují různé možnosti pro replikaci.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-180">Relational databases such as SQL Server and Oracle provide various options for replication.</span></span> <span data-ttu-id="8f8f2-181">Pro systém SQL Server [SQL serveru skupin dostupnosti Always On](https://msdn.microsoft.com/library/hh510230.aspx) lze použít pro vysokou dostupnost.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-181">For SQL Server, [SQL Server Always On Availability Groups](https://msdn.microsoft.com/library/hh510230.aspx) can be used for high availability.</span></span>

<span data-ttu-id="8f8f2-182">Databáze NoSQL, jako MongoDB také podporují [repliky](https://docs.mongodb.com/manual/replication/) redundanci.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-182">NoSQL databases like MongoDB also support [replicas](https://docs.mongodb.com/manual/replication/) for redundancy.</span></span> <span data-ttu-id="8f8f2-183">Hello replik pro zajištění vysoké dostupnosti lze použít.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-183">hello replicas for high availability can be used.</span></span>

### <a name="scenario-2-a-cluster-of-redundant-vms"></a><span data-ttu-id="8f8f2-184">Scénář 2: Cluster redundantní virtuální počítače</span><span class="sxs-lookup"><span data-stu-id="8f8f2-184">Scenario 2: A cluster of redundant VMs</span></span>

<span data-ttu-id="8f8f2-185">Vezměte v úvahu zatížení zpracovává cluster virtuálních počítačů, které poskytují redundanci a vyrovnávání zatížení.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-185">Consider a workload handled by a cluster of VMs that provide redundancy and load balancing.</span></span> <span data-ttu-id="8f8f2-186">Příkladem může být cluster Cassandra nasazené v oblasti.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-186">One example would be a Cassandra cluster deployed in a region.</span></span> <span data-ttu-id="8f8f2-187">Tento typ architektury již poskytuje vysokou úroveň redundance v rámci této oblasti.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-187">This type of architecture already provides a high level of redundancy within that region.</span></span> <span data-ttu-id="8f8f2-188">Ale tooprotect hello zatížení v případě selhání místní úrovni, měli byste zvážit šíření hello clusteru rámci dvou oblastí nebo provádění pravidelné zálohy tooanother oblast.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-188">However, tooprotect hello workload from a regional level failure, you should consider spreading hello cluster across two regions or making periodic backups tooanother region.</span></span>

### <a name="scenario-3-iaas-application-workload"></a><span data-ttu-id="8f8f2-189">Scénář 3: IaaS aplikace zatížení</span><span class="sxs-lookup"><span data-stu-id="8f8f2-189">Scenario 3: IaaS Application Workload</span></span>

<span data-ttu-id="8f8f2-190">To může být typické provozní úlohu spuštěnou na virtuální počítač Azure.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-190">This could be a typical production workload running on an Azure VM.</span></span> <span data-ttu-id="8f8f2-191">Například může být na webovém serveru nebo souborového serveru, která uchovává hello obsah a dalším prostředkům lokality.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-191">For example, it could be a web server or file server holding hello content and other resources of a site.</span></span> <span data-ttu-id="8f8f2-192">Mohou být také uživatelské obchodní aplikace běžící v virtuální počítač, který uložené prostředky, stav aplikace a jeho data na disky virtuálních počítačů hello.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-192">It could also be a custom-built business application running on a VM that stored its data, resources, and application state on hello VM disks.</span></span> <span data-ttu-id="8f8f2-193">V takovém případě je důležité toomake se, že provedete zálohy v pravidelných intervalech.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-193">In this case, it is important toomake sure you take backups on a regular basis.</span></span> <span data-ttu-id="8f8f2-194">Četnost zálohování by měla být založena na hello povaha hello zatížení virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-194">Backup frequency should be based on hello nature of hello VM workload.</span></span> <span data-ttu-id="8f8f2-195">Například pokud aplikace hello spouští každý den a mění data, pak hello zálohování třeba přijmout každou hodinu.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-195">For example, if hello application runs every day and modifies data, then hello backup should be taken every hour.</span></span>

<span data-ttu-id="8f8f2-196">Dalším příkladem je server pro sestavy této načítat data z jiných zdrojů a generuje souhrnné sestavy.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-196">Another example is a reporting server that pull data from other sources and generates aggregated reports.</span></span> <span data-ttu-id="8f8f2-197">Ztrátě tohoto virtuálního počítače nebo disky povede ke ztrátě toohello hello sestav.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-197">Loss of this VM or disks will lead toohello loss of hello reports.</span></span> <span data-ttu-id="8f8f2-198">Však může být možné toorerun hello reporting proces a opětovné vytváření hello výstup.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-198">However, it may be possible toorerun hello reporting process and regenerate hello output.</span></span> <span data-ttu-id="8f8f2-199">V takovém případě nemáte skutečně ztrátu dat i v případě, že server pro sestavy hello je dosáhl s po havárii, tak může mít vyšší úroveň tolerance pro ztráty součástí hello dat na server pro sestavy hello.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-199">In that case, you don’t really have a loss of data even if hello reporting server is hit with a disaster, so you could have a higher level of tolerance for losing part of hello data on hello reporting server.</span></span> <span data-ttu-id="8f8f2-200">V takovém případě méně časté zálohování je nákladů na možnost tooreduce hello.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-200">In that case, less frequent backups is an option tooreduce hello cost.</span></span>

### <a name="scenario-4-iaas-application-data-issues"></a><span data-ttu-id="8f8f2-201">Scénář 4: Aplikace IaaS dat problémy</span><span class="sxs-lookup"><span data-stu-id="8f8f2-201">Scenario 4: IaaS Application data issues</span></span>

<span data-ttu-id="8f8f2-202">Máte aplikaci, která vypočítá, udržuje a slouží důležitá obchodní data, například informace o cenách.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-202">You have an application that computes, maintains, and serves critical commercial data such as pricing information.</span></span> <span data-ttu-id="8f8f2-203">Nová verze aplikace měla chyb softwaru, který nesprávně počítaný hello ceny a poškozený stávající data a obchodu Spojených států hello obsloužených hello platformy.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-203">A new version of your application had a software bug which incorrectly computed hello pricing and corrupted hello existing commerce data served by hello platform.</span></span> <span data-ttu-id="8f8f2-204">Zde hello nejlepším řešením může být toorevert toohello dřívější verzi hello aplikace a hello data první.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-204">Here, hello best course of action would be toorevert toohello earlier version of hello application and hello data first.</span></span> <span data-ttu-id="8f8f2-205">tooenable se proveďte pravidelné zálohy systému.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-205">tooenable this, take periodic backups of your system.</span></span>

## <a name="disaster-recovery-solution-azure-backup-service"></a><span data-ttu-id="8f8f2-206">Řešení zotavení po havárii: Služba Azure Backup</span><span class="sxs-lookup"><span data-stu-id="8f8f2-206">Disaster Recovery Solution: Azure Backup Service</span></span>

<span data-ttu-id="8f8f2-207">[Služba Azure Backup](https://azure.microsoft.com/services/backup/) je lze použít pro zálohování a zotavení po Havárii a funguje s [spravované disky](storage-managed-disks-overview.md) a také [nespravované disky](storage-about-disks-and-vhds-windows.md#unmanaged-disks).</span><span class="sxs-lookup"><span data-stu-id="8f8f2-207">[Azure Backup Service](https://azure.microsoft.com/services/backup/) is can be used for Backup and DR, and it works with [Managed Disks](storage-managed-disks-overview.md) as well as [Unmanaged Disks](storage-about-disks-and-vhds-windows.md#unmanaged-disks).</span></span> <span data-ttu-id="8f8f2-208">Můžete vytvořit úlohu zálohování s zálohy založené na čase, snadno obnovení virtuálních počítačů a zásady uchovávání záloh.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-208">You can create a backup job with time-based backups, easy VM restoration and backup retention policies.</span></span> 

<span data-ttu-id="8f8f2-209">Pokud používáte [disky úložiště Premium](storage-premium-storage.md), [spravované disky](storage-managed-disks-overview.md), nebo jiných typů disku s hello [místně redundantní úložiště (LRS)](storage-redundancy.md#locally-redundant-storage) možnost, je zvlášť důležité tooleverage pravidelné zálohy zotavení po Havárii.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-209">If you use [Premium Storage disks](storage-premium-storage.md), [Managed Disks](storage-managed-disks-overview.md), or other disk types with hello [locally redundant storage (LRS)](storage-redundancy.md#locally-redundant-storage) option, it is especially important tooleverage periodic DR backups.</span></span> <span data-ttu-id="8f8f2-210">Zálohování Azure ukládá hello data ve vašem trezoru služeb zotavení pro dlouhodobé uchovávání.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-210">Azure Backup stores hello data in your Recovery Services vault for long term retention.</span></span> <span data-ttu-id="8f8f2-211">Zvolte hello [geograficky redundantní úložiště (GRS)](storage-redundancy.md#geo-redundant-storage) možnost pro trezor služeb zotavení hello zálohování.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-211">Choose hello [Geo-redundant storage (GRS)](storage-redundancy.md#geo-redundant-storage) option for hello Backup Recovery Services vault.</span></span> <span data-ttu-id="8f8f2-212">Se ujistěte se, že zálohy jsou replikované tooa jiné oblasti Azure pro zabezpečení z místní havárie.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-212">That will ensure backups are replicated tooa different Azure region for safeguarding from regional disasters.</span></span>

<span data-ttu-id="8f8f2-213">Pro [nespravované disky](storage-about-disks-and-vhds-windows.md#unmanaged-disks), můžete použít typ úložiště LRS hello disků IaaS, ale ujistěte se, že Azure Backup je povolená s hello GRS možnost pro hello trezoru služeb zotavení.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-213">For [Unmanaged Disks](storage-about-disks-and-vhds-windows.md#unmanaged-disks), you can use hello LRS storage type for IaaS disks, but ensure that Azure Backup is enabled with hello GRS option for hello Recovery Services Vault.</span></span>

<span data-ttu-id="8f8f2-214">**Pokud používáte hello [GRS](storage-redundancy.md#geo-redundant-storage)/[RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage) možnost pro nespravovaná disky, je stále nutné snímky konzistentní s aplikacemi pro zálohování a zotavení po Havárii.**</span><span class="sxs-lookup"><span data-stu-id="8f8f2-214">**If you use hello [GRS](storage-redundancy.md#geo-redundant-storage)/[RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage) option for your Unmanaged Disks, you still need consistent snapshots for Backup and DR.**</span></span> <span data-ttu-id="8f8f2-215">Je nutné použít buď [služby zálohování Azure](https://azure.microsoft.com/services/backup/) nebo [snímky konzistentní](#alternative-solution-consistent-snapshots).</span><span class="sxs-lookup"><span data-stu-id="8f8f2-215">You must use either [Azure Backup Service](https://azure.microsoft.com/services/backup/) or [consistent snapshots](#alternative-solution-consistent-snapshots).</span></span>

<span data-ttu-id="8f8f2-216">Hello Následuje souhrn řešení pro zotavení po Havárii.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-216">hello following is a summary of solutions for DR.</span></span>

| <span data-ttu-id="8f8f2-217">Scénář</span><span class="sxs-lookup"><span data-stu-id="8f8f2-217">Scenario</span></span> | <span data-ttu-id="8f8f2-218">Automatické replikace</span><span class="sxs-lookup"><span data-stu-id="8f8f2-218">Automatic Replication</span></span> | <span data-ttu-id="8f8f2-219">Řešení zotavení po Havárii</span><span class="sxs-lookup"><span data-stu-id="8f8f2-219">DR Solution</span></span> |
| --- | --- | --- |
| <span data-ttu-id="8f8f2-220">*Disky úložiště Premium*</span><span class="sxs-lookup"><span data-stu-id="8f8f2-220">*Premium Storage Disks*</span></span> | <span data-ttu-id="8f8f2-221">Místní ([LRS](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="8f8f2-221">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="8f8f2-222">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="8f8f2-222">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="8f8f2-223">*Managed Disks*</span><span class="sxs-lookup"><span data-stu-id="8f8f2-223">*Managed Disks*</span></span> | <span data-ttu-id="8f8f2-224">Místní ([LRS](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="8f8f2-224">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="8f8f2-225">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="8f8f2-225">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="8f8f2-226">*Nespravované LRS disky*</span><span class="sxs-lookup"><span data-stu-id="8f8f2-226">*Unmanaged LRS Disks*</span></span> | <span data-ttu-id="8f8f2-227">Místní ([LRS](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="8f8f2-227">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="8f8f2-228">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="8f8f2-228">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="8f8f2-229">*Nespravované GRS disky*</span><span class="sxs-lookup"><span data-stu-id="8f8f2-229">*Unmanaged GRS Disks*</span></span> | <span data-ttu-id="8f8f2-230">Pro různé oblasti ([GRS](storage-redundancy.md#geo-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="8f8f2-230">Cross region ([GRS](storage-redundancy.md#geo-redundant-storage))</span></span> | [<span data-ttu-id="8f8f2-231">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="8f8f2-231">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/)<br/>[<span data-ttu-id="8f8f2-232">Snímky konzistentní s aplikacemi</span><span class="sxs-lookup"><span data-stu-id="8f8f2-232">Consistent snapshots</span></span>](#alternative-solution-consistent-snapshots) |
| <span data-ttu-id="8f8f2-233">*Nespravované RA-GRS disky*</span><span class="sxs-lookup"><span data-stu-id="8f8f2-233">*Unmanaged RA-GRS Disks*</span></span> | <span data-ttu-id="8f8f2-234">Pro různé oblasti ([RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="8f8f2-234">Cross region ([RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage))</span></span> | [<span data-ttu-id="8f8f2-235">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="8f8f2-235">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/)<br/>[<span data-ttu-id="8f8f2-236">Snímky konzistentní s aplikacemi</span><span class="sxs-lookup"><span data-stu-id="8f8f2-236">Consistent snapshots</span></span>](#alternative-solution-consistent-snapshots) |

<span data-ttu-id="8f8f2-237">Zajištění vysoké dostupnosti můžete nejlépe pomocí splní prostřednictvím použití hello spravované disků ve skupiny dostupnosti společně s Azure Backup.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-237">High availability can best by met through hello use of Managed Disks in an Availability Set along with Azure Backup.</span></span> <span data-ttu-id="8f8f2-238">Pokud používáte nespravované disky, stále můžete zálohování Azure pro zotavení po Havárii.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-238">If you are using Unmanaged Disks, you can still  use Azure Backup for DR.</span></span> <span data-ttu-id="8f8f2-239">Pokud jste nelze toouse Azure Backup, pak trvá [snímky konzistentní](#alternative-solution-consistent-snapshots) jak je popsáno v další části je alternativní řešení pro zálohování a zotavení po Havárii.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-239">If you are unable toouse Azure Backup, then taking [consistent snapshots](#alternative-solution-consistent-snapshots) as described in a later section is an alternative solution for Backup and DR.</span></span>

<span data-ttu-id="8f8f2-240">Vaše volby pro vysokou dostupnost, zálohování a zotavení po Havárii aplikace nebo infrastruktury úrovni může být reprezentován jako níže:</span><span class="sxs-lookup"><span data-stu-id="8f8f2-240">Your choices for high availability, backup and DR at Application or Infrastructure levels can be represented as below:</span></span>

| <span data-ttu-id="8f8f2-241">*Úroveň*</span><span class="sxs-lookup"><span data-stu-id="8f8f2-241">*Level*</span></span> | <span data-ttu-id="8f8f2-242">Vysoká dostupnost</span><span class="sxs-lookup"><span data-stu-id="8f8f2-242">High Availability</span></span>   | <span data-ttu-id="8f8f2-243">Zálohování nebo zotavení po Havárii</span><span class="sxs-lookup"><span data-stu-id="8f8f2-243">Backup / DR</span></span> |
| --- | --- | --- |
| <span data-ttu-id="8f8f2-244">*Aplikace*</span><span class="sxs-lookup"><span data-stu-id="8f8f2-244">*Application*</span></span> | <span data-ttu-id="8f8f2-245">Always On SQL</span><span class="sxs-lookup"><span data-stu-id="8f8f2-245">SQL Always On</span></span> | <span data-ttu-id="8f8f2-246">Azure Backup</span><span class="sxs-lookup"><span data-stu-id="8f8f2-246">Azure Backup</span></span> |
| <span data-ttu-id="8f8f2-247">*Infrastruktury*</span><span class="sxs-lookup"><span data-stu-id="8f8f2-247">*Infrastructure*</span></span>  | <span data-ttu-id="8f8f2-248">Skupina dostupnosti</span><span class="sxs-lookup"><span data-stu-id="8f8f2-248">Availability Set</span></span>  | <span data-ttu-id="8f8f2-249">GRS s snímky konzistentní s aplikacemi</span><span class="sxs-lookup"><span data-stu-id="8f8f2-249">GRS with consistent snapshots</span></span> |

### <a name="using-hello-azure-backup-service"></a><span data-ttu-id="8f8f2-250">Pomocí hello služby zálohování Azure</span><span class="sxs-lookup"><span data-stu-id="8f8f2-250">Using hello Azure Backup Service</span></span>

<span data-ttu-id="8f8f2-251">[Zálohování Azure](../backup/backup-azure-vms-introduction.md) může zálohovat virtuální počítače s Windows nebo Linux toohello trezoru služeb zotavení Azure.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-251">[Azure Backup](../backup/backup-azure-vms-introduction.md) can backup your VMs running Windows or Linux toohello Azure Recovery Services Vault.</span></span> <span data-ttu-id="8f8f2-252">Zálohování a obnovení důležitých podnikových dat ztěžuje hello skutečnost, že důležitých podnikových dat je třeba zálohovat při hello aplikace, které vytvářejí hello dat běží.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-252">Backing up and restoring business-critical data is complicated by hello fact that business-critical data must be backed up while hello applications that produce hello data are running.</span></span> <span data-ttu-id="8f8f2-253">tooaddress, Azure Backup poskytuje zálohování konzistentní s aplikací pro Microsoft úlohy pomocí tooensure hello služby Stínová svazku (VSS), že data jsou zapsána správně toostorage.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-253">tooaddress this, Azure Backup provides application-consistent backups for Microsoft workloads by using hello Volume Shadow Service (VSS) tooensure that data is written correctly toostorage.</span></span> <span data-ttu-id="8f8f2-254">Pro virtuální počítače s Linuxem je možné, pouze konzistentními soubory zálohy, protože Linux nemá ekvivalentní tooVSS funkce.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-254">For Linux VMs, only file-consistent backups are possible, since Linux does not have functionality equivalent tooVSS.</span></span>

![][1]

<span data-ttu-id="8f8f2-255">Když spustí úlohu zálohování Azure Backup v hello naplánované době aktivuje rozšíření zálohování hello nainstalované v hello tootake virtuálních počítačů v okamžiku snímku.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-255">When Azure Backup initiates a backup job at hello scheduled time, it triggers hello backup extension installed in hello VM tootake a point-in-time snapshot.</span></span> <span data-ttu-id="8f8f2-256">Pořízení snímku v koordinaci s VSS tooget konzistentního snímku hello disků ve virtuálním počítači hello bez nutnosti tooshut ho dolů.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-256">A snapshot is taken in coordination with VSS tooget a consistent snapshot of hello disks in hello virtual machine without having tooshut it down.</span></span> <span data-ttu-id="8f8f2-257">Rozšíření zálohování Hello v hello virtuálních počítačů vyprázdnění všech zápisů před přepnutím snímky konzistentní s hello všech disků hello.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-257">hello backup extension in hello VM flushes all writes before taking hello consistent snapshot of all hello disks.</span></span> <span data-ttu-id="8f8f2-258">Po pořízení snímku hello, hello data se přenáší přes Azure Backup toohello úložiště záloh.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-258">After hello snapshot is taken, hello data is transferred by Azure Backup toohello backup vault.</span></span> <span data-ttu-id="8f8f2-259">toomake hello proces zálohování efektivnější, služba hello identifikuje a přenáší pouze hello bloky dat, které se změnily od poslední zálohy hello.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-259">toomake hello backup process more efficient, hello service identifies and transfers only hello blocks of data that have changed since hello last backup.</span></span>


<span data-ttu-id="8f8f2-260">toorestore, můžete zobrazit hello k dispozici zálohování pomocí zálohování Azure a pak spustit obnovení.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-260">toorestore, you can view hello available backups through Azure Backup and then initiate a restore.</span></span> <span data-ttu-id="8f8f2-261">Můžete vytvořit a obnovit zálohování Azure prostřednictvím hello [portál Azure](https://portal.azure.com/), [pomocí prostředí PowerShell](../backup/backup-azure-vms-automation.md ), nebo pomocí hello [rozhraní příkazového řádku Azure](https://docs.microsoft.com/azure/xplat-cli-install).</span><span class="sxs-lookup"><span data-stu-id="8f8f2-261">You can create and restore Azure backups through hello [Azure portal](https://portal.azure.com/), [using PowerShell](../backup/backup-azure-vms-automation.md ), or using hello [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install).</span></span> <span data-ttu-id="8f8f2-262">Další informace najdete v tématu Zálohování Azure.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-262">For more information, see Azure Backup.</span></span>

### <a name="steps-tooenable-backup"></a><span data-ttu-id="8f8f2-263">Kroky tooEnable zálohování</span><span class="sxs-lookup"><span data-stu-id="8f8f2-263">Steps tooEnable Backup</span></span>

<span data-ttu-id="8f8f2-264">Hello následující kroky jsou obvykle používanými tooenable zálohování virtuálních počítačů pomocí hello [portálu Azure](https://portal.azure.com/).</span><span class="sxs-lookup"><span data-stu-id="8f8f2-264">hello following steps are typically used tooenable backups of your VMs using hello [Azure Portal](https://portal.azure.com/).</span></span> <span data-ttu-id="8f8f2-265">Bude existovat několik odchylek v závislosti na přesný scénář.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-265">There will be some variations depending on your exact scenario.</span></span> <span data-ttu-id="8f8f2-266">Odkazovat toohello [Azure Backup](../backup/backup-azure-vms-introduction.md) dokumentace pro úplné podrobnosti.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-266">Refer toohello [Azure Backup](../backup/backup-azure-vms-introduction.md) documentation for full details.</span></span> <span data-ttu-id="8f8f2-267">Azure také zálohování [podporuje virtuální počítače s spravované disky](https://azure.microsoft.com/blog/azure-managed-disk-backup/).</span><span class="sxs-lookup"><span data-stu-id="8f8f2-267">Azure Backup also [supports VMs with Managed Disks](https://azure.microsoft.com/blog/azure-managed-disk-backup/).</span></span>

1.  <span data-ttu-id="8f8f2-268">Vytvoření trezoru služeb zotavení pro virtuální počítač pomocí hello následující kroky:</span><span class="sxs-lookup"><span data-stu-id="8f8f2-268">Create a recovery services vault for a VM using hello following steps:</span></span>

    <span data-ttu-id="8f8f2-269">a.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-269">a.</span></span>  <span data-ttu-id="8f8f2-270">Pomocí hello [portál Azure](https://portal.azure.com/), procházet všechny prostředky a vyhledávat "Trezory služeb zotavení".</span><span class="sxs-lookup"><span data-stu-id="8f8f2-270">Using hello [Azure portal](https://portal.azure.com/), browse all resources and find “Recovery Services vaults”.</span></span>

    <span data-ttu-id="8f8f2-271">b.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-271">b.</span></span>  <span data-ttu-id="8f8f2-272">Na hello trezory služeb zotavení nabídky, klikněte na tlačítko Přidat a postupujte podle kroků toocreate hello nový trezor v hello stejné oblasti jako hello virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-272">On hello Recovery Services vaults menu, click Add and follow hello steps toocreate a new vault in hello same region as hello VM.</span></span> <span data-ttu-id="8f8f2-273">Například pokud vaše virtuální počítač v oblasti západní USA, vyberte pro trezor hello západní USA.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-273">For example, if your VM is in West US region, pick West US for hello vault.</span></span>

2.  <span data-ttu-id="8f8f2-274">Ověřte hello úložiště replikace pro nově vytvořený trezor hello.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-274">Verify hello Storage replication for hello newly created vault.</span></span> <span data-ttu-id="8f8f2-275">toodo se vault hello přístup z hello služeb zotavení trezory okno a přejděte toohello nastavení nebo zálohu konfigurace.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-275">toodo this, access hello vault from hello Recovery Services vaults blade and go toohello settings/Backup Configuration.</span></span> <span data-ttu-id="8f8f2-276">Zkontrolujte, zda hello GRS možnost je standardně vybraná.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-276">Ensure hello GRS option is selected by default.</span></span> <span data-ttu-id="8f8f2-277">Tím bude zajištěno, že je váš trezor automaticky replikované tooa sekundárního datového centra.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-277">This will ensure that your vault is automatically replicated tooa secondary data center.</span></span> <span data-ttu-id="8f8f2-278">Například trezoru v západní USA bude automaticky replikované tooEast USA.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-278">For example, your vault in West US will be automatically replicated tooEast US.</span></span>

3.  <span data-ttu-id="8f8f2-279">Nakonfigurujte zásady zálohování hello a vyberte hello virtuálních počítačů z hello stejné uživatelské rozhraní.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-279">Configure hello backup policy and select hello VM from hello same UI.</span></span>

4.  <span data-ttu-id="8f8f2-280">Ujistěte se, zda text hello, instalace agenta zálohování na hello virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-280">Make sure hello Backup Agent is installed on hello VM.</span></span> <span data-ttu-id="8f8f2-281">Pokud váš virtuální počítač je vytvořen pomocí image Galerie Azure, hello Backup agent již nainstalován.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-281">If your VM is created using an Azure gallery image, then hello Backup agent is already installed.</span></span> <span data-ttu-id="8f8f2-282">Jinak (tj. Pokud používáte vlastní image), použijte pokyny příliš[hello instalace agenta virtuálního počítače na virtuálním počítači hello](../backup/backup-azure-arm-vms-prepare.md#install-the-vm-agent-on-the-virtual-machine).</span><span class="sxs-lookup"><span data-stu-id="8f8f2-282">Otherwise (that is, if you are using a custom image), use instructions too[Install hello VM Agent on hello virtual machine](../backup/backup-azure-arm-vms-prepare.md#install-the-vm-agent-on-the-virtual-machine).</span></span>

5.  <span data-ttu-id="8f8f2-283">Ujistěte se, že hello virtuálního počítače umožňuje připojení k síti pro služby zálohování toofunction hello.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-283">Make sure that hello VM allows network connectivity for hello backup service toofunction.</span></span> <span data-ttu-id="8f8f2-284">Postupujte podle těchto pokynů pro [připojení k síti](../backup/backup-azure-arm-vms-prepare.md#network-connectivity).</span><span class="sxs-lookup"><span data-stu-id="8f8f2-284">Follow these instructions for [Network connectivity](../backup/backup-azure-arm-vms-prepare.md#network-connectivity).</span></span>

6.  <span data-ttu-id="8f8f2-285">Po dokončení hello výše kroky jsou hello zálohování se spustí v pravidelných intervalech podle zásady zálohování hello.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-285">Once hello above steps are completed, hello backup will run at regular intervals as specified in hello backup policy.</span></span> <span data-ttu-id="8f8f2-286">V případě potřeby můžete aktivovat hello první zálohy ručně z panelu trezoru hello na hello portálu Azure.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-286">If necessary, you can trigger hello first backup manually from hello vault dashboard on hello Azure portal.</span></span>

<span data-ttu-id="8f8f2-287">Pro automatizaci Azure Backup pomocí skriptů, naleznete v příliš[rutiny prostředí PowerShell pro zálohování virtuálních počítačů](../backup/backup-azure-vms-automation.md).</span><span class="sxs-lookup"><span data-stu-id="8f8f2-287">For automating Azure Backup using scripts, please refer too[PowerShell cmdlets for VM backup](../backup/backup-azure-vms-automation.md).</span></span>

### <a name="steps-for-recovery"></a><span data-ttu-id="8f8f2-288">Kroky pro obnovení</span><span class="sxs-lookup"><span data-stu-id="8f8f2-288">Steps for Recovery</span></span>

<span data-ttu-id="8f8f2-289">Pokud potřebujete toorepair nebo znovu sestavte virtuální počítač, můžete obnovit hello virtuálních počítačů z libovolného hello body obnovení záloh v trezoru hello.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-289">If you need toorepair or rebuild a VM, you can restore hello VM from any of hello backup recovery points in hello vault.</span></span> <span data-ttu-id="8f8f2-290">Existuje několik různých možností pro obnovení hello:</span><span class="sxs-lookup"><span data-stu-id="8f8f2-290">There are a couple of different options for performing hello recovery:</span></span>

1.  <span data-ttu-id="8f8f2-291">Můžete vytvořit nový virtuální počítač jako reprezentace v okamžiku zálohy virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-291">You can create a new VM as a point-in-time representation of your backed-up VM.</span></span>

2.  <span data-ttu-id="8f8f2-292">Můžete obnovit hello disky a potom hello šablonu použít pro virtuální počítač toocustomize hello a opětovné sestavení hello obnovit virtuální počítač.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-292">You can restore hello disks and then use hello template for hello VM toocustomize and rebuild hello restored VM.</span></span> 

<span data-ttu-id="8f8f2-293">Zobrazí pokyny k příliš[virtuální počítače Azure pomocí portálu toorestore](../backup/backup-azure-arm-restore-vms.md#restoring-a-vm-during-azure-datacenter-disaster).</span><span class="sxs-lookup"><span data-stu-id="8f8f2-293">See instructions too[Use Azure portal toorestore virtual machines](../backup/backup-azure-arm-restore-vms.md#restoring-a-vm-during-azure-datacenter-disaster).</span></span> <span data-ttu-id="8f8f2-294">Hello dokumentu se vysvětluje také hello konkrétní kroky pro obnovení zálohy virtuálních počítačů toohello spárované datového centra pomocí vaší geograficky redundantní úložiště záloh v případě hello nebo přírodní katastrofě v hello primární datové centrum.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-294">hello document also explains hello specific steps for restoring backed-up VMs toohello paired data center using your geo-redundant backup vault in hello case of a disaster at hello primary data center.</span></span> <span data-ttu-id="8f8f2-295">V takovém případě Azure Backup používá hello výpočetní služba z hello sekundární oblasti toocreate hello obnovení virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-295">In that case, Azure Backup uses hello Compute service from hello secondary region toocreate hello restored virtual machine.</span></span>

<span data-ttu-id="8f8f2-296">Můžete také pomocí prostředí PowerShell pro [obnovení virtuálního počítače](../backup/backup-azure-vms-automation.md#restore-an-azure-vm) nebo [vytváření nového virtuálního počítače z obnovit disky](../backup/backup-azure-vms-automation.md#create-a-vm-from-restored-disks).</span><span class="sxs-lookup"><span data-stu-id="8f8f2-296">You can also use PowerShell for [restoring a VM](../backup/backup-azure-vms-automation.md#restore-an-azure-vm) or for [creating a new VM from restored disks](../backup/backup-azure-vms-automation.md#create-a-vm-from-restored-disks).</span></span>

## <a name="alternative-solution-consistent-snapshots"></a><span data-ttu-id="8f8f2-297">Alternativní řešení: Snímky konzistentní</span><span class="sxs-lookup"><span data-stu-id="8f8f2-297">Alternative Solution: Consistent Snapshots</span></span>

<span data-ttu-id="8f8f2-298">Pokud jste nelze toouse hello služby zálohování Azure, můžete implementovat vlastní zálohovací mechanismus, pomocí snímků.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-298">If you are unable toouse hello Azure Backup Service, you can implement your own backup mechanism using snapshots.</span></span> <span data-ttu-id="8f8f2-299">Je složitá toocreate snímky konzistentní s aplikacemi pro všechny disky používané Virtuálním počítačem a pak replikovat tyto snímky tooanother oblast.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-299">It is complicated toocreate consistent snapshots for all disks used by a VM and then replicate those snapshots tooanother region.</span></span> <span data-ttu-id="8f8f2-300">Z tohoto důvodu Azure zvažuje využívání hello služby zálohování vhodnější než vytváření vlastní řešení.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-300">For this reason, Azure considers leveraging hello Backup Service a better option than building a custom solution.</span></span> <span data-ttu-id="8f8f2-301">Pokud používáte RA-GRS nebo GRS úložiště pro disky, snímky jsou automaticky replikované tooa sekundárního datového centra.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-301">If you use RA-GRS/GRS storage for disks, snapshots are automatically replicated tooa secondary data center.</span></span> <span data-ttu-id="8f8f2-302">Pokud používáte LRS úložiště pro disky, musíte se tooreplicate hello data sami.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-302">If you use LRS storage for disks, you will need tooreplicate hello data yourself.</span></span> <span data-ttu-id="8f8f2-303">Další informace najdete v tématu [zálohování Azure nespravované disky virtuálních počítačů s přírůstkové snímky](storage-incremental-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="8f8f2-303">For more information, see [Back up Azure unmanaged VM disks with incremental snapshots](storage-incremental-snapshots.md).</span></span>

<span data-ttu-id="8f8f2-304">Snímek je reprezentace objektu v určitém bodě v čase.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-304">A snapshot is a representation of an object at a specific point in time.</span></span> <span data-ttu-id="8f8f2-305">Snímek zpoplatněná fakturace pro hello přírůstkové velikost dat hello ho blokování.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-305">A snapshot will incur billing for hello incremental size of hello data it holds.</span></span> <span data-ttu-id="8f8f2-306">Další informace najdete v tématu [vytvoření snímku blob](storage-blob-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="8f8f2-306">For more information, see [Create a blob snapshot](storage-blob-snapshots.md).</span></span>

### <a name="creating-snapshots-while-hello-vm-is-running"></a><span data-ttu-id="8f8f2-307">Vytváření snímků při hello je spuštěný virtuální počítač</span><span class="sxs-lookup"><span data-stu-id="8f8f2-307">Creating snapshots while hello VM is running</span></span>

<span data-ttu-id="8f8f2-308">Při snímek kdykoli, můžete provést v případě hello je spuštěný virtuální počítač, je stále data vysílá toohello disky a snímky hello může obsahovat částečné operace, které byly v cestě.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-308">While you can take a snapshot at any time, if hello VM is running, there is still data being streamed toohello disks, and hello snapshots may contain partial operations that were in flight.</span></span> <span data-ttu-id="8f8f2-309">Navíc pokud existují několik disků související se situací, hello snímky různých disků mohlo dojít v různou dobu, což znamená, že tyto snímky nemusí být koordinované.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-309">Also, if there are several disks involved, hello snapshots of different disks may have occurred at different times, which means these snapshots may not be coordinated.</span></span> <span data-ttu-id="8f8f2-310">To je obzvláště problematické pro prokládané svazky, jejichž souborů může být poškozená, pokud se během zálohování provedeny změny.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-310">This is especially problematic for striped volumes whose files can be corrupted if changes were being made during backup.</span></span>

<span data-ttu-id="8f8f2-311">tooavoid této situaci se proces zálohování hello musí implementovat hello následující kroky:</span><span class="sxs-lookup"><span data-stu-id="8f8f2-311">tooavoid this situation, hello backup process must implement hello following steps:</span></span>

1.  <span data-ttu-id="8f8f2-312">Freeze – všechny disky hello</span><span class="sxs-lookup"><span data-stu-id="8f8f2-312">Freeze all hello disks</span></span>

2.  <span data-ttu-id="8f8f2-313">Vyprázdnit všechny hello čekající na vyřízení zápisy</span><span class="sxs-lookup"><span data-stu-id="8f8f2-313">Flush all hello pending writes</span></span>

3.  <span data-ttu-id="8f8f2-314">Potom [vytvoření snímku blob](storage-blob-snapshots.md) pro všechny disky hello</span><span class="sxs-lookup"><span data-stu-id="8f8f2-314">Then, [create a blob snapshot](storage-blob-snapshots.md) for all hello disks</span></span>

<span data-ttu-id="8f8f2-315">Některé aplikace systému Windows, jako je SQL Server poskytují mechanismus koordinované zálohování pomocí zálohování konzistentní s aplikací toocreate služby Stínová kopie svazku.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-315">Some Windows applications like SQL Server provide a coordinated backup mechanism via VSS toocreate application-consistent backups.</span></span> <span data-ttu-id="8f8f2-316">V systému Linux můžete použít nástroje, jako je fsfreeze pro spolupráci hello disky, což poskytne konzistentními soubory zálohy, ale není snímky konzistentní s aplikacemi.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-316">On Linux, you can use a tool like fsfreeze for coordinating hello disks, which will provide file-consistent backups, but not application-consistent snapshots.</span></span> <span data-ttu-id="8f8f2-317">Tento proces je složitá, takže a měli byste zvážit použití [Azure Backup](../backup/backup-azure-vms-introduction.md) nebo řešení zálohování jiného výrobce, který už tuto funkci implementovat.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-317">This process is complicated, so and you should consider using [Azure Backup](../backup/backup-azure-vms-introduction.md) or a third-party backup solution which already implement this.</span></span>

<span data-ttu-id="8f8f2-318">Hello výše proces bude v kolekci koordinované snímků pro všechny disky virtuálního počítače hello představující konkrétní zobrazení v okamžiku hello virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-318">hello above process will result in a collection of coordinated snapshots for all hello VM disks, representing a specific point-in-time view of hello VM.</span></span> <span data-ttu-id="8f8f2-319">Toto je bod obnovení zálohy pro hello virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-319">This is a backup restore point for hello VM.</span></span> <span data-ttu-id="8f8f2-320">Proces hello v naplánovaných intervalech toocreate pravidelné zálohy, můžete opakovat.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-320">You can repeat hello process at scheduled intervals toocreate periodic backups.</span></span> <span data-ttu-id="8f8f2-321">Níže najdete kroky hello příliš[kopie hello zálohy tooanother oblast](#copy-the-snapshots-to-another-region) pro zotavení po Havárii.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-321">See below for hello steps too[copy hello backups tooanother region](#copy-the-snapshots-to-another-region) for DR.</span></span>

### <a name="creating-snapshots-while-hello-vm-is-offline"></a><span data-ttu-id="8f8f2-322">Vytváření snímků při hello virtuální počítač je v režimu offline</span><span class="sxs-lookup"><span data-stu-id="8f8f2-322">Creating snapshots while hello VM is offline</span></span>

<span data-ttu-id="8f8f2-323">Jiná možnost toocreate konzistentní zálohování probíhá ukončení hello virtuálních počítačů a objektů blob pořízení snímků každého disku.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-323">Another option toocreate consistent backups is shutting down hello VM and taking blob snapshots of each disk.</span></span> <span data-ttu-id="8f8f2-324">Toto je jednodušší než koordinující snímky spuštění virtuálního počítače, ale vyžaduje to pár minut nečinnosti.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-324">This is easier than coordinating snapshots of a running VM, but it requires a few minutes of downtime.</span></span> <span data-ttu-id="8f8f2-325">Pro tento proces postupujte takto:</span><span class="sxs-lookup"><span data-stu-id="8f8f2-325">For this process, follow these steps:</span></span>

1. <span data-ttu-id="8f8f2-326">Vypněte hello virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-326">Shut down hello VM.</span></span>

2. <span data-ttu-id="8f8f2-327">Vytvoření snímku každý objekt blob virtuálního pevného disku, který přebírá jenom pár sekund.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-327">Create a snapshot of each VHD blob, which only takes a few seconds.</span></span>

    <span data-ttu-id="8f8f2-328">toocreate snímek, můžete použít [prostředí PowerShell](storage-powershell-guide-full.md#how-to-manage-azure-blob-snapshots), hello [Rest API pro Azure Storage](https://msdn.microsoft.com/library/azure/ee691971.aspx), [rozhraní příkazového řádku Azure](https://docs.microsoft.com/azure/xplat-cli-install), nebo jeden z knihovny klienta Azure Storage hello jako [ Klientská knihovna pro Hello úložiště pro .NET](https://msdn.microsoft.com/library/azure/hh488361.aspx).</span><span class="sxs-lookup"><span data-stu-id="8f8f2-328">toocreate a snapshot, you can use [PowerShell](storage-powershell-guide-full.md#how-to-manage-azure-blob-snapshots), hello [Azure Storage Rest API](https://msdn.microsoft.com/library/azure/ee691971.aspx), [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install), or one of hello Azure Storage Client Libraries such as [hello Storage client library for .NET](https://msdn.microsoft.com/library/azure/hh488361.aspx).</span></span>

3. <span data-ttu-id="8f8f2-329">Spusťte virtuální počítač, který končí hello výpadek hello.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-329">Start hello VM, which ends hello downtime.</span></span> <span data-ttu-id="8f8f2-330">Obvykle dokončí celý proces hello během několika minut.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-330">Typically hello entire process completes within a few minutes.</span></span>

<span data-ttu-id="8f8f2-331">Tento proces vypočítá kolekce snímky konzistentní s aplikacemi pro všechny disky hello poskytuje bod obnovení zálohy pro hello virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-331">This process yields a collection of consistent snapshots for all hello disks, providing a backup restore point for hello VM.</span></span> <span data-ttu-id="8f8f2-332">Níže najdete hello kroky toocopy hello snímky tooanother oblast pro zotavení po Havárii.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-332">See below for hello steps toocopy hello snapshots tooanother region for DR.</span></span>

### <a name="copy-hello-snapshots-tooanother-region"></a><span data-ttu-id="8f8f2-333">Zkopírujte hello snímky tooanother oblast</span><span class="sxs-lookup"><span data-stu-id="8f8f2-333">Copy hello snapshots tooanother region</span></span>

<span data-ttu-id="8f8f2-334">Vytváření snímků hello samostatně nemusí dostačovat pro zotavení po Havárii.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-334">Creation of hello snapshots alone may not be sufficient for DR.</span></span> <span data-ttu-id="8f8f2-335">Také je potřeba replikovat hello snímek zálohy tooanother oblast.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-335">You must also replicate hello snapshot backups tooanother region.</span></span>

<span data-ttu-id="8f8f2-336">Pokud používáte GRS nebo RA-GRS pro disky, v hello snímky jsou replikované toohello sekundární oblasti automaticky.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-336">If you are using GRS or RA-GRS for your disks, then hello snapshots are replicated toohello secondary region automatically.</span></span> <span data-ttu-id="8f8f2-337">Může být několik minut prodlevy před hello replikace a pokud hello primární datové centrum ocitne mimo provoz, než hello snímky dokončit replikace, nebudete moct tooaccess hello snímky z hello sekundárního datového centra.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-337">There can be a few minutes of lag before hello replication, and if hello primary data center goes down before hello snapshots finish replicating, you will not be able tooaccess hello snapshots from hello secondary data center.</span></span> <span data-ttu-id="8f8f2-338">Hello pravděpodobnost, že to je malá.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-338">hello likelihood of this is small.</span></span>

> [!Note] 
> <span data-ttu-id="8f8f2-339">Jenom s disky hello ve GRS nebo RA-GRS účet nechrání hello virtuálních počítačů z havárie.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-339">Only having hello disks in a GRS or RA-GRS account does not protect hello VM from disasters.</span></span> <span data-ttu-id="8f8f2-340">Také musíte vytvořit koordinované snímky nebo používat Azure Backup.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-340">You must also create coordinated snapshots or use Azure Backup.</span></span> <span data-ttu-id="8f8f2-341">Toto je požadované toorecover tooa konzistentní stav virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-341">This is required toorecover a VM tooa consistent state.</span></span>

<span data-ttu-id="8f8f2-342">Pokud používáte LRS, musíte zkopírovat hello snímky tooa jiný účet úložiště hned po vytvoření snímku hello.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-342">If you are using LRS, you must copy hello snapshots tooa different storage account immediately after creating hello snapshot.</span></span> <span data-ttu-id="8f8f2-343">Cíl kopírování Hello může být účet úložiště LRS v jiné oblasti, která výsledkem se v oblasti vzdálené kopie hello.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-343">hello copy target could be an LRS storage account in a different region, resulting in hello copy being in a remote region.</span></span> <span data-ttu-id="8f8f2-344">Můžete také zkopírovat účet úložiště hello snímku tooan RA-GRS v hello stejné oblasti.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-344">You can also copy hello snapshot tooan RA-GRS storage account in hello same region.</span></span> <span data-ttu-id="8f8f2-345">V takovém případě bude snímek hello líné replikované toohello vzdálené sekundární oblasti.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-345">In this case, hello snapshot will be lazily replicated toohello remote secondary region.</span></span> <span data-ttu-id="8f8f2-346">Zálohování je chráněn z havárie v primární lokalitě hello po dokončení kopírování hello a replikace.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-346">Your backup is protected from disasters at hello primary site once hello copying and replication is complete.</span></span>

<span data-ttu-id="8f8f2-347">toocopy vaše přírůstkové snímky pro zotavení po Havárii efektivně, zkontrolujte hello pokyny v [zálohování Azure nespravované disky virtuálních počítačů s přírůstkové snímky](storage-incremental-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="8f8f2-347">toocopy your incremental snapshots for DR efficiently, review hello instructions in [Back up Azure unmanaged VM disks with incremental snapshots](storage-incremental-snapshots.md).</span></span>

![][2]

### <a name="recovery-from-snapshots"></a><span data-ttu-id="8f8f2-348">Obnovení ze snímků</span><span class="sxs-lookup"><span data-stu-id="8f8f2-348">Recovery from Snapshots</span></span>

<span data-ttu-id="8f8f2-349">tooretrieve snímek, zkopírujte jej toomake nového objektu blob.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-349">tooretrieve a snapshot, copy it toomake a new blob.</span></span> <span data-ttu-id="8f8f2-350">Pokud kopírujete hello snímek z hello primární účet, můžete zkopírovat hello snímku přes základní objekt blob toohello hello snímku, proto navrácení hello disku toohello snímku; To se označuje jako povýšení hello snímku.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-350">If you are copying hello snapshot from hello primary account, you can copy hello snapshot over toohello base blob of hello snapshot, thus reverting hello disk toohello snapshot; this is known as promoting hello snapshot.</span></span> <span data-ttu-id="8f8f2-351">Pokud kopírujete zálohy snímku hello pomocí jiného účtu (v případě hello RA-GRS), musí být zkopírován tooa primární účet.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-351">If you are copying hello snapshot backup from a secondary account (in hello case of RA-GRS), it must be copied tooa primary account.</span></span> <span data-ttu-id="8f8f2-352">Můžete zkopírovat snímek [pomocí prostředí PowerShell](storage-powershell-guide-full.md#how-to-copy-a-snapshot-of-a-blob) nebo pomocí nástroje AzCopy hello.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-352">You can copy a snapshot [using PowerShell](storage-powershell-guide-full.md#how-to-copy-a-snapshot-of-a-blob) or using hello AzCopy utility.</span></span> <span data-ttu-id="8f8f2-353">Další informace najdete v tématu [přenos dat pomocí příkazového řádku Azcopy hello](storage-use-azcopy.md).</span><span class="sxs-lookup"><span data-stu-id="8f8f2-353">For more information, see [Transfer data with hello AzCopy Command-Line Utility](storage-use-azcopy.md).</span></span>

<span data-ttu-id="8f8f2-354">V případě hello virtuálních počítačů s více disky, musíte zkopírovat všechny hello snímky, které jsou součástí stejné koordinované hello bod obnovení.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-354">In hello case of VMs with multiple disks, you must copy all hello snapshots that are part of hello same coordinated restore point.</span></span> <span data-ttu-id="8f8f2-355">Po zkopírujete BLOB VHD toowritable snímky hello, můžete použít objekty BLOB toorecreate hello virtuálního počítače pomocí šablony hello pro hello virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-355">Once you copy hello snapshots toowritable VHD blobs, you can use hello blobs toorecreate your VM using hello template for hello VM.</span></span>

## <a name="other-options"></a><span data-ttu-id="8f8f2-356">Další možnosti</span><span class="sxs-lookup"><span data-stu-id="8f8f2-356">Other options</span></span>

### <a name="sql-server"></a><span data-ttu-id="8f8f2-357">SQL Server</span><span class="sxs-lookup"><span data-stu-id="8f8f2-357">SQL Server</span></span>

<span data-ttu-id="8f8f2-358">SQL Server běžící ve virtuálním počítači má svou vlastní integrované funkce toobackup vaše tooAzure databáze systému SQL Server úložiště objektů Blob nebo sdílené složky.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-358">SQL Server running in a VM has its own built-in capabilities toobackup your SQL Server database tooAzure Blob storage or a file share.</span></span> <span data-ttu-id="8f8f2-359">Pokud je účet úložiště hello GRS nebo RA-GRS, tyto zálohy v účtu úložiště hello sekundárního datového centra v hello události po havárii, můžete přistupovat pomocí hello stejná omezení, jak je popsáno dříve.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-359">If hello storage account is GRS or RA-GRS, you can access those backups in hello storage account’s secondary data center in hello event of a disaster, with hello same restrictions as discussed previously.</span></span> <span data-ttu-id="8f8f2-360">Další informace najdete v tématu [zálohování a obnovení pro SQL Server v Azure Virtual Machines](../virtual-machines/windows/sql/virtual-machines-windows-sql-backup-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="8f8f2-360">For more information, see [Backup and Restore for SQL Server in Azure Virtual Machines](../virtual-machines/windows/sql/virtual-machines-windows-sql-backup-recovery.md).</span></span> <span data-ttu-id="8f8f2-361">Přidání toobackup a obnovení [SQL serveru skupin dostupnosti Always On](../virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr.md) můžete udržovat sekundární repliky databáze toogreatly zkrátit čas obnovení po havárii hello.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-361">In addition toobackup and restore, [SQL Server Always On Availability Groups](../virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr.md) can maintain secondary replicas of databases toogreatly reduce hello disaster recovery time.</span></span>

## <a name="other-considerations"></a><span data-ttu-id="8f8f2-362">Další důležité informace</span><span class="sxs-lookup"><span data-stu-id="8f8f2-362">Other considerations</span></span>

<span data-ttu-id="8f8f2-363">Tento článek má popsané jak toobackup nebo proveďte snímků virtuálních počítačů a jejich zotavení po havárii toosupport disky a jak toouse těchto toorecover.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-363">This article has discussed how toobackup or take snapshots of your VMs and their disks toosupport disaster recovery, and how toouse those toorecover.</span></span> <span data-ttu-id="8f8f2-364">U modelu Azure Resource Manager hello Spousta lidí používá šablony toocreate jejich virtuální počítače a další infrastrukturou v Azure.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-364">With hello Azure Resource Manager model, many people use templates toocreate their VMs and other infrastructure in Azure.</span></span> <span data-ttu-id="8f8f2-365">Můžete použít šablonu toocreate virtuální počítač, který má hello stejnou konfiguraci pokaždé, když.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-365">You can use a template toocreate a VM that has hello same configuration every time.</span></span> <span data-ttu-id="8f8f2-366">Pokud používáte vlastní Image pro vytváření virtuálních počítačů, je rovněž třeba ověřit obrázků jsou chráněné pomocí účet toostore RA-GRS je.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-366">If you use custom images for creating your VMs, you must also make sure your images are protected by using an RA-GRS account toostore them.</span></span>

<span data-ttu-id="8f8f2-367">V důsledku toho procesu zálohování může být kombinací dvě věci:</span><span class="sxs-lookup"><span data-stu-id="8f8f2-367">Consequently, your backup process may be a combination of two things:</span></span>

1. <span data-ttu-id="8f8f2-368">Zálohování hello dat (disky)</span><span class="sxs-lookup"><span data-stu-id="8f8f2-368">Backup hello data (disks)</span></span>
2. <span data-ttu-id="8f8f2-369">Konfigurace zálohování hello (šablony, vlastních bitových kopií)</span><span class="sxs-lookup"><span data-stu-id="8f8f2-369">Backup hello configuration (templates, custom images)</span></span>

<span data-ttu-id="8f8f2-370">V závislosti na hello zálohování možnost, kterou zvolíte může mít zálohu hello toohandle hello dat a konfigurace hello nebo služby zálohování hello může zpracovávat veškerý který pro vás.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-370">Depending on hello backup option you choose, you may have toohandle hello backup of both hello data and hello configuration, or hello backup service may handle all of that for you.</span></span>

## <a name="appendix---understanding-hello-impact-of-lrs-grs-and-ra-grs"></a><span data-ttu-id="8f8f2-371">Příloha - porozumění hello vlivu LRS, GRS a RA-GRS</span><span class="sxs-lookup"><span data-stu-id="8f8f2-371">Appendix - Understanding hello impact of LRS, GRS, and RA-GRS</span></span>

<span data-ttu-id="8f8f2-372">Pro účty úložiště v Azure existují tři typy redundanci dat, které byste měli uvažovat o zotavení po havárii – místně redundantní (LRS), geograficky redundantní (GRS), nebo geograficky redundantní s čtení (RA-GRS) přístup.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-372">For storage accounts in Azure, there are three types of data redundancy that you should consider regarding disaster recovery – locally redundant (LRS), geo-redundant (GRS), or geo-redundant with read access (RA-GRS).</span></span> 

<span data-ttu-id="8f8f2-373">Místně redundantní úložiště (LRS) uchovává tři kopie dat hello v hello stejném datovém centru.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-373">Locally Redundant Storage (LRS) retains three copies of hello data in hello same data center.</span></span> <span data-ttu-id="8f8f2-374">Při zápisu dat hello, jsou aktualizovány všechny tři kopie dříve, než úspěch vrácena toohello volajícího, abyste věděli, že jsou identické.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-374">When writing hello data, all three copies are updated before success is returned toohello caller, so you know they are identical.</span></span> <span data-ttu-id="8f8f2-375">Disk je chráněný před místní selhání, protože je to velmi nepravděpodobné, že všechny tři kopie bude mít dopad na hello stejnou dobu.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-375">Your disk is protected from local failures, since it is extremely unlikely that all three copies would be impacted at hello same time.</span></span> <span data-ttu-id="8f8f2-376">V případě hello LRS neexistuje žádný geografická redundance, takže hello disku není chráněn před závažné chyby, které můžou mít vliv celého datového centra nebo úložiště jednotku.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-376">In hello case of LRS, there is no geo-redundancy, so hello disk is not protected from catastrophic failures that can impact an entire data center or storage unit.</span></span>

<span data-ttu-id="8f8f2-377">S GRS a RA-GRS v primární oblasti hello (vámi zvolené) jsou uchovány tři kopie dat a další tři kopie dat jsou uchovány v odpovídající sekundární oblasti (nastavuje Azure).</span><span class="sxs-lookup"><span data-stu-id="8f8f2-377">With GRS and RA-GRS, three copies of your data are retained in hello primary region (selected by you), and three more copies of your data are retained in a corresponding secondary region (set by Azure).</span></span> <span data-ttu-id="8f8f2-378">Například pokud data uchováváte v západní USA, hello data budou replikované tooEast USA.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-378">For example, if you store data in West US, hello data will be replicated tooEast US.</span></span> <span data-ttu-id="8f8f2-379">To se provádí asynchronně a existuje malé zpoždění mezi toohello aktualizace primární a sekundární.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-379">This is done asynchronously, and there is a small delay between updates toohello primary and secondary.</span></span> <span data-ttu-id="8f8f2-380">Repliky disků hello na sekundární lokalitě hello jsou konzistentní u jednotlivých disků (s odloženým hello), ale repliky více disků active pravděpodobně není synchronizována **mezi sebou**.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-380">Replicas of hello disks on hello secondary site are consistent on a per-disk basis (with hello delay), but replicas of multiple active disks may not be in sync **with each other**.</span></span> <span data-ttu-id="8f8f2-381">toohave repliky konzistentní napříč více disky, snímky konzistentní s aplikacemi, je potřeba.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-381">toohave consistent replicas across multiple disks, consistent snapshots are needed.</span></span>

<span data-ttu-id="8f8f2-382">Hello hlavní rozdíl mezi GRS a RA-GRS je s RA-GRS, může číst sekundární kopie hello kdykoli.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-382">hello main difference between GRS and RA-GRS is that with RA-GRS, you can read hello secondary copy at any time.</span></span> <span data-ttu-id="8f8f2-383">Pokud dojde k problému, který vykreslí hello data v primární oblasti hello nedostupné, hello tým Azure bude každý úsilí toorestore přístup.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-383">If there is a problem that renders hello data in hello primary region inaccessible, hello Azure team will make every effort toorestore access.</span></span> <span data-ttu-id="8f8f2-384">Zatímco primární hello je mimo provoz, pokud máte povolené RA-GRS, můžete přístup k datům hello v hello sekundárního datového centra.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-384">While hello primary is down, if you have RA-GRS enabled, you can access hello data in hello secondary data center.</span></span> <span data-ttu-id="8f8f2-385">Proto pokud máte v plánu tooread z repliky hello při hello primární je nedostupná, pak RA-GRS měli zvážit.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-385">Therefore, if you plan tooread from hello replica while hello primary is inaccessible, then RA-GRS should be considered.</span></span>

<span data-ttu-id="8f8f2-386">Pokud se jím toobe významné výpadku, hello tým Azure může aktivovat selhání geograficky a změňte hello primárního DNS položky toopoint toosecondary úložiště.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-386">If it turns out toobe a significant outage, hello Azure team may trigger a geo-failover and change hello primary DNS entries toopoint toosecondary storage.</span></span> <span data-ttu-id="8f8f2-387">Pokud máte buď GRS nebo RA-GRS povolená, můžete v tomto okamžiku přistupovat k datům hello v oblasti hello, který používá sekundární toobe hello.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-387">At this point, if you have either GRS or RA-GRS enabled, you can access hello data in hello region that used toobe hello secondary.</span></span> <span data-ttu-id="8f8f2-388">Jinými slovy Pokud je váš účet úložiště GRS a došlo k potížím, můžete přistupovat hello sekundární úložiště jenom v případě, že je geo-převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-388">In other words, if your storage account is GRS and there is a problem, you can access hello secondary storage only if there is a geo-failover.</span></span>

<span data-ttu-id="8f8f2-389">Další informace najdete v tématu [co toodo, když dojde k výpadku Azure Storage](storage-disaster-recovery-guidance.md).</span><span class="sxs-lookup"><span data-stu-id="8f8f2-389">For more information, see [What toodo if an Azure Storage outage occurs](storage-disaster-recovery-guidance.md).</span></span> 

<span data-ttu-id="8f8f2-390">Všimněte si, že Microsoft řídí, zda dojde k selhání.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-390">Note that Microsoft controls whether a failover occurs.</span></span> <span data-ttu-id="8f8f2-391">Převzetí služeb při selhání není řízený na účet úložiště, takže ji není rozhodnuto pomocí jednotliví zákazníci.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-391">Failover is not controlled per storage account, therefore it is not decided by individual customers.</span></span> <span data-ttu-id="8f8f2-392">tooimplement zotavení po havárii pro účty konkrétní úložiště nebo disky virtuálního počítače, je nutné použít hello techniky popsané v tomto článku.</span><span class="sxs-lookup"><span data-stu-id="8f8f2-392">tooimplement Disaster Recovery for specific storage accounts or virtual machine disks, you must use hello techniques described previously in this article.</span></span>



[1]: ./media/storage-backup-and-disaster-recovery-for-azure-iaas-disks/backup-and-disaster-recovery-for-azure-iaas-disks-1.png
[2]: ./media/storage-backup-and-disaster-recovery-for-azure-iaas-disks/backup-and-disaster-recovery-for-azure-iaas-disks-2.png