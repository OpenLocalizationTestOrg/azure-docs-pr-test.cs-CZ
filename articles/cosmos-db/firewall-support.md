---
title: "Podpora brány firewall Cosmos DB aaaAzure & IP řízení přístupu | Microsoft Docs"
description: "Zjistěte, jak zásady řízení přístupu toouse IP brány firewall podporují v Azure Cosmos DB databáze účtů."
keywords: "Řízení přístupu IP, podporu brány firewall"
services: cosmos-db
author: shahankur11
manager: jhubbard
editor: 
tags: azure-resource-manager
documentationcenter: 
ms.assetid: c1b9ede0-ed93-411a-ac9a-62c113a8e887
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/22/2017
ms.author: ankshah
ms.openlocfilehash: b5cdbdb28e9d7ee0fd0ea54aad277167b699929f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="azure-cosmos-db-firewall-support"></a><span data-ttu-id="78185-104">Podpora brány firewall Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="78185-104">Azure Cosmos DB firewall support</span></span>
<span data-ttu-id="78185-105">toosecure data uložená v účtu Azure Cosmos DB databáze, Azure Cosmos DB poskytl podporu pro tajný klíč na základě [modelu autorizace](https://msdn.microsoft.com/library/azure/dn783368.aspx) , využívá ověřovací kód silné Hash-based zprávy (HMAC).</span><span class="sxs-lookup"><span data-stu-id="78185-105">toosecure data stored in an Azure Cosmos DB database account, Azure Cosmos DB has provided support for a secret based [authorization model](https://msdn.microsoft.com/library/azure/dn783368.aspx) that utilizes a strong Hash-based message authentication code (HMAC).</span></span> <span data-ttu-id="78185-106">Nyní kromě tajný klíč toohello na základě modelu autorizace, Azure Cosmos DB podporuje zásady řízené řízení přístupu na základě IP pro podporu brány firewall pro příchozí.</span><span class="sxs-lookup"><span data-stu-id="78185-106">Now, in addition toohello secret based authorization model, Azure Cosmos DB supports policy driven IP-based access controls for inbound firewall support.</span></span> <span data-ttu-id="78185-107">Tento model je velmi podobné toohello pravidla brány firewall systému tradiční databáze a poskytuje další úroveň zabezpečení toohello databázový účet Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="78185-107">This model is very similar toohello firewall rules of a traditional database system and provides an additional level of security toohello Azure Cosmos DB database account.</span></span> <span data-ttu-id="78185-108">Tento model můžete teď konfigurovat dostupný jenom z schválené sadu počítačů Azure Cosmos DB toobe účtu databáze nebo cloudové služby.</span><span class="sxs-lookup"><span data-stu-id="78185-108">With this model, you can now configure an Azure Cosmos DB database account toobe accessible only from an approved set of machines and/or cloud services.</span></span> <span data-ttu-id="78185-109">Přístup k prostředkům Cosmos DB tooAzure ze tyto schválené sady počítačů a služeb stále vyžadují hello volající toopresent token platný autorizace.</span><span class="sxs-lookup"><span data-stu-id="78185-109">Access tooAzure Cosmos DB resources from these approved sets of machines and services still require hello caller toopresent a valid authorization token.</span></span>

## <a name="ip-access-control-overview"></a><span data-ttu-id="78185-110">Přehled řízení přístupu IP</span><span class="sxs-lookup"><span data-stu-id="78185-110">IP access control overview</span></span>
<span data-ttu-id="78185-111">Ve výchozím nastavení je přístupné z veřejného Internetu účet Azure Cosmos DB databáze, tak dlouho, dokud hello žádosti je přiložena token platný autorizace.</span><span class="sxs-lookup"><span data-stu-id="78185-111">By default, an Azure Cosmos DB database account is accessible from public internet as long as hello request is accompanied by a valid authorization token.</span></span> <span data-ttu-id="78185-112">řízení přístupu na základě zásad tooconfigure IP, hello uživatel musí poskytnout sadu hello IP adresy nebo rozsahy IP adres v toobe formuláře CIDR zahrnuty jako hello klienta IP adres pro danou databázi účet seznamu povolených aplikací.</span><span class="sxs-lookup"><span data-stu-id="78185-112">tooconfigure IP policy-based access control, hello user must provide hello set of IP addresses or IP address ranges in CIDR form toobe included as hello allowed list of client IPs for a given database account.</span></span> <span data-ttu-id="78185-113">Jakmile tato konfigurace se použije, všechny požadavky z počítače mimo tento seznam povolených se zablokuje serverem hello.</span><span class="sxs-lookup"><span data-stu-id="78185-113">Once this configuration is applied, all requests originating from machines outside this allowed list will be blocked by hello server.</span></span>  <span data-ttu-id="78185-114">připojení Hello zpracování tok pro hello řízení přístupu na základě IP je popsáno v následujícím diagramu hello.</span><span class="sxs-lookup"><span data-stu-id="78185-114">hello connection processing flow for hello IP-based access control is described in hello following diagram.</span></span>

![Diagram zobrazující hello proces připojení u řízení přístupu na základě IP](./media/firewall-support/firewall-support-flow.png)

## <a name="connections-from-cloud-services"></a><span data-ttu-id="78185-116">Připojení z cloudové služby</span><span class="sxs-lookup"><span data-stu-id="78185-116">Connections from cloud services</span></span>
<span data-ttu-id="78185-117">Cloudové služby v Azure, jsou velmi běžný způsob, jak hostování logikou střední úrovně služby pomocí Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="78185-117">In Azure, cloud services are a very common way for hosting middle tier service logic using Azure Cosmos DB.</span></span> <span data-ttu-id="78185-118">tooenable přístup tooan databázový účet Azure Cosmos DB z cloudové služby, hello veřejnou IP adresu hello cloudové služby musí být přidané toohello povolené seznam IP adres, které jsou spojené s vaším účtem Azure Cosmos DB databáze pomocí [konfigurace Hello zásad řízení přístupu IP](#configure-ip-policy).</span><span class="sxs-lookup"><span data-stu-id="78185-118">tooenable access tooan Azure Cosmos DB database account from a cloud service, hello public IP address of hello cloud service must be added toohello allowed list of IP addresses associated with your Azure Cosmos DB database account by [configuring hello IP access control policy](#configure-ip-policy).</span></span>  <span data-ttu-id="78185-119">To zajistí, že všechny instance role cloudové služby mít přístup tooyour databázový účet Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="78185-119">This ensures that all role instances of cloud services have access tooyour Azure Cosmos DB database account.</span></span> <span data-ttu-id="78185-120">IP adresy můžete načíst pro vaše cloudové služby v hello portál Azure, jak ukazuje následující snímek obrazovky hello.</span><span class="sxs-lookup"><span data-stu-id="78185-120">You can retrieve IP addresses for your cloud services in hello Azure portal, as shown in hello following screenshot.</span></span>

![Snímek obrazovky zobrazující hello veřejné IP adresy pro cloudové služby zobrazí v hello portálu Azure](./media/firewall-support/public-ip-addresses.png)

<span data-ttu-id="78185-122">Když cloudové služby můžete škálovat tak, že přidáte další role instance, tyto nové instance bude automaticky mít účet přístupu k toohello Azure Cosmos DB databáze vzhledem k tomu, že jsou součástí hello stejné cloudové služby.</span><span class="sxs-lookup"><span data-stu-id="78185-122">When you scale out your cloud service by adding additional role instance(s), those new instances will automatically have access toohello Azure Cosmos DB database account since they are part of hello same cloud service.</span></span>

## <a name="connections-from-virtual-machines"></a><span data-ttu-id="78185-123">Připojení z virtuálních počítačů</span><span class="sxs-lookup"><span data-stu-id="78185-123">Connections from virtual machines</span></span>
<span data-ttu-id="78185-124">[Virtuální počítače](https://azure.microsoft.com/services/virtual-machines/) nebo [sady škálování virtuálního počítače](../virtual-machine-scale-sets/virtual-machine-scale-sets-overview.md) lze také použít toohost střední vrstvy služeb pomocí Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="78185-124">[Virtual machines](https://azure.microsoft.com/services/virtual-machines/) or [virtual machine scale sets](../virtual-machine-scale-sets/virtual-machine-scale-sets-overview.md) can also be used toohost middle tier services using Azure Cosmos DB.</span></span>  <span data-ttu-id="78185-125">tooconfigure hello Azure Cosmos DB databázový účet tooallow přístup z virtuálních počítačů, veřejné IP adresy virtuálního počítače nebo škálovací sadu virtuálních počítačů musí být nakonfigurován jako jeden z hello povolené IP adresy pro váš účet Azure Cosmos DB databáze pomocí [konfigurace zásad řízení přístupu IP hello](#configure-ip-policy).</span><span class="sxs-lookup"><span data-stu-id="78185-125">tooconfigure hello Azure Cosmos DB database account tooallow access from virtual machines, public IP addresses of virtual machine and/or virtual machine scale set must be configured as one of hello allowed IP addresses for your Azure Cosmos DB database account by [configuring hello IP access control policy](#configure-ip-policy).</span></span> <span data-ttu-id="78185-126">IP adresy pro virtuální počítače v hello portál Azure, můžete načíst, jak ukazuje následující snímek obrazovky hello.</span><span class="sxs-lookup"><span data-stu-id="78185-126">You can retrieve IP addresses for virtual machines in hello Azure portal, as shown in hello following screenshot.</span></span>

![Snímek obrazovky s veřejnou IP adresu pro virtuální počítač, který se zobrazí v hello portálu Azure](./media/firewall-support/public-ip-addresses-dns.png)

<span data-ttu-id="78185-128">Když přidáte další virtuální počítač instancí toohello skupiny, jsou automaticky poskytnuty přístup tooyour Azure Cosmos DB databázového účtu.</span><span class="sxs-lookup"><span data-stu-id="78185-128">When you add additional virtual machine instances toohello group, they are automatically provided access tooyour Azure Cosmos DB database account.</span></span>

## <a name="connections-from-hello-internet"></a><span data-ttu-id="78185-129">Hello připojení z Internetu</span><span class="sxs-lookup"><span data-stu-id="78185-129">Connections from hello internet</span></span>
<span data-ttu-id="78185-130">Při přístupu Azure DB Cosmos databáze účtu z počítače na hello internet, hello klienta IP adresu nebo rozsah IP adres hello počítače musí být přidané toohello povolené seznam IP adresu pro hello databázový účet Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="78185-130">When you access an Azure Cosmos DB database account from a computer on hello internet, hello client IP address or IP address range of hello machine must be added toohello allowed list of IP address for hello Azure Cosmos DB database account.</span></span> 

## <span data-ttu-id="78185-131"><a id="configure-ip-policy"></a>Konfigurace zásad řízení přístupu IP hello</span><span class="sxs-lookup"><span data-stu-id="78185-131"><a id="configure-ip-policy"></a> Configuring hello IP access control policy</span></span>
<span data-ttu-id="78185-132">zásada řízení přístupu IP Hello lze nastavit v hello portál Azure, nebo programově pomocí [rozhraní příkazového řádku Azure](cli-samples.md), [prostředí Azure Powershell](powershell-samples.md), nebo hello [REST API](/rest/api/documentdb/) aktualizací hello `ipRangeFilter` vlastnost.</span><span class="sxs-lookup"><span data-stu-id="78185-132">hello IP access control policy can be set in hello Azure portal, or programmatically through [Azure CLI](cli-samples.md), [Azure Powershell](powershell-samples.md), or hello [REST API](/rest/api/documentdb/) by updating hello `ipRangeFilter` property.</span></span> <span data-ttu-id="78185-133">IP adresy a rozsahy musí být oddělené čárkami a nesmí obsahovat žádné mezery.</span><span class="sxs-lookup"><span data-stu-id="78185-133">IP addresses/ranges must be comma separated and must not contain any spaces.</span></span> <span data-ttu-id="78185-134">Příklad: "13.91.6.132,13.91.6.1/24".</span><span class="sxs-lookup"><span data-stu-id="78185-134">Example: "13.91.6.132,13.91.6.1/24".</span></span> <span data-ttu-id="78185-135">Při aktualizaci databázový účet prostřednictvím těchto metod, musí být jisti toopopulate všechny tooprevent vlastnosti hello resetování toodefault nastavení.</span><span class="sxs-lookup"><span data-stu-id="78185-135">When updating your database account through these methods, be sure toopopulate all of hello properties tooprevent resetting toodefault settings.</span></span>

> [!NOTE]
> <span data-ttu-id="78185-136">Povolením IP zásad řízení přístupu pro váš účet Azure Cosmos DB databáze povoleny všechny tooyour přístup k databázi Azure Cosmos databázového účtu z počítače mimo nakonfigurovaný hello seznam rozsahů IP adres jsou zablokované.</span><span class="sxs-lookup"><span data-stu-id="78185-136">By enabling an IP access control policy for your Azure Cosmos DB database account, all access tooyour Azure Cosmos DB database account from machines outside hello configured allowed list of IP address ranges are blocked.</span></span> <span data-ttu-id="78185-137">Na základě tento model procházení hello datové roviny operace z portálu hello budou i blokované tooensure hello integritu řízení přístupu.</span><span class="sxs-lookup"><span data-stu-id="78185-137">By virtue of this model, browsing hello data plane operation from hello portal will also be blocked tooensure hello integrity of access control.</span></span>

<span data-ttu-id="78185-138">vývoj toosimplify hello portál Azure vám pomůže identifikovat a přidejte IP hello toohello počítač vašeho klienta povoleny seznamu, aby aplikace běžící počítači přístup hello účet Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="78185-138">toosimplify development, hello Azure portal helps you identify and add hello IP of your client machine toohello allowed list, so that apps running your machine can access hello Azure Cosmos DB account.</span></span> <span data-ttu-id="78185-139">Všimněte si, že hello IP adresa klienta zde byla nalezena registrovaného portálem hello.</span><span class="sxs-lookup"><span data-stu-id="78185-139">Note that hello client IP address here is detected as seen by hello portal.</span></span> <span data-ttu-id="78185-140">Může být IP adresa klienta hello počítače, ale mohou být také hello IP adresu brány sítě.</span><span class="sxs-lookup"><span data-stu-id="78185-140">It may be hello client IP address of your machine, but it could also be hello IP address of your network gateway.</span></span> <span data-ttu-id="78185-141">Nevynechali tooremove ho před tooproduction probíhající.</span><span class="sxs-lookup"><span data-stu-id="78185-141">Do not forget tooremove it before going tooproduction.</span></span>

<span data-ttu-id="78185-142">zásada řízení tooset hello IP přístup v hello portál Azure, přejděte okně účtu Azure Cosmos DB toohello, klikněte na **brány Firewall** v navigační nabídce hello klikněte **ON**</span><span class="sxs-lookup"><span data-stu-id="78185-142">tooset hello IP access control policy in hello Azure portal, navigate toohello Azure Cosmos DB account blade, click **Firewall** in hello navigation menu, then click **ON**</span></span> 

![Snímek obrazovky ukazující, jak tooopen hello okno brány Firewall v hello portálu Azure](./media/firewall-support/azure-portal-firewall.png)

<span data-ttu-id="78185-144">V nové podokno hello, určete, zda hello portálu Azure můžete přístup k účtu hello a podle potřeby přidat další adresy a rozsahy a pak klikněte na tlačítko **Uložit**.</span><span class="sxs-lookup"><span data-stu-id="78185-144">In hello new pane, specify whether hello Azure portal can access hello account, and add other addresses and ranges as appropriate, then click **Save**.</span></span>  

> [!NOTE]
> <span data-ttu-id="78185-145">Když povolíte IP zásad řízení přístupu, musíte tooadd hello IP adresa pro přístup k portálu Azure toomaintain hello.</span><span class="sxs-lookup"><span data-stu-id="78185-145">When you enable an IP access control policy, you need tooadd hello IP address for hello Azure portal toomaintain access.</span></span> <span data-ttu-id="78185-146">Hello portálu IP adresy jsou:</span><span class="sxs-lookup"><span data-stu-id="78185-146">hello portal IP addresses are:</span></span>
> |<span data-ttu-id="78185-147">Oblast</span><span class="sxs-lookup"><span data-stu-id="78185-147">Region</span></span>|<span data-ttu-id="78185-148">IP adresa</span><span class="sxs-lookup"><span data-stu-id="78185-148">IP address</span></span>|
> |------|----------|
> |<span data-ttu-id="78185-149">Všechny oblasti s výjimkou těchto zadané níže</span><span class="sxs-lookup"><span data-stu-id="78185-149">All regions except those specified below</span></span>| <span data-ttu-id="78185-150">104.42.195.92</span><span class="sxs-lookup"><span data-stu-id="78185-150">104.42.195.92</span></span>|
> |<span data-ttu-id="78185-151">Německo</span><span class="sxs-lookup"><span data-stu-id="78185-151">Germany</span></span>|<span data-ttu-id="78185-152">51.4.229.218</span><span class="sxs-lookup"><span data-stu-id="78185-152">51.4.229.218</span></span>|
> |<span data-ttu-id="78185-153">Čína</span><span class="sxs-lookup"><span data-stu-id="78185-153">China</span></span>|<span data-ttu-id="78185-154">139.217.8.252</span><span class="sxs-lookup"><span data-stu-id="78185-154">139.217.8.252</span></span>|
> |<span data-ttu-id="78185-155">USA (Gov) – Arizona</span><span class="sxs-lookup"><span data-stu-id="78185-155">US Gov Arizona</span></span>|<span data-ttu-id="78185-156">52.244.48.71</span><span class="sxs-lookup"><span data-stu-id="78185-156">52.244.48.71</span></span>|
>

![Snímek obrazovky znázorňující nastavení brány firewall tooconfigure v hello portálu Azure](./media/firewall-support/azure-portal-firewall-configure.png)

## <a name="troubleshooting-hello-ip-access-control-policy"></a><span data-ttu-id="78185-158">Řešení potíží s zásad řízení přístupu IP hello</span><span class="sxs-lookup"><span data-stu-id="78185-158">Troubleshooting hello IP access control policy</span></span>
### <a name="portal-operations"></a><span data-ttu-id="78185-159">Operace portálu</span><span class="sxs-lookup"><span data-stu-id="78185-159">Portal operations</span></span>
<span data-ttu-id="78185-160">Povolením IP zásad řízení přístupu pro váš účet Azure Cosmos DB databáze povoleny všechny tooyour přístup k databázi Azure Cosmos databázového účtu z počítače mimo nakonfigurovaný hello seznam rozsahů IP adres jsou zablokované.</span><span class="sxs-lookup"><span data-stu-id="78185-160">By enabling an IP access control policy for your Azure Cosmos DB database account, all access tooyour Azure Cosmos DB database account from machines outside hello configured allowed list of IP address ranges are blocked.</span></span> <span data-ttu-id="78185-161">Proto pokud chcete, aby operace roviny tooenable portálu data, jako je procházení kolekcí a dokumenty dotaz, je třeba tooexplicitly povolit Azure přístup k portálu pomocí hello **brány Firewall** okna portálu hello.</span><span class="sxs-lookup"><span data-stu-id="78185-161">Therefore if you want tooenable portal data plane operations like browsing collections and query documents, you need tooexplicitly allow Azure portal access using hello **Firewall** blade in hello portal.</span></span> 

![Snímek obrazovky ukazující, jak toohello tooenable přístup k portálu Azure](./media/firewall-support/azure-portal-access-firewall.png)

### <a name="sdk--rest-api"></a><span data-ttu-id="78185-163">Sadu SDK a Rest API</span><span class="sxs-lookup"><span data-stu-id="78185-163">SDK & Rest API</span></span>
<span data-ttu-id="78185-164">Pro z bezpečnostních důvodů, přístup prostřednictvím sady SDK nebo REST API z počítače není na seznamu povolených aplikací hello vrátí obecné 404 nebyl nalezen odpověď se žádné další podrobnosti.</span><span class="sxs-lookup"><span data-stu-id="78185-164">For security reasons, access via SDK or REST API from machines not on hello allowed list will return a generic 404 Not Found response with no additional details.</span></span> <span data-ttu-id="78185-165">Zkontrolujte, zda že text hello IP povolená, seznam nakonfigurovaný pro Azure Cosmos DB databáze konfiguraci vašeho účtu tooensure hello správné zásady je použité tooyour databázový účet Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="78185-165">Please verify hello IP allowed list configured for your Azure Cosmos DB database account tooensure hello correct policy configuration is applied tooyour Azure Cosmos DB database account.</span></span>

## <a name="next-steps"></a><span data-ttu-id="78185-166">Další kroky</span><span class="sxs-lookup"><span data-stu-id="78185-166">Next steps</span></span>
<span data-ttu-id="78185-167">Informace o síti tipy pro zvýšení výkonu související, najdete v článku [tipy pro zvýšení výkonu](performance-tips.md).</span><span class="sxs-lookup"><span data-stu-id="78185-167">For information about network related performance tips, see [Performance tips](performance-tips.md).</span></span>

