---
title: "Tipy aaaPerformance - Azure Cosmos databáze NoSQL | Microsoft Docs"
description: "Další možnosti konfigurace klienta, tooimprove výkonu databáze Azure Cosmos DB"
keywords: "jak tooimprove databázi s vyšším výkonem"
services: cosmos-db
author: mimig1
manager: jhubbard
editor: 
documentationcenter: 
ms.assetid: 94ff155e-f9bc-488f-8c7a-5e7037091bb9
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 02/23/2017
ms.author: mimig
ms.openlocfilehash: 4f3e82ae5048e3dbc20b0fd891a2d3aa22adf3fc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="performance-tips-for-azure-cosmos-db"></a><span data-ttu-id="9e5b6-104">Tipy pro zvýšení výkonu pro Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="9e5b6-104">Performance tips for Azure Cosmos DB</span></span>
<span data-ttu-id="9e5b6-105">Azure Cosmos DB je rychlé a flexibilní distribuovanou databázi, která bezproblémově škáluje s zaručenou latence a propustnosti.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-105">Azure Cosmos DB is a fast and flexible distributed database that scales seamlessly with guaranteed latency and throughput.</span></span> <span data-ttu-id="9e5b6-106">Nemáte provést změny hlavní architektura toomake nebo zapsat složitý kód tooscale vaší databáze pomocí Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-106">You do not have toomake major architecture changes or write complex code tooscale your database with Cosmos DB.</span></span> <span data-ttu-id="9e5b6-107">Škálování nahoru a dolů je stejně snadná jako provedení jednoho volání rozhraní API nebo [volání metody SDK](set-throughput.md#set-throughput-sdk).</span><span class="sxs-lookup"><span data-stu-id="9e5b6-107">Scaling up and down is as easy as making a single API call or [SDK method call](set-throughput.md#set-throughput-sdk).</span></span> <span data-ttu-id="9e5b6-108">Ale protože Cosmos DB přistupuje prostřednictvím sítě volání existuje jsou optimalizace na straně klienta provedete tooachieve nejvyššího výkonu.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-108">However, because Cosmos DB is accessed via network calls there are client-side optimizations you can make tooachieve peak performance.</span></span>

<span data-ttu-id="9e5b6-109">Takže pokud vás nemůže ověřit "jak vylepšit výkon Moje databáze?"</span><span class="sxs-lookup"><span data-stu-id="9e5b6-109">So if you're asking "How can I improve my database performance?"</span></span> <span data-ttu-id="9e5b6-110">Vezměte v úvahu hello následující možnosti:</span><span class="sxs-lookup"><span data-stu-id="9e5b6-110">consider hello following options:</span></span>

## <a name="networking"></a><span data-ttu-id="9e5b6-111">Sítě</span><span class="sxs-lookup"><span data-stu-id="9e5b6-111">Networking</span></span>
<a id="direct-connection"></a>

1. <span data-ttu-id="9e5b6-112">**Zásady připojení: použití režimu přímé připojení**</span><span class="sxs-lookup"><span data-stu-id="9e5b6-112">**Connection policy: Use direct connection mode**</span></span>

    <span data-ttu-id="9e5b6-113">Jak se klient připojuje tooCosmos DB má důležité dopady na výkon, hlavně z hlediska zjištěnou latence klienta.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-113">How a client connects tooCosmos DB has important implications on performance, especially in terms of observed client-side latency.</span></span> <span data-ttu-id="9e5b6-114">Nejsou k dispozici pro konfiguraci klienta zásady připojení – hello připojení dvě nastavení konfigurace klíče *režimu* a hello [připojení *protokol*](#connection-protocol).</span><span class="sxs-lookup"><span data-stu-id="9e5b6-114">There are two key configuration settings available for configuring client Connection Policy – hello connection *mode* and hello [connection *protocol*](#connection-protocol).</span></span>  <span data-ttu-id="9e5b6-115">jsou dva režimy dostupné Hello:</span><span class="sxs-lookup"><span data-stu-id="9e5b6-115">hello two available modes are:</span></span>

   1. <span data-ttu-id="9e5b6-116">Režim brány (výchozí)</span><span class="sxs-lookup"><span data-stu-id="9e5b6-116">Gateway Mode (default)</span></span>
   2. <span data-ttu-id="9e5b6-117">Přímý režim</span><span class="sxs-lookup"><span data-stu-id="9e5b6-117">Direct Mode</span></span>

      <span data-ttu-id="9e5b6-118">Režim brány je podporovaná na všech platformách SDK a je hello nakonfigurované výchozí.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-118">Gateway Mode is supported on all SDK platforms and is hello configured default.</span></span>  <span data-ttu-id="9e5b6-119">Pokud vaše aplikace běží v rámci podnikové sítě s omezeními striktní brány firewall, režim brány je nejlepší volbou hello vzhledem k tomu, že používá hello standardní port HTTPS a jeden koncový bod.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-119">If your application runs within a corporate network with strict firewall restrictions, Gateway Mode is hello best choice since it uses hello standard HTTPS port and a single endpoint.</span></span> <span data-ttu-id="9e5b6-120">Dobrý den kompromis výkonu, je však, že brány režimu zahrnuje směrování další síti pokaždé, když je číst nebo zapisovat tooCosmos DB data.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-120">hello performance tradeoff, however, is that Gateway Mode involves an additional network hop every time data is read or written tooCosmos DB.</span></span> <span data-ttu-id="9e5b6-121">Z toho důvodu přímý režim nabízí lepší výkon z důvodu toofewer síťové směrování.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-121">Because of this, Direct Mode offers better performance due toofewer network hops.</span></span>
<a id="use-tcp"></a>
2. <span data-ttu-id="9e5b6-122">**Zásady připojení: použití protokolu TCP hello**</span><span class="sxs-lookup"><span data-stu-id="9e5b6-122">**Connection policy: Use hello TCP protocol**</span></span>

    <span data-ttu-id="9e5b6-123">Při použití režimu přímého, existují dvě možnosti protokolu k dispozici:</span><span class="sxs-lookup"><span data-stu-id="9e5b6-123">When using Direct Mode, there are two protocol options available:</span></span>

   * <span data-ttu-id="9e5b6-124">TCP</span><span class="sxs-lookup"><span data-stu-id="9e5b6-124">TCP</span></span>
   * <span data-ttu-id="9e5b6-125">HTTPS</span><span class="sxs-lookup"><span data-stu-id="9e5b6-125">HTTPS</span></span>

     <span data-ttu-id="9e5b6-126">Cosmos DB nabízí jednoduchý a otevřete programovací model RESTful přes protokol HTTPS.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-126">Cosmos DB offers a simple and open RESTful programming model over HTTPS.</span></span> <span data-ttu-id="9e5b6-127">Kromě toho nabízí efektivní protokolu TCP, který je také dosáhl standardu RESTful v jeho komunikace modelu a je k dispozici prostřednictvím hello klient .NET SDK.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-127">Additionally, it offers an efficient TCP protocol, which is also RESTful in its communication model and is available through hello .NET client SDK.</span></span> <span data-ttu-id="9e5b6-128">Přímé TCP a HTTPS používat protokol SSL pro počáteční ověřování a šifrování přenosů.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-128">Both Direct TCP and HTTPS use SSL for initial authentication and encrypting traffic.</span></span> <span data-ttu-id="9e5b6-129">Pro nejlepší výkon použijte hello protokolu TCP, pokud je to možné.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-129">For best performance, use hello TCP protocol when possible.</span></span>

     <span data-ttu-id="9e5b6-130">Při použití protokolu TCP v režimu brány, TCP Port 443 je hello Cosmos DB portu a 10255 hello MongoDB API portu.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-130">When using TCP in Gateway Mode, TCP Port 443 is hello Cosmos DB port, and 10255 is hello MongoDB API port.</span></span> <span data-ttu-id="9e5b6-131">Při použití protokolu TCP v režimu přímého v přidání toohello brány porty, třeba tooensure hello port rozsahu 10000 až 20000 je otevřený, protože Cosmos DB používá dynamické porty TCP.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-131">When using TCP in Direct Mode, in addition toohello Gateway ports, you need tooensure hello port range between 10000 and 20000 is open because Cosmos DB uses dynamic TCP ports.</span></span> <span data-ttu-id="9e5b6-132">Pokud nejsou tyto porty otevřít a pokusíte se toouse TCP, obdržíte chybu 503 Služba není k dispozici.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-132">If these ports are not open and you attempt toouse TCP, you receive a 503 Service Unavailable error.</span></span>

     <span data-ttu-id="9e5b6-133">během vytváření hello instance DocumentClient hello s parametrem ConnectionPolicy hello je nakonfigurován Hello režim připojení.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-133">hello Connectivity Mode is configured during hello construction of hello DocumentClient instance with hello ConnectionPolicy parameter.</span></span> <span data-ttu-id="9e5b6-134">Pokud se používá přímý režim hello protokolu můžete také nastavit v rámci hello ConnectionPolicy parametr.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-134">If Direct Mode is used, hello Protocol can also be set within hello ConnectionPolicy parameter.</span></span>

    ```C#
    var serviceEndpoint = new Uri("https://contoso.documents.net");
    var authKey = new "your authKey from hello Azure portal";
    DocumentClient client = new DocumentClient(serviceEndpoint, authKey,
    new ConnectionPolicy
    {
        ConnectionMode = ConnectionMode.Direct,
        ConnectionProtocol = Protocol.Tcp
    });
    ```

    <span data-ttu-id="9e5b6-135">Protože TCP je podporována pouze v režimu přímého, pokud se používá v režimu brány, pak hello protokol HTTPS, je vždy použít toocommunicate s hello brány a hello hodnotu protokolu v hello ConnectionPolicy je ignorován.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-135">Because TCP is only supported in Direct Mode, if Gateway Mode is used, then hello HTTPS protocol is always used toocommunicate with hello Gateway and hello Protocol value in hello ConnectionPolicy is ignored.</span></span>

    ![Obrázek hello zásady Azure Cosmos DB připojení](./media/performance-tips/connection-policy.png)

3. <span data-ttu-id="9e5b6-137">**Volání OpenAsync tooavoid spuštění latence na první požadavek**</span><span class="sxs-lookup"><span data-stu-id="9e5b6-137">**Call OpenAsync tooavoid startup latency on first request**</span></span>

    <span data-ttu-id="9e5b6-138">Ve výchozím nastavení první požadavek hello má vyšší latence, protože má toofetch hello adresu směrovací tabulky.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-138">By default, hello first request has a higher latency because it has toofetch hello address routing table.</span></span> <span data-ttu-id="9e5b6-139">tooavoid tato čekací doba spuštění na hello nejdřív požádat, OpenAsync() by měly volat jednou během inicializace následujícím způsobem.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-139">tooavoid this startup latency on hello first request, you should call OpenAsync() once during initialization as follows.</span></span>

        await client.OpenAsync();
   <a id="same-region"></a>
4. <span data-ttu-id="9e5b6-140">**Společně umístit klienty ve stejné oblasti Azure výkonu**</span><span class="sxs-lookup"><span data-stu-id="9e5b6-140">**Collocate clients in same Azure region for performance**</span></span>

    <span data-ttu-id="9e5b6-141">Pokud to možné, všechny aplikace, volání Cosmos DB v hello stejné oblasti jako místní hello Cosmos DB databáze.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-141">When possible, place any applications calling Cosmos DB in hello same region as hello Cosmos DB database.</span></span> <span data-ttu-id="9e5b6-142">Při porovnávání přibližnou volá tooCosmos DB v rámci stejné oblasti dokončení v ms 1 – 2, ale hello latenci mezi hello – západ a východním pobřeží USA je hello hello > 50 ms.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-142">For an approximate comparison, calls tooCosmos DB within hello same region complete within 1-2 ms, but hello latency between hello West and East coast of hello US is >50 ms.</span></span> <span data-ttu-id="9e5b6-143">Tato čekací doba se můžou pravděpodobně lišit od toorequest žádosti v závislosti na hello trasy provedenou hello žádost jako předává z hello klienta toohello datové centrum Azure hranic.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-143">This latency can likely vary from request toorequest depending on hello route taken by hello request as it passes from hello client toohello Azure datacenter boundary.</span></span> <span data-ttu-id="9e5b6-144">Hello nejnižší možnou latenci je dosaženo tak hello volání aplikace se nachází v rámci hello stejné oblasti Azure jako hello zřízený Cosmos DB koncový bod.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-144">hello lowest possible latency is achieved by ensuring hello calling application is located within hello same Azure region as hello provisioned Cosmos DB endpoint.</span></span> <span data-ttu-id="9e5b6-145">Seznam dostupných oblastí najdete v tématu [oblasti Azure](https://azure.microsoft.com/regions/#services).</span><span class="sxs-lookup"><span data-stu-id="9e5b6-145">For a list of available regions, see [Azure Regions](https://azure.microsoft.com/regions/#services).</span></span>

    <span data-ttu-id="9e5b6-146">![Obrázek hello zásady Azure Cosmos DB připojení](./media/performance-tips/same-region.png)
   <a id="increase-threads"></a></span><span class="sxs-lookup"><span data-stu-id="9e5b6-146">![Illustration of hello Azure Cosmos DB connection policy](./media/performance-tips/same-region.png)
<a id="increase-threads"></a></span></span>
5. <span data-ttu-id="9e5b6-147">**Zvýšit počet vláken/úlohy**</span><span class="sxs-lookup"><span data-stu-id="9e5b6-147">**Increase number of threads/tasks**</span></span>

    <span data-ttu-id="9e5b6-148">Vzhledem k tomu, že volání tooAzure Cosmos DB probíhají hello síti, může být nutné toovary hello stupně paralelního zpracování žádostí o tak, aby hello klientská aplikace stráví velmi malé dobu čekání mezi požadavky.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-148">Since calls tooAzure Cosmos DB are made over hello network, you may need toovary hello degree of parallelism of your requests so that hello client application spends very little time waiting between requests.</span></span> <span data-ttu-id="9e5b6-149">Pokud například používáte. NET na [Task Parallel Library](https://msdn.microsoft.com//library/dd460717.aspx), vytvořte v pořadí hello 100s úloh čtení nebo zápis tooCosmos DB.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-149">For example, if you're using .NET's [Task Parallel Library](https://msdn.microsoft.com//library/dd460717.aspx), create in hello order of 100s of Tasks reading or writing tooCosmos DB.</span></span>

## <a name="sdk-usage"></a><span data-ttu-id="9e5b6-150">Použití sady SDK</span><span class="sxs-lookup"><span data-stu-id="9e5b6-150">SDK Usage</span></span>
1. <span data-ttu-id="9e5b6-151">**Nainstalujte hello nejnovější SDK**</span><span class="sxs-lookup"><span data-stu-id="9e5b6-151">**Install hello most recent SDK**</span></span>

    <span data-ttu-id="9e5b6-152">Hello Cosmos DB SDK neustále vylepšené tooprovide hello nejlepší výkon.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-152">hello Cosmos DB SDKs are constantly being improved tooprovide hello best performance.</span></span> <span data-ttu-id="9e5b6-153">V tématu hello [Cosmos DB SDK](documentdb-sdk-dotnet.md) stránky toodetermine hello nejnovější SDK a zkontrolujte vylepšení.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-153">See hello [Cosmos DB SDK](documentdb-sdk-dotnet.md) pages toodetermine hello most recent SDK and review improvements.</span></span>
2. <span data-ttu-id="9e5b6-154">**Použít klienta Cosmos DB jednotlivý prvek pro hello životního cyklu aplikace**</span><span class="sxs-lookup"><span data-stu-id="9e5b6-154">**Use a singleton Cosmos DB client for hello lifetime of your application**</span></span>

    <span data-ttu-id="9e5b6-155">Všimněte si, že každá instance DocumentClient je bezpečné pro přístup z více vláken a provádí správu efektivní připojení a ukládání adres do mezipaměti v režimu přímého.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-155">Note that each DocumentClient instance is thread-safe and performs efficient connection management and address caching when operating in Direct Mode.</span></span> <span data-ttu-id="9e5b6-156">Správa tooallow efektivní připojení a lepší výkon pomocí DocumentClient, je doporučeno toouse jedna instance DocumentClient jednotlivé domény aplikace pro hello životního cyklu aplikace hello.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-156">tooallow efficient connection management and better performance by DocumentClient, it is recommended toouse a single instance of DocumentClient per AppDomain for hello lifetime of hello application.</span></span>

   <a id="max-connection"></a>
3. <span data-ttu-id="9e5b6-157">**Při použití režimu brány zvýšit System.Net MaxConnections na hostitele**</span><span class="sxs-lookup"><span data-stu-id="9e5b6-157">**Increase System.Net MaxConnections per host when using Gateway mode**</span></span>

    <span data-ttu-id="9e5b6-158">Žádosti o cosmos DB jsou proveden prostřednictvím protokolu HTTPS nebo REST, při použití režimu brány a jsou vystaveno toohello výchozí limit připojení pro hostitele nebo IP adresa.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-158">Cosmos DB requests are made over HTTPS/REST when using Gateway mode, and are subjected toohello default connection limit per hostname or IP address.</span></span> <span data-ttu-id="9e5b6-159">Tooset hello MaxConnections tooa vyšší hodnota (100-1000) může být nutné, aby hello klientské knihovny může využívat víc souběžných připojení tooCosmos DB.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-159">You may need tooset hello MaxConnections tooa higher value (100-1000) so that hello client library can utilize multiple simultaneous connections tooCosmos DB.</span></span> <span data-ttu-id="9e5b6-160">V hello .NET SDK 1.8.0 a výše, hello výchozí hodnota pro [ServicePointManager.DefaultConnectionLimit](https://msdn.microsoft.com/library/system.net.servicepointmanager.defaultconnectionlimit.aspx) je 50 a toochange hello hodnotu, můžete nastavit hello [Documents.Client.ConnectionPolicy.MaxConnectionLimit ](https://msdn.microsoft.com/library/azure/microsoft.azure.documents.client.connectionpolicy.maxconnectionlimit.aspx) tooa vyšší hodnotu.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-160">In hello .NET SDK 1.8.0 and above, hello default value for [ServicePointManager.DefaultConnectionLimit](https://msdn.microsoft.com/library/system.net.servicepointmanager.defaultconnectionlimit.aspx) is 50 and toochange hello value, you can set hello [Documents.Client.ConnectionPolicy.MaxConnectionLimit](https://msdn.microsoft.com/library/azure/microsoft.azure.documents.client.connectionpolicy.maxconnectionlimit.aspx) tooa higher value.</span></span>   
4. <span data-ttu-id="9e5b6-161">**Ladění paralelní dotazy pro dělené kolekce**</span><span class="sxs-lookup"><span data-stu-id="9e5b6-161">**Tuning parallel queries for partitioned collections**</span></span>

     <span data-ttu-id="9e5b6-162">DocumentDB .NET SDK verze 1.9.0 a vyšší paralelní dotazy podpory, které umožňují tooquery dělenou kolekci paralelně (najdete v části [práce s hello sady SDK](documentdb-partition-data.md#working-with-the-azure-cosmos-db-sdks) a hello související [ukázky kódu](https://github.com/Azure/azure-documentdb-dotnet/blob/master/samples/code-samples/Queries/Program.cs) pro Další informace o).</span><span class="sxs-lookup"><span data-stu-id="9e5b6-162">DocumentDB .NET SDK version 1.9.0 and above support parallel queries, which enable you tooquery a partitioned collection in parallel (see [Working with hello SDKs](documentdb-partition-data.md#working-with-the-azure-cosmos-db-sdks) and hello related [code samples](https://github.com/Azure/azure-documentdb-dotnet/blob/master/samples/code-samples/Queries/Program.cs) for more info).</span></span> <span data-ttu-id="9e5b6-163">Paralelní dotazy jsou přes jejich sériové protějšku navrženou tooimprove dotazu latence a propustnosti.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-163">Parallel queries are designed tooimprove query latency and throughput over their serial counterpart.</span></span> <span data-ttu-id="9e5b6-164">Paralelní dotazy poskytují dva parametry, uživatelé mohli vyladit toocustom-fit jejich požadavků (a) MaxDegreeOfParallelism: toocontrol hello maximální počet oddílů pak může být dotazována v paralelní a (b) MaxBufferedItemCount: počet toocontrol hello předem načtených výsledky.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-164">Parallel queries provide two parameters that users can tune toocustom-fit their requirements, (a) MaxDegreeOfParallelism: toocontrol hello maximum number of partitions then can be queried in parallel, and (b) MaxBufferedItemCount: toocontrol hello number of pre-fetched results.</span></span>

    <span data-ttu-id="9e5b6-165">(a) ***ladění MaxDegreeOfParallelism\: *** paralelní dotaz funguje dotazováním více oddílů souběžně.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-165">(a) ***Tuning MaxDegreeOfParallelism\:*** Parallel query works by querying multiple partitions in parallel.</span></span> <span data-ttu-id="9e5b6-166">Data z shromažďování jednotlivých oddílů je však načtených sériově s ohledem toohello dotazu.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-166">However, data from an individual partitioned collect is fetched serially with respect toohello query.</span></span> <span data-ttu-id="9e5b6-167">Ano nastavení hello MaxDegreeOfParallelism toohello počet oddílů má hello maximální riziko dosažení hello většina původce dotazu, zadaný všechny další podmínky systému zůstanou hello stejné.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-167">So, setting hello MaxDegreeOfParallelism toohello number of partitions has hello maximum chance of achieving hello most performant query, provided all other system conditions remain hello same.</span></span> <span data-ttu-id="9e5b6-168">Pokud si nejste jisti hello počet oddílů, můžete nastavit hello MaxDegreeOfParallelism tooa vysoké číslo, a systém hello zvolí hello minimální (počet oddílů, uživatel zadal vstup) jako hello MaxDegreeOfParallelism.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-168">If you don't know hello number of partitions, you can set hello MaxDegreeOfParallelism tooa high number, and hello system chooses hello minimum (number of partitions, user provided input) as hello MaxDegreeOfParallelism.</span></span>

    <span data-ttu-id="9e5b6-169">Je důležité toonote, který paralelní dotazy produktu hello nejlepší výhody, pokud hello dat je rovnoměrně rozdělené mezi všechny oddíly s ohledem toohello dotazu.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-169">It is important toonote that parallel queries produce hello best benefits if hello data is evenly distributed across all partitions with respect toohello query.</span></span> <span data-ttu-id="9e5b6-170">Pokud hello kolekce rozdělena na oddíly je rozdělena na oddíly tak, že se soustřeďuje všechny nebo většinu hello dat vrácených dotazem do několika oddílů (jeden oddíl v nejhorším případě), a potom hello výkonu hello dotazu by omezené podle těchto oddílů.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-170">If hello partitioned collection is partitioned such a way that all or a majority of hello data returned by a query is concentrated in a few partitions (one partition in worst case), then hello performance of hello query would be bottlenecked by those partitions.</span></span>

    <span data-ttu-id="9e5b6-171">(b) ***ladění MaxBufferedItemCount\: *** paralelního dotazu je navrženou toopre načítání výsledků, během zpracování dávky aktuální hello výsledků klientem hello.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-171">(b) ***Tuning MaxBufferedItemCount\:*** Parallel query is designed toopre-fetch results while hello current batch of results is being processed by hello client.</span></span> <span data-ttu-id="9e5b6-172">předběžné načítání pomáhá v celkového zlepšení latence dotazu Hello.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-172">hello pre-fetching helps in overall latency improvement of a query.</span></span> <span data-ttu-id="9e5b6-173">MaxBufferedItemCount je hello parametr toolimit hello počet předem načtených výsledky.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-173">MaxBufferedItemCount is hello parameter toolimit hello number of pre-fetched results.</span></span> <span data-ttu-id="9e5b6-174">Nastavení MaxBufferedItemCount toohello očekává, že počet výsledků vrácených (nebo vyšším číslem) umožňuje maximální benefit tooreceive hello dotazu z předem načítání.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-174">Setting MaxBufferedItemCount toohello expected number of results returned (or a higher number) allows hello query tooreceive maximum benefit from pre-fetching.</span></span>

    <span data-ttu-id="9e5b6-175">Upozorňujeme, že předběžné načítání funguje hello stejný způsobem bez ohledu hello MaxDegreeOfParallelism a je do jedné vyrovnávací paměti pro hello data ze všech oddílů.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-175">Note that pre-fetching works hello same way irrespective of hello MaxDegreeOfParallelism, and there is a single buffer for hello data from all partitions.</span></span>  
5. <span data-ttu-id="9e5b6-176">**Zapnout na straně serveru globálního katalogu**</span><span class="sxs-lookup"><span data-stu-id="9e5b6-176">**Turn on server-side GC**</span></span>

    <span data-ttu-id="9e5b6-177">V některých případech mohou pomoci snížit frekvenci hello uvolňování paměti.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-177">Reducing hello frequency of garbage collection may help in some cases.</span></span> <span data-ttu-id="9e5b6-178">V rozhraní .NET, nastavte [gcserver –](https://msdn.microsoft.com/library/ms229357.aspx) tootrue.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-178">In .NET, set [gcServer](https://msdn.microsoft.com/library/ms229357.aspx) tootrue.</span></span>
6. <span data-ttu-id="9e5b6-179">**Implementace omezení rychlosti v intervalech RetryAfter**</span><span class="sxs-lookup"><span data-stu-id="9e5b6-179">**Implement backoff at RetryAfter intervals**</span></span>

    <span data-ttu-id="9e5b6-180">Během testování výkonu měli zvýšit zatížení, dokud malý počet žádostí o získání omezeny.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-180">During performance testing, you should increase load until a small rate of requests get throttled.</span></span> <span data-ttu-id="9e5b6-181">Pokud omezené, měli klientské aplikace hello omezení rychlosti na omezení pro interval opakování zadaný server hello.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-181">If throttled, hello client application should backoff on throttle for hello server-specified retry interval.</span></span> <span data-ttu-id="9e5b6-182">Bere ohledy na omezení rychlosti hello zajišťuje strávený minimální množství času čekat mezi opakovanými pokusy.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-182">Respecting hello backoff ensures that you spend minimal amount of time waiting between retries.</span></span> <span data-ttu-id="9e5b6-183">Podpora zásad opakování je součástí verze 1.8.0 a výše z hello DocumentDB [.NET](documentdb-sdk-dotnet.md) a [Java](documentdb-sdk-java.md), verze 1.9.0 a vyšší z hello [Node.js](documentdb-sdk-node.md) a [ Python](documentdb-sdk-python.md), a všechny podporované verze systému hello [.NET Core](documentdb-sdk-dotnet-core.md) sady SDK.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-183">Retry policy support is included in Version 1.8.0 and above of hello DocumentDB [.NET](documentdb-sdk-dotnet.md) and [Java](documentdb-sdk-java.md), version 1.9.0 and above of hello [Node.js](documentdb-sdk-node.md) and [Python](documentdb-sdk-python.md), and all supported versions of hello [.NET Core](documentdb-sdk-dotnet-core.md) SDKs.</span></span> <span data-ttu-id="9e5b6-184">Další informace najdete v tématu [Exceeding vyhrazené omezení propustnosti](request-units.md#RequestRateTooLarge) a [RetryAfter](https://msdn.microsoft.com/library/microsoft.azure.documents.documentclientexception.retryafter.aspx).</span><span class="sxs-lookup"><span data-stu-id="9e5b6-184">For more information, see [Exceeding reserved throughput limits](request-units.md#RequestRateTooLarge) and [RetryAfter](https://msdn.microsoft.com/library/microsoft.azure.documents.documentclientexception.retryafter.aspx).</span></span>
7. <span data-ttu-id="9e5b6-185">**Horizontální navýšení kapacity vaše úlohy klienta**</span><span class="sxs-lookup"><span data-stu-id="9e5b6-185">**Scale out your client-workload**</span></span>

    <span data-ttu-id="9e5b6-186">Pokud testujete na úrovních vysoké propustnosti (> 50 000 RU/s), klientská aplikace hello se může stát úzkým místem hello kvůli toohello počítače malá a velká se na využití procesoru nebo sítě.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-186">If you are testing at high throughput levels (>50,000 RU/s), hello client application may become hello bottleneck due toohello machine capping out on CPU or Network utilization.</span></span> <span data-ttu-id="9e5b6-187">Pokud dostanete tento bod, můžete pokračovat toopush hello Cosmos DB účtu další tím škálování klientských aplikací na více serverech.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-187">If you reach this point, you can continue toopush hello Cosmos DB account further by scaling out your client applications across multiple servers.</span></span>
8. <span data-ttu-id="9e5b6-188">**Dokument mezipaměti identifikátorů URI pro nižší latenci pro čtení**</span><span class="sxs-lookup"><span data-stu-id="9e5b6-188">**Cache document URIs for lower read latency**</span></span>

    <span data-ttu-id="9e5b6-189">Dokument mezipaměti identifikátory URI, kdykoli je to možné pro nejlepší výkon čtení hello.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-189">Cache document URIs whenever possible for hello best read performance.</span></span>
   <a id="tune-page-size"></a>
9. <span data-ttu-id="9e5b6-190">**Vyladění hello velikost stránky pro dotazy/číst informační kanály pro lepší výkon**</span><span class="sxs-lookup"><span data-stu-id="9e5b6-190">**Tune hello page size for queries/read feeds for better performance**</span></span>

    <span data-ttu-id="9e5b6-191">Při provádění hromadně číst dokumenty pomocí funkce (například ReadDocumentFeedAsync) informační kanál čtení, nebo při vystavování dotazu DocumentDB SQL, hello výsledky se vrátí segmentovaným způsobem, pokud hello sadu výsledků dotazu je příliš velký.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-191">When performing a bulk read of documents using read feed functionality (for example, ReadDocumentFeedAsync) or when issuing a DocumentDB SQL query, hello results are returned in a segmented fashion if hello result set is too large.</span></span> <span data-ttu-id="9e5b6-192">Ve výchozím nastavení budou vráceny výsledky v bloky 100 položky nebo 1 MB, z těchto omezení dosáhl první.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-192">By default, results are returned in chunks of 100 items or 1 MB, whichever limit is hit first.</span></span>

    <span data-ttu-id="9e5b6-193">počet hello tooreduce síť odezev požadované tooretrieve všechny příslušné výsledky, můžete zvýšit velikost stránky hello pomocí too1000 tooup hlavičky x-ms-max--počet položek požadavku.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-193">tooreduce hello number of network round trips required tooretrieve all applicable results, you can increase hello page size using x-ms-max-item-count request header tooup too1000.</span></span> <span data-ttu-id="9e5b6-194">V případech, kde je nutné toodisplay jenom pár výsledky například pokud vaše uživatelské rozhraní nebo aplikací rozhraní API vrátí jenom 10 výsledků na dobu, může také snížit hello stránky velikost too10 tooreduce hello propustnost využité pro čtení a dotazy.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-194">In cases where you need toodisplay only a few results, for example, if your user interface or application API returns only 10 results a time, you can also decrease hello page size too10 tooreduce hello throughput consumed for reads and queries.</span></span>

    <span data-ttu-id="9e5b6-195">Můžete také nastavit velikost stránky hello pomocí hello k dispozici sady SDK DB Cosmos.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-195">You may also set hello page size using hello available Cosmos DB SDKs.</span></span>  <span data-ttu-id="9e5b6-196">Například:</span><span class="sxs-lookup"><span data-stu-id="9e5b6-196">For example:</span></span>

        IQueryable<dynamic> authorResults = client.CreateDocumentQuery(documentCollection.SelfLink, "SELECT p.Author FROM Pages p WHERE p.Title = 'About Seattle'", new FeedOptions { MaxItemCount = 1000 });
10. <span data-ttu-id="9e5b6-197">**Zvýšit počet vláken/úlohy**</span><span class="sxs-lookup"><span data-stu-id="9e5b6-197">**Increase number of threads/tasks**</span></span>

    <span data-ttu-id="9e5b6-198">V tématu [zvýšit počet vláken/úlohy](#increase-threads) v hello části sítě.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-198">See [Increase number of threads/tasks](#increase-threads) in hello Networking section.</span></span>

11. <span data-ttu-id="9e5b6-199">**Použijte hostitele 64-bit zpracování**</span><span class="sxs-lookup"><span data-stu-id="9e5b6-199">**Use 64-bit host processing**</span></span>

    <span data-ttu-id="9e5b6-200">Hello DocumentDB SDK pracuje v 32bitové hostitelský proces, při použití DocumentDB .NET SDK verze 1.11.4 a vyšší.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-200">hello DocumentDB SDK works in a 32-bit host process when you are using DocumentDB .NET SDK version 1.11.4 and above.</span></span> <span data-ttu-id="9e5b6-201">Ale pokud používáte křížové oddílu dotazy, se doporučuje zpracování hostitelem 64-bit pro zlepšení výkonu.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-201">However, if you are using cross partition queries, 64-bit host processing is recommended for improved performance.</span></span> <span data-ttu-id="9e5b6-202">Hello následující typy aplikací mít 32bitové hostitele zpracovat jako výchozí hello, takže v pořadí toochange to too64 bitů, podle těchto kroků v závislosti na typu hello vaší aplikace:</span><span class="sxs-lookup"><span data-stu-id="9e5b6-202">hello following types of applications have 32-bit host process as hello default, so in order toochange that too64-bit, follow these steps based on hello type of your application:</span></span>

    - <span data-ttu-id="9e5b6-203">Pro spustitelný soubor aplikace, to lze provést pomocí zaškrtnutí políčka hello **raději 32bitové** možnost v hello **vlastnosti projektu** okně na hello **sestavení** kartě.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-203">For Executable applications, this can be done by unchecking hello **Prefer 32-bit** option in hello **Project Properties** window, on hello **Build** tab.</span></span>

    - <span data-ttu-id="9e5b6-204">Pro testovací projekty založené na VSTest, to lze provést výběrem **testování**->**Test nastavení**->**výchozí architekturu procesoru jako X64**, z hello **testu sady Visual Studio** možnost nabídky.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-204">For VSTest based test projects, this can be done by selecting **Test**->**Test Settings**->**Default Processor Architecture as X64**, from hello **Visual Studio Test** menu option.</span></span>

    - <span data-ttu-id="9e5b6-205">Pro místně nasazené webové aplikace ASP.NET, stačí kontrolou hello **použití hello 64bitová verze služby IIS Express pro weby a projekty**v části **nástroje** ->  **Možnosti**->**projekty a řešení**->**webových projektů**.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-205">For locally deployed ASP.NET Web applications, this can be done by checking hello **Use hello 64-bit version of IIS Express for web sites and projects**, under **Tools**->**Options**->**Projects and Solutions**->**Web Projects**.</span></span>

    - <span data-ttu-id="9e5b6-206">Pro ASP.NET – webové aplikace nasazené na platformě Azure, to lze provést výběrem hello **platforma jako 64-bit** v hello **nastavení aplikace** na hello portálu Azure.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-206">For ASP.NET Web applications deployed on Azure, this can be done by choosing hello **Platform as 64-bit** in hello **Application Settings** on hello Azure portal.</span></span>

## <a name="indexing-policy"></a><span data-ttu-id="9e5b6-207">Zásady indexování</span><span class="sxs-lookup"><span data-stu-id="9e5b6-207">Indexing Policy</span></span>
1. <span data-ttu-id="9e5b6-208">**Použít Opožděné indexování pro rychlejší sazby přijímání dobu ve špičce**</span><span class="sxs-lookup"><span data-stu-id="9e5b6-208">**Use lazy indexing for faster peak time ingestion rates**</span></span>

    <span data-ttu-id="9e5b6-209">Cosmos DB vám umožní toospecify – na úrovni kolekce hello – indexování zásady, které umožní vám toochoose, pokud chcete, aby hello dokumenty v kolekci toobe, automaticky indexované nebo ne.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-209">Cosmos DB allows you toospecify – at hello collection level – an indexing policy, which enables you toochoose if you want hello documents in a collection toobe automatically indexed or not.</span></span>  <span data-ttu-id="9e5b6-210">Kromě toho můžete taky rozhodnout mezi synchronní (konzistentní) a asynchronní aktualizace indexu (Lazy).</span><span class="sxs-lookup"><span data-stu-id="9e5b6-210">In addition, you may also choose between synchronous (Consistent) and asynchronous (Lazy) index updates.</span></span> <span data-ttu-id="9e5b6-211">Ve výchozím nastavení hello aktualizace indexu synchronně na každý insert, replace nebo odstranění toohello kolekce dokumentů.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-211">By default, hello index is updated synchronously on each insert, replace, or delete of a document toohello collection.</span></span> <span data-ttu-id="9e5b6-212">Synchronně režim umožňuje hello dotazy toohonor hello stejné [úroveň konzistence](consistency-levels.md) jako hello dokumentu načte bez jakéhokoli zpoždění pro hello index příliš "nezaznamenaly".</span><span class="sxs-lookup"><span data-stu-id="9e5b6-212">Synchronously mode enables hello queries toohonor hello same [consistency level](consistency-levels.md) as that of hello document reads without any delay for hello index too“catch up".</span></span>

    <span data-ttu-id="9e5b6-213">Opožděné indexování lze považovat za pro scénáře, ve kterých je zapisovat data v shluky a chcete tooamortize hello práce potřebné tooindex obsah po delší dobu.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-213">Lazy indexing may be considered for scenarios in which data is written in bursts, and you want tooamortize hello work required tooindex content over a longer period of time.</span></span> <span data-ttu-id="9e5b6-214">Opožděné indexování také umožňuje toouse vaší efektivně zřízené propustnosti a používat požadavků na zápis ve špičce s minimální latenci.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-214">Lazy indexing also allows you toouse your provisioned throughput effectively and serve write requests at peak times with minimal latency.</span></span> <span data-ttu-id="9e5b6-215">Je důležité toonote, ale, že pokud je povoleno indexování opožděné, výsledky dotazu jsou nakonec byl konzistentní bez ohledu na nakonfigurované pro účet Cosmos DB hello úroveň konzistence hello.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-215">It is important toonote, however, that when lazy indexing is enabled, query results are eventually consistent regardless of hello consistency level configured for hello Cosmos DB account.</span></span>

    <span data-ttu-id="9e5b6-216">Proto konzistentní indexování režimu (IndexingPolicy.IndexingMode je nastavený tooConsistent) způsobuje hello nejvyšší požadavek jednotky poplatků za zápis při Lazy indexování režim (IndexingPolicy.IndexingMode je nastavený tooLazy) a žádný indexování (IndexingPolicy.Automatic nastavena tooFalse) mají nulové indexování náklady v době zápisu hello.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-216">Hence, Consistent indexing mode (IndexingPolicy.IndexingMode is set tooConsistent) incurs hello highest request unit charge per write, while Lazy indexing mode (IndexingPolicy.IndexingMode is set tooLazy) and no indexing (IndexingPolicy.Automatic is set tooFalse) have zero indexing cost at hello time of write.</span></span>
2. <span data-ttu-id="9e5b6-217">**Vyloučit z indexování pro rychlejší zápisy nepoužívané cesty**</span><span class="sxs-lookup"><span data-stu-id="9e5b6-217">**Exclude unused paths from indexing for faster writes**</span></span>

    <span data-ttu-id="9e5b6-218">Zásady indexování cosmos DB společnosti vám umožní toospecify, která dokumentu tooinclude cesty nebo vyloučit z indexování s využitím indexování cesty (IndexingPolicy.IncludedPaths a IndexingPolicy.ExcludedPaths).</span><span class="sxs-lookup"><span data-stu-id="9e5b6-218">Cosmos DB’s indexing policy also allows you toospecify which document paths tooinclude or exclude from indexing by leveraging Indexing Paths (IndexingPolicy.IncludedPaths and IndexingPolicy.ExcludedPaths).</span></span> <span data-ttu-id="9e5b6-219">použití Hello indexování cesty můžete nabízí vylepšené zápisu výkonu a nižší index úložiště pro scénáře, ve které hello vzorům dotazů znám předem, jsou-li indexování náklady přímo korelační toohello počet jedinečných cesty indexované.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-219">hello use of indexing paths can offer improved write performance and lower index storage for scenarios in which hello query patterns are known beforehand, as indexing costs are directly correlated toohello number of unique paths indexed.</span></span>  <span data-ttu-id="9e5b6-220">Například hello následující kód ukazuje, jak tooexclude celý oddíl hello dokumentů (také známa jako</span><span class="sxs-lookup"><span data-stu-id="9e5b6-220">For example, hello following code shows how tooexclude an entire section of hello documents (a.k.a.</span></span> <span data-ttu-id="9e5b6-221">podstrom) z indexování pomocí hello "*" zástupný znak.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-221">a subtree) from indexing using hello "*" wildcard.</span></span>

    ```C#
    var collection = new DocumentCollection { Id = "excludedPathCollection" };
    collection.IndexingPolicy.IncludedPaths.Add(new IncludedPath { Path = "/*" });
    collection.IndexingPolicy.ExcludedPaths.Add(new ExcludedPath { Path = "/nonIndexedContent/*");
    collection = await client.CreateDocumentCollectionAsync(UriFactory.CreateDatabaseUri("db"), excluded);
    ```

    <span data-ttu-id="9e5b6-222">Další informace najdete v tématu [Azure DB Cosmos indexování zásady](indexing-policies.md).</span><span class="sxs-lookup"><span data-stu-id="9e5b6-222">For more information, see [Azure Cosmos DB indexing policies](indexing-policies.md).</span></span>

## <a name="throughput"></a><span data-ttu-id="9e5b6-223">Propustnost</span><span class="sxs-lookup"><span data-stu-id="9e5b6-223">Throughput</span></span>
<a id="measure-rus"></a>

1. <span data-ttu-id="9e5b6-224">**Měření a optimalizovat pro nižší požadavek jednotek za sekundu využití**</span><span class="sxs-lookup"><span data-stu-id="9e5b6-224">**Measure and tune for lower request units/second usage**</span></span>

    <span data-ttu-id="9e5b6-225">Cosmos DB nabízí širokou škálu databázové operace, včetně dotazů na relační a hierarchických UDF, uložené procedury a triggery – všechny provozní na dokumentech hello v rámci kolekce databáze.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-225">Cosmos DB offers a rich set of database operations including relational and hierarchical queries with UDFs, stored procedures, and triggers – all operating on hello documents within a database collection.</span></span> <span data-ttu-id="9e5b6-226">Hello náklady spojené s každou z těchto operací se liší podle hello procesoru, vstupně-výstupní operace a požadované paměti toocomplete hello operaci.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-226">hello cost associated with each of these operations varies based on hello CPU, IO, and memory required toocomplete hello operation.</span></span> <span data-ttu-id="9e5b6-227">Namísto přemýšlení o a správu hardwarové prostředky si můžete představit jednotka žádosti (RU) jako jednu míru pro tooperform požadované prostředky hello různé operace databáze a služba žádostí na aplikace.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-227">Instead of thinking about and managing hardware resources, you can think of a request unit (RU) as a single measure for hello resources required tooperform various database operations and service an application request.</span></span>

    <span data-ttu-id="9e5b6-228">[Požadované jednotky](request-units.md) zřízeny pro každý účet databáze na základě hello počtu jednotek kapacity, které jste si koupili.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-228">[Request units](request-units.md) are provisioned for each database account based on hello number of capacity units that you purchase.</span></span> <span data-ttu-id="9e5b6-229">Spotřeba jednotek žádosti budou vyhodnocené jako za sekundu.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-229">Request unit consumption is evaluated as a rate per second.</span></span> <span data-ttu-id="9e5b6-230">Aplikace, které překročit hello zřízené požadavek jednotku hodnocení pro svůj účet je omezená, dokud hello rychlost klesne pod hello úroveň vyhrazené pro účet hello.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-230">Applications that exceed hello provisioned request unit rate for their account is limited until hello rate drops below hello reserved level for hello account.</span></span> <span data-ttu-id="9e5b6-231">Pokud vaše aplikace vyžaduje vyšší úroveň propustnosti, si můžete zakoupit jednotky dodatečnou kapacitu.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-231">If your application requires a higher level of throughput, you can purchase additional capacity units.</span></span>

    <span data-ttu-id="9e5b6-232">složitost Hello dotazu má dopad na tom, kolik jednotek žádosti se spotřebovávají pro operace.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-232">hello complexity of a query impacts how many Request Units are consumed for an operation.</span></span> <span data-ttu-id="9e5b6-233">Hello počet predikáty, povaha hello predikáty, počtu UDF a velikosti hello hello zdroje dat sady všechny ovlivnit hello náklady na dotaz operace.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-233">hello number of predicates, nature of hello predicates, number of UDFs, and hello size of hello source data set all influence hello cost of query operations.</span></span>

    <span data-ttu-id="9e5b6-234">toomeasure hello režii všechny operace (vytvoření, aktualizace nebo odstranění), zkontrolujte hlavičky x-ms požadavku poplatků hello (nebo ekvivalentní vlastnost RequestCharge v ResourceResponse hello<T> nebo FeedResponse<T> v hello .NET SDK) toomeasure Hello počet jednotek žádosti uplatníte tyto operace.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-234">toomeasure hello overhead of any operation (create, update, or delete), inspect hello x-ms-request-charge header (or hello equivalent RequestCharge property in ResourceResponse<T> or FeedResponse<T> in hello .NET SDK) toomeasure hello number of request units consumed by these operations.</span></span>

    ```C#
    // Measure hello performance (request units) of writes
    ResourceResponse<Document> response = await client.CreateDocumentAsync(collectionSelfLink, myDocument);
    Console.WriteLine("Insert of document consumed {0} request units", response.RequestCharge);
    // Measure hello performance (request units) of queries
    IDocumentQuery<dynamic> queryable = client.CreateDocumentQuery(collectionSelfLink, queryString).AsDocumentQuery();
    while (queryable.HasMoreResults)
         {
              FeedResponse<dynamic> queryResponse = await queryable.ExecuteNextAsync<dynamic>();
              Console.WriteLine("Query batch consumed {0} request units", queryResponse.RequestCharge);
         }
    ```             

    <span data-ttu-id="9e5b6-235">Hello požadavek poplatků, vrátí se v tuto hlavičku je zlomek zřízené propustnosti (tj, RUs 2000 / druhý).</span><span class="sxs-lookup"><span data-stu-id="9e5b6-235">hello request charge returned in this header is a fraction of your provisioned throughput (i.e., 2000 RUs / second).</span></span> <span data-ttu-id="9e5b6-236">Například pokud hello předchozí dotaz vrátí 1000 1KB – dokumenty, náklady na hello operace hello je 1 000.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-236">For example, if hello preceding query returns 1000 1KB-documents, hello cost of hello operation is 1000.</span></span> <span data-ttu-id="9e5b6-237">Jako takový jedné sekundy ctí hello server pouze dva takových požadavků před omezení následných žádostí.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-237">As such, within one second, hello server honors only two such requests before throttling subsequent requests.</span></span> <span data-ttu-id="9e5b6-238">Další informace najdete v tématu [požadované jednotky](request-units.md) a hello [kalkulačky jednotek žádosti](https://www.documentdb.com/capacityplanner).</span><span class="sxs-lookup"><span data-stu-id="9e5b6-238">For more information, see [Request units](request-units.md) and hello [request unit calculator](https://www.documentdb.com/capacityplanner).</span></span>
<a id="429"></a>
2. <span data-ttu-id="9e5b6-239">**Rychlost omezení nebo požadavků popisovač míra příliš velký**</span><span class="sxs-lookup"><span data-stu-id="9e5b6-239">**Handle rate limiting/request rate too large**</span></span>

    <span data-ttu-id="9e5b6-240">Když se klient pokusí tooexceed hello vyhrazenou propustností pro účet, není bez snížení výkonu na serveru hello a bez využití kapacity propustnosti mimo úroveň hello vyhrazena.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-240">When a client attempts tooexceed hello reserved throughput for an account, there is no performance degradation at hello server and no use of throughput capacity beyond hello reserved level.</span></span> <span data-ttu-id="9e5b6-241">Hello server se ukončí ho preventivně hello žádost s RequestRateTooLarge (kód stavu HTTP 429) a návratové hello hlavičky x-ms opakování za ms informující o hello množství času v milisekundách, která hello uživatel musí počkat před provedením nového pokusu hello požadavku.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-241">hello server will preemptively end hello request with RequestRateTooLarge (HTTP status code 429) and return hello x-ms-retry-after-ms header indicating hello amount of time, in milliseconds, that hello user must wait before reattempting hello request.</span></span>

        HTTP Status 429,
        Status Line: RequestRateTooLarge
        x-ms-retry-after-ms :100

    <span data-ttu-id="9e5b6-242">sady SDK Hello všechny implicitně catch této odpovědi, respektují hello zadaný server opakovat po záhlaví a opakujte žádost hello.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-242">hello SDKs all implicitly catch this response, respect hello server-specified retry-after header, and retry hello request.</span></span> <span data-ttu-id="9e5b6-243">Pokud váš účet je současně přistupuje více klientů, hello další pokus bude úspěšné.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-243">Unless your account is being accessed concurrently by multiple clients, hello next retry will succeed.</span></span>

    <span data-ttu-id="9e5b6-244">Pokud máte více než jednoho klienta kumulativně operační konzistentně vyšší rychlost požadavků hello, hello výchozí počet opakování aktuálně sadu too9 interně klientem hello nemusí stačit; v takovém případě hello klienta vyvolá DocumentClientException s aplikaci toohello 429 kódu stavu.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-244">If you have more than one client cumulatively operating consistently above hello request rate, hello default retry count currently set too9 internally by hello client may not suffice; in this case, hello client throws a DocumentClientException with status code 429 toohello application.</span></span> <span data-ttu-id="9e5b6-245">Počet opakování výchozí Hello může změnit nastavení hello RetryOptions na instanci ConnectionPolicy hello.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-245">hello default retry count can be changed by setting hello RetryOptions on hello ConnectionPolicy instance.</span></span> <span data-ttu-id="9e5b6-246">Ve výchozím nastavení je hello DocumentClientException se stavovým kódem 429 vrátila po uplynutí určité doby kumulativní Počkejte 30 sekund, pokud požadavek hello pokračuje toooperate vyšší rychlost požadavků hello.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-246">By default, hello DocumentClientException with status code 429 is returned after a cumulative wait time of 30 seconds if hello request continues toooperate above hello request rate.</span></span> <span data-ttu-id="9e5b6-247">K tomu dojde i v případě hello aktuální počet opakování je menší než počet hello maximálního počtu opakování, je jej hello výchozí hodnotu 9 nebo hodnotu definovanou uživatelem.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-247">This occurs even when hello current retry count is less than hello max retry count, be it hello default of 9 or a user-defined value.</span></span>

    <span data-ttu-id="9e5b6-248">Při automatizované hello opakování chování pomáhá tooimprove odolnost a použitelnost pro hello většinu aplikací, by mohl pocházet ve odds, když srovnávacího testu výkonu, zejména při měření latence.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-248">While hello automated retry behavior helps tooimprove resiliency and usability for hello most applications, it might come at odds when doing performance benchmarks, especially when measuring latency.</span></span>  <span data-ttu-id="9e5b6-249">latence klienta zjištěnými Hello bude špiček Pokud hello experimentu dotkne hello serveru omezení a způsobí, že hello klienta SDK toosilently opakování.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-249">hello client-observed latency will spike if hello experiment hits hello server throttle and causes hello client SDK toosilently retry.</span></span> <span data-ttu-id="9e5b6-250">latence tooavoid špičky během výkonu experimenty měr hello poplatků vrácený jednotlivých operací a ujistěte se, že jsou pod rychlost vyhrazené požadavků hello operační požadavky.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-250">tooavoid latency spikes during performance experiments, measure hello charge returned by each operation and ensure that requests are operating below hello reserved request rate.</span></span> <span data-ttu-id="9e5b6-251">Další informace najdete v tématu [požadované jednotky](request-units.md).</span><span class="sxs-lookup"><span data-stu-id="9e5b6-251">For more information, see [Request units](request-units.md).</span></span>
3. <span data-ttu-id="9e5b6-252">**Návrh pro menší dokumenty pro vyšší propustnost**</span><span class="sxs-lookup"><span data-stu-id="9e5b6-252">**Design for smaller documents for higher throughput**</span></span>

    <span data-ttu-id="9e5b6-253">Hello poplatků požadavku (tj. zpracování žádosti náklady) dané operace je přímo korelační toohello velikost hello dokumentu.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-253">hello request charge (i.e. request processing cost) of a given operation is directly correlated toohello size of hello document.</span></span> <span data-ttu-id="9e5b6-254">Operace u velkých dokumentů nákladů více než operací pro malé dokumenty.</span><span class="sxs-lookup"><span data-stu-id="9e5b6-254">Operations on large documents cost more than operations for small documents.</span></span>

## <a name="next-steps"></a><span data-ttu-id="9e5b6-255">Další kroky</span><span class="sxs-lookup"><span data-stu-id="9e5b6-255">Next steps</span></span>
<span data-ttu-id="9e5b6-256">Ukázková aplikace používá tooevaluate Cosmos DB pro vysoce výkonné scénáře na několik klientských počítačů, najdete v části [výkonu a možností škálování testování pomocí Cosmos DB](performance-testing.md).</span><span class="sxs-lookup"><span data-stu-id="9e5b6-256">For a sample application used tooevaluate Cosmos DB for high-performance scenarios on a few client machines, see [Performance and scale testing with Cosmos DB](performance-testing.md).</span></span>

<span data-ttu-id="9e5b6-257">Viz také toolearn Další informace o návrhu aplikace pro škálování a vysoký výkon, [dělení a škálování v Azure Cosmos DB](partition-data.md).</span><span class="sxs-lookup"><span data-stu-id="9e5b6-257">Also, toolearn more about designing your application for scale and high performance, see [Partitioning and scaling in Azure Cosmos DB](partition-data.md).</span></span>
