---
title: "Průvodce návrhem úložiště Table aaaAzure | Microsoft Docs"
description: "Návrh škálovatelné a původce tabulky ve službě Azure Table Storage"
services: cosmos-db
documentationcenter: na
author: mimig1
manager: tadb
editor: tysonn
ms.assetid: 8e228b0c-2998-4462-8101-9f16517393ca
ms.service: cosmos-db
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: storage
ms.date: 02/28/2017
ms.author: mimig
ms.openlocfilehash: 059f05a1d20e4d9537034b7ca133c5334bbefa04
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="azure-storage-table-design-guide-designing-scalable-and-performant-tables"></a><span data-ttu-id="4a470-103">Průvodce návrhem tabulky úložiště Azure: Návrh škálovatelné a původce tabulky</span><span class="sxs-lookup"><span data-stu-id="4a470-103">Azure Storage Table Design Guide: Designing Scalable and Performant Tables</span></span>
[!INCLUDE [storage-table-cosmos-db-tip-include](../../includes/storage-table-cosmos-db-tip-include.md)]

<span data-ttu-id="4a470-104">toodesign, škálovatelnou a původce tabulky je nutné zvážit několik faktorů, třeba výkon, škálovatelnost a náklady.</span><span class="sxs-lookup"><span data-stu-id="4a470-104">toodesign scalable and performant tables you must consider a number of factors such as performance, scalability, and cost.</span></span> <span data-ttu-id="4a470-105">Pokud dříve navrženy schémata pro relační databáze, bude těchto aspektů známé tooyou, ale existuje některé podobnosti mezi modelu úložiště služby Azure Table hello a relační modely, existují také mnoho důležité rozdíly.</span><span class="sxs-lookup"><span data-stu-id="4a470-105">If you have previously designed schemas for relational databases, these considerations will be familiar tooyou, but while there are some similarities between hello Azure Table service storage model and relational models, there are also many important differences.</span></span> <span data-ttu-id="4a470-106">Tyto rozdíly obvykle vést toovery různých návrzích, který může vypadat counter-intuitive nebo nesprávný toosomeone obeznámeni s relačních databází, ale které Nedělejte představu, pokud navrhujete pro úložiště dvojic klíč/hodnota NoSQL například hello služby Azure Table.</span><span class="sxs-lookup"><span data-stu-id="4a470-106">These differences typically lead toovery different designs that may look counter-intuitive or wrong toosomeone familiar with relational databases, but which do make good sense if you are designing for a NoSQL key/value store such as hello Azure Table service.</span></span> <span data-ttu-id="4a470-107">Řadu váš návrh rozdíly bude odrážet hello skutečnost, že služby Table hello je navrženou toosupport škálování cloudové aplikace, které může obsahovat až miliardy entit (řádky v terminologii relační databáze), data nebo datové sady, které musí podporovat velmi vysoká transakce svazky: tedy potřebujete toothink jinak o tom, jak ukládat data a pochopit, jak funguje hello služby Table.</span><span class="sxs-lookup"><span data-stu-id="4a470-107">Many of your design differences will reflect hello fact that hello Table service is designed toosupport cloud-scale applications that can contain billions of entities (rows in relational database terminology) of data or for datasets that must support very high transaction volumes: therefore, you need toothink differently about how you store your data and understand how hello Table service works.</span></span> <span data-ttu-id="4a470-108">Dobře navrženým úložiště dat typu NoSQL můžete povolit vaše řešení tooscale mnohem další (a se to při nižších nákladech) než řešení, které používá relační databáze.</span><span class="sxs-lookup"><span data-stu-id="4a470-108">A well designed NoSQL data store can enable your solution tooscale much further (and at a lower cost) than a solution that uses a relational database.</span></span> <span data-ttu-id="4a470-109">Tento průvodce vám pomůže s Tato témata.</span><span class="sxs-lookup"><span data-stu-id="4a470-109">This guide helps you with these topics.</span></span>  

## <a name="about-hello-azure-table-service"></a><span data-ttu-id="4a470-110">O hello služby Azure Table</span><span class="sxs-lookup"><span data-stu-id="4a470-110">About hello Azure Table service</span></span>
<span data-ttu-id="4a470-111">V této části jsou zdůrazněné některé hello klíčové funkce služby Table hello které jsou obzvláště důležité toodesigning pro výkon a škálovatelnost.</span><span class="sxs-lookup"><span data-stu-id="4a470-111">This section highlights some of hello key features of hello Table service that are especially relevant toodesigning for performance and scalability.</span></span> <span data-ttu-id="4a470-112">Pokud jste tooAzure nové úložiště a hello služby Table, nejdřív přečíst [tooMicrosoft Úvod Azure Storage](../storage/common/storage-introduction.md) a [Začínáme s Azure Table Storage pomocí rozhraní .NET](table-storage-how-to-use-dotnet.md) než si přečtete zbytek hello článek.</span><span class="sxs-lookup"><span data-stu-id="4a470-112">If you are new tooAzure Storage and hello Table service, first read [Introduction tooMicrosoft Azure Storage](../storage/common/storage-introduction.md) and [Get started with Azure Table Storage using .NET](table-storage-how-to-use-dotnet.md) before reading hello remainder of this article.</span></span> <span data-ttu-id="4a470-113">I když je aktivní hello tohoto průvodce hello služby Table, bude obsahovat některé diskuzi o hello fronty Azure a objekt Blob služby a jak je možné použít společně s hello služby Table v řešení.</span><span class="sxs-lookup"><span data-stu-id="4a470-113">Although hello focus of this guide is on hello Table service, it will include some discussion of hello Azure Queue and Blob services, and how you might use them along with hello Table service in a solution.</span></span>  

<span data-ttu-id="4a470-114">Co je služba Table hello?</span><span class="sxs-lookup"><span data-stu-id="4a470-114">What is hello Table service?</span></span> <span data-ttu-id="4a470-115">Podle očekávání z názvu hello používá hello služby Table dat toostore tabulkovém formátu.</span><span class="sxs-lookup"><span data-stu-id="4a470-115">As you might expect from hello name, hello Table service uses a tabular format toostore data.</span></span> <span data-ttu-id="4a470-116">V terminologii standardní hello každý řádek tabulky hello reprezentuje entitu a úložiště sloupců hello hello různé vlastnosti dané entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-116">In hello standard terminology, each row of hello table represents an entity, and hello columns store hello various properties of that entity.</span></span> <span data-ttu-id="4a470-117">Každé entity má pár klíčů toouniquely ho, a sloupec časového razítka, která hello služby Table používá tootrack data poslední aktualizace hello entity (k tomu dojde automaticky a nelze ručně přepsat hello časové razítko s libovolnou hodnotou).</span><span class="sxs-lookup"><span data-stu-id="4a470-117">Every entity has a pair of keys toouniquely identify it, and a timestamp column that hello Table service uses tootrack when hello entity was last updated (this happens automatically and you cannot manually overwrite hello timestamp with an arbitrary value).</span></span> <span data-ttu-id="4a470-118">Hello služby Table používá tento optimistickou metodu souběžného toomanage poslední úpravy časové razítko (LMT).</span><span class="sxs-lookup"><span data-stu-id="4a470-118">hello Table service uses this last-modified timestamp (LMT) toomanage optimistic concurrency.</span></span>  

> [!NOTE]
> <span data-ttu-id="4a470-119">operace REST API služby Table Hello se taky vrátit **značka ETag** hodnotu, která je odvozena z razítka poslední úpravy hello (LMT).</span><span class="sxs-lookup"><span data-stu-id="4a470-119">hello Table service REST API operations also return an **ETag** value that it derives from hello last-modified timestamp (LMT).</span></span> <span data-ttu-id="4a470-120">V tomto dokumentu budeme používat hello podmínky ETag a LMT zcela zaměnitelným významem protože odkazují toohello stejné základní data.</span><span class="sxs-lookup"><span data-stu-id="4a470-120">In this document we will use hello terms ETag and LMT interchangeably because they refer toohello same underlying data.</span></span>  
> 
> 

<span data-ttu-id="4a470-121">Hello následující příklad ukazuje toostore návrhu jednoduché tabulky zaměstnanců a oddělení entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-121">hello following example shows a simple table design toostore employee and department entities.</span></span> <span data-ttu-id="4a470-122">Řadu hello příklady uvedené v této příručce jsou založené na tento návrh jednoduché.</span><span class="sxs-lookup"><span data-stu-id="4a470-122">Many of hello examples shown later in this guide are based on this simple design.</span></span>  

<table>
<tr>
<th><span data-ttu-id="4a470-123">Klíč oddílu</span><span class="sxs-lookup"><span data-stu-id="4a470-123">PartitionKey</span></span></th>
<th><span data-ttu-id="4a470-124">RowKey</span><span class="sxs-lookup"><span data-stu-id="4a470-124">RowKey</span></span></th>
<th><span data-ttu-id="4a470-125">časové razítko</span><span class="sxs-lookup"><span data-stu-id="4a470-125">Timestamp</span></span></th>
<th></th>
</tr>
<tr>
<td><span data-ttu-id="4a470-126">Marketing</span><span class="sxs-lookup"><span data-stu-id="4a470-126">Marketing</span></span></td>
<td><span data-ttu-id="4a470-127">00001</span><span class="sxs-lookup"><span data-stu-id="4a470-127">00001</span></span></td>
<td><span data-ttu-id="4a470-128">2014-08-22T00:50:32Z</span><span class="sxs-lookup"><span data-stu-id="4a470-128">2014-08-22T00:50:32Z</span></span></td>
<td>
<table>
<tr>
<th><span data-ttu-id="4a470-129">FirstName</span><span class="sxs-lookup"><span data-stu-id="4a470-129">FirstName</span></span></th>
<th><span data-ttu-id="4a470-130">Příjmení</span><span class="sxs-lookup"><span data-stu-id="4a470-130">LastName</span></span></th>
<th><span data-ttu-id="4a470-131">Věk</span><span class="sxs-lookup"><span data-stu-id="4a470-131">Age</span></span></th>
<th><span data-ttu-id="4a470-132">E-mail</span><span class="sxs-lookup"><span data-stu-id="4a470-132">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="4a470-133">Na ochranu</span><span class="sxs-lookup"><span data-stu-id="4a470-133">Don</span></span></td>
<td><span data-ttu-id="4a470-134">Hall</span><span class="sxs-lookup"><span data-stu-id="4a470-134">Hall</span></span></td>
<td><span data-ttu-id="4a470-135">34</span><span class="sxs-lookup"><span data-stu-id="4a470-135">34</span></span></td>
<td>donh@contoso.com</td>
</tr>
</table>
</tr>
<tr>
<td><span data-ttu-id="4a470-136">Marketing</span><span class="sxs-lookup"><span data-stu-id="4a470-136">Marketing</span></span></td>
<td><span data-ttu-id="4a470-137">00002</span><span class="sxs-lookup"><span data-stu-id="4a470-137">00002</span></span></td>
<td><span data-ttu-id="4a470-138">2014-08-22T00:50:34Z</span><span class="sxs-lookup"><span data-stu-id="4a470-138">2014-08-22T00:50:34Z</span></span></td>
<td>
<table>
<tr>
<th><span data-ttu-id="4a470-139">FirstName</span><span class="sxs-lookup"><span data-stu-id="4a470-139">FirstName</span></span></th>
<th><span data-ttu-id="4a470-140">Příjmení</span><span class="sxs-lookup"><span data-stu-id="4a470-140">LastName</span></span></th>
<th><span data-ttu-id="4a470-141">Věk</span><span class="sxs-lookup"><span data-stu-id="4a470-141">Age</span></span></th>
<th><span data-ttu-id="4a470-142">E-mail</span><span class="sxs-lookup"><span data-stu-id="4a470-142">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="4a470-143">Června</span><span class="sxs-lookup"><span data-stu-id="4a470-143">Jun</span></span></td>
<td><span data-ttu-id="4a470-144">CaO</span><span class="sxs-lookup"><span data-stu-id="4a470-144">Cao</span></span></td>
<td><span data-ttu-id="4a470-145">47</span><span class="sxs-lookup"><span data-stu-id="4a470-145">47</span></span></td>
<td>junc@contoso.com</td>
</tr>
</table>
</tr>
<tr>
<td><span data-ttu-id="4a470-146">Marketing</span><span class="sxs-lookup"><span data-stu-id="4a470-146">Marketing</span></span></td>
<td><span data-ttu-id="4a470-147">Oddělení</span><span class="sxs-lookup"><span data-stu-id="4a470-147">Department</span></span></td>
<td><span data-ttu-id="4a470-148">2014-08-22T00:50:30Z</span><span class="sxs-lookup"><span data-stu-id="4a470-148">2014-08-22T00:50:30Z</span></span></td>
<td>
<table>
<tr>
<th><span data-ttu-id="4a470-149">DepartmentName</span><span class="sxs-lookup"><span data-stu-id="4a470-149">DepartmentName</span></span></th>
<th><span data-ttu-id="4a470-150">EmployeeCount</span><span class="sxs-lookup"><span data-stu-id="4a470-150">EmployeeCount</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="4a470-151">Marketing</span><span class="sxs-lookup"><span data-stu-id="4a470-151">Marketing</span></span></td>
<td><span data-ttu-id="4a470-152">153</span><span class="sxs-lookup"><span data-stu-id="4a470-152">153</span></span></td>
</tr>
</table>
</td>
</tr>
<tr>
<td><span data-ttu-id="4a470-153">Prodej</span><span class="sxs-lookup"><span data-stu-id="4a470-153">Sales</span></span></td>
<td><span data-ttu-id="4a470-154">00010</span><span class="sxs-lookup"><span data-stu-id="4a470-154">00010</span></span></td>
<td><span data-ttu-id="4a470-155">2014-08-22T00:50:44Z</span><span class="sxs-lookup"><span data-stu-id="4a470-155">2014-08-22T00:50:44Z</span></span></td>
<td>
<table>
<tr>
<th><span data-ttu-id="4a470-156">FirstName</span><span class="sxs-lookup"><span data-stu-id="4a470-156">FirstName</span></span></th>
<th><span data-ttu-id="4a470-157">Příjmení</span><span class="sxs-lookup"><span data-stu-id="4a470-157">LastName</span></span></th>
<th><span data-ttu-id="4a470-158">Věk</span><span class="sxs-lookup"><span data-stu-id="4a470-158">Age</span></span></th>
<th><span data-ttu-id="4a470-159">E-mail</span><span class="sxs-lookup"><span data-stu-id="4a470-159">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="4a470-160">Ken</span><span class="sxs-lookup"><span data-stu-id="4a470-160">Ken</span></span></td>
<td><span data-ttu-id="4a470-161">Kwok</span><span class="sxs-lookup"><span data-stu-id="4a470-161">Kwok</span></span></td>
<td><span data-ttu-id="4a470-162">23</span><span class="sxs-lookup"><span data-stu-id="4a470-162">23</span></span></td>
<td>kenk@contoso.com</td>
</tr>
</table>
</td>
</tr>
</table>


<span data-ttu-id="4a470-163">Pokud to vypadá velmi podobné tooa tabulky v relační databázi s hlavní rozdíly hello se hello povinné sloupce, a hello možnost toostore více entit typy v hello stejné tabulky.</span><span class="sxs-lookup"><span data-stu-id="4a470-163">So far, this looks very similar tooa table in a relational database with hello key differences being hello mandatory columns, and hello ability toostore multiple entity types in hello same table.</span></span> <span data-ttu-id="4a470-164">Kromě toho každý hello uživatelem definované vlastnosti, jako například **FirstName** nebo **stáří** má datový typ jako celé číslo nebo řetězec, jenom jako sloupec v relační databázi.</span><span class="sxs-lookup"><span data-stu-id="4a470-164">In addition, each of hello user-defined properties such as **FirstName** or **Age** has a data type, such as integer or string, just like a column in a relational database.</span></span> <span data-ttu-id="4a470-165">I když na rozdíl od v relační databázi, hello bez schématu povaha hello tabulky služby znamená, že vlastnost nemusí mít hello stejný datový typ u každé entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-165">Although unlike in a relational database, hello schema-less nature of hello Table service means that a property need not have hello same data type on each entity.</span></span> <span data-ttu-id="4a470-166">toostore komplexní datových typů v jedné vlastnosti, musíte použít serializovaných formátu například XML nebo JSON.</span><span class="sxs-lookup"><span data-stu-id="4a470-166">toostore complex data types in a single property, you must use a serialized format such as JSON or XML.</span></span> <span data-ttu-id="4a470-167">Další informace o hello tabulky služby, například podporované datové typy, podporované rozsahů, pravidla pojmenování a omezení velikosti najdete v tématu [hello Principy datového modelu služby Table](http://msdn.microsoft.com/library/azure/dd179338.aspx).</span><span class="sxs-lookup"><span data-stu-id="4a470-167">For more information about hello table service such as supported data types, supported date ranges, naming rules, and size constraints, see [Understanding hello Table Service Data Model](http://msdn.microsoft.com/library/azure/dd179338.aspx).</span></span>

<span data-ttu-id="4a470-168">Jak uvidíte, vaši volbu **PartitionKey** a **RowKey** je základní toogood návrh tabulky.</span><span class="sxs-lookup"><span data-stu-id="4a470-168">As you will see, your choice of **PartitionKey** and **RowKey** is fundamental toogood table design.</span></span> <span data-ttu-id="4a470-169">Každou entitu uložené v tabulce musí mít jedinečnou kombinaci **PartitionKey** a **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="4a470-169">Every entity stored in a table must have a unique combination of **PartitionKey** and **RowKey**.</span></span> <span data-ttu-id="4a470-170">Stejně jako u klíče v relační databázi tabulce hello **PartitionKey** a **RowKey** hodnoty jsou indexované toocreate clusterovaný index, který umožňuje rychlé look-ups, ale hello služby Table nevytvoří žádné sekundární indexy tak, aby byly hello jenom dvou indexované vlastnosti (některé vzory hello popsané dál zobrazit jak můžete obejít toto zřejmá omezení).</span><span class="sxs-lookup"><span data-stu-id="4a470-170">As with keys in a relational database table, hello **PartitionKey** and **RowKey** values are indexed toocreate a clustered index that enables fast look-ups; however, hello Table service does not create any secondary indexes so these are hello only two indexed properties (some of hello patterns described later show how you can work around this apparent limitation).</span></span>  

<span data-ttu-id="4a470-171">Tabulka se skládá z jednoho nebo více oddílů, a jak uvidíte, řadu hello rozhodnutí, která učiníte bude kolem vyberete vhodný návrh **PartitionKey** a **RowKey** toooptimize řešení.</span><span class="sxs-lookup"><span data-stu-id="4a470-171">A table is made up of one or more partitions, and as you will see, many of hello design decisions you make will be around choosing a suitable **PartitionKey** and **RowKey** toooptimize your solution.</span></span> <span data-ttu-id="4a470-172">Řešení může obsahovat pouze jednu tabulku, která obsahuje všechny vaše entity, které jsou uspořádány do oddílů, ale obvykle řešení bude mít více tabulek.</span><span class="sxs-lookup"><span data-stu-id="4a470-172">A solution could consist of just a single table that contains all your entities organized into partitions, but typically a solution will have multiple tables.</span></span> <span data-ttu-id="4a470-173">Tabulky umožňují toologically uspořádání vaší entity, snadněji tak můžete spravovat přístup k toohello dat pomocí seznamy řízení přístupu a mohou vyřadit celé tabulky pomocí operace jedno úložiště.</span><span class="sxs-lookup"><span data-stu-id="4a470-173">Tables help you toologically organize your entities, help you manage access toohello data using access control lists, and you can drop an entire table using a single storage operation.</span></span>  

### <a name="table-partitions"></a><span data-ttu-id="4a470-174">Oddíly tabulky</span><span class="sxs-lookup"><span data-stu-id="4a470-174">Table partitions</span></span>
<span data-ttu-id="4a470-175">název účtu Hello, název tabulky a **PartitionKey** společně identifikovat hello oddílu v rámci služby hello úložiště, kde služby table hello ukládá hello entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-175">hello account name, table name and **PartitionKey** together identify hello partition within hello storage service where hello table service stores hello entity.</span></span> <span data-ttu-id="4a470-176">A také se součástí hello adresování schéma pro entity, oddíly definování oboru pro transakce (v tématu [Entity skupiny transakce](#entity-group-transactions) níže) a jak služby table hello škáluje základ hello formuláře.</span><span class="sxs-lookup"><span data-stu-id="4a470-176">As well as being part of hello addressing scheme for entities, partitions define a scope for transactions (see [Entity Group Transactions](#entity-group-transactions) below), and form hello basis of how hello table service scales.</span></span> <span data-ttu-id="4a470-177">Další informace o oddílech najdete v části [a cíle výkonnosti služby Azure Storage Scalability](../storage/common/storage-scalability-targets.md).</span><span class="sxs-lookup"><span data-stu-id="4a470-177">For more information on partitions see [Azure Storage Scalability and Performance Targets](../storage/common/storage-scalability-targets.md).</span></span>  

<span data-ttu-id="4a470-178">V hello služby Table, jednotlivé uzel služeb jeden nebo více dokončení oddíly a hello služby lze rozšířit pomocí dynamické vyrovnávání zatížení oddíly mezi uzly.</span><span class="sxs-lookup"><span data-stu-id="4a470-178">In hello Table service, an individual node services one or more complete partitions and hello service scales by dynamically load-balancing partitions across nodes.</span></span> <span data-ttu-id="4a470-179">Pokud uzel je zatížení, můžete služby table hello *rozdělení* hello rozsah oddílů obsluhovány pomocí daného uzlu do jiných uzlů; při provozu subvence, můžete službu hello *sloučení* hello oddílu rozsahy z quiet uzly zpět do jednoho uzlu.</span><span class="sxs-lookup"><span data-stu-id="4a470-179">If a node is under load, hello table service can *split* hello range of partitions serviced by that node onto different nodes; when traffic subsides, hello service can *merge* hello partition ranges from quiet nodes back onto a single node.</span></span>  

<span data-ttu-id="4a470-180">Další informace o hello interní podrobnosti hello služba Table a na konkrétní způsobu hello služba spravuje oddíly, najdete v dokumentu hello [Microsoft Azure Storage: A vysoce dostupné cloudového úložiště se silnou konzistencí](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/11/20/windows-azure-storage-a-highly-available-cloud-storage-service-with-strong-consistency.aspx).</span><span class="sxs-lookup"><span data-stu-id="4a470-180">For more information about hello internal details of hello Table service, and in particular how hello service manages partitions, see hello paper [Microsoft Azure Storage: A Highly Available Cloud Storage Service with Strong Consistency](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/11/20/windows-azure-storage-a-highly-available-cloud-storage-service-with-strong-consistency.aspx).</span></span>  

### <a name="entity-group-transactions"></a><span data-ttu-id="4a470-181">Transakce skupiny entity</span><span class="sxs-lookup"><span data-stu-id="4a470-181">Entity Group Transactions</span></span>
<span data-ttu-id="4a470-182">V hello služby Table jsou Entity skupiny transakce (EGTs) hello pouze integrované mechanismus pro provádění atomic aktualizace napříč více entit.</span><span class="sxs-lookup"><span data-stu-id="4a470-182">In hello Table service, Entity Group Transactions (EGTs) are hello only built-in mechanism for performing atomic updates across multiple entities.</span></span> <span data-ttu-id="4a470-183">EGTs se také označují tooas *dávky transakce* v některé dokumentaci.</span><span class="sxs-lookup"><span data-stu-id="4a470-183">EGTs are also referred tooas *batch transactions* in some documentation.</span></span> <span data-ttu-id="4a470-184">EGTs mohou pracovat pouze u entit, které jsou uložené v hello stejného oddílu (sdílené složky hello stejným klíčem oddílu v dané tabulce), takže můžete kdykoli potřebujete atomic transakční chování napříč více entit je třeba tooensure, které jsou tyto entity v hello stejného oddílu.</span><span class="sxs-lookup"><span data-stu-id="4a470-184">EGTs can only operate on entities stored in hello same partition (share hello same partition key in a given table), so anytime you need atomic transactional behavior across multiple entities you need tooensure that those entities are in hello same partition.</span></span> <span data-ttu-id="4a470-185">Toto je často důvod pro zachování více typů entit v hello stejné tabulky (a oddílu) a nepoužíváte více tabulek pro typy různých entit.</span><span class="sxs-lookup"><span data-stu-id="4a470-185">This is often a reason for keeping multiple entity types in hello same table (and partition) and not using multiple tables for different entity types.</span></span> <span data-ttu-id="4a470-186">Jeden EGT mohou pracovat na maximálně 100 entit.</span><span class="sxs-lookup"><span data-stu-id="4a470-186">A single EGT can operate on at most 100 entities.</span></span>  <span data-ttu-id="4a470-187">Pokud odešlete více souběžných EGTs pro zpracování, je důležité tooensure těchto EGTs na entity, které jsou společné napříč EGTs při zpracování v opačném případě může být zpoždění nefunguje.</span><span class="sxs-lookup"><span data-stu-id="4a470-187">If you submit multiple concurrent EGTs for processing it is important tooensure  those EGTs do not operate on entities that are common across EGTs as otherwise processing can be delayed.</span></span>

<span data-ttu-id="4a470-188">EGTs také zavádět potenciální kompromis pro tooevaluate při návrhu: pomocí více oddíly bude zvýšení škálovatelnosti hello vaší aplikace, protože Azure má většího počtu možností pro vyrovnávání zatížení požadavky napříč uzly, ale to může omezit hello schopnost vaší aplikace tooperform jednotlivé transakce a udržovat silnou konzistenci pro vaše data.</span><span class="sxs-lookup"><span data-stu-id="4a470-188">EGTs also introduce a potential trade-off for you tooevaluate in your design: using more partitions will increase hello scalability of your application because Azure has more opportunities for load balancing requests across nodes, but this might limit hello ability of your application tooperform atomic transactions and maintain strong consistency for your data.</span></span> <span data-ttu-id="4a470-189">Kromě toho existují určité škálovatelnost cíle na úrovni hello oddílu, který může omezit hello propustnost transakcí můžete očekávat, že pro jeden uzel: Další informace o hello cíle škálovatelnosti pro účty úložiště Azure a tabulku hello najdete v tématu [a cíle výkonnosti služby Azure Storage Scalability](../storage/common/storage-scalability-targets.md).</span><span class="sxs-lookup"><span data-stu-id="4a470-189">Furthermore, there are specific scalability targets at hello level of a partition that might limit hello throughput of transactions you can expect for a single node: for more information about hello scalability targets for Azure storage accounts and hello table service, see [Azure Storage Scalability and Performance Targets](../storage/common/storage-scalability-targets.md).</span></span> <span data-ttu-id="4a470-190">Novější části této příručky popisují různé návrhu strategií, které vám pomohou spravovat kompromis jako je tento a popisují, jak nejlépe toochoose klíč oddílu na základě hello specifických požadavků klientské aplikace.</span><span class="sxs-lookup"><span data-stu-id="4a470-190">Later sections of this guide discuss various design strategies that help you manage trade-offs such as this one, and discuss how best toochoose your partition key based on hello specific requirements of your client application.</span></span>  

### <a name="capacity-considerations"></a><span data-ttu-id="4a470-191">Aspekty kapacity</span><span class="sxs-lookup"><span data-stu-id="4a470-191">Capacity considerations</span></span>
<span data-ttu-id="4a470-192">Hello následující tabulka uvádí některé z hello hodnoty klíče toobe vědět při navrhování řešení pro službu tabulky:</span><span class="sxs-lookup"><span data-stu-id="4a470-192">hello following table includes some of hello key values toobe aware of when you are designing a Table service solution:</span></span>  

| <span data-ttu-id="4a470-193">Celkové kapacity účtu úložiště Azure</span><span class="sxs-lookup"><span data-stu-id="4a470-193">Total capacity of an Azure storage account</span></span> | <span data-ttu-id="4a470-194">500 TB</span><span class="sxs-lookup"><span data-stu-id="4a470-194">500 TB</span></span> |
| --- | --- |
| <span data-ttu-id="4a470-195">Počet tabulek v účtu úložiště Azure</span><span class="sxs-lookup"><span data-stu-id="4a470-195">Number of tables in an Azure storage account</span></span> |<span data-ttu-id="4a470-196">Omezeno pouze hello kapacity účtu úložiště hello</span><span class="sxs-lookup"><span data-stu-id="4a470-196">Limited only by hello capacity of hello storage account</span></span> |
| <span data-ttu-id="4a470-197">Počet oddílů v tabulce</span><span class="sxs-lookup"><span data-stu-id="4a470-197">Number of partitions in a table</span></span> |<span data-ttu-id="4a470-198">Omezeno pouze hello kapacity účtu úložiště hello</span><span class="sxs-lookup"><span data-stu-id="4a470-198">Limited only by hello capacity of hello storage account</span></span> |
| <span data-ttu-id="4a470-199">Počet entit v oddílu</span><span class="sxs-lookup"><span data-stu-id="4a470-199">Number of entities in a partition</span></span> |<span data-ttu-id="4a470-200">Omezeno pouze hello kapacity účtu úložiště hello</span><span class="sxs-lookup"><span data-stu-id="4a470-200">Limited only by hello capacity of hello storage account</span></span> |
| <span data-ttu-id="4a470-201">Velikost jednotlivých entit</span><span class="sxs-lookup"><span data-stu-id="4a470-201">Size of an individual entity</span></span> |<span data-ttu-id="4a470-202">Až too1 MB delší než 255 vlastnosti (včetně hello **PartitionKey**, **RowKey**, a **časové razítko**)</span><span class="sxs-lookup"><span data-stu-id="4a470-202">Up too1 MB with a maximum of 255 properties (including hello **PartitionKey**, **RowKey**, and **Timestamp**)</span></span> |
| <span data-ttu-id="4a470-203">Velikost hello **PartitionKey**</span><span class="sxs-lookup"><span data-stu-id="4a470-203">Size of hello **PartitionKey**</span></span> |<span data-ttu-id="4a470-204">Řetězec se velikost too1 KB</span><span class="sxs-lookup"><span data-stu-id="4a470-204">A string up too1 KB in size</span></span> |
| <span data-ttu-id="4a470-205">Velikost hello **RowKey**</span><span class="sxs-lookup"><span data-stu-id="4a470-205">Size of hello **RowKey**</span></span> |<span data-ttu-id="4a470-206">Řetězec se velikost too1 KB</span><span class="sxs-lookup"><span data-stu-id="4a470-206">A string up too1 KB in size</span></span> |
| <span data-ttu-id="4a470-207">Velikost skupiny Entity transakce</span><span class="sxs-lookup"><span data-stu-id="4a470-207">Size of an Entity Group Transaction</span></span> |<span data-ttu-id="4a470-208">Transakce může obsahovat maximálně 100 entit a datovou část hello musí být menší než 4 MB.</span><span class="sxs-lookup"><span data-stu-id="4a470-208">A transaction can include at most 100 entities and hello payload must be less than 4 MB in size.</span></span> <span data-ttu-id="4a470-209">EGT lze aktualizovat pouze entity jednou.</span><span class="sxs-lookup"><span data-stu-id="4a470-209">An EGT can only update an entity once.</span></span> |

<span data-ttu-id="4a470-210">Další informace najdete v tématu [hello Principy datového modelu služby Table](http://msdn.microsoft.com/library/azure/dd179338.aspx).</span><span class="sxs-lookup"><span data-stu-id="4a470-210">For more information, see [Understanding hello Table Service Data Model](http://msdn.microsoft.com/library/azure/dd179338.aspx).</span></span>  

### <a name="cost-considerations"></a><span data-ttu-id="4a470-211">Aspekty náklady</span><span class="sxs-lookup"><span data-stu-id="4a470-211">Cost considerations</span></span>
<span data-ttu-id="4a470-212">Table storage je relativně levný, ale by měla obsahovat odhadované náklady pro obě kapacitu a využití hello množství transakcí v rámci testování jakéhokoli řešení, které používá služby Table hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-212">Table storage is relatively inexpensive, but you should include cost estimates for both capacity usage and hello quantity of transactions as part of your evaluation of any solution that uses hello Table service.</span></span> <span data-ttu-id="4a470-213">V mnoha scénářích ukládání nenormalizované nebo duplicitní data v pořadí tooimprove hello výkonu nebo škálovatelnost řešení je ale tootake platný přístup.</span><span class="sxs-lookup"><span data-stu-id="4a470-213">However, in many scenarios storing denormalized or duplicate data in order tooimprove hello performance or scalability of your solution is a valid approach tootake.</span></span> <span data-ttu-id="4a470-214">Další informace o cenách najdete v tématu [Azure Storage – ceny](https://azure.microsoft.com/pricing/details/storage/).</span><span class="sxs-lookup"><span data-stu-id="4a470-214">For more information about pricing, see [Azure Storage Pricing](https://azure.microsoft.com/pricing/details/storage/).</span></span>  

## <a name="guidelines-for-table-design"></a><span data-ttu-id="4a470-215">Pokyny pro návrh tabulky</span><span class="sxs-lookup"><span data-stu-id="4a470-215">Guidelines for table design</span></span>
<span data-ttu-id="4a470-216">Tyto seznamy shrnují některé hello klíče pokyny, které jste měli vzít v úvahu při navrhování vaší tabulky a tato příručka se jimi bude zabývat v podrobněji později.</span><span class="sxs-lookup"><span data-stu-id="4a470-216">These lists summarize some of hello key guidelines you should keep in mind when you are designing your tables, and this guide will address them all in more detail later in.</span></span> <span data-ttu-id="4a470-217">Tato pravidla se příliš neliší od hello pokyny, které by obvykle postupujte podle návrh relační databáze.</span><span class="sxs-lookup"><span data-stu-id="4a470-217">These guidelines are very different from hello guidelines you would typically follow for relational database design.</span></span>  

<span data-ttu-id="4a470-218">Navrhování vaší tabulky služby řešení toobe *číst* efektivní:</span><span class="sxs-lookup"><span data-stu-id="4a470-218">Designing your Table service solution toobe *read* efficient:</span></span>

* <span data-ttu-id="4a470-219">***Návrh pro dotazování v aplikacích číst náročné.***</span><span class="sxs-lookup"><span data-stu-id="4a470-219">***Design for querying in read-heavy applications.***</span></span> <span data-ttu-id="4a470-220">Při navrhování vaší tabulky, vezměte v úvahu hello dotazy (zejména hello latence citlivé ty), které se provedou předtím, než si myslíte o tom, jak bude aktualizovat váš entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-220">When you are designing your tables, think about hello queries (especially hello latency sensitive ones) that you will execute before you think about how you will update your entities.</span></span> <span data-ttu-id="4a470-221">To obvykle vede efektivní a původce řešení.</span><span class="sxs-lookup"><span data-stu-id="4a470-221">This typically results in an efficient and performant solution.</span></span>  
* <span data-ttu-id="4a470-222">***Zadejte klíč oddílu a RowKey v dotazech.***</span><span class="sxs-lookup"><span data-stu-id="4a470-222">***Specify both PartitionKey and RowKey in your queries.***</span></span> <span data-ttu-id="4a470-223">*Bod dotazy* , jako jsou ty se hello nejúčinnější tabulky služby dotazy.</span><span class="sxs-lookup"><span data-stu-id="4a470-223">*Point queries* such as these are hello most efficient table service queries.</span></span>  
* <span data-ttu-id="4a470-224">***Zvažte uložení duplicitní kopie entit.***</span><span class="sxs-lookup"><span data-stu-id="4a470-224">***Consider storing duplicate copies of entities.***</span></span> <span data-ttu-id="4a470-225">Table storage je levných, zvažte uložení hello stejné entity vícekrát (s různými klíči) tooenable efektivnější dotazy.</span><span class="sxs-lookup"><span data-stu-id="4a470-225">Table storage is cheap so consider storing hello same entity multiple times (with different keys) tooenable more efficient queries.</span></span>  
* <span data-ttu-id="4a470-226">***Vezměte v úvahu denormalizing vaše data.***</span><span class="sxs-lookup"><span data-stu-id="4a470-226">***Consider denormalizing your data.***</span></span> <span data-ttu-id="4a470-227">Table storage je levných, vezměte v úvahu denormalizing vaše data.</span><span class="sxs-lookup"><span data-stu-id="4a470-227">Table storage is cheap so consider denormalizing your data.</span></span> <span data-ttu-id="4a470-228">Například uložte souhrn entit, tak, aby dotazy pro agregovaná data, stačí tooaccess jedné entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-228">For example, store summary entities so that queries for aggregate data only need tooaccess a single entity.</span></span>  
* <span data-ttu-id="4a470-229">***Použijte hodnoty složeného klíče.***</span><span class="sxs-lookup"><span data-stu-id="4a470-229">***Use compound key values.***</span></span> <span data-ttu-id="4a470-230">Hello pouze klíče máte jsou **PartitionKey** a **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="4a470-230">hello only keys you have are **PartitionKey** and **RowKey**.</span></span> <span data-ttu-id="4a470-231">Například použijte složené klíče hodnoty tooenable alternativní s klíčem přístup cesty tooentities.</span><span class="sxs-lookup"><span data-stu-id="4a470-231">For example, use compound key values tooenable alternate keyed access paths tooentities.</span></span>  
* <span data-ttu-id="4a470-232">***Použijte projekce dotazu.***</span><span class="sxs-lookup"><span data-stu-id="4a470-232">***Use query projection.***</span></span> <span data-ttu-id="4a470-233">Můžete snížit hello množství dat, který přenos přes síť hello pomocí dotazů, které vyberte právě hello pole, které potřebujete.</span><span class="sxs-lookup"><span data-stu-id="4a470-233">You can reduce hello amount of data that you transfer over hello network by using queries that select just hello fields you need.</span></span>  

<span data-ttu-id="4a470-234">Navrhování vaší tabulky služby řešení toobe *zápisu* efektivní:</span><span class="sxs-lookup"><span data-stu-id="4a470-234">Designing your Table service solution toobe *write* efficient:</span></span>  

* <span data-ttu-id="4a470-235">***Nevytvářejte aktivní oddíly.***</span><span class="sxs-lookup"><span data-stu-id="4a470-235">***Do not create hot partitions.***</span></span> <span data-ttu-id="4a470-236">Zvolte klíče, které umožňují toospread své žádosti napříč více oddílů v libovolném bodě času.</span><span class="sxs-lookup"><span data-stu-id="4a470-236">Choose keys that enable you toospread your requests across multiple partitions at any point of time.</span></span>  
* <span data-ttu-id="4a470-237">***Vyhněte se špičky v provozu.***</span><span class="sxs-lookup"><span data-stu-id="4a470-237">***Avoid spikes in traffic.***</span></span> <span data-ttu-id="4a470-238">Funkce Smooth hello provoz přiměřené období a vyhnout se špičky v provozu.</span><span class="sxs-lookup"><span data-stu-id="4a470-238">Smooth hello traffic over a reasonable period of time and avoid spikes in traffic.</span></span>
* <span data-ttu-id="4a470-239">***Nevytvářejte nutně do samostatné tabulky pro každý typ entity.***</span><span class="sxs-lookup"><span data-stu-id="4a470-239">***Don't necessarily create a separate table for each type of entity.***</span></span> <span data-ttu-id="4a470-240">Pokud požadujete jednotlivé transakce mezi typy entit, můžete uložit těchto více typů entit ve stejné oddílu v hello hello stejné tabulky.</span><span class="sxs-lookup"><span data-stu-id="4a470-240">When you require atomic transactions across entity types, you can store these multiple entity types in hello same partition in hello same table.</span></span>
* <span data-ttu-id="4a470-241">***Vezměte v úvahu hello maximální propustnost, kterou musí dosáhnout.***</span><span class="sxs-lookup"><span data-stu-id="4a470-241">***Consider hello maximum throughput you must achieve.***</span></span> <span data-ttu-id="4a470-242">Musí mít přehled o hello cíle škálovatelnosti pro hello služby Table a ujistěte se, že váš návrh nezpůsobí jste tooexceed je.</span><span class="sxs-lookup"><span data-stu-id="4a470-242">You must be aware of hello scalability targets for hello Table service and ensure that your design will not cause you tooexceed them.</span></span>  

<span data-ttu-id="4a470-243">Při čtení této příručky, zobrazí se příklady, které všechny tyto zásady uvedené do praxe.</span><span class="sxs-lookup"><span data-stu-id="4a470-243">As you read this guide, you will see examples that put all of these principles into practice.</span></span>  

## <a name="design-for-querying"></a><span data-ttu-id="4a470-244">Návrh pro dotazování</span><span class="sxs-lookup"><span data-stu-id="4a470-244">Design for querying</span></span>
<span data-ttu-id="4a470-245">Řešení služby TABLE lze číst náročné na prostředky, zápis náročné na prostředky nebo jejich kombinace hello dva.</span><span class="sxs-lookup"><span data-stu-id="4a470-245">Table service solutions may be read intensive, write intensive, or a mix of hello two.</span></span> <span data-ttu-id="4a470-246">Tato část se zaměřuje na toobear věcí hello nezapomeňte při návrhu vaší toosupport služby tabulky operací čtení efektivně.</span><span class="sxs-lookup"><span data-stu-id="4a470-246">This section focuses on hello things toobear in mind when you are designing your Table service toosupport read operations efficiently.</span></span> <span data-ttu-id="4a470-247">Návrh podporuje efektivně zapisovacích operací je obvykle také efektivní pro operace zápisu.</span><span class="sxs-lookup"><span data-stu-id="4a470-247">Typically, a design that supports read operations efficiently is also efficient for write operations.</span></span> <span data-ttu-id="4a470-248">Existují však toobear další aspekty v úvahu při navrhování toosupport zápisu operace, které jsou popsané v další části hello, [návrhu pro úpravu dat](#design-for-data-modification).</span><span class="sxs-lookup"><span data-stu-id="4a470-248">However, there are additional considerations toobear in mind when designing toosupport write operations, discussed in hello next section, [Design for data modification](#design-for-data-modification).</span></span>

<span data-ttu-id="4a470-249">To dobrý výchozí bod pro návrh vaší tabulky služby řešení tooenable tooread data efektivně je tooask "jaké dotazy bude Moje nutné tooexecute tooretrieve hello data aplikací, které je nutné z hello služby Table?"</span><span class="sxs-lookup"><span data-stu-id="4a470-249">A good starting point for designing your Table service solution tooenable you tooread data efficiently is tooask "What queries will my application need tooexecute tooretrieve hello data it needs from hello Table service?"</span></span>  

> [!NOTE]
> <span data-ttu-id="4a470-250">S hello služby Table, je důležité tooget hello návrhu správné předem protože je složité a nákladné toochange později.</span><span class="sxs-lookup"><span data-stu-id="4a470-250">With hello Table service, it's important tooget hello design correct up front because it's difficult and expensive toochange it later.</span></span> <span data-ttu-id="4a470-251">Například v relační databázi je často problémy s výkonem možné tooaddress jednoduše přidáním indexuje existující databázi tooan: to není možné s hello služby Table.</span><span class="sxs-lookup"><span data-stu-id="4a470-251">For example, in a relational database it's often possible tooaddress performance issues simply by adding indexes tooan existing database: this is not an option with hello Table service.</span></span>  
> 
> 

<span data-ttu-id="4a470-252">Tato část se zaměřuje na hello klíčových otázek, které musíte vyřešit, když tabulek pro zadávání dotazů.</span><span class="sxs-lookup"><span data-stu-id="4a470-252">This section focuses on hello key issues you must address when you design your tables for querying.</span></span> <span data-ttu-id="4a470-253">témata Hello uvedenými v této části:</span><span class="sxs-lookup"><span data-stu-id="4a470-253">hello topics covered in this section include:</span></span>

* [<span data-ttu-id="4a470-254">Jak vaši volbu PartitionKey a RowKey ovlivňuje výkon dotazů</span><span class="sxs-lookup"><span data-stu-id="4a470-254">How your choice of PartitionKey and RowKey impacts query performance</span></span>](#how-your-choice-of-partitionkey-and-rowkey-impacts-query-performance)
* [<span data-ttu-id="4a470-255">Výběr vhodné PartitionKey</span><span class="sxs-lookup"><span data-stu-id="4a470-255">Choosing an appropriate PartitionKey</span></span>](#choosing-an-appropriate-partitionkey)
* [<span data-ttu-id="4a470-256">Optimalizace dotazů pro hello služby Table</span><span class="sxs-lookup"><span data-stu-id="4a470-256">Optimizing queries for hello Table service</span></span>](#optimizing-queries-for-the-table-service)
* [<span data-ttu-id="4a470-257">Řazení dat v hello služby Table</span><span class="sxs-lookup"><span data-stu-id="4a470-257">Sorting data in hello Table service</span></span>](#sorting-data-in-the-table-service)

### <a name="how-your-choice-of-partitionkey-and-rowkey-impacts-query-performance"></a><span data-ttu-id="4a470-258">Jak vaši volbu PartitionKey a RowKey ovlivňuje výkon dotazů</span><span class="sxs-lookup"><span data-stu-id="4a470-258">How your choice of PartitionKey and RowKey impacts query performance</span></span>
<span data-ttu-id="4a470-259">Hello následující příklady předpokládají služby table hello je ukládání entit zaměstnanec s hello strukturu (většina z příkladů hello vynechejte hello **časové razítko** vlastnost pro přehlednost):</span><span class="sxs-lookup"><span data-stu-id="4a470-259">hello following examples assume hello table service is storing employee entities with hello following structure (most of hello examples omit hello **Timestamp** property for clarity):</span></span>  

| <span data-ttu-id="4a470-260">*Název sloupce*</span><span class="sxs-lookup"><span data-stu-id="4a470-260">*Column name*</span></span> | <span data-ttu-id="4a470-261">*Datový typ*</span><span class="sxs-lookup"><span data-stu-id="4a470-261">*Data type*</span></span> |
| --- | --- |
| <span data-ttu-id="4a470-262">**PartitionKey** (název oddělení)</span><span class="sxs-lookup"><span data-stu-id="4a470-262">**PartitionKey** (Department Name)</span></span> |<span data-ttu-id="4a470-263">Řetězec</span><span class="sxs-lookup"><span data-stu-id="4a470-263">String</span></span> |
| <span data-ttu-id="4a470-264">**RowKey** (Id zaměstnance)</span><span class="sxs-lookup"><span data-stu-id="4a470-264">**RowKey** (Employee Id)</span></span> |<span data-ttu-id="4a470-265">Řetězec</span><span class="sxs-lookup"><span data-stu-id="4a470-265">String</span></span> |
| <span data-ttu-id="4a470-266">**FirstName**</span><span class="sxs-lookup"><span data-stu-id="4a470-266">**FirstName**</span></span> |<span data-ttu-id="4a470-267">Řetězec</span><span class="sxs-lookup"><span data-stu-id="4a470-267">String</span></span> |
| <span data-ttu-id="4a470-268">**Příjmení**</span><span class="sxs-lookup"><span data-stu-id="4a470-268">**LastName**</span></span> |<span data-ttu-id="4a470-269">Řetězec</span><span class="sxs-lookup"><span data-stu-id="4a470-269">String</span></span> |
| <span data-ttu-id="4a470-270">**Stáří**</span><span class="sxs-lookup"><span data-stu-id="4a470-270">**Age**</span></span> |<span data-ttu-id="4a470-271">Integer</span><span class="sxs-lookup"><span data-stu-id="4a470-271">Integer</span></span> |
| <span data-ttu-id="4a470-272">**EmailAddress**</span><span class="sxs-lookup"><span data-stu-id="4a470-272">**EmailAddress**</span></span> |<span data-ttu-id="4a470-273">Řetězec</span><span class="sxs-lookup"><span data-stu-id="4a470-273">String</span></span> |

<span data-ttu-id="4a470-274">Hello výše uvedené části [Přehled služby Azure Table](#overview) popisuje některé z hello klíčové funkce hello služby Azure Table které mají přímý vliv na návrh pro dotaz.</span><span class="sxs-lookup"><span data-stu-id="4a470-274">hello earlier section [Azure Table service overview](#overview) describes some of hello key features of hello Azure Table service that have a direct influence on designing for query.</span></span> <span data-ttu-id="4a470-275">To mít za následek hello následující obecné pokyny pro návrh tabulky služby dotazy.</span><span class="sxs-lookup"><span data-stu-id="4a470-275">These result in hello following general guidelines for designing Table service queries.</span></span> <span data-ttu-id="4a470-276">Upozorňujeme, že se syntaxí filtru hello použít v následujících příkladech hello se ze služby Table hello rozhraní REST API, další informace najdete v tématu [dotazu entity](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span><span class="sxs-lookup"><span data-stu-id="4a470-276">Note that hello filter syntax used in hello examples below is from hello Table service REST API, for more information see [Query Entities](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span></span>  

* <span data-ttu-id="4a470-277">A ***bodu dotazu*** je nejúčinnější toouse vyhledávání hello a doporučuje toobe používá pro vyhledávání vysoký počet nebo vyhledávání, které vyžadují nejnižší latenci.</span><span class="sxs-lookup"><span data-stu-id="4a470-277">A ***Point Query*** is hello most efficient lookup toouse and is recommended toobe used for high-volume lookups or lookups requiring lowest latency.</span></span> <span data-ttu-id="4a470-278">Pak můžete takový dotaz velmi efektivně použít hello indexy toolocate jednotlivých entit zadáním obě hello **PartitionKey** a **RowKey** hodnoty.</span><span class="sxs-lookup"><span data-stu-id="4a470-278">Such a query can use hello indexes toolocate an individual entity very efficiently by specifying both hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="4a470-279">Příklad: $filter = (PartitionKey eq 'Prodej') a (RowKey eq: 2.)</span><span class="sxs-lookup"><span data-stu-id="4a470-279">For example: $filter=(PartitionKey eq 'Sales') and (RowKey eq '2')</span></span>  
* <span data-ttu-id="4a470-280">Druhý nejlépe je ***dotazu na rozsah*** používající hello **PartitionKey** a filtry pro celou řadu **RowKey** hodnoty tooreturn více než jedna entita.</span><span class="sxs-lookup"><span data-stu-id="4a470-280">Second best is a ***Range Query*** that uses hello **PartitionKey** and filters on a range of **RowKey** values tooreturn more than one entity.</span></span> <span data-ttu-id="4a470-281">Hello **PartitionKey** hodnota identifikuje konkrétního oddílu a hello **RowKey** hodnoty identifikovat podmnožinu hello entity v oddílu.</span><span class="sxs-lookup"><span data-stu-id="4a470-281">hello **PartitionKey** value identifies a specific partition, and hello **RowKey** values identify a subset of hello entities in that partition.</span></span> <span data-ttu-id="4a470-282">Příklad: $filter = PartitionKey eq 'prodeje a RowKey ge' a RowKey lt se.</span><span class="sxs-lookup"><span data-stu-id="4a470-282">For example: $filter=PartitionKey eq 'Sales' and RowKey ge 'S' and RowKey lt 'T'</span></span>  
* <span data-ttu-id="4a470-283">Je třetí nejlepší ***oddílu kontrolovat*** používající hello **PartitionKey** a filtry na jiné neklíčovou vlastnost a který může vrátit více než jedna entita.</span><span class="sxs-lookup"><span data-stu-id="4a470-283">Third best is a ***Partition Scan*** that uses hello **PartitionKey** and filters on another non-key property and that may return more than one entity.</span></span> <span data-ttu-id="4a470-284">Hello **PartitionKey** hodnota identifikuje na konkrétní oddíl a hodnoty vlastnosti hello, vyberte pro podmnožinu hello entity v oddílu.</span><span class="sxs-lookup"><span data-stu-id="4a470-284">hello **PartitionKey** value identifies a specific partition, and hello property values select for a subset of hello entities in that partition.</span></span> <span data-ttu-id="4a470-285">Příklad: $filter = PartitionKey eq 'prodeje a LastName eq: Váša.</span><span class="sxs-lookup"><span data-stu-id="4a470-285">For example: $filter=PartitionKey eq 'Sales' and LastName eq 'Smith'</span></span>  
* <span data-ttu-id="4a470-286">A ***tabulky kontrolovat*** nezahrnuje hello **PartitionKey** a je velmi neefektivní, protože všechny hello oddíly, které tvoří tabulku zase pro všechny odpovídající entity vyhledávání.</span><span class="sxs-lookup"><span data-stu-id="4a470-286">A ***Table Scan*** does not include hello **PartitionKey** and is very inefficient because it searches all of hello partitions that make up your table in turn for any matching entities.</span></span> <span data-ttu-id="4a470-287">Provede prohledávání tabulky bez ohledu na to, zda filtr používá hello **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="4a470-287">It will perform a table scan regardless of whether or not your filter uses hello **RowKey**.</span></span> <span data-ttu-id="4a470-288">Příklad: $filter = LastName eq 'Petr.</span><span class="sxs-lookup"><span data-stu-id="4a470-288">For example: $filter=LastName eq 'Jones'</span></span>  
* <span data-ttu-id="4a470-289">Dotazy, které vracejí víc entit obnoví v nich seřazeny ve **PartitionKey** a **RowKey** pořadí.</span><span class="sxs-lookup"><span data-stu-id="4a470-289">Queries that return multiple entities return them sorted in **PartitionKey** and **RowKey** order.</span></span> <span data-ttu-id="4a470-290">Zvolte tooavoid opětné řazení hello entity v hello klienta **RowKey** , který definuje hello nejběžnější pořadí řazení.</span><span class="sxs-lookup"><span data-stu-id="4a470-290">tooavoid resorting hello entities in hello client, choose a **RowKey** that defines hello most common sort order.</span></span>  

<span data-ttu-id="4a470-291">Všimněte si, že pomocí "**nebo**" toospecify filtr na základě **RowKey** hodnoty výsledků v oddílu kontroly a nepovažuje se za dotazu na rozsah.</span><span class="sxs-lookup"><span data-stu-id="4a470-291">Note that using an "**or**" toospecify a filter based on **RowKey** values results in a partition scan and is not treated as a range query.</span></span> <span data-ttu-id="4a470-292">Proto byste neměli dotazy, které pomocí filtrů, jako například: $filter = PartitionKey eq 'Prodej' a (RowKey eq '121' nebo RowKey eq "322")</span><span class="sxs-lookup"><span data-stu-id="4a470-292">Therefore, you should avoid queries that use filters such as: $filter=PartitionKey eq 'Sales' and (RowKey eq '121' or RowKey eq '322')</span></span>  

<span data-ttu-id="4a470-293">Příklady kódu na straně klienta, které používají efektivní dotazy tooexecute hello Klientská knihovna pro úložiště najdete v tématu:</span><span class="sxs-lookup"><span data-stu-id="4a470-293">For examples of client-side code that use hello Storage Client Library tooexecute efficient queries, see:</span></span>  

* [<span data-ttu-id="4a470-294">Spuštění dotazu na bodu pomocí hello Klientská knihovna pro úložiště</span><span class="sxs-lookup"><span data-stu-id="4a470-294">Executing a point query using hello Storage Client Library</span></span>](#executing-a-point-query-using-the-storage-client-library)
* [<span data-ttu-id="4a470-295">Načítání více entit pomocí LINQ</span><span class="sxs-lookup"><span data-stu-id="4a470-295">Retrieving multiple entities using LINQ</span></span>](#retrieving-multiple-entities-using-linq)
* [<span data-ttu-id="4a470-296">Projekce na straně serveru</span><span class="sxs-lookup"><span data-stu-id="4a470-296">Server-side projection</span></span>](#server-side-projection)  

<span data-ttu-id="4a470-297">Příklady kódu na straně klienta, který může zpracovat více entit typy uložené v hello stejné tabulky najdete v tématu:</span><span class="sxs-lookup"><span data-stu-id="4a470-297">For examples of client-side code that can handle multiple entity types stored in hello same table, see:</span></span>  

* [<span data-ttu-id="4a470-298">Práce s typy heterogenní entit</span><span class="sxs-lookup"><span data-stu-id="4a470-298">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)  

### <a name="choosing-an-appropriate-partitionkey"></a><span data-ttu-id="4a470-299">Výběr vhodné PartitionKey</span><span class="sxs-lookup"><span data-stu-id="4a470-299">Choosing an appropriate PartitionKey</span></span>
<span data-ttu-id="4a470-300">Vaši volbu **PartitionKey** by měl vyrovnávat hello nutné tooenables hello použití EGTs (tooensure konzistence) proti hello požadavek toodistribute vaší entity ve více oddílů (tooensure škálovatelné řešení).</span><span class="sxs-lookup"><span data-stu-id="4a470-300">Your choice of **PartitionKey** should balance hello need tooenables hello use of EGTs (tooensure consistency) against hello requirement toodistribute your entities across multiple partitions (tooensure a scalable solution).</span></span>  

<span data-ttu-id="4a470-301">V jedné extreme může ukládat všechny entity v jeden oddíl, ale to může omezit škálovatelnost hello vašeho řešení a by bránily je možné tooload vyrovnávat požadavky na služby table hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-301">At one extreme, you could store all your entities in a single partition, but this may limit hello scalability of your solution and would prevent hello table service from being able tooload-balance requests.</span></span> <span data-ttu-id="4a470-302">V hello jiných extreme může uložit jednu entitu na oddíl, který bude vysoce škálovatelné a která umožňuje hello tabulky služby tooload vyrovnávat požadavky, ale které by zabránit vám v použití transakcí skupiny entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-302">At hello other extreme, you could store one entity per partition, which would be highly scalable and which enables hello table service tooload-balance requests, but which would prevent you from using entity group transactions.</span></span>  

<span data-ttu-id="4a470-303">Ideálu **PartitionKey** je ten, který vám umožní efektivní dotazy toouse a má dostatek tooensure oddíly řešení je škálovatelná.</span><span class="sxs-lookup"><span data-stu-id="4a470-303">An ideal **PartitionKey** is one that enables you toouse efficient queries and that has sufficient partitions tooensure your solution is scalable.</span></span> <span data-ttu-id="4a470-304">Obvykle zjistíte, že vaší entity budou mít vhodný vlastnost, která distribuuje vaší entity v dostatečná oddíly.</span><span class="sxs-lookup"><span data-stu-id="4a470-304">Typically, you will find that your entities will have a suitable property that distributes your entities across sufficient partitions.</span></span>

> [!NOTE]
> <span data-ttu-id="4a470-305">V systému, která uchovává informace o uživatele nebo zaměstnancům, například ID uživatele může být dobrým PartitionKey.</span><span class="sxs-lookup"><span data-stu-id="4a470-305">For example, in a system that stores information about users or employees, UserID may be a good PartitionKey.</span></span> <span data-ttu-id="4a470-306">Může mít několik entit, které použít jako klíč oddílu hello dané ID uživatele.</span><span class="sxs-lookup"><span data-stu-id="4a470-306">You may have several entities that use a given UserID as hello partition key.</span></span> <span data-ttu-id="4a470-307">Každá entita, která ukládá data o uživateli se seskupují do jednoho oddílu, a proto tyto entity jsou přístupné přes transakce skupiny entity, ale stále mít vysoce škálovatelná.</span><span class="sxs-lookup"><span data-stu-id="4a470-307">Each entity that stores data about a user is grouped into a single partition, and so these entities are accessible via entity group transactions, while still being highly scalable.</span></span>
> 
> 

<span data-ttu-id="4a470-308">Další rozhodnutí v požadovaném **PartitionKey** které se týkají toohow bude vložit, aktualizovat a odstranit entity: najdete v tématu hello [návrhu pro úpravu dat](#design-for-data-modification) níže.</span><span class="sxs-lookup"><span data-stu-id="4a470-308">There are additional considerations in your choice of **PartitionKey** that relate toohow you will insert, update, and delete entities: see hello section [Design for data modification](#design-for-data-modification) below.</span></span>  

### <a name="optimizing-queries-for-hello-table-service"></a><span data-ttu-id="4a470-309">Optimalizace dotazů pro hello služby Table</span><span class="sxs-lookup"><span data-stu-id="4a470-309">Optimizing queries for hello Table service</span></span>
<span data-ttu-id="4a470-310">Hello služby Table automaticky indexuje vaší entity pomocí hello **PartitionKey** a **RowKey** hodnot v jednom clusterovaný index, proto hello důvodu, že bod dotazy jsou hello nejúčinnější toouse .</span><span class="sxs-lookup"><span data-stu-id="4a470-310">hello Table service automatically indexes your entities using hello **PartitionKey** and **RowKey** values in a single clustered index, hence hello reason that point queries are hello most efficient toouse.</span></span> <span data-ttu-id="4a470-311">Však nejsou žádné indexy než tu, která na clusterovaný index hello hello **PartitionKey** a **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="4a470-311">However, there are no indexes other than that on hello clustered index on hello **PartitionKey** and **RowKey**.</span></span>

<span data-ttu-id="4a470-312">Řada návrhů musí splňovat požadavky na vyhledávání tooenable entit na základě několika kritérií.</span><span class="sxs-lookup"><span data-stu-id="4a470-312">Many designs must meet requirements tooenable lookup of entities based on multiple criteria.</span></span> <span data-ttu-id="4a470-313">Například hledání zaměstnanec entity podle e-mailu, identifikační číslo zaměstnance nebo příjmení.</span><span class="sxs-lookup"><span data-stu-id="4a470-313">For example, locating employee entities based on email, employee id, or last name.</span></span> <span data-ttu-id="4a470-314">tyto vzory v části hello Hello [vzory návrhu tabulky](#table-design-patterns) adres tyto typy požadavek a popisují způsoby obcházet hello fakt, že služby Table hello nenabízí sekundární indexy:</span><span class="sxs-lookup"><span data-stu-id="4a470-314">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address these types of requirement and describe ways of working around hello fact that hello Table service does not provide secondary indexes:</span></span>  

* <span data-ttu-id="4a470-315">[Vzor sekundární index Intra-partition](#intra-partition-secondary-index-pattern) -uložit více kopií každou entitu s využitím různých **RowKey** hodnoty (v hello stejného oddílu) tooenable rychlé a efektivní vyhledávání a řazení alternativní řadí pomocí různé **RowKey** hodnoty.</span><span class="sxs-lookup"><span data-stu-id="4a470-315">[Intra-partition secondary index pattern](#intra-partition-secondary-index-pattern) - Store multiple copies of each entity using different **RowKey** values (in hello same partition) tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  
* <span data-ttu-id="4a470-316">[Vzor mezi oddíl sekundární index](#inter-partition-secondary-index-pattern) – ukládání více kopií každé entity pomocí různých hodnot RowKey v samostatné oddíly nebo v samostatných tabulkách tooenable rychlé a efektivní vyhledávání a řazení alternativní řadí pomocí různých **RowKey** hodnoty.</span><span class="sxs-lookup"><span data-stu-id="4a470-316">[Inter-partition secondary index pattern](#inter-partition-secondary-index-pattern) - Store multiple copies of each entity using different RowKey values in separate partitions or in separate tables tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  
* <span data-ttu-id="4a470-317">[Index entity vzor](#index-entities-pattern) -udržovat index entity tooenable efektivní vyhledávání, která vrátí seznam entit.</span><span class="sxs-lookup"><span data-stu-id="4a470-317">[Index Entities Pattern](#index-entities-pattern) - Maintain index entities tooenable efficient searches that return lists of entities.</span></span>  

### <a name="sorting-data-in-hello-table-service"></a><span data-ttu-id="4a470-318">Řazení dat v hello služby Table</span><span class="sxs-lookup"><span data-stu-id="4a470-318">Sorting data in hello Table service</span></span>
<span data-ttu-id="4a470-319">Hello služby Table vrací entity ve vzestupném pořadí podle **PartitionKey** a potom podle **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="4a470-319">hello Table service returns entities sorted in ascending order based on **PartitionKey** and then by **RowKey**.</span></span> <span data-ttu-id="4a470-320">Tyto klíče jsou hodnoty řetězce a tooensure, která číselné hodnoty řadit správně, měli byste je převést tooa pevná délka a jejich odsadí nulami.</span><span class="sxs-lookup"><span data-stu-id="4a470-320">These keys are string values and tooensure that numeric values sort correctly, you should convert them tooa fixed length and pad them with zeroes.</span></span> <span data-ttu-id="4a470-321">Například pokud hello hodnota id zaměstnance můžete použít jako hello **RowKey** je celočíselná hodnota, bude třeba převést identifikační číslo zaměstnance **123** příliš**00000123**.</span><span class="sxs-lookup"><span data-stu-id="4a470-321">For example, if hello employee id value you use as hello **RowKey** is an integer value, you should convert employee id **123** too**00000123**.</span></span>  

<span data-ttu-id="4a470-322">Mnoho aplikací mít požadavky na toouse data seřazená v různém pořadí: například řazení zaměstnanci podle názvu nebo díky připojení ke službě data.</span><span class="sxs-lookup"><span data-stu-id="4a470-322">Many applications have requirements toouse data sorted in different orders: for example, sorting employees by name, or by joining date.</span></span> <span data-ttu-id="4a470-323">Hello tyto vzory v části hello [vzory návrhu tabulky](#table-design-patterns) adres, jak pořadí řazení tooalternate pro vaše entity:</span><span class="sxs-lookup"><span data-stu-id="4a470-323">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address how tooalternate sort orders for your entities:</span></span>  

* <span data-ttu-id="4a470-324">[Vzor sekundární index Intra-partition](#intra-partition-secondary-index-pattern) -uložit více kopií každé entity pomocí různých hodnot RowKey (v hello stejného oddílu) tooenable rychlé a efektivní vyhledávání a řazení alternativní řadí za použití různých hodnot RowKey.</span><span class="sxs-lookup"><span data-stu-id="4a470-324">[Intra-partition secondary index pattern](#intra-partition-secondary-index-pattern) - Store multiple copies of each entity using different RowKey values (in hello same partition) tooenable fast and efficient lookups and alternate sort orders by using different RowKey values.</span></span>  
* <span data-ttu-id="4a470-325">[Vzor mezi oddíl sekundární index](#inter-partition-secondary-index-pattern) – ukládání více kopií každé entity pomocí různých hodnot RowKey v samostatné oddíly v samostatných tabulkách tooenable rychlé a efektivní vyhledávání a řazení alternativní řadí pomocí různých RowKey hodnoty.</span><span class="sxs-lookup"><span data-stu-id="4a470-325">[Inter-partition secondary index pattern](#inter-partition-secondary-index-pattern) - Store multiple copies of each entity using different RowKey values in separate partitions in separate tables tooenable fast and efficient lookups and alternate sort orders by using different RowKey values.</span></span>
* <span data-ttu-id="4a470-326">[Vzor protokolu poškozené databáze](#log-tail-pattern) -načtení hello * n * entity naposledy přidat oddíl tooa pomocí **RowKey** hodnotu, která seřadí zpětné datum a čas pořadí.</span><span class="sxs-lookup"><span data-stu-id="4a470-326">[Log tail pattern](#log-tail-pattern) - Retrieve hello *n* entities most recently added tooa partition by using a **RowKey** value that sorts in reverse date and time order.</span></span>  

## <a name="design-for-data-modification"></a><span data-ttu-id="4a470-327">Návrh pro úpravu dat</span><span class="sxs-lookup"><span data-stu-id="4a470-327">Design for data modification</span></span>
<span data-ttu-id="4a470-328">Tato část se zaměřuje na aspekty návrhu hello pro optimalizaci vložení, aktualizace a odstraní.</span><span class="sxs-lookup"><span data-stu-id="4a470-328">This section focuses on hello design considerations for optimizing inserts, updates, and deletes.</span></span> <span data-ttu-id="4a470-329">V některých případech je nutné tooevaluate hello kompromis mezi návrhů, které je optimální pro dotazování na návrhů, které je optimální pro úpravu dat stejným způsobem jako v návrhy pro relační databáze (i když hello techniky pro správu hello návrhu kompromis se liší v relační databázi).</span><span class="sxs-lookup"><span data-stu-id="4a470-329">In some cases, you will need tooevaluate hello trade-off between designs that optimize for querying against designs that optimize for data modification just as you do in designs for relational databases (although hello techniques for managing hello design trade-offs are different in a relational database).</span></span> <span data-ttu-id="4a470-330">Hello části [vzory návrhu tabulky](#table-design-patterns) popisuje některé podrobné návrhových schématech hello služby Table a zvýrazňuje některé tyto kompromis.</span><span class="sxs-lookup"><span data-stu-id="4a470-330">hello section [Table Design Patterns](#table-design-patterns) describes some detailed design patterns for hello Table service and highlights some these trade-offs.</span></span> <span data-ttu-id="4a470-331">V praxi zjistíte, že řada návrhů optimalizované pro dotazování entity také fungovat i pro úpravy entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-331">In practice, you will find that many designs optimized for querying entities also work well for modifying entities.</span></span>  

### <a name="optimizing-hello-performance-of-insert-update-and-delete-operations"></a><span data-ttu-id="4a470-332">Optimalizace výkonu hello vložit, aktualizovat a operace odstranění</span><span class="sxs-lookup"><span data-stu-id="4a470-332">Optimizing hello performance of insert, update, and delete operations</span></span>
<span data-ttu-id="4a470-333">tooupdate nebo odstranění entity, musí být schopný tooidentify ho pomocí hello **PartitionKey** a **RowKey** hodnoty.</span><span class="sxs-lookup"><span data-stu-id="4a470-333">tooupdate or delete an entity, you must be able tooidentify it by using hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="4a470-334">V tomto ohledu vaši volbu **PartitionKey** a **RowKey** pro úpravy entity byste měli postupovat podle podobné kritéria tooyour volba toosupport bodu dotazů, protože chcete, aby tooidentify entity jako možná nejefektivněji.</span><span class="sxs-lookup"><span data-stu-id="4a470-334">In this respect, your choice of **PartitionKey** and **RowKey** for modifying entities should follow similar criteria tooyour choice toosupport point queries because you want tooidentify entities as efficiently as possible.</span></span> <span data-ttu-id="4a470-335">Nechcete toouse neefektivní oddílu nebo tabulky kontroly toolocate entity v pořadí toodiscover hello **PartitionKey** a **RowKey** hodnoty potřebovat tooupdate nebo ho odstranit.</span><span class="sxs-lookup"><span data-stu-id="4a470-335">You do not want toouse an inefficient partition or table scan toolocate an entity in order toodiscover hello **PartitionKey** and **RowKey** values you need tooupdate or delete it.</span></span>  

<span data-ttu-id="4a470-336">tyto vzory v části hello Hello [vzory návrhu tabulky](#table-design-patterns) adres optimalizace výkonu hello nebo vaší insert, update a operace odstranění:</span><span class="sxs-lookup"><span data-stu-id="4a470-336">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address optimizing hello performance or your insert, update, and delete operations:</span></span>  

* <span data-ttu-id="4a470-337">[Velkému odstranit vzor](#high-volume-delete-pattern) -Povolit odstranění hello k velkému počtu entity uložením všechny entity hello k odstranění souběžných vlastní samostatné tabulky; odstranit hello entity odstraněním hello tabulky.</span><span class="sxs-lookup"><span data-stu-id="4a470-337">[High volume delete pattern](#high-volume-delete-pattern) - Enable hello deletion of a high volume of entities by storing all hello entities for simultaneous deletion in their own separate table; you delete hello entities by deleting hello table.</span></span>  
* <span data-ttu-id="4a470-338">[Vzorek dat řady](#data-series-pattern) -úložiště dokončení datové řady za jedné entity toominimize hello počet požadavků, které provedete.</span><span class="sxs-lookup"><span data-stu-id="4a470-338">[Data series pattern](#data-series-pattern) - Store complete data series in a single entity toominimize hello number of requests you make.</span></span>  
* <span data-ttu-id="4a470-339">[Vzor široké entity](#wide-entities-pattern) -použití více fyzických entit toostore logických entit s více než 252 vlastností.</span><span class="sxs-lookup"><span data-stu-id="4a470-339">[Wide entities pattern](#wide-entities-pattern) - Use multiple physical entities toostore logical entities with more than 252 properties.</span></span>  
* <span data-ttu-id="4a470-340">[Vzor velké entity](#large-entities-pattern) -použití objektu blob úložiště toostore vlastnost velké hodnoty.</span><span class="sxs-lookup"><span data-stu-id="4a470-340">[Large entities pattern](#large-entities-pattern) - Use blob storage toostore large property values.</span></span>  

### <a name="ensuring-consistency-in-your-stored-entities"></a><span data-ttu-id="4a470-341">Zajištění konzistence v uložené entity</span><span class="sxs-lookup"><span data-stu-id="4a470-341">Ensuring consistency in your stored entities</span></span>
<span data-ttu-id="4a470-342">Hello jiných klíčovým faktorem, který ovlivňuje vaši volbu klíče pro optimalizaci změny dat je jak tooensure konzistence pomocí jednotlivé transakce.</span><span class="sxs-lookup"><span data-stu-id="4a470-342">hello other key factor that influences your choice of keys for optimizing data modifications is how tooensure consistency by using atomic transactions.</span></span> <span data-ttu-id="4a470-343">Toooperate EGT lze použít pouze u entit, které jsou uložené v hello stejného oddílu.</span><span class="sxs-lookup"><span data-stu-id="4a470-343">You can only use an EGT toooperate on entities stored in hello same partition.</span></span>  

<span data-ttu-id="4a470-344">tyto vzory v části hello Hello [vzory návrhu tabulky](#table-design-patterns) adresu Správa konzistence:</span><span class="sxs-lookup"><span data-stu-id="4a470-344">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address managing consistency:</span></span>  

* <span data-ttu-id="4a470-345">[Vzor sekundární index Intra-partition](#intra-partition-secondary-index-pattern) -uložit více kopií každou entitu s využitím různých **RowKey** hodnoty (v hello stejného oddílu) tooenable rychlé a efektivní vyhledávání a řazení alternativní řadí pomocí různé **RowKey** hodnoty.</span><span class="sxs-lookup"><span data-stu-id="4a470-345">[Intra-partition secondary index pattern](#intra-partition-secondary-index-pattern) - Store multiple copies of each entity using different **RowKey** values (in hello same partition) tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  
* <span data-ttu-id="4a470-346">[Vzor mezi oddíl sekundární index](#inter-partition-secondary-index-pattern) – ukládání více kopií každé entity pomocí různých hodnot RowKey v samostatné oddíly nebo v samostatných tabulkách tooenable rychlé a efektivní vyhledávání a řazení alternativní řadí pomocí různých **RowKey** hodnoty.</span><span class="sxs-lookup"><span data-stu-id="4a470-346">[Inter-partition secondary index pattern](#inter-partition-secondary-index-pattern) - Store multiple copies of each entity using different RowKey values in separate partitions or in separate tables tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  
* <span data-ttu-id="4a470-347">[Nakonec byl konzistentní transakce vzor](#eventually-consistent-transactions-pattern) -povolit nakonec byl konzistentní chování v rámci hranice oddílů nebo hranice systému úložiště pomocí front Azure.</span><span class="sxs-lookup"><span data-stu-id="4a470-347">[Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) - Enable eventually consistent behavior across partition boundaries or storage system boundaries by using Azure queues.</span></span>
* <span data-ttu-id="4a470-348">[Index entity vzor](#index-entities-pattern) -udržovat index entity tooenable efektivní vyhledávání, která vrátí seznam entit.</span><span class="sxs-lookup"><span data-stu-id="4a470-348">[Index Entities Pattern](#index-entities-pattern) - Maintain index entities tooenable efficient searches that return lists of entities.</span></span>  
* <span data-ttu-id="4a470-349">[Vzor denormalization](#denormalization-pattern) -zkombinujte související data společně v jedné entity tooenable tooretrieve všechny hello dat je třeba pomocí dotazu jediný bod.</span><span class="sxs-lookup"><span data-stu-id="4a470-349">[Denormalization pattern](#denormalization-pattern) - Combine related data together in a single entity tooenable you tooretrieve all hello data you need with a single point query.</span></span>  
* <span data-ttu-id="4a470-350">[Vzorek dat řady](#data-series-pattern) -úložiště dokončení datové řady za jedné entity toominimize hello počet požadavků, které provedete.</span><span class="sxs-lookup"><span data-stu-id="4a470-350">[Data series pattern](#data-series-pattern) - Store complete data series in a single entity toominimize hello number of requests you make.</span></span>  

<span data-ttu-id="4a470-351">Informace o transakcích skupiny entity, najdete v tématu hello [Entity skupiny transakce](#entity-group-transactions).</span><span class="sxs-lookup"><span data-stu-id="4a470-351">For information about entity group transactions, see hello section [Entity Group Transactions](#entity-group-transactions).</span></span>  

### <a name="ensuring-your-design-for-efficient-modifications-facilitates-efficient-queries"></a><span data-ttu-id="4a470-352">Zajištění návrhu pro efektivní úpravy usnadňuje efektivní dotazy</span><span class="sxs-lookup"><span data-stu-id="4a470-352">Ensuring your design for efficient modifications facilitates efficient queries</span></span>
<span data-ttu-id="4a470-353">V mnoha případech by měl návrhu pro efektivní dotazování výsledků v efektivní úpravy, ale vždy vyhodnocení, zda se jedná o případ hello pro konkrétní scénář.</span><span class="sxs-lookup"><span data-stu-id="4a470-353">In many cases, a design for efficient querying results in efficient modifications, but you should always evaluate whether this is hello case for your specific scenario.</span></span> <span data-ttu-id="4a470-354">Některé vzory hello v části hello [vzory návrhu tabulky](#table-design-patterns) explicitně vyhodnocení kompromis mezi dotazování a úprava entity a vždy byste měli vzít do účtu hello počty jednotlivých typů operace.</span><span class="sxs-lookup"><span data-stu-id="4a470-354">Some of hello patterns in hello section [Table Design Patterns](#table-design-patterns) explicitly evaluate trade-offs between querying and modifying entities, and you should always take into account hello number of each type of operation.</span></span>  

<span data-ttu-id="4a470-355">tyto vzory v části hello Hello [vzory návrhu tabulky](#table-design-patterns) adres kompromis mezi návrhu pro efektivní dotazy a návrhu pro úpravu efektivní dat:</span><span class="sxs-lookup"><span data-stu-id="4a470-355">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address trade-offs between designing for efficient queries and designing for efficient data modification:</span></span>  

* <span data-ttu-id="4a470-356">[Složené klíče vzor](#compound-key-pattern) -použití složené **RowKey** hodnoty tooenable klienta toolookup související data pomocí dotazu jediný bod.</span><span class="sxs-lookup"><span data-stu-id="4a470-356">[Compound key pattern](#compound-key-pattern) - Use compound **RowKey** values tooenable a client toolookup related data with a single point query.</span></span>  
* <span data-ttu-id="4a470-357">[Vzor protokolu poškozené databáze](#log-tail-pattern) -načtení hello * n * entity naposledy přidat oddíl tooa pomocí **RowKey** hodnotu, která seřadí zpětné datum a čas pořadí.</span><span class="sxs-lookup"><span data-stu-id="4a470-357">[Log tail pattern](#log-tail-pattern) - Retrieve hello *n* entities most recently added tooa partition by using a **RowKey** value that sorts in reverse date and time order.</span></span>  

## <a name="encrypting-table-data"></a><span data-ttu-id="4a470-358">Šifrování dat v tabulce</span><span class="sxs-lookup"><span data-stu-id="4a470-358">Encrypting Table Data</span></span>
<span data-ttu-id="4a470-359">Hello .NET Klientská knihovna pro úložiště Azure podporuje šifrování vlastnosti entity řetězce pro vložení a nahrazovat operace.</span><span class="sxs-lookup"><span data-stu-id="4a470-359">hello .NET Azure Storage Client Library supports encryption of string entity properties for insert and replace operations.</span></span> <span data-ttu-id="4a470-360">Hello šifrované řetězce jsou uložené ve službě hello jako binární vlastnosti a převedení back toostrings po dešifrování.</span><span class="sxs-lookup"><span data-stu-id="4a470-360">hello encrypted strings are stored on hello service as binary properties, and they are converted back toostrings after decryption.</span></span>    

<span data-ttu-id="4a470-361">Pro tabulky kromě toohello zásady šifrování, musí uživatelé zadat toobe vlastnosti hello zašifrovaná.</span><span class="sxs-lookup"><span data-stu-id="4a470-361">For tables, in addition toohello encryption policy, users must specify hello properties toobe encrypted.</span></span> <span data-ttu-id="4a470-362">To lze provést zadáním buď atribut [EncryptProperty] (pro entity objektů POCO, které jsou odvozeny od TableEntity) nebo šifrování překladač v žádosti o možnostech.</span><span class="sxs-lookup"><span data-stu-id="4a470-362">This can be done by either specifying an [EncryptProperty] attribute (for POCO entities that derive from TableEntity) or an encryption resolver in request options.</span></span> <span data-ttu-id="4a470-363">Překladač šifrování je delegáta, který přebírá klíč oddílu, klíč řádku a název vlastnosti a vrátí logickou hodnotu, která určuje, jestli by se šifrovat tuto vlastnost.</span><span class="sxs-lookup"><span data-stu-id="4a470-363">An encryption resolver is a delegate that takes a partition key, row key, and property name and returns a Boolean that indicates whether that property should be encrypted.</span></span> <span data-ttu-id="4a470-364">Během šifrování se použije hello klientské knihovny tato informace toodecide zda vlastnosti by se měla šifrovat během zápisu toohello přenosu.</span><span class="sxs-lookup"><span data-stu-id="4a470-364">During encryption, hello client library will use this information toodecide whether a property should be encrypted while writing toohello wire.</span></span> <span data-ttu-id="4a470-365">Delegát Hello také poskytuje možnost hello logiky kolem jak jsou zašifrované vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="4a470-365">hello delegate also provides for hello possibility of logic around how properties are encrypted.</span></span> <span data-ttu-id="4a470-366">(Například pokud X, potom šifrování vlastnost A; v opačném případě šifrování vlastnosti A a B.) Všimněte si, že IT oddělení není nutné tooprovide tyto informace při čtení nebo dotazování entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-366">(For example, if X, then encrypt property A; otherwise encrypt properties A and B.) Note that it is not necessary tooprovide this information while reading or querying entities.</span></span>

<span data-ttu-id="4a470-367">Všimněte si, že sloučení není aktuálně podporována.</span><span class="sxs-lookup"><span data-stu-id="4a470-367">Note that merge is not currently supported.</span></span> <span data-ttu-id="4a470-368">Vzhledem k tomu, že podmnožinu vlastností může být šifrována dříve pomocí jiného klíče, jednoduše slučování hello nové vlastnosti a aktualizace hello metadat dojde ke ztrátě dat.</span><span class="sxs-lookup"><span data-stu-id="4a470-368">Since a subset of properties may have been encrypted previously using a different key, simply merging hello new properties and updating hello metadata will result in data loss.</span></span> <span data-ttu-id="4a470-369">Slučování buď vyžaduje provedení další služby volání tooread hello existující entity ze služby hello nebo pomocí nového klíče na vlastnosti, které nejsou vhodné z důvodů výkonu.</span><span class="sxs-lookup"><span data-stu-id="4a470-369">Merging either requires making extra service calls tooread hello pre-existing entity from hello service, or using a new key per property, both of which are not suitable for performance reasons.</span></span>     

<span data-ttu-id="4a470-370">Informace o šifrování dat v tabulce najdete v tématu [šifrování na straně klienta a Azure Key Vault pro Microsoft Azure Storage](../storage/common/storage-client-side-encryption.md).</span><span class="sxs-lookup"><span data-stu-id="4a470-370">For information about encrypting table data, see [Client-Side Encryption and Azure Key Vault for Microsoft Azure Storage](../storage/common/storage-client-side-encryption.md).</span></span>  

## <a name="modelling-relationships"></a><span data-ttu-id="4a470-371">Modelování vztahů</span><span class="sxs-lookup"><span data-stu-id="4a470-371">Modelling relationships</span></span>
<span data-ttu-id="4a470-372">Vytváření modelů domény je klíče krok v návrhu hello složitých systémů.</span><span class="sxs-lookup"><span data-stu-id="4a470-372">Building domain models is a key step in hello design of complex systems.</span></span> <span data-ttu-id="4a470-373">Obvykle použijete hello modelování proces tooidentify entity a hello vztahy mezi nimi jako způsob toounderstand hello firmy domény a informujte hello návrh vašeho systému.</span><span class="sxs-lookup"><span data-stu-id="4a470-373">Typically, you use hello modelling process tooidentify entities and hello relationships between them as a way toounderstand hello business domain and inform hello design of your system.</span></span> <span data-ttu-id="4a470-374">Tato část se zaměřuje na tom, jak může překládat některé běžné typy vztahů hello najít v doméně toodesigns modely pro hello služby Table.</span><span class="sxs-lookup"><span data-stu-id="4a470-374">This section focuses on how you can translate some of hello common relationship types found in domain models toodesigns for hello Table service.</span></span> <span data-ttu-id="4a470-375">Hello proces mapování z logický datový model tooa fyzické NoSQL na základě datového modelu se příliš neliší od kterého při navrhování relační databáze.</span><span class="sxs-lookup"><span data-stu-id="4a470-375">hello process of mapping from a logical data-model tooa physical NoSQL based data-model is very different from that used when designing a relational database.</span></span> <span data-ttu-id="4a470-376">Návrh relační databáze obvykle předpokládá proces normalizace dat optimalizované pro minimalizaci redundance – a deklarativní dotazování funkci, která přehledů jak hello implementace fungování hello databáze.</span><span class="sxs-lookup"><span data-stu-id="4a470-376">Relational databases design typically assumes a data normalization process optimized for minimizing redundancy – and a declarative querying capability that abstracts how hello implementation of how hello database works.</span></span>  

### <a name="one-to-many-relationships"></a><span data-ttu-id="4a470-377">Vztahy jeden mnoho</span><span class="sxs-lookup"><span data-stu-id="4a470-377">One-to-many relationships</span></span>
<span data-ttu-id="4a470-378">Na více vztahů mezi objekty domény obchodní dojde k velmi často: například jeden oddělení má mnoho pracovníků.</span><span class="sxs-lookup"><span data-stu-id="4a470-378">One-to-many relationships between business domain objects occur very frequently: for example, one department has many employees.</span></span> <span data-ttu-id="4a470-379">V hello služby Table každý s výhody a nevýhody, které mohou být relevantní toohello konkrétní scénář je několik způsobů tooimplement na více relací.</span><span class="sxs-lookup"><span data-stu-id="4a470-379">There are several ways tooimplement one-to-many relationships in hello Table service each with pros and cons that may be relevant toohello particular scenario.</span></span>  

<span data-ttu-id="4a470-380">Podívejte se na příklad hello velké korporace více national s desítkami tisíc oddělení a zaměstnanci entity, kde každé oddělení má mnoho zaměstnance a zaměstnance, jak je přidružený jeden konkrétní oddělení.</span><span class="sxs-lookup"><span data-stu-id="4a470-380">Consider hello example of a large multi-national corporation with tens of thousands of departments and employee entities where every department has many employees and each employee as associated with one specific department.</span></span> <span data-ttu-id="4a470-381">Jeden z přístupů je toostore samostatné oddělení a zaměstnanci entitami, jako je například tyto:</span><span class="sxs-lookup"><span data-stu-id="4a470-381">One approach is toostore separate department and employee entities such as these:</span></span>  

![][1]

<span data-ttu-id="4a470-382">Tento příklad ukazuje implicitní vztah jeden mnoho mezi typy hello podle hello **PartitionKey** hodnotu.</span><span class="sxs-lookup"><span data-stu-id="4a470-382">This example shows an implicit one-to-many relationship between hello types based on hello **PartitionKey** value.</span></span> <span data-ttu-id="4a470-383">Každé oddělení může mít mnoho pracovníků.</span><span class="sxs-lookup"><span data-stu-id="4a470-383">Each department can have many employees.</span></span>  

<span data-ttu-id="4a470-384">Tento příklad také ukazuje entity oddělení a jeho souvisejících zaměstnanec entity v hello stejného oddílu.</span><span class="sxs-lookup"><span data-stu-id="4a470-384">This example also shows a department entity and its related employee entities in hello same partition.</span></span> <span data-ttu-id="4a470-385">Může zvolit toouse různých oddílů, tabulky nebo i účty úložiště pro typy hello různých entit.</span><span class="sxs-lookup"><span data-stu-id="4a470-385">You could choose toouse different partitions, tables, or even storage accounts for hello different entity types.</span></span>  

<span data-ttu-id="4a470-386">Alternativní způsob je toodenormalize pouze zaměstnanci entity s nenormalizované oddělení dat vaše data a úložiště, jak ukazuje následující příklad hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-386">An alternative approach is toodenormalize your data and store only employee entities with denormalized department data as shown in hello following example.</span></span> <span data-ttu-id="4a470-387">V tomto scénáři konkrétní tento nenormalizované přístup nemusí být hello nejlepší Pokud máte požadavek toobe možné toochange hello podrobnosti o oddělení manager, protože toodo to budete potřebovat tooupdate každý zaměstnanec hello oddělení.</span><span class="sxs-lookup"><span data-stu-id="4a470-387">In this particular scenario, this denormalized approach may not be hello best if you have a requirement toobe able toochange hello details of a department manager because toodo this you need tooupdate every employee in hello department.</span></span>  

![][2]

<span data-ttu-id="4a470-388">Další informace najdete v tématu hello [Denormalization vzor](#denormalization-pattern) dál v této příručce.</span><span class="sxs-lookup"><span data-stu-id="4a470-388">For more information, see hello [Denormalization pattern](#denormalization-pattern) later in this guide.</span></span>  

<span data-ttu-id="4a470-389">Hello následující tabulka shrnuje hello výhody a nevýhody jednotlivých uvedených výše pro ukládání zaměstnanců a oddělení entity, které mají vztah jeden mnoho přístupů hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-389">hello following table summarizes hello pros and cons of each of hello approaches outlined above for storing employee and department entities that have a one-to-many relationship.</span></span> <span data-ttu-id="4a470-390">Také byste měli zvážit, jak často předpokládáte tooperform, různé operace: to může být přijatelné toohave návrh, který zahrnuje náročná operace, pokud tuto operaci pouze dochází zřídka.</span><span class="sxs-lookup"><span data-stu-id="4a470-390">You should also consider how often you expect tooperform various operations: it may be acceptable toohave a design that includes an expensive operation if that operation only happens infrequently.</span></span>  

<table>
<tr>
<th><span data-ttu-id="4a470-391">Přístup</span><span class="sxs-lookup"><span data-stu-id="4a470-391">Approach</span></span></th>
<th><span data-ttu-id="4a470-392">Odborníci na</span><span class="sxs-lookup"><span data-stu-id="4a470-392">Pros</span></span></th>
<th><span data-ttu-id="4a470-393">Nevýhody</span><span class="sxs-lookup"><span data-stu-id="4a470-393">Cons</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="4a470-394">Jednotlivé typy entit, stejného oddílu, stejné tabulky</span><span class="sxs-lookup"><span data-stu-id="4a470-394">Separate entity types, same partition, same table</span></span></td>
<td>
<ul>
<li><span data-ttu-id="4a470-395">Entity oddělení můžete aktualizovat pomocí jedné operace.</span><span class="sxs-lookup"><span data-stu-id="4a470-395">You can update a department entity with a single operation.</span></span></li>
<li><span data-ttu-id="4a470-396">Pokud máte požadavek toomodify entity oddělení, můžete použít EGT toomaintain konzistence pokaždé, když jste aktualizace, insert nebo odstranění entity zaměstnanců.</span><span class="sxs-lookup"><span data-stu-id="4a470-396">You can use an EGT toomaintain consistency if you have a requirement toomodify a department entity whenever you update/insert/delete an employee entity.</span></span> <span data-ttu-id="4a470-397">Například pokud chcete zachovat počet zaměstnanců oddělení pro každé oddělení.</span><span class="sxs-lookup"><span data-stu-id="4a470-397">For example if you maintain a departmental employee count for each department.</span></span></li>
</ul>
</td>
<td>
<ul>
<li><span data-ttu-id="4a470-398">Může být nutné tooretrieve zaměstnanec i oddělení entity pro některé činnosti klienta.</span><span class="sxs-lookup"><span data-stu-id="4a470-398">You may need tooretrieve both an employee and a department entity for some client activities.</span></span></li>
<li><span data-ttu-id="4a470-399">Operace úložiště dojít v hello stejné oddílu.</span><span class="sxs-lookup"><span data-stu-id="4a470-399">Storage operations happen in hello same partition.</span></span> <span data-ttu-id="4a470-400">Na vysoké transakce svazky proto může docházet v aktivní oblast.</span><span class="sxs-lookup"><span data-stu-id="4a470-400">At high transaction volumes, this may result in a hotspot.</span></span></li>
<li><span data-ttu-id="4a470-401">Nelze přesunout zaměstnance tooa nové oddělení pomocí EGT.</span><span class="sxs-lookup"><span data-stu-id="4a470-401">You cannot move an employee tooa new department using an EGT.</span></span></li>
</ul>
</td>
</tr>
<tr>
<td><span data-ttu-id="4a470-402">Typy samostatné entity, různých oddílů nebo tabulek účty úložiště</span><span class="sxs-lookup"><span data-stu-id="4a470-402">Separate entity types, different partitions or tables or storage accounts</span></span></td>
<td>
<ul>
<li><span data-ttu-id="4a470-403">Oddělení entity nebo zaměstnanec entity můžete aktualizovat pomocí jedné operace.</span><span class="sxs-lookup"><span data-stu-id="4a470-403">You can update a department entity or employee entity with a single operation.</span></span></li>
<li><span data-ttu-id="4a470-404">Na vysoké transakce svazky, může to pomoci šíření hello zatížení mezi více oddílů.</span><span class="sxs-lookup"><span data-stu-id="4a470-404">At high transaction volumes, this may help spread hello load across more partitions.</span></span></li>
</ul>
</td>
<td>
<ul>
<li><span data-ttu-id="4a470-405">Může být nutné tooretrieve zaměstnanec i oddělení entity pro některé činnosti klienta.</span><span class="sxs-lookup"><span data-stu-id="4a470-405">You may need tooretrieve both an employee and a department entity for some client activities.</span></span></li>
<li><span data-ttu-id="4a470-406">Nelze použít EGTs toomaintain konzistence když jste update, insert nebo odstranění zaměstnanec a aktualizace oddělení.</span><span class="sxs-lookup"><span data-stu-id="4a470-406">You cannot use EGTs toomaintain consistency when you update/insert/delete an employee and update a department.</span></span> <span data-ttu-id="4a470-407">Aktualizuje se například počet zaměstnanců v oddělení entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-407">For example, updating an employee count in a department entity.</span></span></li>
<li><span data-ttu-id="4a470-408">Nelze přesunout zaměstnance tooa nové oddělení pomocí EGT.</span><span class="sxs-lookup"><span data-stu-id="4a470-408">You cannot move an employee tooa new department using an EGT.</span></span></li>
</ul>
</td>
</tr>
<tr>
<td><span data-ttu-id="4a470-409">Denormalize do jedné entity typu</span><span class="sxs-lookup"><span data-stu-id="4a470-409">Denormalize into single entity type</span></span></td>
<td>
<ul>
<li><span data-ttu-id="4a470-410">Můžete načíst všechny hello informace, které je nutné se jeden požadavek.</span><span class="sxs-lookup"><span data-stu-id="4a470-410">You can retrieve all hello information you need with a single request.</span></span></li>
</ul>
</td>
<td>
<ul>
<li><span data-ttu-id="4a470-411">Pokud potřebujete informace oddělení tooupdate (to by znamenalo jste tooupdate všichni zaměstnanci hello v oddělení) může být nákladné toomaintain konzistence.</span><span class="sxs-lookup"><span data-stu-id="4a470-411">It may be expensive toomaintain consistency if you need tooupdate department information (this would require you tooupdate all hello employees in a department).</span></span></li>
</ul>
</td>
</tr>
</table>

<span data-ttu-id="4a470-412">Jak zvolíte mezi tyto možnosti a které hello specialisté a cons jsou nejvýznamnější, závisí na konkrétní aplikaci scénářů.</span><span class="sxs-lookup"><span data-stu-id="4a470-412">How you choose between these options, and which of hello pros and cons are most significant, depends on your specific application scenarios.</span></span> <span data-ttu-id="4a470-413">Například jak často upravíte entities oddělení; mají všechny dotazy zaměstnanec hello další oddělení informace; jak jsou omezení škálovatelnosti toohello na oddíly nebo účtu úložiště?</span><span class="sxs-lookup"><span data-stu-id="4a470-413">For example, how often do you modify department entities; do all your employee queries need hello additional departmental information; how close are you toohello scalability limits on your partitions or your storage account?</span></span>  

### <a name="one-to-one-relationships"></a><span data-ttu-id="4a470-414">Relace 1: 1</span><span class="sxs-lookup"><span data-stu-id="4a470-414">One-to-one relationships</span></span>
<span data-ttu-id="4a470-415">Modely domény může zahrnovat relace 1: 1 mezi entitami.</span><span class="sxs-lookup"><span data-stu-id="4a470-415">Domain models may include one-to-one relationships between entities.</span></span> <span data-ttu-id="4a470-416">Pokud potřebujete tooimplement relace v hello služby Table, musíte také zvolit, jak toolink hello dvě související entity, pokud je potřebujete tooretrieve obě.</span><span class="sxs-lookup"><span data-stu-id="4a470-416">If you need tooimplement a one-to-one relationship in hello Table service, you must also choose how toolink hello two related entities when you need tooretrieve them both.</span></span> <span data-ttu-id="4a470-417">Tento odkaz může být implicitní, podle názvů v hodnoty klíče hello nebo explicitní uložením odkaz hello tvar **PartitionKey** a **RowKey** hodnot v jednotlivých entit tooits související entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-417">This link can be either implicit, based on a convention in hello key values, or explicit by storing a link in hello form of **PartitionKey** and **RowKey** values in each entity tooits related entity.</span></span> <span data-ttu-id="4a470-418">Informace o tom, zda by měl uložit hello související entity v hello stejného oddílu, najdete v tématu hello [na více vztahů](#one-to-many-relationships).</span><span class="sxs-lookup"><span data-stu-id="4a470-418">For a discussion of whether you should store hello related entities in hello same partition, see hello section [One-to-many relationships](#one-to-many-relationships).</span></span>  

<span data-ttu-id="4a470-419">Všimněte si, že existují také aspekty implementace, které můžou způsobit je relace 1: 1 tooimplement v služby Table hello:</span><span class="sxs-lookup"><span data-stu-id="4a470-419">Note that there are also implementation considerations that might lead you tooimplement one-to-one relationships in hello Table service:</span></span>  

* <span data-ttu-id="4a470-420">Zpracování velkých entit (Další informace najdete v tématu [velké vzor entity](#large-entities-pattern)).</span><span class="sxs-lookup"><span data-stu-id="4a470-420">Handling large entities (for more information, see [Large Entities Pattern](#large-entities-pattern)).</span></span>  
* <span data-ttu-id="4a470-421">Implementace řízení přístupu (Další informace najdete v tématu [řízení přístupu s podpisy sdíleného přístupu](#controlling-access-with-shared-access-signatures)).</span><span class="sxs-lookup"><span data-stu-id="4a470-421">Implementing access controls (for more information, see [Controlling access with Shared Access Signatures](#controlling-access-with-shared-access-signatures)).</span></span>  

### <a name="join-in-hello-client"></a><span data-ttu-id="4a470-422">Připojení v klientovi hello</span><span class="sxs-lookup"><span data-stu-id="4a470-422">Join in hello client</span></span>
<span data-ttu-id="4a470-423">I když existují způsoby toomodel vztahy v hello služby Table, by neměl zapomenete, zda jsou dva prvotní důvody pro používání služby Table hello hello škálovatelnost a výkon.</span><span class="sxs-lookup"><span data-stu-id="4a470-423">Although there are ways toomodel relationships in hello Table service, you should not forget that hello two prime reasons for using hello Table service are scalability and performance.</span></span> <span data-ttu-id="4a470-424">Pokud zjistíte, že jsou modelování více vztahů, které ohrožují hello výkon a škálovatelnost řešení, měli byste požádat sami že pokud je nutné toobuild všechny hello relace mezi daty do návrhu tabulky.</span><span class="sxs-lookup"><span data-stu-id="4a470-424">If you find you are modelling many relationships that compromise hello performance and scalability of your solution, you should ask yourself if it is necessary toobuild all hello data relationships into your table design.</span></span> <span data-ttu-id="4a470-425">Může být schopný toosimplify hello návrhu a zvýšit hello škálovatelnost a výkon vašeho řešení, pokud je necháte klientskou aplikaci, proveďte všechny nezbytné spojení.</span><span class="sxs-lookup"><span data-stu-id="4a470-425">You may be able toosimplify hello design and improve hello scalability and performance of your solution if you let your client application perform any necessary joins.</span></span>  

<span data-ttu-id="4a470-426">Například pokud máte malé tabulky, které obsahují data, která se nemění příliš často, pak můžete tato data načíst jednou a uložení do mezipaměti na klientovi hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-426">For example, if you have small tables that contain data that does not change very often, then you can retrieve this data once and cache it on hello client.</span></span> <span data-ttu-id="4a470-427">To se můžete vyhnout opakovaných zbytečné komunikace tooretrieve hello stejná data.</span><span class="sxs-lookup"><span data-stu-id="4a470-427">This can avoid repeated roundtrips tooretrieve hello same data.</span></span> <span data-ttu-id="4a470-428">V příkladech hello, které jsme jste prohlédli v této příručce hello sadu oddělení v organizaci, malé je pravděpodobně toobe malé a změňte zřídka díky tomu vhodným kandidátem na data, která klientská aplikace můžete stáhnout jednou a mezipaměti jako vyhledávání dat.</span><span class="sxs-lookup"><span data-stu-id="4a470-428">In hello examples we have looked at in this guide, hello set of departments in a small organization is likely toobe small and change infrequently making it a good candidate for data that client application can download once and cache as look up data.</span></span>  

### <a name="inheritance-relationships"></a><span data-ttu-id="4a470-429">Vztahy dědičnosti</span><span class="sxs-lookup"><span data-stu-id="4a470-429">Inheritance relationships</span></span>
<span data-ttu-id="4a470-430">Pokud klientské aplikace používá sadu tříd, které jsou součástí dědičnosti vztah toorepresent obchodní entity, můžete snadno zachovat tyto entity v hello služby Table.</span><span class="sxs-lookup"><span data-stu-id="4a470-430">If your client application uses a set of classes that form part of an inheritance relationship toorepresent business entities, you can easily persist those entities in hello Table service.</span></span> <span data-ttu-id="4a470-431">Například můžete mít následující sadu tříd definovaných v klientské aplikace hello kde **osoba** je abstraktní třída.</span><span class="sxs-lookup"><span data-stu-id="4a470-431">For example, you might have hello following set of classes defined in your client application where **Person** is an abstract class.</span></span>

![][3]

<span data-ttu-id="4a470-432">Můžete zachovat instancí dvě konkrétní třídy v hello služby Table pomocí jedné tabulky osoba pomocí entity v tomto vypadají hello:</span><span class="sxs-lookup"><span data-stu-id="4a470-432">You can persist instances of hello two concrete classes in hello Table service using a single Person table using entities in that look like this:</span></span>  

![][4]

<span data-ttu-id="4a470-433">Další informace o práci s více typy entit v hello stejné tabulky v kódu klienta najdete v tématu hello [práce s typy entit heterogenní](#working-with-heterogeneous-entity-types) dál v této příručce.</span><span class="sxs-lookup"><span data-stu-id="4a470-433">For more information about working with multiple entity types in hello same table in client code, see hello section [Working with heterogeneous entity types](#working-with-heterogeneous-entity-types) later in this guide.</span></span> <span data-ttu-id="4a470-434">To obsahuje příklady jak toorecognize hello typ entity v kódu klienta.</span><span class="sxs-lookup"><span data-stu-id="4a470-434">This provides examples of how toorecognize hello entity type in client code.</span></span>  

## <a name="table-design-patterns"></a><span data-ttu-id="4a470-435">Vzory návrhu tabulky</span><span class="sxs-lookup"><span data-stu-id="4a470-435">Table Design Patterns</span></span>
<span data-ttu-id="4a470-436">V předchozích částech jste viděli některé podrobné diskusí o tom, jak toooptimize tabulku pro obě načítání dat entity pomocí dotazů a návrhu pro vložení, aktualizaci a odstraňování dat entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-436">In previous sections, you have seen some detailed discussions about how toooptimize your table design for both retrieving entity data using queries and for inserting, updating, and deleting entity data.</span></span> <span data-ttu-id="4a470-437">Tato část popisuje některé vzory vhodné používat s řešeními služby Table.</span><span class="sxs-lookup"><span data-stu-id="4a470-437">This section describes some patterns appropriate for use with Table service solutions.</span></span> <span data-ttu-id="4a470-438">Kromě toho se zobrazí, může prakticky adresování některé problémy hello a kompromis vyvolá dříve v této příručce.</span><span class="sxs-lookup"><span data-stu-id="4a470-438">In addition, you will see how you can practically address some of hello issues and trade-offs raised previously in this guide.</span></span> <span data-ttu-id="4a470-439">Hello následující diagram shrnuje hello vztahy mezi hello různé vzorce:</span><span class="sxs-lookup"><span data-stu-id="4a470-439">hello following diagram summarizes hello relationships between hello different patterns:</span></span>  

![][5]

<span data-ttu-id="4a470-440">Mapa vzor Hello výše označuje některé vztahy mezi vzory (modré) a proti vzory (oranžová), které jsou popsané v této příručce.</span><span class="sxs-lookup"><span data-stu-id="4a470-440">hello pattern map above highlights some relationships between patterns (blue) and anti-patterns (orange) that are documented in this guide.</span></span> <span data-ttu-id="4a470-441">Mnoho dalších vzorech, které jsou vhodné vzhledem k tomu, samozřejmě neexistují.</span><span class="sxs-lookup"><span data-stu-id="4a470-441">There are of course many other patterns that are worth considering.</span></span> <span data-ttu-id="4a470-442">Například jeden z hello klíčové scénáře pro služby Table je toouse hello [Materializována vzor zobrazení](https://msdn.microsoft.com/library/azure/dn589782.aspx) z hello [příkaz dotazu odpovědnost oddělení (CQRS)](https://msdn.microsoft.com/library/azure/jj554200.aspx) vzor.</span><span class="sxs-lookup"><span data-stu-id="4a470-442">For example, one of hello key scenarios for Table Service is toouse hello [Materialized View Pattern](https://msdn.microsoft.com/library/azure/dn589782.aspx) from hello [Command Query Responsibility Segregation (CQRS)](https://msdn.microsoft.com/library/azure/jj554200.aspx) pattern.</span></span>  

### <a name="intra-partition-secondary-index-pattern"></a><span data-ttu-id="4a470-443">Vzor Intra-partition sekundární index</span><span class="sxs-lookup"><span data-stu-id="4a470-443">Intra-partition secondary index pattern</span></span>
<span data-ttu-id="4a470-444">Uložit více kopií každou entitu s využitím různých **RowKey** hodnoty (v hello stejného oddílu) tooenable rychlé a efektivní vyhledávání a řazení alternativní řadí pomocí různých **RowKey** hodnoty.</span><span class="sxs-lookup"><span data-stu-id="4a470-444">Store multiple copies of each entity using different **RowKey** values (in hello same partition) tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span> <span data-ttu-id="4a470-445">Aktualizace mezi kopie je možné mít konzistentní pomocí EGT společnosti.</span><span class="sxs-lookup"><span data-stu-id="4a470-445">Updates between copies can be kept consistent using EGT's.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="4a470-446">Kontext a problém</span><span class="sxs-lookup"><span data-stu-id="4a470-446">Context and problem</span></span>
<span data-ttu-id="4a470-447">Hello služby Table automaticky indexuje entity pomocí hello **PartitionKey** a **RowKey** hodnoty.</span><span class="sxs-lookup"><span data-stu-id="4a470-447">hello Table service automatically indexes entities using hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="4a470-448">To umožňuje klienta aplikace tooretrieve entity efektivně pomocí těchto hodnot.</span><span class="sxs-lookup"><span data-stu-id="4a470-448">This enables a client application tooretrieve an entity efficiently using these values.</span></span> <span data-ttu-id="4a470-449">Například struktura tabulky hello vidíte níže, klientská aplikace pomocí tooretrieve dotaz bod entitu jednotlivých zaměstnanců pomocí názvu hello oddělení a identifikační číslo zaměstnance hello (hello **PartitionKey** a ** RowKey** hodnoty).</span><span class="sxs-lookup"><span data-stu-id="4a470-449">For example, using hello table structure shown below, a client application can use a point query tooretrieve an individual employee entity by using hello department name and hello employee id (hello **PartitionKey** and **RowKey** values).</span></span> <span data-ttu-id="4a470-450">Klienta můžete také načíst entity seřazené podle id zaměstnance v rámci každé oddělení.</span><span class="sxs-lookup"><span data-stu-id="4a470-450">A client can also retrieve entities sorted by employee id within each department.</span></span>

![][6]

<span data-ttu-id="4a470-451">Pokud chcete mít toofind toobe entitu zaměstnanců na základě hodnoty hello další vlastnosti, jako je například e-mailovou adresu, musíte použít méně efektivní prohledávání toofind oddílu shody.</span><span class="sxs-lookup"><span data-stu-id="4a470-451">If you also want toobe able toofind an employee entity based on hello value of another property, such as email address, you must use a less efficient partition scan toofind a match.</span></span> <span data-ttu-id="4a470-452">Je to proto, že služby table hello neposkytuje sekundární indexy.</span><span class="sxs-lookup"><span data-stu-id="4a470-452">This is because hello table service does not provide secondary indexes.</span></span> <span data-ttu-id="4a470-453">Kromě toho není žádná možnost toorequest seznam seřazen v jiném pořadí než zaměstnanců **RowKey** pořadí.</span><span class="sxs-lookup"><span data-stu-id="4a470-453">In addition, there is no option toorequest a list of employees sorted in a different order than **RowKey** order.</span></span>  

#### <a name="solution"></a><span data-ttu-id="4a470-454">Řešení</span><span class="sxs-lookup"><span data-stu-id="4a470-454">Solution</span></span>
<span data-ttu-id="4a470-455">toowork kolem hello nedostatečná sekundární indexy, můžete uložit více kopií každé entity s každou kopii pomocí jiné **RowKey** hodnotu.</span><span class="sxs-lookup"><span data-stu-id="4a470-455">toowork around hello lack of secondary indexes, you can store multiple copies of each entity with each copy using a different **RowKey** value.</span></span> <span data-ttu-id="4a470-456">Pokud ukládáte entitu s hello struktury vidíte níže, můžete efektivně načíst zaměstnanec entit na základě id e-mailovou adresu nebo zaměstnanců. Hello předpon pro hello **RowKey**, "empid_" a "email_" umožňují tooquery pro jeden zaměstnanců nebo rozsah zaměstnanci pomocí řadu e-mailové adresy nebo ID zaměstnance.</span><span class="sxs-lookup"><span data-stu-id="4a470-456">If you store an entity with hello structures shown below, you can efficiently retrieve employee entities based on email address or employee id. hello prefix values for hello **RowKey**, "empid_" and "email_" enable you tooquery for a single employee or a range of employees by using a range of email addresses or employee ids.</span></span>  

![][7]

<span data-ttu-id="4a470-457">Hello následující dvě kritéria filtru (jeden vyhledávání podle id zaměstnance a jeden vyhledávání pomocí e-mailové adresy) i zadejte bod dotazy:</span><span class="sxs-lookup"><span data-stu-id="4a470-457">hello following two filter criteria (one looking up by employee id and one looking up by email address) both specify point queries:</span></span>  

* <span data-ttu-id="4a470-458">$filter = (PartitionKey eq 'Prodej') a (RowKey eq 'empid_000223')</span><span class="sxs-lookup"><span data-stu-id="4a470-458">$filter=(PartitionKey eq 'Sales') and (RowKey eq 'empid_000223')</span></span>  
* <span data-ttu-id="4a470-459">$filter = (PartitionKey eq 'Prodej') a (RowKey eq 'email_jonesj@contoso.com')</span><span class="sxs-lookup"><span data-stu-id="4a470-459">$filter=(PartitionKey eq 'Sales') and (RowKey eq 'email_jonesj@contoso.com')</span></span>  

<span data-ttu-id="4a470-460">Pokud vyhledat rozsahu entit zaměstnanců, můžete zadat rozsah id řazení zaměstnanců nebo rozsahu seřazeny v e-mailovou adresu pořadí pomocí dotazu pro entity s příslušnou předponu hello hello **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="4a470-460">If you query for a range of employee entities, you can specify a range sorted in employee id order, or a range sorted in email address order by querying for entities with hello appropriate prefix in hello **RowKey**.</span></span>  

* <span data-ttu-id="4a470-461">použít všechny zaměstnance hello v oddělení prodeje hello se do rozsahu 000100 too000199 hello identifikační číslo zaměstnance toofind: $filter = (PartitionKey eq 'Prodej') a (RowKey ge 'empid_000100') a (RowKey le 'empid_000199')</span><span class="sxs-lookup"><span data-stu-id="4a470-461">toofind all hello employees in hello Sales department with an employee id in hello range 000100 too000199 use: $filter=(PartitionKey eq 'Sales') and (RowKey ge 'empid_000100') and (RowKey le 'empid_000199')</span></span>  
* <span data-ttu-id="4a470-462">toofind všechny zaměstnance v oddělení prodeje hello hello s e-mailovou adresu, počínaje hello písmeno "a" použití: $filter = (PartitionKey eq 'Prodej') a (RowKey ge 'email_a') a (RowKey lt 'email_b')</span><span class="sxs-lookup"><span data-stu-id="4a470-462">toofind all hello employees in hello Sales department with an email address starting with hello letter 'a' use: $filter=(PartitionKey eq 'Sales') and (RowKey ge 'email_a') and (RowKey lt 'email_b')</span></span>  
  
  <span data-ttu-id="4a470-463">Upozorňujeme, že se syntaxí filtru hello použít ve výše uvedených příkladech hello se ze služby Table hello rozhraní REST API, další informace najdete v tématu [dotazu entity](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span><span class="sxs-lookup"><span data-stu-id="4a470-463">Note that hello filter syntax used in hello examples above is from hello Table service REST API, for more information see [Query Entities](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="4a470-464">Problémy a důležité informace</span><span class="sxs-lookup"><span data-stu-id="4a470-464">Issues and considerations</span></span>
<span data-ttu-id="4a470-465">Vezměte v úvahu hello následující body při rozhodování o tom, jak tooimplement tento vzor:</span><span class="sxs-lookup"><span data-stu-id="4a470-465">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="4a470-466">Table storage je relativně levný toouse, takže hello náklady režijní náklady na ukládání dat duplicitní by nemělo být závažný problém.</span><span class="sxs-lookup"><span data-stu-id="4a470-466">Table storage is relatively cheap toouse so hello cost overhead of storing duplicate data should not be a major concern.</span></span> <span data-ttu-id="4a470-467">Však měli vždy vyhodnoceny hello náklady návrhu na základě požadavků vaší předpokládaného úložiště a přidat pouze duplicitní položky toosupport hello dotazy, které budou spuštěny klientské aplikace.</span><span class="sxs-lookup"><span data-stu-id="4a470-467">However, you should always evaluate hello cost of your design based on your anticipated storage requirements and only add duplicate entities toosupport hello queries your client application will execute.</span></span>  
* <span data-ttu-id="4a470-468">Proto hello sekundární index entity jsou uložené v hello stejné jako původní entity hello oddílu, musíte ověřit nepřekračují hello cíle škálovatelnosti pro jednotlivé oddíl.</span><span class="sxs-lookup"><span data-stu-id="4a470-468">Because hello secondary index entities are stored in hello same partition as hello original entities, you should ensure that you do not exceed hello scalability targets for an individual partition.</span></span>  
* <span data-ttu-id="4a470-469">Vzájemnou konzistenci duplicitní položky můžete ponechat atomicky pomocí EGTs tooupdate hello dvě kopie hello entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-469">You can keep your duplicate entities consistent with each other by using EGTs tooupdate hello two copies of hello entity atomically.</span></span> <span data-ttu-id="4a470-470">To znamená, že měli uložit všechny kopie entity v hello stejného oddílu.</span><span class="sxs-lookup"><span data-stu-id="4a470-470">This implies that you should store all copies of an entity in hello same partition.</span></span> <span data-ttu-id="4a470-471">Další informace najdete v tématu hello [pomocí transakce skupiny Entity](#entity-group-transactions).</span><span class="sxs-lookup"><span data-stu-id="4a470-471">For more information, see hello section [Using Entity Group Transactions](#entity-group-transactions).</span></span>  
* <span data-ttu-id="4a470-472">Hello hodnota používaná pro hello **RowKey** musí být jedinečný pro každé entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-472">hello value used for hello **RowKey** must be unique for each entity.</span></span> <span data-ttu-id="4a470-473">Zvažte použití hodnoty složeného klíče.</span><span class="sxs-lookup"><span data-stu-id="4a470-473">Consider using compound key values.</span></span>  
* <span data-ttu-id="4a470-474">Odsazení číselných hodnot v hello **RowKey** (například id zaměstnance hello 000223), umožňuje opravte řazení a filtrování na základě horní a dolní meze.</span><span class="sxs-lookup"><span data-stu-id="4a470-474">Padding numeric values in hello **RowKey** (for example, hello employee id 000223), enables correct sorting and filtering based on upper and lower bounds.</span></span>  
* <span data-ttu-id="4a470-475">Není nutné nutně tooduplicate všechny hello vlastnosti vaší entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-475">You do not necessarily need tooduplicate all hello properties of your entity.</span></span> <span data-ttu-id="4a470-476">Například pokud hello dotazy, které e-mailu pomocí hello vyhledávací hello entity, které se adresu v hello **RowKey** nikdy nepotřebují stáří hello zaměstnance, tyto entit může mít hello strukturu:</span><span class="sxs-lookup"><span data-stu-id="4a470-476">For example, if hello queries that lookup hello entities using hello email address in hello **RowKey** never need hello employee's age, these entities could have hello following structure:</span></span>

![][8]

* <span data-ttu-id="4a470-477">Je obvykle lepší toostore duplicitních dat a zkontrolujte, zda lze načíst všechna data hello, které je nutné se jeden dotaz, než jeden dotaz toolocate toouse entity a jiné toolookup hello požadovaná data.</span><span class="sxs-lookup"><span data-stu-id="4a470-477">It is typically better toostore duplicate data and ensure that you can retrieve all hello data you need with a single query, than toouse one query toolocate an entity and another toolookup hello required data.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="4a470-478">Když toouse tento vzor</span><span class="sxs-lookup"><span data-stu-id="4a470-478">When toouse this pattern</span></span>
<span data-ttu-id="4a470-479">Tento vzor použijte, když klientské aplikace potřebuje tooretrieve entity pomocí různých odlišné klíče, když klient potřebuje tooretrieve entity v jiné pořadí řazení, a tam, kde můžete identifikovat každé entity pomocí různých jedinečné hodnoty.</span><span class="sxs-lookup"><span data-stu-id="4a470-479">Use this pattern when your client application needs tooretrieve entities using a variety of different keys, when your client needs tooretrieve entities in different sort orders, and where you can identify each entity using a variety of unique values.</span></span> <span data-ttu-id="4a470-480">Nicméně byste měli jistotu, že nedošlo k překročení omezení škálovatelnosti oddílu hello při provádění entity vyhledávání pomocí různých hello **RowKey** hodnoty.</span><span class="sxs-lookup"><span data-stu-id="4a470-480">However, you should be sure that you do not exceed hello partition scalability limits when you are performing entity lookups using hello different **RowKey** values.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="4a470-481">Související vzory a pokyny</span><span class="sxs-lookup"><span data-stu-id="4a470-481">Related patterns and guidance</span></span>
<span data-ttu-id="4a470-482">Hello následující vzory a pokyny může být také důležité při implementaci tohoto vzoru:</span><span class="sxs-lookup"><span data-stu-id="4a470-482">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="4a470-483">Vzor sekundární index mezi oddílů</span><span class="sxs-lookup"><span data-stu-id="4a470-483">Inter-partition secondary index pattern</span></span>](#inter-partition-secondary-index-pattern)
* [<span data-ttu-id="4a470-484">Složené klíče vzor</span><span class="sxs-lookup"><span data-stu-id="4a470-484">Compound key pattern</span></span>](#compound-key-pattern)
* [<span data-ttu-id="4a470-485">Transakce skupiny entity</span><span class="sxs-lookup"><span data-stu-id="4a470-485">Entity Group Transactions</span></span>](#entity-group-transactions)
* [<span data-ttu-id="4a470-486">Práce s typy heterogenní entit</span><span class="sxs-lookup"><span data-stu-id="4a470-486">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)

### <a name="inter-partition-secondary-index-pattern"></a><span data-ttu-id="4a470-487">Vzor sekundární index mezi oddílů</span><span class="sxs-lookup"><span data-stu-id="4a470-487">Inter-partition secondary index pattern</span></span>
<span data-ttu-id="4a470-488">Uložit více kopií každou entitu s využitím různých **RowKey** hodnoty v samostatné oddíly nebo v samostatných tabulkách tooenable rychlé a efektivní vyhledávání a alternativní pořadí řazení pomocí různých **RowKey**hodnoty.</span><span class="sxs-lookup"><span data-stu-id="4a470-488">Store multiple copies of each entity using different **RowKey** values in separate partitions or in separate tables tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="4a470-489">Kontext a problém</span><span class="sxs-lookup"><span data-stu-id="4a470-489">Context and problem</span></span>
<span data-ttu-id="4a470-490">Hello služby Table automaticky indexuje entity pomocí hello **PartitionKey** a **RowKey** hodnoty.</span><span class="sxs-lookup"><span data-stu-id="4a470-490">hello Table service automatically indexes entities using hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="4a470-491">To umožňuje klienta aplikace tooretrieve entity efektivně pomocí těchto hodnot.</span><span class="sxs-lookup"><span data-stu-id="4a470-491">This enables a client application tooretrieve an entity efficiently using these values.</span></span> <span data-ttu-id="4a470-492">Například struktura tabulky hello vidíte níže, klientská aplikace pomocí tooretrieve dotaz bod entitu jednotlivých zaměstnanců pomocí názvu hello oddělení a identifikační číslo zaměstnance hello (hello **PartitionKey** a ** RowKey** hodnoty).</span><span class="sxs-lookup"><span data-stu-id="4a470-492">For example, using hello table structure shown below, a client application can use a point query tooretrieve an individual employee entity by using hello department name and hello employee id (hello **PartitionKey** and **RowKey** values).</span></span> <span data-ttu-id="4a470-493">Klienta můžete také načíst entity seřazené podle id zaměstnance v rámci každé oddělení.</span><span class="sxs-lookup"><span data-stu-id="4a470-493">A client can also retrieve entities sorted by employee id within each department.</span></span>  

![][9]

<span data-ttu-id="4a470-494">Pokud chcete mít toofind toobe entitu zaměstnanců na základě hodnoty hello další vlastnosti, jako je například e-mailovou adresu, musíte použít méně efektivní prohledávání toofind oddílu shody.</span><span class="sxs-lookup"><span data-stu-id="4a470-494">If you also want toobe able toofind an employee entity based on hello value of another property, such as email address, you must use a less efficient partition scan toofind a match.</span></span> <span data-ttu-id="4a470-495">Je to proto, že služby table hello neposkytuje sekundární indexy.</span><span class="sxs-lookup"><span data-stu-id="4a470-495">This is because hello table service does not provide secondary indexes.</span></span> <span data-ttu-id="4a470-496">Kromě toho není žádná možnost toorequest seznam seřazen v jiném pořadí než zaměstnanců **RowKey** pořadí.</span><span class="sxs-lookup"><span data-stu-id="4a470-496">In addition, there is no option toorequest a list of employees sorted in a different order than **RowKey** order.</span></span>  

<span data-ttu-id="4a470-497">Jsou očekávání velmi velký objem transakcí proti tyto entity a chcete toominimize hello riziko hello omezení vašeho klienta služby Table.</span><span class="sxs-lookup"><span data-stu-id="4a470-497">You are anticipating a very high volume of transactions against these entities and want toominimize hello risk of hello Table service throttling your client.</span></span>  

#### <a name="solution"></a><span data-ttu-id="4a470-498">Řešení</span><span class="sxs-lookup"><span data-stu-id="4a470-498">Solution</span></span>
<span data-ttu-id="4a470-499">toowork kolem hello nedostatečná sekundární indexy, můžete uložit více kopií každé entity s každou kopírování pomocí různých **PartitionKey** a **RowKey** hodnoty.</span><span class="sxs-lookup"><span data-stu-id="4a470-499">toowork around hello lack of secondary indexes, you can store multiple copies of each entity with each copy using different **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="4a470-500">Pokud ukládáte entitu s hello struktury vidíte níže, můžete efektivně načíst zaměstnanec entit na základě id e-mailovou adresu nebo zaměstnanců. Hello předpon pro hello **PartitionKey**, "empid_" a "email_" umožňují tooidentify, kterého jste indexu má toouse pro dotaz.</span><span class="sxs-lookup"><span data-stu-id="4a470-500">If you store an entity with hello structures shown below, you can efficiently retrieve employee entities based on email address or employee id. hello prefix values for hello **PartitionKey**, "empid_" and "email_" enable you tooidentify which index you want toouse for a query.</span></span>  

![][10]

<span data-ttu-id="4a470-501">Hello následující dvě kritéria filtru (jeden vyhledávání podle id zaměstnance a jeden vyhledávání pomocí e-mailové adresy) i zadejte bod dotazy:</span><span class="sxs-lookup"><span data-stu-id="4a470-501">hello following two filter criteria (one looking up by employee id and one looking up by email address) both specify point queries:</span></span>  

* <span data-ttu-id="4a470-502">$filter = (PartitionKey eq ' empid_Sales') a (RowKey eq '000223')</span><span class="sxs-lookup"><span data-stu-id="4a470-502">$filter=(PartitionKey eq 'empid_Sales') and (RowKey eq '000223')</span></span>
* <span data-ttu-id="4a470-503">$filter = (PartitionKey eq ' email_Sales') a (RowKey eq 'jonesj@contoso.com')</span><span class="sxs-lookup"><span data-stu-id="4a470-503">$filter=(PartitionKey eq 'email_Sales') and (RowKey eq 'jonesj@contoso.com')</span></span>  

<span data-ttu-id="4a470-504">Pokud vyhledat rozsahu entit zaměstnanců, můžete zadat rozsah id řazení zaměstnanců nebo rozsahu seřazeny v e-mailovou adresu pořadí pomocí dotazu pro entity s příslušnou předponu hello hello **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="4a470-504">If you query for a range of employee entities, you can specify a range sorted in employee id order, or a range sorted in email address order by querying for entities with hello appropriate prefix in hello **RowKey**.</span></span>  

* <span data-ttu-id="4a470-505">toofind všechny zaměstnance v hello hello oddělení prodeje s id zaměstnance v rozsahu hello **000100** příliš**000199** seřazeny ve zaměstnanec id pořadí použití: $filter = (PartitionKey eq ' empid_Sales') a (RowKey ge. 000100') a (RowKey le '000199')</span><span class="sxs-lookup"><span data-stu-id="4a470-505">toofind all hello employees in hello Sales department with an employee id in hello range **000100** too**000199** sorted in employee id order use: $filter=(PartitionKey eq 'empid_Sales') and (RowKey ge '000100') and (RowKey le '000199')</span></span>  
* <span data-ttu-id="4a470-506">toofind všechny zaměstnance hello oddělení prodeje hello s e-mailovou adresu, který začíná slovem "a" seřazených podle e-mailová adresa pořadí použití: $filter = (PartitionKey eq ' email_Sales') a (RowKey ge "a") a (RowKey lt "b")</span><span class="sxs-lookup"><span data-stu-id="4a470-506">toofind all hello employees in hello Sales department with an email address that starts with 'a' sorted in email address order use: $filter=(PartitionKey eq 'email_Sales') and (RowKey ge 'a') and (RowKey lt 'b')</span></span>  

<span data-ttu-id="4a470-507">Upozorňujeme, že se syntaxí filtru hello použít ve výše uvedených příkladech hello se ze služby Table hello rozhraní REST API, další informace najdete v tématu [dotazu entity](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span><span class="sxs-lookup"><span data-stu-id="4a470-507">Note that hello filter syntax used in hello examples above is from hello Table service REST API, for more information see [Query Entities](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="4a470-508">Problémy a důležité informace</span><span class="sxs-lookup"><span data-stu-id="4a470-508">Issues and considerations</span></span>
<span data-ttu-id="4a470-509">Vezměte v úvahu hello následující body při rozhodování o tom, jak tooimplement tento vzor:</span><span class="sxs-lookup"><span data-stu-id="4a470-509">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="4a470-510">Abyste zajistili, že duplicitní položky nakonec byl konzistentní se navzájem pomocí hello [nakonec byl konzistentní transakce vzor](#eventually-consistent-transactions-pattern) toomaintain hello primární a sekundární index entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-510">You can keep your duplicate entities eventually consistent with each other by using hello [Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) toomaintain hello primary and secondary index entities.</span></span>  
* <span data-ttu-id="4a470-511">Table storage je relativně levný toouse, takže hello náklady režijní náklady na ukládání dat duplicitní by nemělo být závažný problém.</span><span class="sxs-lookup"><span data-stu-id="4a470-511">Table storage is relatively cheap toouse so hello cost overhead of storing duplicate data should not be a major concern.</span></span> <span data-ttu-id="4a470-512">Však měli vždy vyhodnoceny hello náklady návrhu na základě požadavků vaší předpokládaného úložiště a přidat pouze duplicitní položky toosupport hello dotazy, které budou spuštěny klientské aplikace.</span><span class="sxs-lookup"><span data-stu-id="4a470-512">However, you should always evaluate hello cost of your design based on your anticipated storage requirements and only add duplicate entities toosupport hello queries your client application will execute.</span></span>  
* <span data-ttu-id="4a470-513">Hello hodnota používaná pro hello **RowKey** musí být jedinečný pro každé entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-513">hello value used for hello **RowKey** must be unique for each entity.</span></span> <span data-ttu-id="4a470-514">Zvažte použití hodnoty složeného klíče.</span><span class="sxs-lookup"><span data-stu-id="4a470-514">Consider using compound key values.</span></span>  
* <span data-ttu-id="4a470-515">Odsazení číselných hodnot v hello **RowKey** (například id zaměstnance hello 000223), umožňuje opravte řazení a filtrování na základě horní a dolní meze.</span><span class="sxs-lookup"><span data-stu-id="4a470-515">Padding numeric values in hello **RowKey** (for example, hello employee id 000223), enables correct sorting and filtering based on upper and lower bounds.</span></span>  
* <span data-ttu-id="4a470-516">Není nutné nutně tooduplicate všechny hello vlastnosti vaší entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-516">You do not necessarily need tooduplicate all hello properties of your entity.</span></span> <span data-ttu-id="4a470-517">Například pokud hello dotazy, které e-mailu pomocí hello vyhledávací hello entity, které se adresu v hello **RowKey** nikdy nepotřebují stáří hello zaměstnance, tyto entit může mít hello strukturu:</span><span class="sxs-lookup"><span data-stu-id="4a470-517">For example, if hello queries that lookup hello entities using hello email address in hello **RowKey** never need hello employee's age, these entities could have hello following structure:</span></span>
  
  ![][11]
* <span data-ttu-id="4a470-518">Je obvykle lepší toostore duplicitních dat a ujistěte se, že můžete načíst všechna data hello, které je nutné se jeden dotaz než toolocate jeden dotaz toouse entitu s využitím hello sekundární index a jiné toolookup hello požadovaná data v primární index hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-518">It is typically better toostore duplicate data and ensure that you can retrieve all hello data you need with a single query than toouse one query toolocate an entity using hello secondary index and another toolookup hello required data in hello primary index.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="4a470-519">Když toouse tento vzor</span><span class="sxs-lookup"><span data-stu-id="4a470-519">When toouse this pattern</span></span>
<span data-ttu-id="4a470-520">Tento vzor použijte, když klientské aplikace potřebuje tooretrieve entity pomocí různých odlišné klíče, když klient potřebuje tooretrieve entity v jiné pořadí řazení, a tam, kde můžete identifikovat každé entity pomocí různých jedinečné hodnoty.</span><span class="sxs-lookup"><span data-stu-id="4a470-520">Use this pattern when your client application needs tooretrieve entities using a variety of different keys, when your client needs tooretrieve entities in different sort orders, and where you can identify each entity using a variety of unique values.</span></span> <span data-ttu-id="4a470-521">Pomocí tohoto vzoru můžete tooavoid překročení omezení škálovatelnosti oddílu hello při provádění entity vyhledávání pomocí různých hello **RowKey** hodnoty.</span><span class="sxs-lookup"><span data-stu-id="4a470-521">Use this pattern when you want tooavoid exceeding hello partition scalability limits when you are performing entity lookups using hello different **RowKey** values.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="4a470-522">Související vzory a pokyny</span><span class="sxs-lookup"><span data-stu-id="4a470-522">Related patterns and guidance</span></span>
<span data-ttu-id="4a470-523">Hello následující vzory a pokyny může být také důležité při implementaci tohoto vzoru:</span><span class="sxs-lookup"><span data-stu-id="4a470-523">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="4a470-524">Nakonec byl konzistentní transakce vzor</span><span class="sxs-lookup"><span data-stu-id="4a470-524">Eventually consistent transactions pattern</span></span>](#eventually-consistent-transactions-pattern)  
* [<span data-ttu-id="4a470-525">Vzor Intra-partition sekundární index</span><span class="sxs-lookup"><span data-stu-id="4a470-525">Intra-partition secondary index pattern</span></span>](#intra-partition-secondary-index-pattern)  
* [<span data-ttu-id="4a470-526">Složené klíče vzor</span><span class="sxs-lookup"><span data-stu-id="4a470-526">Compound key pattern</span></span>](#compound-key-pattern)  
* [<span data-ttu-id="4a470-527">Transakce skupiny entity</span><span class="sxs-lookup"><span data-stu-id="4a470-527">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="4a470-528">Práce s typy heterogenní entit</span><span class="sxs-lookup"><span data-stu-id="4a470-528">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)  

### <a name="eventually-consistent-transactions-pattern"></a><span data-ttu-id="4a470-529">Nakonec byl konzistentní transakce vzor</span><span class="sxs-lookup"><span data-stu-id="4a470-529">Eventually consistent transactions pattern</span></span>
<span data-ttu-id="4a470-530">Povolte nakonec byl konzistentní chování mezi hranice oddílů nebo hranice systému úložiště pomocí front Azure.</span><span class="sxs-lookup"><span data-stu-id="4a470-530">Enable eventually consistent behavior across partition boundaries or storage system boundaries by using Azure queues.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="4a470-531">Kontext a problém</span><span class="sxs-lookup"><span data-stu-id="4a470-531">Context and problem</span></span>
<span data-ttu-id="4a470-532">EGTs povolit jednotlivé transakce v rámci více entit, které sdílejí hello stejným klíčem oddílu.</span><span class="sxs-lookup"><span data-stu-id="4a470-532">EGTs enable atomic transactions across multiple entities that share hello same partition key.</span></span> <span data-ttu-id="4a470-533">Pro výkon a škálovatelnost, můžete se rozhodnout toostore entit, které mají požadavky konzistence v samostatné oddíly nebo v samostatné úložiště systému: v takové situaci nelze použít EGTs toomaintain konzistence.</span><span class="sxs-lookup"><span data-stu-id="4a470-533">For performance and scalability reasons, you might decide toostore entities that have consistency requirements in separate partitions or in a separate storage system: in such a scenario, you cannot use EGTs toomaintain consistency.</span></span> <span data-ttu-id="4a470-534">Například můžete mít požadavek toomaintain konzistence typu případné mezi:</span><span class="sxs-lookup"><span data-stu-id="4a470-534">For example, you might have a requirement toomaintain eventual consistency between:</span></span>  

* <span data-ttu-id="4a470-535">Entity, které jsou uloženy ve dvou různých oddílů v hello stejné tabulky, v různých tabulek ve v jiným účtům úložiště.</span><span class="sxs-lookup"><span data-stu-id="4a470-535">Entities stored in two different partitions in hello same table, in different tables, in in different storage accounts.</span></span>  
* <span data-ttu-id="4a470-536">Entity ukládají v hello služby Table a objekt blob do hello služby objektů Blob.</span><span class="sxs-lookup"><span data-stu-id="4a470-536">An entity stored in hello Table service and a blob stored in hello Blob service.</span></span>  
* <span data-ttu-id="4a470-537">Entity ukládají do služby Table hello a soubor v systému souborů.</span><span class="sxs-lookup"><span data-stu-id="4a470-537">An entity stored in hello Table service and a file in a file system.</span></span>  
* <span data-ttu-id="4a470-538">Entity uložit hello služby Table ještě indexovat pomocí služby Azure Search hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-538">An entity store in hello Table service yet indexed using hello Azure Search service.</span></span>  

#### <a name="solution"></a><span data-ttu-id="4a470-539">Řešení</span><span class="sxs-lookup"><span data-stu-id="4a470-539">Solution</span></span>
<span data-ttu-id="4a470-540">Pomocí fronty Azure můžete implementovat řešení, které nabízí konzistence typu případné mezi dva nebo více oddílů nebo úložných systémů.</span><span class="sxs-lookup"><span data-stu-id="4a470-540">By using Azure queues, you can implement a solution that delivers eventual consistency across two or more partitions or storage systems.</span></span>
<span data-ttu-id="4a470-541">tooillustrate to postupovat, předpokládá, že máte požadavek toobe možné tooarchive starší zaměstnanec entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-541">tooillustrate this approach, assume you have a requirement toobe able tooarchive old employee entities.</span></span> <span data-ttu-id="4a470-542">Starší zaměstnanec entity jsou zřídka dotaz a mají být vyloučeny z všechny aktivity, které pracují s aktuální zaměstnanci.</span><span class="sxs-lookup"><span data-stu-id="4a470-542">Old employee entities are rarely queried and should be excluded from any activities that deal with current employees.</span></span> <span data-ttu-id="4a470-543">tooimplement tento požadavek ukládáte aktivní zaměstnance v hello **aktuální** tabulky a původní zaměstnance v hello **archivu** tabulky.</span><span class="sxs-lookup"><span data-stu-id="4a470-543">tooimplement this requirement you store active employees in hello **Current** table and old employees in hello **Archive** table.</span></span> <span data-ttu-id="4a470-544">Archivace zaměstnanec vyžaduje toodelete hello entita z hello **aktuální** tabulky a přidejte hello entity toohello **archivu** tabulky, ale nemůžete použít tooperform EGT těchto dvou operací.</span><span class="sxs-lookup"><span data-stu-id="4a470-544">Archiving an employee requires you toodelete hello entity from hello **Current** table and add hello entity toohello **Archive** table, but you cannot use an EGT tooperform these two operations.</span></span> <span data-ttu-id="4a470-545">tooavoid hello riziko, že selhání způsobí, že tooappear entity v obou nebo žádná z tabulek, hello archivu operace musí být nakonec byl konzistentní.</span><span class="sxs-lookup"><span data-stu-id="4a470-545">tooavoid hello risk that a failure causes an entity tooappear in both or neither tables, hello archive operation must be eventually consistent.</span></span> <span data-ttu-id="4a470-546">Hello následující pořadí diagram popisuje hello kroky v této operaci.</span><span class="sxs-lookup"><span data-stu-id="4a470-546">hello following sequence diagram outlines hello steps in this operation.</span></span> <span data-ttu-id="4a470-547">Podrobněji se poskytuje pro cesty výjimka v následující text hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-547">More detail is provided for exception paths in hello text following.</span></span>  

![][12]

<span data-ttu-id="4a470-548">Klient zahájí operaci archivu hello umístěním zprávu na fronty Azure, v tohoto příkladu tooarchive zaměstnance #456.</span><span class="sxs-lookup"><span data-stu-id="4a470-548">A client initiates hello archive operation by placing a message on an Azure queue, in this example tooarchive employee #456.</span></span> <span data-ttu-id="4a470-549">Role pracovního procesu dotazuje hello fronty pro nové zprávy; v případě, že některou najde, čte uvítací zprávu a zanechá skrytá kopie ve frontě hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-549">A worker role polls hello queue for new messages; when it finds one, it reads hello message and leaves a hidden copy on hello queue.</span></span> <span data-ttu-id="4a470-550">role pracovního procesu Hello vedle načte kopii hello entity z hello **aktuální** tabulky, vloží kopii hello **archivu** tabulky a potom hello odstraní původní z hello **aktuální**tabulky.</span><span class="sxs-lookup"><span data-stu-id="4a470-550">hello worker role next fetches a copy of hello entity from hello **Current** table, inserts a copy in hello **Archive** table, and then deletes hello original from hello **Current** table.</span></span> <span data-ttu-id="4a470-551">Nakonec pokud nedošlo k chybám z předchozích kroků hello, role pracovního procesu hello odstraní hello skryté zprávy z fronty hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-551">Finally, if there were no errors from hello previous steps, hello worker role deletes hello hidden message from hello queue.</span></span>  

<span data-ttu-id="4a470-552">Krok 4 v tomto příkladu vloží hello zaměstnanec do hello **archivu** tabulky.</span><span class="sxs-lookup"><span data-stu-id="4a470-552">In this example, step 4 inserts hello employee into hello **Archive** table.</span></span> <span data-ttu-id="4a470-553">V systému souborů se může přidat hello zaměstnanec tooa objektů blob v hello služby objektů Blob nebo soubor.</span><span class="sxs-lookup"><span data-stu-id="4a470-553">It could add hello employee tooa blob in hello Blob service or a file in a file system.</span></span>  

#### <a name="recovering-from-failures"></a><span data-ttu-id="4a470-554">Zotavení z chyb</span><span class="sxs-lookup"><span data-stu-id="4a470-554">Recovering from failures</span></span>
<span data-ttu-id="4a470-555">Je důležité, hello operace v krocích **4** a **5** musí být *idempotent* v případě, že role pracovního procesu hello musí toorestart hello archivu operaci.</span><span class="sxs-lookup"><span data-stu-id="4a470-555">It is important that hello operations in steps **4** and **5** must be *idempotent* in case hello worker role needs toorestart hello archive operation.</span></span> <span data-ttu-id="4a470-556">Pokud používáte služby Table hello, pro krok **4** byste měli používat operace "vložení nebo nahrazení"; pro krok **5** byste měli používat "odstranit, pokud existuje" operace v hello klientské knihovny, kterou používáte.</span><span class="sxs-lookup"><span data-stu-id="4a470-556">If you are using hello Table service, for step **4** you should use an "insert or replace" operation; for step **5** you should use a "delete if exists" operation in hello client library you are using.</span></span> <span data-ttu-id="4a470-557">Pokud používáte jiné úložiště systému, musíte použít příslušné idempotent operace.</span><span class="sxs-lookup"><span data-stu-id="4a470-557">If you are using another storage system, you must use an appropriate idempotent operation.</span></span>  

<span data-ttu-id="4a470-558">Pokud role pracovního procesu hello nedokončí krok **6**, pak po na hello fronty se znovu zobrazí zprávu hello časový limit připravené pro tooreprocess tootry role pracovního procesu hello ho.</span><span class="sxs-lookup"><span data-stu-id="4a470-558">If hello worker role never completes step **6**, then after a timeout hello message reappears on hello queue ready for hello worker role tootry tooreprocess it.</span></span> <span data-ttu-id="4a470-559">role pracovního procesu Hello můžete zkontrolovat, kolikrát byl načten zprávu ve frontě hello a v případě potřeby příznak je zprávu "poškozených" pro zkoumání odesláním tooa oddělit fronty.</span><span class="sxs-lookup"><span data-stu-id="4a470-559">hello worker role can check how many times a message on hello queue has been read and, if necessary, flag it is a "poison" message for investigation by sending it tooa separate queue.</span></span> <span data-ttu-id="4a470-560">Další informace o čtení fronty zpráv a kontrolou hello dequeue – počet najdete v tématu [získat zprávy](https://msdn.microsoft.com/library/azure/dd179474.aspx).</span><span class="sxs-lookup"><span data-stu-id="4a470-560">For more information about reading queue messages and checking hello dequeue count, see [Get Messages](https://msdn.microsoft.com/library/azure/dd179474.aspx).</span></span>  

<span data-ttu-id="4a470-561">Některé chyby ze služby Table a Queue hello jsou přechodné chyby a klientské aplikace by měla obsahovat toohandle logiku vhodný opakovat je.</span><span class="sxs-lookup"><span data-stu-id="4a470-561">Some errors from hello Table and Queue services are transient errors, and your client application should include suitable retry logic toohandle them.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="4a470-562">Problémy a důležité informace</span><span class="sxs-lookup"><span data-stu-id="4a470-562">Issues and considerations</span></span>
<span data-ttu-id="4a470-563">Vezměte v úvahu hello následující body při rozhodování o tom, jak tooimplement tento vzor:</span><span class="sxs-lookup"><span data-stu-id="4a470-563">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="4a470-564">Toto řešení neposkytuje pro izolace transakce.</span><span class="sxs-lookup"><span data-stu-id="4a470-564">This solution does not provide for transaction isolation.</span></span> <span data-ttu-id="4a470-565">Například klienta může číst hello **aktuální** a **archivu** tabulky při role pracovního procesu hello mezi kroky **4** a **5**a najdete v části nekonzistentní zobrazení dat hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-565">For example, a client could read hello **Current** and **Archive** tables when hello worker role was between steps **4** and **5**, and see an inconsistent view of hello data.</span></span> <span data-ttu-id="4a470-566">Všimněte si, že hello data budou konzistentní nakonec.</span><span class="sxs-lookup"><span data-stu-id="4a470-566">Note that hello data will be consistent eventually.</span></span>  
* <span data-ttu-id="4a470-567">Je nutné zajistit, že kroky 4 a 5 jsou idempotent v konzistence typu případné tooensure pořadí.</span><span class="sxs-lookup"><span data-stu-id="4a470-567">You must be sure that steps 4 and 5 are idempotent in order tooensure eventual consistency.</span></span>  
* <span data-ttu-id="4a470-568">Je možné škálovat hello řešení pomocí více front a instance rolí pracovního procesu.</span><span class="sxs-lookup"><span data-stu-id="4a470-568">You can scale hello solution by using multiple queues and worker role instances.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="4a470-569">Když toouse tento vzor</span><span class="sxs-lookup"><span data-stu-id="4a470-569">When toouse this pattern</span></span>
<span data-ttu-id="4a470-570">Tento vzor použijte, pokud chcete, aby konzistence typu případné tooguarantee mezi entitami, které existují v různých oddílů nebo tabulky.</span><span class="sxs-lookup"><span data-stu-id="4a470-570">Use this pattern when you want tooguarantee eventual consistency between entities that exist in different partitions or tables.</span></span> <span data-ttu-id="4a470-571">Tento vzor tooensure konzistence typu případné pro operace můžete rozšířit na služby Table hello a hello služby objektů Blob a další zdroje dat Azure Storage jako systém souborů databáze nebo hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-571">You can extend this pattern tooensure eventual consistency for operations across hello Table service and hello Blob service and other non-Azure Storage data sources such as database or hello file system.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="4a470-572">Související vzory a pokyny</span><span class="sxs-lookup"><span data-stu-id="4a470-572">Related patterns and guidance</span></span>
<span data-ttu-id="4a470-573">Hello následující vzory a pokyny může být také důležité při implementaci tohoto vzoru:</span><span class="sxs-lookup"><span data-stu-id="4a470-573">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="4a470-574">Transakce skupiny entity</span><span class="sxs-lookup"><span data-stu-id="4a470-574">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="4a470-575">Sloučení nebo nahradit</span><span class="sxs-lookup"><span data-stu-id="4a470-575">Merge or replace</span></span>](#merge-or-replace)  

> [!NOTE]
> <span data-ttu-id="4a470-576">Pokud izolace transakce je důležité tooyour řešení, měli byste zvážit přepracování vaší tooenable tabulky můžete toouse EGTs.</span><span class="sxs-lookup"><span data-stu-id="4a470-576">If transaction isolation is important tooyour solution, you should consider redesigning your tables tooenable you toouse EGTs.</span></span>  
> 
> 

### <a name="index-entities-pattern"></a><span data-ttu-id="4a470-577">Vzor entity indexu</span><span class="sxs-lookup"><span data-stu-id="4a470-577">Index Entities Pattern</span></span>
<span data-ttu-id="4a470-578">Udržujte index entity tooenable efektivní vyhledávání, která vrátí seznam entit.</span><span class="sxs-lookup"><span data-stu-id="4a470-578">Maintain index entities tooenable efficient searches that return lists of entities.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="4a470-579">Kontext a problém</span><span class="sxs-lookup"><span data-stu-id="4a470-579">Context and problem</span></span>
<span data-ttu-id="4a470-580">Hello služby Table automaticky indexuje entity pomocí hello **PartitionKey** a **RowKey** hodnoty.</span><span class="sxs-lookup"><span data-stu-id="4a470-580">hello Table service automatically indexes entities using hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="4a470-581">To umožňuje klienta aplikace tooretrieve entity efektivní použití bodu dotazu.</span><span class="sxs-lookup"><span data-stu-id="4a470-581">This enables a client application tooretrieve an entity efficiently using a point query.</span></span> <span data-ttu-id="4a470-582">Například pomocí struktura tabulky hello vidíte níže, klientská aplikace můžete efektivně načíst entity jednotlivých zaměstnanců pomocí hello oddělení název a id zaměstnance hello (hello **PartitionKey** a **RowKey **).</span><span class="sxs-lookup"><span data-stu-id="4a470-582">For example, using hello table structure shown below, a client application can efficiently retrieve an individual employee entity by using hello department name and hello employee id (hello **PartitionKey** and **RowKey**).</span></span>  

![][13]

<span data-ttu-id="4a470-583">Pokud chcete mít tooretrieve toobe seznam zaměstnanec entit na základě hello hodnoty jiný jedinečný vlastnosti, například jejich poslední název, musíte použít méně efektivní oddíl kontroly shody toofind než pomocí toolook indexu je až přímo.</span><span class="sxs-lookup"><span data-stu-id="4a470-583">If you also want toobe able tooretrieve a list of employee entities based on hello value of another non-unique property, such as their last name, you must use a less efficient partition scan toofind matches rather than using an index toolook them up directly.</span></span> <span data-ttu-id="4a470-584">Je to proto, že služby table hello neposkytuje sekundární indexy.</span><span class="sxs-lookup"><span data-stu-id="4a470-584">This is because hello table service does not provide secondary indexes.</span></span>  

#### <a name="solution"></a><span data-ttu-id="4a470-585">Řešení</span><span class="sxs-lookup"><span data-stu-id="4a470-585">Solution</span></span>
<span data-ttu-id="4a470-586">tooenable vyhledávání podle příjmení s struktura entity hello uvedené výše, musíte udržovat seznam ID zaměstnance.</span><span class="sxs-lookup"><span data-stu-id="4a470-586">tooenable lookup by last name with hello entity structure shown above, you must maintain lists of employee ids.</span></span> <span data-ttu-id="4a470-587">Pokud tooretrieve hello zaměstnanec entity s konkrétním poslední názvem, jako je například Petr, musíte nejprve vyhledat hello seznam ID zaměstnance pro zaměstnance s Petr jako své příjmení a následně načíst tyto entity zaměstnanců.</span><span class="sxs-lookup"><span data-stu-id="4a470-587">If you want tooretrieve hello employee entities with a particular last name, such as Jones, you must first locate hello list of employee ids for employees with Jones as their last name, and then retrieve those employee entities.</span></span> <span data-ttu-id="4a470-588">Existují tři hlavní možnosti pro ukládání hello seznam ID zaměstnanců:</span><span class="sxs-lookup"><span data-stu-id="4a470-588">There are three main options for storing hello lists of employee ids:</span></span>  

* <span data-ttu-id="4a470-589">Používání úložiště blob.</span><span class="sxs-lookup"><span data-stu-id="4a470-589">Use blob storage.</span></span>  
* <span data-ttu-id="4a470-590">Vytvořte index entity v hello stejné oddílu jako hello zaměstnanec entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-590">Create index entities in hello same partition as hello employee entities.</span></span>  
* <span data-ttu-id="4a470-591">Vytvořte index entity v samostatném oddílu nebo tabulky.</span><span class="sxs-lookup"><span data-stu-id="4a470-591">Create index entities in a separate partition or table.</span></span>  

<span data-ttu-id="4a470-592"><u>Možnost #1: Použití objektu blob storage</u></span><span class="sxs-lookup"><span data-stu-id="4a470-592"><u>Option #1: Use blob storage</u></span></span>  

<span data-ttu-id="4a470-593">Pro první možnost hello vytvoříte objekt blob pro každý jedinečný příjmení a na každý objekt blob úložiště seznam hello **PartitionKey** (oddělení) a **RowKey** hodnoty (zaměstnanec id) pro zaměstnance, které mají to poslední Jméno.</span><span class="sxs-lookup"><span data-stu-id="4a470-593">For hello first option, you create a blob for every unique last name, and in each blob store a list of hello **PartitionKey** (department) and **RowKey** (employee id) values for employees that have that last name.</span></span> <span data-ttu-id="4a470-594">Při přidání nebo odstranění zaměstnanec měli byste zajistit, že je hello obsahu objektu blob relevantní hello nakonec byl konzistentní se hello zaměstnanec entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-594">When you add or delete an employee you should ensure that hello content of hello relevant blob is eventually consistent with hello employee entities.</span></span>  

<span data-ttu-id="4a470-595"><u>Možnost #2:</u> vytvořit index entity v hello stejného oddílu</span><span class="sxs-lookup"><span data-stu-id="4a470-595"><u>Option #2:</u> Create index entities in hello same partition</span></span>  

<span data-ttu-id="4a470-596">Druhá možnost hello použijte index entity, které ukládají hello následující data:</span><span class="sxs-lookup"><span data-stu-id="4a470-596">For hello second option, use index entities that store hello following data:</span></span>  

![][14]

<span data-ttu-id="4a470-597">Hello **EmployeeIDs** vlastnost obsahuje seznam identifikátorů zaměstnanec pro zaměstnance s příjmení hello uložené v hello **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="4a470-597">hello **EmployeeIDs** property contains a list of employee ids for employees with hello last name stored in hello **RowKey**.</span></span>  

<span data-ttu-id="4a470-598">Hello následující kroky popisují proces hello, které byste měli postupovat při přidávání nového zaměstnance Pokud používáte druhá možnost hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-598">hello following steps outline hello process you should follow when you are adding a new employee if you are using hello second option.</span></span> <span data-ttu-id="4a470-599">V tomto příkladu přidáváme zaměstnance s Id 000152 a příjmení Petr v oddělení prodeje hello:</span><span class="sxs-lookup"><span data-stu-id="4a470-599">In this example, we are adding an employee with Id 000152 and a last name Jones in hello Sales department:</span></span>  

1. <span data-ttu-id="4a470-600">Načtení entity hello index s **PartitionKey** hodnotu "Prodej" a hello **RowKey** hodnotu "Petr."</span><span class="sxs-lookup"><span data-stu-id="4a470-600">Retrieve hello index entity with a **PartitionKey** value "Sales" and hello **RowKey** value "Jones."</span></span> <span data-ttu-id="4a470-601">Uložte hello ETag toouse této entity v kroku 2.</span><span class="sxs-lookup"><span data-stu-id="4a470-601">Save hello ETag of this entity toouse in step 2.</span></span>  
2. <span data-ttu-id="4a470-602">Vytvoření skupiny transakci entity (tedy dávkovou operaci), která vloží novou entitu zaměstnanec hello (**PartitionKey** hodnotu "Prodej" a **RowKey** hodnotu "000152"), a aktualizace hello index entity (** PartitionKey** hodnotu "Prodej" a **RowKey** hodnotu "Petr") přidáním hello nové zaměstnance id toohello seznamu v poli EmployeeIDs hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-602">Create an entity group transaction (that is, a batch operation) that inserts hello new employee entity (**PartitionKey** value "Sales" and **RowKey** value "000152"), and updates hello index entity (**PartitionKey** value "Sales" and **RowKey** value "Jones") by adding hello new employee id toohello list in hello EmployeeIDs field.</span></span> <span data-ttu-id="4a470-603">Další informace o transakcích skupiny entity najdete v tématu [Entity skupiny transakce](#entity-group-transactions).</span><span class="sxs-lookup"><span data-stu-id="4a470-603">For more information about entity group transactions, see [Entity Group Transactions](#entity-group-transactions).</span></span>  
3. <span data-ttu-id="4a470-604">Pokud se transakce skupiny entity hello nezdaří z důvodu chyby optimistickou metodu souběžného (někdo jiný právě změnil hello index entity), budete potřebovat toostart přes v kroku 1 znovu.</span><span class="sxs-lookup"><span data-stu-id="4a470-604">If hello entity group transaction fails because of an optimistic concurrency error (someone else has just modified hello index entity), then you need toostart over at step 1 again.</span></span>  

<span data-ttu-id="4a470-605">Podobné toodeleting přístup zaměstnanec můžete použít, pokud používáte hello druhou možnost.</span><span class="sxs-lookup"><span data-stu-id="4a470-605">You can use a similar approach toodeleting an employee if you are using hello second option.</span></span> <span data-ttu-id="4a470-606">Změna příjmení zaměstnance je trochu složitější, protože budete potřebovat tooexecute transakci skupiny entity, která aktualizuje tři entity: hello zaměstnanec entita, hello index entity pro hello staré příjmení a hello index entity pro nové příjmení hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-606">Changing an employee's last name is slightly more complex because you will need tooexecute an entity group transaction that updates three entities: hello employee entity, hello index entity for hello old last name, and hello index entity for hello new last name.</span></span> <span data-ttu-id="4a470-607">Před provedením jakýchkoli změn v pořadí tooretrieve hello ETag hodnoty, které pak můžete tooperform hello aktualizací pomocí optimistickou metodu souběžného musí získat každé entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-607">You must retrieve each entity before making any changes in order tooretrieve hello ETag values that you can then use tooperform hello updates using optimistic concurrency.</span></span>  

<span data-ttu-id="4a470-608">Hello následující kroky popisují proces hello, které byste měli postupovat, když potřebujete toolook až všichni zaměstnanci hello s danou příjmení v oddělení, pokud používáte hello druhou možnost.</span><span class="sxs-lookup"><span data-stu-id="4a470-608">hello following steps outline hello process you should follow when you need toolook up all hello employees with a given last name in a department if you are using hello second option.</span></span> <span data-ttu-id="4a470-609">V tomto příkladu jsme se vyhledá všechny zaměstnance hello se příjmení Petr v oddělení prodeje hello:</span><span class="sxs-lookup"><span data-stu-id="4a470-609">In this example, we are looking up all hello employees with last name Jones in hello Sales department:</span></span>  

1. <span data-ttu-id="4a470-610">Načtení entity hello index s **PartitionKey** hodnotu "Prodej" a hello **RowKey** hodnotu "Petr."</span><span class="sxs-lookup"><span data-stu-id="4a470-610">Retrieve hello index entity with a **PartitionKey** value "Sales" and hello **RowKey** value "Jones."</span></span>  
2. <span data-ttu-id="4a470-611">Analyzovat hello seznam ID v poli EmployeeIDs hello zaměstnanců.</span><span class="sxs-lookup"><span data-stu-id="4a470-611">Parse hello list of employee Ids in hello EmployeeIDs field.</span></span>  
3. <span data-ttu-id="4a470-612">Pokud potřebujete další informace o jednotlivých tito zaměstnanci (například jejich e-mailové adresy), načtení jednotlivých entit zaměstnanec hello pomocí **PartitionKey** hodnotu "Prodej" a **RowKey** hodnoty z Hello seznam zaměstnanců, které jste získali v kroku 2.</span><span class="sxs-lookup"><span data-stu-id="4a470-612">If you need additional information about each of these employees (such as their email addresses), retrieve each of hello employee entities using **PartitionKey** value "Sales" and **RowKey** values from hello list of employees you obtained in step 2.</span></span>  

<span data-ttu-id="4a470-613"><u>Možnost #3:</u> vytvořte index entity v samostatném oddílu nebo tabulky</span><span class="sxs-lookup"><span data-stu-id="4a470-613"><u>Option #3:</u> Create index entities in a separate partition or table</span></span>  

<span data-ttu-id="4a470-614">Třetí možnost hello použijte index entity, které ukládají hello následující data:</span><span class="sxs-lookup"><span data-stu-id="4a470-614">For hello third option, use index entities that store hello following data:</span></span>  

![][15]

<span data-ttu-id="4a470-615">Hello **EmployeeIDs** vlastnost obsahuje seznam identifikátorů zaměstnanec pro zaměstnance s příjmení hello uložené v hello **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="4a470-615">hello **EmployeeIDs** property contains a list of employee ids for employees with hello last name stored in hello **RowKey**.</span></span>  

<span data-ttu-id="4a470-616">Třetí možnost hello nemůžete použít EGTs toomaintain konzistence, protože hello index entity jsou v samostatném oddílu z hello zaměstnanec entit.</span><span class="sxs-lookup"><span data-stu-id="4a470-616">With hello third option, you cannot use EGTs toomaintain consistency because hello index entities are in a separate partition from hello employee entities.</span></span> <span data-ttu-id="4a470-617">Se ujistěte, že hello index entity jsou nakonec byl konzistentní se hello zaměstnanec entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-617">You should ensure that hello index entities are eventually consistent with hello employee entities.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="4a470-618">Problémy a důležité informace</span><span class="sxs-lookup"><span data-stu-id="4a470-618">Issues and considerations</span></span>
<span data-ttu-id="4a470-619">Vezměte v úvahu hello následující body při rozhodování o tom, jak tooimplement tento vzor:</span><span class="sxs-lookup"><span data-stu-id="4a470-619">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="4a470-620">Toto řešení vyžaduje alespoň dva dotazy tooretrieve odpovídající entity: jeden tooquery hello index entity tooobtain hello seznam **RowKey** hodnoty a následně dotazuje tooretrieve každé entity v seznamu hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-620">This solution requires at least two queries tooretrieve matching entities: one tooquery hello index entities tooobtain hello list of **RowKey** values, and then queries tooretrieve each entity in hello list.</span></span>  
* <span data-ttu-id="4a470-621">Oznámeno, že jednotlivé entity má maximální velikost 1 MB, možnost #2 a možnost #3 v hello řešení předpokládá, že hello seznam ID zaměstnance pro danou příjmení se nikdy větší než 1 MB.</span><span class="sxs-lookup"><span data-stu-id="4a470-621">Given that an individual entity has a maximum size of 1 MB, option #2 and option #3 in hello solution assume that hello list of employee ids for any given last name is never greater than 1 MB.</span></span> <span data-ttu-id="4a470-622">Pokud hello seznam ID zaměstnance je pravděpodobně toobe větší než velikost 1 MB, použijte možnost #1 a ukládat data indexu hello v úložišti objektů blob.</span><span class="sxs-lookup"><span data-stu-id="4a470-622">If hello list of employee ids is likely toobe greater than 1 MB in size, use option #1 and store hello index data in blob storage.</span></span>  
* <span data-ttu-id="4a470-623">Pokud použijete možnost #2 (s použitím EGTs toohandle přidávání a odstraňování zaměstnanci a změna zaměstnance příjmení), musíte zjistit Pokud hello objem transakcí bude postupovat hello omezení škálovatelnosti v daném oddílu.</span><span class="sxs-lookup"><span data-stu-id="4a470-623">If you use option #2 (using EGTs toohandle adding and deleting employees, and changing an employee's last name) you must evaluate if hello volume of transactions will approach hello scalability limits in a given partition.</span></span> <span data-ttu-id="4a470-624">Pokud se jedná o případ hello, měli byste zvážit nakonec byl konzistentní řešení (možnost #1 nebo #3), které používá fronty toohandle hello aktualizace požadavky a umožňuje vám toostore vaše index entity v samostatném oddílu z hello zaměstnanec entit.</span><span class="sxs-lookup"><span data-stu-id="4a470-624">If this is hello case, you should consider an eventually consistent solution (option #1 or option #3) that uses queues toohandle hello update requests and enables you toostore your index entities in a separate partition from hello employee entities.</span></span>  
* <span data-ttu-id="4a470-625">Možnost #2 v tomto řešení se předpokládá, má toolook nahoru podle příjmení v rámci oddělení: například chcete tooretrieve seznam zaměstnancům příjmení Petr v oddělení prodeje hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-625">Option #2 in this solution assumes that you want toolook up by last name within a department: for example, you want tooretrieve a list of employees with a last name Jones in hello Sales department.</span></span> <span data-ttu-id="4a470-626">Pokud chcete mít toolook toobe až všechny zaměstnance hello se příjmení Petr napříč celou organizaci hello, použijte možnost #1 nebo možnost #3.</span><span class="sxs-lookup"><span data-stu-id="4a470-626">If you want toobe able toolook up all hello employees with a last name Jones across hello whole organization, use either option #1 or option #3.</span></span>
* <span data-ttu-id="4a470-627">Můžete implementovat řešení na základě fronty, který doručí konzistence typu případné (viz hello [nakonec byl konzistentní transakce vzor](#eventually-consistent-transactions-pattern) podrobnosti).</span><span class="sxs-lookup"><span data-stu-id="4a470-627">You can implement a queue-based solution that delivers eventual consistency (see hello [Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) for more details).</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="4a470-628">Když toouse tento vzor</span><span class="sxs-lookup"><span data-stu-id="4a470-628">When toouse this pattern</span></span>
<span data-ttu-id="4a470-629">Tento vzor použijte, pokud chcete, aby toolookup sady entit, že všechny společné hodnotu vlastnosti, například všechny zaměstnance se hello příjmení Petr sdílet.</span><span class="sxs-lookup"><span data-stu-id="4a470-629">Use this pattern when you want toolookup a set of entities that all share a common property value, such as all employees with hello last name Jones.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="4a470-630">Související vzory a pokyny</span><span class="sxs-lookup"><span data-stu-id="4a470-630">Related patterns and guidance</span></span>
<span data-ttu-id="4a470-631">Hello následující vzory a pokyny může být také důležité při implementaci tohoto vzoru:</span><span class="sxs-lookup"><span data-stu-id="4a470-631">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="4a470-632">Složené klíče vzor</span><span class="sxs-lookup"><span data-stu-id="4a470-632">Compound key pattern</span></span>](#compound-key-pattern)  
* [<span data-ttu-id="4a470-633">Nakonec byl konzistentní transakce vzor</span><span class="sxs-lookup"><span data-stu-id="4a470-633">Eventually consistent transactions pattern</span></span>](#eventually-consistent-transactions-pattern)  
* [<span data-ttu-id="4a470-634">Transakce skupiny entity</span><span class="sxs-lookup"><span data-stu-id="4a470-634">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="4a470-635">Práce s typy heterogenní entit</span><span class="sxs-lookup"><span data-stu-id="4a470-635">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)  

### <a name="denormalization-pattern"></a><span data-ttu-id="4a470-636">Vzor denormalization</span><span class="sxs-lookup"><span data-stu-id="4a470-636">Denormalization pattern</span></span>
<span data-ttu-id="4a470-637">Kombinování souvisejících dat společně v jedné entity tooenable tooretrieve všechny hello dat je třeba pomocí dotazu jediný bod.</span><span class="sxs-lookup"><span data-stu-id="4a470-637">Combine related data together in a single entity tooenable you tooretrieve all hello data you need with a single point query.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="4a470-638">Kontext a problém</span><span class="sxs-lookup"><span data-stu-id="4a470-638">Context and problem</span></span>
<span data-ttu-id="4a470-639">V relační databázi obvykle normalizaci odstranění duplicitních dat tooremove výsledkem dotazy, které načtení dat z více tabulek.</span><span class="sxs-lookup"><span data-stu-id="4a470-639">In a relational database, you typically normalize data tooremove duplication resulting in queries that retrieve data from multiple tables.</span></span> <span data-ttu-id="4a470-640">Pokud jste normalizaci data do tabulek Azure, musíte nastavit více přenosů z hello klienta toohello server tooretrieve související data.</span><span class="sxs-lookup"><span data-stu-id="4a470-640">If you normalize your data in Azure tables, you must make multiple round trips from hello client toohello server tooretrieve your related data.</span></span> <span data-ttu-id="4a470-641">Například s struktura tabulky hello zobrazené níže potřebovat dva zaokrouhlit služebních cest tooretrieve hello podrobnosti o oddělení: jeden toofetch hello oddělení entita, která obsahuje id hello manager a pak další požadavek toofetch hello manažera podrobnosti v zaměstnanec entita.</span><span class="sxs-lookup"><span data-stu-id="4a470-641">For example, with hello table structure shown below you need two round trips tooretrieve hello details for a department: one toofetch hello department entity that includes hello manager's id, and then another request toofetch hello manager's details in an employee entity.</span></span>  

![][16]

#### <a name="solution"></a><span data-ttu-id="4a470-642">Řešení</span><span class="sxs-lookup"><span data-stu-id="4a470-642">Solution</span></span>
<span data-ttu-id="4a470-643">Místo ukládání dat hello v dvě samostatné entity, denormalize hello data a ponechat si kopii hello správci v entitě oddělení hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-643">Instead of storing hello data in two separate entities, denormalize hello data and keep a copy of hello manager's details in hello department entity.</span></span> <span data-ttu-id="4a470-644">Například:</span><span class="sxs-lookup"><span data-stu-id="4a470-644">For example:</span></span>  

![][17]

<span data-ttu-id="4a470-645">S entitami oddělení uložené s těmito vlastnostmi můžete nyní načíst všechny hello podrobnosti, které potřebujete o oddělení použití bodu dotazu.</span><span class="sxs-lookup"><span data-stu-id="4a470-645">With department entities stored with these properties, you can now retrieve all hello details you need about a department using a point query.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="4a470-646">Problémy a důležité informace</span><span class="sxs-lookup"><span data-stu-id="4a470-646">Issues and considerations</span></span>
<span data-ttu-id="4a470-647">Vezměte v úvahu hello následující body při rozhodování o tom, jak tooimplement tento vzor:</span><span class="sxs-lookup"><span data-stu-id="4a470-647">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="4a470-648">Není náklady režie spojená s ukládáním některá data dvakrát.</span><span class="sxs-lookup"><span data-stu-id="4a470-648">There is some cost overhead associated with storing some data twice.</span></span> <span data-ttu-id="4a470-649">Hello výkonu dávky (vyplývající z méně požadavků toohello úložiště služby) většinou převáží hello okrajového vzrůst náklady na úložiště (a náklady na tento je částečně posun omezením v hello počet transakcí vyžadují toofetch hello podrobnosti oddělení).</span><span class="sxs-lookup"><span data-stu-id="4a470-649">hello performance benefit (resulting from fewer requests toohello storage service) typically outweighs hello marginal increase in storage costs (and this cost is partially offset by a reduction in hello number of transactions you require toofetch hello details of a department).</span></span>  
* <span data-ttu-id="4a470-650">Musíte udržovat hello konzistence hello dvě entity, které obsahují informace o správci.</span><span class="sxs-lookup"><span data-stu-id="4a470-650">You must maintain hello consistency of hello two entities that store information about managers.</span></span> <span data-ttu-id="4a470-651">Dokáže zpracovat hello konzistence problém pomocí EGTs tooupdate více entit v rámci jedné transakce atomic: v tomto případě hello oddělení entity a hello zaměstnanec entity pro hello oddělení manager jsou uloženy v hello stejného oddílu.</span><span class="sxs-lookup"><span data-stu-id="4a470-651">You can handle hello consistency issue by using EGTs tooupdate multiple entities in a single atomic transaction: in this case, hello department entity, and hello employee entity for hello department manager are stored in hello same partition.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="4a470-652">Když toouse tento vzor</span><span class="sxs-lookup"><span data-stu-id="4a470-652">When toouse this pattern</span></span>
<span data-ttu-id="4a470-653">Tento vzor použijte, pokud potřebujete často toolook si související informace.</span><span class="sxs-lookup"><span data-stu-id="4a470-653">Use this pattern when you frequently need toolook up related information.</span></span> <span data-ttu-id="4a470-654">Tento vzor snižuje hello počet dotazů, které váš klient musí udělat tooretrieve hello daty, která vyžaduje.</span><span class="sxs-lookup"><span data-stu-id="4a470-654">This pattern reduces hello number of queries your client must make tooretrieve hello data it requires.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="4a470-655">Související vzory a pokyny</span><span class="sxs-lookup"><span data-stu-id="4a470-655">Related patterns and guidance</span></span>
<span data-ttu-id="4a470-656">Hello následující vzory a pokyny může být také důležité při implementaci tohoto vzoru:</span><span class="sxs-lookup"><span data-stu-id="4a470-656">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="4a470-657">Složené klíče vzor</span><span class="sxs-lookup"><span data-stu-id="4a470-657">Compound key pattern</span></span>](#compound-key-pattern)  
* [<span data-ttu-id="4a470-658">Transakce skupiny entity</span><span class="sxs-lookup"><span data-stu-id="4a470-658">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="4a470-659">Práce s typy heterogenní entit</span><span class="sxs-lookup"><span data-stu-id="4a470-659">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)

### <a name="compound-key-pattern"></a><span data-ttu-id="4a470-660">Složené klíče vzor</span><span class="sxs-lookup"><span data-stu-id="4a470-660">Compound key pattern</span></span>
<span data-ttu-id="4a470-661">Použití složené **RowKey** hodnoty tooenable klienta toolookup související data pomocí dotazu jediný bod.</span><span class="sxs-lookup"><span data-stu-id="4a470-661">Use compound **RowKey** values tooenable a client toolookup related data with a single point query.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="4a470-662">Kontext a problém</span><span class="sxs-lookup"><span data-stu-id="4a470-662">Context and problem</span></span>
<span data-ttu-id="4a470-663">V relační databázi, je poměrně přirozené toouse spojení v dotazech tooreturn související kusy toohello klientských dat v jednom dotazu.</span><span class="sxs-lookup"><span data-stu-id="4a470-663">In a relational database, it is quite natural toouse joins in queries tooreturn related pieces of data toohello client in a single query.</span></span> <span data-ttu-id="4a470-664">Můžete například použít hello zaměstnanec id toolook seznam entit v relaci, které obsahují výkonu a zkontrolujte data pro zaměstnance.</span><span class="sxs-lookup"><span data-stu-id="4a470-664">For example, you might use hello employee id toolook up a list of related entities that contain performance and review data for that employee.</span></span>  

<span data-ttu-id="4a470-665">Předpokládejme, že zaměstnanec entity jsou ukládána do služby Table hello pomocí hello strukturu:</span><span class="sxs-lookup"><span data-stu-id="4a470-665">Assume you are storing employee entities in hello Table service using hello following structure:</span></span>  

![][18]

<span data-ttu-id="4a470-666">Musíte taky toostore historická data týkající se tooreviews a výkon pro každý rok hello zaměstnanec fungovala pro vaši organizaci a potřebujete mít tooaccess toobe tyto informace o rok.</span><span class="sxs-lookup"><span data-stu-id="4a470-666">You also need toostore historical data relating tooreviews and performance for each year hello employee has worked for your organization and you need toobe able tooaccess this information by year.</span></span> <span data-ttu-id="4a470-667">Jednou z možností je toocreate jiné tabulky, který uchovává entity s hello strukturu:</span><span class="sxs-lookup"><span data-stu-id="4a470-667">One option is toocreate another table that stores entities with hello following structure:</span></span>  

![][19]

<span data-ttu-id="4a470-668">Všimněte si, že s tímto přístupu můžete rozhodnout tooduplicate některé informace (například křestní jméno a příjmení) v nové entity tooenable hello tooretrieve můžete svá data pomocí jedné žádosti.</span><span class="sxs-lookup"><span data-stu-id="4a470-668">Notice that with this approach you may decide tooduplicate some information (such as first name and last name) in hello new entity tooenable you tooretrieve your data with a single request.</span></span> <span data-ttu-id="4a470-669">Nelze však udržovat silnou konzistenci, protože nelze použít dvě entity EGT tooupdate hello atomicky.</span><span class="sxs-lookup"><span data-stu-id="4a470-669">However, you cannot maintain strong consistency because you cannot use an EGT tooupdate hello two entities atomically.</span></span>  

#### <a name="solution"></a><span data-ttu-id="4a470-670">Řešení</span><span class="sxs-lookup"><span data-stu-id="4a470-670">Solution</span></span>
<span data-ttu-id="4a470-671">Uložte nový typ entity v původní tabulky pomocí entity hello strukturu:</span><span class="sxs-lookup"><span data-stu-id="4a470-671">Store a new entity type in your original table using entities with hello following structure:</span></span>  

![][20]

<span data-ttu-id="4a470-672">Všimněte si, jak hello **RowKey** je nyní složený klíč tvořená hello identifikační číslo zaměstnance a hello rok hello zkontrolujte data, která vám umožní tooretrieve hello zaměstnance výkon a kontrolovat data pomocí jedné žádosti pro jednu entitu.</span><span class="sxs-lookup"><span data-stu-id="4a470-672">Notice how hello **RowKey** is now a compound key made up of hello employee id and hello year of hello review data that enables you tooretrieve hello employee's performance and review data with a single request for a single entity.</span></span>  

<span data-ttu-id="4a470-673">Hello následující příklad popisuje, jak můžete načíst všechna data hello zkontrolujte pro konkrétního zaměstnance (například zaměstnanci 000123 v oddělení prodeje hello):</span><span class="sxs-lookup"><span data-stu-id="4a470-673">hello following example outlines how you can retrieve all hello review data for a particular employee (such as employee 000123 in hello Sales department):</span></span>  

<span data-ttu-id="4a470-674">$filter = (PartitionKey eq 'Prodej') a (RowKey ge 'empid_000123') a (RowKey lt 'empid_000124') & $select = RowKey, Manager hodnocení, sdílené hodnocení a komentáře</span><span class="sxs-lookup"><span data-stu-id="4a470-674">$filter=(PartitionKey eq 'Sales') and (RowKey ge 'empid_000123') and (RowKey lt 'empid_000124')&$select=RowKey,Manager Rating,Peer Rating,Comments</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="4a470-675">Problémy a důležité informace</span><span class="sxs-lookup"><span data-stu-id="4a470-675">Issues and considerations</span></span>
<span data-ttu-id="4a470-676">Vezměte v úvahu hello následující body při rozhodování o tom, jak tooimplement tento vzor:</span><span class="sxs-lookup"><span data-stu-id="4a470-676">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="4a470-677">Měli byste použít vhodný oddělovací znak, který umožňuje snadno tooparse hello **RowKey** hodnota: například **000123_2012**.</span><span class="sxs-lookup"><span data-stu-id="4a470-677">You should use a suitable separator character that makes it easy tooparse hello **RowKey** value: for example, **000123_2012**.</span></span>  
* <span data-ttu-id="4a470-678">Také ukládáte tuto entitu v hello stejně jako ostatní entity, které obsahují data týkající se hello oddílu stejného zaměstnance, což znamená, můžete použít silnou konzistenci EGTs toomaintain.</span><span class="sxs-lookup"><span data-stu-id="4a470-678">You are also storing this entity in hello same partition as other entities that contain related data for hello same employee, which means you can use EGTs toomaintain strong consistency.</span></span>
* <span data-ttu-id="4a470-679">Měli byste zvážit, jak často bude dotaz hello data toodetermine zda tento vzor je vhodné.</span><span class="sxs-lookup"><span data-stu-id="4a470-679">You should consider how frequently you will query hello data toodetermine whether this pattern is appropriate.</span></span>  <span data-ttu-id="4a470-680">Například pokud bude mít přístup zřídka hello zkontrolujte data a hello hlavní data zaměstnance často byste měli mít jako samostatné entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-680">For example, if you will access hello review data infrequently and hello main employee data often you should keep them as separate entities.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="4a470-681">Když toouse tento vzor</span><span class="sxs-lookup"><span data-stu-id="4a470-681">When toouse this pattern</span></span>
<span data-ttu-id="4a470-682">Tento vzor použijte, pokud potřebujete toostore jeden nebo více související entity dotazu často.</span><span class="sxs-lookup"><span data-stu-id="4a470-682">Use this pattern when you need toostore one or more related entities that you query frequently.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="4a470-683">Související vzory a pokyny</span><span class="sxs-lookup"><span data-stu-id="4a470-683">Related patterns and guidance</span></span>
<span data-ttu-id="4a470-684">Hello následující vzory a pokyny může být také důležité při implementaci tohoto vzoru:</span><span class="sxs-lookup"><span data-stu-id="4a470-684">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="4a470-685">Transakce skupiny entity</span><span class="sxs-lookup"><span data-stu-id="4a470-685">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="4a470-686">Práce s typy heterogenní entit</span><span class="sxs-lookup"><span data-stu-id="4a470-686">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)  
* [<span data-ttu-id="4a470-687">Nakonec byl konzistentní transakce vzor</span><span class="sxs-lookup"><span data-stu-id="4a470-687">Eventually consistent transactions pattern</span></span>](#eventually-consistent-transactions-pattern)  

### <a name="log-tail-pattern"></a><span data-ttu-id="4a470-688">Vzor protokolu poškozené databáze</span><span class="sxs-lookup"><span data-stu-id="4a470-688">Log tail pattern</span></span>
<span data-ttu-id="4a470-689">Načtení hello * n * entity naposledy přidat oddíl tooa pomocí **RowKey** hodnotu, která seřadí zpětné datum a čas pořadí.</span><span class="sxs-lookup"><span data-stu-id="4a470-689">Retrieve hello *n* entities most recently added tooa partition by using a **RowKey** value that sorts in reverse date and time order.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="4a470-690">Kontext a problém</span><span class="sxs-lookup"><span data-stu-id="4a470-690">Context and problem</span></span>
<span data-ttu-id="4a470-691">Běžným požadavkem je, být schopný tooretrieve hello vytvořeno naposled entity, například hello deset nejnovější výdajů deklarace identity odeslaný zaměstnanec.</span><span class="sxs-lookup"><span data-stu-id="4a470-691">A common requirement is be able tooretrieve hello most recently created entities, for example hello ten most recent expense claims submitted by an employee.</span></span> <span data-ttu-id="4a470-692">Tabulka dotazuje podporu **$top** dotaz operaci tooreturn hello nejprve * n * entit ze sady: není žádná ekvivalentní dotazu operaci tooreturn hello posledních n entity v sadě.</span><span class="sxs-lookup"><span data-stu-id="4a470-692">Table queries support a **$top** query operation tooreturn hello first *n* entities from a set: there is no equivalent query operation tooreturn hello last n entities in a set.</span></span>  

#### <a name="solution"></a><span data-ttu-id="4a470-693">Řešení</span><span class="sxs-lookup"><span data-stu-id="4a470-693">Solution</span></span>
<span data-ttu-id="4a470-694">Entity hello úložiště pomocí **RowKey** že přirozeně řazení obráceným datum a čas pořadí pomocí tak hello poslední položka je vždy hello první z nich v tabulce hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-694">Store hello entities using a **RowKey** that naturally sorts in reverse date/time order by using so hello most recent entry is always hello first one in hello table.</span></span>  

<span data-ttu-id="4a470-695">Například může tooretrieve toobe hello deset nejnovější výdajů deklarací odeslaný zaměstnanec, můžete použít hodnotu zpětné značek odvozené od hello aktuální datum a čas.</span><span class="sxs-lookup"><span data-stu-id="4a470-695">For example, toobe able tooretrieve hello ten most recent expense claims submitted by an employee, you can use a reverse tick value derived from hello current date/time.</span></span> <span data-ttu-id="4a470-696">Hello následující ukázka kódu C# ukazuje jeden ze způsobů toocreate vhodný hodnota "obrácený rysky" pro **RowKey** , seřadí z hello nejnovější toohello nejstarší:</span><span class="sxs-lookup"><span data-stu-id="4a470-696">hello following C# code sample shows one way toocreate a suitable "inverted ticks" value for a **RowKey** that sorts from hello most recent toohello oldest:</span></span>  

`string invertedTicks = string.Format("{0:D19}", DateTime.MaxValue.Ticks - DateTime.UtcNow.Ticks);`  

<span data-ttu-id="4a470-697">Můžete získat zpět toohello hodnotu data a času pomocí hello následující kód:</span><span class="sxs-lookup"><span data-stu-id="4a470-697">You can get back toohello date time value using hello following code:</span></span>  

`DateTime dt = new DateTime(DateTime.MaxValue.Ticks - Int64.Parse(invertedTicks));`  

<span data-ttu-id="4a470-698">dotaz tabulky Hello vypadá takto:</span><span class="sxs-lookup"><span data-stu-id="4a470-698">hello table query looks like this:</span></span>  

`https://myaccount.table.core.windows.net/EmployeeExpense(PartitionKey='empid')?$top=10`  

#### <a name="issues-and-considerations"></a><span data-ttu-id="4a470-699">Problémy a důležité informace</span><span class="sxs-lookup"><span data-stu-id="4a470-699">Issues and considerations</span></span>
<span data-ttu-id="4a470-700">Vezměte v úvahu hello následující body při rozhodování o tom, jak tooimplement tento vzor:</span><span class="sxs-lookup"><span data-stu-id="4a470-700">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="4a470-701">Hodnota zpětné značek hello s úvodní nuly musí odsadí tooensure hello řetězcovou hodnotu seřadí podle očekávání.</span><span class="sxs-lookup"><span data-stu-id="4a470-701">You must pad hello reverse tick value with leading zeroes tooensure hello string value sorts as expected.</span></span>  
* <span data-ttu-id="4a470-702">Musíte být vědomi hello škálovatelnost cílů na úrovni hello oddílu.</span><span class="sxs-lookup"><span data-stu-id="4a470-702">You must be aware of hello scalability targets at hello level of a partition.</span></span> <span data-ttu-id="4a470-703">Dávejte pozor, vytváření oddílů aktivního bodu.</span><span class="sxs-lookup"><span data-stu-id="4a470-703">Be careful not create hot spot partitions.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="4a470-704">Když toouse tento vzor</span><span class="sxs-lookup"><span data-stu-id="4a470-704">When toouse this pattern</span></span>
<span data-ttu-id="4a470-705">Použijte tento vzor, když potřebujete tooaccess entity v pořadí zpětné datum a čas, nebo když potřebujete tooaccess hello naposledy přidat entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-705">Use this pattern when you need tooaccess entities in reverse date/time order or when you need tooaccess hello most recently added entities.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="4a470-706">Související vzory a pokyny</span><span class="sxs-lookup"><span data-stu-id="4a470-706">Related patterns and guidance</span></span>
<span data-ttu-id="4a470-707">Hello následující vzory a pokyny může být také důležité při implementaci tohoto vzoru:</span><span class="sxs-lookup"><span data-stu-id="4a470-707">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="4a470-708">Předřadit / append proti vzor</span><span class="sxs-lookup"><span data-stu-id="4a470-708">Prepend / append anti-pattern</span></span>](#prepend-append-anti-pattern)  
* [<span data-ttu-id="4a470-709">Načtení entit</span><span class="sxs-lookup"><span data-stu-id="4a470-709">Retrieving entities</span></span>](#retrieving-entities)  

### <a name="high-volume-delete-pattern"></a><span data-ttu-id="4a470-710">Vzor velkému odstranění</span><span class="sxs-lookup"><span data-stu-id="4a470-710">High volume delete pattern</span></span>
<span data-ttu-id="4a470-711">Povolit odstranění hello k velkému počtu entity uložením všechny entity hello k odstranění souběžných vlastní samostatné tabulky; Odstranění entity hello odstraněním hello tabulky.</span><span class="sxs-lookup"><span data-stu-id="4a470-711">Enable hello deletion of a high volume of entities by storing all hello entities for simultaneous deletion in their own separate table; you delete hello entities by deleting hello table.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="4a470-712">Kontext a problém</span><span class="sxs-lookup"><span data-stu-id="4a470-712">Context and problem</span></span>
<span data-ttu-id="4a470-713">Mnoho aplikací odstranit stará data, která už nepotřebuje toobe dostupné tooa klientská aplikace nebo aplikace hello má archivovaných tooanother paměťového média.</span><span class="sxs-lookup"><span data-stu-id="4a470-713">Many applications delete old data which no longer needs toobe available tooa client application, or that hello application has archived tooanother storage medium.</span></span> <span data-ttu-id="4a470-714">Obvykle identifikovat taková data data: můžete mít například záznamy a požadavek toodelete všech žádostí o přihlášení, které jsou starší než 60 dní.</span><span class="sxs-lookup"><span data-stu-id="4a470-714">You typically identify such data by a date: for example, you have a requirement toodelete records of all login requests that are more than 60 days old.</span></span>  

<span data-ttu-id="4a470-715">Jeden možné návrhu je toouse hello datum a čas požadavku hello přihlášení v hello **RowKey**:</span><span class="sxs-lookup"><span data-stu-id="4a470-715">One possible design is toouse hello date and time of hello login request in hello **RowKey**:</span></span>  

![][21]

<span data-ttu-id="4a470-716">Tento přístup zabraňuje hotspotům oddílu, protože aplikace hello můžete vložit a odstranit entity přihlášení pro každého uživatele v samostatném oddílu.</span><span class="sxs-lookup"><span data-stu-id="4a470-716">This approach avoids partition hotspots because hello application can insert and delete login entities for each user in a separate partition.</span></span> <span data-ttu-id="4a470-717">Však tento přístup může být nákladná a časově náročné Pokud máte velký počet entit, protože je třeba nejprve tooperform tabulku kontroly v pořadí tooidentify všechny entity toodelete hello a pak je nutné odstranit každé staré entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-717">However, this approach may be costly and time consuming if you have a large number of entities because first you need tooperform a table scan in order tooidentify all hello entities toodelete, and then you must delete each old entity.</span></span> <span data-ttu-id="4a470-718">Všimněte si, že můžete snížit hello počet zpátečních cest toohello server vyžaduje toodelete hello staré entit podle dávkování více žádosti o odstranění do EGTs.</span><span class="sxs-lookup"><span data-stu-id="4a470-718">Note that you can reduce hello number of round trips toohello server required toodelete hello old entities by batching multiple delete requests into EGTs.</span></span>  

#### <a name="solution"></a><span data-ttu-id="4a470-719">Řešení</span><span class="sxs-lookup"><span data-stu-id="4a470-719">Solution</span></span>
<span data-ttu-id="4a470-720">Do samostatné tabulky použijte pro každý den pokusů o přihlášení.</span><span class="sxs-lookup"><span data-stu-id="4a470-720">Use a separate table for each day of login attempts.</span></span> <span data-ttu-id="4a470-721">Návrh entit hello výše tooavoid hotspotům můžete použít při vkládání entity a odstranění starší entity je nyní prostě odstranění jedna tabulka každý den (jedno úložiště operace) namísto hledání a odstraňování stovky a tisíce jednotlivé přihlášení entity každý den.</span><span class="sxs-lookup"><span data-stu-id="4a470-721">You can use hello entity design above tooavoid hotspots when you are inserting entities, and deleting old entities is now simply a question of deleting one table every day (a single storage operation) instead of finding and deleting hundreds and thousands of individual login entities every day.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="4a470-722">Problémy a důležité informace</span><span class="sxs-lookup"><span data-stu-id="4a470-722">Issues and considerations</span></span>
<span data-ttu-id="4a470-723">Vezměte v úvahu hello následující body při rozhodování o tom, jak tooimplement tento vzor:</span><span class="sxs-lookup"><span data-stu-id="4a470-723">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="4a470-724">Podporuje váš návrh další způsoby, které vaše aplikace bude používat data hello například vyhledávání konkrétních entit, propojení s jinými dat nebo generování agregační informace?</span><span class="sxs-lookup"><span data-stu-id="4a470-724">Does your design support other ways your application will use hello data such as looking up specific entities, linking with other data, or generating aggregate information?</span></span>  
* <span data-ttu-id="4a470-725">Návrhu vyhnout aktivní body při vkládání nové entity</span><span class="sxs-lookup"><span data-stu-id="4a470-725">Does your design avoid hot spots when you are inserting new entities?</span></span>  
* <span data-ttu-id="4a470-726">Očekávat zpoždění, pokud chcete, aby tooreuse hello stejný název tabulky po jeho odstranění.</span><span class="sxs-lookup"><span data-stu-id="4a470-726">Expect a delay if you want tooreuse hello same table name after deleting it.</span></span> <span data-ttu-id="4a470-727">Je lepší tooalways používat tabulky jedinečné názvy.</span><span class="sxs-lookup"><span data-stu-id="4a470-727">It's better tooalways use unique table names.</span></span>  
* <span data-ttu-id="4a470-728">Očekávají, že některé omezení při prvním použití nové tabulky při hello služby Table zjišťuje hello přístupové vzorce a distribuuje hello oddíly mezi uzly.</span><span class="sxs-lookup"><span data-stu-id="4a470-728">Expect some throttling when you first use a new table while hello Table service learns hello access patterns and distributes hello partitions across nodes.</span></span> <span data-ttu-id="4a470-729">Měli byste zvážit, jak často potřebujete toocreate nové tabulky.</span><span class="sxs-lookup"><span data-stu-id="4a470-729">You should consider how frequently you need toocreate new tables.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="4a470-730">Když toouse tento vzor</span><span class="sxs-lookup"><span data-stu-id="4a470-730">When toouse this pattern</span></span>
<span data-ttu-id="4a470-731">Použít tento vzor, až budete mít k velkému počtu entit, které je nutné odstranit v hello stejnou dobu.</span><span class="sxs-lookup"><span data-stu-id="4a470-731">Use this pattern when you have a high volume of entities that you must delete at hello same time.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="4a470-732">Související vzory a pokyny</span><span class="sxs-lookup"><span data-stu-id="4a470-732">Related patterns and guidance</span></span>
<span data-ttu-id="4a470-733">Hello následující vzory a pokyny může být také důležité při implementaci tohoto vzoru:</span><span class="sxs-lookup"><span data-stu-id="4a470-733">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="4a470-734">Transakce skupiny entity</span><span class="sxs-lookup"><span data-stu-id="4a470-734">Entity Group Transactions</span></span>](#entity-group-transactions)
* [<span data-ttu-id="4a470-735">Úprava entity</span><span class="sxs-lookup"><span data-stu-id="4a470-735">Modifying entities</span></span>](#modifying-entities)  

### <a name="data-series-pattern"></a><span data-ttu-id="4a470-736">Řada vzorek dat</span><span class="sxs-lookup"><span data-stu-id="4a470-736">Data series pattern</span></span>
<span data-ttu-id="4a470-737">Dokončení datové řady úložiště jedna entita toominimize hello počet požadavků, které provedete.</span><span class="sxs-lookup"><span data-stu-id="4a470-737">Store complete data series in a single entity toominimize hello number of requests you make.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="4a470-738">Kontext a problém</span><span class="sxs-lookup"><span data-stu-id="4a470-738">Context and problem</span></span>
<span data-ttu-id="4a470-739">Obvyklým scénářem je pro aplikací toostore řadu dat, obvykle musí tooretrieve všechny najednou.</span><span class="sxs-lookup"><span data-stu-id="4a470-739">A common scenario is for an application toostore a series of data that it typically needs tooretrieve all at once.</span></span> <span data-ttu-id="4a470-740">Vaše aplikace může například záznam kolik zasílání Rychlých zpráv každý zaměstnanec odešle každou hodinu a potom pomocí této informace tooplot, kolik zpráv každý uživatel odešlou přes hello předchozích 24 hodin.</span><span class="sxs-lookup"><span data-stu-id="4a470-740">For example, your application might record how many IM messages each employee sends every hour, and then use this information tooplot how many messages each user sent over hello preceding 24 hours.</span></span> <span data-ttu-id="4a470-741">Jeden návrhu může být toostore 24 entity pro každý zaměstnanec:</span><span class="sxs-lookup"><span data-stu-id="4a470-741">One design might be toostore 24 entities for each employee:</span></span>  

![][22]

<span data-ttu-id="4a470-742">V tomto návrhu můžete snadno vyhledat a aktualizace hello entity tooupdate pro každý zaměstnanec vždy, když aplikace hello je hodnota počtu zpráv tooupdate hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-742">With this design, you can easily locate and update hello entity tooupdate for each employee whenever hello application needs tooupdate hello message count value.</span></span> <span data-ttu-id="4a470-743">Ale tooretrieve hello informace tooplot graf hello aktivity pro hello předchozích 24 hodin, je nutné ji načíst 24 entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-743">However, tooretrieve hello information tooplot a chart of hello activity for hello preceding 24 hours, you must retrieve 24 entities.</span></span>  

#### <a name="solution"></a><span data-ttu-id="4a470-744">Řešení</span><span class="sxs-lookup"><span data-stu-id="4a470-744">Solution</span></span>
<span data-ttu-id="4a470-745">Použijte následující návrh s počtem samostatné vlastnost toostore hello zpráva pro každou hodinu hello:</span><span class="sxs-lookup"><span data-stu-id="4a470-745">Use hello following design with a separate property toostore hello message count for each hour:</span></span>  

![][23]

<span data-ttu-id="4a470-746">V tomto návrhu můžete počet zpráv hello tooupdate operaci sloučení pro zaměstnance pro zadané hodiny.</span><span class="sxs-lookup"><span data-stu-id="4a470-746">With this design, you can use a merge operation tooupdate hello message count for an employee for a specific hour.</span></span> <span data-ttu-id="4a470-747">Teď můžete načíst všechny hello informace, které budete potřebovat graf hello tooplot pomocí žádosti pro jednu entitu.</span><span class="sxs-lookup"><span data-stu-id="4a470-747">Now, you can retrieve all hello information you need tooplot hello chart using a request for a single entity.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="4a470-748">Problémy a důležité informace</span><span class="sxs-lookup"><span data-stu-id="4a470-748">Issues and considerations</span></span>
<span data-ttu-id="4a470-749">Vezměte v úvahu hello následující body při rozhodování o tom, jak tooimplement tento vzor:</span><span class="sxs-lookup"><span data-stu-id="4a470-749">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="4a470-750">Pokud dokončení datové řady nevejde do jedné entity (entita může mít too252 vlastností), použijte alternativní úložišti například objekt blob.</span><span class="sxs-lookup"><span data-stu-id="4a470-750">If your complete data series does not fit into a single entity (an entity can have up too252 properties), use an alternative data store such as a blob.</span></span>  
* <span data-ttu-id="4a470-751">Pokud máte víc klientů současně aktualizaci entity, budete potřebovat toouse hello **značka ETag** optimistickou metodu souběžného tooimplement.</span><span class="sxs-lookup"><span data-stu-id="4a470-751">If you have multiple clients updating an entity simultaneously, you will need toouse hello **ETag** tooimplement optimistic concurrency.</span></span> <span data-ttu-id="4a470-752">Pokud máte mnoho klientů, můžete se setkat vysoké kolizí.</span><span class="sxs-lookup"><span data-stu-id="4a470-752">If you have many clients, you may experience high contention.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="4a470-753">Když toouse tento vzor</span><span class="sxs-lookup"><span data-stu-id="4a470-753">When toouse this pattern</span></span>
<span data-ttu-id="4a470-754">Tento vzor použijte, pokud potřebujete tooupdate a načíst data řady přidružené jednotlivých entit.</span><span class="sxs-lookup"><span data-stu-id="4a470-754">Use this pattern when you need tooupdate and retrieve a data series associated with an individual entity.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="4a470-755">Související vzory a pokyny</span><span class="sxs-lookup"><span data-stu-id="4a470-755">Related patterns and guidance</span></span>
<span data-ttu-id="4a470-756">Hello následující vzory a pokyny může být také důležité při implementaci tohoto vzoru:</span><span class="sxs-lookup"><span data-stu-id="4a470-756">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="4a470-757">Vzor velkých entit</span><span class="sxs-lookup"><span data-stu-id="4a470-757">Large entities pattern</span></span>](#large-entities-pattern)  
* [<span data-ttu-id="4a470-758">Sloučení nebo nahradit</span><span class="sxs-lookup"><span data-stu-id="4a470-758">Merge or replace</span></span>](#merge-or-replace)  
* <span data-ttu-id="4a470-759">[Nakonec byl konzistentní transakce vzor](#eventually-consistent-transactions-pattern) (Pokud ukládáte hello datové řady do objektu BLOB)</span><span class="sxs-lookup"><span data-stu-id="4a470-759">[Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) (if you are storing hello data series in a blob)</span></span>  

### <a name="wide-entities-pattern"></a><span data-ttu-id="4a470-760">Vzor široké entity</span><span class="sxs-lookup"><span data-stu-id="4a470-760">Wide entities pattern</span></span>
<span data-ttu-id="4a470-761">Použití více fyzických entit toostore logických entit s více než 252 vlastností.</span><span class="sxs-lookup"><span data-stu-id="4a470-761">Use multiple physical entities toostore logical entities with more than 252 properties.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="4a470-762">Kontext a problém</span><span class="sxs-lookup"><span data-stu-id="4a470-762">Context and problem</span></span>
<span data-ttu-id="4a470-763">Jednotlivých entit může mít více než 252 vlastností (s výjimkou vlastnosti povinné systému hello) a nelze uložit více než 1 MB dat celkem.</span><span class="sxs-lookup"><span data-stu-id="4a470-763">An individual entity can have no more than 252 properties (excluding hello mandatory system properties) and cannot store more than 1 MB of data in total.</span></span> <span data-ttu-id="4a470-764">V relační databázi by obvykle získáte zaokrouhlí žádné omezení velikosti hello řádku přidáním nové tabulky a vynucování relace 1: 1 mezi nimi.</span><span class="sxs-lookup"><span data-stu-id="4a470-764">In a relational database, you would typically get round any limits on hello size of a row by adding a new table and enforcing a 1-to-1 relationship between them.</span></span>  

#### <a name="solution"></a><span data-ttu-id="4a470-765">Řešení</span><span class="sxs-lookup"><span data-stu-id="4a470-765">Solution</span></span>
<span data-ttu-id="4a470-766">Pomocí služby Table hello, můžete uložit více entit toorepresent objekt jeden velký podnik s více než 252 vlastností.</span><span class="sxs-lookup"><span data-stu-id="4a470-766">Using hello Table service, you can store multiple entities toorepresent a single large business object with more than 252 properties.</span></span> <span data-ttu-id="4a470-767">Například pokud chcete toostore počet hello počet Rychlých zpráv odeslaných každý zaměstnanec pro hello posledních 365 dnů, můžete použít následující návrh, který používá dvě entity s různými schématy hello:</span><span class="sxs-lookup"><span data-stu-id="4a470-767">For example, if you want toostore a count of hello number of IM messages sent by each employee for hello last 365 days, you could use hello following design that uses two entities with different schemas:</span></span>  

![][24]

<span data-ttu-id="4a470-768">Pokud potřebujete toomake změnu, která vyžaduje aktualizaci obou tookeep entity, je synchronizovány mezi sebou můžete použít EGT.</span><span class="sxs-lookup"><span data-stu-id="4a470-768">If you need toomake a change that requires updating both entities tookeep them synchronized with each other you can use an EGT.</span></span> <span data-ttu-id="4a470-769">Počet zpráv tooupdate hello jednom sloučení operace, jinak hodnota můžete použít pro určitý den.</span><span class="sxs-lookup"><span data-stu-id="4a470-769">Otherwise, you can use a single merge operation tooupdate hello message count for a specific day.</span></span> <span data-ttu-id="4a470-770">všechny hello data pro jednotlivé zaměstnance musí načíst obě entity, které můžete provést dva efektivní požadavky, které používají oba tooretrieve **PartitionKey** a **RowKey** hodnotu.</span><span class="sxs-lookup"><span data-stu-id="4a470-770">tooretrieve all hello data for an individual employee you must retrieve both entities, which you can do with two efficient requests that use both a **PartitionKey** and a **RowKey** value.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="4a470-771">Problémy a důležité informace</span><span class="sxs-lookup"><span data-stu-id="4a470-771">Issues and considerations</span></span>
<span data-ttu-id="4a470-772">Vezměte v úvahu hello následující body při rozhodování o tom, jak tooimplement tento vzor:</span><span class="sxs-lookup"><span data-stu-id="4a470-772">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="4a470-773">Načítání dokončení logická entita zahrnuje alespoň dva transakce úložiště: jeden tooretrieve fyzická entita.</span><span class="sxs-lookup"><span data-stu-id="4a470-773">Retrieving a complete logical entity involves at least two storage transactions: one tooretrieve each physical entity.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="4a470-774">Když toouse tento vzor</span><span class="sxs-lookup"><span data-stu-id="4a470-774">When toouse this pattern</span></span>
<span data-ttu-id="4a470-775">Tento vzor použijte v případě potřeby toostore entity, jejichž velikost nebo počet vlastností překračuje hello limity pro jednotlivé entity v hello služba Table.</span><span class="sxs-lookup"><span data-stu-id="4a470-775">Use this pattern when  need toostore entities whose size or number of properties exceeds hello limits for an individual entity in hello Table service.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="4a470-776">Související vzory a pokyny</span><span class="sxs-lookup"><span data-stu-id="4a470-776">Related patterns and guidance</span></span>
<span data-ttu-id="4a470-777">Hello následující vzory a pokyny může být také důležité při implementaci tohoto vzoru:</span><span class="sxs-lookup"><span data-stu-id="4a470-777">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="4a470-778">Transakce skupiny entity</span><span class="sxs-lookup"><span data-stu-id="4a470-778">Entity Group Transactions</span></span>](#entity-group-transactions)
* [<span data-ttu-id="4a470-779">Sloučení nebo nahradit</span><span class="sxs-lookup"><span data-stu-id="4a470-779">Merge or replace</span></span>](#merge-or-replace)

### <a name="large-entities-pattern"></a><span data-ttu-id="4a470-780">Vzor velkých entit</span><span class="sxs-lookup"><span data-stu-id="4a470-780">Large entities pattern</span></span>
<span data-ttu-id="4a470-781">Použijte hodnoty velký vlastností toostore úložiště objektů blob.</span><span class="sxs-lookup"><span data-stu-id="4a470-781">Use blob storage toostore large property values.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="4a470-782">Kontext a problém</span><span class="sxs-lookup"><span data-stu-id="4a470-782">Context and problem</span></span>
<span data-ttu-id="4a470-783">Jednotlivé entity Nejde uložit více než 1 MB dat celkem.</span><span class="sxs-lookup"><span data-stu-id="4a470-783">An individual entity cannot store more than 1 MB of data in total.</span></span> <span data-ttu-id="4a470-784">Pokud jeden nebo několik vlastnosti ukládá hodnoty, které způsobí hello celková velikost vaší entity tooexceed tuto hodnotu, nemůžete uložit celý entity hello hello služby Table.</span><span class="sxs-lookup"><span data-stu-id="4a470-784">If one or several of your properties store values that cause hello total size of your entity tooexceed this value, you cannot store hello entire entity in hello Table service.</span></span>  

#### <a name="solution"></a><span data-ttu-id="4a470-785">Řešení</span><span class="sxs-lookup"><span data-stu-id="4a470-785">Solution</span></span>
<span data-ttu-id="4a470-786">Pokud vaší entity překračuje 1 MB velikost, protože jeden nebo více vlastností obsahovat velké množství dat, můžete ukládání dat v hello služby objektů Blob a potom uložte hello adresu hello blob ve vlastnosti v entitě hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-786">If your entity exceeds 1 MB in size because one or more properties contain a large amount of data, you can store data in hello Blob service and then store hello address of hello blob in a property in hello entity.</span></span> <span data-ttu-id="4a470-787">Například můžete ukládat hello fotografie zaměstnanec v úložišti objektů blob a uložit fotografii toohello odkaz hello **fotografií** vlastnosti vaší entity zaměstnanců:</span><span class="sxs-lookup"><span data-stu-id="4a470-787">For example, you can store hello photo of an employee in blob storage and store a link toohello photo in hello **Photo** property of your employee entity:</span></span>  

![][25]

#### <a name="issues-and-considerations"></a><span data-ttu-id="4a470-788">Problémy a důležité informace</span><span class="sxs-lookup"><span data-stu-id="4a470-788">Issues and considerations</span></span>
<span data-ttu-id="4a470-789">Vezměte v úvahu hello následující body při rozhodování o tom, jak tooimplement tento vzor:</span><span class="sxs-lookup"><span data-stu-id="4a470-789">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="4a470-790">konzistence typu případné toomaintain mezi hello entity v hello služby Table a hello data v hello služby objektů Blob, použijte hello [nakonec byl konzistentní transakce vzor](#eventually-consistent-transactions-pattern) toomaintain vaší entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-790">toomaintain eventual consistency between hello entity in hello Table service and hello data in hello Blob service, use hello [Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) toomaintain your entities.</span></span>
* <span data-ttu-id="4a470-791">Načítání úplnou entitu zahrnuje alespoň dva transakce úložiště: jednu entitu hello tooretrieve a jeden tooretrieve hello data objektů blob.</span><span class="sxs-lookup"><span data-stu-id="4a470-791">Retrieving a complete entity involves at least two storage transactions: one tooretrieve hello entity and one tooretrieve hello blob data.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="4a470-792">Když toouse tento vzor</span><span class="sxs-lookup"><span data-stu-id="4a470-792">When toouse this pattern</span></span>
<span data-ttu-id="4a470-793">Tento vzor použijte, pokud budete potřebovat toostore entity, jehož velikost překračuje hello limity pro jednotlivé entity v služby Table hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-793">Use this pattern when you need toostore entities whose size exceeds hello limits for an individual entity in hello Table service.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="4a470-794">Související vzory a pokyny</span><span class="sxs-lookup"><span data-stu-id="4a470-794">Related patterns and guidance</span></span>
<span data-ttu-id="4a470-795">Hello následující vzory a pokyny může být také důležité při implementaci tohoto vzoru:</span><span class="sxs-lookup"><span data-stu-id="4a470-795">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="4a470-796">Nakonec byl konzistentní transakce vzor</span><span class="sxs-lookup"><span data-stu-id="4a470-796">Eventually consistent transactions pattern</span></span>](#eventually-consistent-transactions-pattern)  
* [<span data-ttu-id="4a470-797">Vzor široké entity</span><span class="sxs-lookup"><span data-stu-id="4a470-797">Wide entities pattern</span></span>](#wide-entities-pattern)

<a name="prepend-append-anti-pattern"></a>

### <a name="prependappend-anti-pattern"></a><span data-ttu-id="4a470-798">Předřazení připojit proti vzor</span><span class="sxs-lookup"><span data-stu-id="4a470-798">Prepend/append anti-pattern</span></span>
<span data-ttu-id="4a470-799">Zvýšení škálovatelnosti, když máte k velkému počtu vloží tak, že se vloží hello napříč více oddílů.</span><span class="sxs-lookup"><span data-stu-id="4a470-799">Increase scalability when you have a high volume of inserts by spreading hello inserts across multiple partitions.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="4a470-800">Kontext a problém</span><span class="sxs-lookup"><span data-stu-id="4a470-800">Context and problem</span></span>
<span data-ttu-id="4a470-801">Přidáním nebo připojování entity tooyour uložené entity obvykle výsledkem aplikace hello přidání nové entity toohello první nebo poslední oddílu pořadí oddílů.</span><span class="sxs-lookup"><span data-stu-id="4a470-801">Prepending or appending entities tooyour stored entities typically results in hello application adding new entities toohello first or last partition of a sequence of partitions.</span></span> <span data-ttu-id="4a470-802">V takovém případě všechny hello vložení v každém okamžiku jsou probíhající v hello stejného oddílu, vytváření aktivní bod, který brání Vyrovnávání zatížení služby table hello vloží mezi několika uzly a což může způsobit vaše aplikace toohit hello škálovatelnost cíle pro oddíl.</span><span class="sxs-lookup"><span data-stu-id="4a470-802">In this case, all of hello inserts at any given time are taking place in hello same partition, creating a hotspot that prevents hello table service from load balancing inserts across multiple nodes, and possibly causing your application toohit hello scalability targets for partition.</span></span> <span data-ttu-id="4a470-803">Například pokud máte aplikaci, která zaměstnanci, přístup k síťové protokoly a prostředků, pak může mít za následek strukturu entity, jak je uvedeno níže hello stane aktivní oblast, pokud hello objem transakcí dosáhne hello škálovatelnost cíl pro oddíl aktuální hodiny jednotlivé oddílu:</span><span class="sxs-lookup"><span data-stu-id="4a470-803">For example, if you have an application that logs network and resource access by employees, then an entity structure as shown below could result in hello current hour's partition becoming a hotspot if hello volume of transactions reaches hello scalability target for an individual partition:</span></span>  

![][26]

#### <a name="solution"></a><span data-ttu-id="4a470-804">Řešení</span><span class="sxs-lookup"><span data-stu-id="4a470-804">Solution</span></span>
<span data-ttu-id="4a470-805">Hello následující strukturu alternativní entity zabraňuje v žádné konkrétní oddílu aktivní bod jako hello aplikace protokoly událostí:</span><span class="sxs-lookup"><span data-stu-id="4a470-805">hello following alternative entity structure avoids a hotspot on any particular partition as hello application logs events:</span></span>  

![][27]

<span data-ttu-id="4a470-806">Všimněte si tento příklad, jak oba hello **PartitionKey** a **RowKey** jsou složeného klíče.</span><span class="sxs-lookup"><span data-stu-id="4a470-806">Notice with this example how both hello **PartitionKey** and **RowKey** are compound keys.</span></span> <span data-ttu-id="4a470-807">Hello **PartitionKey** používá hello oddělení a zaměstnanci id toodistribute hello protokolování napříč více oddílů.</span><span class="sxs-lookup"><span data-stu-id="4a470-807">hello **PartitionKey** uses both hello department and employee id toodistribute hello logging across multiple partitions.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="4a470-808">Problémy a důležité informace</span><span class="sxs-lookup"><span data-stu-id="4a470-808">Issues and considerations</span></span>
<span data-ttu-id="4a470-809">Vezměte v úvahu hello následující body při rozhodování o tom, jak tooimplement tento vzor:</span><span class="sxs-lookup"><span data-stu-id="4a470-809">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="4a470-810">Nepodporuje hello alternativní klíče struktura, která zabraňuje vytváření aktivní oddíly na vložení efektivně dotazů hello podpory umožňuje klientské aplikace?</span><span class="sxs-lookup"><span data-stu-id="4a470-810">Does hello alternative key structure that avoids creating hot partitions on inserts efficiently support hello queries your client application makes?</span></span>  
* <span data-ttu-id="4a470-811">Znamená předpokládaného svazku transakcí jsou cíle škálovatelnosti hello pro jednotlivé oddíl pravděpodobně tooreach a omezeny službou hello úložiště?</span><span class="sxs-lookup"><span data-stu-id="4a470-811">Does your anticipated volume of transactions mean that you are likely tooreach hello scalability targets for an individual partition and be throttled by hello storage service?</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="4a470-812">Když toouse tento vzor</span><span class="sxs-lookup"><span data-stu-id="4a470-812">When toouse this pattern</span></span>
<span data-ttu-id="4a470-813">Vzor proti předřazení připojit hello Vyhněte se při svazku transakcí je pravděpodobně tooresult v omezení šířky pásma službou hello úložiště při přístupu k aktivní oddíl.</span><span class="sxs-lookup"><span data-stu-id="4a470-813">Avoid hello prepend/append anti-pattern when your volume of transactions is likely tooresult in throttling by hello storage service when you access a hot partition.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="4a470-814">Související vzory a pokyny</span><span class="sxs-lookup"><span data-stu-id="4a470-814">Related patterns and guidance</span></span>
<span data-ttu-id="4a470-815">Hello následující vzory a pokyny může být také důležité při implementaci tohoto vzoru:</span><span class="sxs-lookup"><span data-stu-id="4a470-815">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="4a470-816">Složené klíče vzor</span><span class="sxs-lookup"><span data-stu-id="4a470-816">Compound key pattern</span></span>](#compound-key-pattern)  
* [<span data-ttu-id="4a470-817">Vzor protokolu poškozené databáze</span><span class="sxs-lookup"><span data-stu-id="4a470-817">Log tail pattern</span></span>](#log-tail-pattern)  
* [<span data-ttu-id="4a470-818">Úprava entity</span><span class="sxs-lookup"><span data-stu-id="4a470-818">Modifying entities</span></span>](#modifying-entities)  

### <a name="log-data-anti-pattern"></a><span data-ttu-id="4a470-819">Proti vzorek dat protokolu</span><span class="sxs-lookup"><span data-stu-id="4a470-819">Log data anti-pattern</span></span>
<span data-ttu-id="4a470-820">Obvykle použijte hello služby objektů Blob místo hello data protokolu toostore služby Table.</span><span class="sxs-lookup"><span data-stu-id="4a470-820">Typically, you should use hello Blob service instead of hello Table service toostore log data.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="4a470-821">Kontext a problém</span><span class="sxs-lookup"><span data-stu-id="4a470-821">Context and problem</span></span>
<span data-ttu-id="4a470-822">Případ použití běžné pro data protokolu je tooretrieve výběr položky protokolu pro konkrétní datum a čas rozsah: například chcete toofind všechny hello chyba a kritické zprávy, které vaše aplikace protokolují mezi 15:04 a 15:06 na konkrétní datum.</span><span class="sxs-lookup"><span data-stu-id="4a470-822">A common use case for log data is tooretrieve a selection of log entries for a specific date/time range: for example, you want toofind all hello error and critical messages that your application logged between 15:04 and 15:06 on a specific date.</span></span> <span data-ttu-id="4a470-823">Nechcete toouse hello datum a čas hello protokolu zpráv toodetermine hello oddílu uložit protokolu entity k: aby výsledky do aktivního oddílu vzhledem k tomu, že v každém okamžiku budou sdílet všechny entity protokolu hello hello stejné **PartitionKey** hodnota (části hello [Prepend/připojovat proti vzor](#prepend-append-anti-pattern)).</span><span class="sxs-lookup"><span data-stu-id="4a470-823">You do not want toouse hello date and time of hello log message toodetermine hello partition you save log entities to: that results in a hot partition because at any given time, all hello log entities will share hello same **PartitionKey** value (see hello section [Prepend/append anti-pattern](#prepend-append-anti-pattern)).</span></span> <span data-ttu-id="4a470-824">Například hello následující schéma entity pro zprávu protokolu dochází v oddílu aktivní, protože aplikace hello zapíše všechny zprávy protokolu pro hello aktuální datum a hodinu toohello oddíl:</span><span class="sxs-lookup"><span data-stu-id="4a470-824">For example, hello following entity schema for a log message results in a hot partition because hello application writes all log messages toohello partition for hello current date and hour:</span></span>  

![][28]

<span data-ttu-id="4a470-825">V tomto příkladu hello **RowKey** zahrnuje hello datum a čas hello protokolu zpráv tooensure zprávy protokolu jsou uložená data a času řazení a zahrnuje id zprávy v případě, že více zpráv protokolu sdílet hello stejná data a času.</span><span class="sxs-lookup"><span data-stu-id="4a470-825">In this example, hello **RowKey** includes hello date and time of hello log message tooensure that log messages are stored sorted in date/time order, and includes a message id in case multiple log messages share hello same date and time.</span></span>  

<span data-ttu-id="4a470-826">Další možností je toouse **PartitionKey** zajistí, že aplikace hello zapíše zprávy napříč celou řadu oddíly.</span><span class="sxs-lookup"><span data-stu-id="4a470-826">Another approach is toouse a **PartitionKey** that ensures that hello application writes messages across a range of partitions.</span></span> <span data-ttu-id="4a470-827">Například pokud hello zdroj zprávy protokolu hello poskytuje způsob toodistribute zprávy napříč mnoha oddílů, můžete použít následující schéma entity hello:</span><span class="sxs-lookup"><span data-stu-id="4a470-827">For example, if hello source of hello log message provides a way toodistribute messages across many partitions, you could use hello following entity schema:</span></span>  

![][29]

<span data-ttu-id="4a470-828">Hello problém s tímto schématem je ale, že tooretrieve všechny hello zprávy protokolu pro konkrétní časové rozpětí musí prohledávat každý oddíl v tabulce hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-828">However, hello problem with this schema is that tooretrieve all hello log messages for a specific time span you must search every partition in hello table.</span></span>

#### <a name="solution"></a><span data-ttu-id="4a470-829">Řešení</span><span class="sxs-lookup"><span data-stu-id="4a470-829">Solution</span></span>
<span data-ttu-id="4a470-830">Hello předchozí část zvýrazněná hello problém při toouse hello položky protokolu toostore služby tabulky a navrhované dva nevyhovující, návrhy.</span><span class="sxs-lookup"><span data-stu-id="4a470-830">hello previous section highlighted hello problem of trying toouse hello Table service toostore log entries and suggested two, unsatisfactory, designs.</span></span> <span data-ttu-id="4a470-831">Jedno řešení vedla tooa aktivní oddíl s hello riziko nízký výkon zápis zpráv protokolu; Hello jiné řešení výsledkem dotaz nízký výkon z důvodu hello požadavek tooscan každého oddílu ve zprávách protokolu tooretrieve hello tabulky pro konkrétní časové období.</span><span class="sxs-lookup"><span data-stu-id="4a470-831">One solution led tooa hot partition with hello risk of poor performance writing log messages; hello other solution resulted in poor query performance because of hello requirement tooscan every partition in hello table tooretrieve log messages for a specific time span.</span></span> <span data-ttu-id="4a470-832">Úložiště BLOB nabízí lepší řešení pro tento typ scénáře a jedná se o tom, jak Azure Storage Analytics úložiště hello protokolu data shromáždí.</span><span class="sxs-lookup"><span data-stu-id="4a470-832">Blob storage offers a better solution for this type of scenario and this is how Azure Storage Analytics stores hello log data it collects.</span></span>  

<span data-ttu-id="4a470-833">Tato část popisuje, jak analytika úložiště ukládá data protokolu v úložišti objektů blob jako ilustraci dat toostoring přístup, která obvykle dotazování podle rozsahu.</span><span class="sxs-lookup"><span data-stu-id="4a470-833">This section outlines how Storage Analytics stores log data in blob storage as an illustration of this approach toostoring data that you typically query by range.</span></span>  

<span data-ttu-id="4a470-834">Analytika úložiště ukládá zprávy protokolu ve formátu odděleného do více objektů BLOB.</span><span class="sxs-lookup"><span data-stu-id="4a470-834">Storage Analytics stores log messages in a delimited format in multiple blobs.</span></span> <span data-ttu-id="4a470-835">Formát odděleného Hello snadno pro klienta aplikace tooparse hello data ve zprávě protokolu hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-835">hello delimited format makes it easy for a client application tooparse hello data in hello log message.</span></span>  

<span data-ttu-id="4a470-836">Analytika úložiště používá vytváření názvů pro objekty BLOB, které umožňuje toolocate hello blob (nebo objekty BLOB) obsahující zprávy protokolu hello, pro které chcete najít.</span><span class="sxs-lookup"><span data-stu-id="4a470-836">Storage Analytics uses a naming convention for blobs that enables you toolocate hello blob (or blobs) that contain hello log messages for which you are searching.</span></span> <span data-ttu-id="4a470-837">Například objekt blob s názvem "queue/2014/07/31/1800/000001.log" obsahuje zprávy protokolu, které se týkají služby front toohello hello hodinu od 18:00 na 31 červenec 2014.</span><span class="sxs-lookup"><span data-stu-id="4a470-837">For example, a blob named "queue/2014/07/31/1800/000001.log" contains log messages that relate toohello queue service for hello hour starting at 18:00 on 31 July 2014.</span></span> <span data-ttu-id="4a470-838">Hello "000001" označuje, že se jedná hello první soubor protokolu pro toto období.</span><span class="sxs-lookup"><span data-stu-id="4a470-838">hello "000001" indicates that this is hello first log file for this period.</span></span> <span data-ttu-id="4a470-839">Analytika úložiště taky zaznamenává hello časová razítka hello první a poslední protokolování zpráv, které jsou uložené v souboru hello jako součást metadata objektu blob hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-839">Storage Analytics also records hello timestamps of hello first and last log messages stored in hello file as part of hello blob's metadata.</span></span> <span data-ttu-id="4a470-840">Hello rozhraní API pro objekt blob úložiště umožňuje vyhledat objekty BLOB v kontejneru na základě předpony názvu: toolocate všech objektů BLOB hello, které obsahují fronty protokolovat data hello hodinu od 18:00, můžete použít hello předponu "fronty/2014/07/31/1 800."</span><span class="sxs-lookup"><span data-stu-id="4a470-840">hello API for blob storage enables you locate blobs in a container based on a name prefix: toolocate all hello blobs that contain queue log data for hello hour starting at 18:00, you can use hello prefix "queue/2014/07/31/1800."</span></span>  

<span data-ttu-id="4a470-841">Analytika úložiště interně ukládá zprávy protokolu vyrovnávací paměti a pravidelně aktualizuje příslušné blob hello nebo vytvoří nový s hello nejnovější dávku položky protokolu.</span><span class="sxs-lookup"><span data-stu-id="4a470-841">Storage Analytics buffers log messages internally and then periodically updates hello appropriate blob or creates a new one with hello latest batch of log entries.</span></span> <span data-ttu-id="4a470-842">Tím se snižuje počet hello zápisů proveďte toohello služby objektů blob.</span><span class="sxs-lookup"><span data-stu-id="4a470-842">This reduces hello number of writes it must perform toohello blob service.</span></span>  

<span data-ttu-id="4a470-843">Pokud implementujete řešení podobné ve vaší vlastní aplikaci, musíte zvážit, jak toomanage hello kompromis mezi spolehlivost (zápis jako Odehrává se každý záznam tooblob úložiště) a náklady a škálovatelnost (ukládání do vyrovnávací paměti aktualizací ve vaší aplikaci a zápis je tooblob úložiště v dávkách).</span><span class="sxs-lookup"><span data-stu-id="4a470-843">If you are implementing a similar solution in your own application, you must consider how toomanage hello trade-off between reliability (writing every log entry tooblob storage as it happens) and cost and scalability (buffering updates in your application and writing them tooblob storage in batches).</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="4a470-844">Problémy a důležité informace</span><span class="sxs-lookup"><span data-stu-id="4a470-844">Issues and considerations</span></span>
<span data-ttu-id="4a470-845">Mějte na paměti následující body při rozhodování o tom, jak toostore protokolovat data hello:</span><span class="sxs-lookup"><span data-stu-id="4a470-845">Consider hello following points when deciding how toostore log data:</span></span>  

* <span data-ttu-id="4a470-846">Pokud vytvoříte návrh tabulky, který zabraňuje potenciální aktivní oddíly, můžete zjistit, data protokolu nelze efektivní přístup.</span><span class="sxs-lookup"><span data-stu-id="4a470-846">If you create a table design that avoids potential hot partitions, you may find that you cannot access your log data efficiently.</span></span>  
* <span data-ttu-id="4a470-847">tooprocess protokolovat data, klient často potřebuje tooload mnoho záznamů.</span><span class="sxs-lookup"><span data-stu-id="4a470-847">tooprocess log data, a client often needs tooload many records.</span></span>  
* <span data-ttu-id="4a470-848">I když je často strukturovaná data protokolu, úložiště objektů blob může být lepším řešením.</span><span class="sxs-lookup"><span data-stu-id="4a470-848">Although log data is often structured, blob storage may be a better solution.</span></span>  

### <a name="implementation-considerations"></a><span data-ttu-id="4a470-849">Důležité informace o implementaci</span><span class="sxs-lookup"><span data-stu-id="4a470-849">Implementation considerations</span></span>
<span data-ttu-id="4a470-850">Tato část popisuje některé aspekty toobear hello pamatujte při implementaci hello vzory popsané v předchozích částech hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-850">This section discusses some of hello considerations toobear in mind when you implement hello patterns described in hello previous sections.</span></span> <span data-ttu-id="4a470-851">Většina Tato část používá příklady napsané v C#, které používají hello Klientská knihovna pro úložiště (verze 4.3.0 v době psaní hello).</span><span class="sxs-lookup"><span data-stu-id="4a470-851">Most of this section uses examples written in C# that use hello Storage Client Library (version 4.3.0 at hello time of writing).</span></span>  

### <a name="retrieving-entities"></a><span data-ttu-id="4a470-852">Načtení entit</span><span class="sxs-lookup"><span data-stu-id="4a470-852">Retrieving entities</span></span>
<span data-ttu-id="4a470-853">Jak je popsáno v části hello [návrhu pro dotazování](#design-for-querying), hello nejúčinnější dotaz je dotaz bodu.</span><span class="sxs-lookup"><span data-stu-id="4a470-853">As discussed in hello section [Design for querying](#design-for-querying), hello most efficient query is a point query.</span></span> <span data-ttu-id="4a470-854">Ale v některých scénářích musíte tooretrieve více entit.</span><span class="sxs-lookup"><span data-stu-id="4a470-854">However, in some scenarios you may need tooretrieve multiple entities.</span></span> <span data-ttu-id="4a470-855">Tato část popisuje některé běžné entity tooretrieving přístupy pomocí hello Klientská knihovna pro úložiště.</span><span class="sxs-lookup"><span data-stu-id="4a470-855">This section describes some common approaches tooretrieving entities using hello Storage Client Library.</span></span>  

#### <a name="executing-a-point-query-using-hello-storage-client-library"></a><span data-ttu-id="4a470-856">Spuštění dotazu na bodu pomocí hello Klientská knihovna pro úložiště</span><span class="sxs-lookup"><span data-stu-id="4a470-856">Executing a point query using hello Storage Client Library</span></span>
<span data-ttu-id="4a470-857">Hello nejjednodušší způsob, jak tooexecute bodu dotazu je toouse hello **načíst** tabulky operace, jak je znázorněno v hello následující fragment kódu jazyka C#, který načte entit **PartitionKey** hodnotu "prodej" a ** RowKey** hodnoty "212":</span><span class="sxs-lookup"><span data-stu-id="4a470-857">hello easiest way tooexecute a point query is toouse hello **Retrieve** table operation as shown in hello following C# code snippet that retrieves an entity with a **PartitionKey** of value "Sales" and a **RowKey** of value "212":</span></span>  

```csharp
TableOperation retrieveOperation = TableOperation.Retrieve<EmployeeEntity>("Sales", "212");
var retrieveResult = employeeTable.Execute(retrieveOperation);
if (retrieveResult.Result != null)
{
    EmployeeEntity employee = (EmployeeEntity)retrieveResult.Result;
    ...
}  
```

<span data-ttu-id="4a470-858">Všimněte si, jak tento příklad očekává hello entity ho načte toobe typu **EmployeeEntity**.</span><span class="sxs-lookup"><span data-stu-id="4a470-858">Notice how this example expects hello entity it retrieves toobe of type **EmployeeEntity**.</span></span>  

#### <a name="retrieving-multiple-entities-using-linq"></a><span data-ttu-id="4a470-859">Načítání více entit pomocí LINQ</span><span class="sxs-lookup"><span data-stu-id="4a470-859">Retrieving multiple entities using LINQ</span></span>
<span data-ttu-id="4a470-860">Můžete načíst pomocí LINQ s Klientská knihovna pro úložiště a zadat dotaz s více entit **kde** klauzule.</span><span class="sxs-lookup"><span data-stu-id="4a470-860">You can retrieve multiple entities by using LINQ with Storage Client Library and specifying a query with a **where** clause.</span></span> <span data-ttu-id="4a470-861">tooavoid prohledávání tabulky, by měla vždycky obsahovat hello **PartitionKey** hodnota v hello kde klauzule a pokud je to možné hello **RowKey** hodnotu tooavoid prohledávání tabulky a oddíl.</span><span class="sxs-lookup"><span data-stu-id="4a470-861">tooavoid a table scan, you should always include hello **PartitionKey** value in hello where clause, and if possible hello **RowKey** value tooavoid table and partition scans.</span></span> <span data-ttu-id="4a470-862">Hello služby table podporuje omezenou sadu operátory porovnání (větší než, větší než nebo rovna méně než je menší než nebo rovna, stejné a není rovno) toouse v hello kde klauzule.</span><span class="sxs-lookup"><span data-stu-id="4a470-862">hello table service supports a limited set of comparison operators (greater than, greater than or equal, less than, less than or equal, equal, and not equal) toouse in hello where clause.</span></span> <span data-ttu-id="4a470-863">Hello následující fragment kódu jazyka C# vyhledá všechny zaměstnance hello jejichž poslední název začíná na "B" (za předpokladu, že hello **RowKey** úložiště hello příjmení) v oddělení prodeje hello (za předpokladu, že hello **PartitionKey** ukládá název oddělení hello):</span><span class="sxs-lookup"><span data-stu-id="4a470-863">hello following C# code snippet finds all hello employees whose last name starts with "B" (assuming that hello **RowKey** stores hello last name) in hello sales department (assuming hello **PartitionKey** stores hello department name):</span></span>  

```csharp
TableQuery<EmployeeEntity> employeeQuery = employeeTable.CreateQuery<EmployeeEntity>();
var query = (from employee in employeeQuery
            where employee.PartitionKey == "Sales" &&
            employee.RowKey.CompareTo("B") >= 0 &&
            employee.RowKey.CompareTo("C") < 0
            select employee).AsTableQuery();
var employees = query.Execute();  
```

<span data-ttu-id="4a470-864">Všimněte si, jak hello dotaz Určuje, jak **RowKey** a **PartitionKey** tooensure lepší výkon.</span><span class="sxs-lookup"><span data-stu-id="4a470-864">Notice how hello query specifies both a **RowKey** and a **PartitionKey** tooensure better performance.</span></span>  

<span data-ttu-id="4a470-865">Hello následující ukázka kódu zobrazuje ekvivalentní funkce pomocí rozhraní fluent API hello (Další informace o rozhraní fluent API obecně platí, najdete v části [osvědčené postupy pro navrhování rozhraní Fluent API](http://visualstudiomagazine.com/articles/2013/12/01/best-practices-for-designing-a-fluent-api.aspx)):</span><span class="sxs-lookup"><span data-stu-id="4a470-865">hello following code sample shows equivalent functionality using hello fluent API (for more information about fluent APIs in general, see [Best Practices for Designing a Fluent API](http://visualstudiomagazine.com/articles/2013/12/01/best-practices-for-designing-a-fluent-api.aspx)):</span></span>  

```csharp
TableQuery<EmployeeEntity> employeeQuery = new TableQuery<EmployeeEntity>().Where(
    TableQuery.CombineFilters(
    TableQuery.CombineFilters(
        TableQuery.GenerateFilterCondition(
    "PartitionKey", QueryComparisons.Equal, "Sales"),
    TableOperators.And,
    TableQuery.GenerateFilterCondition(
    "RowKey", QueryComparisons.GreaterThanOrEqual, "B")
),
TableOperators.And,
TableQuery.GenerateFilterCondition("RowKey", QueryComparisons.LessThan, "C")
    )
);
var employees = employeeTable.ExecuteQuery(employeeQuery);  
```

> [!NOTE]
> <span data-ttu-id="4a470-866">Hello ukázka vnořena více **CombineFilters** metody tooinclude hello tři filtr podmínek.</span><span class="sxs-lookup"><span data-stu-id="4a470-866">hello sample nests multiple **CombineFilters** methods tooinclude hello three filter conditions.</span></span>  
> 
> 

#### <a name="retrieving-large-numbers-of-entities-from-a-query"></a><span data-ttu-id="4a470-867">Načítání velký počet entit z dotazu</span><span class="sxs-lookup"><span data-stu-id="4a470-867">Retrieving large numbers of entities from a query</span></span>
<span data-ttu-id="4a470-868">Optimální dotaz vrátí jednotlivých entit na základě **PartitionKey** hodnotu a **RowKey** hodnotu.</span><span class="sxs-lookup"><span data-stu-id="4a470-868">An optimal query returns an individual entity based on a **PartitionKey** value and a **RowKey** value.</span></span> <span data-ttu-id="4a470-869">Ale v některých případech může obsahují tooreturn požadavek mnoho entit z hello stejné oddílu, nebo dokonce z mnoha oddílů.</span><span class="sxs-lookup"><span data-stu-id="4a470-869">However, in some scenarios you may have a requirement tooreturn many entities from hello same partition or even from many partitions.</span></span>  

<span data-ttu-id="4a470-870">V takových případech byste měli vždy plně otestovat hello výkon aplikace.</span><span class="sxs-lookup"><span data-stu-id="4a470-870">You should always fully test hello performance of your application in such scenarios.</span></span>  

<span data-ttu-id="4a470-871">Dotazy na data služby table hello může vrátit maximálně 1000 entit najednou a může spustit maximálně pět sekund.</span><span class="sxs-lookup"><span data-stu-id="4a470-871">A query against hello table service may return a maximum of 1,000 entities at one time and may execute for a maximum of five seconds.</span></span> <span data-ttu-id="4a470-872">Pokud hello sadu výsledků dotazu obsahuje více než 1 000 entity, pokud hello dotaz nebyl dokončen v pět sekund, nebo pokud dotaz hello protne hello oddílu hranic, vrátí hello služby Table tooenable token pokračování hello hello toorequest klientské aplikace Další sady entit.</span><span class="sxs-lookup"><span data-stu-id="4a470-872">If hello result set contains more than 1,000 entities, if hello query did not complete within five seconds, or if hello query crosses hello partition boundary, hello Table service returns a continuation token tooenable hello client application toorequest hello next set of entities.</span></span> <span data-ttu-id="4a470-873">Další informace o tom, jak pokračování tokeny pracovní najdete v tématu [časový limit dotazu a Paginování](http://msdn.microsoft.com/library/azure/dd135718.aspx).</span><span class="sxs-lookup"><span data-stu-id="4a470-873">For more information about how continuation tokens work, see [Query Timeout and Pagination](http://msdn.microsoft.com/library/azure/dd135718.aspx).</span></span>  

<span data-ttu-id="4a470-874">Pokud používáte hello Klientská knihovna pro úložiště, může ho automaticky jako vrátí entity z hello služby Table pro vás zpracovávat pokračování tokeny.</span><span class="sxs-lookup"><span data-stu-id="4a470-874">If you are using hello Storage Client Library, it can automatically handle continuation tokens for you as it returns entities from hello Table service.</span></span> <span data-ttu-id="4a470-875">Hello následující C# ukázka kódu pomocí hello Klientská knihovna pro úložiště automaticky zpracovává pokračování tokeny služby table hello vrátí funkce je v odpovědi:</span><span class="sxs-lookup"><span data-stu-id="4a470-875">hello following C# code sample using hello Storage Client Library automatically handles continuation tokens if hello table service returns them in a response:</span></span>  

```csharp
string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, "Sales");
TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter);

var employees = employeeTable.ExecuteQuery(employeeQuery);
foreach (var emp in employees)
{
        ...
}  
```

<span data-ttu-id="4a470-876">Následující kód C# Hello zpracovává pokračování tokeny explicitně:</span><span class="sxs-lookup"><span data-stu-id="4a470-876">hello following C# code handles continuation tokens explicitly:</span></span>  

```csharp
string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, "Sales");
TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter);

TableContinuationToken continuationToken = null;

do
{
        var employees = employeeTable.ExecuteQuerySegmented(
        employeeQuery, continuationToken);
    foreach (var emp in employees)
    {
    ...
    }
    continuationToken = employees.ContinuationToken;
} while (continuationToken != null);  
```

<span data-ttu-id="4a470-877">Pomocí explicitně pokračování tokenů, můžete řídit, kdy aplikace načítá hello další segment dat.</span><span class="sxs-lookup"><span data-stu-id="4a470-877">By using continuation tokens explicitly, you can control when your application retrieves hello next segment of data.</span></span> <span data-ttu-id="4a470-878">Například pokud klientské aplikace umožňuje uživatelům toopage prostřednictvím hello entity uložené v tabulce, uživatel může rozhodnout není toopage prostřednictvím všechny hello entity načíst dotazem hello tak vaše aplikace použijte pouze pokračování tokenu tooretrieve hello další Segment po hello uživatel měl dokončení stránkování prostřednictvím všechny hello entity v aktuálním segmentu hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-878">For example, if your client application enables users toopage through hello entities stored in a table, a user may decide not toopage through all hello entities retrieved by hello query so your application would only use a continuation token tooretrieve hello next segment when hello user had finished paging through all hello entities in hello current segment.</span></span> <span data-ttu-id="4a470-879">Tento přístup má několik výhod:</span><span class="sxs-lookup"><span data-stu-id="4a470-879">This approach has several benefits:</span></span>  

* <span data-ttu-id="4a470-880">Umožní vám toolimit hello množství dat tooretrieve z hello služby Table a přesunutí přes síť hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-880">It enables you toolimit hello amount of data tooretrieve from hello Table service and that you move over hello network.</span></span>  
* <span data-ttu-id="4a470-881">Umožňuje vám tooperform asynchronní vstupně-výstupní operace v rozhraní .NET.</span><span class="sxs-lookup"><span data-stu-id="4a470-881">It enables you tooperform asynchronous IO in .NET.</span></span>  
* <span data-ttu-id="4a470-882">Umožní vám tooserialize hello pokračovací token toopersistent úložiště, můžete pokračovat v hello události při selhání aplikace.</span><span class="sxs-lookup"><span data-stu-id="4a470-882">It enables you tooserialize hello continuation token toopersistent storage so you can continue in hello event of an application crash.</span></span>  

> [!NOTE]
> <span data-ttu-id="4a470-883">Token pokračování obvykle vrátí segment obsahující 1000 entity, i když může být méně.</span><span class="sxs-lookup"><span data-stu-id="4a470-883">A continuation token typically returns a segment containing 1,000 entities, although it may be fewer.</span></span> <span data-ttu-id="4a470-884">Toto je také hello případ, pokud omezíte hello počet položek dotaz vrátí pomocí **trvat** tooreturn hello první n entit, které odpovídají zadaným kritériím vyhledávání: služby table hello může vrátit segment obsahující méně než n entity podél s tooenable tokenu pokračování je tooretrieve hello zbývající entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-884">This is also hello case if you limit hello number of entries a query returns by using **Take** tooreturn hello first n entities that match your lookup criteria: hello table service may return a segment containing fewer than n entities along with a continuation token tooenable you tooretrieve hello remaining entities.</span></span>  
> 
> 

<span data-ttu-id="4a470-885">Hello následující C# – kód ukazuje, jak toomodify hello počet entit, vrátila uvnitř segment:</span><span class="sxs-lookup"><span data-stu-id="4a470-885">hello following C# code shows how toomodify hello number of entities returned inside a segment:</span></span>  

```csharp
employeeQuery.TakeCount = 50;  
```

#### <a name="server-side-projection"></a><span data-ttu-id="4a470-886">Projekce na straně serveru</span><span class="sxs-lookup"><span data-stu-id="4a470-886">Server-side projection</span></span>
<span data-ttu-id="4a470-887">Jedna entita mají too255 vlastností a být až velikost too1 MB.</span><span class="sxs-lookup"><span data-stu-id="4a470-887">A single entity can have up too255 properties and be up too1 MB in size.</span></span> <span data-ttu-id="4a470-888">Při dotazování tabulky hello a načtení entit, možná nebudete potřebovat všechny vlastnosti hello a zbytečně přenosu dat se můžete vyhnout (toohelp snížit latenci a náklady).</span><span class="sxs-lookup"><span data-stu-id="4a470-888">When you query hello table and retrieve entities, you may not need all hello properties and can avoid transferring data unnecessarily (toohelp reduce latency and cost).</span></span> <span data-ttu-id="4a470-889">Můžete vytvořit serverovou projekce tootransfer jenom hello vlastnosti, které potřebujete.</span><span class="sxs-lookup"><span data-stu-id="4a470-889">You can use server-side projection tootransfer just hello properties you need.</span></span> <span data-ttu-id="4a470-890">Hello následující příklad je právě hello načte **e-mailu** vlastnost (spolu s **PartitionKey**, **RowKey**, **časové razítko**a ** Značka ETag**) z entit hello vybrané dotazem hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-890">hello following example is retrieves just hello **Email** property (along with **PartitionKey**, **RowKey**, **Timestamp**, and **ETag**) from hello entities selected by hello query.</span></span>  

```csharp
string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, "Sales");
List<string> columns = new List<string>() { "Email" };
TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter).Select(columns);

var entities = employeeTable.ExecuteQuery(employeeQuery);
foreach (var e in entities)
{
        Console.WriteLine("RowKey: {0}, EmployeeEmail: {1}", e.RowKey, e.Email);
}  
```

<span data-ttu-id="4a470-891">Všimněte si, jak hello **RowKey** hodnota je k dispozici, přestože nebyl součástí hello seznam tooretrieve vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="4a470-891">Notice how hello **RowKey** value is available even though it was not included in hello list of properties tooretrieve.</span></span>  

### <a name="modifying-entities"></a><span data-ttu-id="4a470-892">Úprava entity</span><span class="sxs-lookup"><span data-stu-id="4a470-892">Modifying entities</span></span>
<span data-ttu-id="4a470-893">Hello Klientská knihovna pro úložiště umožňuje toomodify vaší entity uloží v služby table hello vkládání, odstraňování a aktualizaci entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-893">hello Storage Client Library enables you toomodify your entities stored in hello table service by inserting, deleting, and updating entities.</span></span> <span data-ttu-id="4a470-894">Můžete EGTs toobatch více insert, update a operace odstranění společně tooreduce hello počet zpátečních cest vyžaduje a zlepšit výkon hello vašeho řešení.</span><span class="sxs-lookup"><span data-stu-id="4a470-894">You can use EGTs toobatch multiple insert, update, and delete operations together tooreduce hello number of round trips required and improve hello performance of your solution.</span></span>  

<span data-ttu-id="4a470-895">Mějte na paměti, že výjimky vydané když hello Klientská knihovna pro úložiště provede EGT obvykle zahrnout hello index hello entity, která způsobila, že hello batch toofail.</span><span class="sxs-lookup"><span data-stu-id="4a470-895">Note that exceptions thrown when hello Storage Client Library executes an EGT typically include hello index of hello entity that caused hello batch toofail.</span></span> <span data-ttu-id="4a470-896">To je užitečné při ladění kódu, který používá EGTs.</span><span class="sxs-lookup"><span data-stu-id="4a470-896">This is helpful when you are debugging code that uses EGTs.</span></span>  

<span data-ttu-id="4a470-897">Měli byste také zvážit, jak váš návrh ovlivňuje způsob, jakým klientské aplikace zpracovává operace souběžnosti a aktualizace.</span><span class="sxs-lookup"><span data-stu-id="4a470-897">You should also consider how your design affects how your client application handles concurrency and update operations.</span></span>  

#### <a name="managing-concurrency"></a><span data-ttu-id="4a470-898">Správa souběžnosti</span><span class="sxs-lookup"><span data-stu-id="4a470-898">Managing concurrency</span></span>
<span data-ttu-id="4a470-899">Ve výchozím nastavení, implementuje optimistickou metodu souběžného zpracování kontroluje úrovni hello jednotlivých entit pro služby table hello **vložit**, **sloučení**, a **odstranit** operace, Přestože je možné pro hello tooforce klienta tabulky služby toobypass těchto kontrol.</span><span class="sxs-lookup"><span data-stu-id="4a470-899">By default, hello table service implements optimistic concurrency checks at hello level of individual entities for **Insert**, **Merge**, and **Delete** operations, although it is possible for a client tooforce hello table service toobypass these checks.</span></span> <span data-ttu-id="4a470-900">Další informace o správě služby table hello souběžnosti najdete v tématu [Správa souběžnost v Microsoft Azure Storage](../storage/common/storage-concurrency.md).</span><span class="sxs-lookup"><span data-stu-id="4a470-900">For more information about how hello table service manages concurrency, see  [Managing Concurrency in Microsoft Azure Storage](../storage/common/storage-concurrency.md).</span></span>  

#### <a name="merge-or-replace"></a><span data-ttu-id="4a470-901">Sloučení nebo nahradit</span><span class="sxs-lookup"><span data-stu-id="4a470-901">Merge or replace</span></span>
<span data-ttu-id="4a470-902">Hello **nahradit** metoda hello **TableOperation** třída vždycky nahradí hello úplnou entitu v hello služby Table.</span><span class="sxs-lookup"><span data-stu-id="4a470-902">hello **Replace** method of hello **TableOperation** class always replaces hello complete entity in hello Table service.</span></span> <span data-ttu-id="4a470-903">Pokud nezadáte vlastnost v žádosti o hello tuto vlastnost existuje v entitě hello uložené, žádost hello odebere, vlastnost z hello uložené entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-903">If you do not include a property in hello request when that property exists in hello stored entity, hello request removes that property from hello stored entity.</span></span> <span data-ttu-id="4a470-904">Pokud chcete, aby tooremove vlastnost explicitně z uložené entity, musí obsahovat všech vlastností v žádosti o hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-904">Unless you want tooremove a property explicitly from a stored entity, you must include every property in hello request.</span></span>  

<span data-ttu-id="4a470-905">Můžete použít hello **sloučení** metoda hello **TableOperation** třída tooreduce hello množství dat poslat služby Table toohello když chcete, aby tooupdate entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-905">You can use hello **Merge** method of hello **TableOperation** class tooreduce hello amount of data that you send toohello Table service when you want tooupdate an entity.</span></span> <span data-ttu-id="4a470-906">Hello **sloučení** metoda nahradí všechny vlastnosti v entitě hello uložené hodnoty vlastností z entity hello součástí hello požadavek, ale nechá beze změn ukládat všechny vlastnosti v hello entita, která nejsou zahrnuta v žádosti o hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-906">hello **Merge** method replaces any properties in hello stored entity with property values from hello entity included in hello request, but leaves intact any properties in hello stored entity that are not included in hello request.</span></span> <span data-ttu-id="4a470-907">To je užitečné, pokud máte velké entity a stačí tooupdate malý počet vlastností v požadavku.</span><span class="sxs-lookup"><span data-stu-id="4a470-907">This is useful if you have large entities and only need tooupdate a small number of properties in a request.</span></span>  

> [!NOTE]
> <span data-ttu-id="4a470-908">Hello **nahradit** a **sloučení** metody nezdaří, pokud hello entita neexistuje.</span><span class="sxs-lookup"><span data-stu-id="4a470-908">hello **Replace** and **Merge** methods fail if hello entity does not exist.</span></span> <span data-ttu-id="4a470-909">Jako alternativu, můžete použít hello **InsertOrReplace** a **InsertOrMerge** metody, které vytvářejí nové entity, pokud neexistuje.</span><span class="sxs-lookup"><span data-stu-id="4a470-909">As an alternative, you can use hello **InsertOrReplace** and **InsertOrMerge** methods that create a new entity if it doesn't exist.</span></span>  
> 
> 

### <a name="working-with-heterogeneous-entity-types"></a><span data-ttu-id="4a470-910">Práce s typy heterogenní entit</span><span class="sxs-lookup"><span data-stu-id="4a470-910">Working with heterogeneous entity types</span></span>
<span data-ttu-id="4a470-911">je Hello služby Table *bez schématu* tabulky úložiště, která znamená, že na jednotlivé tabulky můžete ukládat entity více typů poskytuje flexibilitu při návrhu.</span><span class="sxs-lookup"><span data-stu-id="4a470-911">hello Table service is a *schema-less* table store that means that a single table can store entities of multiple types providing great flexibility in your design.</span></span> <span data-ttu-id="4a470-912">Hello následující příklad ilustruje tabulku ukládání zaměstnanců a entity oddělení:</span><span class="sxs-lookup"><span data-stu-id="4a470-912">hello following example illustrates a table storing both employee and department entities:</span></span>  

<table>
<tr>
<th><span data-ttu-id="4a470-913">Klíč oddílu</span><span class="sxs-lookup"><span data-stu-id="4a470-913">PartitionKey</span></span></th>
<th><span data-ttu-id="4a470-914">RowKey</span><span class="sxs-lookup"><span data-stu-id="4a470-914">RowKey</span></span></th>
<th><span data-ttu-id="4a470-915">časové razítko</span><span class="sxs-lookup"><span data-stu-id="4a470-915">Timestamp</span></span></th>
<th></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="4a470-916">FirstName</span><span class="sxs-lookup"><span data-stu-id="4a470-916">FirstName</span></span></th>
<th><span data-ttu-id="4a470-917">Příjmení</span><span class="sxs-lookup"><span data-stu-id="4a470-917">LastName</span></span></th>
<th><span data-ttu-id="4a470-918">Věk</span><span class="sxs-lookup"><span data-stu-id="4a470-918">Age</span></span></th>
<th><span data-ttu-id="4a470-919">E-mail</span><span class="sxs-lookup"><span data-stu-id="4a470-919">Email</span></span></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="4a470-920">FirstName</span><span class="sxs-lookup"><span data-stu-id="4a470-920">FirstName</span></span></th>
<th><span data-ttu-id="4a470-921">Příjmení</span><span class="sxs-lookup"><span data-stu-id="4a470-921">LastName</span></span></th>
<th><span data-ttu-id="4a470-922">Věk</span><span class="sxs-lookup"><span data-stu-id="4a470-922">Age</span></span></th>
<th><span data-ttu-id="4a470-923">E-mail</span><span class="sxs-lookup"><span data-stu-id="4a470-923">Email</span></span></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="4a470-924">DepartmentName</span><span class="sxs-lookup"><span data-stu-id="4a470-924">DepartmentName</span></span></th>
<th><span data-ttu-id="4a470-925">EmployeeCount</span><span class="sxs-lookup"><span data-stu-id="4a470-925">EmployeeCount</span></span></th>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</table>
</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="4a470-926">FirstName</span><span class="sxs-lookup"><span data-stu-id="4a470-926">FirstName</span></span></th>
<th><span data-ttu-id="4a470-927">Příjmení</span><span class="sxs-lookup"><span data-stu-id="4a470-927">LastName</span></span></th>
<th><span data-ttu-id="4a470-928">Věk</span><span class="sxs-lookup"><span data-stu-id="4a470-928">Age</span></span></th>
<th><span data-ttu-id="4a470-929">E-mail</span><span class="sxs-lookup"><span data-stu-id="4a470-929">Email</span></span></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</td>
</tr>
</table>

<span data-ttu-id="4a470-930">Všimněte si, že každá entita musí mít dál **PartitionKey**, **RowKey**, a **časové razítko** hodnoty, ale mohou mít všechny sadu vlastností.</span><span class="sxs-lookup"><span data-stu-id="4a470-930">Note that each entity must still have **PartitionKey**, **RowKey**, and **Timestamp** values, but may have any set of properties.</span></span> <span data-ttu-id="4a470-931">Kromě toho není nic tooindicate hello typ entity nerozhodnete toostore někde tyto informace.</span><span class="sxs-lookup"><span data-stu-id="4a470-931">Furthermore, there is nothing tooindicate hello type of an entity unless you choose toostore that information somewhere.</span></span> <span data-ttu-id="4a470-932">Existují dvě možnosti pro určení typu entity hello:</span><span class="sxs-lookup"><span data-stu-id="4a470-932">There are two options for identifying hello entity type:</span></span>  

* <span data-ttu-id="4a470-933">Předřazení hello entity typu toohello **RowKey** (nebo případně hello **PartitionKey**).</span><span class="sxs-lookup"><span data-stu-id="4a470-933">Prepend hello entity type toohello **RowKey** (or possibly hello **PartitionKey**).</span></span> <span data-ttu-id="4a470-934">Například **EMPLOYEE_000123** nebo **DEPARTMENT_SALES** jako **RowKey** hodnoty.</span><span class="sxs-lookup"><span data-stu-id="4a470-934">For example, **EMPLOYEE_000123** or **DEPARTMENT_SALES** as **RowKey** values.</span></span>  
* <span data-ttu-id="4a470-935">Použijte samostatné toorecord hello entity typ vlastnosti jsou uvedené v tabulce hello níže.</span><span class="sxs-lookup"><span data-stu-id="4a470-935">Use a separate property toorecord hello entity type as shown in hello table below.</span></span>  

<table>
<tr>
<th><span data-ttu-id="4a470-936">Klíč oddílu</span><span class="sxs-lookup"><span data-stu-id="4a470-936">PartitionKey</span></span></th>
<th><span data-ttu-id="4a470-937">RowKey</span><span class="sxs-lookup"><span data-stu-id="4a470-937">RowKey</span></span></th>
<th><span data-ttu-id="4a470-938">časové razítko</span><span class="sxs-lookup"><span data-stu-id="4a470-938">Timestamp</span></span></th>
<th></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="4a470-939">Typ entity</span><span class="sxs-lookup"><span data-stu-id="4a470-939">EntityType</span></span></th>
<th><span data-ttu-id="4a470-940">FirstName</span><span class="sxs-lookup"><span data-stu-id="4a470-940">FirstName</span></span></th>
<th><span data-ttu-id="4a470-941">Příjmení</span><span class="sxs-lookup"><span data-stu-id="4a470-941">LastName</span></span></th>
<th><span data-ttu-id="4a470-942">Věk</span><span class="sxs-lookup"><span data-stu-id="4a470-942">Age</span></span></th>
<th><span data-ttu-id="4a470-943">E-mail</span><span class="sxs-lookup"><span data-stu-id="4a470-943">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="4a470-944">Zaměstnanec</span><span class="sxs-lookup"><span data-stu-id="4a470-944">Employee</span></span></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="4a470-945">Typ entity</span><span class="sxs-lookup"><span data-stu-id="4a470-945">EntityType</span></span></th>
<th><span data-ttu-id="4a470-946">FirstName</span><span class="sxs-lookup"><span data-stu-id="4a470-946">FirstName</span></span></th>
<th><span data-ttu-id="4a470-947">Příjmení</span><span class="sxs-lookup"><span data-stu-id="4a470-947">LastName</span></span></th>
<th><span data-ttu-id="4a470-948">Věk</span><span class="sxs-lookup"><span data-stu-id="4a470-948">Age</span></span></th>
<th><span data-ttu-id="4a470-949">E-mail</span><span class="sxs-lookup"><span data-stu-id="4a470-949">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="4a470-950">Zaměstnanec</span><span class="sxs-lookup"><span data-stu-id="4a470-950">Employee</span></span></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="4a470-951">Typ entity</span><span class="sxs-lookup"><span data-stu-id="4a470-951">EntityType</span></span></th>
<th><span data-ttu-id="4a470-952">DepartmentName</span><span class="sxs-lookup"><span data-stu-id="4a470-952">DepartmentName</span></span></th>
<th><span data-ttu-id="4a470-953">EmployeeCount</span><span class="sxs-lookup"><span data-stu-id="4a470-953">EmployeeCount</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="4a470-954">Oddělení</span><span class="sxs-lookup"><span data-stu-id="4a470-954">Department</span></span></td>
<td></td>
<td></td>
</tr>
</table>
</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="4a470-955">Typ entity</span><span class="sxs-lookup"><span data-stu-id="4a470-955">EntityType</span></span></th>
<th><span data-ttu-id="4a470-956">FirstName</span><span class="sxs-lookup"><span data-stu-id="4a470-956">FirstName</span></span></th>
<th><span data-ttu-id="4a470-957">Příjmení</span><span class="sxs-lookup"><span data-stu-id="4a470-957">LastName</span></span></th>
<th><span data-ttu-id="4a470-958">Věk</span><span class="sxs-lookup"><span data-stu-id="4a470-958">Age</span></span></th>
<th><span data-ttu-id="4a470-959">E-mail</span><span class="sxs-lookup"><span data-stu-id="4a470-959">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="4a470-960">Zaměstnanec</span><span class="sxs-lookup"><span data-stu-id="4a470-960">Employee</span></span></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</td>
</tr>
</table>

<span data-ttu-id="4a470-961">první možnost Hello předřazení hello entity typu toohello **RowKey**, je užitečné, pokud je možné, že dvě entity různých typů pravděpodobně hello stejnou hodnotu klíče.</span><span class="sxs-lookup"><span data-stu-id="4a470-961">hello first option, prepending hello entity type toohello **RowKey**, is useful if there is a possibility that two entities of different types might have hello same key value.</span></span> <span data-ttu-id="4a470-962">Skupiny také entity hello stejný typ společně v oddílu hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-962">It also groups entities of hello same type together in hello partition.</span></span>  

<span data-ttu-id="4a470-963">Hello technik popsaných v této části jsou obzvláště důležité toohello diskusní [vztahy dědičnosti](#inheritance-relationships) výše v tomto průvodci v části hello [modelování vztahů](#modelling-relationships).</span><span class="sxs-lookup"><span data-stu-id="4a470-963">hello techniques discussed in this section are especially relevant toohello discussion [Inheritance relationships](#inheritance-relationships) earlier in this guide in hello section [Modelling relationships](#modelling-relationships).</span></span>  

> [!NOTE]
> <span data-ttu-id="4a470-964">Měli byste zvážit číslo verze hello entity hodnota tooenable klienta aplikace tooevolve objektů POCO objekty typu a práci s různými verzemi.</span><span class="sxs-lookup"><span data-stu-id="4a470-964">You should consider including a version number in hello entity type value tooenable client applications tooevolve POCO objects and work with different versions.</span></span>  
> 
> 

<span data-ttu-id="4a470-965">Hello zbytek Tato část popisuje některé funkce hello v hello Klientská knihovna pro úložiště, které usnadňují práce s více typy entit v hello stejné tabulky.</span><span class="sxs-lookup"><span data-stu-id="4a470-965">hello remainder of this section describes some of hello features in hello Storage Client Library that facilitate working with multiple entity types in hello same table.</span></span>  

#### <a name="retrieving-heterogeneous-entity-types"></a><span data-ttu-id="4a470-966">Načítání typy heterogenní entit</span><span class="sxs-lookup"><span data-stu-id="4a470-966">Retrieving heterogeneous entity types</span></span>
<span data-ttu-id="4a470-967">Pokud používáte hello Klientská knihovna pro úložiště, máte tři možnosti pro práci s více typy entit.</span><span class="sxs-lookup"><span data-stu-id="4a470-967">If you are using hello Storage Client Library, you have three options for working with multiple entity types.</span></span>  

<span data-ttu-id="4a470-968">Pokud znáte hello typ entity hello uložené s konkrétním **RowKey** a **PartitionKey** hodnoty, potom můžete zadat typ entity hello při načtení hello entity, jak je znázorněno v hello předchozí dva příklady který načtení entity typu **EmployeeEntity**: [provádění dotazu bodu pomocí hello Klientská knihovna pro úložiště](#executing-a-point-query-using-the-storage-client-library) a [načítání více entit pomocí LINQ](#retrieving-multiple-entities-using-linq).</span><span class="sxs-lookup"><span data-stu-id="4a470-968">If you know hello type of hello entity stored with a specific **RowKey** and **PartitionKey** values, then you can specify hello entity type when you retrieve hello entity as shown in hello previous two examples that retrieve entities of type **EmployeeEntity**: [Executing a point query using hello Storage Client Library](#executing-a-point-query-using-the-storage-client-library) and [Retrieving multiple entities using LINQ](#retrieving-multiple-entities-using-linq).</span></span>  

<span data-ttu-id="4a470-969">Druhá možnost Hello je toouse hello **DynamicTableEntity** typu (kontejner objektů) namísto konkrétní typ entity objektů POCO (Tato možnost může také zvýšit výkon, protože není bez nutnosti tooserialize a příliš deserializovat hello entity. NET typy).</span><span class="sxs-lookup"><span data-stu-id="4a470-969">hello second option is toouse hello **DynamicTableEntity** type (a property bag) instead of a concrete POCO entity type (this option may also improve performance because there is no need tooserialize and deserialize hello entity too.NET types).</span></span> <span data-ttu-id="4a470-970">načte více entit různých typů z tabulky hello Hello potenciálně následující kód C#, ale vrací všechny entity jako **DynamicTableEntity** instance.</span><span class="sxs-lookup"><span data-stu-id="4a470-970">hello following C# code potentially retrieves multiple entities of different types from hello table, but returns all entities as **DynamicTableEntity** instances.</span></span> <span data-ttu-id="4a470-971">Poté použije hello **EntityType** hello typ vlastnosti toodetermine Každá entita:</span><span class="sxs-lookup"><span data-stu-id="4a470-971">It then uses hello **EntityType** property toodetermine hello type of each entity:</span></span>  

```csharp
string filter = TableQuery.CombineFilters(
    TableQuery.GenerateFilterCondition("PartitionKey",
    QueryComparisons.Equal, "Sales"),
    TableOperators.And,
    TableQuery.CombineFilters(
    TableQuery.GenerateFilterCondition("RowKey",
                    QueryComparisons.GreaterThanOrEqual, "B"),
        TableOperators.And,
        TableQuery.GenerateFilterCondition("RowKey",
        QueryComparisons.LessThan, "F")
    )
);
TableQuery<DynamicTableEntity> entityQuery =
    new TableQuery<DynamicTableEntity>().Where(filter);
var employees = employeeTable.ExecuteQuery(entityQuery);

IEnumerable<DynamicTableEntity> entities = employeeTable.ExecuteQuery(entityQuery);
foreach (var e in entities)
{
EntityProperty entityTypeProperty;
if (e.Properties.TryGetValue("EntityType", out entityTypeProperty))
{
    if (entityTypeProperty.StringValue == "Employee")
    {
        // Use entityTypeProperty, RowKey, PartitionKey, Etag, and Timestamp
        }
    }
}  
```

<span data-ttu-id="4a470-972">Všimněte si, že tooretrieve dalších vlastností, je nutné použít hello **TryGetValue** metodu hello **vlastnosti** vlastnost hello **DynamicTableEntity** třídy.</span><span class="sxs-lookup"><span data-stu-id="4a470-972">Note that tooretrieve other properties you must use hello **TryGetValue** method on hello **Properties** property of hello **DynamicTableEntity** class.</span></span>  

<span data-ttu-id="4a470-973">Třetí možnost je toocombine pomocí hello **DynamicTableEntity** typu a **EntityResolver** instance.</span><span class="sxs-lookup"><span data-stu-id="4a470-973">A third option is toocombine using hello **DynamicTableEntity** type and an **EntityResolver** instance.</span></span> <span data-ttu-id="4a470-974">To vám umožní typy objektů POCO toomultiple tooresolve v hello stejný dotaz.</span><span class="sxs-lookup"><span data-stu-id="4a470-974">This enables you tooresolve toomultiple POCO types in hello same query.</span></span> <span data-ttu-id="4a470-975">V tomto příkladu hello **EntityResolver** delegát používá hello **EntityType** toodistinguish vlastnost mezi hello dva typy entit, které hello dotaz vrací.</span><span class="sxs-lookup"><span data-stu-id="4a470-975">In this example, hello **EntityResolver** delegate is using hello **EntityType** property toodistinguish between hello two types of entity that hello query returns.</span></span> <span data-ttu-id="4a470-976">Hello **vyřešit** metoda používá hello **překladač** delegovat tooresolve **DynamicTableEntity** instance příliš**TableEntity** instance.</span><span class="sxs-lookup"><span data-stu-id="4a470-976">hello **Resolve** method uses hello **resolver** delegate tooresolve **DynamicTableEntity** instances too**TableEntity** instances.</span></span>  

```csharp
EntityResolver<TableEntity> resolver = (pk, rk, ts, props, etag) =>
{

        TableEntity resolvedEntity = null;
        if (props["EntityType"].StringValue == "Department")
        {
        resolvedEntity = new DepartmentEntity();
        }
        else if (props["EntityType"].StringValue == "Employee")
        {
        resolvedEntity = new EmployeeEntity();
        }
        else throw new ArgumentException("Unrecognized entity", "props");

        resolvedEntity.PartitionKey = pk;
        resolvedEntity.RowKey = rk;
        resolvedEntity.Timestamp = ts;
        resolvedEntity.ETag = etag;
        resolvedEntity.ReadEntity(props, null);
        return resolvedEntity;
};

string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, "Sales");
TableQuery<DynamicTableEntity> entityQuery =
        new TableQuery<DynamicTableEntity>().Where(filter);

var entities = employeeTable.ExecuteQuery(entityQuery, resolver);
foreach (var e in entities)
{
        if (e is DepartmentEntity)
        {
    ...
        }
        if (e is EmployeeEntity)
        {
    ...
        }
}  
```

#### <a name="modifying-heterogeneous-entity-types"></a><span data-ttu-id="4a470-977">Úprava typy heterogenní entit</span><span class="sxs-lookup"><span data-stu-id="4a470-977">Modifying heterogeneous entity types</span></span>
<span data-ttu-id="4a470-978">Není nutné tooknow typ hello entity toodelete ho a budete vždy vědět hello typ entity, když vložíte ho.</span><span class="sxs-lookup"><span data-stu-id="4a470-978">You do not need tooknow hello type of an entity toodelete it, and you always know hello type of an entity when you insert it.</span></span> <span data-ttu-id="4a470-979">Můžete však použít **DynamicTableEntity** zadejte tooupdate entity, aniž by věděly, její typ a bez použití třídu entity objektů POCO.</span><span class="sxs-lookup"><span data-stu-id="4a470-979">However, you can use **DynamicTableEntity** type tooupdate an entity without knowing its type and without using a POCO entity class.</span></span> <span data-ttu-id="4a470-980">Hello následující ukázka kódu načte jedné entity a kontroluje hello **EmployeeCount** existuje vlastnost před aktualizací.</span><span class="sxs-lookup"><span data-stu-id="4a470-980">hello following code sample retrieves a single entity, and checks hello **EmployeeCount** property exists before updating it.</span></span>  

```csharp
TableResult result =
        employeeTable.Execute(TableOperation.Retrieve(partitionKey, rowKey));
DynamicTableEntity department = (DynamicTableEntity)result.Result;

EntityProperty countProperty;

if (!department.Properties.TryGetValue("EmployeeCount", out countProperty))
{
        throw new
        InvalidOperationException("Invalid entity, EmployeeCount property not found.");
}
countProperty.Int32Value += 1;
employeeTable.Execute(TableOperation.Merge(department));  
```

### <a name="controlling-access-with-shared-access-signatures"></a><span data-ttu-id="4a470-981">Řízení přístupu s podpisy sdíleného přístupu</span><span class="sxs-lookup"><span data-stu-id="4a470-981">Controlling access with Shared Access Signatures</span></span>
<span data-ttu-id="4a470-982">Můžete použít sdíleného přístupového podpisu (SAS) tokeny tooenable klienta aplikace toomodify (a dotaz) entity tabulky přímo bez hello nutné tooauthenticate přímo s služby table hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-982">You can use Shared Access Signature (SAS) tokens tooenable client applications toomodify (and query) table entities directly without hello need tooauthenticate directly with hello table service.</span></span> <span data-ttu-id="4a470-983">Obvykle jsou tři hlavní výhody toousing SAS ve vaší aplikaci:</span><span class="sxs-lookup"><span data-stu-id="4a470-983">Typically, there are three main benefits toousing SAS in your application:</span></span>  

* <span data-ttu-id="4a470-984">Není nutné toodistribute úložiště účtu klíče tooan nezabezpečené platformy (například mobilní zařízení) v pořadí tooallow tooaccess tohoto zařízení a upravit entity v hello služby Table.</span><span class="sxs-lookup"><span data-stu-id="4a470-984">You do not need toodistribute your storage account key tooan insecure platform (such as a mobile device) in order tooallow that device tooaccess and modify entities in hello Table service.</span></span>  
* <span data-ttu-id="4a470-985">Část práce hello může převzít tento web a rolí pracovního procesu provádět při správě zařízení entity tooclient například koncového uživatele počítače a mobilní zařízení.</span><span class="sxs-lookup"><span data-stu-id="4a470-985">You can offload some of hello work that web and worker roles perform in managing your entities tooclient devices such as end-user computers and mobile devices.</span></span>  
* <span data-ttu-id="4a470-986">Můžete přiřadit omezené a čas omezenou sadu oprávnění tooa klienta (například umožníte přístup jen pro čtení toospecific prostředky).</span><span class="sxs-lookup"><span data-stu-id="4a470-986">You can assign a constrained and time limited set of permissions tooa client (such as allowing read-only access toospecific resources).</span></span>  

<span data-ttu-id="4a470-987">Další informace o používání tokeny SAS s hello služby Table najdete v tématu [pomocí sdíleného přístupového podpisy (SAS)](../storage/common/storage-dotnet-shared-access-signature-part-1.md).</span><span class="sxs-lookup"><span data-stu-id="4a470-987">For more information about using SAS tokens with hello Table service, see [Using Shared Access Signatures (SAS)](../storage/common/storage-dotnet-shared-access-signature-part-1.md).</span></span>  

<span data-ttu-id="4a470-988">Však musí i nadále generovat tokeny hello SAS, která udělují klienta aplikace toohello entity v služby table hello: bude třeba provést v prostředí, které má zabezpečený přístup tooyour klíče účtu úložiště.</span><span class="sxs-lookup"><span data-stu-id="4a470-988">However, you must still generate hello SAS tokens that grant a client application toohello entities in hello table service: you should do this in an environment that has secure access tooyour storage account keys.</span></span> <span data-ttu-id="4a470-989">Obvykle se používá web nebo worker role toogenerate hello SAS tokeny a poskytovat jim toohello klientských aplikací, které potřebují přístup k tooyour entity.</span><span class="sxs-lookup"><span data-stu-id="4a470-989">Typically, you use a web or worker role toogenerate hello SAS tokens and deliver them toohello client applications that need access tooyour entities.</span></span> <span data-ttu-id="4a470-990">Protože je stále režii zahrnutých v generování a doručování tooclients tokeny SAS, měli byste zvážit jak nejlepší tooreduce Tato dodatečná režie, zejména v vysoký počet scénáře.</span><span class="sxs-lookup"><span data-stu-id="4a470-990">Because there is still an overhead involved in generating and delivering SAS tokens tooclients, you should consider how best tooreduce this overhead, especially in high-volume scenarios.</span></span>  

<span data-ttu-id="4a470-991">Je možné toogenerate token SAS, že uděluje přístup k podmnožině tooa hello entity v tabulce.</span><span class="sxs-lookup"><span data-stu-id="4a470-991">It is possible toogenerate a SAS token that grants access tooa subset of hello entities in a table.</span></span> <span data-ttu-id="4a470-992">Ve výchozím nastavení, můžete vytvořit token SAS pro celou tabulku, ale je také možné toospecify této hello SAS token udělení přístupu tooeither a rozsah **PartitionKey** hodnoty nebo celou řadu **PartitionKey** a ** RowKey** hodnoty.</span><span class="sxs-lookup"><span data-stu-id="4a470-992">By default, you create a SAS token for an entire table, but it is also possible toospecify that hello SAS token grant access tooeither a range of **PartitionKey** values, or a range of **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="4a470-993">Můžete vybrat toogenerate tokeny SAS pro jednotlivé uživatele systému tak, aby každý uživatel tokenu SAS pouze umožňuje jim přístup služba table tootheir vlastní entity v hello.</span><span class="sxs-lookup"><span data-stu-id="4a470-993">You might choose toogenerate SAS tokens for individual users of your system such that each user's SAS token only allows them access tootheir own entities in hello table service.</span></span>  

### <a name="asynchronous-and-parallel-operations"></a><span data-ttu-id="4a470-994">Operace asynchronní a paralelní</span><span class="sxs-lookup"><span data-stu-id="4a470-994">Asynchronous and parallel operations</span></span>
<span data-ttu-id="4a470-995">Zadaný své žádosti jsou šíření mezi více oddílů, můžete zlepšit propustnost a klient odezvy pomocí asynchronní nebo paralelní dotazy.</span><span class="sxs-lookup"><span data-stu-id="4a470-995">Provided you are spreading your requests across multiple partitions, you can improve throughput and client responsiveness by using asynchronous or parallel queries.</span></span>
<span data-ttu-id="4a470-996">Například můžete mít dvě nebo více pracovních instance rolí přístup k vaší tabulky paralelně.</span><span class="sxs-lookup"><span data-stu-id="4a470-996">For example, you might have two or more worker role instances accessing your tables in parallel.</span></span> <span data-ttu-id="4a470-997">Může mít jednotlivým pracovním role zodpovědná za konkrétní sady oddílů nebo jednoduše mít více instancí role pracovního procesu, každý schopný tooaccess všechny hello oddílů v tabulce.</span><span class="sxs-lookup"><span data-stu-id="4a470-997">You could have individual worker roles responsible for particular sets of partitions, or simply have multiple worker role instances, each able tooaccess all hello partitions in a table.</span></span>  

<span data-ttu-id="4a470-998">V rámci instanci klienta můžete zlepšit propustnost asynchronně provádění operace úložiště.</span><span class="sxs-lookup"><span data-stu-id="4a470-998">Within a client instance, you can improve throughput by executing storage operations asynchronously.</span></span> <span data-ttu-id="4a470-999">Hello Klientská knihovna pro úložiště umožňuje snadno toowrite asynchronní dotazy a úpravy.</span><span class="sxs-lookup"><span data-stu-id="4a470-999">hello Storage Client Library makes it easy toowrite asynchronous queries and modifications.</span></span> <span data-ttu-id="4a470-1000">Například můžete začít s hello synchronní metoda, která načte všechny hello entit v oddílu, jak je znázorněno v hello následující kód C#:</span><span class="sxs-lookup"><span data-stu-id="4a470-1000">For example, you might start with hello synchronous method that retrieves all hello entities in a partition as shown in hello following C# code:</span></span>  

```csharp
private static void ManyEntitiesQuery(CloudTable employeeTable, string department)
{
        string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, department);
        TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter);

        TableContinuationToken continuationToken = null;

        do
        {
        var employees = employeeTable.ExecuteQuerySegmented(
                employeeQuery, continuationToken);
        foreach (var emp in employees)
    {
        ...
    }
        continuationToken = employees.ContinuationToken;
        } while (continuationToken != null);
}  
```

<span data-ttu-id="4a470-1001">Tento kód můžete snadno upravit, spuštění tohoto dotazu hello asynchronně následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="4a470-1001">You can easily modify this code so that hello query runs asynchronously as follows:</span></span>  

```csharp
private static async Task ManyEntitiesQueryAsync(CloudTable employeeTable, string department)
{
        string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, department);
        TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter);
        TableContinuationToken continuationToken = null;

        do
        {
        var employees = await employeeTable.ExecuteQuerySegmentedAsync(
                employeeQuery, continuationToken);
        foreach (var emp in employees)
        {
            ...
        }
        continuationToken = employees.ContinuationToken;
            } while (continuationToken != null);
}  
```

<span data-ttu-id="4a470-1002">V tomto příkladu asynchronní vidíte hello následující změny z hello synchronní verze:</span><span class="sxs-lookup"><span data-stu-id="4a470-1002">In this asynchronous example, you can see hello following changes from hello synchronous version:</span></span>  

* <span data-ttu-id="4a470-1003">Podpis metody Hello nyní zahrnuje hello **asynchronní** modifikátor a vrátí **úloh** instance.</span><span class="sxs-lookup"><span data-stu-id="4a470-1003">hello method signature now includes hello **async** modifier and returns a **Task** instance.</span></span>  
* <span data-ttu-id="4a470-1004">Místo volání hello **ExecuteSegmented** metoda tooretrieve výsledky, hello metoda nyní volání hello **ExecuteSegmentedAsync** metoda a používá hello **await** – modifikátor tooretrieve výsledků asynchronně.</span><span class="sxs-lookup"><span data-stu-id="4a470-1004">Instead of calling hello **ExecuteSegmented** method tooretrieve results, hello method now calls hello **ExecuteSegmentedAsync** method and uses hello **await** modifier tooretrieve results asynchronously.</span></span>  

<span data-ttu-id="4a470-1005">klientská aplikace Hello tuto metodu můžete volat vícekrát (s různými hodnotami hello **oddělení** parametr), a každý dotaz se spustí na samostatné vlákno.</span><span class="sxs-lookup"><span data-stu-id="4a470-1005">hello client application can call this method multiple times (with different values for hello **department** parameter), and each query will run on a separate thread.</span></span>  

<span data-ttu-id="4a470-1006">Všimněte si, že žádné asynchronní verzi hello **Execute** metoda v hello **TableQuery** třídy protože hello **rozhraní IEnumerable** rozhraní nepodporuje asynchronní výčet.</span><span class="sxs-lookup"><span data-stu-id="4a470-1006">Note that there is no asynchronous version of hello **Execute** method in hello **TableQuery** class because hello **IEnumerable** interface does not support asynchronous enumeration.</span></span>  

<span data-ttu-id="4a470-1007">Můžete také vložit, aktualizovat a odstranit entity asynchronně.</span><span class="sxs-lookup"><span data-stu-id="4a470-1007">You can also insert, update, and delete entities asynchronously.</span></span> <span data-ttu-id="4a470-1008">Hello následující příklad jazyka C# ukazuje jednoduchý, synchronní metoda tooinsert nebo nahrazení entity zaměstnanců:</span><span class="sxs-lookup"><span data-stu-id="4a470-1008">hello following C# example shows a simple, synchronous method tooinsert or replace an employee entity:</span></span>  

```csharp
private static void SimpleEmployeeUpsert(CloudTable employeeTable,
        EmployeeEntity employee)
{
        TableResult result = employeeTable
        .Execute(TableOperation.InsertOrReplace(employee));
        Console.WriteLine("HTTP Status: {0}", result.HttpStatusCode);
}  
```

<span data-ttu-id="4a470-1009">Tento kód můžete snadno upravit tak, aby aktualizace hello asynchronně následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="4a470-1009">You can easily modify this code so that hello update runs asynchronously as follows:</span></span>  

```csharp
private static async Task SimpleEmployeeUpsertAsync(CloudTable employeeTable,
        EmployeeEntity employee)
{
        TableResult result = await employeeTable
        .ExecuteAsync(TableOperation.InsertOrReplace(employee));
        Console.WriteLine("HTTP Status: {0}", result.HttpStatusCode);
}  
```

<span data-ttu-id="4a470-1010">V tomto příkladu asynchronní vidíte hello následující změny z hello synchronní verze:</span><span class="sxs-lookup"><span data-stu-id="4a470-1010">In this asynchronous example, you can see hello following changes from hello synchronous version:</span></span>  

* <span data-ttu-id="4a470-1011">Podpis metody Hello nyní zahrnuje hello **asynchronní** modifikátor a vrátí **úloh** instance.</span><span class="sxs-lookup"><span data-stu-id="4a470-1011">hello method signature now includes hello **async** modifier and returns a **Task** instance.</span></span>  
* <span data-ttu-id="4a470-1012">Místo volání hello **Execute** metoda tooupdate hello entity, hello metoda nyní volání hello **ExecuteAsync** metoda a používá hello **await** tooretrieve – modifikátor asynchronně výsledků.</span><span class="sxs-lookup"><span data-stu-id="4a470-1012">Instead of calling hello **Execute** method tooupdate hello entity, hello method now calls hello **ExecuteAsync** method and uses hello **await** modifier tooretrieve results asynchronously.</span></span>  

<span data-ttu-id="4a470-1013">klientská aplikace Hello můžete volat více asynchronní metody, jako je tato, a každé volání metody se spustí na samostatné vlákno.</span><span class="sxs-lookup"><span data-stu-id="4a470-1013">hello client application can call multiple asynchronous methods like this one, and each method invocation will run on a separate thread.</span></span>  

### <a name="credits"></a><span data-ttu-id="4a470-1014">Kredity</span><span class="sxs-lookup"><span data-stu-id="4a470-1014">Credits</span></span>
<span data-ttu-id="4a470-1015">Rádi bychom znali toothank hello následující členy hello tým Azure pro jejich příspěvky: Dominic Betts, Jason Hogg, Jean Ghanem, Jai Haridas, Jeff Yields, Vamshidhar Kommineni, Vinay Shaha a Serdar Ozler stejně jako tní Hollander z Microsoft DX.</span><span class="sxs-lookup"><span data-stu-id="4a470-1015">We would like toothank hello following members of hello Azure team for their contributions: Dominic Betts, Jason Hogg, Jean Ghanem, Jai Haridas, Jeff Irwin, Vamshidhar Kommineni, Vinay Shah and Serdar Ozler as well as  Tom Hollander from Microsoft DX.</span></span> 

<span data-ttu-id="4a470-1016">Rádi bychom znali také toothank hello následující Microsoft MVP pro jejich cenné zpětné vazby během zkontrolujte cykly: Igor Papirov a Edward Bakker.</span><span class="sxs-lookup"><span data-stu-id="4a470-1016">We would also like toothank hello following Microsoft MVP's for their valuable feedback during review cycles: Igor Papirov and Edward Bakker.</span></span>

[1]: ./media/storage-table-design-guide/storage-table-design-IMAGE01.png
[2]: ./media/storage-table-design-guide/storage-table-design-IMAGE02.png
[3]: ./media/storage-table-design-guide/storage-table-design-IMAGE03.png
[4]: ./media/storage-table-design-guide/storage-table-design-IMAGE04.png
[5]: ./media/storage-table-design-guide/storage-table-design-IMAGE05.png
[6]: ./media/storage-table-design-guide/storage-table-design-IMAGE06.png
[7]: ./media/storage-table-design-guide/storage-table-design-IMAGE07.png
[8]: ./media/storage-table-design-guide/storage-table-design-IMAGE08.png
[9]: ./media/storage-table-design-guide/storage-table-design-IMAGE09.png
[10]: ./media/storage-table-design-guide/storage-table-design-IMAGE10.png
[11]: ./media/storage-table-design-guide/storage-table-design-IMAGE11.png
[12]: ./media/storage-table-design-guide/storage-table-design-IMAGE12.png
[13]: ./media/storage-table-design-guide/storage-table-design-IMAGE13.png
[14]: ./media/storage-table-design-guide/storage-table-design-IMAGE14.png
[15]: ./media/storage-table-design-guide/storage-table-design-IMAGE15.png
[16]: ./media/storage-table-design-guide/storage-table-design-IMAGE16.png
[17]: ./media/storage-table-design-guide/storage-table-design-IMAGE17.png
[18]: ./media/storage-table-design-guide/storage-table-design-IMAGE18.png
[19]: ./media/storage-table-design-guide/storage-table-design-IMAGE19.png
[20]: ./media/storage-table-design-guide/storage-table-design-IMAGE20.png
[21]: ./media/storage-table-design-guide/storage-table-design-IMAGE21.png
[22]: ./media/storage-table-design-guide/storage-table-design-IMAGE22.png
[23]: ./media/storage-table-design-guide/storage-table-design-IMAGE23.png
[24]: ./media/storage-table-design-guide/storage-table-design-IMAGE24.png
[25]: ./media/storage-table-design-guide/storage-table-design-IMAGE25.png
[26]: ./media/storage-table-design-guide/storage-table-design-IMAGE26.png
[27]: ./media/storage-table-design-guide/storage-table-design-IMAGE27.png
[28]: ./media/storage-table-design-guide/storage-table-design-IMAGE28.png
[29]: ./media/storage-table-design-guide/storage-table-design-IMAGE29.png

