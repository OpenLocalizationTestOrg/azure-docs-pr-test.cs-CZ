---
title: "aaaDeploy sady Azure IoT Suite připojen objekt pro vytváření brány | Microsoft Docs"
description: "Jak toodeploy brány na systému Windows nebo Linux toohello připojení tooenable připojen objekt pro vytváření předkonfigurovaného řešení."
services: 
suite: iot-suite
documentationcenter: na
author: dominicbetts
manager: timlt
editor: 
ms.service: iot-suite
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 07/24/2017
ms.author: dobett
ms.openlocfilehash: 72436dec60eda0de20143f362fe740b0c4412f36
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="deploy-a-gateway-on-windows-or-linux-for-hello-connected-factory-preconfigured-solution"></a><span data-ttu-id="997d9-103">Nasazení brány v systému Windows nebo Linux hello připojen objekt pro vytváření předkonfigurovaného řešení</span><span class="sxs-lookup"><span data-stu-id="997d9-103">Deploy a gateway on Windows or Linux for hello connected factory preconfigured solution</span></span>

<span data-ttu-id="997d9-104">Hello softwaru požadované toodeploy a brány pro objekt pro vytváření předkonfigurovaného řešení hello připojené má dvě součásti:</span><span class="sxs-lookup"><span data-stu-id="997d9-104">hello software required toodeploy a gateway for hello connected factory preconfigured solution has two components:</span></span>

* <span data-ttu-id="997d9-105">Hello *OPC Proxy* vytváří tooIoT připojení rozbočovače.</span><span class="sxs-lookup"><span data-stu-id="997d9-105">hello *OPC Proxy* establishes a connection tooIoT Hub.</span></span> <span data-ttu-id="997d9-106">Hello *OPC Proxy* potom počká pro příkazy a ovládání zprávy z hello integrované OPC prohlížeč, který běží v portálu řešení připojených factory hello.</span><span class="sxs-lookup"><span data-stu-id="997d9-106">hello *OPC Proxy* then waits for command and control messages from hello integrated OPC Browser that runs in hello connected factory solution portal.</span></span>
* <span data-ttu-id="997d9-107">Hello *OPC vydavatele* připojí tooexisting místní OPC UA servery a předává telemetrické zprávy z nich tooIoT rozbočovače.</span><span class="sxs-lookup"><span data-stu-id="997d9-107">hello *OPC Publisher* connects tooexisting on-premises OPC UA servers and forwards telemetry messages from them tooIoT Hub.</span></span>

<span data-ttu-id="997d9-108">Obě součásti jsou open source a jsou k dispozici jako zdroj na Githubu a jako kontejnery Docker:</span><span class="sxs-lookup"><span data-stu-id="997d9-108">Both components are open-source and are available as source on GitHub and as Docker containers:</span></span>

| <span data-ttu-id="997d9-109">GitHubu</span><span class="sxs-lookup"><span data-stu-id="997d9-109">GitHub</span></span> | <span data-ttu-id="997d9-110">DockerHub</span><span class="sxs-lookup"><span data-stu-id="997d9-110">DockerHub</span></span> |
| ------ | --------- |
| <span data-ttu-id="997d9-111">[Vydavatel OPC][lnk-publisher-github]</span><span class="sxs-lookup"><span data-stu-id="997d9-111">[OPC Publisher][lnk-publisher-github]</span></span> | <span data-ttu-id="997d9-112">[Vydavatel OPC][lnk-publisher-docker]</span><span class="sxs-lookup"><span data-stu-id="997d9-112">[OPC Publisher][lnk-publisher-docker]</span></span> |
| <span data-ttu-id="997d9-113">[OPC Proxy][lnk-proxy-github]</span><span class="sxs-lookup"><span data-stu-id="997d9-113">[OPC Proxy][lnk-proxy-github]</span></span> | <span data-ttu-id="997d9-114">[OPC Proxy][lnk-proxy-docker]</span><span class="sxs-lookup"><span data-stu-id="997d9-114">[OPC Proxy][lnk-proxy-docker]</span></span> |

<span data-ttu-id="997d9-115">Žádné veřejnou IP adresu nebo díry ve hello brány firewall jsou požadovány pro žádné komponenty.</span><span class="sxs-lookup"><span data-stu-id="997d9-115">No public-facing IP address or holes in hello gateway firewall are required for either component.</span></span> <span data-ttu-id="997d9-116">Hello OPC Proxy a OPC vydavatele používat pouze odchozí porty 443 a 5671, 8883.</span><span class="sxs-lookup"><span data-stu-id="997d9-116">hello OPC Proxy and OPC Publisher use only outbound ports 443, 5671, and 8883.</span></span>

<span data-ttu-id="997d9-117">Hello kroky v tomto článku vám ukážou, jak toodeploy a bránu pomocí Docker na buď [Windows](#windows-deployment) nebo [Linux](#linux-deployment).</span><span class="sxs-lookup"><span data-stu-id="997d9-117">hello steps in this article show you how toodeploy a gateway using Docker on either [Windows](#windows-deployment) or [Linux](#linux-deployment).</span></span> <span data-ttu-id="997d9-118">Brána Hello umožňuje připojení k připojené toohello objekt pro vytváření předkonfigurovaného řešení.</span><span class="sxs-lookup"><span data-stu-id="997d9-118">hello gateway enables connectivity toohello connected factory preconfigured solution.</span></span>

> [!NOTE]
> <span data-ttu-id="997d9-119">Hello brány software, který běží v kontejner Docker hello [Azure IoT Edge].</span><span class="sxs-lookup"><span data-stu-id="997d9-119">hello gateway software that runs in hello Docker container is [Azure IoT Edge].</span></span>

## <a name="windows-deployment"></a><span data-ttu-id="997d9-120">Nasazení systému Windows</span><span class="sxs-lookup"><span data-stu-id="997d9-120">Windows deployment</span></span>

> [!NOTE]
> <span data-ttu-id="997d9-121">Pokud ještě nemáte zařízení brány, Microsoft doporučuje že zakoupit komerční brány na jednom z našich partnerů.</span><span class="sxs-lookup"><span data-stu-id="997d9-121">If you don't yet have a gateway device, Microsoft recommends you buy a commercial gateway from one of our partners.</span></span> <span data-ttu-id="997d9-122">Navštivte hello [katalogu zařízení Azure IoT] seznam zařízení brány, které jsou kompatibilní s hello připojeného objektu pro vytváření řešení.</span><span class="sxs-lookup"><span data-stu-id="997d9-122">Visit hello [Azure IoT device catalog] for a list of gateway devices compatible with hello connected factory solution.</span></span> <span data-ttu-id="997d9-123">Postupujte podle pokynů hello, které jsou součástí hello zařízení tooset bránu hello.</span><span class="sxs-lookup"><span data-stu-id="997d9-123">Follow hello instructions that come with hello device tooset up hello gateway.</span></span> <span data-ttu-id="997d9-124">Můžete taky použijte následující pokyny toomanually nastavení jedné z vašich bran existující hello.</span><span class="sxs-lookup"><span data-stu-id="997d9-124">Alternatively, use hello following instructions toomanually set up one of your existing gateways.</span></span>

### <a name="install-docker"></a><span data-ttu-id="997d9-125">Nainstalujte Docker</span><span class="sxs-lookup"><span data-stu-id="997d9-125">Install Docker</span></span>

<span data-ttu-id="997d9-126">Nainstalujte [Docker pro systém Windows] na zařízení brány se systémem Windows.</span><span class="sxs-lookup"><span data-stu-id="997d9-126">Install [Docker for Windows] on your Windows-based gateway device.</span></span> <span data-ttu-id="997d9-127">Během instalace systému Windows Docker vyberte jednotku na váš počítač tooshare hostitele s Docker.</span><span class="sxs-lookup"><span data-stu-id="997d9-127">During Windows Docker setup, select a drive on your host machine tooshare with Docker.</span></span> <span data-ttu-id="997d9-128">Následující snímek obrazovky ukazuje sdílení hello D jednotky v systému Windows Hello:</span><span class="sxs-lookup"><span data-stu-id="997d9-128">hello following screenshot shows sharing hello D drive on your Windows system:</span></span>

![Nainstalujte Docker][img-install-docker]

<span data-ttu-id="997d9-130">Pak vytvořte složku s názvem **docker** hello kořenové hello sdílené jednotky.</span><span class="sxs-lookup"><span data-stu-id="997d9-130">Then create a folder called **docker** in hello root of hello shared drive.</span></span>
<span data-ttu-id="997d9-131">Můžete také provést tento krok po instalaci docker z hello **nastavení** nabídky.</span><span class="sxs-lookup"><span data-stu-id="997d9-131">You can also perform this step after installing docker from hello **Settings** menu.</span></span>

### <a name="configure-hello-gateway"></a><span data-ttu-id="997d9-132">Konfigurace brány hello</span><span class="sxs-lookup"><span data-stu-id="997d9-132">Configure hello gateway</span></span>

1. <span data-ttu-id="997d9-133">Je třeba hello **iothubowner** připojovací řetězec sady Azure IoT Suite připojen objekt pro vytváření nasazení toocomplete hello brány nasazení.</span><span class="sxs-lookup"><span data-stu-id="997d9-133">You need hello **iothubowner** connection string of your Azure IoT Suite connected factory deployment toocomplete hello gateway deployment.</span></span> <span data-ttu-id="997d9-134">V hello [portál Azure], přejděte tooyour IoT Hub ve skupině prostředků hello vytvořili při nasazení hello připojen objekt pro vytváření řešení.</span><span class="sxs-lookup"><span data-stu-id="997d9-134">In hello [Azure portal], navigate tooyour IoT Hub in hello resource group created when you deployed hello connected factory solution.</span></span> <span data-ttu-id="997d9-135">Klikněte na tlačítko **zásady sdíleného přístupu** tooaccess hello **iothubowner** připojovací řetězec:</span><span class="sxs-lookup"><span data-stu-id="997d9-135">Click **Shared access policies** tooaccess hello **iothubowner** connection string:</span></span>

    ![Najde hello připojovací řetězec služby IoT Hub][img-hub-connection]

    <span data-ttu-id="997d9-137">Kopírování hello **připojovací řetězec – primární klíč** hodnotu.</span><span class="sxs-lookup"><span data-stu-id="997d9-137">Copy hello **Connection string--primary key** value.</span></span>

1. <span data-ttu-id="997d9-138">Konfigurace brány hello služby IoT hub spuštěním hello dvě brány moduly **po** z příkazového řádku pomocí:</span><span class="sxs-lookup"><span data-stu-id="997d9-138">Configure hello gateway for your IoT Hub by running hello two gateway modules **once** from a command prompt with:</span></span>

    `docker run -it --rm -h <ApplicationName> -v //D/docker:/build/src/GatewayApp.NetCore/bin/Debug/netcoreapp1.0/publish/CertificateStores -v //D/docker:/root/.dotnet/corefx/cryptography/x509stores microsoft/iot-gateway-opc-ua:1.0.0 <ApplicationName> "<IoTHubOwnerConnectionString>"`

    `docker run -it --rm -v //D/docker:/mapped microsoft/iot-gateway-opc-ua-proxy:0.1.3 -i -c "<IoTHubOwnerConnectionString>" -D /mapped/cs.db`

    * <span data-ttu-id="997d9-139">**&lt;ApplicationName&gt;**  je hello název toogive tooyour OPC UA vydavatele ve formátu hello **vydavatele.&lt; váš plně kvalifikovaný název domény&gt;**.</span><span class="sxs-lookup"><span data-stu-id="997d9-139">**&lt;ApplicationName&gt;** is hello name toogive tooyour OPC UA Publisher in hello format **publisher.&lt;your fully qualified domain name&gt;**.</span></span> <span data-ttu-id="997d9-140">Například, pokud objekt pro vytváření sítě se nazývá **myfactorynetwork.com**, hello **ApplicationName** hodnota je **publisher.myfactorynetwork.com**.</span><span class="sxs-lookup"><span data-stu-id="997d9-140">For example, if your factory network is called **myfactorynetwork.com**, hello **ApplicationName** value is **publisher.myfactorynetwork.com**.</span></span>
    * <span data-ttu-id="997d9-141">**&lt;IoTHubOwnerConnectionString&gt;**  je hello **iothubowner** připojovacího řetězce, které jste zkopírovali v předchozím kroku hello.</span><span class="sxs-lookup"><span data-stu-id="997d9-141">**&lt;IoTHubOwnerConnectionString&gt;** is hello **iothubowner** connection string you copied in hello previous step.</span></span> <span data-ttu-id="997d9-142">Tento připojovací řetězec se používá pouze v tomto kroku, nebudete ho potřebovat v hello následující kroky:</span><span class="sxs-lookup"><span data-stu-id="997d9-142">This connection string is only used in this step, you don’t need it in hello following steps:</span></span>

    <span data-ttu-id="997d9-143">Používáte hello namapované D:\\docker složky (hello `-v` argument) novější toopersist hello hello brány modulů použít dva certifikáty X.509.</span><span class="sxs-lookup"><span data-stu-id="997d9-143">You use hello mapped D:\\docker folder (hello `-v` argument) later toopersist hello two X.509 certificates that hello gateway modules use.</span></span>

### <a name="run-hello-gateway"></a><span data-ttu-id="997d9-144">Spustit bránu hello</span><span class="sxs-lookup"><span data-stu-id="997d9-144">Run hello gateway</span></span>

1. <span data-ttu-id="997d9-145">Restartujte bránu hello pomocí hello následující příkazy:</span><span class="sxs-lookup"><span data-stu-id="997d9-145">Restart hello gateway using hello following commands:</span></span>

    `docker run -it --rm -h <ApplicationName> --expose 62222 -p 62222:62222 -v //D/docker:/build/src/GatewayApp.NetCore/bin/Debug/netcoreapp1.0/publish/Logs -v //D/docker:/build/src/GatewayApp.NetCore/bin/Debug/netcoreapp1.0/publish/CertificateStores -v //D/docker:/shared -v //D/docker:/root/.dotnet/corefx/cryptography/x509stores -e _GW_PNFP="/shared/publishednodes.JSON" microsoft/iot-gateway-opc-ua:1.0.0 <ApplicationName>`

    `docker run -it --rm -v //D/docker:/mapped microsoft/iot-gateway-opc-ua-proxy:0.1.3 -D /mapped/cs.db`

1. <span data-ttu-id="997d9-146">Z bezpečnostních důvodů hello dva certifikáty X.509 uchovávané v hello D:\\docker složka obsahovat hello privátní klíč.</span><span class="sxs-lookup"><span data-stu-id="997d9-146">For security reasons, hello two X.509 certificates persisted in hello D:\\docker folder contain hello private key.</span></span> <span data-ttu-id="997d9-147">Omezit přístup toothis složky toohello pověření (obvykle **správci**) použijete kontejner Docker toorun hello.</span><span class="sxs-lookup"><span data-stu-id="997d9-147">Limit access toothis folder toohello credentials (typically **Administrators**) you use toorun hello Docker container.</span></span> <span data-ttu-id="997d9-148">Klikněte pravým tlačítkem na hello D:\\docker složky, vyberte **vlastnosti**, pak **zabezpečení**a potom **upravit**.</span><span class="sxs-lookup"><span data-stu-id="997d9-148">Right-click hello D:\\docker folder, choose **Properties**, then **Security**, and then **Edit**.</span></span> <span data-ttu-id="997d9-149">Poskytnout **správci** úplné řízení a odeberte všechny ostatní:</span><span class="sxs-lookup"><span data-stu-id="997d9-149">Give **Administrators** full control and remove everyone else:</span></span>

    ![Udělení oprávnění tooDocker sdílené složky][img-docker-share]

1. <span data-ttu-id="997d9-151">Ověřte připojení k síti.</span><span class="sxs-lookup"><span data-stu-id="997d9-151">Verify network connectivity.</span></span> <span data-ttu-id="997d9-152">Z příkazového řádku, zadejte příkaz hello `ping publisher.<your fully qualified domain name>` tooping bránu.</span><span class="sxs-lookup"><span data-stu-id="997d9-152">From a command prompt, enter hello command `ping publisher.<your fully qualified domain name>` tooping your gateway.</span></span> <span data-ttu-id="997d9-153">Pokud hello cíl nedostupný, přidejte hello IP adresu a název souboru hostitelů toohello brány na bránu.</span><span class="sxs-lookup"><span data-stu-id="997d9-153">If hello destination is unreachable, add hello IP address and name of your gateway toohello hosts file on your gateway.</span></span> <span data-ttu-id="997d9-154">soubor hosts Hello nachází v hello **Windows\\System32\\ovladače\\atd** složky.</span><span class="sxs-lookup"><span data-stu-id="997d9-154">hello hosts file is located in hello **Windows\\System32\\drivers\\etc** folder.</span></span>

1. <span data-ttu-id="997d9-155">Zkuste tooconnect toohello vydavateli pomocí místního klienta OPC UA systémem hello brány.</span><span class="sxs-lookup"><span data-stu-id="997d9-155">Next, try tooconnect toohello publisher using a local OPC UA client running on hello gateway.</span></span> <span data-ttu-id="997d9-156">Hello OPC UA koncový bod je adresa URL `opc.tcp://publisher.<your fully qualified domain name>:62222`.</span><span class="sxs-lookup"><span data-stu-id="997d9-156">hello OPC UA endpoint URL is `opc.tcp://publisher.<your fully qualified domain name>:62222`.</span></span> <span data-ttu-id="997d9-157">Pokud nemáte klientem OPC UA, můžete stáhnout a použít [open-source OPC UA klienta].</span><span class="sxs-lookup"><span data-stu-id="997d9-157">If you don't have an OPC UA client, you can download and use an [open-source OPC UA client].</span></span>

1. <span data-ttu-id="997d9-158">Po úspěšném dokončení tyto místní testy procházet toohello **připojit vlastní OPC UA Server** stránku hello připojené vytváření řešení portálu.</span><span class="sxs-lookup"><span data-stu-id="997d9-158">When you have successfully completed these local tests, browse toohello **Connect your own OPC UA Server** page in hello connected factory solution portal.</span></span> <span data-ttu-id="997d9-159">Zadejte adresu URL koncového bodu vydavatele hello (`tcp://publisher.<your fully qualified domain name>:62222`) a klikněte na tlačítko **Connect**.</span><span class="sxs-lookup"><span data-stu-id="997d9-159">Enter hello publisher endpoint URL (`tcp://publisher.<your fully qualified domain name>:62222`) and click **Connect**.</span></span> <span data-ttu-id="997d9-160">Získat varování týkající se certifikátu a potom klikněte na **pokračovat.**</span><span class="sxs-lookup"><span data-stu-id="997d9-160">You get a certificate warning, then click **Proceed.**</span></span> <span data-ttu-id="997d9-161">Další dojde k chybě této hello vydavatel není důvěřovat hello uživatelský Agent webového klienta.</span><span class="sxs-lookup"><span data-stu-id="997d9-161">Next you get an error that hello publisher doesn’t trust hello UA Web Client.</span></span> <span data-ttu-id="997d9-162">tooresolve tato chyba, kopie hello **uživatelský Agent webového klienta** certifikát z hello **D:\\docker\\odmítl certifikáty\\certifikátů** složky toohello **D:\\docker\\uživatelský Agent aplikace\\certifikátů** složky na hello brány.</span><span class="sxs-lookup"><span data-stu-id="997d9-162">tooresolve this error, copy hello **UA Web Client** certificate from hello **D:\\docker\\Rejected Certificates\\certs** folder toohello **D:\\docker\\UA Applications\\certs** folder on hello gateway.</span></span> <span data-ttu-id="997d9-163">Není nutné toorestart hello brány.</span><span class="sxs-lookup"><span data-stu-id="997d9-163">You do not need toorestart of hello gateway.</span></span> <span data-ttu-id="997d9-164">Tento krok opakujte.</span><span class="sxs-lookup"><span data-stu-id="997d9-164">Repeat this step.</span></span> <span data-ttu-id="997d9-165">Nyní můžete přihlásit toohello brány z cloudu hello a jsou připravené tooadd OPC UA servery toohello řešení.</span><span class="sxs-lookup"><span data-stu-id="997d9-165">You can now connect toohello gateway from hello cloud, and you are ready tooadd OPC UA servers toohello solution.</span></span>

### <a name="add-your-opc-ua-servers"></a><span data-ttu-id="997d9-166">Přidání serverů OPC UA</span><span class="sxs-lookup"><span data-stu-id="997d9-166">Add your OPC UA servers</span></span>

1. <span data-ttu-id="997d9-167">Procházet toohello **připojit vlastní OPC UA Server** stránku hello připojené vytváření řešení portálu.</span><span class="sxs-lookup"><span data-stu-id="997d9-167">Browse toohello **Connect your own OPC UA Server** page in hello connected factory solution portal.</span></span> <span data-ttu-id="997d9-168">Postupujte podle kroků stejná jako v předcházející části tooestablish hello vztah důvěryhodnosti mezi hello připojené factory portál a hello OPC UA server hello.</span><span class="sxs-lookup"><span data-stu-id="997d9-168">Follow hello same steps as in hello preceding section tooestablish trust between hello connected factory portal and hello OPC UA server.</span></span> <span data-ttu-id="997d9-169">Tento krok sestavuje vzájemné důvěryhodnosti hello certifikátů hello připojené portal objekt pro vytváření a hello OPC UA serveru a vytvoří připojení.</span><span class="sxs-lookup"><span data-stu-id="997d9-169">This step establishes a mutual trust of hello certificates from hello connected factory portal and hello OPC UA server and creates a connection.</span></span>

1. <span data-ttu-id="997d9-170">Procházet hello OPC UA uzlů stromu OPC UA serveru, klikněte pravým tlačítkem na hello OPC uzly a vyberte **publikování**.</span><span class="sxs-lookup"><span data-stu-id="997d9-170">Browse hello OPC UA nodes tree of your OPC UA server, right-click hello OPC nodes, and select **publish**.</span></span> <span data-ttu-id="997d9-171">Pro publikování toowork tímto způsobem, hello OPC UA serveru a hello vydavatele musí být na hello stejné síti.</span><span class="sxs-lookup"><span data-stu-id="997d9-171">For publishing toowork this way, hello OPC UA server and hello publisher must be on hello same network.</span></span> <span data-ttu-id="997d9-172">Jinými slovy, pokud hello plně kvalifikovaný název domény hello vydavatele je **publisher.mydomain.com** pak hello plně kvalifikovaný název domény musí být server OPC UA, například hello **myopcuaserver.mydomain.com**. Pokud vaše instalace se liší, můžete ručně přidat uzly toohello publishesnodes.json soubor ve hello **D:\\docker** složky.</span><span class="sxs-lookup"><span data-stu-id="997d9-172">In other words, if hello fully qualified domain name of hello publisher is **publisher.mydomain.com** then hello fully qualified domain name of hello OPC UA server must be, for example, **myopcuaserver.mydomain.com**. If your setup is different, you can manually add nodes toohello publishesnodes.json file found in hello **D:\\docker** folder.</span></span> <span data-ttu-id="997d9-173">Hello publishesnodes.json souboru se automaticky vygeneroval na hello nejprve úspěšné publikování OPC uzlu.</span><span class="sxs-lookup"><span data-stu-id="997d9-173">hello publishesnodes.json file is automatically generated on hello first successful publish of an OPC node.</span></span>

1. <span data-ttu-id="997d9-174">Telemetrická data jsou nyní z hello zařízení brány.</span><span class="sxs-lookup"><span data-stu-id="997d9-174">Telemetry now flows from hello gateway device.</span></span> <span data-ttu-id="997d9-175">Hello telemetrie si můžete prohlédnout v hello **umístění objektu pro vytváření** zobrazení hello připojené factory portálu pod **nový objekt pro vytváření**.</span><span class="sxs-lookup"><span data-stu-id="997d9-175">You can view hello telemetry in hello **Factory Locations** view of hello connected factory portal under **New Factory**.</span></span>

## <a name="linux-deployment"></a><span data-ttu-id="997d9-176">Linux nasazení</span><span class="sxs-lookup"><span data-stu-id="997d9-176">Linux deployment</span></span>

> [!NOTE]
> <span data-ttu-id="997d9-177">Pokud ještě nemáte zařízení brány, Microsoft doporučuje že zakoupit komerční brány na jednom z našich partnerů.</span><span class="sxs-lookup"><span data-stu-id="997d9-177">If you don't yet have a gateway device, Microsoft recommends you buy a commercial gateway from one of our partners.</span></span> <span data-ttu-id="997d9-178">Navštivte hello [katalogu zařízení Azure IoT] seznam zařízení brány, které jsou kompatibilní s hello připojeného objektu pro vytváření řešení.</span><span class="sxs-lookup"><span data-stu-id="997d9-178">Visit hello [Azure IoT device catalog] for a list of gateway devices compatible with hello connected factory solution.</span></span> <span data-ttu-id="997d9-179">Postupujte podle pokynů hello, které jsou součástí hello zařízení tooset bránu hello.</span><span class="sxs-lookup"><span data-stu-id="997d9-179">Follow hello instructions that come with hello device tooset up hello gateway.</span></span> <span data-ttu-id="997d9-180">Můžete taky použijte následující pokyny toomanually nastavení jedné z vašich bran existující hello.</span><span class="sxs-lookup"><span data-stu-id="997d9-180">Alternatively, use hello following instructions toomanually set up one of your existing gateways.</span></span>

<span data-ttu-id="997d9-181">[Nainstalujte Docker] na vaše zařízení brány Linux.</span><span class="sxs-lookup"><span data-stu-id="997d9-181">[Install Docker] on your Linux gateway device.</span></span>

### <a name="configure-hello-gateway"></a><span data-ttu-id="997d9-182">Konfigurace brány hello</span><span class="sxs-lookup"><span data-stu-id="997d9-182">Configure hello gateway</span></span>

1. <span data-ttu-id="997d9-183">Je třeba hello **iothubowner** připojovací řetězec sady Azure IoT Suite připojen objekt pro vytváření nasazení toocomplete hello brány nasazení.</span><span class="sxs-lookup"><span data-stu-id="997d9-183">You need hello **iothubowner** connection string of your Azure IoT Suite connected factory deployment toocomplete hello gateway deployment.</span></span> <span data-ttu-id="997d9-184">V hello [portál Azure], přejděte tooyour IoT Hub ve skupině prostředků hello vytvořili při nasazení hello připojen objekt pro vytváření řešení.</span><span class="sxs-lookup"><span data-stu-id="997d9-184">In hello [Azure portal], navigate tooyour IoT Hub in hello resource group created when you deployed hello connected factory solution.</span></span> <span data-ttu-id="997d9-185">Klikněte na tlačítko **zásady sdíleného přístupu** tooaccess hello **iothubowner** připojovací řetězec:</span><span class="sxs-lookup"><span data-stu-id="997d9-185">Click **Shared access policies** tooaccess hello **iothubowner** connection string:</span></span>

    ![Najde hello připojovací řetězec služby IoT Hub][img-hub-connection]

    <span data-ttu-id="997d9-187">Kopírování hello **připojovací řetězec – primární klíč** hodnotu.</span><span class="sxs-lookup"><span data-stu-id="997d9-187">Copy hello **Connection string--primary key** value.</span></span>

1. <span data-ttu-id="997d9-188">Konfigurace brány hello služby IoT hub spuštěním hello dvě brány moduly **po** z prostředí s:</span><span class="sxs-lookup"><span data-stu-id="997d9-188">Configure hello gateway for your IoT Hub by running hello two gateway modules **once** from a shell with:</span></span>

    `sudo docker run -it --rm -h <ApplicationName> -v /shared:/build/src/GatewayApp.NetCore/bin/Debug/netcoreapp1.0/publish/ -v /shared:/root/.dotnet/corefx/cryptography/x509stores microsoft/iot-gateway-opc-ua:1.0.0 <ApplicationName> "<IoTHubOwnerConnectionString>"`

    `sudo docker run --rm -it -v /shared:/mapped microsoft/iot-gateway-opc-ua-proxy:0.1.3 -i -c "<IoTHubOwnerConnectionString>" -D /mapped/cs.db`

    * <span data-ttu-id="997d9-189">**&lt;ApplicationName&gt;**  je název hello hello OPC UA aplikace hello brány vytvoří ve formátu hello **vydavatele.&lt; váš plně kvalifikovaný název domény&gt;**.</span><span class="sxs-lookup"><span data-stu-id="997d9-189">**&lt;ApplicationName&gt;** is hello name of hello OPC UA application hello gateway creates in hello format **publisher.&lt;your fully qualified domain name&gt;**.</span></span> <span data-ttu-id="997d9-190">Například **publisher.microsoft.com**.</span><span class="sxs-lookup"><span data-stu-id="997d9-190">For example, **publisher.microsoft.com**.</span></span>
    * <span data-ttu-id="997d9-191">**&lt;IoTHubOwnerConnectionString&gt;**  je hello **iothubowner** připojovacího řetězce, které jste zkopírovali v předchozím kroku hello.</span><span class="sxs-lookup"><span data-stu-id="997d9-191">**&lt;IoTHubOwnerConnectionString&gt;** is hello **iothubowner** connection string you copied in hello previous step.</span></span> <span data-ttu-id="997d9-192">Tento připojovací řetězec se používá pouze v tomto kroku, nebudete ho potřebovat v hello následující kroky:</span><span class="sxs-lookup"><span data-stu-id="997d9-192">This connection string is only used in this step, you don’t need it in hello following steps:</span></span>

    <span data-ttu-id="997d9-193">Použít hello **/ sdílené** složky (hello `-v` argument) novější toopersist hello hello brány modulů použít dva certifikáty X.509.</span><span class="sxs-lookup"><span data-stu-id="997d9-193">You use hello **/shared** folder (hello `-v` argument) later toopersist hello two X.509 certificates that hello gateway modules use.</span></span>

### <a name="run-hello-gateway"></a><span data-ttu-id="997d9-194">Spustit bránu hello</span><span class="sxs-lookup"><span data-stu-id="997d9-194">Run hello gateway</span></span>

1. <span data-ttu-id="997d9-195">Restartujte bránu hello pomocí hello následující příkazy:</span><span class="sxs-lookup"><span data-stu-id="997d9-195">Restart hello gateway using hello following commands:</span></span>

    `sudo docker run -it -h <ApplicationName> --expose 62222 -p 62222:62222 –-rm -v /shared:/build/src/GatewayApp.NetCore/bin/Debug/netcoreapp1.0/publish/Logs -v /shared:/build/src/GatewayApp.NetCore/bin/Debug/netcoreapp1.0/publish/CertificateStores -v /shared:/shared -v /shared:/root/.dotnet/corefx/cryptography/x509stores -e _GW_PNFP="/shared/publishednodes.JSON" microsoft/iot-gateway-opc-ua:1.0.0 <ApplicationName>`

    `sudo docker run -it -v /shared:/mapped microsoft/iot-gateway-opc-ua-proxy:0.1.3 -D /mapped/cs.db`

1. <span data-ttu-id="997d9-196">Z bezpečnostních důvodů hello dva certifikáty X.509 uchovávané v hello **/ sdílené** složka obsahovat hello privátní klíč.</span><span class="sxs-lookup"><span data-stu-id="997d9-196">For security reasons, hello two X.509 certificates persisted in hello **/shared** folder contain hello private key.</span></span> <span data-ttu-id="997d9-197">Omezení přístupu toothis složky toohello přihlašovací údaje použijete toorun hello kontejner Docker.</span><span class="sxs-lookup"><span data-stu-id="997d9-197">Limit access toothis folder toohello credentials you use toorun hello Docker container.</span></span> <span data-ttu-id="997d9-198">tooset hello oprávnění pro **kořenové** použít pouze, hello `chmod` prostředí shell příkaz na složku hello.</span><span class="sxs-lookup"><span data-stu-id="997d9-198">tooset hello permissions for **root** only, use hello `chmod` shell command on hello folder.</span></span>

1. <span data-ttu-id="997d9-199">Ověřte připojení k síti.</span><span class="sxs-lookup"><span data-stu-id="997d9-199">Verify network connectivity.</span></span> <span data-ttu-id="997d9-200">Z prostředí, zadejte příkaz hello `ping publisher.<your fully qualified domain name>` tooping bránu.</span><span class="sxs-lookup"><span data-stu-id="997d9-200">From a shell, enter hello command `ping publisher.<your fully qualified domain name>` tooping your gateway.</span></span> <span data-ttu-id="997d9-201">Pokud hello cíl nedostupný, přidejte hello IP adresu a název souboru hostitelů tooyour brány na bránu.</span><span class="sxs-lookup"><span data-stu-id="997d9-201">If hello destination is unreachable, add hello IP address and name of your gateway tooyour hosts file on your gateway.</span></span> <span data-ttu-id="997d9-202">soubor hosts Hello nachází v hello **/atd** složky.</span><span class="sxs-lookup"><span data-stu-id="997d9-202">hello hosts file is located in hello **/etc** folder.</span></span>

1. <span data-ttu-id="997d9-203">Zkuste tooconnect toohello vydavateli pomocí místního klienta OPC UA systémem hello brány.</span><span class="sxs-lookup"><span data-stu-id="997d9-203">Next, try tooconnect toohello publisher using a local OPC UA client running on hello gateway.</span></span> <span data-ttu-id="997d9-204">Hello OPC UA koncový bod je adresa URL `opc.tcp://publisher.<your fully qualified domain name>:62222`.</span><span class="sxs-lookup"><span data-stu-id="997d9-204">hello OPC UA endpoint URL is `opc.tcp://publisher.<your fully qualified domain name>:62222`.</span></span> <span data-ttu-id="997d9-205">Pokud nemáte klientem OPC UA, můžete stáhnout a použít [open-source OPC UA klienta].</span><span class="sxs-lookup"><span data-stu-id="997d9-205">If you don't have an OPC UA client, you can download and use an [open-source OPC UA client].</span></span>

1. <span data-ttu-id="997d9-206">Po úspěšném dokončení tyto místní testy procházet toohello **připojit vlastní OPC UA Server** stránku hello připojené vytváření řešení portálu.</span><span class="sxs-lookup"><span data-stu-id="997d9-206">When you have successfully completed these local tests, browse toohello **Connect your own OPC UA Server** page in hello connected factory solution portal.</span></span> <span data-ttu-id="997d9-207">Zadejte adresu URL koncového bodu vydavatele hello (`tcp://publisher.<your fully qualified domain name>:62222`) a klikněte na tlačítko **Connect**.</span><span class="sxs-lookup"><span data-stu-id="997d9-207">Enter hello publisher endpoint URL (`tcp://publisher.<your fully qualified domain name>:62222`) and click **Connect**.</span></span> <span data-ttu-id="997d9-208">Získat varování týkající se certifikátu a potom klikněte na **pokračovat.**</span><span class="sxs-lookup"><span data-stu-id="997d9-208">You get a certificate warning, then click **Proceed.**</span></span> <span data-ttu-id="997d9-209">Další dojde k chybě této hello vydavatel není důvěřovat hello uživatelský Agent webového klienta.</span><span class="sxs-lookup"><span data-stu-id="997d9-209">Next you get an error that hello publisher doesn’t trust hello UA Web Client.</span></span> <span data-ttu-id="997d9-210">tooresolve tato chyba, kopie hello **uživatelský Agent webového klienta** certifikát z hello **/sdílené/zamítnutý certifikáty nebo certifikáty** složky toohello **/shared/UA aplikací/certifikátů** složka v bráně hello.</span><span class="sxs-lookup"><span data-stu-id="997d9-210">tooresolve this error, copy hello **UA Web Client** certificate from hello **/shared/Rejected Certificates/certs** folder toohello **/shared/UA Applications/certs** folder on hello gateway.</span></span> <span data-ttu-id="997d9-211">Není nutné toorestart hello brány.</span><span class="sxs-lookup"><span data-stu-id="997d9-211">You do not need toorestart of hello gateway.</span></span> <span data-ttu-id="997d9-212">Tento krok opakujte.</span><span class="sxs-lookup"><span data-stu-id="997d9-212">Repeat this step.</span></span> <span data-ttu-id="997d9-213">Nyní můžete přihlásit toohello brány z cloudu hello a jsou připravené tooadd OPC UA servery toohello řešení.</span><span class="sxs-lookup"><span data-stu-id="997d9-213">You can now connect toohello gateway from hello cloud, and you are ready tooadd OPC UA servers toohello solution.</span></span>

### <a name="add-your-opc-ua-servers"></a><span data-ttu-id="997d9-214">Přidání serverů OPC UA</span><span class="sxs-lookup"><span data-stu-id="997d9-214">Add your OPC UA servers</span></span>

1. <span data-ttu-id="997d9-215">Procházet toohello **připojit vlastní OPC UA Server** stránku hello připojené vytváření řešení portálu.</span><span class="sxs-lookup"><span data-stu-id="997d9-215">Browse toohello **Connect your own OPC UA Server** page in hello connected factory solution portal.</span></span> <span data-ttu-id="997d9-216">Postupujte podle kroků stejná jako v předcházející části tooestablish hello vztah důvěryhodnosti mezi hello připojené factory portál a hello OPC UA server hello.</span><span class="sxs-lookup"><span data-stu-id="997d9-216">Follow hello same steps as in hello preceding section tooestablish trust between hello connected factory portal and hello OPC UA server.</span></span> <span data-ttu-id="997d9-217">Tento krok sestavuje vzájemné důvěryhodnosti hello certifikátů hello připojené portal objekt pro vytváření a hello OPC UA serveru a vytvoří připojení.</span><span class="sxs-lookup"><span data-stu-id="997d9-217">This step establishes a mutual trust of hello certificates from hello connected factory portal and hello OPC UA server and creates a connection.</span></span>

1. <span data-ttu-id="997d9-218">Procházet hello OPC UA uzlů stromu OPC UA serveru, klikněte pravým tlačítkem na hello OPC uzly a vyberte **publikování**.</span><span class="sxs-lookup"><span data-stu-id="997d9-218">Browse hello OPC UA nodes tree of your OPC UA server, right-click hello OPC nodes, and select **publish**.</span></span> <span data-ttu-id="997d9-219">Pro publikování toowork tímto způsobem, hello OPC UA serveru a hello vydavatele musí být na hello stejné síti.</span><span class="sxs-lookup"><span data-stu-id="997d9-219">For publishing toowork this way, hello OPC UA server and hello publisher must be on hello same network.</span></span> <span data-ttu-id="997d9-220">Jinými slovy, pokud hello plně kvalifikovaný název domény hello vydavatele je **publisher.mydomain.com** pak hello plně kvalifikovaný název domény musí být server OPC UA, například hello **myopcuaserver.mydomain.com**. Pokud vaše instalace se liší, můžete ručně přidat uzly toohello publishesnodes.json soubor ve hello **/ sdílené** složky.</span><span class="sxs-lookup"><span data-stu-id="997d9-220">In other words, if hello fully qualified domain name of hello publisher is **publisher.mydomain.com** then hello fully qualified domain name of hello OPC UA server must be, for example, **myopcuaserver.mydomain.com**. If your setup is different, you can manually add nodes toohello publishesnodes.json file found in hello **/shared** folder.</span></span> <span data-ttu-id="997d9-221">Hello publishesnodes.json se automaticky vygeneroval na hello nejprve úspěšné publikování OPC uzlu.</span><span class="sxs-lookup"><span data-stu-id="997d9-221">hello publishesnodes.json is automatically generated on hello first successful publish of an OPC node.</span></span>

1. <span data-ttu-id="997d9-222">Telemetrická data jsou nyní z hello zařízení brány.</span><span class="sxs-lookup"><span data-stu-id="997d9-222">Telemetry now flows from hello gateway device.</span></span> <span data-ttu-id="997d9-223">Hello telemetrie si můžete prohlédnout v hello **umístění objektu pro vytváření** zobrazení hello připojené factory portálu pod **nový objekt pro vytváření**.</span><span class="sxs-lookup"><span data-stu-id="997d9-223">You can view hello telemetry in hello **Factory Locations** view of hello connected factory portal under **New Factory**.</span></span>

## <a name="next-steps"></a><span data-ttu-id="997d9-224">Další kroky</span><span class="sxs-lookup"><span data-stu-id="997d9-224">Next steps</span></span>

<span data-ttu-id="997d9-225">toolearn Další informace o architektuře hello hello připojeného objektu pro vytváření předkonfigurovaného řešení najdete v tématu [připojené factory návod pro předkonfigurované řešení][lnk-walkthrough].</span><span class="sxs-lookup"><span data-stu-id="997d9-225">toolearn more about hello architecture of hello connected factory preconfigured solution, see [Connected factory preconfigured solution walkthrough][lnk-walkthrough].</span></span>

[img-install-docker]: ./media/iot-suite-connected-factory-gateway-deployment/image1.png
[img-hub-connection]: ./media/iot-suite-connected-factory-gateway-deployment/image2.png
[img-docker-share]: ./media/iot-suite-connected-factory-gateway-deployment/image3.png

[Docker pro systém Windows]: https://www.docker.com/docker-windows
[katalogu zařízení Azure IoT]: https://catalog.azureiotsuite.com/?q=opc
[portál Azure]: http://portal.azure.com/
[open-source OPC UA klienta]: https://github.com/OPCFoundation/UA-.NETStandardLibrary/tree/master/SampleApplications/Samples/Client.Net4
[Nainstalujte Docker]: https://www.docker.com/community-edition#/download
[lnk-walkthrough]: iot-suite-connected-factory-sample-walkthrough.md
[Azure IoT Edge]: https://github.com/Azure/iot-edge

[lnk-publisher-github]: https://github.com/Azure/iot-edge-opc-publisher
[lnk-publisher-docker]: https://hub.docker.com/r/microsoft/iot-gateway-opc-ua
[lnk-proxy-github]: https://github.com/Azure/iot-edge-opc-proxy
[lnk-proxy-docker]: https://hub.docker.com/r/microsoft/iot-gateway-opc-ua-proxy