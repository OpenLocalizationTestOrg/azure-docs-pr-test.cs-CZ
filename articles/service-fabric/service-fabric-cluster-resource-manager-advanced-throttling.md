---
title: "Omezení šířky pásma ve Správci prostředků clusteru Service Fabric | Microsoft Docs"
description: "Informace o konfiguraci omezení poskytuje služby infrastruktury clusteru správce prostředků."
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: 4a44678b-a5aa-4d30-958f-dc4332ebfb63
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 08/18/2017
ms.author: masnider
ms.openlocfilehash: 1be0beaf2e199a9c384187efd80b33c7dab5e87c
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/18/2017
---
# <a name="throttling-the-service-fabric-cluster-resource-manager"></a><span data-ttu-id="a105d-103">Omezení správce prostředků clusteru Service Fabric</span><span class="sxs-lookup"><span data-stu-id="a105d-103">Throttling the Service Fabric Cluster Resource Manager</span></span>
<span data-ttu-id="a105d-104">I v případě, že správce prostředků clusteru jste správně nakonfigurovaný, můžete získat dojde k narušení clusteru.</span><span class="sxs-lookup"><span data-stu-id="a105d-104">Even if you’ve configured the Cluster Resource Manager correctly, the cluster can get disrupted.</span></span> <span data-ttu-id="a105d-105">Například může být současně uzel a selhání domény selhání - co by mohlo dojít, pokud, ke kterým došlo během upgradu?</span><span class="sxs-lookup"><span data-stu-id="a105d-105">For example, there could be simultaneous node and fault domain failures - what would happen if that occurred during an upgrade?</span></span> <span data-ttu-id="a105d-106">Správce prostředků clusteru se vždy pokusí opravit vše, využívání prostředků clusteru pokusu reorganizovat a opravte clusteru.</span><span class="sxs-lookup"><span data-stu-id="a105d-106">The Cluster Resource Manager always tries to fix everything, consuming the cluster's resources trying to reorganize and fix the cluster.</span></span> <span data-ttu-id="a105d-107">Omezení zajišťuje backstop tak, aby cluster může používat prostředky na stabilizaci – uzly vraťte retušovat síťové oddíly, nasadí opravené bits.</span><span class="sxs-lookup"><span data-stu-id="a105d-107">Throttles help provide a backstop so that the cluster can use resources to stabilize - the nodes come back, the network partitions heal, corrected bits get deployed.</span></span>

<span data-ttu-id="a105d-108">K usnadnění pomocí těchto nastavení neovlivní situacích, správce prostředků clusteru Service Fabric obsahuje několik omezení.</span><span class="sxs-lookup"><span data-stu-id="a105d-108">To help with these sorts of situations, the Service Fabric Cluster Resource Manager includes several throttles.</span></span> <span data-ttu-id="a105d-109">Tato omezení jsou všechny bourací kladiva poměrně velké.</span><span class="sxs-lookup"><span data-stu-id="a105d-109">These throttles are all fairly large hammers.</span></span> <span data-ttu-id="a105d-110">Obecně se nesmí změnit bez pečlivé plánování a testování.</span><span class="sxs-lookup"><span data-stu-id="a105d-110">Generally they shouldn’t be changed without careful planning and testing.</span></span>

<span data-ttu-id="a105d-111">Pokud změníte omezení správce prostředků clusteru, by měl naladění očekávané skutečné zatížení.</span><span class="sxs-lookup"><span data-stu-id="a105d-111">If you change the Cluster Resource Manager's throttles, you should tune them to your expected actual load.</span></span> <span data-ttu-id="a105d-112">Můžete určit, že je potřeba mít některé omezení na místě, i v případě, znamená to, že cluster trvá déle stabilizovat v některých situacích.</span><span class="sxs-lookup"><span data-stu-id="a105d-112">You may determine you need to have some throttles in place, even if it means the cluster takes longer to stabilize in some situations.</span></span> <span data-ttu-id="a105d-113">Testování je potřeba určit správné hodnoty pro omezení.</span><span class="sxs-lookup"><span data-stu-id="a105d-113">Testing is required to determine the correct values for throttles.</span></span> <span data-ttu-id="a105d-114">Omezení musí být dostatečně vysoká, aby umožnit, aby cluster reagovat na změny v přiměřené době a nízké, aby se zabránilo ve skutečnosti příliš mnoho spotřeby prostředků.</span><span class="sxs-lookup"><span data-stu-id="a105d-114">Throttles need to be high enough to allow the cluster to respond to changes in a reasonable amount of time, and low enough to actually prevent too much resource consumption.</span></span> 

<span data-ttu-id="a105d-115">Ve většině případů jsme viděli zákazníkům použít omezení, byla úspěšně, protože již byly v prostředí omezené prostředků.</span><span class="sxs-lookup"><span data-stu-id="a105d-115">Most of the time we’ve seen customers use throttles it has been because they were already in a resource constrained environment.</span></span> <span data-ttu-id="a105d-116">Příkladem může být omezena šířka pásma sítě pro jednotlivé uzly nebo disky, které nejsou možné sestavit mnoho stavových repliky paralelně z důvodu omezení propustnosti.</span><span class="sxs-lookup"><span data-stu-id="a105d-116">Some examples would be limited network bandwidth for individual nodes, or disks that aren't able to build many stateful replicas in parallel due to throughput limitations.</span></span> <span data-ttu-id="a105d-117">Bez omezení může operace zahlcovat těchto prostředků, způsobuje operací selhat nebo být pomalé.</span><span class="sxs-lookup"><span data-stu-id="a105d-117">Without throttles, operations could overwhelm these resources, causing operations to fail or be slow.</span></span> <span data-ttu-id="a105d-118">V těchto situacích zákazníci používají omezení a věděl, že se měla rozšíření množství času, by byly třeba clusteru dosáhnout stabilního stavu.</span><span class="sxs-lookup"><span data-stu-id="a105d-118">In these situations customers used throttles and knew they were extending the amount of time it would take the cluster to reach a stable state.</span></span> <span data-ttu-id="a105d-119">Zákazníci také za to, že se může stát, že běží na nižší celkovou spolehlivost, zatímco se byly omezeny.</span><span class="sxs-lookup"><span data-stu-id="a105d-119">Customers also understood they could end up running at lower overall reliability while they were throttled.</span></span>


## <a name="configuring-the-throttles"></a><span data-ttu-id="a105d-120">Konfigurace omezení</span><span class="sxs-lookup"><span data-stu-id="a105d-120">Configuring the throttles</span></span>

<span data-ttu-id="a105d-121">Service Fabric má dva mechanismy pro omezení počtu pohybů typu repliky.</span><span class="sxs-lookup"><span data-stu-id="a105d-121">Service Fabric has two mechanisms for throttling the number of replica movements.</span></span> <span data-ttu-id="a105d-122">Výchozí mechanismus, které existovaly před Service Fabric 5.7 představuje omezení jako absolutní počet přesune povoleny.</span><span class="sxs-lookup"><span data-stu-id="a105d-122">The default mechanism that existed before Service Fabric 5.7 represents throttling as an absolute number of moves allowed.</span></span> <span data-ttu-id="a105d-123">Není to funguje pro clustery všech velikostí.</span><span class="sxs-lookup"><span data-stu-id="a105d-123">This does not work for clusters of all sizes.</span></span> <span data-ttu-id="a105d-124">Zejména u velkých clusterů výchozí hodnota může být příliš malá, výrazně zpomalení vyrovnávání i v případě, že je to nutné, přitom má neplatí v menší clustery.</span><span class="sxs-lookup"><span data-stu-id="a105d-124">In particular, for large clusters the default value can be too small, significantly slowing down balancing even when it is necessary, while having no effect in smaller clusters.</span></span> <span data-ttu-id="a105d-125">Tento mechanismus předchozí byla nahrazena na základě procenta omezení, která škáluje líp s dynamické clustery, ve kterých počet služeb a uzly pravidelně měnit.</span><span class="sxs-lookup"><span data-stu-id="a105d-125">This prior mechanism has been superseded by percentage-based throttling, which scales better with dynamic clusters in which the number of services and nodes change regularly.</span></span>

<span data-ttu-id="a105d-126">Omezení jsou založené na procento počet replik v clusterech.</span><span class="sxs-lookup"><span data-stu-id="a105d-126">The throttles are based on a percentage of the number of replicas in the clusters.</span></span> <span data-ttu-id="a105d-127">Povolit omezení Percetage na základě vyjádření pravidlo: "nepřesouvejte více než 10 % repliky v intervalu 10 minut", například.</span><span class="sxs-lookup"><span data-stu-id="a105d-127">Percetage based throttles enable expressing the rule: "do not move more than 10% of replicas in a 10 minute interval", for example.</span></span>

<span data-ttu-id="a105d-128">Nastavení konfigurace na základě procenta omezení jsou:</span><span class="sxs-lookup"><span data-stu-id="a105d-128">The configuration settings for percentage-based throttling are:</span></span>

  - <span data-ttu-id="a105d-129">GlobalMovementThrottleThresholdPercentage – maximální počet pohybů v clusteru povolené kdykoli, vyjádřené jako procento celkového počtu replik v clusteru.</span><span class="sxs-lookup"><span data-stu-id="a105d-129">GlobalMovementThrottleThresholdPercentage - Maximum number of movements allowed in cluster at any time, expressed as percentage of total number of replicas in the cluster.</span></span> <span data-ttu-id="a105d-130">0 znamená bez omezení.</span><span class="sxs-lookup"><span data-stu-id="a105d-130">0 indicates no limit.</span></span> <span data-ttu-id="a105d-131">Výchozí hodnota je 0.</span><span class="sxs-lookup"><span data-stu-id="a105d-131">The default value is 0.</span></span> <span data-ttu-id="a105d-132">Pokud toto nastavení a GlobalMovementThrottleThreshold jsou nastaveny, se používá více konzervativní limit.</span><span class="sxs-lookup"><span data-stu-id="a105d-132">If both this setting and GlobalMovementThrottleThreshold are specified, then the more conservative limit is used.</span></span>
  - <span data-ttu-id="a105d-133">GlobalMovementThrottleThresholdPercentageForPlacement – maximální počet pohybů povolené během fáze umístění, vyjádřené jako procento celkového počtu replik v clusteru.</span><span class="sxs-lookup"><span data-stu-id="a105d-133">GlobalMovementThrottleThresholdPercentageForPlacement - Maximum number of movements allowed during the placement phase, expressed as percentage of total number of replicas in the cluster.</span></span> <span data-ttu-id="a105d-134">0 znamená bez omezení.</span><span class="sxs-lookup"><span data-stu-id="a105d-134">0 indicates no limit.</span></span> <span data-ttu-id="a105d-135">Výchozí hodnota je 0.</span><span class="sxs-lookup"><span data-stu-id="a105d-135">The default value is 0.</span></span> <span data-ttu-id="a105d-136">Pokud toto nastavení a GlobalMovementThrottleThresholdForPlacement jsou nastaveny, se používá více konzervativní limit.</span><span class="sxs-lookup"><span data-stu-id="a105d-136">If both this setting and GlobalMovementThrottleThresholdForPlacement are specified, then the more conservative limit is used.</span></span>
  - <span data-ttu-id="a105d-137">GlobalMovementThrottleThresholdPercentageForBalancing – maximální počet pohybů povolené vyrovnávání fázi, vyjádřené jako procento celkového počtu replik v clusteru.</span><span class="sxs-lookup"><span data-stu-id="a105d-137">GlobalMovementThrottleThresholdPercentageForBalancing - Maximum number of movements allowed during the balancing phase, expressed as percentage of total number of replicas in the cluster.</span></span> <span data-ttu-id="a105d-138">0 znamená bez omezení.</span><span class="sxs-lookup"><span data-stu-id="a105d-138">0 indicates no limit.</span></span> <span data-ttu-id="a105d-139">Výchozí hodnota je 0.</span><span class="sxs-lookup"><span data-stu-id="a105d-139">The default value is 0.</span></span> <span data-ttu-id="a105d-140">Pokud toto nastavení a GlobalMovementThrottleThresholdForBalancing jsou nastaveny, se používá více konzervativní limit.</span><span class="sxs-lookup"><span data-stu-id="a105d-140">If both this setting and GlobalMovementThrottleThresholdForBalancing are specified, then the more conservative limit is used.</span></span>

<span data-ttu-id="a105d-141">Při zadávání procento omezení, zadáte jako hodnotu 0,05 5 %.</span><span class="sxs-lookup"><span data-stu-id="a105d-141">When specifying the throttle percentage, you'd specify 5% as 0.05.</span></span> <span data-ttu-id="a105d-142">Interval, ve kterém se řídí těchto omezení je GlobalMovementThrottleCountingInterval, které se určuje v sekundách.</span><span class="sxs-lookup"><span data-stu-id="a105d-142">The interval on which these throttles are governed is the GlobalMovementThrottleCountingInterval, which is specified in seconds.</span></span>


``` xml
<Section Name="PlacementAndLoadBalancing">
     <Parameter Name="GlobalMovementThrottleThresholdPercentage" Value="0" />
     <Parameter Name="GlobalMovementThrottleThresholdPercentageForPlacement" Value="0" />
     <Parameter Name="GlobalMovementThrottleThresholdPercentageForBalancing" Value="0" />
     <Parameter Name="GlobalMovementThrottleCountingInterval" Value="600" />
</Section>
```

<span data-ttu-id="a105d-143">pomocí souboru ClusterConfig.json pro samostatné nasazení nebo Template.json pro Azure hostované clustery:</span><span class="sxs-lookup"><span data-stu-id="a105d-143">via ClusterConfig.json for Standalone deployments or Template.json for Azure hosted clusters:</span></span>

```json
"fabricSettings": [
  {
    "name": "PlacementAndLoadBalancing",
    "parameters": [
      {
          "name": "GlobalMovementThrottleThresholdPercentage",
          "value": "0.0"
      },
      {
          "name": "GlobalMovementThrottleThresholdPercentageForPlacement",
          "value": "0.0"
      },
      {
          "name": "GlobalMovementThrottleThresholdPercentageForBalancing",
          "value": "0.0"
      },
      {
          "name": "GlobalMovementThrottleCountingInterval",
          "value": "600"
      }
    ]
  }
]
```

### <a name="default-count-based-throttles"></a><span data-ttu-id="a105d-144">Výchozí počet na základě omezení</span><span class="sxs-lookup"><span data-stu-id="a105d-144">Default count based throttles</span></span>
<span data-ttu-id="a105d-145">Tyto informace jsou poskytovány v případě, že máte starší clustery nebo zachovat přitom tyto konfigurace clusterů, které od té doby byly upgradovány.</span><span class="sxs-lookup"><span data-stu-id="a105d-145">This information is provided in case you have older clusters or still retain these configurations in clusters that have since been upgraded.</span></span> <span data-ttu-id="a105d-146">Obecně se doporučuje, ty jsou nahrazeny výše na základě procenta omezení.</span><span class="sxs-lookup"><span data-stu-id="a105d-146">In general, it is recommended that these are replaced with the percentage-based throttles above.</span></span> <span data-ttu-id="a105d-147">Vzhledem k tomu, že ve výchozím nastavení vypnutá omezování na základě procenta, zůstanou tato omezení výchozí omezení pro cluster s podporou, dokud jsou zakázána a nahradí omezení na základě procenta.</span><span class="sxs-lookup"><span data-stu-id="a105d-147">Since percentage-based throttling is disabled by default, these throttles remain the default throttles for a cluster until they are disabled and replaced with the percentage-based throttles.</span></span> 

  - <span data-ttu-id="a105d-148">GlobalMovementThrottleThreshold – toto nastavení určuje celkový počet pohybů v clusteru delší dobu.</span><span class="sxs-lookup"><span data-stu-id="a105d-148">GlobalMovementThrottleThreshold – this setting controls the total number of movements in the cluster over some time.</span></span> <span data-ttu-id="a105d-149">Množství času se zadávají v sekundách, jako GlobalMovementThrottleCountingInterval.</span><span class="sxs-lookup"><span data-stu-id="a105d-149">The amount of time is specified in seconds as the GlobalMovementThrottleCountingInterval.</span></span> <span data-ttu-id="a105d-150">Výchozí hodnota GlobalMovementThrottleThreshold je 1000 a výchozí hodnota GlobalMovementThrottleCountingInterval je 600.</span><span class="sxs-lookup"><span data-stu-id="a105d-150">The default value for the GlobalMovementThrottleThreshold is 1000 and the default value for the GlobalMovementThrottleCountingInterval is 600.</span></span>
  - <span data-ttu-id="a105d-151">MovementPerPartitionThrottleThreshold – toto nastavení určuje celkový počet pohybů pro všechny služby oddíl delší dobu.</span><span class="sxs-lookup"><span data-stu-id="a105d-151">MovementPerPartitionThrottleThreshold – this setting controls the total number of movements for any service partition over some time.</span></span> <span data-ttu-id="a105d-152">Množství času se zadávají v sekundách, jako MovementPerPartitionThrottleCountingInterval.</span><span class="sxs-lookup"><span data-stu-id="a105d-152">The amount of time is specified in seconds as the MovementPerPartitionThrottleCountingInterval.</span></span> <span data-ttu-id="a105d-153">Výchozí hodnota MovementPerPartitionThrottleThreshold je 50 a výchozí hodnota MovementPerPartitionThrottleCountingInterval je 600.</span><span class="sxs-lookup"><span data-stu-id="a105d-153">The default value for the MovementPerPartitionThrottleThreshold is 50 and the default value for the MovementPerPartitionThrottleCountingInterval is 600.</span></span>

<span data-ttu-id="a105d-154">Konfiguraci těchto omezení následující stejné jako omezení na základě procenta.</span><span class="sxs-lookup"><span data-stu-id="a105d-154">The configuration for these throttles follows the same pattern as the percentage-based throttling.</span></span>

## <a name="next-steps"></a><span data-ttu-id="a105d-155">Další kroky</span><span class="sxs-lookup"><span data-stu-id="a105d-155">Next steps</span></span>
- <span data-ttu-id="a105d-156">Chcete-li zjistit, o tom, jak správce prostředků clusteru spravuje a vyrovnává zatížení v clusteru, podívejte se na článek na [Vyrovnávání zatížení](service-fabric-cluster-resource-manager-balancing.md)</span><span class="sxs-lookup"><span data-stu-id="a105d-156">To find out about how the Cluster Resource Manager manages and balances load in the cluster, check out the article on [balancing load](service-fabric-cluster-resource-manager-balancing.md)</span></span>
- <span data-ttu-id="a105d-157">Správce prostředků clusteru má mnoho možností pro popis clusteru.</span><span class="sxs-lookup"><span data-stu-id="a105d-157">The Cluster Resource Manager has many options for describing the cluster.</span></span> <span data-ttu-id="a105d-158">Další informace o nich, projděte si tento článek na [popisující cluster Service Fabric](service-fabric-cluster-resource-manager-cluster-description.md)</span><span class="sxs-lookup"><span data-stu-id="a105d-158">To find out more about them, check out this article on [describing a Service Fabric cluster](service-fabric-cluster-resource-manager-cluster-description.md)</span></span>
