---
title: "aaaOverview životního cyklu hello služby Azure Service Fabric spolehlivé | Microsoft Docs"
description: "Další informace o události různých životního cyklu hello v Service Fabric spolehlivé služby"
services: Service-Fabric
documentationcenter: java
author: PavanKunapareddyMSFT
manager: timlt
ms.assetid: 
ms.service: Service-Fabric
ms.devlang: java
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 06/30/2017
ms.author: pakunapa;
ms.openlocfilehash: 6d48c217d12bc5248c2da57b544aac747cecd872
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="reliable-services-lifecycle-overview"></a><span data-ttu-id="c72b4-103">Přehled životního cyklu spolehlivé služby</span><span class="sxs-lookup"><span data-stu-id="c72b4-103">Reliable services lifecycle overview</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="c72b4-104">C# v systému Windows</span><span class="sxs-lookup"><span data-stu-id="c72b4-104">C# on Windows</span></span>](service-fabric-reliable-services-lifecycle.md)
> * [<span data-ttu-id="c72b4-105">Java v Linuxu</span><span class="sxs-lookup"><span data-stu-id="c72b4-105">Java on Linux</span></span>](service-fabric-reliable-services-lifecycle-java.md)
>
>

<span data-ttu-id="c72b4-106">Pokud přemýšlíte o životních hello spolehlivé služeb, jsou hello základy životního cyklu hello hello nejdůležitější.</span><span class="sxs-lookup"><span data-stu-id="c72b4-106">When thinking about hello lifecycles of Reliable Services, hello basics of hello lifecycle are hello most important.</span></span> <span data-ttu-id="c72b4-107">Obecně platí:</span><span class="sxs-lookup"><span data-stu-id="c72b4-107">In general:</span></span>

* <span data-ttu-id="c72b4-108">Při spuštění</span><span class="sxs-lookup"><span data-stu-id="c72b4-108">During Startup</span></span>
  * <span data-ttu-id="c72b4-109">Služby se vytvářejí.</span><span class="sxs-lookup"><span data-stu-id="c72b4-109">Services are constructed</span></span>
  * <span data-ttu-id="c72b4-110">Nemají tooconstruct příležitostí a vrátit nula nebo více – moduly naslouchání</span><span class="sxs-lookup"><span data-stu-id="c72b4-110">They have an opportunity tooconstruct and return zero or more listeners</span></span>
  * <span data-ttu-id="c72b4-111">Jsou otevřené žádné vrácený naslouchací procesy, povolení komunikace se službou hello</span><span class="sxs-lookup"><span data-stu-id="c72b4-111">Any returned listeners are opened, allowing communication with hello service</span></span>
  * <span data-ttu-id="c72b4-112">Služba Hello runAsync metoda je volána, povolit hello služby toodo dlouho spuštěný nebo práce na pozadí</span><span class="sxs-lookup"><span data-stu-id="c72b4-112">hello Service's runAsync method is called, allowing hello service toodo long running or background work</span></span>
* <span data-ttu-id="c72b4-113">Při vypnutí</span><span class="sxs-lookup"><span data-stu-id="c72b4-113">During shutdown</span></span>
  * <span data-ttu-id="c72b4-114">Hello zrušení token předaný toorunAsync se zruší, a jsou uzavřeny hello – moduly naslouchání</span><span class="sxs-lookup"><span data-stu-id="c72b4-114">hello cancellation token passed toorunAsync is canceled, and hello listeners are closed</span></span>
  * <span data-ttu-id="c72b4-115">Po který je dokončena, je destructed samotného objektu služby hello</span><span class="sxs-lookup"><span data-stu-id="c72b4-115">Once that is complete, hello service object itself is destructed</span></span>

<span data-ttu-id="c72b4-116">Přesný řazení tyto události jsou podrobnosti kolem hello.</span><span class="sxs-lookup"><span data-stu-id="c72b4-116">There are details around hello exact ordering of these events.</span></span> <span data-ttu-id="c72b4-117">Konkrétně hello pořadí událostí se může v závislosti na tom, jestli je hello spolehlivá služba Stateless nebo Stateful mírně změnit.</span><span class="sxs-lookup"><span data-stu-id="c72b4-117">In particular, hello order of events may change slightly depending on whether hello Reliable Service is Stateless or Stateful.</span></span> <span data-ttu-id="c72b4-118">Kromě toho pro stavové služby, máme toodeal se scénářem primárních prohození hello.</span><span class="sxs-lookup"><span data-stu-id="c72b4-118">In addition, for stateful services, we have toodeal with hello Primary swap scenario.</span></span> <span data-ttu-id="c72b4-119">Během tohoto pořadí hello role primární replikou přenášená tooanother (nebo zpátky) bez hello vypnutí služby.</span><span class="sxs-lookup"><span data-stu-id="c72b4-119">During this sequence, hello role of Primary is transferred tooanother replica (or comes back) without hello service shutting down.</span></span> <span data-ttu-id="c72b4-120">Nakonec máme toothink o podmínkách chyb nebo selhání.</span><span class="sxs-lookup"><span data-stu-id="c72b4-120">Finally, we have toothink about error or failure conditions.</span></span>

## <a name="stateless-service-startup"></a><span data-ttu-id="c72b4-121">Spuštění bezstavové služby</span><span class="sxs-lookup"><span data-stu-id="c72b4-121">Stateless service startup</span></span>
<span data-ttu-id="c72b4-122">životní cyklus Hello bezstavové služby je poměrně jednoduché.</span><span class="sxs-lookup"><span data-stu-id="c72b4-122">hello lifecycle of a stateless service is fairly straightforward.</span></span> <span data-ttu-id="c72b4-123">Tady je hello pořadí událostí:</span><span class="sxs-lookup"><span data-stu-id="c72b4-123">Here's hello order of events:</span></span>

1. <span data-ttu-id="c72b4-124">Hello služby je vytvořený</span><span class="sxs-lookup"><span data-stu-id="c72b4-124">hello Service is constructed</span></span>
2. <span data-ttu-id="c72b4-125">Potom v paralelní dvě věci situace:</span><span class="sxs-lookup"><span data-stu-id="c72b4-125">Then, in parallel two things happen:</span></span>
    - <span data-ttu-id="c72b4-126">`StatelessService.createServiceInstanceListeners()`je voláno, a jsou otevřené žádné vrácený naslouchací procesy (`CommunicationListener.openAsync()` se volá na každý naslouchací proces)</span><span class="sxs-lookup"><span data-stu-id="c72b4-126">`StatelessService.createServiceInstanceListeners()` is invoked and any returned listeners are Opened (`CommunicationListener.openAsync()` is called on each listener)</span></span>
    - <span data-ttu-id="c72b4-127">Hello metodě runAsync služby (`StatelessService.runAsync()`) se nazývá</span><span class="sxs-lookup"><span data-stu-id="c72b4-127">hello service's runAsync method (`StatelessService.runAsync()`) is called</span></span>
3. <span data-ttu-id="c72b4-128">Pokud je k dispozici, je volána metoda onOpenAsync služby vlastní hello (konkrétně `StatelessService.onOpenAsync()` je volána.</span><span class="sxs-lookup"><span data-stu-id="c72b4-128">If present, hello service's own onOpenAsync method is called (Specifically, `StatelessService.onOpenAsync()` is called.</span></span> <span data-ttu-id="c72b4-129">Toto je neobvyklé přepsání ale je k dispozici).</span><span class="sxs-lookup"><span data-stu-id="c72b4-129">This is an uncommon override but it is available).</span></span>

<span data-ttu-id="c72b4-130">Je důležité toonote se žádné řazení mezi hello volání toocreate a otevřete hello naslouchací procesy a runAsync.</span><span class="sxs-lookup"><span data-stu-id="c72b4-130">It is important toonote that there is no ordering between hello calls toocreate and open hello listeners and runAsync.</span></span> <span data-ttu-id="c72b4-131">moduly pro naslouchání Hello může zobrazit před zahájením runAsync.</span><span class="sxs-lookup"><span data-stu-id="c72b4-131">hello listeners may open before runAsync is started.</span></span> <span data-ttu-id="c72b4-132">Podobně runAsync může stát volána před naslouchací procesy komunikace hello jsou otevřené nebo i byla vytvořená.</span><span class="sxs-lookup"><span data-stu-id="c72b4-132">Similarly, runAsync may end up invoked before hello communication listeners are open or have even been constructed.</span></span> <span data-ttu-id="c72b4-133">Pokud žádné synchronizace je vyžadována, je ponechán jako implementátora toohello cvičení.</span><span class="sxs-lookup"><span data-stu-id="c72b4-133">If any synchronization is required, it is left as an exercise toohello implementer.</span></span> <span data-ttu-id="c72b4-134">Běžná řešení:</span><span class="sxs-lookup"><span data-stu-id="c72b4-134">Common solutions:</span></span>

* <span data-ttu-id="c72b4-135">Někdy naslouchací procesy nemůže fungovat, dokud některé další informace se vytvoří nebo fungovat Hotovo.</span><span class="sxs-lookup"><span data-stu-id="c72b4-135">Sometimes listeners can't function until some other information is created or work done.</span></span> <span data-ttu-id="c72b4-136">Pro bezstavové služby, které pracovní obvykle stačí v konstruktoru hello služby během hello `createServiceInstanceListeners()` volat, nebo jako součást hello konstrukce naslouchací proces hello sám sebe.</span><span class="sxs-lookup"><span data-stu-id="c72b4-136">For stateless services that work can usually be done in hello service's constructor, during hello `createServiceInstanceListeners()` call, or as a part of hello construction of hello listener itself.</span></span>
* <span data-ttu-id="c72b4-137">Někdy hello kód v runAsync nechce toostart dokud hello moduly pro naslouchání jsou otevřené.</span><span class="sxs-lookup"><span data-stu-id="c72b4-137">Sometimes hello code in runAsync does not want toostart until hello listeners are open.</span></span> <span data-ttu-id="c72b4-138">V takovém případě je nutné další spolupráce.</span><span class="sxs-lookup"><span data-stu-id="c72b4-138">In this case additional coordination is necessary.</span></span> <span data-ttu-id="c72b4-139">Běžným řešením je některé příznak v rámci hello naslouchací procesy, která udává, když nebude dokončena, který se změnami runAsync před pokračováním tooactual pracovní.</span><span class="sxs-lookup"><span data-stu-id="c72b4-139">One common solution is some flag within hello listeners indicating when they have completed, which is checked in runAsync before continuing tooactual work.</span></span>

## <a name="stateless-service-shutdown"></a><span data-ttu-id="c72b4-140">Vypnutí bezstavové služby</span><span class="sxs-lookup"><span data-stu-id="c72b4-140">Stateless service shutdown</span></span>
<span data-ttu-id="c72b4-141">Při vypínání bezstavové služby, hello stejného vzoru je pak, právě obráceným:</span><span class="sxs-lookup"><span data-stu-id="c72b4-141">When shutting down a stateless service, hello same pattern is followed, just in reverse:</span></span>

1. <span data-ttu-id="c72b4-142">Paralelní</span><span class="sxs-lookup"><span data-stu-id="c72b4-142">In parallel</span></span>
    - <span data-ttu-id="c72b4-143">Zavřeny všechny otevřené naslouchací procesy (`CommunicationListener.closeAsync()` se volá na každý naslouchací proces)</span><span class="sxs-lookup"><span data-stu-id="c72b4-143">Any open listeners are Closed (`CommunicationListener.closeAsync()` is called on each listener)</span></span>
    - <span data-ttu-id="c72b4-144">token zrušení Hello předán příliš`runAsync()` zrušeny (Kontrola token zrušení hello `isCancelled` vlastnost vrací hodnotu true a pokud volána hello token `throwIfCancellationRequested` metoda vrátí `CancellationException`)</span><span class="sxs-lookup"><span data-stu-id="c72b4-144">hello cancellation token passed too`runAsync()` is canceled (checking hello cancellation token's `isCancelled` property returns true, and if called hello token's `throwIfCancellationRequested` method throws a `CancellationException`)</span></span>
2. <span data-ttu-id="c72b4-145">Jednou `closeAsync()` dokončení na každý naslouchací proces a `runAsync()` také dokončení hello služby `StatelessService.onCloseAsync()` metoda je volána, pokud je k dispozici (znovu jde neobvyklé přepsání).</span><span class="sxs-lookup"><span data-stu-id="c72b4-145">Once `closeAsync()` completes on each listener and `runAsync()` also completes, hello service's `StatelessService.onCloseAsync()` method is called, if present (again this is an uncommon override).</span></span>
3. <span data-ttu-id="c72b4-146">Po `StatelessService.onCloseAsync()` dokončí, je destructed objekt služby hello</span><span class="sxs-lookup"><span data-stu-id="c72b4-146">After `StatelessService.onCloseAsync()` completes, hello service object is destructed</span></span>

## <a name="notes-on-service-lifecycle"></a><span data-ttu-id="c72b4-147">Poznámky k služby životního cyklu</span><span class="sxs-lookup"><span data-stu-id="c72b4-147">Notes on service lifecycle</span></span>
* <span data-ttu-id="c72b4-148">Obě hello `runAsync()` metoda a hello `createServiceInstanceListeners` volání jsou volitelné.</span><span class="sxs-lookup"><span data-stu-id="c72b4-148">Both hello `runAsync()` method and hello `createServiceInstanceListeners` calls are optional.</span></span> <span data-ttu-id="c72b4-149">Služby může mít jeden z nich, obě nebo ani jeden z nich.</span><span class="sxs-lookup"><span data-stu-id="c72b4-149">A service may have one of them, both, or neither.</span></span> <span data-ttu-id="c72b4-150">Například pokud hello služba nemá svou práci v odpovědi toouser volání, není třeba pro něj tooimplement `runAsync()`.</span><span class="sxs-lookup"><span data-stu-id="c72b4-150">For example, if hello service does all its work in response toouser calls, there is no need for it tooimplement `runAsync()`.</span></span> <span data-ttu-id="c72b4-151">Pouze naslouchací procesy komunikace hello a jejich přidružené kód jsou nezbytné.</span><span class="sxs-lookup"><span data-stu-id="c72b4-151">Only hello communication listeners and their associated code are necessary.</span></span> <span data-ttu-id="c72b4-152">Podobně je nepovinný hello služby může mít pouze pozadí pracovní toodo vytváření a vrácení naslouchací procesy komunikace a proto stačí tooimplement`runAsync()`</span><span class="sxs-lookup"><span data-stu-id="c72b4-152">Similarly, creating and returning communication listeners is optional, as hello service may have only background work toodo, and so only needs tooimplement `runAsync()`</span></span>
* <span data-ttu-id="c72b4-153">Je platná pro služby toocomplete `runAsync()` úspěšně a zpět z něj.</span><span class="sxs-lookup"><span data-stu-id="c72b4-153">It is valid for a service toocomplete `runAsync()` successfully and return from it.</span></span> <span data-ttu-id="c72b4-154">Toto není považováno za selhání podmínku a by představují práce pozadí hello od služby hello.</span><span class="sxs-lookup"><span data-stu-id="c72b4-154">This is not considered a failure condition and would represent hello background work of hello service completing.</span></span> <span data-ttu-id="c72b4-155">Pro stavové služby spolehlivé `runAsync()` by volán znovu, pokud služba hello došlo k degradaci z primární a poté vyzval back tooprimary.</span><span class="sxs-lookup"><span data-stu-id="c72b4-155">For stateful reliable services `runAsync()` would be called again if hello service were demoted from primary and then promoted back tooprimary.</span></span>
* <span data-ttu-id="c72b4-156">Pokud služba ukončí z `runAsync()` po vyvolání výjimky neočekávané výjimce, jedná se o chybu a objekt služby hello se vypne a oznámila Chyba stavu.</span><span class="sxs-lookup"><span data-stu-id="c72b4-156">If a service exits from `runAsync()` by throwing some unexpected exception, this is a failure and hello service object is shut down and a health error reported.</span></span>
* <span data-ttu-id="c72b4-157">Když žádný časový limit na vrácení z těchto metod, okamžitě ztratit hello možnost toowrite a proto nelze dokončit všechna skutečná práce.</span><span class="sxs-lookup"><span data-stu-id="c72b4-157">While there is no time limit on returning from these methods, you immediately lose hello ability toowrite and therefore cannot complete any real work.</span></span> <span data-ttu-id="c72b4-158">Doporučuje se vrátíte co nejrychleji po přijetí hello žádost o zrušení.</span><span class="sxs-lookup"><span data-stu-id="c72b4-158">It is recommended that you return as quickly as possible upon receiving hello cancellation request.</span></span> <span data-ttu-id="c72b4-159">Pokud vaše služba neodpovídá volání toothese rozhraní API v přiměřené době Service Fabric může vynucené ukončení služby.</span><span class="sxs-lookup"><span data-stu-id="c72b4-159">If your service does not respond toothese API calls in a reasonable amount of time Service Fabric may forcibly terminate your service.</span></span> <span data-ttu-id="c72b4-160">Obvykle tato situace nastane pouze během upgradu aplikace nebo když se odstraňuje služby.</span><span class="sxs-lookup"><span data-stu-id="c72b4-160">Usually this only happens during application upgrades or when a service is being deleted.</span></span> <span data-ttu-id="c72b4-161">Tento časový limit je 15 minut ve výchozím nastavení.</span><span class="sxs-lookup"><span data-stu-id="c72b4-161">This timeout is 15 minutes by default.</span></span>
* <span data-ttu-id="c72b4-162">Selhání v hello `onCloseAsync()` cesta povede `onAbort()` volané, což je možnost best effort poslední chance pro hello služby tooclean nahoru a uvolnění prostředků, které budou požadovaly.</span><span class="sxs-lookup"><span data-stu-id="c72b4-162">Failures in hello `onCloseAsync()` path result in `onAbort()` being called which is a last-chance best-effort opportunity for hello service tooclean up and release any resources that they have claimed.</span></span>

> [!NOTE]
> <span data-ttu-id="c72b4-163">Stavová spolehlivé služby ještě nepodporuje v jazyce java.</span><span class="sxs-lookup"><span data-stu-id="c72b4-163">Stateful reliable services are not supported in java yet.</span></span>
>
>

## <a name="next-steps"></a><span data-ttu-id="c72b4-164">Další kroky</span><span class="sxs-lookup"><span data-stu-id="c72b4-164">Next steps</span></span>
* [<span data-ttu-id="c72b4-165">Úvod tooReliable služby</span><span class="sxs-lookup"><span data-stu-id="c72b4-165">Introduction tooReliable Services</span></span>](service-fabric-reliable-services-introduction.md)
* [<span data-ttu-id="c72b4-166">Spolehlivé služby rychlý start</span><span class="sxs-lookup"><span data-stu-id="c72b4-166">Reliable Services quick start</span></span>](service-fabric-reliable-services-quick-start.md)
* [<span data-ttu-id="c72b4-167">Spolehlivé služby advanced využití</span><span class="sxs-lookup"><span data-stu-id="c72b4-167">Reliable Services advanced usage</span></span>](service-fabric-reliable-services-advanced-usage.md)
