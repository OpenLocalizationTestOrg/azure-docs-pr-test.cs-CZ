---
title: "Architektura spolehlivé služby | Microsoft Docs"
description: "Přehled architektury spolehlivá služba pro stavová a Bezstavová služby"
services: service-fabric
documentationcenter: .net
author: AlanWarwick
manager: timlt
editor: vturecek
ms.assetid: af002ae6-7f6d-4769-b049-82aa1ba0891b
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 03/30/2016
ms.author: alanwar
redirect_url: /azure/service-fabric/service-fabric-reliable-services-introduction
ms.openlocfilehash: a00a16945356b9731485554e06df46528b5c7bb2
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 07/11/2017
---
# <a name="architecture-for-stateful-and-stateless-reliable-services"></a><span data-ttu-id="417e9-103">Architektura pro stavová a Bezstavová spolehlivé služby</span><span class="sxs-lookup"><span data-stu-id="417e9-103">Architecture for stateful and stateless Reliable Services</span></span>
<span data-ttu-id="417e9-104">Spolehlivé služby Azure Service Fabric může být stavová nebo bezstavové.</span><span class="sxs-lookup"><span data-stu-id="417e9-104">An Azure Service Fabric Reliable Service may be stateful or stateless.</span></span> <span data-ttu-id="417e9-105">Každý typ služby běží v rámci konkrétní architektury.</span><span class="sxs-lookup"><span data-stu-id="417e9-105">Each type of service runs within a specific architecture.</span></span> <span data-ttu-id="417e9-106">Tyto architektury jsou popsané v tomto článku.</span><span class="sxs-lookup"><span data-stu-id="417e9-106">These architectures are described in this article.</span></span>
<span data-ttu-id="417e9-107">Najdete v článku [přehled spolehlivé služby](service-fabric-reliable-services-introduction.md) Další informace o rozdílech mezi stavová a Bezstavová služby.</span><span class="sxs-lookup"><span data-stu-id="417e9-107">See the [Reliable Service overview](service-fabric-reliable-services-introduction.md) for more information about the differences between stateful and stateless services.</span></span>

## <a name="stateful-reliable-services"></a><span data-ttu-id="417e9-108">Stavová spolehlivé služby</span><span class="sxs-lookup"><span data-stu-id="417e9-108">Stateful Reliable Services</span></span>
### <a name="architecture-of-a-stateful-service"></a><span data-ttu-id="417e9-109">Architektura stavové služby</span><span class="sxs-lookup"><span data-stu-id="417e9-109">Architecture of a stateful service</span></span>
![Diagram architektury stavové služby](./media/service-fabric-reliable-services-platform-architecture/reliable-stateful-service-architecture.png)

### <a name="stateful-reliable-service"></a><span data-ttu-id="417e9-111">Stavové spolehlivé služby</span><span class="sxs-lookup"><span data-stu-id="417e9-111">Stateful Reliable Service</span></span>
<span data-ttu-id="417e9-112">Stavové spolehlivé služby můžete odvozena od třídy buď StatefulService nebo StatefulServiceBase.</span><span class="sxs-lookup"><span data-stu-id="417e9-112">A stateful Reliable Service can derive from either the StatefulService or StatefulServiceBase class.</span></span> <span data-ttu-id="417e9-113">Obě tyto základní třídy jsou poskytovány Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="417e9-113">Both of these base classes are provided by Service Fabric.</span></span> <span data-ttu-id="417e9-114">Nabízejí různé úrovně podpory a abstrakci pro stavové služby rozhraní pro aplikaci Service Fabric – a aby se jako služba v rámci clusteru Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="417e9-114">They offer various levels of support and abstraction for the stateful service to interface with Service Fabric--and to participate as a service within the Service Fabric cluster.</span></span>

<span data-ttu-id="417e9-115">StatefulService je odvozena z StatefulServiceBase.</span><span class="sxs-lookup"><span data-stu-id="417e9-115">StatefulService derives from StatefulServiceBase.</span></span> <span data-ttu-id="417e9-116">StatefulServiceBase services nabízí větší flexibilitu, ale vyžaduje další vysvětlení interních Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="417e9-116">StatefulServiceBase offers services more flexibility, but requires more understanding of the internals of Service Fabric.</span></span>
<span data-ttu-id="417e9-117">Najdete v článku [přehled spolehlivé služby](service-fabric-reliable-services-introduction.md) a [spolehlivá služba advanced využití](service-fabric-reliable-services-advanced-usage.md) Další informace o specifikacích zápis služeb pomocí třídy StatefulService a StatefulServiceBase.</span><span class="sxs-lookup"><span data-stu-id="417e9-117">See the [Reliable Service overview](service-fabric-reliable-services-introduction.md) and [Reliable Service advanced usage](service-fabric-reliable-services-advanced-usage.md) for more information on the specifics of writing services by using the StatefulService and StatefulServiceBase classes.</span></span>

<span data-ttu-id="417e9-118">Obě třídy base správu životního cyklu a role implementace služby.</span><span class="sxs-lookup"><span data-stu-id="417e9-118">Both base classes manage the lifetime and role of the service implementation.</span></span> <span data-ttu-id="417e9-119">Implementace služby může přepsat virtuální metody buď základní třídy, pokud má implementace služby, aby se v těchto bodech v životním cyklu implementace služby--nebo pokud chce vytvořit objekt naslouchacího procesu komunikace.</span><span class="sxs-lookup"><span data-stu-id="417e9-119">The service implementation may override virtual methods of either base class if the service implementation has work to do at those points in the service implementation lifecycle--or if it wants to create a communication listener object.</span></span> <span data-ttu-id="417e9-120">Všimněte si, že i když implementace služby může implementovat vlastní objekt naslouchací proces komunikace vystavení ICommunicationListener, v diagramu výše, naslouchací proces komunikace je implementováno modulem Service Fabric – jako u implementace služby komunikace naslouchací proces, který je implementováno modulem Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="417e9-120">Note that although a service implementation may implement its own communication listener object exposing ICommunicationListener, in the diagram above, the communication listener is implemented by Service Fabric--as the service implementation uses a communication listener that is implemented by Service Fabric.</span></span>

<span data-ttu-id="417e9-121">Stavová spolehlivá služba používá správce spolehlivé stavu využívat výhod spolehlivé kolekce.</span><span class="sxs-lookup"><span data-stu-id="417e9-121">A stateful Reliable Service uses the reliable state manager to take advantage of reliable collections.</span></span> <span data-ttu-id="417e9-122">Místní datové struktury, které jsou vysoce dostupné pro službu--, která jsou spolehlivé kolekce, jsou vždy k dispozici, bez ohledu na převzetí služeb při selhání služby.</span><span class="sxs-lookup"><span data-stu-id="417e9-122">Reliable collections are local data structures that are highly available to the service--that is, they are always available, regardless of service failovers.</span></span> <span data-ttu-id="417e9-123">Každý typ spolehlivé kolekce je implementováno modulem zprostředkovatele spolehlivé stavu.</span><span class="sxs-lookup"><span data-stu-id="417e9-123">Each type of reliable collection is implemented by a reliable state provider.</span></span>
<span data-ttu-id="417e9-124">Další informace o spolehlivé kolekcí najdete v tématu [spolehlivé kolekce přehled](service-fabric-reliable-services-reliable-collections.md).</span><span class="sxs-lookup"><span data-stu-id="417e9-124">For more information on reliable collections, see the [reliable collections overview](service-fabric-reliable-services-reliable-collections.md).</span></span>

### <a name="reliable-state-manager-and-state-providers"></a><span data-ttu-id="417e9-125">Správce spolehlivé stavu a zprostředkovatelů stavu</span><span class="sxs-lookup"><span data-stu-id="417e9-125">Reliable state manager and state providers</span></span>
<span data-ttu-id="417e9-126">Správce spolehlivé stavu je objekt, který spravuje zprostředkovatelů spolehlivé stavu.</span><span class="sxs-lookup"><span data-stu-id="417e9-126">The reliable state manager is the object that manages reliable state providers.</span></span> <span data-ttu-id="417e9-127">Obsahuje funkci pro vytvoření, odstranění, výčet a zajistěte, aby zprostředkovatelů spolehlivé stavu trvalé a vysoce dostupné.</span><span class="sxs-lookup"><span data-stu-id="417e9-127">It has the functionality to create, delete, enumerate, and ensure that the reliable state providers are persisted and highly available.</span></span> <span data-ttu-id="417e9-128">Instanci poskytovatele spolehlivé stavu představuje instanci trvalý a vysoce dostupné datová struktura, jako je například slovník nebo fronty.</span><span class="sxs-lookup"><span data-stu-id="417e9-128">A reliable state provider instance represents an instance of a persisted and highly available data structure, such as a dictionary or a queue.</span></span>

<span data-ttu-id="417e9-129">Každý poskytovatel spolehlivé stavu zpřístupňuje rozhraní, které se používají k interakci s poskytovatelem spolehlivé stavu stavové služby.</span><span class="sxs-lookup"><span data-stu-id="417e9-129">Each reliable state provider exposes an interface that is used by a stateful service to interact with the reliable state provider.</span></span> <span data-ttu-id="417e9-130">Například IReliableDictionary slouží k rozhraní spolehlivé slovník, přičemž IReliableQueue se používá k rozhraní s spolehlivé fronty.</span><span class="sxs-lookup"><span data-stu-id="417e9-130">For example, IReliableDictionary is used to interface with the reliable dictionary, while IReliableQueue is used to interface with the reliable queue.</span></span> <span data-ttu-id="417e9-131">Všichni poskytovatelé spolehlivé stavu implementovat rozhraní IReliableState.</span><span class="sxs-lookup"><span data-stu-id="417e9-131">All reliable state providers implement the IReliableState interface.</span></span>

<span data-ttu-id="417e9-132">Správce spolehlivé stavu má rozhraní s názvem IReliableStateManager, který umožňuje přístup k němu z stavové služby.</span><span class="sxs-lookup"><span data-stu-id="417e9-132">The reliable state manager has an interface named IReliableStateManager, which allows access to it from a stateful service.</span></span> <span data-ttu-id="417e9-133">Rozhraní, které se zprostředkovatelů spolehlivé stavu, jsou vráceny prostřednictvím IReliableStateManager.</span><span class="sxs-lookup"><span data-stu-id="417e9-133">Interfaces to reliable state providers are returned through IReliableStateManager.</span></span>

<span data-ttu-id="417e9-134">Správce spolehlivé stavu používá modul plug-in architektura tak, aby nové typy spolehlivé kolekcí může být zapojen dynamicky.</span><span class="sxs-lookup"><span data-stu-id="417e9-134">The reliable state manager uses a plug-in architecture so that new types of reliable collections can be plugged in dynamically.</span></span>

<span data-ttu-id="417e9-135">Slovník spolehlivé a spolehlivé fronty jsou založena na provádění vysoce výkonné, verzí rozdílové úložiště.</span><span class="sxs-lookup"><span data-stu-id="417e9-135">The reliable dictionary and reliable queue are built upon the implementation of a high-performance, versioned differential store.</span></span>

### <a name="transactional-replicator"></a><span data-ttu-id="417e9-136">Transakční Replikátor</span><span class="sxs-lookup"><span data-stu-id="417e9-136">Transactional replicator</span></span>
<span data-ttu-id="417e9-137">Součást transakční Replikátor zodpovídá za zajištění, že stav služby (to znamená, stav v rámci správce spolehlivé stavu a spolehlivé kolekce) je konzistentní napříč všechny repliky spuštěna služba.</span><span class="sxs-lookup"><span data-stu-id="417e9-137">The transactional replicator component is responsible for ensuring that the state of a service (that is, the state within the reliable state manager and the reliable collections) is consistent across all replicas running the service.</span></span> <span data-ttu-id="417e9-138">Také zajistí, že stav je uchován v protokolu.</span><span class="sxs-lookup"><span data-stu-id="417e9-138">It also ensures that the state is persisted in the log.</span></span> <span data-ttu-id="417e9-139">Rozhraní správce spolehlivé stavu s transakční Replikátor prostřednictvím privátní mechanismus.</span><span class="sxs-lookup"><span data-stu-id="417e9-139">The reliable state manager interfaces with the transactional replicator via a private mechanism.</span></span>

<span data-ttu-id="417e9-140">Transakční Replikátor používá síťový protokol pro komunikaci stavu s ostatními replikami v instanci služby tak, aby všechny repliky informace aktuální stav.</span><span class="sxs-lookup"><span data-stu-id="417e9-140">The transactional replicator uses a network protocol to communicate state with other replicas of the service instance so that all replicas have up-to-date state information.</span></span>

<span data-ttu-id="417e9-141">Transakční Replikátor používá protokolu pro zachování informací o stavu tak, aby odolává informace o stavu procesu nebo dojde k chybě uzlu.</span><span class="sxs-lookup"><span data-stu-id="417e9-141">The transactional replicator uses a log to persist state information so that the state information survives process or node crashes.</span></span> <span data-ttu-id="417e9-142">Rozhraní v protokolu je prostřednictvím privátní mechanismus.</span><span class="sxs-lookup"><span data-stu-id="417e9-142">The interface to the log is via a private mechanism.</span></span>

### <a name="log"></a><span data-ttu-id="417e9-143">Protokol</span><span class="sxs-lookup"><span data-stu-id="417e9-143">Log</span></span>
<span data-ttu-id="417e9-144">Součásti protokolu poskytuje vysoce výkonné trvalého úložiště, který lze optimalizovat pro zápis na otáčejícího nebo SSD disky.</span><span class="sxs-lookup"><span data-stu-id="417e9-144">The log component provides a high-performance persistent store that can be optimized for writing to spinning or solid-state disks.</span></span>  <span data-ttu-id="417e9-145">Návrh protokolu je pro trvalé úložiště (tj, pevné disky) jako místní pro uzly, které běží stavové služby.</span><span class="sxs-lookup"><span data-stu-id="417e9-145">The design of the log is for the persistent storage (i.e., hard disks) to be local to the nodes that are running the stateful service.</span></span> <span data-ttu-id="417e9-146">To umožňuje nízkou latenci a vysokou propustnost, porovnání vzdálené trvalé úložiště, která není místní do uzlu.</span><span class="sxs-lookup"><span data-stu-id="417e9-146">This allows for low latencies and high throughput, as compared to remote persistent storage, which is not local to the node.</span></span>

<span data-ttu-id="417e9-147">Součásti protokolu používá víc souborů protokolů.</span><span class="sxs-lookup"><span data-stu-id="417e9-147">The log component uses multiple log files.</span></span> <span data-ttu-id="417e9-148">Neexistuje uzel celou sdílené protokolového souboru, který všech replik použijte ho k ukládání dat stavu poskytuje nejnižší latenci a nejvyšší propustnost.</span><span class="sxs-lookup"><span data-stu-id="417e9-148">There is a node-wide shared log file that all replicas use as it can provide the lowest latency and highest throughput for storing state data.</span></span> <span data-ttu-id="417e9-149">Ve výchozím nastavení je protokol sdílené umístěn v adresáři pracovní uzel Service Fabric, ale může být také nakonfigurována umístit na jiném umístění, v ideálním případě na disk vyhrazený pro pouze protokol sdílené.</span><span class="sxs-lookup"><span data-stu-id="417e9-149">By default the shared log is placed in the Service Fabric node work directory but it may also be configured to be placed at another location, ideally on a disk reserved for only the shared log.</span></span> <span data-ttu-id="417e9-150">Každou repliku pro službu má také soubor protokolu vyhrazené a vyhrazené protokolu je umístěn v rámci služby pracovní adresář.</span><span class="sxs-lookup"><span data-stu-id="417e9-150">Each replica for the service also has a dedicated log file and the dedicated log is placed within the service's work directory.</span></span> <span data-ttu-id="417e9-151">Neexistuje žádný mechanismus konfigurace vyhrazené protokolu, který chcete být umístěny na jiné umístění.</span><span class="sxs-lookup"><span data-stu-id="417e9-151">There is no mechanism to configure the dedicated log to be placed at a different location.</span></span>

<span data-ttu-id="417e9-152">Protokol sdílené je přechodná oblast pro informace o stavu repliky, je soubor protokolu vyhrazené konečného umístění, kde je trvalé.</span><span class="sxs-lookup"><span data-stu-id="417e9-152">The shared log is a transitional area for the replica's state information, while the dedicated log file is the final destination where it is persisted.</span></span> <span data-ttu-id="417e9-153">V tomto návrhu je informace o stavu nejprve do sdíleného souboru protokolu zapíše a pak líné přesunut do souboru protokolu vyhrazené na pozadí.</span><span class="sxs-lookup"><span data-stu-id="417e9-153">In this design, the state information is first written to the shared log file and then lazily moved to the dedicated log file in the background.</span></span> <span data-ttu-id="417e9-154">Tímto způsobem by mít zápis do sdílené protokolu nejnižší latenci a nejvyšší propustnost, což umožňuje službě rychleji průběh.</span><span class="sxs-lookup"><span data-stu-id="417e9-154">In this way, the write to the shared log would have the lowest latency and highest throughput which allows the service to make progress faster.</span></span>

<span data-ttu-id="417e9-155">Čtení a zápis do sdílené protokolu se provádí přes přímé vstupně-výstupní operace pro předběžně přidělené místo na disku pro soubor sdílený protokolu.</span><span class="sxs-lookup"><span data-stu-id="417e9-155">Reads and writes to the shared log are done via direct IO to preallocated space on the disk for the shared log file.</span></span> <span data-ttu-id="417e9-156">Umožňuje optimální využívání místa na disku na jednotce s vyhrazenou protokoly se vytvoří soubor protokolu vyhrazený jako zhuštěného souboru systému souborů NTFS.</span><span class="sxs-lookup"><span data-stu-id="417e9-156">To allow optimal use of disk space on the drive with dedicated logs, the dedicated log file is created as a NTFS sparse file.</span></span> <span data-ttu-id="417e9-157">Všimněte si, že to vám umožní předimenzování místa na disku a operačního systému se zobrazí soubory vyhrazené protokolů pomocí mnohem více místa na disku než je ve skutečnosti použít.</span><span class="sxs-lookup"><span data-stu-id="417e9-157">Note that this will allow overprovisioning of disk space and the OS will show the dedicated log files using much more disk space than is actually used.</span></span>

<span data-ttu-id="417e9-158">Kromě zajištění dostatečného minimální uživatelského režimu rozhraní do protokolu protokol je zapsán jako ovladač režimu jádra.</span><span class="sxs-lookup"><span data-stu-id="417e9-158">Aside from a minimal user-mode interface to the log, the log is written as a kernel-mode driver.</span></span> <span data-ttu-id="417e9-159">Spuštění se ovladač režimu jádra, protokol poskytnout nejvyšší výkon ke všem službám, které ho používají.</span><span class="sxs-lookup"><span data-stu-id="417e9-159">By running as a kernel-mode driver, the log can provide the highest performance to all services that use it.</span></span>

<span data-ttu-id="417e9-160">Další informace o konfiguraci protokolu najdete v tématu [konfigurace stavová spolehlivé služby](service-fabric-reliable-services-configuration.md).</span><span class="sxs-lookup"><span data-stu-id="417e9-160">For more information about configuring the log, see [Configuring stateful Reliable Services](service-fabric-reliable-services-configuration.md).</span></span>

## <a name="stateless-reliable-service"></a><span data-ttu-id="417e9-161">Bezstavové spolehlivé služby</span><span class="sxs-lookup"><span data-stu-id="417e9-161">Stateless Reliable Service</span></span>
### <a name="architecture-of-a-stateless-service"></a><span data-ttu-id="417e9-162">Architektura bezstavové služby</span><span class="sxs-lookup"><span data-stu-id="417e9-162">Architecture of a stateless service</span></span>
![Diagram architektury bezstavové služby](./media/service-fabric-reliable-services-platform-architecture/reliable-stateless-service-architecture.png)

### <a name="stateless-reliable-service"></a><span data-ttu-id="417e9-164">Bezstavové spolehlivé služby</span><span class="sxs-lookup"><span data-stu-id="417e9-164">Stateless Reliable Service</span></span>
<span data-ttu-id="417e9-165">Implementace bezstavové služby odvozena od třídy StatelessService nebo StatelessServiceBase.</span><span class="sxs-lookup"><span data-stu-id="417e9-165">Stateless service implementations derive from the StatelessService or StatelessServiceBase class.</span></span> <span data-ttu-id="417e9-166">Třída StatelessServiceBase umožňuje více flexibility než StatelessService třídy.</span><span class="sxs-lookup"><span data-stu-id="417e9-166">The StatelessServiceBase class allows more flexibility than the StatelessService class.</span></span>
<span data-ttu-id="417e9-167">Obě třídy base správu životního cyklu a role služby.</span><span class="sxs-lookup"><span data-stu-id="417e9-167">Both base classes manage the lifetime and role of a service.</span></span>

<span data-ttu-id="417e9-168">Implementace služby může přepsat virtuální metody buď základní třídy, pokud služba má práce uděláte v těchto bodech v průběhu životního cyklu služby--nebo pokud chce vytvořit objekt naslouchacího procesu komunikace.</span><span class="sxs-lookup"><span data-stu-id="417e9-168">The service implementation may override virtual methods of either base class if the service has work to do at those points in the service lifecycle--or if it wants to create a communication listener object.</span></span> <span data-ttu-id="417e9-169">Všimněte si, že i když služba může implementovat vlastní objekt naslouchací proces komunikace vystavení ICommunicationListener, v diagramu výše, naslouchací proces komunikace je implementováno modulem Service Fabric jako implementace této služby používá komunikaci ve formě naslouchací proces, který je implementováno modulem Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="417e9-169">Note that although the service may implement its own communication listener object exposing ICommunicationListener, in the diagram above, the communication listener is implemented by Service Fabric, as that service implementation uses a communication listener that is implemented by Service Fabric.</span></span>

<span data-ttu-id="417e9-170">Najdete v článku [přehled spolehlivé služby](service-fabric-reliable-services-introduction.md) a [spolehlivá služba advanced využití](service-fabric-reliable-services-advanced-usage.md) Další informace o specifikacích zápis služeb pomocí třídy StatelessService a StatelessServiceBase.</span><span class="sxs-lookup"><span data-stu-id="417e9-170">See the [Reliable Service overview](service-fabric-reliable-services-introduction.md) and [Reliable Service advanced usage](service-fabric-reliable-services-advanced-usage.md) for more information on the specifics of writing services using the StatelessService and StatelessServiceBase classes.</span></span>

<!--Every topic should have next steps and links to the next logical set of content to keep the customer engaged-->
## <a name="next-steps"></a><span data-ttu-id="417e9-171">Další kroky</span><span class="sxs-lookup"><span data-stu-id="417e9-171">Next steps</span></span>
<span data-ttu-id="417e9-172">Další informace o Service Fabric najdete v tématu:</span><span class="sxs-lookup"><span data-stu-id="417e9-172">For more information about Service Fabric, see:</span></span>

[<span data-ttu-id="417e9-173">Přehled spolehlivé služby</span><span class="sxs-lookup"><span data-stu-id="417e9-173">Reliable service overview</span></span>](service-fabric-reliable-services-introduction.md)

[<span data-ttu-id="417e9-174">Rychlý start</span><span class="sxs-lookup"><span data-stu-id="417e9-174">Quick start</span></span>](service-fabric-reliable-services-quick-start.md)

[<span data-ttu-id="417e9-175">Přehled spolehlivé kolekce</span><span class="sxs-lookup"><span data-stu-id="417e9-175">Reliable collections overview</span></span>](service-fabric-reliable-services-reliable-collections.md)

[<span data-ttu-id="417e9-176">Spolehlivé služby advanced využití</span><span class="sxs-lookup"><span data-stu-id="417e9-176">Reliable service advanced usage</span></span>](service-fabric-reliable-services-advanced-usage.md)

[<span data-ttu-id="417e9-177">Konfigurace spolehlivé služby</span><span class="sxs-lookup"><span data-stu-id="417e9-177">Reliable service configuration</span></span>](service-fabric-reliable-services-configuration.md)  

