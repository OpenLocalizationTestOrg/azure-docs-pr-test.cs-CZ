---
title: 'Upgrade aplikace: serializace dat | Microsoft Docs'
description: "Osvědčené postupy pro serializaci dat a jak ovlivňuje postupné upgrady aplikací."
services: service-fabric
documentationcenter: .net
author: vturecek
manager: timlt
editor: 
ms.assetid: a5f36366-a2ab-4ae3-bb08-bc2f9533bc5a
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 06/29/2017
ms.author: vturecek
ms.openlocfilehash: 1b65dfd3813423550631490640a81953864f58e3
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="how-data-serialization-affects-an-application-upgrade"></a><span data-ttu-id="c1e0a-103">Jak ovlivňuje serializace dat upgradu aplikace</span><span class="sxs-lookup"><span data-stu-id="c1e0a-103">How data serialization affects an application upgrade</span></span>
<span data-ttu-id="c1e0a-104">V [vrácení upgradu aplikace](service-fabric-application-upgrade.md), hello upgrade je použité tooa dílčí sadu uzlů, jednu upgradovací doménu najednou.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-104">In a [rolling application upgrade](service-fabric-application-upgrade.md), hello upgrade is applied tooa subset of nodes, one upgrade domain at a time.</span></span> <span data-ttu-id="c1e0a-105">Během tohoto procesu jsou některé domény upgrade na novější verzi aplikace hello a jsou některé upgradu domény na starší verzi aplikace hello.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-105">During this process, some upgrade domains are on hello newer version of your application, and some upgrade domains are on hello older version of your application.</span></span> <span data-ttu-id="c1e0a-106">Při zavedení hello hello novou verzi vaší aplikace musí být schopný tooread hello starší verzi vaše data a hello starší verzi aplikace musí být schopný tooread hello novou verzi vaše data.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-106">During hello rollout, hello new version of your application must be able tooread hello old version of your data, and hello old version of your application must be able tooread hello new version of your data.</span></span> <span data-ttu-id="c1e0a-107">Pokud formát dat hello není vpřed a zpětně kompatibilní, upgrade hello může selže nebo horší, data mohou být ke ztrátě nebo poškozený.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-107">If hello data format is not forward and backward compatible, hello upgrade may fail, or worse, data may be lost or corrupted.</span></span> <span data-ttu-id="c1e0a-108">Tento článek popisuje, co se považuje za vaše formát dat a nabízí osvědčené postupy pro zajištění, aby vaše data byla vpřed a zpětně kompatibilní.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-108">This article discusses what constitutes your data format and offers best practices for ensuring that your data is forward and backward compatible.</span></span>

## <a name="what-makes-up-your-data-format"></a><span data-ttu-id="c1e0a-109">Co tvoří vaše formát dat?</span><span class="sxs-lookup"><span data-stu-id="c1e0a-109">What makes up your data format?</span></span>
<span data-ttu-id="c1e0a-110">V Azure Service Fabric hello data, která je trvale uložila a replikovala pochází z třídy jazyka C#.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-110">In Azure Service Fabric, hello data that is persisted and replicated comes from your C# classes.</span></span> <span data-ttu-id="c1e0a-111">Pro aplikace, které používají [spolehlivé kolekce](service-fabric-reliable-services-reliable-collections.md), že data jsou hello objekty ve slovnících spolehlivé hello a fronty.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-111">For applications that use [Reliable Collections](service-fabric-reliable-services-reliable-collections.md), that data is hello objects in hello reliable dictionaries and queues.</span></span> <span data-ttu-id="c1e0a-112">Pro aplikace, které používají [Reliable Actors](service-fabric-reliable-actors-introduction.md), který je hello zálohování stavu objektu actor hello.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-112">For applications that use [Reliable Actors](service-fabric-reliable-actors-introduction.md), that is hello backing state for hello actor.</span></span> <span data-ttu-id="c1e0a-113">Tyto třídy jazyka C# musí být serializovatelný toobe trvale uložila a replikovala.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-113">These C# classes must be serializable toobe persisted and replicated.</span></span> <span data-ttu-id="c1e0a-114">Proto hello formát dat je definován hello polí a vlastností, které jsou serializovány, a také o tom, že serializovat.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-114">Therefore, hello data format is defined by hello fields and properties that are serialized, as well as how they are serialized.</span></span> <span data-ttu-id="c1e0a-115">Například v `IReliableDictionary<int, MyClass>` hello dat je serializovaný seznam `int` a serializovaný seznam `MyClass`.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-115">For example, in an `IReliableDictionary<int, MyClass>` hello data is a serialized `int` and a serialized `MyClass`.</span></span>

### <a name="code-changes-that-result-in-a-data-format-change"></a><span data-ttu-id="c1e0a-116">Kód změny, které způsobily změnu formátu dat</span><span class="sxs-lookup"><span data-stu-id="c1e0a-116">Code changes that result in a data format change</span></span>
<span data-ttu-id="c1e0a-117">Vzhledem k tomu, že formát dat hello je určen podle třídy jazyka C#, může způsobit změny toohello třídy změně formátu data.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-117">Since hello data format is determined by C# classes, changes toohello classes may cause a data format change.</span></span> <span data-ttu-id="c1e0a-118">Musí dát pozor tooensure, který může zpracovat postupného upgradu hello data formátu změnu.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-118">Care must be taken tooensure that a rolling upgrade can handle hello data format change.</span></span> <span data-ttu-id="c1e0a-119">Příklady, které by mohly způsobit změny formátu dat:</span><span class="sxs-lookup"><span data-stu-id="c1e0a-119">Examples that may cause data format changes:</span></span>

* <span data-ttu-id="c1e0a-120">Přidání nebo odebrání vlastnosti nebo pole</span><span class="sxs-lookup"><span data-stu-id="c1e0a-120">Adding or removing fields or properties</span></span>
* <span data-ttu-id="c1e0a-121">Přejmenování polí a vlastností</span><span class="sxs-lookup"><span data-stu-id="c1e0a-121">Renaming fields or properties</span></span>
* <span data-ttu-id="c1e0a-122">Změna hello typy polí a vlastností</span><span class="sxs-lookup"><span data-stu-id="c1e0a-122">Changing hello types of fields or properties</span></span>
* <span data-ttu-id="c1e0a-123">Změna názvu třídy hello nebo obor názvů</span><span class="sxs-lookup"><span data-stu-id="c1e0a-123">Changing hello class name or namespace</span></span>

### <a name="data-contract-as-hello-default-serializer"></a><span data-ttu-id="c1e0a-124">Kontrakt dat jako výchozí serializátor hello</span><span class="sxs-lookup"><span data-stu-id="c1e0a-124">Data Contract as hello default serializer</span></span>
<span data-ttu-id="c1e0a-125">Serializátor Hello je obecně odpovědná za čtení dat hello a deserializaci do aktuální verze hello, i když hello data jsou ve starší nebo *novější* verze.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-125">hello serializer is generally responsible for reading hello data and deserializing it into hello current version, even if hello data is in an older or *newer* version.</span></span> <span data-ttu-id="c1e0a-126">Hello výchozí serializátor je hello [serializátor kontraktu dat](https://msdn.microsoft.com/library/ms733127.aspx), který má pravidla dobře definovaný verzí.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-126">hello default serializer is hello [Data Contract serializer](https://msdn.microsoft.com/library/ms733127.aspx), which has well-defined versioning rules.</span></span> <span data-ttu-id="c1e0a-127">Spolehlivé kolekce povolit toobe serializátor hello přepsat, ale Reliable Actors aktuálně nepodporují.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-127">Reliable Collections allow hello serializer toobe overridden, but Reliable Actors currently do not.</span></span> <span data-ttu-id="c1e0a-128">Serializátor dat Hello hraje důležitou roli při povolování postupné upgrady.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-128">hello data serializer plays an important role in enabling rolling upgrades.</span></span> <span data-ttu-id="c1e0a-129">Serializátor kontraktu dat Hello je hello serializátoru, který doporučujeme pro aplikace Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-129">hello Data Contract serializer is hello serializer that we recommend for Service Fabric applications.</span></span>

## <a name="how-hello-data-format-affects-a-rolling-upgrade"></a><span data-ttu-id="c1e0a-130">Jak ovlivňuje formát dat hello postupného upgradu</span><span class="sxs-lookup"><span data-stu-id="c1e0a-130">How hello data format affects a rolling upgrade</span></span>
<span data-ttu-id="c1e0a-131">Během postupného upgradu, jsou dva základní scénáře, kde serializátor hello narazit na starší nebo *novější* verzi dat:</span><span class="sxs-lookup"><span data-stu-id="c1e0a-131">During a rolling upgrade, there are two main scenarios where hello serializer may encounter an older or *newer* version of your data:</span></span>

1. <span data-ttu-id="c1e0a-132">Po uzlu upgradu a spuštění zálohování, načte nové serializátor hello hello data, která byla trvalou toodisk hello staré verze.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-132">After a node is upgraded and starts back up, hello new serializer will load hello data that was persisted toodisk by hello old version.</span></span>
2. <span data-ttu-id="c1e0a-133">Během hello vrácení upgradu hello cluster bude obsahovat kombinaci hello staré a nové verze vašeho kódu.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-133">During hello rolling upgrade, hello cluster will contain a mix of hello old and new versions of your code.</span></span> <span data-ttu-id="c1e0a-134">Vzhledem k tomu, že repliky může umístěny v různých doménách upgradu a repliky odesílat data tooeach jiných, hello staré nebo nové verze vaše data mohou být zjištěny hello staré nebo nové verze vaší serializátor.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-134">Since replicas may be placed in different upgrade domains, and replicas send data tooeach other, hello new and/or old version of your data may be encountered by hello new and/or old version of your serializer.</span></span>

> [!NOTE]
> <span data-ttu-id="c1e0a-135">Hello "nové verze" a "staré verze" Zde naleznete toohello verzi váš kód, který běží.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-135">hello "new version" and "old version" here refer toohello version of your code that is running.</span></span> <span data-ttu-id="c1e0a-136">Hello "nové serializátor" odkazuje toohello serializátor kód, který spouští v nové verzi hello vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-136">hello "new serializer" refers toohello serializer code that is executing in hello new version of your application.</span></span> <span data-ttu-id="c1e0a-137">Hello "nová data" odkazuje toohello serializovat C# – třída z hello novou verzi vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-137">hello "new data" refers toohello serialized C# class from hello new version of your application.</span></span>
> 
> 

<span data-ttu-id="c1e0a-138">Hello dvě verze kódu a musí být ve formátu data vpřed a zpětně kompatibilní.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-138">hello two versions of code and data format must be both forward and backward compatible.</span></span> <span data-ttu-id="c1e0a-139">Pokud nejsou kompatibilní, hello vrácení upgradu může selhat nebo data mohou být ztracena.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-139">If they are not compatible, hello rolling upgrade may fail or data may be lost.</span></span> <span data-ttu-id="c1e0a-140">vrácení upgradu Hello může selhat, protože hello kód nebo serializátor může výjimku výjimky nebo chybu při zjistí hello jinou verzi.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-140">hello rolling upgrade may fail because hello code or serializer may throw exceptions or a fault when it encounters hello other version.</span></span> <span data-ttu-id="c1e0a-141">Data mohou být ztracena, pokud například byla přidána nová vlastnost ale staré serializátor hello zahodí se během deserializace.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-141">Data may be lost if, for example, a new property was added but hello old serializer discards it during deserialization.</span></span>

<span data-ttu-id="c1e0a-142">Kontrakt dat je hello doporučené řešení pro zajištění, aby vaše data byla kompatibilní.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-142">Data Contract is hello recommended solution for ensuring that your data is compatible.</span></span> <span data-ttu-id="c1e0a-143">Obsahuje pravidla dobře definovaný verzí pro přidání, odebrání a změna pole.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-143">It has well-defined versioning rules for adding, removing, and changing fields.</span></span> <span data-ttu-id="c1e0a-144">Je také podpora zabývají neznámé pole, zapojování do procesu hello serializace a deserializace a plánování práce s dědičnosti tříd.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-144">It also has support for dealing with unknown fields, hooking into hello serialization and deserialization process, and dealing with class inheritance.</span></span> <span data-ttu-id="c1e0a-145">Další informace najdete v tématu [pomocí kontrakt dat](https://msdn.microsoft.com/library/ms733127.aspx).</span><span class="sxs-lookup"><span data-stu-id="c1e0a-145">For more information, see [Using Data Contract](https://msdn.microsoft.com/library/ms733127.aspx).</span></span>

## <a name="next-steps"></a><span data-ttu-id="c1e0a-146">Další kroky</span><span class="sxs-lookup"><span data-stu-id="c1e0a-146">Next steps</span></span>
<span data-ttu-id="c1e0a-147">[Upgrade vaší aplikace pomocí sady Visual Studio](service-fabric-application-upgrade-tutorial.md) vás provede upgrade aplikace pomocí sady Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-147">[Upgrading your Application Using Visual Studio](service-fabric-application-upgrade-tutorial.md) walks you through an application upgrade using Visual Studio.</span></span>

<span data-ttu-id="c1e0a-148">[Upgrade vaší aplikace pomocí prostředí Powershell](service-fabric-application-upgrade-tutorial-powershell.md) vás provede upgrade aplikace pomocí prostředí PowerShell.</span><span class="sxs-lookup"><span data-stu-id="c1e0a-148">[Upgrading your Application Using Powershell](service-fabric-application-upgrade-tutorial-powershell.md) walks you through an application upgrade using PowerShell.</span></span>

<span data-ttu-id="c1e0a-149">Řídí, jak vaše aplikace upgraduje pomocí [Upgrade parametry](service-fabric-application-upgrade-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="c1e0a-149">Control how your application upgrades by using [Upgrade Parameters](service-fabric-application-upgrade-parameters.md).</span></span>

<span data-ttu-id="c1e0a-150">Zjistěte, jak toouse pokročilé funkce při upgradu vaší aplikace tím, že odkazuje příliš[Pokročilá témata](service-fabric-application-upgrade-advanced.md).</span><span class="sxs-lookup"><span data-stu-id="c1e0a-150">Learn how toouse advanced functionality while upgrading your application by referring too[Advanced Topics](service-fabric-application-upgrade-advanced.md).</span></span>

<span data-ttu-id="c1e0a-151">Řešení běžných potíží v upgradů aplikací tím, že odkazuje toohello kroky v [řešení potíží s aplikací upgrady ](service-fabric-application-upgrade-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="c1e0a-151">Fix common problems in application upgrades by referring toohello steps in [Troubleshooting Application Upgrades ](service-fabric-application-upgrade-troubleshooting.md).</span></span>

