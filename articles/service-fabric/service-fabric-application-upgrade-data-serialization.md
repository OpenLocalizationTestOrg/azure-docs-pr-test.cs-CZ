---
title: 'Upgrade aplikace: serializace dat | Microsoft Docs'
description: "Osvědčené postupy pro serializaci dat a jak ovlivňuje postupné upgrady aplikací."
services: service-fabric
documentationcenter: .net
author: vturecek
manager: timlt
editor: 
ms.assetid: a5f36366-a2ab-4ae3-bb08-bc2f9533bc5a
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 06/29/2017
ms.author: vturecek
ms.openlocfilehash: 6aa3ac7842df4657fca7f6b4264e1c6fe52dc0c6
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 07/11/2017
---
# <a name="how-data-serialization-affects-an-application-upgrade"></a><span data-ttu-id="19e2e-103">Jak ovlivňuje serializace dat upgradu aplikace</span><span class="sxs-lookup"><span data-stu-id="19e2e-103">How data serialization affects an application upgrade</span></span>
<span data-ttu-id="19e2e-104">V [vrácení upgradu aplikace](service-fabric-application-upgrade.md), upgradu se použije pro dílčí sadu uzlů, jednu upgradovací doménu najednou.</span><span class="sxs-lookup"><span data-stu-id="19e2e-104">In a [rolling application upgrade](service-fabric-application-upgrade.md), the upgrade is applied to a subset of nodes, one upgrade domain at a time.</span></span> <span data-ttu-id="19e2e-105">Během tohoto procesu jsou některé domény upgrade na novější verzi aplikace a jsou některé upgradu domény na starší verzi aplikace.</span><span class="sxs-lookup"><span data-stu-id="19e2e-105">During this process, some upgrade domains are on the newer version of your application, and some upgrade domains are on the older version of your application.</span></span> <span data-ttu-id="19e2e-106">Při zavedení nová verze aplikace musí být možné číst stará verze vaše data a starší verzi aplikace musí být možné číst novou verzi vaše data.</span><span class="sxs-lookup"><span data-stu-id="19e2e-106">During the rollout, the new version of your application must be able to read the old version of your data, and the old version of your application must be able to read the new version of your data.</span></span> <span data-ttu-id="19e2e-107">Pokud formát dat není vpřed a zpětně kompatibilní, upgrade může selhat nebo horší, mohou být data ztrátě nebo poškození.</span><span class="sxs-lookup"><span data-stu-id="19e2e-107">If the data format is not forward and backward compatible, the upgrade may fail, or worse, data may be lost or corrupted.</span></span> <span data-ttu-id="19e2e-108">Tento článek popisuje, co se považuje za vaše formát dat a nabízí osvědčené postupy pro zajištění, aby vaše data byla vpřed a zpětně kompatibilní.</span><span class="sxs-lookup"><span data-stu-id="19e2e-108">This article discusses what constitutes your data format and offers best practices for ensuring that your data is forward and backward compatible.</span></span>

## <a name="what-makes-up-your-data-format"></a><span data-ttu-id="19e2e-109">Co tvoří vaše formát dat?</span><span class="sxs-lookup"><span data-stu-id="19e2e-109">What makes up your data format?</span></span>
<span data-ttu-id="19e2e-110">V Azure Service Fabric data, která je trvale uložila a replikovala pochází z třídy jazyka C#.</span><span class="sxs-lookup"><span data-stu-id="19e2e-110">In Azure Service Fabric, the data that is persisted and replicated comes from your C# classes.</span></span> <span data-ttu-id="19e2e-111">Pro aplikace, které používají [spolehlivé kolekce](service-fabric-reliable-services-reliable-collections.md), že data jsou objekty ve slovnících spolehlivé a fronty.</span><span class="sxs-lookup"><span data-stu-id="19e2e-111">For applications that use [Reliable Collections](service-fabric-reliable-services-reliable-collections.md), that data is the objects in the reliable dictionaries and queues.</span></span> <span data-ttu-id="19e2e-112">Pro aplikace, které používají [Reliable Actors](service-fabric-reliable-actors-introduction.md), který je základní stav objektu actor.</span><span class="sxs-lookup"><span data-stu-id="19e2e-112">For applications that use [Reliable Actors](service-fabric-reliable-actors-introduction.md), that is the backing state for the actor.</span></span> <span data-ttu-id="19e2e-113">Tyto třídy jazyka C# musí být serializovatelný k trvale uložila a replikovala.</span><span class="sxs-lookup"><span data-stu-id="19e2e-113">These C# classes must be serializable to be persisted and replicated.</span></span> <span data-ttu-id="19e2e-114">Formát dat je proto definované polí a vlastností, které jsou serializovány, a také o tom, že serializovat.</span><span class="sxs-lookup"><span data-stu-id="19e2e-114">Therefore, the data format is defined by the fields and properties that are serialized, as well as how they are serialized.</span></span> <span data-ttu-id="19e2e-115">Například v `IReliableDictionary<int, MyClass>` data jsou serializovaný seznam `int` a serializovaný seznam `MyClass`.</span><span class="sxs-lookup"><span data-stu-id="19e2e-115">For example, in an `IReliableDictionary<int, MyClass>` the data is a serialized `int` and a serialized `MyClass`.</span></span>

### <a name="code-changes-that-result-in-a-data-format-change"></a><span data-ttu-id="19e2e-116">Kód změny, které způsobily změnu formátu dat</span><span class="sxs-lookup"><span data-stu-id="19e2e-116">Code changes that result in a data format change</span></span>
<span data-ttu-id="19e2e-117">Vzhledem k tomu, že formát dat je určen podle třídy jazyka C#, může způsobit změny třídy změně formátu data.</span><span class="sxs-lookup"><span data-stu-id="19e2e-117">Since the data format is determined by C# classes, changes to the classes may cause a data format change.</span></span> <span data-ttu-id="19e2e-118">Dbát musí zajistit, že postupného upgradu může zpracovat změny dat formátu.</span><span class="sxs-lookup"><span data-stu-id="19e2e-118">Care must be taken to ensure that a rolling upgrade can handle the data format change.</span></span> <span data-ttu-id="19e2e-119">Příklady, které by mohly způsobit změny formátu dat:</span><span class="sxs-lookup"><span data-stu-id="19e2e-119">Examples that may cause data format changes:</span></span>

* <span data-ttu-id="19e2e-120">Přidání nebo odebrání vlastnosti nebo pole</span><span class="sxs-lookup"><span data-stu-id="19e2e-120">Adding or removing fields or properties</span></span>
* <span data-ttu-id="19e2e-121">Přejmenování polí a vlastností</span><span class="sxs-lookup"><span data-stu-id="19e2e-121">Renaming fields or properties</span></span>
* <span data-ttu-id="19e2e-122">Změny typu polí a vlastností</span><span class="sxs-lookup"><span data-stu-id="19e2e-122">Changing the types of fields or properties</span></span>
* <span data-ttu-id="19e2e-123">Změna názvu třídy nebo obor názvů</span><span class="sxs-lookup"><span data-stu-id="19e2e-123">Changing the class name or namespace</span></span>

### <a name="data-contract-as-the-default-serializer"></a><span data-ttu-id="19e2e-124">Kontrakt dat jako výchozí serializátor</span><span class="sxs-lookup"><span data-stu-id="19e2e-124">Data Contract as the default serializer</span></span>
<span data-ttu-id="19e2e-125">Serializátor je obecně odpovědná za čtení dat a deserializaci do aktuální verze i v případě, že data jsou v starší nebo *novější* verze.</span><span class="sxs-lookup"><span data-stu-id="19e2e-125">The serializer is generally responsible for reading the data and deserializing it into the current version, even if the data is in an older or *newer* version.</span></span> <span data-ttu-id="19e2e-126">Výchozí serializátor je [serializátor kontraktu dat](https://msdn.microsoft.com/library/ms733127.aspx), který má pravidla dobře definovaný verzí.</span><span class="sxs-lookup"><span data-stu-id="19e2e-126">The default serializer is the [Data Contract serializer](https://msdn.microsoft.com/library/ms733127.aspx), which has well-defined versioning rules.</span></span> <span data-ttu-id="19e2e-127">Spolehlivé kolekce povolit serializátoru, který má být přepsána, ale Reliable Actors aktuálně nepodporují.</span><span class="sxs-lookup"><span data-stu-id="19e2e-127">Reliable Collections allow the serializer to be overridden, but Reliable Actors currently do not.</span></span> <span data-ttu-id="19e2e-128">Serializátor dat hraje důležitou roli při povolování postupné upgrady.</span><span class="sxs-lookup"><span data-stu-id="19e2e-128">The data serializer plays an important role in enabling rolling upgrades.</span></span> <span data-ttu-id="19e2e-129">Serializátor kontraktu dat je serializátoru, který doporučujeme pro aplikace Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="19e2e-129">The Data Contract serializer is the serializer that we recommend for Service Fabric applications.</span></span>

## <a name="how-the-data-format-affects-a-rolling-upgrade"></a><span data-ttu-id="19e2e-130">Jak ovlivňuje formát dat postupného upgradu</span><span class="sxs-lookup"><span data-stu-id="19e2e-130">How the data format affects a rolling upgrade</span></span>
<span data-ttu-id="19e2e-131">Během postupného upgradu, jsou dva základní scénáře, kde serializátor setkat starší nebo *novější* verzi dat:</span><span class="sxs-lookup"><span data-stu-id="19e2e-131">During a rolling upgrade, there are two main scenarios where the serializer may encounter an older or *newer* version of your data:</span></span>

1. <span data-ttu-id="19e2e-132">Po uzlu upgradu a spuštění zálohování, nové serializátoru, který načte data, která byla trvalé na pevném disku předchozí verzi aplikace.</span><span class="sxs-lookup"><span data-stu-id="19e2e-132">After a node is upgraded and starts back up, the new serializer will load the data that was persisted to disk by the old version.</span></span>
2. <span data-ttu-id="19e2e-133">Během postupného upgradu cluster bude obsahovat kombinací staré a nové verze vašeho kódu.</span><span class="sxs-lookup"><span data-stu-id="19e2e-133">During the rolling upgrade, the cluster will contain a mix of the old and new versions of your code.</span></span> <span data-ttu-id="19e2e-134">Vzhledem k tomu, že repliky může umístěny v různých doménách upgradu a repliky odesílat data mezi sebou, staré nebo nové verze vaše data mohou být zjištěny staré nebo nové verze vaší serializátor.</span><span class="sxs-lookup"><span data-stu-id="19e2e-134">Since replicas may be placed in different upgrade domains, and replicas send data to each other, the new and/or old version of your data may be encountered by the new and/or old version of your serializer.</span></span>

> [!NOTE]
> <span data-ttu-id="19e2e-135">"Nové verze" a "staré verze" Zde naleznete na verzi vašeho kódu, který běží.</span><span class="sxs-lookup"><span data-stu-id="19e2e-135">The "new version" and "old version" here refer to the version of your code that is running.</span></span> <span data-ttu-id="19e2e-136">"Nové serializátor" odkazuje na kód serializátoru, který spouští v nové verzi vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="19e2e-136">The "new serializer" refers to the serializer code that is executing in the new version of your application.</span></span> <span data-ttu-id="19e2e-137">"Nová data" odkazuje na serializovaných třída C# z nové verze aplikace.</span><span class="sxs-lookup"><span data-stu-id="19e2e-137">The "new data" refers to the serialized C# class from the new version of your application.</span></span>
> 
> 

<span data-ttu-id="19e2e-138">Dvě verze formátu kód a data musí být vpřed a zpětně kompatibilní.</span><span class="sxs-lookup"><span data-stu-id="19e2e-138">The two versions of code and data format must be both forward and backward compatible.</span></span> <span data-ttu-id="19e2e-139">Pokud nejsou kompatibilní, postupného upgradu může selhat nebo data mohou být ztracena.</span><span class="sxs-lookup"><span data-stu-id="19e2e-139">If they are not compatible, the rolling upgrade may fail or data may be lost.</span></span> <span data-ttu-id="19e2e-140">Postupného upgradu může selhat, protože kód nebo serializátor může výjimku výjimky nebo chybu při zjistí jinou verzi.</span><span class="sxs-lookup"><span data-stu-id="19e2e-140">The rolling upgrade may fail because the code or serializer may throw exceptions or a fault when it encounters the other version.</span></span> <span data-ttu-id="19e2e-141">Data mohou být ztracena, pokud například byla přidána nová vlastnost ale staré serializátor zahodí se během deserializace.</span><span class="sxs-lookup"><span data-stu-id="19e2e-141">Data may be lost if, for example, a new property was added but the old serializer discards it during deserialization.</span></span>

<span data-ttu-id="19e2e-142">Kontrakt dat je doporučené řešení pro zajištění, aby vaše data byla kompatibilní.</span><span class="sxs-lookup"><span data-stu-id="19e2e-142">Data Contract is the recommended solution for ensuring that your data is compatible.</span></span> <span data-ttu-id="19e2e-143">Obsahuje pravidla dobře definovaný verzí pro přidání, odebrání a změna pole.</span><span class="sxs-lookup"><span data-stu-id="19e2e-143">It has well-defined versioning rules for adding, removing, and changing fields.</span></span> <span data-ttu-id="19e2e-144">Je také podpora zabývají neznámé pole, zapojování do procesu serializace a deserializace a plánování práce s dědičnosti tříd.</span><span class="sxs-lookup"><span data-stu-id="19e2e-144">It also has support for dealing with unknown fields, hooking into the serialization and deserialization process, and dealing with class inheritance.</span></span> <span data-ttu-id="19e2e-145">Další informace najdete v tématu [pomocí kontrakt dat](https://msdn.microsoft.com/library/ms733127.aspx).</span><span class="sxs-lookup"><span data-stu-id="19e2e-145">For more information, see [Using Data Contract](https://msdn.microsoft.com/library/ms733127.aspx).</span></span>

## <a name="next-steps"></a><span data-ttu-id="19e2e-146">Další kroky</span><span class="sxs-lookup"><span data-stu-id="19e2e-146">Next steps</span></span>
<span data-ttu-id="19e2e-147">[Upgrade vaší aplikace pomocí sady Visual Studio](service-fabric-application-upgrade-tutorial.md) vás provede upgrade aplikace pomocí sady Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="19e2e-147">[Upgrading your Application Using Visual Studio](service-fabric-application-upgrade-tutorial.md) walks you through an application upgrade using Visual Studio.</span></span>

<span data-ttu-id="19e2e-148">[Upgrade vaší aplikace pomocí prostředí Powershell](service-fabric-application-upgrade-tutorial-powershell.md) vás provede upgrade aplikace pomocí prostředí PowerShell.</span><span class="sxs-lookup"><span data-stu-id="19e2e-148">[Upgrading your Application Using Powershell](service-fabric-application-upgrade-tutorial-powershell.md) walks you through an application upgrade using PowerShell.</span></span>

<span data-ttu-id="19e2e-149">Řídí, jak vaše aplikace upgraduje pomocí [Upgrade parametry](service-fabric-application-upgrade-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="19e2e-149">Control how your application upgrades by using [Upgrade Parameters](service-fabric-application-upgrade-parameters.md).</span></span>

<span data-ttu-id="19e2e-150">Další informace o použití pokročilých funkcí při upgradu vaší aplikace tím, že odkazuje na [Pokročilá témata](service-fabric-application-upgrade-advanced.md).</span><span class="sxs-lookup"><span data-stu-id="19e2e-150">Learn how to use advanced functionality while upgrading your application by referring to [Advanced Topics](service-fabric-application-upgrade-advanced.md).</span></span>

<span data-ttu-id="19e2e-151">Řešení běžných potíží v upgradů aplikací podle kroků v části [řešení potíží s aplikací upgrady ](service-fabric-application-upgrade-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="19e2e-151">Fix common problems in application upgrades by referring to the steps in [Troubleshooting Application Upgrades ](service-fabric-application-upgrade-troubleshooting.md).</span></span>

