---
title: aaaCluster Popis clusteru Resource Manager | Microsoft Docs
description: "Cluster Service Fabric popisující zadáním domén selhání, Upgrade domény, vlastnosti uzlu a uzel kapacity pro hello správce prostředků clusteru."
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: 55f8ab37-9399-4c9a-9e6c-d2d859de6766
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 08/18/2017
ms.author: masnider
ms.openlocfilehash: f2822075976bd54402af5ad56991b5b360dfb1d8
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="describing-a-service-fabric-cluster"></a><span data-ttu-id="b1614-103">Popisující service fabric cluster</span><span class="sxs-lookup"><span data-stu-id="b1614-103">Describing a service fabric cluster</span></span>
<span data-ttu-id="b1614-104">Hello správce prostředků clusteru Service Fabric nabízí několik mechanismů pro popis clusteru.</span><span class="sxs-lookup"><span data-stu-id="b1614-104">hello Service Fabric Cluster Resource Manager provides several mechanisms for describing a cluster.</span></span> <span data-ttu-id="b1614-105">Během doby běhu hello clusteru Resource Manager používá toto informace tooensure vysokou dostupnost hello běžící v clusteru hello.</span><span class="sxs-lookup"><span data-stu-id="b1614-105">During runtime, hello Cluster Resource Manager uses this information tooensure high availability of hello services running in hello cluster.</span></span> <span data-ttu-id="b1614-106">Při vynucování tyto důležité pravidla, také pokusí toooptimize hello spotřeby prostředků v rámci clusteru hello.</span><span class="sxs-lookup"><span data-stu-id="b1614-106">While enforcing these important rules, it also attempts toooptimize hello resource consumption within hello cluster.</span></span>

## <a name="key-concepts"></a><span data-ttu-id="b1614-107">Klíčové koncepty</span><span class="sxs-lookup"><span data-stu-id="b1614-107">Key concepts</span></span>
<span data-ttu-id="b1614-108">Hello clusteru Resource Manager podporuje několik funkcí, které popisují clusteru:</span><span class="sxs-lookup"><span data-stu-id="b1614-108">hello Cluster Resource Manager supports several features that describe a cluster:</span></span>

* <span data-ttu-id="b1614-109">Domén selhání</span><span class="sxs-lookup"><span data-stu-id="b1614-109">Fault Domains</span></span>
* <span data-ttu-id="b1614-110">Domén upgradu</span><span class="sxs-lookup"><span data-stu-id="b1614-110">Upgrade Domains</span></span>
* <span data-ttu-id="b1614-111">Vlastnosti uzlu</span><span class="sxs-lookup"><span data-stu-id="b1614-111">Node Properties</span></span>
* <span data-ttu-id="b1614-112">Uzel kapacity</span><span class="sxs-lookup"><span data-stu-id="b1614-112">Node Capacities</span></span>

## <a name="fault-domains"></a><span data-ttu-id="b1614-113">Domény selhání</span><span class="sxs-lookup"><span data-stu-id="b1614-113">Fault domains</span></span>
<span data-ttu-id="b1614-114">Domény selhání je všechny oblasti koordinované selhání.</span><span class="sxs-lookup"><span data-stu-id="b1614-114">A Fault Domain is any area of coordinated failure.</span></span> <span data-ttu-id="b1614-115">Jeden počítač je domény selhání (protože ho může selhat v jeho vlastní pro různé příčiny z power napájení selhání toodrive selhání toobad seskupování firmware).</span><span class="sxs-lookup"><span data-stu-id="b1614-115">A single machine is a Fault Domain (since it can fail on its own for various reasons, from power supply failures toodrive failures toobad NIC firmware).</span></span> <span data-ttu-id="b1614-116">Počítače hello připojené toohello stejnému přepínači sítě Ethernet jsou v jedné doméně selhání, jako jsou počítače sdílení jednoho zdroje napájení nebo na jednom místě.</span><span class="sxs-lookup"><span data-stu-id="b1614-116">Machines connected toohello same Ethernet switch are in hello same Fault Domain, as are machines sharing a single source of power or in a single location.</span></span> <span data-ttu-id="b1614-117">Vzhledem k tomu, že je přirozené pro toooverlap chyb hardwaru, jsou ze své podstaty hierarchická domén selhání a jsou reprezentovány jako identifikátory URI v Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="b1614-117">Since it's natural for hardware faults toooverlap, Fault Domains are inherently hierarchal and are represented as URIs in Service Fabric.</span></span>

<span data-ttu-id="b1614-118">Je důležité, aby domén selhání jsou správně nastaveny vzhledem k tomu, že Service Fabric používá tato informace toosafely místní služby.</span><span class="sxs-lookup"><span data-stu-id="b1614-118">It is important that Fault Domains are set up correctly since Service Fabric uses this information toosafely place services.</span></span> <span data-ttu-id="b1614-119">Service Fabric nechce, že tooplace služeb tak, aby hello ztrátě domény selhání (způsobené hello selhání některé komponenty) způsobí, že služba toogo dolů.</span><span class="sxs-lookup"><span data-stu-id="b1614-119">Service Fabric doesn't want tooplace services such that hello loss of a Fault Domain (caused by hello failure of some component) causes a service toogo down.</span></span> <span data-ttu-id="b1614-120">V prostředí Azure Service Fabric používá poskytnuté hello prostředí toocorrectly informace o doméně selhání hello hello nakonfigurujte hello uzly v clusteru hello vaším jménem.</span><span class="sxs-lookup"><span data-stu-id="b1614-120">In hello Azure environment Service Fabric uses hello Fault Domain information provided by hello environment toocorrectly configure hello nodes in hello cluster on your behalf.</span></span> <span data-ttu-id="b1614-121">Pro samostatné služby infrastruktury, domén selhání jsou definovány v době hello je nastavený tento cluster hello</span><span class="sxs-lookup"><span data-stu-id="b1614-121">For Service Fabric Standalone, Fault Domains are defined at hello time that hello cluster is set up</span></span> 

> [!WARNING]
> <span data-ttu-id="b1614-122">Je důležité, že hello informace o doméně selhání, pokud je přesný tooService prostředků infrastruktury.</span><span class="sxs-lookup"><span data-stu-id="b1614-122">It is important that hello Fault Domain information provided tooService Fabric is accurate.</span></span> <span data-ttu-id="b1614-123">Například předpokládejme, že uzly clusteru Service Fabric běží uvnitř 10 virtuálních počítačů běžících na pět fyzických hostitelích.</span><span class="sxs-lookup"><span data-stu-id="b1614-123">For example, let's say that your Service Fabric cluster's nodes are running inside 10 virtual machines, running on five physical hosts.</span></span> <span data-ttu-id="b1614-124">V takovém případě i když se 10 virtuálních počítačů, je jenom 5 různých (nejvyšší úrovně) poruch domén.</span><span class="sxs-lookup"><span data-stu-id="b1614-124">In this case, even though there are 10 virtual machines, there's only 5 different (top level) fault domains.</span></span> <span data-ttu-id="b1614-125">Sdílení hello způsobí, že stejném fyzickém hostiteli virtuálních počítačů tooshare hello stejné kořenová doména selhání, vzhledem k tomu, že hello prostředí virtuálních počítačů koordinované selhání, pokud se nezdaří jejich fyzického hostitele.</span><span class="sxs-lookup"><span data-stu-id="b1614-125">Sharing hello same physical host causes VMs tooshare hello same root fault domain, since hello VMs experience coordinated failure if their physical host fails.</span></span>  
>
> <span data-ttu-id="b1614-126">Vzhledem k tomu, že Service Fabric očekává hello doména selhání uzlu není toochange.</span><span class="sxs-lookup"><span data-stu-id="b1614-126">Since Service Fabric expects hello Fault Domain of a node not toochange.</span></span> <span data-ttu-id="b1614-127">Další mechanismy zajistit vysokou dostupnost hello virtuálních počítačů, jako například [HA – VMs](https://technet.microsoft.com/en-us/library/cc967323.aspx), použijte transparentní migraci virtuálních počítačů z jednoho hostitele tooanother.</span><span class="sxs-lookup"><span data-stu-id="b1614-127">Other mechanisms of ensuring high availability of hello VMs, such as [HA-VMs](https://technet.microsoft.com/en-us/library/cc967323.aspx), use transparent migration of VMs from one host tooanother.</span></span> <span data-ttu-id="b1614-128">Tyto mechanismy nezadávejte překonfigurovat nebo oznámit hello spuštění kódu uvnitř hello virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="b1614-128">These mechanisms do not reconfigure or notify hello running code inside hello VM.</span></span> <span data-ttu-id="b1614-129">Jako takový jsou **nepodporuje** jako prostředí pro spuštění Service Fabric clusterů.</span><span class="sxs-lookup"><span data-stu-id="b1614-129">As such, they are **not supported** as environments for running Service Fabric clusters.</span></span> <span data-ttu-id="b1614-130">Service Fabric musí být hello pouze vysokou dostupnost technologie.</span><span class="sxs-lookup"><span data-stu-id="b1614-130">Service Fabric should be hello only high-availability technology employed.</span></span> <span data-ttu-id="b1614-131">Mechanismy, jako je migrace za provozu virtuálního počítače, sítě SAN, nebo jiné nejsou potřebné.</span><span class="sxs-lookup"><span data-stu-id="b1614-131">Mechanisms like live VM migration, SANs, or others are not necessary.</span></span> <span data-ttu-id="b1614-132">Pokud se používá ve spojení s Service Fabric, tyto mechanismy _snížit_ aplikace dostupnost a spolehlivost vzhledem k tomu, že zavést další složitosti, přidejte centralizované zdroje selhání a využívat spolehlivost a strategie dostupnosti, které je v konfliktu s těmi, která v Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="b1614-132">If used in conjunction with Service Fabric, these mechanisms _reduce_ application availability and reliability because they introduce additional complexity, add centralized sources of failure, and utilize reliability and availability strategies that conflict with those in Service Fabric.</span></span> 
>
>

<span data-ttu-id="b1614-133">V následujícím obrázku hello jsme barvu všechny hello entity, které přispívají tooFault domén a seznam všech hello různých domén selhání, který vést.</span><span class="sxs-lookup"><span data-stu-id="b1614-133">In hello graphic below we color all hello entities that contribute tooFault Domains and list all hello different Fault Domains that result.</span></span> <span data-ttu-id="b1614-134">V tomto příkladu máme datových centrech (dále jen "řadiče domény"), stojany ("R") a okna ("B").</span><span class="sxs-lookup"><span data-stu-id="b1614-134">In this example, we have datacenters ("DC"), racks ("R"), and blades ("B").</span></span> <span data-ttu-id="b1614-135">V opačném případě pokud každý okno obsahuje více než jeden virtuální počítač, může dojít další vrstvu v hello hierarchii domény selhání.</span><span class="sxs-lookup"><span data-stu-id="b1614-135">Conceivably, if each blade holds more than one virtual machine, there could be another layer in hello Fault Domain hierarchy.</span></span>

<span data-ttu-id="b1614-136"><center>
![Uzly uspořádané prostřednictvím domén selhání][Image1]
</center></span><span class="sxs-lookup"><span data-stu-id="b1614-136"><center>
![Nodes organized via Fault Domains][Image1]
</center></span></span>

<span data-ttu-id="b1614-137">Během doby běhu hello správce prostředků clusteru Service Fabric zvažuje hello domén selhání v clusteru hello a plány rozložení.</span><span class="sxs-lookup"><span data-stu-id="b1614-137">During runtime, hello Service Fabric Cluster Resource Manager considers hello Fault Domains in hello cluster and plans layouts.</span></span> <span data-ttu-id="b1614-138">Hello stavová repliky nebo bezstavové instance pro danou službu distribuují tak, aby byly v samostatných doménách selhání.</span><span class="sxs-lookup"><span data-stu-id="b1614-138">hello stateful replicas or stateless instances for a given service are distributed so they are in separate Fault Domains.</span></span> <span data-ttu-id="b1614-139">Distribuci hello služby napříč doménami selhání zajistí, že hello dostupnost služby hello nejsou ohrožená selhání doména selhání na libovolné úrovni hierarchie hello.</span><span class="sxs-lookup"><span data-stu-id="b1614-139">Distributing hello service across fault domains ensures hello availability of hello service is not compromised when a Fault Domain fails at any level of hello hierarchy.</span></span>

<span data-ttu-id="b1614-140">Správce prostředků clusteru Service Fabric není stará počet vrstev v hello hierarchii domény selhání.</span><span class="sxs-lookup"><span data-stu-id="b1614-140">Service Fabric’s Cluster Resource Manager doesn’t care how many layers there are in hello Fault Domain hierarchy.</span></span> <span data-ttu-id="b1614-141">Však pokusí tooensure, který hello ke ztrátě všech jednu část hello hierarchie nebude mít vliv na běžící v ní.</span><span class="sxs-lookup"><span data-stu-id="b1614-141">However, it tries tooensure that hello loss of any one portion of hello hierarchy doesn’t impact services running in it.</span></span> 

<span data-ttu-id="b1614-142">Je vhodné, pokud existují hello stejný počet uzlů na každé úrovni podrobně hello hierarchii domény selhání.</span><span class="sxs-lookup"><span data-stu-id="b1614-142">It is best if there are hello same number of nodes at each level of depth in hello Fault Domain hierarchy.</span></span> <span data-ttu-id="b1614-143">Pokud hello "stromu" domén selhání nevyváženou v clusteru, je ztěžuje hello toofigure správce prostředků clusteru se doporučené přidělení hello služeb.</span><span class="sxs-lookup"><span data-stu-id="b1614-143">If hello “tree” of Fault Domains is unbalanced in your cluster, it makes it harder for hello Cluster Resource Manager toofigure out hello best allocation of services.</span></span> <span data-ttu-id="b1614-144">Imbalanced rozložení domén selhání znamenají, že hello ke ztrátě některých domén dopad hello dostupnost služeb víc než jiných domén.</span><span class="sxs-lookup"><span data-stu-id="b1614-144">Imbalanced Fault Domains layouts mean that hello loss of some domains impact hello availability of services more than other domains.</span></span> <span data-ttu-id="b1614-145">V důsledku toho odpojí hello správce prostředků clusteru mezi dva cíle: ho chce toouse hello počítače v této doméně "těžká" na jejich umístění služby a chce tooplace služby v jiných doménách, tak, aby hello ztrátě domény není způsobit problémy.</span><span class="sxs-lookup"><span data-stu-id="b1614-145">As a result, hello Cluster Resource Manager is torn between two goals: It wants toouse hello machines in that “heavy” domain by placing services on them, and it wants tooplace services in other domains so that hello loss of a domain doesn’t cause problems.</span></span> 

<span data-ttu-id="b1614-146">Co imbalanced domén vypadat?</span><span class="sxs-lookup"><span data-stu-id="b1614-146">What do imbalanced domains look like?</span></span> <span data-ttu-id="b1614-147">V následujícím diagramu hello ukážeme dvě rozložení jiného clusteru.</span><span class="sxs-lookup"><span data-stu-id="b1614-147">In hello diagram below, we show two different cluster layouts.</span></span> <span data-ttu-id="b1614-148">V prvním příkladu hello jsou rovnoměrně rozloženy hello uzly na hello domén selhání.</span><span class="sxs-lookup"><span data-stu-id="b1614-148">In hello first example, hello nodes are distributed evenly across hello Fault Domains.</span></span> <span data-ttu-id="b1614-149">V druhém příkladu hello jednu doménu selhání má mnoho více uzlů než hello jiných domén selhání.</span><span class="sxs-lookup"><span data-stu-id="b1614-149">In hello second example, one Fault Domain has many more nodes than hello other Fault Domains.</span></span> 

<span data-ttu-id="b1614-150"><center>
![Dvě různé clusteru rozložení][Image2]
</center></span><span class="sxs-lookup"><span data-stu-id="b1614-150"><center>
![Two different cluster layouts][Image2]
</center></span></span>

<span data-ttu-id="b1614-151">V Azure hello výběru z nich obsahuje doména selhání uzlu je spravovaná.</span><span class="sxs-lookup"><span data-stu-id="b1614-151">In Azure, hello choice of which Fault Domain contains a node is managed for you.</span></span> <span data-ttu-id="b1614-152">Ale v závislosti na hello počet uzlů, které můžete zřídit můžete stále skončili s domén selhání s více uzly v nich než jiné.</span><span class="sxs-lookup"><span data-stu-id="b1614-152">However, depending on hello number of nodes that you provision you can still end up with Fault Domains with more nodes in them than others.</span></span> <span data-ttu-id="b1614-153">Předpokládejme například že máte pět domén selhání v clusteru hello, ale zřídit sedmi uzlů pro daný typ uzlu.</span><span class="sxs-lookup"><span data-stu-id="b1614-153">For example, say you have five Fault Domains in hello cluster but provision seven nodes for a given NodeType.</span></span> <span data-ttu-id="b1614-154">V takovém případě hello první dva domén selhání skončili s více uzly.</span><span class="sxs-lookup"><span data-stu-id="b1614-154">In this case, hello first two Fault Domains end up with more nodes.</span></span> <span data-ttu-id="b1614-155">Pokud budete pokračovat toodeploy další NodeTypes s pouze několik instancí, získá zhoršení hello problém.</span><span class="sxs-lookup"><span data-stu-id="b1614-155">If you continue toodeploy more NodeTypes with only a couple instances, hello problem gets worse.</span></span> <span data-ttu-id="b1614-156">Proto se doporučuje tuto hello počet uzlů v každém typu uzlu je násobkem hello počet domén selhání.</span><span class="sxs-lookup"><span data-stu-id="b1614-156">For this reason it's recommended that hello number of nodes in each node type is a multiple of hello number of Fault Domains.</span></span>

## <a name="upgrade-domains"></a><span data-ttu-id="b1614-157">Domén upgradu</span><span class="sxs-lookup"><span data-stu-id="b1614-157">Upgrade domains</span></span>
<span data-ttu-id="b1614-158">Další funkce, která pomáhá hello správce prostředků clusteru služby prostředků infrastruktury jsou upgradu domény pochopit hello rozložení hello clusteru.</span><span class="sxs-lookup"><span data-stu-id="b1614-158">Upgrade Domains are another feature that helps hello Service Fabric Cluster Resource Manager understand hello layout of hello cluster.</span></span> <span data-ttu-id="b1614-159">Domén upgradu definovat sadu uzlů, které jsou upgradovány na hello stejnou dobu.</span><span class="sxs-lookup"><span data-stu-id="b1614-159">Upgrade Domains define sets of nodes that are upgraded at hello same time.</span></span> <span data-ttu-id="b1614-160">Nápověda hello upgradu domény správce prostředků clusteru pochopit a orchestraci management operace, jako je upgrady.</span><span class="sxs-lookup"><span data-stu-id="b1614-160">Upgrade Domains help hello Cluster Resource Manager understand and orchestrate management operations like upgrades.</span></span>

<span data-ttu-id="b1614-161">Upgradu domény jsou mnohem jako domén selhání, ale s několik hlavní rozdíly.</span><span class="sxs-lookup"><span data-stu-id="b1614-161">Upgrade Domains are a lot like Fault Domains, but with a couple key differences.</span></span> <span data-ttu-id="b1614-162">Nejprve oblasti selhání koordinované hardwaru definování domén selhání.</span><span class="sxs-lookup"><span data-stu-id="b1614-162">First, areas of coordinated hardware failures define Fault Domains.</span></span> <span data-ttu-id="b1614-163">Upgradovacích domén, na druhé straně Dobrý den, jsou definovány pomocí zásad.</span><span class="sxs-lookup"><span data-stu-id="b1614-163">Upgrade Domains, on hello other hand, are defined by policy.</span></span> <span data-ttu-id="b1614-164">Získat toodecide kolik chcete místo ho se závisí na prostředí hello.</span><span class="sxs-lookup"><span data-stu-id="b1614-164">You get toodecide how many you want, rather than it being dictated by hello environment.</span></span> <span data-ttu-id="b1614-165">Můžete mít tolik upgradu domény jako uzly.</span><span class="sxs-lookup"><span data-stu-id="b1614-165">You could have as many Upgrade Domains as you do nodes.</span></span> <span data-ttu-id="b1614-166">Další rozdíl mezi domén selhání a upgradu domény je, že Upgrade domény nejsou hierarchické.</span><span class="sxs-lookup"><span data-stu-id="b1614-166">Another difference between Fault Domains and Upgrade Domains is that Upgrade Domains are not hierarchical.</span></span> <span data-ttu-id="b1614-167">Místo toho se více podobají prostřednictvím jednoduchých značek.</span><span class="sxs-lookup"><span data-stu-id="b1614-167">Instead, they are more like a simple tag.</span></span> 

<span data-ttu-id="b1614-168">Hello následující diagram znázorňuje tři že upgradu domény jsou rozdělené mezi tři domény selhání.</span><span class="sxs-lookup"><span data-stu-id="b1614-168">hello following diagram shows three Upgrade Domains are striped across three Fault Domains.</span></span> <span data-ttu-id="b1614-169">Také ukazuje jeden možné umístění pro tři různé repliky stavové služby, kde každý skončilo v různých selhání a upgradu domény.</span><span class="sxs-lookup"><span data-stu-id="b1614-169">It also shows one possible placement for three different replicas of a stateful service, where each ends up in different Fault and Upgrade Domains.</span></span> <span data-ttu-id="b1614-170">Toto umístění umožňuje hello ztrátě domény selhání při uprostřed hello upgrade služby a ještě jednu kopii hello kód a data.</span><span class="sxs-lookup"><span data-stu-id="b1614-170">This placement allows hello loss of a Fault Domain while in hello middle of a service upgrade and still have one copy of hello code and data.</span></span>  

<span data-ttu-id="b1614-171"><center>
![Umístění s doménách selhání a upgradu][Image3]
</center></span><span class="sxs-lookup"><span data-stu-id="b1614-171"><center>
![Placement With Fault and Upgrade Domains][Image3]
</center></span></span>

<span data-ttu-id="b1614-172">Existují výhody a nevýhody toohaving velký počet domén upgradu.</span><span class="sxs-lookup"><span data-stu-id="b1614-172">There are pros and cons toohaving large numbers of Upgrade Domains.</span></span> <span data-ttu-id="b1614-173">Další domény upgradu znamená každého kroku upgradu hello je podrobnější a ovlivňuje menší počet uzlů nebo služby.</span><span class="sxs-lookup"><span data-stu-id="b1614-173">More Upgrade Domains means each step of hello upgrade is more granular and therefore affects a smaller number of nodes or services.</span></span> <span data-ttu-id="b1614-174">V důsledku toho méně služeb mají toomove současně, představení méně změn do systému hello.</span><span class="sxs-lookup"><span data-stu-id="b1614-174">As a result, fewer services have toomove at a time, introducing less churn into hello system.</span></span> <span data-ttu-id="b1614-175">To obvykle tooimprove spolehlivost, protože méně hello služby je ovlivněn jakýkoli problém zavedená během upgradu hello.</span><span class="sxs-lookup"><span data-stu-id="b1614-175">This tends tooimprove reliability, since less of hello service is impacted by any issue introduced during hello upgrade.</span></span> <span data-ttu-id="b1614-176">Další domény upgradu také znamená, že potřebovat méně dostupné vyrovnávací paměti na jiných uzlech toohandle hello dopad hello upgradu.</span><span class="sxs-lookup"><span data-stu-id="b1614-176">More Upgrade Domains also means that you need less available buffer on other nodes toohandle hello impact of hello upgrade.</span></span> <span data-ttu-id="b1614-177">Například pokud máte pět upgradu domén, hello uzly v každé jsou zpracování zhruba 20 % z provozu.</span><span class="sxs-lookup"><span data-stu-id="b1614-177">For example, if you have five Upgrade Domains, hello nodes in each are handling roughly 20% of your traffic.</span></span> <span data-ttu-id="b1614-178">Pokud potřebujete tootake dolů upgradu domény pro účely upgradu, aby byla zátěž obvykle musí toogo někde.</span><span class="sxs-lookup"><span data-stu-id="b1614-178">If you need tootake down that Upgrade Domain for an upgrade, that load usually needs toogo somewhere.</span></span> <span data-ttu-id="b1614-179">Vzhledem k tomu, že máte čtyři zbývající domény upgradu, každý musí mít prostor pro přibližně 5 % celkového provozu hello.</span><span class="sxs-lookup"><span data-stu-id="b1614-179">Since you have four remaining Upgrade Domains, each must have room for about 5% of hello total traffic.</span></span> <span data-ttu-id="b1614-180">Další domény upgradu znamená, že budete potřebovat méně vyrovnávací paměti hello uzlů v clusteru hello.</span><span class="sxs-lookup"><span data-stu-id="b1614-180">More Upgrade Domains means you need less buffer on hello nodes in hello cluster.</span></span> <span data-ttu-id="b1614-181">Zvažte například, pokud jste měli 10 upgradu domén místo.</span><span class="sxs-lookup"><span data-stu-id="b1614-181">For example, consider if you had 10 Upgrade Domains instead.</span></span> <span data-ttu-id="b1614-182">V takovém případě každý UD by pouze zpracovávat přibližně 10 % celkového provozu hello.</span><span class="sxs-lookup"><span data-stu-id="b1614-182">In that case, each UD would only be handling about 10% of hello total traffic.</span></span> <span data-ttu-id="b1614-183">Při upgradu kroky prostřednictvím hello clusteru, každou doménu potřebovat pouze toohave prostor pro přibližně 1.1 % celkového provozu hello.</span><span class="sxs-lookup"><span data-stu-id="b1614-183">When an upgrade steps through hello cluster, each domain would only need toohave room for about 1.1% of hello total traffic.</span></span> <span data-ttu-id="b1614-184">Další domény upgradu obvykle umožňují toorun uzly s vyšší využití, vzhledem k tomu, že budete potřebovat méně rezervované kapacity.</span><span class="sxs-lookup"><span data-stu-id="b1614-184">More Upgrade Domains generally allow you toorun your nodes at higher utilization, since you need less reserved capacity.</span></span> <span data-ttu-id="b1614-185">Hello totéž platí pro domény selhání.</span><span class="sxs-lookup"><span data-stu-id="b1614-185">hello same is true for Fault Domains.</span></span>  

<span data-ttu-id="b1614-186">Nevýhodou Hello mnoho upgradu domény je, že upgrady mívají tootake delší.</span><span class="sxs-lookup"><span data-stu-id="b1614-186">hello downside of having many Upgrade Domains is that upgrades tend tootake longer.</span></span> <span data-ttu-id="b1614-187">Service Fabric čeká krátké době po doména Upgrade a provádí kontroly před zahájením tooupgrade hello následujícím kódem.</span><span class="sxs-lookup"><span data-stu-id="b1614-187">Service Fabric waits a short period of time after an Upgrade Domain is completed and performs checks before starting tooupgrade hello next one.</span></span> <span data-ttu-id="b1614-188">Tyto zpoždění povolit zjišťuje problémy, které jsou zavedené službou hello upgrade před provedením upgradu hello.</span><span class="sxs-lookup"><span data-stu-id="b1614-188">These delays enable detecting issues introduced by hello upgrade before hello upgrade proceeds.</span></span> <span data-ttu-id="b1614-189">kompromis Hello je přijatelné, protože chybný změny brání by to ovlivnilo příliš mnoho hello služby najednou.</span><span class="sxs-lookup"><span data-stu-id="b1614-189">hello tradeoff is acceptable because it prevents bad changes from affecting too much of hello service at a time.</span></span>

<span data-ttu-id="b1614-190">Příliš málo upgradu domény má mnoho záporné vedlejší účinky – při každé jednotlivé upgradu domény je mimo provoz a upgraduje velkou část celkové kapacity není k dispozici.</span><span class="sxs-lookup"><span data-stu-id="b1614-190">Too few Upgrade Domains has many negative side effects – while each individual Upgrade Domain is down and being upgraded a large portion of your overall capacity is unavailable.</span></span> <span data-ttu-id="b1614-191">Například pokud máte pouze tři domény upgradu můžete trvá dolů o 1/3 celkové služby nebo kapacity clusteru současně.</span><span class="sxs-lookup"><span data-stu-id="b1614-191">For example, if you only have three Upgrade Domains you are taking down about 1/3 of your overall service or cluster capacity at a time.</span></span> <span data-ttu-id="b1614-192">Značná část služby najednou s dolů není žádoucí, vzhledem k tomu, že máte dostatečnou kapacitu pro toohave v hello zbytek úlohy clusteru toohandle hello.</span><span class="sxs-lookup"><span data-stu-id="b1614-192">Having so much of your service down at once isn’t desirable since you have toohave enough capacity in hello rest of your cluster toohandle hello workload.</span></span> <span data-ttu-id="b1614-193">Zachování této vyrovnávací paměti znamená, že při běžném provozu tyto uzly jsou menší načíst, než by byly jinak.</span><span class="sxs-lookup"><span data-stu-id="b1614-193">Maintaining that buffer means that during normal operation those nodes are less loaded than they would be otherwise.</span></span> <span data-ttu-id="b1614-194">Tím se zvyšuje hello náklady na provozování vaší služby.</span><span class="sxs-lookup"><span data-stu-id="b1614-194">This increases hello cost of running your service.</span></span>

<span data-ttu-id="b1614-195">Neexistuje žádné skutečné limit toohello celkový počet selhání nebo upgradu domény v prostředí nebo omezení toho, jak se překrývají.</span><span class="sxs-lookup"><span data-stu-id="b1614-195">There’s no real limit toohello total number of fault or Upgrade Domains in an environment, or constraints on how they overlap.</span></span> <span data-ttu-id="b1614-196">Ale nutné dodat, existuje několik běžných vzorů:</span><span class="sxs-lookup"><span data-stu-id="b1614-196">That said, there are several common patterns:</span></span>

- <span data-ttu-id="b1614-197">Domén selhání a upgradu domény namapovat 1:1</span><span class="sxs-lookup"><span data-stu-id="b1614-197">Fault Domains and Upgrade Domains mapped 1:1</span></span>
- <span data-ttu-id="b1614-198">Jednu doménu upgradu na uzel (fyzické nebo virtuální instance operačního systému)</span><span class="sxs-lookup"><span data-stu-id="b1614-198">One Upgrade Domain per Node (physical or virtual OS instance)</span></span>
- <span data-ttu-id="b1614-199">Model "prokládané" nebo "matice", kde hello domén selhání a upgradu domény formuláři matice se počítače, které obvykle běží dolů úhlopříčkami hello</span><span class="sxs-lookup"><span data-stu-id="b1614-199">A “striped” or “matrix” model where hello Fault Domains and Upgrade Domains form a matrix with machines usually running down hello diagonals</span></span>

<span data-ttu-id="b1614-200"><center>
![Selhání a upgradu domény rozložení][Image4]
</center></span><span class="sxs-lookup"><span data-stu-id="b1614-200"><center>
![Fault and Upgrade Domain Layouts][Image4]
</center></span></span>

<span data-ttu-id="b1614-201">Není definován že žádný nejvhodnější zodpovědět které toochoose rozložení, každá z nich má některé výhody a nevýhody.</span><span class="sxs-lookup"><span data-stu-id="b1614-201">There’s no best answer which layout toochoose, each has some pros and cons.</span></span> <span data-ttu-id="b1614-202">Například hello 1FD:1UD model je jednoduchý tooset nahoru.</span><span class="sxs-lookup"><span data-stu-id="b1614-202">For example, hello 1FD:1UD model is simple tooset up.</span></span> <span data-ttu-id="b1614-203">Hello 1 doméně pro Upgrade na uzlu modelu je většina jako osoby, které se používají pro.</span><span class="sxs-lookup"><span data-stu-id="b1614-203">hello 1 Upgrade Domain per Node model is most like what people are used to.</span></span> <span data-ttu-id="b1614-204">Během upgradu se aktualizuje každý uzel nezávisle.</span><span class="sxs-lookup"><span data-stu-id="b1614-204">During upgrades each node is updated independently.</span></span> <span data-ttu-id="b1614-205">Tato funkce je toohow malé sady počítačů byly upgradovány ručně v posledních hello.</span><span class="sxs-lookup"><span data-stu-id="b1614-205">This is similar toohow small sets of machines were upgraded manually in hello past.</span></span> 

<span data-ttu-id="b1614-206">Nejběžnější model Hello je hello FD/UD matice, kde hello FDs a UDs vytvoří tabulku a uzly jsou umístěny podél hello diagonálních spouštění.</span><span class="sxs-lookup"><span data-stu-id="b1614-206">hello most common model is hello FD/UD matrix, where hello FDs and UDs form a table and nodes are placed starting along hello diagonal.</span></span> <span data-ttu-id="b1614-207">Toto je model hello používá ve výchozím nastavení v clusterů Service Fabric v Azure.</span><span class="sxs-lookup"><span data-stu-id="b1614-207">This is hello model used by default in Service Fabric clusters in Azure.</span></span> <span data-ttu-id="b1614-208">U clusterů s uzly mnoho všechno, co skončilo vyhledávání jako vzor hustých matice hello výše.</span><span class="sxs-lookup"><span data-stu-id="b1614-208">For clusters with many nodes everything ends up looking like hello dense matrix pattern above.</span></span>

## <a name="fault-and-upgrade-domain-constraints-and-resulting-behavior"></a><span data-ttu-id="b1614-209">Selhání a upgradu domény omezení a výsledné chování</span><span class="sxs-lookup"><span data-stu-id="b1614-209">Fault and Upgrade Domain constraints and resulting behavior</span></span>
<span data-ttu-id="b1614-210">Hello správce prostředků clusteru zpracovává hello desire tookeep služby rovnoměrně rozdělen mezi selhání a upgradu domény jako omezení.</span><span class="sxs-lookup"><span data-stu-id="b1614-210">hello Cluster Resource Manager treats hello desire tookeep a service balanced across fault and Upgrade Domains as a constraint.</span></span> <span data-ttu-id="b1614-211">Můžete najít další informace o omezení v [v tomto článku](service-fabric-cluster-resource-manager-management-integration.md).</span><span class="sxs-lookup"><span data-stu-id="b1614-211">You can find out more about constraints in [this article](service-fabric-cluster-resource-manager-management-integration.md).</span></span> <span data-ttu-id="b1614-212">Hello omezení stavu selhání a upgradu domény: "pro oddíl dané služby by nikdy existovat rozdíl *větší než jedna* v hello počet objektů služby (instance bezstavové služby nebo stavové služby repliky) mezi dvěma doménami."</span><span class="sxs-lookup"><span data-stu-id="b1614-212">hello Fault and Upgrade Domain constraints state: "For a given service partition there should never be a difference *greater than one* in hello number of service objects (stateless service instances or stateful service replicas) between two domains."</span></span> <span data-ttu-id="b1614-213">Tím se zabrání určité přesune nebo ujednání, které porušují toto omezení.</span><span class="sxs-lookup"><span data-stu-id="b1614-213">This prevents certain moves or arrangements that violate this constraint.</span></span>

<span data-ttu-id="b1614-214">Podívejme se na jedním z příkladů.</span><span class="sxs-lookup"><span data-stu-id="b1614-214">Let's look at one example.</span></span> <span data-ttu-id="b1614-215">Řekněme, že se musí na cluster se šesti uzlů, nakonfigurovaný s pěti domén selhání a pět upgradu domény.</span><span class="sxs-lookup"><span data-stu-id="b1614-215">Let's say that we have a cluster with six nodes, configured with five Fault Domains and five Upgrade Domains.</span></span>

|  | <span data-ttu-id="b1614-216">FD0</span><span class="sxs-lookup"><span data-stu-id="b1614-216">FD0</span></span> | <span data-ttu-id="b1614-217">FD1</span><span class="sxs-lookup"><span data-stu-id="b1614-217">FD1</span></span> | <span data-ttu-id="b1614-218">FD2:</span><span class="sxs-lookup"><span data-stu-id="b1614-218">FD2</span></span> | <span data-ttu-id="b1614-219">FD3</span><span class="sxs-lookup"><span data-stu-id="b1614-219">FD3</span></span> | <span data-ttu-id="b1614-220">FD4</span><span class="sxs-lookup"><span data-stu-id="b1614-220">FD4</span></span> |
| --- |:---:|:---:|:---:|:---:|:---:|
| <span data-ttu-id="b1614-221">**UD0**</span><span class="sxs-lookup"><span data-stu-id="b1614-221">**UD0**</span></span> |<span data-ttu-id="b1614-222">N1</span><span class="sxs-lookup"><span data-stu-id="b1614-222">N1</span></span> | | | | |
| <span data-ttu-id="b1614-223">**UD1**</span><span class="sxs-lookup"><span data-stu-id="b1614-223">**UD1**</span></span> |<span data-ttu-id="b1614-224">N6</span><span class="sxs-lookup"><span data-stu-id="b1614-224">N6</span></span> |<span data-ttu-id="b1614-225">N2</span><span class="sxs-lookup"><span data-stu-id="b1614-225">N2</span></span> | | | |
| <span data-ttu-id="b1614-226">**UD2**</span><span class="sxs-lookup"><span data-stu-id="b1614-226">**UD2**</span></span> | | |<span data-ttu-id="b1614-227">N3</span><span class="sxs-lookup"><span data-stu-id="b1614-227">N3</span></span> | | |
| <span data-ttu-id="b1614-228">**UD3**</span><span class="sxs-lookup"><span data-stu-id="b1614-228">**UD3**</span></span> | | | |<span data-ttu-id="b1614-229">N4</span><span class="sxs-lookup"><span data-stu-id="b1614-229">N4</span></span> | |
| <span data-ttu-id="b1614-230">**UD4**</span><span class="sxs-lookup"><span data-stu-id="b1614-230">**UD4**</span></span> | | | | |<span data-ttu-id="b1614-231">N5</span><span class="sxs-lookup"><span data-stu-id="b1614-231">N5</span></span> |

<span data-ttu-id="b1614-232">Nyní Řekněme, že jsme pěti vytvořit službu s TargetReplicaSetSize (nebo bezstavové služby na InstanceCount).</span><span class="sxs-lookup"><span data-stu-id="b1614-232">Now let's say that we create a service with a TargetReplicaSetSize (or, for a stateless service an InstanceCount) of five.</span></span> <span data-ttu-id="b1614-233">repliky Hello zobrazovat N1 N5.</span><span class="sxs-lookup"><span data-stu-id="b1614-233">hello replicas land on N1-N5.</span></span> <span data-ttu-id="b1614-234">Ve skutečnosti N6 se nikdy nepoužívá bez ohledu na to, kolik služby, jako to, které vytvoříte.</span><span class="sxs-lookup"><span data-stu-id="b1614-234">In fact, N6 is never used no matter how many services like this you create.</span></span> <span data-ttu-id="b1614-235">Ale proč?</span><span class="sxs-lookup"><span data-stu-id="b1614-235">But why?</span></span> <span data-ttu-id="b1614-236">Podívejme se na hello rozdíl mezi hello aktuální rozložení a co by mohlo dojít, pokud je zvoleno N6.</span><span class="sxs-lookup"><span data-stu-id="b1614-236">Let's look at hello difference between hello current layout and what would happen if N6 is chosen.</span></span>

<span data-ttu-id="b1614-237">Tady je hello rozložení jsme tu a hello celkového počtu replik na selhání a upgradu domény:</span><span class="sxs-lookup"><span data-stu-id="b1614-237">Here's hello layout we got and hello total number of replicas per Fault and Upgrade Domain:</span></span>

|  | <span data-ttu-id="b1614-238">FD0</span><span class="sxs-lookup"><span data-stu-id="b1614-238">FD0</span></span> | <span data-ttu-id="b1614-239">FD1</span><span class="sxs-lookup"><span data-stu-id="b1614-239">FD1</span></span> | <span data-ttu-id="b1614-240">FD2:</span><span class="sxs-lookup"><span data-stu-id="b1614-240">FD2</span></span> | <span data-ttu-id="b1614-241">FD3</span><span class="sxs-lookup"><span data-stu-id="b1614-241">FD3</span></span> | <span data-ttu-id="b1614-242">FD4</span><span class="sxs-lookup"><span data-stu-id="b1614-242">FD4</span></span> | <span data-ttu-id="b1614-243">UDTotal</span><span class="sxs-lookup"><span data-stu-id="b1614-243">UDTotal</span></span> |
| --- |:---:|:---:|:---:|:---:|:---:|:---:|
| <span data-ttu-id="b1614-244">**UD0**</span><span class="sxs-lookup"><span data-stu-id="b1614-244">**UD0**</span></span> |<span data-ttu-id="b1614-245">R1</span><span class="sxs-lookup"><span data-stu-id="b1614-245">R1</span></span> | | | | |<span data-ttu-id="b1614-246">1</span><span class="sxs-lookup"><span data-stu-id="b1614-246">1</span></span> |
| <span data-ttu-id="b1614-247">**UD1**</span><span class="sxs-lookup"><span data-stu-id="b1614-247">**UD1**</span></span> | |<span data-ttu-id="b1614-248">R2</span><span class="sxs-lookup"><span data-stu-id="b1614-248">R2</span></span> | | | |<span data-ttu-id="b1614-249">1</span><span class="sxs-lookup"><span data-stu-id="b1614-249">1</span></span> |
| <span data-ttu-id="b1614-250">**UD2**</span><span class="sxs-lookup"><span data-stu-id="b1614-250">**UD2**</span></span> | | |<span data-ttu-id="b1614-251">R3</span><span class="sxs-lookup"><span data-stu-id="b1614-251">R3</span></span> | | |<span data-ttu-id="b1614-252">1</span><span class="sxs-lookup"><span data-stu-id="b1614-252">1</span></span> |
| <span data-ttu-id="b1614-253">**UD3**</span><span class="sxs-lookup"><span data-stu-id="b1614-253">**UD3**</span></span> | | | |<span data-ttu-id="b1614-254">R4</span><span class="sxs-lookup"><span data-stu-id="b1614-254">R4</span></span> | |<span data-ttu-id="b1614-255">1</span><span class="sxs-lookup"><span data-stu-id="b1614-255">1</span></span> |
| <span data-ttu-id="b1614-256">**UD4**</span><span class="sxs-lookup"><span data-stu-id="b1614-256">**UD4**</span></span> | | | | |<span data-ttu-id="b1614-257">R5</span><span class="sxs-lookup"><span data-stu-id="b1614-257">R5</span></span> |<span data-ttu-id="b1614-258">1</span><span class="sxs-lookup"><span data-stu-id="b1614-258">1</span></span> |
| <span data-ttu-id="b1614-259">**FDTotal**</span><span class="sxs-lookup"><span data-stu-id="b1614-259">**FDTotal**</span></span> |<span data-ttu-id="b1614-260">1</span><span class="sxs-lookup"><span data-stu-id="b1614-260">1</span></span> |<span data-ttu-id="b1614-261">1</span><span class="sxs-lookup"><span data-stu-id="b1614-261">1</span></span> |<span data-ttu-id="b1614-262">1</span><span class="sxs-lookup"><span data-stu-id="b1614-262">1</span></span> |<span data-ttu-id="b1614-263">1</span><span class="sxs-lookup"><span data-stu-id="b1614-263">1</span></span> |<span data-ttu-id="b1614-264">1</span><span class="sxs-lookup"><span data-stu-id="b1614-264">1</span></span> |- |

<span data-ttu-id="b1614-265">Toto rozložení jsou rovnoměrně z hlediska uzlů na doméně selhání a upgradu domény.</span><span class="sxs-lookup"><span data-stu-id="b1614-265">This layout is balanced in terms of nodes per Fault Domain and Upgrade Domain.</span></span> <span data-ttu-id="b1614-266">Toto pravidlo jsou rovnoměrně také z hlediska hello počet replik na selhání a upgradu domény.</span><span class="sxs-lookup"><span data-stu-id="b1614-266">It is also balanced in terms of hello number of replicas per Fault and Upgrade Domain.</span></span> <span data-ttu-id="b1614-267">Každá doména má hello stejný počet uzlů a hello stejný počet replik.</span><span class="sxs-lookup"><span data-stu-id="b1614-267">Each domain has hello same number of nodes and hello same number of replicas.</span></span>

<span data-ttu-id="b1614-268">Teď se podíváme, co by se stalo jsme použití N6 místo N2.</span><span class="sxs-lookup"><span data-stu-id="b1614-268">Now, let's look at what would happen if we'd used N6 instead of N2.</span></span> <span data-ttu-id="b1614-269">Jak by hello repliky distribuována pak?</span><span class="sxs-lookup"><span data-stu-id="b1614-269">How would hello replicas be distributed then?</span></span>

|  | <span data-ttu-id="b1614-270">FD0</span><span class="sxs-lookup"><span data-stu-id="b1614-270">FD0</span></span> | <span data-ttu-id="b1614-271">FD1</span><span class="sxs-lookup"><span data-stu-id="b1614-271">FD1</span></span> | <span data-ttu-id="b1614-272">FD2:</span><span class="sxs-lookup"><span data-stu-id="b1614-272">FD2</span></span> | <span data-ttu-id="b1614-273">FD3</span><span class="sxs-lookup"><span data-stu-id="b1614-273">FD3</span></span> | <span data-ttu-id="b1614-274">FD4</span><span class="sxs-lookup"><span data-stu-id="b1614-274">FD4</span></span> | <span data-ttu-id="b1614-275">UDTotal</span><span class="sxs-lookup"><span data-stu-id="b1614-275">UDTotal</span></span> |
| --- |:---:|:---:|:---:|:---:|:---:|:---:|
| <span data-ttu-id="b1614-276">**UD0**</span><span class="sxs-lookup"><span data-stu-id="b1614-276">**UD0**</span></span> |<span data-ttu-id="b1614-277">R1</span><span class="sxs-lookup"><span data-stu-id="b1614-277">R1</span></span> | | | | |<span data-ttu-id="b1614-278">1</span><span class="sxs-lookup"><span data-stu-id="b1614-278">1</span></span> |
| <span data-ttu-id="b1614-279">**UD1**</span><span class="sxs-lookup"><span data-stu-id="b1614-279">**UD1**</span></span> |<span data-ttu-id="b1614-280">R5</span><span class="sxs-lookup"><span data-stu-id="b1614-280">R5</span></span> | | | | |<span data-ttu-id="b1614-281">1</span><span class="sxs-lookup"><span data-stu-id="b1614-281">1</span></span> |
| <span data-ttu-id="b1614-282">**UD2**</span><span class="sxs-lookup"><span data-stu-id="b1614-282">**UD2**</span></span> | | |<span data-ttu-id="b1614-283">R2</span><span class="sxs-lookup"><span data-stu-id="b1614-283">R2</span></span> | | |<span data-ttu-id="b1614-284">1</span><span class="sxs-lookup"><span data-stu-id="b1614-284">1</span></span> |
| <span data-ttu-id="b1614-285">**UD3**</span><span class="sxs-lookup"><span data-stu-id="b1614-285">**UD3**</span></span> | | | |<span data-ttu-id="b1614-286">R3</span><span class="sxs-lookup"><span data-stu-id="b1614-286">R3</span></span> | |<span data-ttu-id="b1614-287">1</span><span class="sxs-lookup"><span data-stu-id="b1614-287">1</span></span> |
| <span data-ttu-id="b1614-288">**UD4**</span><span class="sxs-lookup"><span data-stu-id="b1614-288">**UD4**</span></span> | | | | |<span data-ttu-id="b1614-289">R4</span><span class="sxs-lookup"><span data-stu-id="b1614-289">R4</span></span> |<span data-ttu-id="b1614-290">1</span><span class="sxs-lookup"><span data-stu-id="b1614-290">1</span></span> |
| <span data-ttu-id="b1614-291">**FDTotal**</span><span class="sxs-lookup"><span data-stu-id="b1614-291">**FDTotal**</span></span> |<span data-ttu-id="b1614-292">2</span><span class="sxs-lookup"><span data-stu-id="b1614-292">2</span></span> |<span data-ttu-id="b1614-293">0</span><span class="sxs-lookup"><span data-stu-id="b1614-293">0</span></span> |<span data-ttu-id="b1614-294">1</span><span class="sxs-lookup"><span data-stu-id="b1614-294">1</span></span> |<span data-ttu-id="b1614-295">1</span><span class="sxs-lookup"><span data-stu-id="b1614-295">1</span></span> |<span data-ttu-id="b1614-296">1</span><span class="sxs-lookup"><span data-stu-id="b1614-296">1</span></span> |- |

<span data-ttu-id="b1614-297">Toto rozložení porušuje naše definice hello omezení domény selhání.</span><span class="sxs-lookup"><span data-stu-id="b1614-297">This layout violates our definition for hello Fault Domain constraint.</span></span> <span data-ttu-id="b1614-298">FD0 má dvě repliky, zatímco FD1 má nula, které hello rozdíl mezi FD0 a FD1 celkem dva.</span><span class="sxs-lookup"><span data-stu-id="b1614-298">FD0 has two replicas, while FD1 has zero, making hello difference between FD0 and FD1 a total of two.</span></span> <span data-ttu-id="b1614-299">Toto uspořádání Hello správce prostředků clusteru není povoleno.</span><span class="sxs-lookup"><span data-stu-id="b1614-299">hello Cluster Resource Manager does not allow this arrangement.</span></span> <span data-ttu-id="b1614-300">Podobně pokud jsme zachyceny N2 a N6 (namísto N1 a N2) nám se získat:</span><span class="sxs-lookup"><span data-stu-id="b1614-300">Similarly if we picked N2 and N6 (instead of N1 and N2) we'd get:</span></span>

|  | <span data-ttu-id="b1614-301">FD0</span><span class="sxs-lookup"><span data-stu-id="b1614-301">FD0</span></span> | <span data-ttu-id="b1614-302">FD1</span><span class="sxs-lookup"><span data-stu-id="b1614-302">FD1</span></span> | <span data-ttu-id="b1614-303">FD2:</span><span class="sxs-lookup"><span data-stu-id="b1614-303">FD2</span></span> | <span data-ttu-id="b1614-304">FD3</span><span class="sxs-lookup"><span data-stu-id="b1614-304">FD3</span></span> | <span data-ttu-id="b1614-305">FD4</span><span class="sxs-lookup"><span data-stu-id="b1614-305">FD4</span></span> | <span data-ttu-id="b1614-306">UDTotal</span><span class="sxs-lookup"><span data-stu-id="b1614-306">UDTotal</span></span> |
| --- |:---:|:---:|:---:|:---:|:---:|:---:|
| <span data-ttu-id="b1614-307">**UD0**</span><span class="sxs-lookup"><span data-stu-id="b1614-307">**UD0**</span></span> | | | | | |<span data-ttu-id="b1614-308">0</span><span class="sxs-lookup"><span data-stu-id="b1614-308">0</span></span> |
| <span data-ttu-id="b1614-309">**UD1**</span><span class="sxs-lookup"><span data-stu-id="b1614-309">**UD1**</span></span> |<span data-ttu-id="b1614-310">R5</span><span class="sxs-lookup"><span data-stu-id="b1614-310">R5</span></span> |<span data-ttu-id="b1614-311">R1</span><span class="sxs-lookup"><span data-stu-id="b1614-311">R1</span></span> | | | |<span data-ttu-id="b1614-312">2</span><span class="sxs-lookup"><span data-stu-id="b1614-312">2</span></span> |
| <span data-ttu-id="b1614-313">**UD2**</span><span class="sxs-lookup"><span data-stu-id="b1614-313">**UD2**</span></span> | | |<span data-ttu-id="b1614-314">R2</span><span class="sxs-lookup"><span data-stu-id="b1614-314">R2</span></span> | | |<span data-ttu-id="b1614-315">1</span><span class="sxs-lookup"><span data-stu-id="b1614-315">1</span></span> |
| <span data-ttu-id="b1614-316">**UD3**</span><span class="sxs-lookup"><span data-stu-id="b1614-316">**UD3**</span></span> | | | |<span data-ttu-id="b1614-317">R3</span><span class="sxs-lookup"><span data-stu-id="b1614-317">R3</span></span> | |<span data-ttu-id="b1614-318">1</span><span class="sxs-lookup"><span data-stu-id="b1614-318">1</span></span> |
| <span data-ttu-id="b1614-319">**UD4**</span><span class="sxs-lookup"><span data-stu-id="b1614-319">**UD4**</span></span> | | | | |<span data-ttu-id="b1614-320">R4</span><span class="sxs-lookup"><span data-stu-id="b1614-320">R4</span></span> |<span data-ttu-id="b1614-321">1</span><span class="sxs-lookup"><span data-stu-id="b1614-321">1</span></span> |
| <span data-ttu-id="b1614-322">**FDTotal**</span><span class="sxs-lookup"><span data-stu-id="b1614-322">**FDTotal**</span></span> |<span data-ttu-id="b1614-323">1</span><span class="sxs-lookup"><span data-stu-id="b1614-323">1</span></span> |<span data-ttu-id="b1614-324">1</span><span class="sxs-lookup"><span data-stu-id="b1614-324">1</span></span> |<span data-ttu-id="b1614-325">1</span><span class="sxs-lookup"><span data-stu-id="b1614-325">1</span></span> |<span data-ttu-id="b1614-326">1</span><span class="sxs-lookup"><span data-stu-id="b1614-326">1</span></span> |<span data-ttu-id="b1614-327">1</span><span class="sxs-lookup"><span data-stu-id="b1614-327">1</span></span> |- |

<span data-ttu-id="b1614-328">Toto rozložení jsou rovnoměrně z hlediska domén selhání.</span><span class="sxs-lookup"><span data-stu-id="b1614-328">This layout is balanced in terms of Fault Domains.</span></span> <span data-ttu-id="b1614-329">Ale nyní ho porušuje omezení upgradu domény hello.</span><span class="sxs-lookup"><span data-stu-id="b1614-329">However, now it's violating hello Upgrade Domain constraint.</span></span> <span data-ttu-id="b1614-330">To je proto UD0 má nulové repliky, zatímco UD1 má dva.</span><span class="sxs-lookup"><span data-stu-id="b1614-330">This is because UD0 has zero replicas while UD1 has two.</span></span> <span data-ttu-id="b1614-331">Toto rozložení proto je neplatná a nebude vybráno tím hello správce prostředků clusteru.</span><span class="sxs-lookup"><span data-stu-id="b1614-331">Therefore, this layout is also invalid and won't be picked by hello Cluster Resource Manager.</span></span> 

## <a name="configuring-fault-and-upgrade-domains"></a><span data-ttu-id="b1614-332">Konfigurace selhání a upgradu domény</span><span class="sxs-lookup"><span data-stu-id="b1614-332">Configuring fault and Upgrade Domains</span></span>
<span data-ttu-id="b1614-333">Definování domén selhání a upgradu domény se provádí automaticky v Azure hostovaná nasazení Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="b1614-333">Defining Fault Domains and Upgrade Domains is done automatically in Azure hosted Service Fabric deployments.</span></span> <span data-ttu-id="b1614-334">Service Fabric převezme a používá informace o prostředí hello z Azure.</span><span class="sxs-lookup"><span data-stu-id="b1614-334">Service Fabric picks up and uses hello environment information from Azure.</span></span>

<span data-ttu-id="b1614-335">Pokud vytváříte vlastní cluster (nebo má toorun topologii konkrétní vývojem), můžete zadat informace o doméně selhání a upgradu domény hello sami.</span><span class="sxs-lookup"><span data-stu-id="b1614-335">If you’re creating your own cluster (or want toorun a particular topology in development), you can provide hello Fault Domain and Upgrade Domain information yourself.</span></span> <span data-ttu-id="b1614-336">V tomto příkladu jsme definovali místní vývojový cluster devět uzlu, který zahrnuje tři "datových centrech" (každý má tři stojany).</span><span class="sxs-lookup"><span data-stu-id="b1614-336">In this example, we define a nine node local development cluster that spans three “datacenters” (each with three racks).</span></span> <span data-ttu-id="b1614-337">Tento cluster má také tři domény upgradu rozdělená mezi tyto tři datových centrech.</span><span class="sxs-lookup"><span data-stu-id="b1614-337">This cluster also has three Upgrade Domains striped across those three datacenters.</span></span> <span data-ttu-id="b1614-338">Zde je příklad konfigurace hello:</span><span class="sxs-lookup"><span data-stu-id="b1614-338">An example of hello configuration is below:</span></span> 

<span data-ttu-id="b1614-339">ClusterManifest.xml</span><span class="sxs-lookup"><span data-stu-id="b1614-339">ClusterManifest.xml</span></span>

```xml
  <Infrastructure>
    <!-- IsScaleMin indicates that this cluster runs on one-box /one single server -->
    <WindowsServer IsScaleMin="true">
      <NodeList>
        <Node NodeName="Node01" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType01" FaultDomain="fd:/DC01/Rack01" UpgradeDomain="UpgradeDomain1" IsSeedNode="true" />
        <Node NodeName="Node02" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType02" FaultDomain="fd:/DC01/Rack02" UpgradeDomain="UpgradeDomain2" IsSeedNode="true" />
        <Node NodeName="Node03" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType03" FaultDomain="fd:/DC01/Rack03" UpgradeDomain="UpgradeDomain3" IsSeedNode="true" />
        <Node NodeName="Node04" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType04" FaultDomain="fd:/DC02/Rack01" UpgradeDomain="UpgradeDomain1" IsSeedNode="true" />
        <Node NodeName="Node05" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType05" FaultDomain="fd:/DC02/Rack02" UpgradeDomain="UpgradeDomain2" IsSeedNode="true" />
        <Node NodeName="Node06" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType06" FaultDomain="fd:/DC02/Rack03" UpgradeDomain="UpgradeDomain3" IsSeedNode="true" />
        <Node NodeName="Node07" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType07" FaultDomain="fd:/DC03/Rack01" UpgradeDomain="UpgradeDomain1" IsSeedNode="true" />
        <Node NodeName="Node08" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType08" FaultDomain="fd:/DC03/Rack02" UpgradeDomain="UpgradeDomain2" IsSeedNode="true" />
        <Node NodeName="Node09" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType09" FaultDomain="fd:/DC03/Rack03" UpgradeDomain="UpgradeDomain3" IsSeedNode="true" />
      </NodeList>
    </WindowsServer>
  </Infrastructure>
```

<span data-ttu-id="b1614-340">pomocí souboru ClusterConfig.json pro samostatné nasazení</span><span class="sxs-lookup"><span data-stu-id="b1614-340">via ClusterConfig.json for Standalone deployments</span></span>

```json
"nodes": [
  {
    "nodeName": "vm1",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc1/r0",
    "upgradeDomain": "UD1"
  },
  {
    "nodeName": "vm2",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc1/r0",
    "upgradeDomain": "UD2"
  },
  {
    "nodeName": "vm3",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc1/r0",
    "upgradeDomain": "UD3"
  },
  {
    "nodeName": "vm4",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc2/r0",
    "upgradeDomain": "UD1"
  },
  {
    "nodeName": "vm5",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc2/r0",
    "upgradeDomain": "UD2"
  },
  {
    "nodeName": "vm6",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc2/r0",
    "upgradeDomain": "UD3"
  },
  {
    "nodeName": "vm7",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc3/r0",
    "upgradeDomain": "UD1"
  },
  {
    "nodeName": "vm8",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc3/r0",
    "upgradeDomain": "UD2"
  },
  {
    "nodeName": "vm9",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc3/r0",
    "upgradeDomain": "UD3"
  }
],
```

> [!NOTE]
> <span data-ttu-id="b1614-341">Při definování clusterů pomocí Azure Resource Manager, jsou přiřazeny domén selhání a upgradu domény Azure.</span><span class="sxs-lookup"><span data-stu-id="b1614-341">When defining clusters via Azure Resource Manager, Fault Domains and Upgrade Domains are assigned by Azure.</span></span> <span data-ttu-id="b1614-342">Proto hello definice typů uzlů a sady škálování virtuálního počítače do šablony Azure Resource Manager nezahrnuje doména selhání nebo informace o upgradu domény.</span><span class="sxs-lookup"><span data-stu-id="b1614-342">Therefore, hello definition of your Node Types and Virtual Machine Scale Sets in your Azure Resource Manager template does not include Fault Domain or Upgrade Domain information.</span></span>
>

## <a name="node-properties-and-placement-constraints"></a><span data-ttu-id="b1614-343">Vlastnosti uzlu a omezení umístění</span><span class="sxs-lookup"><span data-stu-id="b1614-343">Node properties and placement constraints</span></span>
<span data-ttu-id="b1614-344">V některých případech (v faktu, většinu času hello) budete tooensure toowant, který určité úlohy spustit pouze v určitých typů uzlů v clusteru hello.</span><span class="sxs-lookup"><span data-stu-id="b1614-344">Sometimes (in fact, most of hello time) you’re going toowant tooensure that certain workloads run only on certain types of nodes in hello cluster.</span></span> <span data-ttu-id="b1614-345">Pro některé zatížení může například vyžadovat grafickými procesory nebo SSD a jiné nikoli.</span><span class="sxs-lookup"><span data-stu-id="b1614-345">For example, some workload may require GPUs or SSDs while others may not.</span></span> <span data-ttu-id="b1614-346">Skvělé příklad cílových hardwaru tooparticular úlohy je téměř každé n vrstvá architektura odhlašování došlo.</span><span class="sxs-lookup"><span data-stu-id="b1614-346">A great example of targeting hardware tooparticular workloads is almost every n-tier architecture out there.</span></span> <span data-ttu-id="b1614-347">Některé počítače slouží jako hello front-endu nebo API obsluhující strana hello aplikace a jsou zveřejněné toohello klienty nebo hello Internetu.</span><span class="sxs-lookup"><span data-stu-id="b1614-347">Certain machines serve as hello front end or API serving side of hello application and are exposed toohello clients or hello internet.</span></span> <span data-ttu-id="b1614-348">Různé počítače, často se různé hardwarové prostředky, zpracování pracovní hello hello výpočtů nebo úložiště vrstev.</span><span class="sxs-lookup"><span data-stu-id="b1614-348">Different machines, often with different hardware resources, handle hello work of hello compute or storage layers.</span></span> <span data-ttu-id="b1614-349">Obvykle se jedná o _není_ přímo vystavena tooclients nebo hello Internetu.</span><span class="sxs-lookup"><span data-stu-id="b1614-349">These are usually _not_ directly exposed tooclients or hello internet.</span></span> <span data-ttu-id="b1614-350">Service Fabric očekává, že jsou případy, kde konkrétní úlohy musí toorun na konkrétní hardwarové konfigurace.</span><span class="sxs-lookup"><span data-stu-id="b1614-350">Service Fabric expects that there are cases where particular workloads need toorun on particular hardware configurations.</span></span> <span data-ttu-id="b1614-351">Například:</span><span class="sxs-lookup"><span data-stu-id="b1614-351">For example:</span></span>

* <span data-ttu-id="b1614-352">stávající vícevrstvé aplikace byla "zrušeno a zapuštěno" do prostředí Service Fabric</span><span class="sxs-lookup"><span data-stu-id="b1614-352">an existing n-tier application has been “lifted and shifted” into a Service Fabric environment</span></span>
* <span data-ttu-id="b1614-353">zatížení chce toorun na konkrétní hardware pro výkon, škálování nebo z důvodů zabezpečení izolace</span><span class="sxs-lookup"><span data-stu-id="b1614-353">a workload wants toorun on specific hardware for performance, scale, or security isolation reasons</span></span>
* <span data-ttu-id="b1614-354">Úloha by měla být izolované od ostatních úloh pro zásady nebo prostředek spotřebu důvody</span><span class="sxs-lookup"><span data-stu-id="b1614-354">A workload should be isolated from other workloads for policy or resource consumption reasons</span></span>

<span data-ttu-id="b1614-355">toosupport tyto řazení konfigurací služby prostředků infrastruktury je první třídy představu o značky, které můžou být použité toonodes.</span><span class="sxs-lookup"><span data-stu-id="b1614-355">toosupport these sorts of configurations, Service Fabric has a first class notion of tags that can be applied toonodes.</span></span> <span data-ttu-id="b1614-356">Tyto značky se nazývají **vlastnosti uzlu**.</span><span class="sxs-lookup"><span data-stu-id="b1614-356">These tags are called **node properties**.</span></span> <span data-ttu-id="b1614-357">**Omezení umístění** jsou příkazy hello připojené tooindividual služby, které vyberete pro jednu nebo více vlastností uzlu.</span><span class="sxs-lookup"><span data-stu-id="b1614-357">**Placement constraints** are hello statements attached tooindividual services that select for one or more node properties.</span></span> <span data-ttu-id="b1614-358">Omezení umístění definovat, které by měly běžet služby.</span><span class="sxs-lookup"><span data-stu-id="b1614-358">Placement constraints define where services should run.</span></span> <span data-ttu-id="b1614-359">Sada Hello omezení je rozšiřitelný – může fungovat všechny dvojice klíč/hodnota.</span><span class="sxs-lookup"><span data-stu-id="b1614-359">hello set of constraints is extensible - any key/value pair can work.</span></span> 

<span data-ttu-id="b1614-360"><center>
![Různé rozložení zatížení clusteru][Image5]
</center></span><span class="sxs-lookup"><span data-stu-id="b1614-360"><center>
![Cluster Layout Different Workloads][Image5]
</center></span></span>

### <a name="built-in-node-properties"></a><span data-ttu-id="b1614-361">Součástí vlastnosti uzlu</span><span class="sxs-lookup"><span data-stu-id="b1614-361">Built in node properties</span></span>
<span data-ttu-id="b1614-362">Service Fabric definuje některé výchozí uzel vlastnosti, které lze použít automaticky bez nutnosti toodefine uživatele hello je.</span><span class="sxs-lookup"><span data-stu-id="b1614-362">Service Fabric defines some default node properties that can be used automatically without hello user having toodefine them.</span></span> <span data-ttu-id="b1614-363">Hello výchozí vlastnosti definované v každém uzlu jsou hello **NodeType** a hello **NodeName**.</span><span class="sxs-lookup"><span data-stu-id="b1614-363">hello default properties defined at each node are hello **NodeType** and hello **NodeName**.</span></span> <span data-ttu-id="b1614-364">Můžete napsat tak například omezení umístění jako `"(NodeType == NodeType03)"`.</span><span class="sxs-lookup"><span data-stu-id="b1614-364">So for example you could write a placement constraint as `"(NodeType == NodeType03)"`.</span></span> <span data-ttu-id="b1614-365">Obecně našli jsme NodeType toobe jedna z vlastností hello nejčastěji používají.</span><span class="sxs-lookup"><span data-stu-id="b1614-365">Generally we have found NodeType toobe one of hello most commonly used properties.</span></span> <span data-ttu-id="b1614-366">Je vhodné vzhledem k tomu, že odpovídá 1:1 s typem počítače.</span><span class="sxs-lookup"><span data-stu-id="b1614-366">It is useful since it corresponds 1:1 with a type of a machine.</span></span> <span data-ttu-id="b1614-367">Každý typ počítače odpovídá tooa typu úlohy v tradiční n vrstvá aplikaci.</span><span class="sxs-lookup"><span data-stu-id="b1614-367">Each type of machine corresponds tooa type of workload in a traditional n-tier application.</span></span>

<span data-ttu-id="b1614-368"><center>
![Omezení umístění a vlastnosti uzlu][Image6]
</center></span><span class="sxs-lookup"><span data-stu-id="b1614-368"><center>
![Placement Constraints and Node Properties][Image6]
</center></span></span>

## <a name="placement-constraint-and-node-property-syntax"></a><span data-ttu-id="b1614-369">Omezení umístění a syntaxe vlastnosti uzlu</span><span class="sxs-lookup"><span data-stu-id="b1614-369">Placement Constraint and Node Property Syntax</span></span> 
<span data-ttu-id="b1614-370">Hodnota Hello zadaná ve vlastnosti uzlu hello může být řetězec, bool, nebo podepsané dlouho.</span><span class="sxs-lookup"><span data-stu-id="b1614-370">hello value specified in hello node property can be a string, bool, or signed long.</span></span> <span data-ttu-id="b1614-371">příkaz Hello u služby hello se označuje jako umístění *omezení* vzhledem k tomu, že omezuje kde hello služba může běžet v clusteru hello.</span><span class="sxs-lookup"><span data-stu-id="b1614-371">hello statement at hello service is called a placement *constraint* since it constrains where hello service can run in hello cluster.</span></span> <span data-ttu-id="b1614-372">Hello omezení může být jakékoli Boolean příkaz, který funguje na vlastnosti hello jiného uzlu v clusteru hello.</span><span class="sxs-lookup"><span data-stu-id="b1614-372">hello constraint can be any Boolean statement that operates on hello different node properties in hello cluster.</span></span> <span data-ttu-id="b1614-373">Hello platný selektory v těchto příkazech boolean jsou:</span><span class="sxs-lookup"><span data-stu-id="b1614-373">hello valid selectors in these boolean statements are:</span></span>

1) <span data-ttu-id="b1614-374">Podmíněné kontroly pro vytvoření konkrétní příkazy</span><span class="sxs-lookup"><span data-stu-id="b1614-374">conditional checks for creating particular statements</span></span>

| <span data-ttu-id="b1614-375">Příkaz</span><span class="sxs-lookup"><span data-stu-id="b1614-375">Statement</span></span> | <span data-ttu-id="b1614-376">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="b1614-376">Syntax</span></span> |
| --- |:---:|
| <span data-ttu-id="b1614-377">"rovno"</span><span class="sxs-lookup"><span data-stu-id="b1614-377">"equal to"</span></span> | <span data-ttu-id="b1614-378">"=="</span><span class="sxs-lookup"><span data-stu-id="b1614-378">"=="</span></span> |
| <span data-ttu-id="b1614-379">"není rovno"</span><span class="sxs-lookup"><span data-stu-id="b1614-379">"not equal to"</span></span> | <span data-ttu-id="b1614-380">"!="</span><span class="sxs-lookup"><span data-stu-id="b1614-380">"!="</span></span> |
| <span data-ttu-id="b1614-381">"větší než"</span><span class="sxs-lookup"><span data-stu-id="b1614-381">"greater than"</span></span> | <span data-ttu-id="b1614-382">">"</span><span class="sxs-lookup"><span data-stu-id="b1614-382">">"</span></span> |
| <span data-ttu-id="b1614-383">"větší než nebo rovno"</span><span class="sxs-lookup"><span data-stu-id="b1614-383">"greater than or equal to"</span></span> | <span data-ttu-id="b1614-384">">="</span><span class="sxs-lookup"><span data-stu-id="b1614-384">">="</span></span> |
| <span data-ttu-id="b1614-385">"menší než"</span><span class="sxs-lookup"><span data-stu-id="b1614-385">"less than"</span></span> | <span data-ttu-id="b1614-386">"<"</span><span class="sxs-lookup"><span data-stu-id="b1614-386">"<"</span></span> |
| <span data-ttu-id="b1614-387">"menší než nebo rovno"</span><span class="sxs-lookup"><span data-stu-id="b1614-387">"less than or equal to"</span></span> | <span data-ttu-id="b1614-388">"<="</span><span class="sxs-lookup"><span data-stu-id="b1614-388">"<="</span></span> |

2) <span data-ttu-id="b1614-389">Logická hodnota příkazy pro seskupování a logické operace</span><span class="sxs-lookup"><span data-stu-id="b1614-389">boolean statements for grouping and logical operations</span></span>

| <span data-ttu-id="b1614-390">Příkaz</span><span class="sxs-lookup"><span data-stu-id="b1614-390">Statement</span></span> | <span data-ttu-id="b1614-391">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="b1614-391">Syntax</span></span> |
| --- |:---:|
| <span data-ttu-id="b1614-392">"a"</span><span class="sxs-lookup"><span data-stu-id="b1614-392">"and"</span></span> | <span data-ttu-id="b1614-393">"&&"</span><span class="sxs-lookup"><span data-stu-id="b1614-393">"&&"</span></span> |
| <span data-ttu-id="b1614-394">"nebo"</span><span class="sxs-lookup"><span data-stu-id="b1614-394">"or"</span></span> | <span data-ttu-id="b1614-395">"&#124;&#124;"</span><span class="sxs-lookup"><span data-stu-id="b1614-395">"&#124;&#124;"</span></span> |
| <span data-ttu-id="b1614-396">"Ne"</span><span class="sxs-lookup"><span data-stu-id="b1614-396">"not"</span></span> | <span data-ttu-id="b1614-397">"!"</span><span class="sxs-lookup"><span data-stu-id="b1614-397">"!"</span></span> |
| <span data-ttu-id="b1614-398">"skupiny jako jediný příkaz"</span><span class="sxs-lookup"><span data-stu-id="b1614-398">"group as single statement"</span></span> | <span data-ttu-id="b1614-399">"()"</span><span class="sxs-lookup"><span data-stu-id="b1614-399">"()"</span></span> |

<span data-ttu-id="b1614-400">Zde jsou některé příklady příkazů základní omezení.</span><span class="sxs-lookup"><span data-stu-id="b1614-400">Here are some examples of basic constraint statements.</span></span>

  * `"Value >= 5"`
  * `"NodeColor != green"`
  * `"((OneProperty < 100) || ((AnotherProperty == false) && (OneProperty >= 100)))"`

<span data-ttu-id="b1614-401">Služba hello umístit na něm může mít pouze uzly, kde hello celkové příkaz omezení umístění vyhodnotí příliš "True".</span><span class="sxs-lookup"><span data-stu-id="b1614-401">Only nodes where hello overall placement constraint statement evaluates too“True” can have hello service placed on it.</span></span> <span data-ttu-id="b1614-402">Uzly, které nemají vlastnost definovanou se neshodují žádné omezení umístění obsahující tuto vlastnost.</span><span class="sxs-lookup"><span data-stu-id="b1614-402">Nodes that do not have a property defined do not match any placement constraint containing that property.</span></span>

<span data-ttu-id="b1614-403">Řekněme, že hello následující uzlu, které byly definovány vlastnosti pro typ daného uzlu:</span><span class="sxs-lookup"><span data-stu-id="b1614-403">Let’s say that hello following node properties were defined for a given node type:</span></span>

<span data-ttu-id="b1614-404">ClusterManifest.xml</span><span class="sxs-lookup"><span data-stu-id="b1614-404">ClusterManifest.xml</span></span>

```xml
    <NodeType Name="NodeType01">
      <PlacementProperties>
        <Property Name="HasSSD" Value="true"/>
        <Property Name="NodeColor" Value="green"/>
        <Property Name="SomeProperty" Value="5"/>
      </PlacementProperties>
    </NodeType>
```

<span data-ttu-id="b1614-405">pomocí souboru ClusterConfig.json pro samostatné nasazení nebo Template.json pro Azure hostované clustery.</span><span class="sxs-lookup"><span data-stu-id="b1614-405">via ClusterConfig.json for Standalone deployments or Template.json for Azure hosted clusters.</span></span> 

> [!NOTE]
> <span data-ttu-id="b1614-406">V uzlu hello šablony Azure Resource Manager je obvykle parametry typu.</span><span class="sxs-lookup"><span data-stu-id="b1614-406">In your Azure Resource Manager template hello node type is usually parameterized.</span></span> <span data-ttu-id="b1614-407">Může vypadat třeba "[parameters('vmNodeType1Name')]" místo "NodeType01".</span><span class="sxs-lookup"><span data-stu-id="b1614-407">It would look like "[parameters('vmNodeType1Name')]" rather than "NodeType01".</span></span>
>

```json
"nodeTypes": [
    {
        "name": "NodeType01",
        "placementProperties": {
            "HasSSD": "true",
            "NodeColor": "green",
            "SomeProperty": "5"
        },
    }
],
```

<span data-ttu-id="b1614-408">Můžete vytvořit umístění služby *omezení* pro službu, jako následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="b1614-408">You can create service placement *constraints* for a service like as follows:</span></span>

<span data-ttu-id="b1614-409">C#</span><span class="sxs-lookup"><span data-stu-id="b1614-409">C#</span></span>

```csharp
FabricClient fabricClient = new FabricClient();
StatefulServiceDescription serviceDescription = new StatefulServiceDescription();
serviceDescription.PlacementConstraints = "(HasSSD == true && SomeProperty >= 4)";
// add other required servicedescription fields
//...
await fabricClient.ServiceManager.CreateServiceAsync(serviceDescription);
```

<span data-ttu-id="b1614-410">Prostředí PowerShell:</span><span class="sxs-lookup"><span data-stu-id="b1614-410">Powershell:</span></span>

```posh
New-ServiceFabricService -ApplicationName $applicationName -ServiceName $serviceName -ServiceTypeName $serviceType -Stateful -MinReplicaSetSize 3 -TargetReplicaSetSize 3 -PartitionSchemeSingleton -PlacementConstraint "HasSSD == true && SomeProperty >= 4"
```

<span data-ttu-id="b1614-411">Pokud jsou všechny uzly NodeType01 platné, můžete také vybrat daný typ uzlu s omezením hello "(NodeType == NodeType01)".</span><span class="sxs-lookup"><span data-stu-id="b1614-411">If all nodes of NodeType01 are valid, you can also select that node type with hello constraint "(NodeType == NodeType01)".</span></span>

<span data-ttu-id="b1614-412">Jedním z nástrojů věcí hello o omezení umístění služby je, aby bylo možné aktualizovat dynamicky za běhu.</span><span class="sxs-lookup"><span data-stu-id="b1614-412">One of hello cool things about a service’s placement constraints is that they can be updated dynamically during runtime.</span></span> <span data-ttu-id="b1614-413">Proto pokud potřebujete, můžete v clusteru hello pohyb služby, přidat a odebrat požadavky atd. Service Fabric postará zajistit, že služba hello zůstává a k dispozici i když jsou vytvářeny těchto typů změn.</span><span class="sxs-lookup"><span data-stu-id="b1614-413">So if you need to, you can move a service around in hello cluster, add and remove requirements, etc. Service Fabric takes care of ensuring that hello service stays up and available even when these types of changes are made.</span></span>

<span data-ttu-id="b1614-414">C#:</span><span class="sxs-lookup"><span data-stu-id="b1614-414">C#:</span></span>

```csharp
StatefulServiceUpdateDescription updateDescription = new StatefulServiceUpdateDescription();
updateDescription.PlacementConstraints = "NodeType == NodeType01";
await fabricClient.ServiceManager.UpdateServiceAsync(new Uri("fabric:/app/service"), updateDescription);
```

<span data-ttu-id="b1614-415">Prostředí PowerShell:</span><span class="sxs-lookup"><span data-stu-id="b1614-415">Powershell:</span></span>

```posh
Update-ServiceFabricService -Stateful -ServiceName $serviceName -PlacementConstraints "NodeType == NodeType01"
```

<span data-ttu-id="b1614-416">Pro všechny různé služby s názvem instance jsou zadány omezení umístění.</span><span class="sxs-lookup"><span data-stu-id="b1614-416">Placement constraints are specified for every different named service instance.</span></span> <span data-ttu-id="b1614-417">Aktualizace vždy provést místo hello (Přepsat) byl dříve zadán.</span><span class="sxs-lookup"><span data-stu-id="b1614-417">Updates always take hello place of (overwrite) what was previously specified.</span></span>

<span data-ttu-id="b1614-418">Definice clusteru Hello definuje vlastnosti hello na uzlu.</span><span class="sxs-lookup"><span data-stu-id="b1614-418">hello cluster definition defines hello properties on a node.</span></span> <span data-ttu-id="b1614-419">Změna vlastnosti uzlu vyžaduje s upgradem konfigurace clusteru.</span><span class="sxs-lookup"><span data-stu-id="b1614-419">Changing a node's properties requires a cluster configuration upgrade.</span></span> <span data-ttu-id="b1614-420">Upgrade vlastnosti uzlu vyžaduje jeho nové vlastnosti tooreport toorestart každý uzel došlo k chybě.</span><span class="sxs-lookup"><span data-stu-id="b1614-420">Upgrading a node's properties requires each affected node toorestart tooreport its new properties.</span></span> <span data-ttu-id="b1614-421">Tyto vrácení upgradů Service Fabric spravuje.</span><span class="sxs-lookup"><span data-stu-id="b1614-421">These rolling upgrades are managed by Service Fabric.</span></span>

## <a name="describing-and-managing-cluster-resources"></a><span data-ttu-id="b1614-422">Popisující a Správa prostředků clusteru</span><span class="sxs-lookup"><span data-stu-id="b1614-422">Describing and Managing Cluster Resources</span></span>
<span data-ttu-id="b1614-423">Jedním z nejdůležitějších úloh žádné orchestrator je toohelp hello spravovat spotřeby prostředků v clusteru hello.</span><span class="sxs-lookup"><span data-stu-id="b1614-423">One of hello most important jobs of any orchestrator is toohelp manage resource consumption in hello cluster.</span></span> <span data-ttu-id="b1614-424">Správa prostředků clusteru může zahrnovat několik různých věcí.</span><span class="sxs-lookup"><span data-stu-id="b1614-424">Managing cluster resources can mean a couple of different things.</span></span> <span data-ttu-id="b1614-425">Nejprve existuje zajišťuje, že počítače nejsou přetížené.</span><span class="sxs-lookup"><span data-stu-id="b1614-425">First, there's ensuring that machines are not overloaded.</span></span> <span data-ttu-id="b1614-426">To znamená, a ujistěte se, že počítače nejsou spuštěné další služby, než se může zpracovat.</span><span class="sxs-lookup"><span data-stu-id="b1614-426">This means making sure that machines aren't running more services than they can handle.</span></span> <span data-ttu-id="b1614-427">Druhou je, že vyrovnávání a optimalizace, což je důležité toorunning služby efektivně.</span><span class="sxs-lookup"><span data-stu-id="b1614-427">Second, there's balancing and optimization which is critical toorunning services efficiently.</span></span> <span data-ttu-id="b1614-428">Cenově platné nebo výkonu nabídky citlivé služeb nemůže povolit některé uzly toobe aktivní zase cold.</span><span class="sxs-lookup"><span data-stu-id="b1614-428">Cost effective or performance sensitive service offerings can't allow some nodes toobe hot while others are cold.</span></span> <span data-ttu-id="b1614-429">Aktivní uzly vést tooresource kolizí nebo nízký výkon a cold uzly představují ke znehodnocení části prostředků a vyšší náklady.</span><span class="sxs-lookup"><span data-stu-id="b1614-429">Hot nodes lead tooresource contention and poor performance, and cold nodes represent wasted resources and increased costs.</span></span> 

<span data-ttu-id="b1614-430">Service Fabric představuje prostředky jako `Metrics`.</span><span class="sxs-lookup"><span data-stu-id="b1614-430">Service Fabric represents resources as `Metrics`.</span></span> <span data-ttu-id="b1614-431">Metriky jsou všechny logickou nebo fyzickou prostředků, které chcete toodescribe tooService prostředků infrastruktury.</span><span class="sxs-lookup"><span data-stu-id="b1614-431">Metrics are any logical or physical resource that you want toodescribe tooService Fabric.</span></span> <span data-ttu-id="b1614-432">Příklady metrik věci jako "WorkQueueDepth" nebo "MemoryInMb".</span><span class="sxs-lookup"><span data-stu-id="b1614-432">Examples of metrics are things like “WorkQueueDepth” or “MemoryInMb”.</span></span> <span data-ttu-id="b1614-433">Informace o hello fyzické prostředky, které můžou řídit Service Fabric na uzlech naleznete v tématu [zásad správného řízení prostředků](service-fabric-resource-governance.md).</span><span class="sxs-lookup"><span data-stu-id="b1614-433">For information about hello physical resources that Service Fabric can govern on nodes, see [resource governance](service-fabric-resource-governance.md).</span></span> <span data-ttu-id="b1614-434">Informace o konfiguraci vlastní metriky a jejich použití naleznete v tématu [v tomto článku](service-fabric-cluster-resource-manager-metrics.md)</span><span class="sxs-lookup"><span data-stu-id="b1614-434">For information on configuring custom metrics and their uses, see [this article](service-fabric-cluster-resource-manager-metrics.md)</span></span>

<span data-ttu-id="b1614-435">Metriky se liší od umísťováním omezení a vlastnosti uzlu.</span><span class="sxs-lookup"><span data-stu-id="b1614-435">Metrics are different from placements constraints and node properties.</span></span> <span data-ttu-id="b1614-436">Vlastnosti uzlu jsou statické popisovače hello v samotných uzlech.</span><span class="sxs-lookup"><span data-stu-id="b1614-436">Node properties are static descriptors of hello nodes themselves.</span></span> <span data-ttu-id="b1614-437">Metriky popisují prostředky, které mají uzly a že využívat služby při spuštění na uzlu.</span><span class="sxs-lookup"><span data-stu-id="b1614-437">Metrics describe resources that nodes have and that services consume when they are run on a node.</span></span> <span data-ttu-id="b1614-438">Vlastnost uzlu může být "HasSSD" a může být nastaven tootrue nebo hodnotu false.</span><span class="sxs-lookup"><span data-stu-id="b1614-438">A node property could be "HasSSD" and could be set tootrue or false.</span></span> <span data-ttu-id="b1614-439">Hello množství místa, které jsou k dispozici v této SSD a kolik je využívána služby by metrika jako "DriveSpaceInMb".</span><span class="sxs-lookup"><span data-stu-id="b1614-439">hello amount of space available on that SSD and how much is consumed by services would be a metric like “DriveSpaceInMb”.</span></span> 

<span data-ttu-id="b1614-440">Je důležité toonote, stejně jako omezení umístění a vlastnosti uzlu hello správce prostředků clusteru Service Fabric není pochopit, jaké hello názvy střední metriky hello.</span><span class="sxs-lookup"><span data-stu-id="b1614-440">It is important toonote that just like for placement constraints and node properties, hello Service Fabric Cluster Resource Manager doesn't understand what hello names of hello metrics mean.</span></span> <span data-ttu-id="b1614-441">Metriky názvy jsou jenom řetězce.</span><span class="sxs-lookup"><span data-stu-id="b1614-441">Metric names are just strings.</span></span> <span data-ttu-id="b1614-442">Je dobrým zvykem toodeclare jednotky jako součást hello metriky názvy, které vytvoříte, když může být nejednoznačný.</span><span class="sxs-lookup"><span data-stu-id="b1614-442">It is a good practice toodeclare units as a part of hello metric names that you create when it could be ambiguous.</span></span>

## <a name="capacity"></a><span data-ttu-id="b1614-443">Kapacita</span><span class="sxs-lookup"><span data-stu-id="b1614-443">Capacity</span></span>
<span data-ttu-id="b1614-444">Pokud jste měli vypnuté všechny prostředků *vyrovnávání*, správce prostředků clusteru Service Fabric stále zajistí, že žádný uzel skončila přes své kapacity.</span><span class="sxs-lookup"><span data-stu-id="b1614-444">If you turned off all resource *balancing*, Service Fabric’s Cluster Resource Manager would still ensure that no node ended up over its capacity.</span></span> <span data-ttu-id="b1614-445">Správa přetečení kapacity je možné, pokud hello clusteru je málo místa nebo je větší než libovolného uzlu hello zatížení.</span><span class="sxs-lookup"><span data-stu-id="b1614-445">Managing capacity overruns is possible unless hello cluster is too full or hello workload is larger than any node.</span></span> <span data-ttu-id="b1614-446">Kapacita je jiné *omezení* této hello správce prostředků clusteru používá toounderstand kolik prostředku a uzel má.</span><span class="sxs-lookup"><span data-stu-id="b1614-446">Capacity is another *constraint* that hello Cluster Resource Manager uses toounderstand how much of a resource a node has.</span></span> <span data-ttu-id="b1614-447">Zbývající kapacity jsou také sledovány hello clusteru jako celek.</span><span class="sxs-lookup"><span data-stu-id="b1614-447">Remaining capacity is also tracked for hello cluster as a whole.</span></span> <span data-ttu-id="b1614-448">Z hlediska metriky jsou vyjádřeny hello kapacitu a spotřeba hello na úrovni služby hello.</span><span class="sxs-lookup"><span data-stu-id="b1614-448">Both hello capacity and hello consumption at hello service level are expressed in terms of metrics.</span></span> <span data-ttu-id="b1614-449">Tak například metrika hello může být "ClientConnections" a daný uzel je pravděpodobně kapacity pro "ClientConnections" z 32768.</span><span class="sxs-lookup"><span data-stu-id="b1614-449">So for example, hello metric might be "ClientConnections" and a given Node may have a capacity for "ClientConnections" of 32768.</span></span> <span data-ttu-id="b1614-450">Další uzly může mít jiné omezení některé služby spuštěné v tomto uzlu můžete například ho aktuálně spotřebovává 32256 metrika hello "ClientConnections".</span><span class="sxs-lookup"><span data-stu-id="b1614-450">Other nodes can have other limits Some service running on that node can say it is currently consuming 32256 of hello metric "ClientConnections".</span></span>

<span data-ttu-id="b1614-451">Během doby běhu hello správce prostředků clusteru sleduje zbývající kapacity v clusteru hello a na uzlech.</span><span class="sxs-lookup"><span data-stu-id="b1614-451">During runtime, hello Cluster Resource Manager tracks remaining capacity in hello cluster and on nodes.</span></span> <span data-ttu-id="b1614-452">V pořadí tootrack odečítá kapacity hello správce prostředků clusteru využití každé služby z uzlu kapacity, kde je spuštěna služba hello.</span><span class="sxs-lookup"><span data-stu-id="b1614-452">In order tootrack capacity hello Cluster Resource Manager subtracts each service's usage from node's capacity where hello service runs.</span></span> <span data-ttu-id="b1614-453">Tyto informace a hello správce prostředků clusteru Service Fabric nepřijdete na to, kde tooplace nebo přesunout repliky tak, aby uzly si projít kapacity.</span><span class="sxs-lookup"><span data-stu-id="b1614-453">With this information, hello Service Fabric Cluster Resource Manager can figure out where tooplace or move replicas so that nodes don’t go over capacity.</span></span>

<span data-ttu-id="b1614-454"><center>
![Uzly clusteru a kapacity][Image7]
</center></span><span class="sxs-lookup"><span data-stu-id="b1614-454"><center>
![Cluster nodes and capacity][Image7]
</center></span></span>

<span data-ttu-id="b1614-455">C#:</span><span class="sxs-lookup"><span data-stu-id="b1614-455">C#:</span></span>

```csharp
StatefulServiceDescription serviceDescription = new StatefulServiceDescription();
ServiceLoadMetricDescription metric = new ServiceLoadMetricDescription();
metric.Name = "ClientConnections";
metric.PrimaryDefaultLoad = 1024;
metric.SecondaryDefaultLoad = 0;
metric.Weight = ServiceLoadMetricWeight.High;
serviceDescription.Metrics.Add(metric);
await fabricClient.ServiceManager.CreateServiceAsync(serviceDescription);
```

<span data-ttu-id="b1614-456">Prostředí PowerShell:</span><span class="sxs-lookup"><span data-stu-id="b1614-456">Powershell:</span></span>

```posh
New-ServiceFabricService -ApplicationName $applicationName -ServiceName $serviceName -ServiceTypeName $serviceTypeName –Stateful -MinReplicaSetSize 3 -TargetReplicaSetSize 3 -PartitionSchemeSingleton –Metric @("ClientConnections,High,1024,0)
```

<span data-ttu-id="b1614-457">Můžete zjistit kapacity definované v manifestu clusteru hello:</span><span class="sxs-lookup"><span data-stu-id="b1614-457">You can see capacities defined in hello cluster manifest:</span></span>

<span data-ttu-id="b1614-458">ClusterManifest.xml</span><span class="sxs-lookup"><span data-stu-id="b1614-458">ClusterManifest.xml</span></span>

```xml
    <NodeType Name="NodeType03">
      <Capacities>
        <Capacity Name="ClientConnections" Value="65536"/>
      </Capacities>
    </NodeType>
```

<span data-ttu-id="b1614-459">pomocí souboru ClusterConfig.json pro samostatné nasazení nebo Template.json pro Azure hostované clustery.</span><span class="sxs-lookup"><span data-stu-id="b1614-459">via ClusterConfig.json for Standalone deployments or Template.json for Azure hosted clusters.</span></span> 

```json
"nodeTypes": [
    {
        "name": "NodeType03",
        "capacities": {
            "ClientConnections": "65536",
        }
    }
],
```

<span data-ttu-id="b1614-460">Běžně služby načíst dynamicky změny.</span><span class="sxs-lookup"><span data-stu-id="b1614-460">Commonly a service’s load changes dynamically.</span></span> <span data-ttu-id="b1614-461">Řekněme, že zatížení repliky "ClientConnections" změnila z 1024 too2048, ale hello uzlu běžel následně pouze měl 512 kapacita zbývající pro tuto metriku.</span><span class="sxs-lookup"><span data-stu-id="b1614-461">Say that a replica's load of "ClientConnections" changed from 1024 too2048, but hello node it was running on then only had 512 capacity remaining for that metric.</span></span> <span data-ttu-id="b1614-462">Nyní repliky nebo instance umístění je neplatná, protože v tomto uzlu není dostatek místa.</span><span class="sxs-lookup"><span data-stu-id="b1614-462">Now that replica or instance's placement is invalid, since there's not enough room on that node.</span></span> <span data-ttu-id="b1614-463">Hello správce prostředků clusteru má tookick a získat hello uzel zpět níže kapacity.</span><span class="sxs-lookup"><span data-stu-id="b1614-463">hello Cluster Resource Manager has tookick in and get hello node back below capacity.</span></span> <span data-ttu-id="b1614-464">Snižuje zátěž hello uzlu, který je nad kapacity přesunutím jeden nebo víc hello replik nebo instancí z tohoto uzlu tooother uzlů.</span><span class="sxs-lookup"><span data-stu-id="b1614-464">It reduces load on hello node that is over capacity by moving one or more of hello replicas or instances from that node tooother nodes.</span></span> <span data-ttu-id="b1614-465">Při přesunu repliky, hello správce prostředků clusteru pokusí toominimize náklady hello pohybů tyto.</span><span class="sxs-lookup"><span data-stu-id="b1614-465">When moving replicas, hello Cluster Resource Manager tries toominimize hello cost of those movements.</span></span> <span data-ttu-id="b1614-466">Náklady na přesunutí popsané v [v tomto článku](service-fabric-cluster-resource-manager-movement-cost.md) a více o hello je správce prostředků clusteru vyrovnává strategie a pravidla je popsaný [zde](service-fabric-cluster-resource-manager-metrics.md).</span><span class="sxs-lookup"><span data-stu-id="b1614-466">Movement cost is discussed in [this article](service-fabric-cluster-resource-manager-movement-cost.md) and more about hello Cluster Resource Manager's rebalancing strategies and rules is described [here](service-fabric-cluster-resource-manager-metrics.md).</span></span>

## <a name="cluster-capacity"></a><span data-ttu-id="b1614-467">Kapacita clusteru</span><span class="sxs-lookup"><span data-stu-id="b1614-467">Cluster capacity</span></span>
<span data-ttu-id="b1614-468">Jak tedy hello správce prostředků clusteru Service Fabric zachovat hello celkové clusteru z příliš zaplnění?</span><span class="sxs-lookup"><span data-stu-id="b1614-468">So how does hello Service Fabric Cluster Resource Manager keep hello overall cluster from being too full?</span></span> <span data-ttu-id="b1614-469">Dobře s dynamického zatížení, není k dispozici mnoho ho provést.</span><span class="sxs-lookup"><span data-stu-id="b1614-469">Well, with dynamic load there’s not a lot it can do.</span></span> <span data-ttu-id="b1614-470">Služby mohou mít jejich zatížení Špička nezávisle na akce provedené hello správce prostředků clusteru.</span><span class="sxs-lookup"><span data-stu-id="b1614-470">Services can have their load spike independently of actions taken by hello Cluster Resource Manager.</span></span> <span data-ttu-id="b1614-471">Cluster s dostatek prostoru dnes v důsledku toho může být underpowered, když jste se famous zítra.</span><span class="sxs-lookup"><span data-stu-id="b1614-471">As a result, your cluster with plenty of headroom today may be underpowered when you become famous tomorrow.</span></span> <span data-ttu-id="b1614-472">Ale nutné dodat, nejsou některé ovládací prvky, které jsou zaručená v tooprevent problémy.</span><span class="sxs-lookup"><span data-stu-id="b1614-472">That said, there are some controls that are baked in tooprevent problems.</span></span> <span data-ttu-id="b1614-473">Hello prvním, co můžeme udělat je zabránit hello vytvoření nové úlohy, které by způsobily hello clusteru toobecome úplná.</span><span class="sxs-lookup"><span data-stu-id="b1614-473">hello first thing we can do is prevent hello creation of new workloads that would cause hello cluster toobecome full.</span></span>

<span data-ttu-id="b1614-474">Řekněme, že vytvoření bezstavové služby a obsahuje některé zatížení s ním spojená.</span><span class="sxs-lookup"><span data-stu-id="b1614-474">Say that you create a stateless service and it has some load associated with it.</span></span> <span data-ttu-id="b1614-475">Řekněme, že služba hello záleží metrika "DiskSpaceInMb" hello.</span><span class="sxs-lookup"><span data-stu-id="b1614-475">Let’s say that hello service cares about hello "DiskSpaceInMb" metric.</span></span> <span data-ttu-id="b1614-476">Dále předpokládejme, že se jedná o probíhající tooconsume pět jednotky "DiskSpaceInMb" pro všechny instance služby hello.</span><span class="sxs-lookup"><span data-stu-id="b1614-476">Let's also say that it is going tooconsume five units of "DiskSpaceInMb" for every instance of hello service.</span></span> <span data-ttu-id="b1614-477">Chcete toocreate tři instance služby hello.</span><span class="sxs-lookup"><span data-stu-id="b1614-477">You want toocreate three instances of hello service.</span></span> <span data-ttu-id="b1614-478">Výborně!</span><span class="sxs-lookup"><span data-stu-id="b1614-478">Great!</span></span> <span data-ttu-id="b1614-479">Tak, aby znamená, že potřebujeme 15 jednotky toobe "DiskSpaceInMb" k dispozici v clusteru hello abychom vás tooeven být schopný toocreate tyto instance služby.</span><span class="sxs-lookup"><span data-stu-id="b1614-479">So that means that we need 15 units of "DiskSpaceInMb" toobe present in hello cluster in order for us tooeven be able toocreate these service instances.</span></span> <span data-ttu-id="b1614-480">Hello správce prostředků clusteru průběžně vypočítá hello kapacitu a využití každé metriky tak může zjistit hello zbývající kapacity v clusteru hello.</span><span class="sxs-lookup"><span data-stu-id="b1614-480">hello Cluster Resource Manager continually calculates hello capacity and consumption of each metric so it can determine hello remaining capacity in hello cluster.</span></span> <span data-ttu-id="b1614-481">Pokud není k dispozici dostatek místa, vytvořte hello správce prostředků clusteru odmítne hello volání služby.</span><span class="sxs-lookup"><span data-stu-id="b1614-481">If there isn't enough space, hello Cluster Resource Manager rejects hello create service call.</span></span>

<span data-ttu-id="b1614-482">Vzhledem k tomu, že požadavek hello existuje pouze to, že se 15 jednotky k dispozici, může být tento prostor přiděleno mnoha různými způsoby.</span><span class="sxs-lookup"><span data-stu-id="b1614-482">Since hello requirement is only that there be 15 units available, this space could be allocated many different ways.</span></span> <span data-ttu-id="b1614-483">Například může existovat jednu jednotku zbývající kapacity v 15 rozdílných uzlech, nebo tři zbývající jednotky kapacity na pět různých uzlech.</span><span class="sxs-lookup"><span data-stu-id="b1614-483">For example, there could be one remaining unit of capacity on 15 different nodes, or three remaining units of capacity on five different nodes.</span></span> <span data-ttu-id="b1614-484">Pokud hello správce prostředků clusteru můžete přeuspořádat věcí, takže na tři uzly je k dispozici pět jednotky, umístí hello služby.</span><span class="sxs-lookup"><span data-stu-id="b1614-484">If hello Cluster Resource Manager can rearrange things so there's five units available on three nodes, it places hello service.</span></span> <span data-ttu-id="b1614-485">Změna uspořádání hello clusteru je obvykle možné, pokud hello cluster je téměř plná, nebo z nějakého důvodu nelze konsolidovat hello stávající služby.</span><span class="sxs-lookup"><span data-stu-id="b1614-485">Rearranging hello cluster is usually possible unless hello cluster is almost full or hello existing services can't be consolidated for some reason.</span></span>

## <a name="buffered-capacity"></a><span data-ttu-id="b1614-486">Kapacita ve vyrovnávací paměti</span><span class="sxs-lookup"><span data-stu-id="b1614-486">Buffered Capacity</span></span>
<span data-ttu-id="b1614-487">Kapacita ve vyrovnávací paměti je další funkcí hello správce prostředků clusteru.</span><span class="sxs-lookup"><span data-stu-id="b1614-487">Buffered capacity is another feature of hello Cluster Resource Manager.</span></span> <span data-ttu-id="b1614-488">Umožňuje rezervace některé část hello celkové kapacity uzlu.</span><span class="sxs-lookup"><span data-stu-id="b1614-488">It allows reservation of some portion of hello overall node capacity.</span></span> <span data-ttu-id="b1614-489">Tato kapacity vyrovnávací paměť je pouze použité tooplace služby během upgradu a selhání uzlu.</span><span class="sxs-lookup"><span data-stu-id="b1614-489">This capacity buffer is only used tooplace services during upgrades and node failures.</span></span> <span data-ttu-id="b1614-490">Kapacita ve vyrovnávací paměti je zadán globálně za Metrika pro všechny uzly.</span><span class="sxs-lookup"><span data-stu-id="b1614-490">Buffered Capacity is specified globally per metric for all nodes.</span></span> <span data-ttu-id="b1614-491">Hello hodnotu, kterou vyberete pro hello rezervované kapacity je funkce hello počtu selhání a upgradu domén, budete mít v clusteru hello.</span><span class="sxs-lookup"><span data-stu-id="b1614-491">hello value you pick for hello reserved capacity is a function of hello number of Fault and Upgrade Domains you have in hello cluster.</span></span> <span data-ttu-id="b1614-492">Další selhání a upgradu domény znamená, můžete si vybrat nižší číslo pro vaše kapacita ve vyrovnávací paměti.</span><span class="sxs-lookup"><span data-stu-id="b1614-492">More Fault and Upgrade Domains means that you can pick a lower number for your buffered capacity.</span></span> <span data-ttu-id="b1614-493">Pokud máte více domén, můžete očekávat snížení objemu toobe vašeho clusteru k dispozici během upgradu a selhání.</span><span class="sxs-lookup"><span data-stu-id="b1614-493">If you have more domains, you can expect smaller amounts of your cluster toobe unavailable during upgrades and failures.</span></span> <span data-ttu-id="b1614-494">Určení uložená do vyrovnávací paměti kapacity má smysl pouze, pokud máte také zadaný hello uzlu kapacity pro metriku.</span><span class="sxs-lookup"><span data-stu-id="b1614-494">Specifying Buffered Capacity only makes sense if you have also specified hello node capacity for a metric.</span></span>

<span data-ttu-id="b1614-495">Tady je příklad, jak toospecify do vyrovnávací paměti kapacity:</span><span class="sxs-lookup"><span data-stu-id="b1614-495">Here's an example of how toospecify buffered capacity:</span></span>

<span data-ttu-id="b1614-496">ClusterManifest.xml</span><span class="sxs-lookup"><span data-stu-id="b1614-496">ClusterManifest.xml</span></span>

```xml
        <Section Name="NodeBufferPercentage">
            <Parameter Name="SomeMetric" Value="0.15" />
            <Parameter Name="SomeOtherMetric" Value="0.20" />
        </Section>
```

<span data-ttu-id="b1614-497">pomocí souboru ClusterConfig.json pro samostatné nasazení nebo Template.json pro Azure hostované clustery:</span><span class="sxs-lookup"><span data-stu-id="b1614-497">via ClusterConfig.json for Standalone deployments or Template.json for Azure hosted clusters:</span></span>

```json
"fabricSettings": [
  {
    "name": "NodeBufferPercentage",
    "parameters": [
      {
          "name": "SomeMetric",
          "value": "0.15"
      },
      {
          "name": "SomeOtherMetric",
          "value": "0.20"
      }
    ]
  }
]
```

<span data-ttu-id="b1614-498">Vytvoření nové služby Hello selže, když hello clusteru je mimo ve vyrovnávací paměti kapacity pro metriku.</span><span class="sxs-lookup"><span data-stu-id="b1614-498">hello creation of new services fails when hello cluster is out of buffered capacity for a metric.</span></span> <span data-ttu-id="b1614-499">Brání hello vytvoření nové služby toopreserve hello vyrovnávací paměti zajistí, že upgrady a selhání nezpůsobí, že uzly toogo přes kapacity.</span><span class="sxs-lookup"><span data-stu-id="b1614-499">Preventing hello creation of new services toopreserve hello buffer ensures that upgrades and failures don’t cause nodes toogo over capacity.</span></span> <span data-ttu-id="b1614-500">Kapacita ve vyrovnávací paměti je nepovinný, ale doporučuje se v jakékoli clusteru, který definuje kapacity pro metriku.</span><span class="sxs-lookup"><span data-stu-id="b1614-500">Buffered capacity is optional but is recommended in any cluster that defines a capacity for a metric.</span></span>

<span data-ttu-id="b1614-501">Hello správce prostředků clusteru zpřístupní tyto informace zatížení.</span><span class="sxs-lookup"><span data-stu-id="b1614-501">hello Cluster Resource Manager exposes this load information.</span></span> <span data-ttu-id="b1614-502">Pro jednotlivé metriky tyto informace zahrnují:</span><span class="sxs-lookup"><span data-stu-id="b1614-502">For each metric, this information includes:</span></span> 
  - <span data-ttu-id="b1614-503">Nastavení kapacity Hello do vyrovnávací paměti</span><span class="sxs-lookup"><span data-stu-id="b1614-503">hello buffered capacity settings</span></span>
  - <span data-ttu-id="b1614-504">Celková kapacita Hello</span><span class="sxs-lookup"><span data-stu-id="b1614-504">hello total capacity</span></span>
  - <span data-ttu-id="b1614-505">aktuální spotřeba Hello</span><span class="sxs-lookup"><span data-stu-id="b1614-505">hello current consumption</span></span>
  - <span data-ttu-id="b1614-506">jestli je považován za jednotlivé metriky vyrovnáváním nebo ne</span><span class="sxs-lookup"><span data-stu-id="b1614-506">whether each metric is considered balanced or not</span></span>
  - <span data-ttu-id="b1614-507">Statistika týkající se hello směrodatné odchylky</span><span class="sxs-lookup"><span data-stu-id="b1614-507">statistics about hello standard deviation</span></span>
  - <span data-ttu-id="b1614-508">Hello uzly, které mají hello většinu a minimálně zatížení</span><span class="sxs-lookup"><span data-stu-id="b1614-508">hello nodes which have hello most and least load</span></span>  
  
<span data-ttu-id="b1614-509">Níže vidíte příklad tento výstup:</span><span class="sxs-lookup"><span data-stu-id="b1614-509">Below we see an example of that output:</span></span>

```posh
PS C:\Users\user> Get-ServiceFabricClusterLoadInformation
LastBalancingStartTimeUtc : 9/1/2016 12:54:59 AM
LastBalancingEndTimeUtc   : 9/1/2016 12:54:59 AM
LoadMetricInformation     :
                            LoadMetricName        : Metric1
                            IsBalancedBefore      : False
                            IsBalancedAfter       : False
                            DeviationBefore       : 0.192450089729875
                            DeviationAfter        : 0.192450089729875
                            BalancingThreshold    : 1
                            Action                : NoActionNeeded
                            ActivityThreshold     : 0
                            ClusterCapacity       : 189
                            ClusterLoad           : 45
                            ClusterRemainingCapacity : 144
                            NodeBufferPercentage  : 10
                            ClusterBufferedCapacity : 170
                            ClusterRemainingBufferedCapacity : 125
                            ClusterCapacityViolation : False
                            MinNodeLoadValue      : 0
                            MinNodeLoadNodeId     : 3ea71e8e01f4b0999b121abcbf27d74d
                            MaxNodeLoadValue      : 15
                            MaxNodeLoadNodeId     : 2cc648b6770be1bc9824fa995d5b68b1
```

## <a name="next-steps"></a><span data-ttu-id="b1614-510">Další kroky</span><span class="sxs-lookup"><span data-stu-id="b1614-510">Next steps</span></span>
* <span data-ttu-id="b1614-511">Informace o hello architektura a informačního toku v rámci hello správce prostředků clusteru, podívejte se na [v tomto článku](service-fabric-cluster-resource-manager-architecture.md)</span><span class="sxs-lookup"><span data-stu-id="b1614-511">For information on hello architecture and information flow within hello Cluster Resource Manager, check out [this article ](service-fabric-cluster-resource-manager-architecture.md)</span></span>
* <span data-ttu-id="b1614-512">Definování defragmentace metriky je jedním ze způsobů tooconsolidate zatížení na uzlech místo rozšíří ho. toolearn jak tooconfigure defragmentace, získáte příliš[v tomto článku](service-fabric-cluster-resource-manager-defragmentation-metrics.md)</span><span class="sxs-lookup"><span data-stu-id="b1614-512">Defining Defragmentation Metrics is one way tooconsolidate load on nodes instead of spreading it out. toolearn how tooconfigure defragmentation, refer too[this article](service-fabric-cluster-resource-manager-defragmentation-metrics.md)</span></span>
* <span data-ttu-id="b1614-513">Začít od začátku hello a [získat Úvod toohello správce prostředků clusteru Service Fabric](service-fabric-cluster-resource-manager-introduction.md)</span><span class="sxs-lookup"><span data-stu-id="b1614-513">Start from hello beginning and [get an Introduction toohello Service Fabric Cluster Resource Manager](service-fabric-cluster-resource-manager-introduction.md)</span></span>
* <span data-ttu-id="b1614-514">toofind si o tom, jak hello správce prostředků clusteru spravuje a vyrovnává zatížení v clusteru hello, podívejte se na článek hello na [Vyrovnávání zatížení](service-fabric-cluster-resource-manager-balancing.md)</span><span class="sxs-lookup"><span data-stu-id="b1614-514">toofind out about how hello Cluster Resource Manager manages and balances load in hello cluster, check out hello article on [balancing load](service-fabric-cluster-resource-manager-balancing.md)</span></span>

[Image1]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-fault-domains.png
[Image2]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-uneven-fault-domain-layout.png
[Image3]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-fault-and-upgrade-domains-with-placement.png
[Image4]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-fault-and-upgrade-domain-layout-strategies.png
[Image5]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-layout-different-workloads.png
[Image6]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-placement-constraints-node-properties.png
[Image7]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-nodes-and-capacity.png
