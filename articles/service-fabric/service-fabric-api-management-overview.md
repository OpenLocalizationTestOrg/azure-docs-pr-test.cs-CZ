---
title: "Azure Service Fabric se API Management přehled | Microsoft Docs"
description: "Tento článek je úvodem do jako brána pro vaše aplikace Service Fabric pomocí Azure API Management."
services: service-fabric
documentationcenter: .net
author: vturecek
manager: timlt
editor: 
ms.assetid: 96176149-69bb-4b06-a72e-ebbfea84454b
ms.service: service-fabric
ms.devlang: dotNet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 06/22/2017
ms.author: vturecek
ms.openlocfilehash: a3eedacac5efb53f82e46a56285713dece56ffe8
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 07/11/2017
---
# <a name="service-fabric-with-azure-api-management-overview"></a><span data-ttu-id="857da-103">Service Fabric s Azure API Management – přehled</span><span class="sxs-lookup"><span data-stu-id="857da-103">Service Fabric with Azure API Management overview</span></span>

<span data-ttu-id="857da-104">Cloudové aplikace obvykle nutné front-endu brány zajistit jediný bod příjem příchozích dat pro uživatele, zařízení nebo jiné aplikace.</span><span class="sxs-lookup"><span data-stu-id="857da-104">Cloud applications typically need a front-end gateway to provide a single point of ingress for users, devices, or other applications.</span></span> <span data-ttu-id="857da-105">V Service Fabric bránu být jakékoli bezstavové služby, jako [aplikace ASP.NET Core](service-fabric-reliable-services-communication-aspnetcore.md), nebo jiné služby, které jsou určené pro příchozí provoz, například [Event Hubs](https://docs.microsoft.com/azure/event-hubs/), [IoT Hub](https://docs.microsoft.com/azure/iot-hub/), nebo [Azure API Management](https://docs.microsoft.com/azure/api-management/).</span><span class="sxs-lookup"><span data-stu-id="857da-105">In Service Fabric, a gateway can be any stateless service such as an [ASP.NET Core application](service-fabric-reliable-services-communication-aspnetcore.md), or another service designed for traffic ingress, such as [Event Hubs](https://docs.microsoft.com/azure/event-hubs/), [IoT Hub](https://docs.microsoft.com/azure/iot-hub/), or [Azure API Management](https://docs.microsoft.com/azure/api-management/).</span></span>

<span data-ttu-id="857da-106">Tento článek je úvodem do jako brána pro vaše aplikace Service Fabric pomocí Azure API Management.</span><span class="sxs-lookup"><span data-stu-id="857da-106">This article is an introduction to using Azure API Management as a gateway to your Service Fabric applications.</span></span> <span data-ttu-id="857da-107">API Management se integruje přímo s Service Fabric, že vám umožní publikovat rozhraní API s bohatou sadu pravidel směrování k vašim službám Service Fabric back-end.</span><span class="sxs-lookup"><span data-stu-id="857da-107">API Management integrates directly with Service Fabric, allowing you to publish APIs with a rich set of routing rules to your back-end Service Fabric services.</span></span> 

## <a name="architecture"></a><span data-ttu-id="857da-108">Architektura</span><span class="sxs-lookup"><span data-stu-id="857da-108">Architecture</span></span>
<span data-ttu-id="857da-109">Běžné architektura Service Fabric používá jednostránkovou webovou aplikaci, která provádí volání HTTP na back endové služby, které zveřejňují rozhraní API HTTP.</span><span class="sxs-lookup"><span data-stu-id="857da-109">A common Service Fabric architecture uses a single-page web application that makes HTTP calls to back-end services that expose HTTP APIs.</span></span> <span data-ttu-id="857da-110">[Service Fabric Začínáme ukázkovou aplikaci](https://github.com/Azure-Samples/service-fabric-dotnet-getting-started) ukazuje příklad této architektury.</span><span class="sxs-lookup"><span data-stu-id="857da-110">The [Service Fabric getting-started sample application](https://github.com/Azure-Samples/service-fabric-dotnet-getting-started) shows an example of this architecture.</span></span>

<span data-ttu-id="857da-111">V tomto scénáři bezstavové webové služby slouží jako brány do aplikace Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="857da-111">In this scenario, a stateless web service serves as the gateway into the Service Fabric application.</span></span> <span data-ttu-id="857da-112">Tento postup vyžaduje, abyste zápisu webová služba, která může požadavky HTTP proxy server na back endové služby, jak je znázorněno v následujícím diagramu:</span><span class="sxs-lookup"><span data-stu-id="857da-112">This approach requires you to write a web service that can proxy HTTP requests to back-end services, as shown in the following diagram:</span></span>

![Service Fabric s Azure API Management přehled topologie][sf-web-app-stateless-gateway]

<span data-ttu-id="857da-114">Jelikož aplikace v složitost, takže to brány, které musí představovat rozhraní API před řadu back endové služby.</span><span class="sxs-lookup"><span data-stu-id="857da-114">As applications grow in complexity, so do the gateways that must present an API in front of myriad back-end services.</span></span> <span data-ttu-id="857da-115">Azure API Management je určený k řešení komplexní rozhraní API pomocí pravidel směrování, řízení přístupu, omezení rychlosti, sledování, protokolování událostí a ukládání odpovědí do mezipaměti s minimálním úsilím na vaší straně.</span><span class="sxs-lookup"><span data-stu-id="857da-115">Azure API Management is designed to handle complex APIs with routing rules, access control, rate limiting, monitoring, event logging, and response caching with minimal work on your part.</span></span> <span data-ttu-id="857da-116">Azure API Management podporuje zjišťování služby Service Fabric, oddílu řešení a výběr repliky inteligentně směrovat požadavky přímo na back endové služby v Service Fabric, takže není nutné zapsat bezstavové brány rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="857da-116">Azure API Management supports Service Fabric service discovery, partition resolution, and replica selection to intelligently route requests directly to back-end services in Service Fabric so you don't have to write your own stateless API gateway.</span></span> 

<span data-ttu-id="857da-117">V tomto scénáři webového uživatelského rozhraní je stále obsluhovat pomocí webové služby, při volání rozhraní API HTTP jsou spravovaná a směrován přes Azure API Management, jak je znázorněno v následujícím diagramu:</span><span class="sxs-lookup"><span data-stu-id="857da-117">In this scenario, the web UI is still served through a web service, while HTTP API calls are managed and routed through Azure API Management, as shown in the following diagram:</span></span>

![Service Fabric s Azure API Management přehled topologie][sf-apim-web-app]

## <a name="application-scenarios"></a><span data-ttu-id="857da-119">Scénáře aplikací</span><span class="sxs-lookup"><span data-stu-id="857da-119">Application scenarios</span></span>

<span data-ttu-id="857da-120">Služby v Service Fabric může být bezstavové nebo stavová a jejich může být rozděleny do oddílů pomocí jednoho ze tří schémata: singleton, int-64 rozsahu a s názvem.</span><span class="sxs-lookup"><span data-stu-id="857da-120">Services in Service Fabric may be either stateless or stateful, and they may be partitioned using one of three schemes: singleton, int-64 range, and named.</span></span> <span data-ttu-id="857da-121">Rozlišení koncového bodu služby vyžaduje identifikace na konkrétní oddíl instance konkrétní služby.</span><span class="sxs-lookup"><span data-stu-id="857da-121">Service endpoint resolution requires identifying a specific partition of a specific service instance.</span></span> <span data-ttu-id="857da-122">Při rozpoznávání koncový bod služby, obě instance názvu služby (například `fabric:/myapp/myservice`) a také konkrétní oddíl služby se musí určit, s výjimkou oddílů singleton.</span><span class="sxs-lookup"><span data-stu-id="857da-122">When resolving an endpoint of a service, both the service instance name (for example, `fabric:/myapp/myservice`) as well as the specific partition of the service must be specified, except in the case of singleton partition.</span></span>

<span data-ttu-id="857da-123">Azure API Management můžete použít s libovolnou kombinaci bezstavové služby, stavové služby a všechny schéma rozdělení oddílů.</span><span class="sxs-lookup"><span data-stu-id="857da-123">Azure API Management can be used with any combination of stateless services, stateful services, and any partitioning scheme.</span></span>

## <a name="send-traffic-to-a-stateless-service"></a><span data-ttu-id="857da-124">Odesílá data na bezstavové služby</span><span class="sxs-lookup"><span data-stu-id="857da-124">Send traffic to a stateless service</span></span>

<span data-ttu-id="857da-125">V nejjednodušším případě přenosy předávaly do instance bezstavové služby.</span><span class="sxs-lookup"><span data-stu-id="857da-125">In the simplest case, traffic is forwarded to a stateless service instance.</span></span> <span data-ttu-id="857da-126">K dosažení tohoto API Management operace obsahuje zásady zpracování příchozích s Service Fabric back-end, který se mapuje na instanci konkrétní bezstavové služby v Service Fabric back-end.</span><span class="sxs-lookup"><span data-stu-id="857da-126">To achieve this, an API Management operation contains an inbound processing policy with a Service Fabric back-end that maps to a specific stateless service instance in the Service Fabric back-end.</span></span> <span data-ttu-id="857da-127">Náhodné repliky instance bezstavové služby jsou odesílány požadavky odeslané na tuto službu.</span><span class="sxs-lookup"><span data-stu-id="857da-127">Requests sent to that service are sent to a random replica of the stateless service instance.</span></span>

#### <a name="example"></a><span data-ttu-id="857da-128">Příklad</span><span class="sxs-lookup"><span data-stu-id="857da-128">Example</span></span>
<span data-ttu-id="857da-129">V následujícím scénáři aplikace Service Fabric obsahuje bezstavové služby s názvem `fabric:/app/fooservice`, která zpřístupňuje rozhraní API interní HTTP.</span><span class="sxs-lookup"><span data-stu-id="857da-129">In the following scenario, a Service Fabric application contains a stateless service named `fabric:/app/fooservice`, that exposes an internal HTTP API.</span></span> <span data-ttu-id="857da-130">Název instance služby je dobře známé a může být pevně přímo v zásadách zpracování příchozí API Management.</span><span class="sxs-lookup"><span data-stu-id="857da-130">The service instance name is well known and can be hard-coded directly in the API Management inbound processing policy.</span></span> 

![Service Fabric s Azure API Management přehled topologie][sf-apim-static-stateless]

## <a name="send-traffic-to-a-stateful-service"></a><span data-ttu-id="857da-132">Odesílá data na stavové služby</span><span class="sxs-lookup"><span data-stu-id="857da-132">Send traffic to a stateful service</span></span>

<span data-ttu-id="857da-133">Podobně jako bezstavové služby scénář, provoz mohou být přenesena do instance stavové služby.</span><span class="sxs-lookup"><span data-stu-id="857da-133">Similar to the stateless service scenario, traffic can be forwarded to a stateful service instance.</span></span> <span data-ttu-id="857da-134">V takovém případě API Management operace obsahuje zásady zpracování příchozích s Service Fabric back-end, který mapuje žádost na konkrétní oddíl konkrétní *stateful* instance služby.</span><span class="sxs-lookup"><span data-stu-id="857da-134">In this case, an API Management operation contains an inbound processing policy with a Service Fabric back-end that maps a request to a specific partition of a specific *stateful* service instance.</span></span> <span data-ttu-id="857da-135">Oddíl mapovat každý požadavek pro výpočet je metodou lambda pomocí některé vstup z příchozího požadavku HTTP, jako je například hodnotu do cesty URL.</span><span class="sxs-lookup"><span data-stu-id="857da-135">The partition to map each request to is computed via a lambda method using some input from the incoming HTTP request, such as a value in the URL path.</span></span> <span data-ttu-id="857da-136">Zásady lze nakonfigurovat na odesílání žádostí pouze primární replikou, nebo náhodné repliky pro operace čtení.</span><span class="sxs-lookup"><span data-stu-id="857da-136">The policy may be configured to send requests to the primary replica only, or to a random replica for read operations.</span></span>

#### <a name="example"></a><span data-ttu-id="857da-137">Příklad</span><span class="sxs-lookup"><span data-stu-id="857da-137">Example</span></span>

<span data-ttu-id="857da-138">V následujícím scénáři aplikace Service Fabric obsahuje oddílů stavové služby s názvem `fabric:/app/userservice` který zpřístupňuje rozhraní API interní HTTP.</span><span class="sxs-lookup"><span data-stu-id="857da-138">In the following scenario, a Service Fabric application contains a partitioned stateful service named `fabric:/app/userservice` that exposes an internal HTTP API.</span></span> <span data-ttu-id="857da-139">Název instance služby je dobře známé a může být pevně přímo v zásadách zpracování příchozí API Management.</span><span class="sxs-lookup"><span data-stu-id="857da-139">The service instance name is well known and can be hard-coded directly in the API Management inbound processing policy.</span></span>  

<span data-ttu-id="857da-140">Služba je rozdělen na oddíly pomocí schéma oddílu Int64 dva oddíly a klíče rozsah, který zahrnuje `Int64.MinValue` k `Int64.MaxValue`.</span><span class="sxs-lookup"><span data-stu-id="857da-140">The service is partitioned using the Int64 partition scheme with two partitions and a key range that spans `Int64.MinValue` to `Int64.MaxValue`.</span></span> <span data-ttu-id="857da-141">Zásady back-end vypočítá klíč oddílu v tomto rozsahu převedením `id` hodnota zadaná v žádosti o cestě adresy URL 64bitové celé číslo, i když libovolný algoritmus lze zde výpočetní klíč oddílu.</span><span class="sxs-lookup"><span data-stu-id="857da-141">The back-end policy computes a partition key within that range by converting the `id` value provided in the URL request path to a 64-bit integer, although any algorithm can be used here to compute the partition key.</span></span> 

![Service Fabric s Azure API Management přehled topologie][sf-apim-static-stateful]

## <a name="send-traffic-to-multiple-stateless-services"></a><span data-ttu-id="857da-143">Odesílá data na více bezstavové služby</span><span class="sxs-lookup"><span data-stu-id="857da-143">Send traffic to multiple stateless services</span></span>

<span data-ttu-id="857da-144">V pokročilejších scénářích můžete definovat API Management operace, která mapuje požadavky na více než jedna instance služby.</span><span class="sxs-lookup"><span data-stu-id="857da-144">In more advanced scenarios, you can define an API Management operation that maps requests to more than one service instance.</span></span> <span data-ttu-id="857da-145">V takovém případě každé operace obsahuje zásady, která mapuje požadavky na instanci konkrétní služby založené na hodnotách z příchozí požadavek HTTP, jako třeba řetězce adresy URL cestu nebo dotaz a v případě stavové služby, oddílu v rámci instance služby.</span><span class="sxs-lookup"><span data-stu-id="857da-145">In this case, each operation contains a policy that maps requests to a specific service instance based on values from the incoming HTTP request, such as the URL path or query string, and in the case of stateful services, a partition within the service instance.</span></span> 

<span data-ttu-id="857da-146">K dosažení tohoto API Management operace obsahuje zásady zpracování příchozích s Service Fabric back-end, který se mapuje na instanci bezstavové služby v Service Fabric na základě hodnot načíst z příchozího požadavku HTTP back-end.</span><span class="sxs-lookup"><span data-stu-id="857da-146">To achieve this, an API Management operation contains an inbound processing policy with a Service Fabric back-end that maps to a stateless service instance in the Service Fabric back-end based on values retrieved from the incoming HTTP request.</span></span> <span data-ttu-id="857da-147">Požadavky na instanci služby jsou odesílány náhodných repliky instance služby.</span><span class="sxs-lookup"><span data-stu-id="857da-147">Requests to a service instance are sent to a random replica of the service instance.</span></span>

#### <a name="example"></a><span data-ttu-id="857da-148">Příklad</span><span class="sxs-lookup"><span data-stu-id="857da-148">Example</span></span>

<span data-ttu-id="857da-149">V tomto příkladu je vytvořena nová instance bezstavové služby pro každého uživatele aplikace s názvem dynamicky generovaném pomocí následujícího vzorce:</span><span class="sxs-lookup"><span data-stu-id="857da-149">In this example, a new stateless service instance is created for each user of an application with a dynamically generated name using the following formula:</span></span>
 
 - `fabric:/app/users/<username>`

 <span data-ttu-id="857da-150">Každá služba má jedinečný název, ale nejsou známé názvy počáteční, protože služby jsou vytvořeny v reakci na uživatele nebo správce vstup a proto nemůže být pevně zakódované do APIM zásady nebo pravidla směrování.</span><span class="sxs-lookup"><span data-stu-id="857da-150">Each service has a unique name, but the names are not known up-front because the services are created in response to user or admin input and thus cannot be hard-coded into APIM policies or routing rules.</span></span> <span data-ttu-id="857da-151">Místo toho název služby, do které chcete odeslat žádost o je vytvořen v definici zásady back-end z `name` hodnota zadaná pro cestu adresy URL požadavku.</span><span class="sxs-lookup"><span data-stu-id="857da-151">Instead, the name of the service to which to send a request is generated in the back-end policy definition from the `name` value provided in the URL request path.</span></span> <span data-ttu-id="857da-152">Například:</span><span class="sxs-lookup"><span data-stu-id="857da-152">For example:</span></span>

  - <span data-ttu-id="857da-153">Požadavek na `/api/users/foo` se směruje na instanci služby`fabric:/app/users/foo`</span><span class="sxs-lookup"><span data-stu-id="857da-153">A request to `/api/users/foo` is routed to service instance `fabric:/app/users/foo`</span></span>
  - <span data-ttu-id="857da-154">Požadavek na `/api/users/bar` se směruje na instanci služby`fabric:/app/users/bar`</span><span class="sxs-lookup"><span data-stu-id="857da-154">A request to `/api/users/bar` is routed to service instance `fabric:/app/users/bar`</span></span>

![Service Fabric s Azure API Management přehled topologie][sf-apim-dynamic-stateless]

## <a name="send-traffic-to-multiple-stateful-services"></a><span data-ttu-id="857da-156">Odesílá data na více stavové služby</span><span class="sxs-lookup"><span data-stu-id="857da-156">Send traffic to multiple stateful services</span></span>

<span data-ttu-id="857da-157">Podobně jako v příkladu bezstavové služby API Management operace můžete mapovat požadavky na více než jeden **stateful** instance služby, ve které je případ také můžete využít řešení oddílu pro každou instanci stavové služby.</span><span class="sxs-lookup"><span data-stu-id="857da-157">Similar to the stateless service example, an API Management operation can map requests to more than one **stateful** service instance, in which case you also may need to perform partition resolution for each stateful service instance.</span></span>

<span data-ttu-id="857da-158">K dosažení tohoto API Management operace obsahuje zásady zpracování příchozích s Service Fabric back-end, který se mapuje na instanci stavové služby v Service Fabric na základě hodnot načíst z příchozího požadavku HTTP back-end.</span><span class="sxs-lookup"><span data-stu-id="857da-158">To achieve this, an API Management operation contains an inbound processing policy with a Service Fabric back-end that maps to a stateful service instance in the Service Fabric back-end based on values retrieved from the incoming HTTP request.</span></span> <span data-ttu-id="857da-159">Kromě mapování žádost o instanci určité služby, požadavek lze také mapovat na konkrétní oddíl v rámci instance služby a volitelně primární repliku nebo náhodné sekundární repliky v oddílu.</span><span class="sxs-lookup"><span data-stu-id="857da-159">In addition to mapping a request to specific service instance, the request can also be mapped to a specific partition within the service instance, and optionally to either the primary replica or a random secondary replica within the partition.</span></span>

#### <a name="example"></a><span data-ttu-id="857da-160">Příklad</span><span class="sxs-lookup"><span data-stu-id="857da-160">Example</span></span>

<span data-ttu-id="857da-161">V tomto příkladu je vytvořena nová instance stavové služby pro každého uživatele aplikace s názvem dynamicky generovaném pomocí následujícího vzorce:</span><span class="sxs-lookup"><span data-stu-id="857da-161">In this example, a new stateful service instance is created for each user of the application with a dynamically generated name using the following formula:</span></span>
 
 - `fabric:/app/users/<username>`

 <span data-ttu-id="857da-162">Každá služba má jedinečný název, ale nejsou známé názvy počáteční, protože služby jsou vytvořeny v reakci na uživatele nebo správce vstup a proto nemůže být pevně zakódované do APIM zásady nebo pravidla směrování.</span><span class="sxs-lookup"><span data-stu-id="857da-162">Each service has a unique name, but the names are not known up-front because the services are created in response to user or admin input and thus cannot be hard-coded into APIM policies or routing rules.</span></span> <span data-ttu-id="857da-163">Místo toho název služby, do které chcete odeslat žádost o je vytvořen v definici zásady back-end z `name` hodnota poskytnutá cesta URL požadavku.</span><span class="sxs-lookup"><span data-stu-id="857da-163">Instead, the name of the service to which to send a request is generated in the back-end policy definition from the `name` value provided the URL request path.</span></span> <span data-ttu-id="857da-164">Například:</span><span class="sxs-lookup"><span data-stu-id="857da-164">For example:</span></span>

  - <span data-ttu-id="857da-165">Požadavek na `/api/users/foo` se směruje na instanci služby`fabric:/app/users/foo`</span><span class="sxs-lookup"><span data-stu-id="857da-165">A request to `/api/users/foo` is routed to service instance `fabric:/app/users/foo`</span></span>
  - <span data-ttu-id="857da-166">Požadavek na `/api/users/bar` se směruje na instanci služby`fabric:/app/users/bar`</span><span class="sxs-lookup"><span data-stu-id="857da-166">A request to `/api/users/bar` is routed to service instance `fabric:/app/users/bar`</span></span>

<span data-ttu-id="857da-167">Každá instance služby je také rozdělen na oddíly pomocí schéma oddílu Int64 dva oddíly a klíče rozsah, který zahrnuje `Int64.MinValue` k `Int64.MaxValue`.</span><span class="sxs-lookup"><span data-stu-id="857da-167">Each service instance is also partitioned using the Int64 partition scheme with two partitions and a key range that spans `Int64.MinValue` to `Int64.MaxValue`.</span></span> <span data-ttu-id="857da-168">Zásady back-end vypočítá klíč oddílu v tomto rozsahu převedením `id` hodnota zadaná v žádosti o cestě adresy URL 64bitové celé číslo, i když libovolný algoritmus lze zde výpočetní klíč oddílu.</span><span class="sxs-lookup"><span data-stu-id="857da-168">The back-end policy computes a partition key within that range by converting the `id` value provided in the URL request path to a 64-bit integer, although any algorithm can be used here to compute the partition key.</span></span> 

![Service Fabric s Azure API Management přehled topologie][sf-apim-dynamic-stateful]

## <a name="next-steps"></a><span data-ttu-id="857da-170">Další kroky</span><span class="sxs-lookup"><span data-stu-id="857da-170">Next steps</span></span>

<span data-ttu-id="857da-171">Postupujte podle [úvodní příručka](service-fabric-api-management-quick-start.md) nastavit první clusteru Service Fabric pomocí API Management a toku požadavky prostřednictvím rozhraní API správy k vašim službám.</span><span class="sxs-lookup"><span data-stu-id="857da-171">Follow the [quick start guide](service-fabric-api-management-quick-start.md) to set up your first Service Fabric cluster with API Management and flow requests through API Management to your services.</span></span>

<!-- links -->

<!-- pics -->
[sf-apim-web-app]: ./media/service-fabric-api-management-overview/sf-apim-web-app.png
[sf-web-app-stateless-gateway]: ./media/service-fabric-api-management-overview/sf-web-app-stateless-gateway.png
[sf-apim-static-stateless]: ./media/service-fabric-api-management-overview/sf-apim-static-stateless.png
[sf-apim-static-stateful]: ./media/service-fabric-api-management-overview/sf-apim-static-stateful.png
[sf-apim-dynamic-stateless]: ./media/service-fabric-api-management-overview/sf-apim-dynamic-stateless.png
[sf-apim-dynamic-stateful]: ./media/service-fabric-api-management-overview/sf-apim-dynamic-stateful.png