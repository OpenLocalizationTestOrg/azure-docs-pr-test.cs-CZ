---
title: "aaaUsing Elasticsearch jako úložiště trasování aplikace Service Fabric | Microsoft Docs"
description: "Popisuje, jak můžete použít aplikace Service Fabric Elasticsearch a Kibana toostore, rejstřík a vyhledávání pomocí trasování aplikací (protokoly)"
services: service-fabric
documentationcenter: .net
author: karolz-ms
manager: adegeo
editor: 
ms.assetid: e59b0c39-e468-4d9e-b453-d5f2a8ad20d8
ms.service: service-fabric
ms.devlang: dotNet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 04/07/2017
ms.author: karolz@microsoft.com
redirect_url: /azure/service-fabric/service-fabric-diagnostics-event-aggregation-eventflow
ms.openlocfilehash: b5977c54e69319e3caa376e44a02f971b66a3254
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="use-elasticsearch-as-a-service-fabric-application-trace-store"></a><span data-ttu-id="cbd18-103">Uložení Elasticsearch použijte jako trasování aplikace Service Fabric</span><span class="sxs-lookup"><span data-stu-id="cbd18-103">Use Elasticsearch as a Service Fabric application trace store</span></span>
## <a name="introduction"></a><span data-ttu-id="cbd18-104">Úvod</span><span class="sxs-lookup"><span data-stu-id="cbd18-104">Introduction</span></span>
<span data-ttu-id="cbd18-105">Tento článek popisuje, jak [Azure Service Fabric](https://azure.microsoft.com/documentation/services/service-fabric/) aplikace můžete použít **Elasticsearch** a **Kibana** pro úložiště trasování aplikací, indexování a vyhledávání.</span><span class="sxs-lookup"><span data-stu-id="cbd18-105">This article describes how [Azure Service Fabric](https://azure.microsoft.com/documentation/services/service-fabric/) applications can use **Elasticsearch** and **Kibana** for application trace storage, indexing, and search.</span></span> <span data-ttu-id="cbd18-106">[Elasticsearch](https://www.elastic.co/guide/index.html) open source, distribuované a škálovatelné v reálném čase vyhledávání a analýzy modul, který je vhodná pro tuto úlohu.</span><span class="sxs-lookup"><span data-stu-id="cbd18-106">[Elasticsearch](https://www.elastic.co/guide/index.html) is an open-source, distributed, and scalable real-time search and analytics engine that is well-suited for this task.</span></span> <span data-ttu-id="cbd18-107">Je můžete nainstalovat na Windows a Linux virtuální počítače běžící v Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="cbd18-107">It can be installed on Windows and Linux virtual machines running in Microsoft Azure.</span></span> <span data-ttu-id="cbd18-108">Elasticsearch efektivně zpracovávat *strukturovaných* trasování vytvořeného pomocí technologie, jako třeba **trasování událostí pro Windows (ETW)**.</span><span class="sxs-lookup"><span data-stu-id="cbd18-108">Elasticsearch can efficiently process *structured* traces produced using technologies such as **Event Tracing for Windows (ETW)**.</span></span>

<span data-ttu-id="cbd18-109">Trasování událostí pro Windows používá Service Fabric toosource diagnostické informace o běhu programu (trasování).</span><span class="sxs-lookup"><span data-stu-id="cbd18-109">ETW is used by Service Fabric runtime toosource diagnostic information (traces).</span></span> <span data-ttu-id="cbd18-110">Je, že hello doporučené metody pro toosource aplikace Service Fabric diagnostické informace, příliš.</span><span class="sxs-lookup"><span data-stu-id="cbd18-110">It is hello recommended method for Service Fabric applications toosource their diagnostic information, too.</span></span> <span data-ttu-id="cbd18-111">Pomocí hello shodný mechanismus umožňuje korelace mezi trasování zadaná runtime a zadané aplikace a díky při odstraňování problémů.</span><span class="sxs-lookup"><span data-stu-id="cbd18-111">Using hello same mechanism allows for correlation between runtime-supplied and application-supplied traces and makes troubleshooting easier.</span></span> <span data-ttu-id="cbd18-112">Šablony projektu Service Fabric v sadě Visual Studio zahrnují protokolování API (podle hello .NET **EventSource** třída) který vysílá trasování ETW ve výchozím nastavení.</span><span class="sxs-lookup"><span data-stu-id="cbd18-112">Service Fabric project templates in Visual Studio include a logging API (based on hello .NET **EventSource** class) that emits ETW traces by default.</span></span> <span data-ttu-id="cbd18-113">Obecné informace o aplikace Service Fabric trasování pomocí trasování událostí pro Windows, najdete v části [monitorování a Diagnostika služby v instalačním programu místním počítači vývoj](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md).</span><span class="sxs-lookup"><span data-stu-id="cbd18-113">For a general overview of Service Fabric application tracing using ETW, see [Monitoring and diagnosing services in a local machine development setup](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md).</span></span>

<span data-ttu-id="cbd18-114">Aby hello trasování tooshow nahoru v Elasticsearch potřebují mít toobe zaznamenané v uzlech clusteru Service Fabric hello v reálném čase (když je spuštěna aplikace hello) a odešle tooan Elasticsearch koncový bod.</span><span class="sxs-lookup"><span data-stu-id="cbd18-114">For hello traces tooshow up in Elasticsearch, they need toobe captured at hello Service Fabric cluster nodes in real time (while hello application is running) and sent tooan Elasticsearch endpoint.</span></span> <span data-ttu-id="cbd18-115">Existují dvě hlavní možnosti pro zaznamenání trasování:</span><span class="sxs-lookup"><span data-stu-id="cbd18-115">There are two major options for trace capturing:</span></span>

* <span data-ttu-id="cbd18-116">**Proces zaznamenávání trasování**</span><span class="sxs-lookup"><span data-stu-id="cbd18-116">**In-process trace capturing**</span></span>  
  <span data-ttu-id="cbd18-117">aplikace Hello nebo přesněji řečeno, proces služby je odpovědná za zasílání out hello diagnostických dat toohello trasování úložiště (Elasticsearch).</span><span class="sxs-lookup"><span data-stu-id="cbd18-117">hello application, or more precisely, service process, is responsible for sending out hello diagnostic data toohello trace store (Elasticsearch).</span></span>
* <span data-ttu-id="cbd18-118">**Zaznamenání mimo proces trasování**</span><span class="sxs-lookup"><span data-stu-id="cbd18-118">**Out-of-process trace capturing**</span></span>  
  <span data-ttu-id="cbd18-119">Samostatným agentem je zaznamenání trasování z procesu služby hello nebo procesy a odesláním toohello trasování úložiště.</span><span class="sxs-lookup"><span data-stu-id="cbd18-119">A separate agent is capturing traces from hello service process or processes and sending them toohello trace store.</span></span>

<span data-ttu-id="cbd18-120">Níže jsme popisují, jak tooset až Elasticsearch v Azure, a popisují hello specialisté a cons pro obě možnosti zachycení a vysvětlují, jak tooconfigure Service Fabric služby toosend data tooElasticsearch.</span><span class="sxs-lookup"><span data-stu-id="cbd18-120">Below, we describe how tooset up Elasticsearch on Azure, discuss hello pros and cons for both capture options, and explain how tooconfigure a Service Fabric service toosend data tooElasticsearch.</span></span>

## <a name="set-up-elasticsearch-on-azure"></a><span data-ttu-id="cbd18-121">Nastavit Elasticsearch v Azure</span><span class="sxs-lookup"><span data-stu-id="cbd18-121">Set up Elasticsearch on Azure</span></span>
<span data-ttu-id="cbd18-122">Hello tooset nejjednodušší způsob, jak si hello Elasticsearch služby v Azure je prostřednictvím [ **šablon Azure Resource Manageru**](../azure-resource-manager/resource-group-overview.md).</span><span class="sxs-lookup"><span data-stu-id="cbd18-122">hello most straightforward way tooset up hello Elasticsearch service on Azure is through [**Azure Resource Manager templates**](../azure-resource-manager/resource-group-overview.md).</span></span> <span data-ttu-id="cbd18-123">O komplexní [šablony rychlý start Azure Resource Manageru pro Elasticsearch](https://github.com/Azure/azure-quickstart-templates/tree/master/elasticsearch) je k dispozici z úložiště Azure Quickstart šablony.</span><span class="sxs-lookup"><span data-stu-id="cbd18-123">A comprehensive [Quickstart Azure Resource Manager template for Elasticsearch](https://github.com/Azure/azure-quickstart-templates/tree/master/elasticsearch) is available from Azure Quickstart templates repository.</span></span> <span data-ttu-id="cbd18-124">Tato šablona používá samostatné úložiště účtů pro jednotky škálování (skupiny uzly).</span><span class="sxs-lookup"><span data-stu-id="cbd18-124">This template uses separate storage accounts for scale units (groups of nodes).</span></span> <span data-ttu-id="cbd18-125">Můžete také vytvářet, klienta a serveru uzly s různými konfiguracemi a různé počty datových disků připojených.</span><span class="sxs-lookup"><span data-stu-id="cbd18-125">It can also provision separate client and server nodes with different configurations and various numbers of data disks attached.</span></span>

<span data-ttu-id="cbd18-126">Tady používáme jinou šablonu, nazývá **ES MultiNode** z hello [úložiště Azure diagnostických nástrojů](https://github.com/Azure/azure-diagnostics-tools).</span><span class="sxs-lookup"><span data-stu-id="cbd18-126">Here, we use another template, called **ES-MultiNode** from hello [Azure diagnostic tools repository](https://github.com/Azure/azure-diagnostics-tools).</span></span> <span data-ttu-id="cbd18-127">Tato šablona je snazší toouse a vytvoří cluster služby Elasticsearch chráněn základní ověřování protokolu HTTP.</span><span class="sxs-lookup"><span data-stu-id="cbd18-127">This template is easier toouse, and it creates an Elasticsearch cluster protected by HTTP basic authentication.</span></span> <span data-ttu-id="cbd18-128">Než budete pokračovat, stáhněte hello úložiště z Githubu tooyour počítače (buď klonování úložiště hello nebo stažení souboru zip).</span><span class="sxs-lookup"><span data-stu-id="cbd18-128">Before you proceed, download hello repository from GitHub tooyour machine (by either cloning hello repository or downloading a zip file).</span></span> <span data-ttu-id="cbd18-129">Šablona Hello ES MultiNode se nachází ve složce hello s hello stejný název.</span><span class="sxs-lookup"><span data-stu-id="cbd18-129">hello ES-MultiNode template is located in hello folder with hello same name.</span></span>

### <a name="prepare-a-machine-toorun-elasticsearch-installation-scripts"></a><span data-ttu-id="cbd18-130">Příprava počítače toorun Elasticsearch skripty instalace</span><span class="sxs-lookup"><span data-stu-id="cbd18-130">Prepare a machine toorun Elasticsearch installation scripts</span></span>
<span data-ttu-id="cbd18-131">Hello nejjednodušší způsob, jak toouse hello ES MultiNode šablona je pomocí poskytnutého skriptu prostředí Azure PowerShell názvem `CreateElasticSearchCluster`.</span><span class="sxs-lookup"><span data-stu-id="cbd18-131">hello easiest way toouse hello ES-MultiNode template is through a provided Azure PowerShell script called `CreateElasticSearchCluster`.</span></span> <span data-ttu-id="cbd18-132">toouse tento skript, budete potřebovat tooinstall moduly prostředí PowerShell a nástroj nazvaný **openssl**.</span><span class="sxs-lookup"><span data-stu-id="cbd18-132">toouse this script, you need tooinstall PowerShell modules and a tool called **openssl**.</span></span> <span data-ttu-id="cbd18-133">Hello druhé je zapotřebí pro vytvoření klíče SSH, které můžou být použité tooadminister clusteru Elasticsearch vzdáleně.</span><span class="sxs-lookup"><span data-stu-id="cbd18-133">hello latter is needed for creating an SSH key that can be used tooadminister your Elasticsearch cluster remotely.</span></span>

<span data-ttu-id="cbd18-134">`CreateElasticSearchCluster`skript je určená pro snadné použití pomocí šablony hello ES MultiNode z počítače s Windows.</span><span class="sxs-lookup"><span data-stu-id="cbd18-134">`CreateElasticSearchCluster` script is designed for ease of use with hello ES-MultiNode template from a Windows machine.</span></span> <span data-ttu-id="cbd18-135">Je možné toouse hello šablony na počítač s jiným systémem než Windows, ale tento scénář je nad rámec tohoto článku hello.</span><span class="sxs-lookup"><span data-stu-id="cbd18-135">It is possible toouse hello template on a non-Windows machine, but that scenario is beyond hello scope of this article.</span></span>

1. <span data-ttu-id="cbd18-136">Pokud jste nenainstalovali je již, nainstalujte [ **modulů prostředí Azure PowerShell**](http://aka.ms/webpi-azps).</span><span class="sxs-lookup"><span data-stu-id="cbd18-136">If you haven't installed them already, install [**Azure PowerShell modules**](http://aka.ms/webpi-azps).</span></span> <span data-ttu-id="cbd18-137">Po zobrazení výzvy klikněte na tlačítko **spustit**, pak **nainstalovat**.</span><span class="sxs-lookup"><span data-stu-id="cbd18-137">When prompted, click **Run**, then **Install**.</span></span> <span data-ttu-id="cbd18-138">Azure PowerShell 1.3 nebo novější je povinný.</span><span class="sxs-lookup"><span data-stu-id="cbd18-138">Azure PowerShell 1.3 or newer is required.</span></span>
2. <span data-ttu-id="cbd18-139">Hello **openssl** nástroj je součástí distribuce hello [ **Git pro Windows**](http://www.git-scm.com/downloads).</span><span class="sxs-lookup"><span data-stu-id="cbd18-139">hello **openssl** tool is included in hello distribution of [**Git for Windows**](http://www.git-scm.com/downloads).</span></span> <span data-ttu-id="cbd18-140">Pokud jste tak ještě neučinili, nainstalujte [Git pro Windows](http://www.git-scm.com/downloads) nyní.</span><span class="sxs-lookup"><span data-stu-id="cbd18-140">If you have not done so already, install [Git for Windows](http://www.git-scm.com/downloads) now.</span></span> <span data-ttu-id="cbd18-141">(Možnosti instalace výchozí hello jsou OK).</span><span class="sxs-lookup"><span data-stu-id="cbd18-141">(hello default installation options are OK.)</span></span>
3. <span data-ttu-id="cbd18-142">Za předpokladu, že Git byl nainstalován, ale není zahrnutý v systémové cestě hello, otevřete okno Microsoft Azure PowerShell a spusťte následující příkazy hello:</span><span class="sxs-lookup"><span data-stu-id="cbd18-142">Assuming that Git has been installed but not included in hello system path, open a Microsoft Azure PowerShell window and run hello following commands:</span></span>
   
    ```powershell
    $ENV:PATH += ";<Git installation folder>\usr\bin"
    $ENV:OPENSSL_CONF = "<Git installation folder>\usr\ssl\openssl.cnf"
    ```
   
    <span data-ttu-id="cbd18-143">Nahraďte hello `<Git installation folder>` hello Git umístění na počítači; výchozí hodnota hello je **"C:\Program Files\Git"**.</span><span class="sxs-lookup"><span data-stu-id="cbd18-143">Replace hello `<Git installation folder>` with hello Git location on your machine; hello default is **"C:\Program Files\Git"**.</span></span> <span data-ttu-id="cbd18-144">Všimněte si hello středníkem od začátku hello hello první cesty.</span><span class="sxs-lookup"><span data-stu-id="cbd18-144">Note hello semicolon character at hello beginning of hello first path.</span></span>
4. <span data-ttu-id="cbd18-145">Ujistěte se, že jste přihlášeni tooAzure (prostřednictvím [ `Add-AzureRmAccount` ](https://msdn.microsoft.com/library/mt619267.aspx) rutiny) a zda jste vybrali hello předplatné, které by měl být použit toocreate cluster elastické vyhledávání.</span><span class="sxs-lookup"><span data-stu-id="cbd18-145">Ensure that you are logged on tooAzure (via [`Add-AzureRmAccount`](https://msdn.microsoft.com/library/mt619267.aspx) cmdlet) and that you have selected hello subscription that should be used toocreate your Elastic Search cluster.</span></span> <span data-ttu-id="cbd18-146">Můžete ověřit, že je vybrané správné předplatné pomocí `Get-AzureRmContext` a `Get-AzureRmSubscription` rutiny.</span><span class="sxs-lookup"><span data-stu-id="cbd18-146">You can verify that correct subscription is selected using `Get-AzureRmContext` and `Get-AzureRmSubscription` cmdlets.</span></span>
5. <span data-ttu-id="cbd18-147">Pokud jste tak ještě neučinili, změňte hello aktuální adresář toohello ES MultiNode.</span><span class="sxs-lookup"><span data-stu-id="cbd18-147">If you haven't done so already, change hello current directory toohello ES-MultiNode folder.</span></span>

### <a name="run-hello-createelasticsearchcluster-script"></a><span data-ttu-id="cbd18-148">Spusťte skript CreateElasticSearchCluster hello</span><span class="sxs-lookup"><span data-stu-id="cbd18-148">Run hello CreateElasticSearchCluster script</span></span>
<span data-ttu-id="cbd18-149">Před spuštěním skriptu hello, otevřete hello `azuredeploy-parameters.json` souboru a ověřte nebo zadejte hodnoty pro parametry skriptu hello.</span><span class="sxs-lookup"><span data-stu-id="cbd18-149">Before you run hello script, open hello `azuredeploy-parameters.json` file and verify or provide values for hello script parameters.</span></span> <span data-ttu-id="cbd18-150">jsou k dispozici Hello následující parametry:</span><span class="sxs-lookup"><span data-stu-id="cbd18-150">hello following parameters are provided:</span></span>

| <span data-ttu-id="cbd18-151">Název parametru</span><span class="sxs-lookup"><span data-stu-id="cbd18-151">Parameter Name</span></span> | <span data-ttu-id="cbd18-152">Popis</span><span class="sxs-lookup"><span data-stu-id="cbd18-152">Description</span></span> |
| --- | --- |
| <span data-ttu-id="cbd18-153">dnsNameForLoadBalancerIP</span><span class="sxs-lookup"><span data-stu-id="cbd18-153">dnsNameForLoadBalancerIP</span></span> |<span data-ttu-id="cbd18-154">Hello název, který je použité toocreate hello veřejně viditelný DNS název clusteru elastické vyhledávání hello (přidáním hello oblast Azure domény toohello zadaný název).</span><span class="sxs-lookup"><span data-stu-id="cbd18-154">hello name that is used toocreate hello publicly visible DNS name for hello Elastic Search cluster (by appending hello Azure region domain toohello provided name).</span></span> <span data-ttu-id="cbd18-155">Například pokud je tato hodnota parametru "myBigCluster" a hello vybrali oblast Azure je západní USA, hello výsledný název DNS pro hello cluster je myBigCluster.westus.cloudapp.azure.com.</span><span class="sxs-lookup"><span data-stu-id="cbd18-155">For example, if this parameter value is "myBigCluster" and hello chosen Azure region is West US, hello resulting DNS name for hello cluster is myBigCluster.westus.cloudapp.azure.com.</span></span> <br /><br /><span data-ttu-id="cbd18-156">Tento název slouží také jako název kořenové pro mnoho artefakty přidružené hello elastické vyhledávání clusterem, jako jsou názvy data.</span><span class="sxs-lookup"><span data-stu-id="cbd18-156">This name also serves as a root name for many artifacts associated with hello Elastic Search cluster, such as data node names.</span></span> |
| <span data-ttu-id="cbd18-157">adminUsername</span><span class="sxs-lookup"><span data-stu-id="cbd18-157">adminUsername</span></span> |<span data-ttu-id="cbd18-158">Název Hello hello správce účtu pro správu clusteru elastické vyhledávání hello (odpovídající klíče SSH jsou automaticky generovány.).</span><span class="sxs-lookup"><span data-stu-id="cbd18-158">hello name of hello administrator account for managing hello Elastic Search cluster (corresponding SSH keys are generated automatically).</span></span> |
| <span data-ttu-id="cbd18-159">dataNodeCount</span><span class="sxs-lookup"><span data-stu-id="cbd18-159">dataNodeCount</span></span> |<span data-ttu-id="cbd18-160">Hello počet uzlů v clusteru elastické vyhledávání hello.</span><span class="sxs-lookup"><span data-stu-id="cbd18-160">hello number of nodes in hello Elastic Search cluster.</span></span> <span data-ttu-id="cbd18-161">aktuální verze Hello hello skriptu nerozlišuje mezi uzly dat a dotazu. všechny uzly přehrát obě role.</span><span class="sxs-lookup"><span data-stu-id="cbd18-161">hello current version of hello script does not distinguish between data and query nodes; all nodes play both roles.</span></span> <span data-ttu-id="cbd18-162">Výchozí hodnoty too3 uzlů.</span><span class="sxs-lookup"><span data-stu-id="cbd18-162">Defaults too3 nodes.</span></span> |
| <span data-ttu-id="cbd18-163">dataDiskSize</span><span class="sxs-lookup"><span data-stu-id="cbd18-163">dataDiskSize</span></span> |<span data-ttu-id="cbd18-164">velikost Hello, datových disků (v GB), který je přidělen pro každý uzel data.</span><span class="sxs-lookup"><span data-stu-id="cbd18-164">hello size of data disks (in GB) that is allocated for each data node.</span></span> <span data-ttu-id="cbd18-165">Každý uzel přijme 4 datových disků, výhradně vyhrazené tooElastic službu vyhledávání.</span><span class="sxs-lookup"><span data-stu-id="cbd18-165">Each node receives 4 data disks, exclusively dedicated tooElastic Search service.</span></span> |
| <span data-ttu-id="cbd18-166">Oblast</span><span class="sxs-lookup"><span data-stu-id="cbd18-166">region</span></span> |<span data-ttu-id="cbd18-167">Hello název oblasti Azure, kde by měl být umístěn hello elastické vyhledávání clusteru.</span><span class="sxs-lookup"><span data-stu-id="cbd18-167">hello name of Azure region where hello Elastic Search cluster should be located.</span></span> |
| <span data-ttu-id="cbd18-168">esUserName</span><span class="sxs-lookup"><span data-stu-id="cbd18-168">esUserName</span></span> |<span data-ttu-id="cbd18-169">Hello uživatelské jméno hello uživatele, který je nakonfigurován toohave přístup tooES clusteru (subjektu tooHTTP základní ověřování).</span><span class="sxs-lookup"><span data-stu-id="cbd18-169">hello user name of hello user that is configured toohave access tooES cluster (subject tooHTTP basic authentication).</span></span> <span data-ttu-id="cbd18-170">Hello heslo není součástí souboru parametrů a je třeba zadat při `CreateElasticSearchCluster` vyvolání skriptu.</span><span class="sxs-lookup"><span data-stu-id="cbd18-170">hello password is not part of parameters file and must be provided when `CreateElasticSearchCluster` script is invoked.</span></span> |
| <span data-ttu-id="cbd18-171">vmSizeDataNodes</span><span class="sxs-lookup"><span data-stu-id="cbd18-171">vmSizeDataNodes</span></span> |<span data-ttu-id="cbd18-172">Hello velikost virtuálního počítače Azure pro uzly clusteru elastické vyhledávání.</span><span class="sxs-lookup"><span data-stu-id="cbd18-172">hello Azure virtual machine size for Elastic Search cluster nodes.</span></span> <span data-ttu-id="cbd18-173">TooStandard_D2 výchozí hodnoty.</span><span class="sxs-lookup"><span data-stu-id="cbd18-173">Defaults tooStandard_D2.</span></span> |

<span data-ttu-id="cbd18-174">Teď je připraven toorun hello skriptu.</span><span class="sxs-lookup"><span data-stu-id="cbd18-174">Now you are ready toorun hello script.</span></span> <span data-ttu-id="cbd18-175">Problém hello následující příkaz:</span><span class="sxs-lookup"><span data-stu-id="cbd18-175">Issue hello following command:</span></span>

```powershell
CreateElasticSearchCluster -ResourceGroupName <es-group-name> -Region <azure-region> -EsPassword <es-password>
```

<span data-ttu-id="cbd18-176">kde</span><span class="sxs-lookup"><span data-stu-id="cbd18-176">where</span></span> 

| <span data-ttu-id="cbd18-177">Název parametru skriptu</span><span class="sxs-lookup"><span data-stu-id="cbd18-177">Script Parameter Name</span></span> | <span data-ttu-id="cbd18-178">Popis</span><span class="sxs-lookup"><span data-stu-id="cbd18-178">Description</span></span> |
| --- | --- |
| `<es-group-name>` |<span data-ttu-id="cbd18-179">Hello název skupiny prostředků Azure hello, která bude obsahovat všechny prostředky clusteru elastické vyhledávání.</span><span class="sxs-lookup"><span data-stu-id="cbd18-179">hello name of hello Azure resource group that will contain all Elastic Search cluster resources.</span></span> |
| `<azure-region>` |<span data-ttu-id="cbd18-180">Název Hello hello oblast Azure, kde by se měl vytvořit hello elastické vyhledávání clusteru.</span><span class="sxs-lookup"><span data-stu-id="cbd18-180">hello name of hello Azure region where hello Elastic Search cluster should be created.</span></span> |
| `<es-password>` |<span data-ttu-id="cbd18-181">Hello heslo pro hello elastické hledat uživatele.</span><span class="sxs-lookup"><span data-stu-id="cbd18-181">hello password for hello Elastic Search user.</span></span> |

> [!NOTE]
> <span data-ttu-id="cbd18-182">Pokud dojde NullReferenceException z rutiny Test-AzureResourceGroup hello, že jste zapomněli toolog na tooAzure (`Add-AzureRmAccount`).</span><span class="sxs-lookup"><span data-stu-id="cbd18-182">If you get a NullReferenceException from hello Test-AzureResourceGroup cmdlet, you have forgotten toolog on tooAzure (`Add-AzureRmAccount`).</span></span>
> 
> 

<span data-ttu-id="cbd18-183">Pokud dojde k chybě z skriptu hello a zjistíte, hello chyba způsobila hodnotu parametru nesprávný šablony, opravte hello soubor parametrů a znovu spusťte hello skript s názvem skupiny prostředků jiného.</span><span class="sxs-lookup"><span data-stu-id="cbd18-183">If you get an error from running hello script and you determine that hello error was caused by a wrong template parameter value, correct hello parameter file and run hello script again with a different resource group name.</span></span> <span data-ttu-id="cbd18-184">Také můžete opakovaně použít hello stejný název skupiny prostředků a mít hello skript vyčištění hello starý přidáním hello `-RemoveExistingResourceGroup` parametr toohello skriptu volání.</span><span class="sxs-lookup"><span data-stu-id="cbd18-184">You can also reuse hello same resource group name and have hello script clean up hello old one by adding hello `-RemoveExistingResourceGroup` parameter toohello script invocation.</span></span>

### <a name="result-of-running-hello-createelasticsearchcluster-script"></a><span data-ttu-id="cbd18-185">Výsledek skriptu CreateElasticSearchCluster hello</span><span class="sxs-lookup"><span data-stu-id="cbd18-185">Result of running hello CreateElasticSearchCluster script</span></span>
<span data-ttu-id="cbd18-186">Po spuštění hello `CreateElasticSearchCluster` skriptu, bude vytvořena následující hlavní artefakty hello.</span><span class="sxs-lookup"><span data-stu-id="cbd18-186">After you run hello `CreateElasticSearchCluster` script, hello following main artifacts will be created.</span></span> <span data-ttu-id="cbd18-187">V tomto příkladu předpokládáme, že jste už použili "myBigCluster" jako hodnota hello hello `dnsNameForLoadBalancerIP` parametr a že hello oblasti, kde jste vytvořili hello clusteru je západní USA.</span><span class="sxs-lookup"><span data-stu-id="cbd18-187">For this example we assume that you have used "myBigCluster" as hello value of hello `dnsNameForLoadBalancerIP` parameter and that hello region where you created hello cluster is West US.</span></span>

| <span data-ttu-id="cbd18-188">Artefaktů</span><span class="sxs-lookup"><span data-stu-id="cbd18-188">Artifact</span></span> | <span data-ttu-id="cbd18-189">Název, umístění a poznámky</span><span class="sxs-lookup"><span data-stu-id="cbd18-189">Name, location, and remarks</span></span> |
| --- | --- |
| <span data-ttu-id="cbd18-190">Klíč SSH pro vzdálenou správu</span><span class="sxs-lookup"><span data-stu-id="cbd18-190">SSH key for remote administration</span></span> |<span data-ttu-id="cbd18-191">myBigCluster.key soubor (ve hello adresář, ze které hello se spouštěl CreateElasticSearchCluster).</span><span class="sxs-lookup"><span data-stu-id="cbd18-191">myBigCluster.key file (in hello directory from which hello CreateElasticSearchCluster was run).</span></span> <br /><br /><span data-ttu-id="cbd18-192">Tento soubor klíče může být použité tooconnect toohello správce uzlu a (prostřednictvím Správce uzel hello) toodata uzly v clusteru hello.</span><span class="sxs-lookup"><span data-stu-id="cbd18-192">This key file can be used tooconnect toohello admin node and (through hello admin node) toodata nodes in hello cluster.</span></span> |
| <span data-ttu-id="cbd18-193">Správce uzlu</span><span class="sxs-lookup"><span data-stu-id="cbd18-193">Admin node</span></span> |<span data-ttu-id="cbd18-194">myBigCluster admin.westus.cloudapp.azure.com</span><span class="sxs-lookup"><span data-stu-id="cbd18-194">myBigCluster-admin.westus.cloudapp.azure.com</span></span> <br /><br /><span data-ttu-id="cbd18-195">Vyhrazený virtuální počítač pro vzdálenou správu clusteru Elasticsearch – hello pouze jeden, který umožňuje externí připojení SSH.</span><span class="sxs-lookup"><span data-stu-id="cbd18-195">A dedicated VM for remote Elasticsearch cluster administration--hello only one that allows external SSH connections.</span></span> <span data-ttu-id="cbd18-196">Běží na hello nemá stejné virtuální síti jako všechny uzly clusteru Elasticsearch hello, ale nejde spustit žádné služby, Elasticsearch.</span><span class="sxs-lookup"><span data-stu-id="cbd18-196">It runs on hello same virtual network as all hello Elasticsearch cluster nodes, but it does not run any Elasticsearch services.</span></span> |
| <span data-ttu-id="cbd18-197">Datové uzly</span><span class="sxs-lookup"><span data-stu-id="cbd18-197">Data nodes</span></span> |<span data-ttu-id="cbd18-198">myBigCluster1...</span><span class="sxs-lookup"><span data-stu-id="cbd18-198">myBigCluster1 …</span></span> <span data-ttu-id="cbd18-199">myBigCluster*N*</span><span class="sxs-lookup"><span data-stu-id="cbd18-199">myBigCluster*N*</span></span> <br /><br /><span data-ttu-id="cbd18-200">Datové uzly, které jsou spuštěny služby Elasticsearch a Kibana.</span><span class="sxs-lookup"><span data-stu-id="cbd18-200">Data nodes that are running Elasticsearch and Kibana services.</span></span> <span data-ttu-id="cbd18-201">Můžete připojit přes SSH tooeach uzlu, ale pouze prostřednictvím hello správce uzlu.</span><span class="sxs-lookup"><span data-stu-id="cbd18-201">You can connect via SSH tooeach node, but only via hello admin node.</span></span> |
| <span data-ttu-id="cbd18-202">Elasticsearch clusteru</span><span class="sxs-lookup"><span data-stu-id="cbd18-202">Elasticsearch cluster</span></span> |<span data-ttu-id="cbd18-203">http://myBigCluster.westus.cloudapp.Azure.com/ES/</span><span class="sxs-lookup"><span data-stu-id="cbd18-203">http://myBigCluster.westus.cloudapp.azure.com/es/</span></span> <br /><br /><span data-ttu-id="cbd18-204">Hello primární koncový bod pro cluster Elasticsearch hello (Poznámka hello /es přípona).</span><span class="sxs-lookup"><span data-stu-id="cbd18-204">hello primary endpoint for hello Elasticsearch cluster (note hello /es suffix).</span></span> <span data-ttu-id="cbd18-205">Je chráněn základní ověřování protokolu HTTP (hello přihlašovací údaje byly hello zadané parametry esUserName nebo esPassword hello ES MultiNode šablony).</span><span class="sxs-lookup"><span data-stu-id="cbd18-205">It is protected by basic HTTP authentication (hello credentials were hello specified esUserName/esPassword parameters of hello ES-MultiNode template).</span></span> <span data-ttu-id="cbd18-206">Hello cluster má také hello head modulu plug-in nainstalovaný (http://myBigCluster.westus.cloudapp.azure.com/es/_plugin/head) pro správu základní cluster.</span><span class="sxs-lookup"><span data-stu-id="cbd18-206">hello cluster has also hello head plug-in installed (http://myBigCluster.westus.cloudapp.azure.com/es/_plugin/head) for basic cluster administration.</span></span> |
| <span data-ttu-id="cbd18-207">Kibana služby</span><span class="sxs-lookup"><span data-stu-id="cbd18-207">Kibana service</span></span> |<span data-ttu-id="cbd18-208">http://myBigCluster.westus.cloudapp.Azure.com</span><span class="sxs-lookup"><span data-stu-id="cbd18-208">http://myBigCluster.westus.cloudapp.azure.com</span></span> <br /><br /><span data-ttu-id="cbd18-209">Hello Kibana služby je nastavený tooshow data z hello vytvořit Elasticsearch clusteru.</span><span class="sxs-lookup"><span data-stu-id="cbd18-209">hello Kibana service is set up tooshow data from hello created Elasticsearch cluster.</span></span> <span data-ttu-id="cbd18-210">Je chráněn hello stejné přihlašovací údaje ověřování jako hello cluster sám sebe.</span><span class="sxs-lookup"><span data-stu-id="cbd18-210">It is protected by hello same authentication credentials as hello cluster itself.</span></span> |

## <a name="in-process-versus-out-of-process-trace-capturing"></a><span data-ttu-id="cbd18-211">V procesu versus zaznamenávání mimo proces trasování</span><span class="sxs-lookup"><span data-stu-id="cbd18-211">In-process versus out-of-process trace capturing</span></span>
<span data-ttu-id="cbd18-212">V hello Úvod jsme uvedených dva základní způsoby shromažďování diagnostických dat: v rámci procesu a mimo proces.</span><span class="sxs-lookup"><span data-stu-id="cbd18-212">In hello introduction, we mentioned two fundamental ways of collecting diagnostic data: in-process and out-of-process.</span></span> <span data-ttu-id="cbd18-213">Každý má silné a slabé stránky.</span><span class="sxs-lookup"><span data-stu-id="cbd18-213">Each has strengths and weaknesses.</span></span>

<span data-ttu-id="cbd18-214">Výhody hello **proces zaznamenávání trasování** zahrnují:</span><span class="sxs-lookup"><span data-stu-id="cbd18-214">Advantages of hello **in-process trace capturing** include:</span></span>

1. <span data-ttu-id="cbd18-215">*Jednoduchá konfigurace a nasazení*</span><span class="sxs-lookup"><span data-stu-id="cbd18-215">*Easy configuration and deployment*</span></span>
   
   * <span data-ttu-id="cbd18-216">Konfigurace Hello shromažďování diagnostických dat je právě součástí konfigurace aplikace hello.</span><span class="sxs-lookup"><span data-stu-id="cbd18-216">hello configuration of diagnostic data collection is just part of hello application configuration.</span></span> <span data-ttu-id="cbd18-217">Je snadno tooalways zachovat ji "synchronizována" s hello rest aplikace hello.</span><span class="sxs-lookup"><span data-stu-id="cbd18-217">It is easy tooalways keep it "in sync" with hello rest of hello application.</span></span>
   * <span data-ttu-id="cbd18-218">Konfigurace pro aplikaci nebo službě,-je snadno dosažitelné.</span><span class="sxs-lookup"><span data-stu-id="cbd18-218">Per-application or per-service configuration is easily achievable.</span></span>
   * <span data-ttu-id="cbd18-219">Trasování mimo proces zaznamenávání obvykle vyžaduje samostatné nasazení a konfiguraci diagnostiky agenta hello, což je velmi Správce úloh a potenciální příčinu chyby.</span><span class="sxs-lookup"><span data-stu-id="cbd18-219">Out-of-process trace capturing usually requires a separate deployment and configuration of hello diagnostic agent, which is an extra administrative task and a potential source of errors.</span></span> <span data-ttu-id="cbd18-220">technologie konkrétní agenta Hello často umožňuje jenom jednu instanci hello agenta na virtuální počítač (uzel).</span><span class="sxs-lookup"><span data-stu-id="cbd18-220">hello particular agent technology often allows only one instance of hello agent per virtual machine (node).</span></span> <span data-ttu-id="cbd18-221">To znamená že konfigurace pro kolekci hello konfigurace diagnostiky hello sdílí všechny aplikace a služby spuštěné v tomto uzlu.</span><span class="sxs-lookup"><span data-stu-id="cbd18-221">This means that configuration for hello collection of hello diagnostic configuration is shared among all applications and services running on that node.</span></span>
2. <span data-ttu-id="cbd18-222">*Flexibilita*</span><span class="sxs-lookup"><span data-stu-id="cbd18-222">*Flexibility*</span></span>
   
   * <span data-ttu-id="cbd18-223">Hello aplikace může odesílat hello data bez ohledu na potřebuje toogo, dokud není klientské knihovny, která podporuje systém úložiště dat hello cílové.</span><span class="sxs-lookup"><span data-stu-id="cbd18-223">hello application can send hello data wherever it needs toogo, as long as there is a client library that supports hello targeted data storage system.</span></span> <span data-ttu-id="cbd18-224">Můžete přidat nové jímky podle potřeby.</span><span class="sxs-lookup"><span data-stu-id="cbd18-224">New sinks can be added as desired.</span></span>
   * <span data-ttu-id="cbd18-225">Komplexní zachycení, filtrování a agregace dat pravidla mohou být implementována.</span><span class="sxs-lookup"><span data-stu-id="cbd18-225">Complex capture, filtering, and data-aggregation rules can be implemented.</span></span>
   * <span data-ttu-id="cbd18-226">Trasování mimo proces zachycení je často omezena jímky hello dat, které hello agent podporuje.</span><span class="sxs-lookup"><span data-stu-id="cbd18-226">An out-of-process trace capturing is often limited by hello data sinks that hello agent supports.</span></span> <span data-ttu-id="cbd18-227">Někteří agenti jsou extensible.</span><span class="sxs-lookup"><span data-stu-id="cbd18-227">Some agents are extensible.</span></span>
3. <span data-ttu-id="cbd18-228">*Data aplikací toointernal přístup a kontext*</span><span class="sxs-lookup"><span data-stu-id="cbd18-228">*Access toointernal application data and context*</span></span>
   
   * <span data-ttu-id="cbd18-229">diagnostické subsystému Hello běžících v rámci procesu aplikace nebo služby hello můžete snadno posílení hello trasování s kontextové informace.</span><span class="sxs-lookup"><span data-stu-id="cbd18-229">hello diagnostic subsystem running inside hello application/service process can easily augment hello traces with contextual information.</span></span>
   * <span data-ttu-id="cbd18-230">V hello přístupu mimo proces, hello data musí být odeslána tooan agent prostřednictvím některé mechanismus komunikace mezi procesy, jako je například trasování událostí pro Windows.</span><span class="sxs-lookup"><span data-stu-id="cbd18-230">In hello out-of-process approach, hello data must be sent tooan agent via some inter-process communication mechanism, such as Event Tracing for Windows.</span></span> <span data-ttu-id="cbd18-231">Tento mechanismus může použít další omezení.</span><span class="sxs-lookup"><span data-stu-id="cbd18-231">This mechanism could impose additional limitations.</span></span>

<span data-ttu-id="cbd18-232">Výhody hello **trasování mimo proces zaznamenávání** zahrnují:</span><span class="sxs-lookup"><span data-stu-id="cbd18-232">Advantages of hello **out-of-process trace capturing** include:</span></span>

1. <span data-ttu-id="cbd18-233">*Hello možnost toomonitor hello aplikaci a shromažďování výpisy stavu systému*</span><span class="sxs-lookup"><span data-stu-id="cbd18-233">*hello ability toomonitor hello application and collect crash dumps*</span></span>
   
   * <span data-ttu-id="cbd18-234">V procesu trasování zaznamenávání mohou neúspěšné, pokud aplikace hello selže toostart nebo dojde k chybě.</span><span class="sxs-lookup"><span data-stu-id="cbd18-234">In-process trace capturing may be unsuccessful if hello application fails toostart or crashes.</span></span> <span data-ttu-id="cbd18-235">Nezávislého agenta má mnohem větší šanci zachycení zásadní informace o odstraňování potíží.</span><span class="sxs-lookup"><span data-stu-id="cbd18-235">An independent agent has a much better chance of capturing crucial troubleshooting information.</span></span><br /><br />
2. <span data-ttu-id="cbd18-236">*Vyspělosti, odolné a principy výkonu*</span><span class="sxs-lookup"><span data-stu-id="cbd18-236">*Maturity, robustness, and proven performance*</span></span>
   
   * <span data-ttu-id="cbd18-237">Agenta vyvinuté dodavatelem platformy (například Microsoft Azure Diagnostics agent) byl subjektu toorigorous testování a boj-posílení zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="cbd18-237">An agent developed by a platform vendor (such as a Microsoft Azure Diagnostics agent) has been subject toorigorous testing and battle-hardening.</span></span>
   * <span data-ttu-id="cbd18-238">Pomocí trasování v procesu zachycení musí dát pozor tooensure že hello aktivitu odesílání diagnostických dat z aplikační proces narušovat hlavní úlohy hello aplikace nebo nastat problémy načasování nebo výkonu.</span><span class="sxs-lookup"><span data-stu-id="cbd18-238">With in-process trace capturing, care must be taken tooensure that hello activity of sending diagnostic data from an application process does not interfere with hello application's main tasks or introduce timing or performance problems.</span></span> <span data-ttu-id="cbd18-239">Nezávisle spuštěné agenta je méně náchylná toothese problémy a je speciálně navrženého toolimit jeho dopad na hello systému.</span><span class="sxs-lookup"><span data-stu-id="cbd18-239">An independently running agent is less prone toothese issues and is specifically designed toolimit its impact on hello system.</span></span>

<span data-ttu-id="cbd18-240">Je možné toocombine a benefit z obou přístupů.</span><span class="sxs-lookup"><span data-stu-id="cbd18-240">It is possible toocombine and benefit from both approaches.</span></span> <span data-ttu-id="cbd18-241">Ve skutečnosti může být hello nejlepší řešení pro mnoho aplikací.</span><span class="sxs-lookup"><span data-stu-id="cbd18-241">Indeed, it might be hello best solution for many applications.</span></span>

<span data-ttu-id="cbd18-242">Tady používáme hello **Microsoft.Diagnostic.Listeners knihovny** a trasování v procesu hello zaznamenání dat toosend z clusteru Service Fabric aplikace tooan Elasticsearch.</span><span class="sxs-lookup"><span data-stu-id="cbd18-242">Here, we use hello **Microsoft.Diagnostic.Listeners library** and hello in-process trace capturing toosend data from a Service Fabric application tooan Elasticsearch cluster.</span></span>

## <a name="use-hello-listeners-library-toosend-diagnostic-data-tooelasticsearch"></a><span data-ttu-id="cbd18-243">Použít hello naslouchací procesy knihovny toosend diagnostických dat tooElasticsearch</span><span class="sxs-lookup"><span data-stu-id="cbd18-243">Use hello Listeners library toosend diagnostic data tooElasticsearch</span></span>
<span data-ttu-id="cbd18-244">Knihovna Microsoft.Diagnostic.Listeners Hello je součástí aplikace Service Fabric PartyCluster ukázka.</span><span class="sxs-lookup"><span data-stu-id="cbd18-244">hello Microsoft.Diagnostic.Listeners library is part of PartyCluster sample Service Fabric application.</span></span> <span data-ttu-id="cbd18-245">toouse ho:</span><span class="sxs-lookup"><span data-stu-id="cbd18-245">toouse it:</span></span>

1. <span data-ttu-id="cbd18-246">Stáhněte si [hello PartyCluster ukázka](https://github.com/Azure-Samples/service-fabric-dotnet-management-party-cluster) z Githubu.</span><span class="sxs-lookup"><span data-stu-id="cbd18-246">Download [hello PartyCluster sample](https://github.com/Azure-Samples/service-fabric-dotnet-management-party-cluster) from GitHub.</span></span>
2. <span data-ttu-id="cbd18-247">Zkopírujte hello Microsoft.Diagnostics.Listeners a Microsoft.Diagnostics.Listeners.Fabric projekty (celý složky) z hello PartyCluster ukázka toohello řešení složku hello aplikace, která by měla toosend hello data tooElasticsearch .</span><span class="sxs-lookup"><span data-stu-id="cbd18-247">Copy hello Microsoft.Diagnostics.Listeners and Microsoft.Diagnostics.Listeners.Fabric projects (whole folders) from hello PartyCluster sample directory toohello solution folder of hello application that is supposed toosend hello data tooElasticsearch.</span></span>
3. <span data-ttu-id="cbd18-248">Otevřít řešení hello cíl, klikněte pravým tlačítkem na uzel řešení hello v hello Průzkumníku řešení a zvolte **přidat existující projekt**.</span><span class="sxs-lookup"><span data-stu-id="cbd18-248">Open hello target solution, right-click hello solution node in hello Solution Explorer, and choose **Add Existing Project**.</span></span> <span data-ttu-id="cbd18-249">Přidejte hello Microsoft.Diagnostics.Listeners projekt toohello řešení.</span><span class="sxs-lookup"><span data-stu-id="cbd18-249">Add hello Microsoft.Diagnostics.Listeners project toohello solution.</span></span> <span data-ttu-id="cbd18-250">Opakujte stejný hello hello Microsoft.Diagnostics.Listeners.Fabric projektu.</span><span class="sxs-lookup"><span data-stu-id="cbd18-250">Repeat hello same for hello Microsoft.Diagnostics.Listeners.Fabric project.</span></span>
4. <span data-ttu-id="cbd18-251">Přidáte odkaz na projekt z vaší služby projekty toohello dva přidané projekty.</span><span class="sxs-lookup"><span data-stu-id="cbd18-251">Add a project reference from your service project(s) toohello two added projects.</span></span> <span data-ttu-id="cbd18-252">(Každá služba, která by měla toosend data tooElasticsearch by měl odkazovat Microsoft.Diagnostics.EventListeners a Microsoft.Diagnostics.EventListeners.Fabric).</span><span class="sxs-lookup"><span data-stu-id="cbd18-252">(Each service that is supposed toosend data tooElasticsearch should reference Microsoft.Diagnostics.EventListeners and Microsoft.Diagnostics.EventListeners.Fabric).</span></span>
   
    ![Projekt odkazuje na tooMicrosoft.Diagnostics.EventListeners a Microsoft.Diagnostics.EventListeners.Fabric knihovny][1]

### <a name="service-fabric-general-availability-release-and-microsoftdiagnosticstracing-nuget-package"></a><span data-ttu-id="cbd18-254">Verze služby Fabric obecné dostupnosti a balíček Microsoft.Diagnostics.Tracing Nuget</span><span class="sxs-lookup"><span data-stu-id="cbd18-254">Service Fabric General Availability release and Microsoft.Diagnostics.Tracing Nuget package</span></span>
<span data-ttu-id="cbd18-255">Aplikace sestavené s verzí Service Fabric obecné dostupnosti (2.0.135 vydané 31. března 2016) cílové **rozhraní .NET Framework 4.5.2**.</span><span class="sxs-lookup"><span data-stu-id="cbd18-255">Applications built with Service Fabric General Availability release (2.0.135, released March 31, 2016) target **.NET Framework 4.5.2**.</span></span> <span data-ttu-id="cbd18-256">Tato verze je hello nejvyšší verzi hello nepodporuje v Azure v době hello hello GA verze rozhraní .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="cbd18-256">This version is hello highest version of hello .NET Framework supported by Azure at hello time of hello GA release.</span></span> <span data-ttu-id="cbd18-257">Tato verze hello framework bohužel chybí určité EventListener rozhraní API této hello Microsoft.Diagnostics.Listeners musí knihovny.</span><span class="sxs-lookup"><span data-stu-id="cbd18-257">Unfortunately, this version of hello framework lacks certain EventListener APIs that hello Microsoft.Diagnostics.Listeners library needs.</span></span> <span data-ttu-id="cbd18-258">Protože EventSource (hello komponenta, která základem hello protokolování rozhraní API v aplikacích prostředků infrastruktury) a EventListener jsou úzce spojeny, každý projekt, který používá hello Microsoft.Diagnostics.Listeners knihovny, musíte použít alternativní implementace EventSource.</span><span class="sxs-lookup"><span data-stu-id="cbd18-258">Because EventSource (hello component that forms hello basis of logging APIs in Fabric applications) and EventListener are tightly coupled, every project that uses hello Microsoft.Diagnostics.Listeners library must use an alternative implementation of EventSource.</span></span> <span data-ttu-id="cbd18-259">Tato implementace poskytuje hello **balíček Microsoft.Diagnostics.Tracing Nuget**, vytvořené společností Microsoft.</span><span class="sxs-lookup"><span data-stu-id="cbd18-259">This implementation is provided by hello **Microsoft.Diagnostics.Tracing Nuget package**, authored by Microsoft.</span></span> <span data-ttu-id="cbd18-260">balíček Hello je plně zpětně kompatibilní s EventSource součástí hello framework, takže beze změn kódu by měla být nutné než změny odkazované oboru názvů.</span><span class="sxs-lookup"><span data-stu-id="cbd18-260">hello package is fully backward-compatible with EventSource included in hello framework, so no code changes should be necessary other than referenced namespace changes.</span></span>

<span data-ttu-id="cbd18-261">toostart pomocí hello Microsoft.Diagnostics.Tracing implementace třídy hello EventSource, postupujte takto pro každý projekt služby, který potřebuje tooElasticsearch toosend dat:</span><span class="sxs-lookup"><span data-stu-id="cbd18-261">toostart using hello Microsoft.Diagnostics.Tracing implementation of hello EventSource class, follow these steps for each service project that needs toosend data tooElasticsearch:</span></span>

1. <span data-ttu-id="cbd18-262">Klikněte pravým tlačítkem na projekt služby hello a zvolte **spravovat balíčky Nuget**.</span><span class="sxs-lookup"><span data-stu-id="cbd18-262">Right-click on hello service project and choose **Manage Nuget Packages**.</span></span>
2. <span data-ttu-id="cbd18-263">Přepínač zdroje balíčku nuget.org toohello (Pokud již není vybrána) a vyhledejte "**Microsoft.Diagnostics.Tracing**".</span><span class="sxs-lookup"><span data-stu-id="cbd18-263">Switch toohello nuget.org package source (if it is not already selected) and search for "**Microsoft.Diagnostics.Tracing**".</span></span>
3. <span data-ttu-id="cbd18-264">Nainstalujte hello `Microsoft.Diagnostics.Tracing.EventSource` balíčku (a její závislosti).</span><span class="sxs-lookup"><span data-stu-id="cbd18-264">Install hello `Microsoft.Diagnostics.Tracing.EventSource` package (and its dependencies).</span></span>
4. <span data-ttu-id="cbd18-265">Otevřete hello **ServiceEventSource.cs** nebo **ActorEventSource.cs** souborů ve vašem projektu service a nahraďte hello `using System.Diagnostics.Tracing` direktivy nad hello soubor s hello `using Microsoft.Diagnostics.Tracing` – direktiva.</span><span class="sxs-lookup"><span data-stu-id="cbd18-265">Open hello **ServiceEventSource.cs** or **ActorEventSource.cs** file in your service project and replace hello `using System.Diagnostics.Tracing` directive on top of hello file with hello `using Microsoft.Diagnostics.Tracing` directive.</span></span>

<span data-ttu-id="cbd18-266">Tyto kroky nebude nutné jednou hello **rozhraní .NET Framework 4.6** podporuje Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="cbd18-266">These steps will not be necessary once hello **.NET Framework 4.6** is supported by Microsoft Azure.</span></span>

### <a name="elasticsearch-listener-instantiation-and-configuration"></a><span data-ttu-id="cbd18-267">Vytváření instancí Elasticsearch naslouchací proces a konfigurace</span><span class="sxs-lookup"><span data-stu-id="cbd18-267">Elasticsearch listener instantiation and configuration</span></span>
<span data-ttu-id="cbd18-268">Hello poslední krok pro odesílání diagnostických dat tooElasticsearch je toocreate instance `ElasticSearchListener` a nakonfigurujte ho s Elasticsearch data připojení.</span><span class="sxs-lookup"><span data-stu-id="cbd18-268">hello final step for sending diagnostic data tooElasticsearch is toocreate an instance of `ElasticSearchListener` and configure it with Elasticsearch connection data.</span></span> <span data-ttu-id="cbd18-269">naslouchací proces Hello automaticky zaznamená všechny události vyvolané prostřednictvím EventSource tříd definovaných v projektu služby hello.</span><span class="sxs-lookup"><span data-stu-id="cbd18-269">hello listener automatically captures all events raised via EventSource classes defined in hello service project.</span></span> <span data-ttu-id="cbd18-270">Potřebuje toobe zachování během doby života hello služby hello, takže hello nejlepší umístit toocreate, který je v kódu inicializace služby hello.</span><span class="sxs-lookup"><span data-stu-id="cbd18-270">It needs toobe alive during hello lifetime of hello service, so hello best place toocreate it is in hello service initialization code.</span></span> <span data-ttu-id="cbd18-271">Zde je, jak může vypadat hello inicializace kód pro bezstavové služby po hello potřebné změny (přidání zdůraznit v komentářích počínaje `****`):</span><span class="sxs-lookup"><span data-stu-id="cbd18-271">Here is how hello initialization code for a stateless service could look after hello necessary changes (additions pointed out in comments starting with `****`):</span></span>

```csharp
using System;
using System.Diagnostics;
using System.Fabric;
using System.Threading;
using System.Threading.Tasks;
using Microsoft.ServiceFabric.Services.Runtime;

// **** Add hello following directives
using Microsoft.Diagnostics.EventListeners;
using Microsoft.Diagnostics.EventListeners.Fabric;

namespace Stateless1
{
    internal static class Program
    {
        /// <summary>
        /// This is hello entry point of hello service host process.
        /// </summary>        
        private static void Main()
        {
            try
            {
                // **** Instantiate ElasticSearchListener
                var configProvider = new FabricConfigurationProvider("ElasticSearchEventListener");
                ElasticSearchListener esListener = null;
                if (configProvider.HasConfiguration)
                {
                    esListener = new ElasticSearchListener(configProvider, new FabricHealthReporter("ElasticSearchEventListener"));
                }

                // hello ServiceManifest.XML file defines one or more service type names.
                // Registering a service maps a service type name tooa .NET type.
                // When Service Fabric creates an instance of this service type,
                // an instance of hello class is created in this host process.

                ServiceRuntime.RegisterServiceAsync("Stateless1Type", 
                    context => new Stateless1(context)).GetAwaiter().GetResult();

                ServiceEventSource.Current.ServiceTypeRegistered(Process.GetCurrentProcess().Id, typeof(Stateless1).Name);

                // Prevents this host process from terminating so services keep running.
                Thread.Sleep(Timeout.Infinite);

                // **** Ensure that hello ElasticSearchListner instance is not garbage-collected prematurely
                GC.KeepAlive(esListener);
            }
            catch (Exception e)
            {
                ServiceEventSource.Current.ServiceHostInitializationFailed(e);
                throw;
            }
        }
    }
}
```

<span data-ttu-id="cbd18-272">Data připojení Elasticsearch by mělo být uvedeno v samostatném oddílu v konfiguračním souboru služby hello (**PackageRoot\Config\Settings.xml**).</span><span class="sxs-lookup"><span data-stu-id="cbd18-272">Elasticsearch connection data should be put in a separate section in hello service configuration file (**PackageRoot\Config\Settings.xml**).</span></span> <span data-ttu-id="cbd18-273">Hello název oddílu hello musí odpovídat toohello předaná hodnota toohello `FabricConfigurationProvider` konstruktoru, například:</span><span class="sxs-lookup"><span data-stu-id="cbd18-273">hello name of hello section must correspond toohello value passed toohello `FabricConfigurationProvider` constructor, for example:</span></span>

```xml
<Section Name="ElasticSearchEventListener">
  <Parameter Name="serviceUri" Value="http://myBigCluster.westus.cloudapp.azure.com/es/" />
  <Parameter Name="userName" Value="(ES user name)" />
  <Parameter Name="password" Value="(ES user password)" />
  <Parameter Name="indexNamePrefix" Value="myapp" />
</Section>
```
<span data-ttu-id="cbd18-274">Hello hodnoty `serviceUri`, `userName` a `password` parametry odpovídají adresa koncového bodu clusteru Elasticsearch toohello, Elasticsearch uživatelské jméno a heslo, v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="cbd18-274">hello values of `serviceUri`, `userName` and `password` parameters correspond toohello Elasticsearch cluster endpoint address, Elasticsearch user name, and password, respectively.</span></span> <span data-ttu-id="cbd18-275">`indexNamePrefix`hello předpona pro indexy Elasticsearch; Knihovna Microsoft.Diagnostics.Listeners Hello se vytvoří nový index pro svoje data každý den.</span><span class="sxs-lookup"><span data-stu-id="cbd18-275">`indexNamePrefix` is hello prefix for Elasticsearch indexes; hello Microsoft.Diagnostics.Listeners library creates a new index for its data daily.</span></span>

### <a name="verification"></a><span data-ttu-id="cbd18-276">Ověření</span><span class="sxs-lookup"><span data-stu-id="cbd18-276">Verification</span></span>
<span data-ttu-id="cbd18-277">A to je vše!</span><span class="sxs-lookup"><span data-stu-id="cbd18-277">That's it!</span></span> <span data-ttu-id="cbd18-278">Nyní vždy, když se spustí služba hello, spustí odesílání trasování toohello Elasticsearch služby zadaný v konfiguraci hello.</span><span class="sxs-lookup"><span data-stu-id="cbd18-278">Now, whenever hello service is run, it starts sending traces toohello Elasticsearch service specified in hello configuration.</span></span> <span data-ttu-id="cbd18-279">Můžete to ověřit pomocí uživatelského rozhraní Kibana přidruženého k instanci Elasticsearch cíl hello hello otevírání.</span><span class="sxs-lookup"><span data-stu-id="cbd18-279">You can verify this by opening hello Kibana UI associated with hello target Elasticsearch instance.</span></span> <span data-ttu-id="cbd18-280">V našem příkladu adresa stránku hello je http://myBigCluster.westus.cloudapp.azure.com/.</span><span class="sxs-lookup"><span data-stu-id="cbd18-280">In our example, hello page address is http://myBigCluster.westus.cloudapp.azure.com/.</span></span> <span data-ttu-id="cbd18-281">Zkontrolujte, zda indexy s předponou názvu hello zvolené pro hello `ElasticSearchListener` instance skutečně byly vytvořeny a naplněny s daty.</span><span class="sxs-lookup"><span data-stu-id="cbd18-281">Check that indexes with hello name prefix chosen for hello `ElasticSearchListener` instance have indeed been created and populated with data.</span></span>

![Zobrazuje Kibana PartyCluster aplikace události][2]

## <a name="next-steps"></a><span data-ttu-id="cbd18-283">Další kroky</span><span class="sxs-lookup"><span data-stu-id="cbd18-283">Next steps</span></span>
* [<span data-ttu-id="cbd18-284">Další informace o diagnostice a monitorování služby Service Fabric</span><span class="sxs-lookup"><span data-stu-id="cbd18-284">Learn more about diagnosing and monitoring a Service Fabric service</span></span>](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md)

<!--Image references-->
[1]: ./media/service-fabric-diagnostics-how-to-use-elasticsearch/listener-lib-references.png
[2]: ./media/service-fabric-diagnostics-how-to-use-elasticsearch/kibana.png
