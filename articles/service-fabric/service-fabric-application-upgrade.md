---
title: upgrade aplikace Fabric aaaService | Microsoft Docs
description: "Tento článek obsahuje úvod tooupgrading aplikace Service Fabric, včetně výběrem možnosti upgradu režimy a provádění kontroly stavu."
services: service-fabric
documentationcenter: .net
author: mani-ramaswamy
manager: timlt
editor: 
ms.assetid: 803c9c63-373a-4d6a-8ef2-ea97e16e88dd
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 8/9/2017
ms.author: subramar
ms.openlocfilehash: 6f649ef4a5c0afab682522bcba7d2d66a4268ead
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="service-fabric-application-upgrade"></a><span data-ttu-id="0c234-103">Upgrade aplikace Service Fabric</span><span class="sxs-lookup"><span data-stu-id="0c234-103">Service Fabric application upgrade</span></span>
<span data-ttu-id="0c234-104">Aplikace Azure Service Fabric je kolekce služeb.</span><span class="sxs-lookup"><span data-stu-id="0c234-104">An Azure Service Fabric application is a collection of services.</span></span> <span data-ttu-id="0c234-105">Během upgradu Service Fabric porovná hello nové [manifest aplikace](service-fabric-application-model.md#describe-an-application) s hello předchozí verze a určuje, které služby v aplikaci hello vyžadovat aktualizace.</span><span class="sxs-lookup"><span data-stu-id="0c234-105">During an upgrade, Service Fabric compares hello new [application manifest](service-fabric-application-model.md#describe-an-application) with hello previous version and determines which services in hello application require updates.</span></span> <span data-ttu-id="0c234-106">Service Fabric porovnává verze hello čísla ve službě hello manifesty s hello čísla verze v předchozí verzi hello.</span><span class="sxs-lookup"><span data-stu-id="0c234-106">Service Fabric compares hello version numbers in hello service manifests with hello version numbers in hello previous version.</span></span> <span data-ttu-id="0c234-107">Je-li služba se nezměnila, není aktualizován dané služby.</span><span class="sxs-lookup"><span data-stu-id="0c234-107">If a service has not changed, that service is not upgraded.</span></span>

## <a name="rolling-upgrades-overview"></a><span data-ttu-id="0c234-108">Vrácení upgradu – přehled</span><span class="sxs-lookup"><span data-stu-id="0c234-108">Rolling upgrades overview</span></span>
<span data-ttu-id="0c234-109">V postupného upgradu aplikace hello upgradu provádí ve fázích.</span><span class="sxs-lookup"><span data-stu-id="0c234-109">In a rolling application upgrade, hello upgrade is performed in stages.</span></span> <span data-ttu-id="0c234-110">V každé fázi je hello upgrade použité tooa dílčí sadu uzlů v clusteru hello, názvem domény služby aktualizace.</span><span class="sxs-lookup"><span data-stu-id="0c234-110">At each stage, hello upgrade is applied tooa subset of nodes in hello cluster, called an update domain.</span></span> <span data-ttu-id="0c234-111">V důsledku toho hello aplikace bude k dispozici v rámci upgradu hello.</span><span class="sxs-lookup"><span data-stu-id="0c234-111">As a result, hello application remains available throughout hello upgrade.</span></span> <span data-ttu-id="0c234-112">Během upgradu hello hello clusteru může obsahovat kombinaci hello staré a nové verze.</span><span class="sxs-lookup"><span data-stu-id="0c234-112">During hello upgrade, hello cluster may contain a mix of hello old and new versions.</span></span>

<span data-ttu-id="0c234-113">Z tohoto důvodu musí být hello dvě verze dopředného a zpětně kompatibilní.</span><span class="sxs-lookup"><span data-stu-id="0c234-113">For that reason, hello two versions must be forward and backward compatible.</span></span> <span data-ttu-id="0c234-114">Pokud nejsou kompatibilní, Správce aplikací hello je zodpovědná za pracovní více fází upgradu toomaintain dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="0c234-114">If they are not compatible, hello application administrator is responsible for staging a multiple-phase upgrade toomaintain availability.</span></span> <span data-ttu-id="0c234-115">V případě více fází upgradu je prvním krokem hello upgrade tooan zprostředkující verze hello aplikace, který je kompatibilní s hello předchozí verze.</span><span class="sxs-lookup"><span data-stu-id="0c234-115">In a multiple-phase upgrade, hello first step is upgrading tooan intermediate version of hello application that is compatible with hello previous version.</span></span> <span data-ttu-id="0c234-116">druhým krokem Hello je hello tooupgrade konečné se verzi, která dělí kompatibilitu s verzí hello před aktualizací, ale je kompatibilní s verzí zprostředkující hello.</span><span class="sxs-lookup"><span data-stu-id="0c234-116">hello second step is tooupgrade hello final version that breaks compatibility with hello pre-update version, but is compatible with hello intermediate version.</span></span>

<span data-ttu-id="0c234-117">Aktualizace domény jsou určené v manifestu clusteru hello, pokud konfigurujete hello cluster.</span><span class="sxs-lookup"><span data-stu-id="0c234-117">Update domains are specified in hello cluster manifest when you configure hello cluster.</span></span> <span data-ttu-id="0c234-118">Aktualizace domén neobdrží aktualizace v určitém pořadí.</span><span class="sxs-lookup"><span data-stu-id="0c234-118">Update domains do not receive updates in a particular order.</span></span> <span data-ttu-id="0c234-119">Doména aktualizace je logická jednotka nasazení pro aplikaci.</span><span class="sxs-lookup"><span data-stu-id="0c234-119">An update domain is a logical unit of deployment for an application.</span></span> <span data-ttu-id="0c234-120">Aktualizace domén povolit hello služby tooremain na vysokou dostupnost během upgradu.</span><span class="sxs-lookup"><span data-stu-id="0c234-120">Update domains allow hello services tooremain at high availability during an upgrade.</span></span>

<span data-ttu-id="0c234-121">Bez vrácení upgrady je možné, pokud je použité tooall uzly v clusteru hello, což je případ hello, pokud má jenom jednu aktualizační doménu aplikace hello hello upgrade.</span><span class="sxs-lookup"><span data-stu-id="0c234-121">Non-rolling upgrades are possible if hello upgrade is applied tooall nodes in hello cluster, which is hello case when hello application has only one update domain.</span></span> <span data-ttu-id="0c234-122">Tento přístup se nedoporučuje, protože služba hello přestane fungovat a není k dispozici v době hello upgradu.</span><span class="sxs-lookup"><span data-stu-id="0c234-122">This approach is not recommended, since hello service goes down and isn't available at hello time of upgrade.</span></span> <span data-ttu-id="0c234-123">Kromě toho Azure neposkytuje žádné záruky, při nastavení clusteru s doménou pouze jednu aktualizaci.</span><span class="sxs-lookup"><span data-stu-id="0c234-123">Additionally, Azure doesn't provide any guarantees when a cluster is set up with only one update domain.</span></span>

## <a name="health-checks-during-upgrades"></a><span data-ttu-id="0c234-124">Kontroly stavu během upgradu</span><span class="sxs-lookup"><span data-stu-id="0c234-124">Health checks during upgrades</span></span>
<span data-ttu-id="0c234-125">Pro účely upgradu mají zásady stavu toobe nastavit (nebo mohou být použity výchozí hodnoty).</span><span class="sxs-lookup"><span data-stu-id="0c234-125">For an upgrade, health policies have toobe set (or default values may be used).</span></span> <span data-ttu-id="0c234-126">Upgrade se říká úspěšné když jsou všechny aktualizace domény upgradován během hello zadané vypršení časových limitů, a když se všechny aktualizace domén se považují za v pořádku.</span><span class="sxs-lookup"><span data-stu-id="0c234-126">An upgrade is termed successful when all update domains are upgraded within hello specified time-outs, and when all update domains are deemed healthy.</span></span>  <span data-ttu-id="0c234-127">Domény v pořádku aktualizace znamená, že aktualizace domény hello předán všechny kontroly stavu hello určená v zásadách stavu hello.</span><span class="sxs-lookup"><span data-stu-id="0c234-127">A healthy update domain means that hello update domain passed all hello health checks specified in hello health policy.</span></span> <span data-ttu-id="0c234-128">Například může zásady stavu vyžádá, musí být všechny služby v rámci instance aplikace *pořádku*, jak je definováno stavu Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="0c234-128">For example, a health policy may mandate that all services within an application instance must be *healthy*, as health is defined by Service Fabric.</span></span>

<span data-ttu-id="0c234-129">Zásady stavu a kontroly během upgradu pomocí Service Fabric se bez ohledu na služby a aplikace.</span><span class="sxs-lookup"><span data-stu-id="0c234-129">Health policies and checks during upgrade by Service Fabric are service and application agnostic.</span></span> <span data-ttu-id="0c234-130">To znamená, že se provádějí žádné testy specifickou pro službu.</span><span class="sxs-lookup"><span data-stu-id="0c234-130">That is, no service-specific tests are done.</span></span>  <span data-ttu-id="0c234-131">Například služby může mít požadavek propustnost, ale Service Fabric nemá hello informace toocheck propustnost.</span><span class="sxs-lookup"><span data-stu-id="0c234-131">For example, your service might have a throughput requirement, but Service Fabric does not have hello information toocheck throughput.</span></span> <span data-ttu-id="0c234-132">Odkazovat toohello [stavu články](service-fabric-health-introduction.md) pro hello kontroly, které se provádí.</span><span class="sxs-lookup"><span data-stu-id="0c234-132">Refer toohello [health articles](service-fabric-health-introduction.md) for hello checks that are performed.</span></span> <span data-ttu-id="0c234-133">Hello kontroly, které dojít během upgradu zahrnout testy pro zda byl balíček aplikace hello zkopírován správně, zda byla spuštěna hello instance a tak dále.</span><span class="sxs-lookup"><span data-stu-id="0c234-133">hello checks that happen during an upgrade include tests for whether hello application package was copied correctly, whether hello instance was started, and so on.</span></span>

<span data-ttu-id="0c234-134">Stav aplikace Hello je agregaci hello podřízených entit aplikace hello.</span><span class="sxs-lookup"><span data-stu-id="0c234-134">hello application health is an aggregation of hello child entities of hello application.</span></span> <span data-ttu-id="0c234-135">Stručně řečeno Service Fabric vyhodnotí hello stav aplikace hello prostřednictvím hello stavu, který je hlášen na aplikace hello.</span><span class="sxs-lookup"><span data-stu-id="0c234-135">In short, Service Fabric evaluates hello health of hello application through hello health that is reported on hello application.</span></span> <span data-ttu-id="0c234-136">Také vyhodnocuje hello stavu všech hello služeb pro aplikace hello tímto způsobem.</span><span class="sxs-lookup"><span data-stu-id="0c234-136">It also evaluates hello health of all hello services for hello application this way.</span></span> <span data-ttu-id="0c234-137">Service Fabric další vyhodnotí hello stav služby aplikace hello agregování hello stav jejich podřízené položky, jako je například hello služby repliky.</span><span class="sxs-lookup"><span data-stu-id="0c234-137">Service Fabric further evaluates hello health of hello application services by aggregating hello health of their children, such as hello service replica.</span></span> <span data-ttu-id="0c234-138">Jakmile splňují zásady stavu aplikace hello hello upgradu pokračovat.</span><span class="sxs-lookup"><span data-stu-id="0c234-138">Once hello application health policy is satisfied, hello upgrade can proceed.</span></span> <span data-ttu-id="0c234-139">Pokud porušení zásady stavu hello upgradu aplikace hello se nezdaří.</span><span class="sxs-lookup"><span data-stu-id="0c234-139">If hello health policy is violated, hello application upgrade fails.</span></span>

## <a name="upgrade-modes"></a><span data-ttu-id="0c234-140">Upgrade režimy</span><span class="sxs-lookup"><span data-stu-id="0c234-140">Upgrade modes</span></span>
<span data-ttu-id="0c234-141">Hello režim, který doporučujeme pro upgradu aplikace je hello monitorovat režimu, který je režim hello běžně používá.</span><span class="sxs-lookup"><span data-stu-id="0c234-141">hello mode that we recommend for application upgrade is hello monitored mode, which is hello commonly used mode.</span></span> <span data-ttu-id="0c234-142">Monitorované režimu provede hello upgrade na jednu aktualizační doménu a pokud kontroluje všechny stavy průchodu (podle hello zadanou zásadu), se přesune na další aktualizaci domény toohello automaticky.</span><span class="sxs-lookup"><span data-stu-id="0c234-142">Monitored mode performs hello upgrade on one update domain, and if all health checks pass (per hello policy specified), moves on toohello next update domain automatically.</span></span>  <span data-ttu-id="0c234-143">Pokud selhání kontroly stavu a/nebo se dosáhne vypršení časových limitů, hello upgrade je pro doménu aktualizace hello buď vrácena nebo režim hello je změněné toounmonitored ručně.</span><span class="sxs-lookup"><span data-stu-id="0c234-143">If health checks fail and/or time-outs are reached, hello upgrade is either rolled back for hello update domain, or hello mode is changed toounmonitored manual.</span></span> <span data-ttu-id="0c234-144">Můžete nakonfigurovat hello upgradu toochoose jednu z těchto dvou režimů pro upgrade se nezdařilo.</span><span class="sxs-lookup"><span data-stu-id="0c234-144">You can configure hello upgrade toochoose one of those two modes for failed upgrades.</span></span> 

<span data-ttu-id="0c234-145">Sledována ruční režim musí po každé aktualizaci na doméně aktualizace, tookick vypnout hello upgradu na další aktualizaci domény hello ruční zásah.</span><span class="sxs-lookup"><span data-stu-id="0c234-145">Unmonitored manual mode needs manual intervention after every upgrade on an update domain, tookick off hello upgrade on hello next update domain.</span></span> <span data-ttu-id="0c234-146">Budou provedeny žádné kontroly stavu Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="0c234-146">No Service Fabric health checks are performed.</span></span> <span data-ttu-id="0c234-147">Správce Hello provádí hello stavu nebo stavu kontroly před zahájením upgradu hello v hello další aktualizaci domény.</span><span class="sxs-lookup"><span data-stu-id="0c234-147">hello administrator performs hello health or status checks before starting hello upgrade in hello next update domain.</span></span>

## <a name="upgrade-default-services"></a><span data-ttu-id="0c234-148">Upgradujte výchozí služby</span><span class="sxs-lookup"><span data-stu-id="0c234-148">Upgrade default services</span></span>
<span data-ttu-id="0c234-149">Během procesu upgradu hello aplikace lze upgradovat výchozích služeb v rámci aplikace Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="0c234-149">Default services within Service Fabric application can be upgraded during hello upgrade process of an application.</span></span> <span data-ttu-id="0c234-150">Výchozí služby jsou definovány v hello [manifest aplikace](service-fabric-application-model.md#describe-an-application).</span><span class="sxs-lookup"><span data-stu-id="0c234-150">Default services are defined in hello [application manifest](service-fabric-application-model.md#describe-an-application).</span></span> <span data-ttu-id="0c234-151">Standardní pravidla Hello upgradu výchozích služeb jsou:</span><span class="sxs-lookup"><span data-stu-id="0c234-151">hello standard rules of upgrading default services are:</span></span>

1. <span data-ttu-id="0c234-152">Výchozí služby v hello nové [manifest aplikace](service-fabric-application-model.md#describe-an-application) které neexistují v clusteru hello se vytvářejí.</span><span class="sxs-lookup"><span data-stu-id="0c234-152">Default services in hello new [application manifest](service-fabric-application-model.md#describe-an-application) that do not exist in hello cluster are created.</span></span>
> [!TIP]
> <span data-ttu-id="0c234-153">[EnableDefaultServicesUpgrade](service-fabric-cluster-fabric-settings.md#fabric-settings-that-you-can-customize) vyžaduje toobe nastavit hello tooenable tootrue následující pravidla.</span><span class="sxs-lookup"><span data-stu-id="0c234-153">[EnableDefaultServicesUpgrade](service-fabric-cluster-fabric-settings.md#fabric-settings-that-you-can-customize) needs toobe set tootrue tooenable hello following rules.</span></span> <span data-ttu-id="0c234-154">Tato funkce je podporovaná ze v5.5.</span><span class="sxs-lookup"><span data-stu-id="0c234-154">This feature is supported from v5.5.</span></span>

2. <span data-ttu-id="0c234-155">Výchozí služby existující v obou předchozích [manifest aplikace](service-fabric-application-model.md#describe-an-application) a jsou aktualizovány novou verzi.</span><span class="sxs-lookup"><span data-stu-id="0c234-155">Default services existing in both previous [application manifest](service-fabric-application-model.md#describe-an-application) and new version are updated.</span></span> <span data-ttu-id="0c234-156">Popis služby v nové verzi hello by přepsala těch, které již v clusteru hello.</span><span class="sxs-lookup"><span data-stu-id="0c234-156">Service descriptions in hello new version would overwrite those already in hello cluster.</span></span> <span data-ttu-id="0c234-157">Upgrade aplikace by vrácení zpět automaticky při aktualizaci selhání výchozí služby.</span><span class="sxs-lookup"><span data-stu-id="0c234-157">Application upgrade would rollback automatically upon updating default service failure.</span></span>
3. <span data-ttu-id="0c234-158">Výchozí služby v předchozí hello [manifest aplikace](service-fabric-application-model.md#describe-an-application) , ale ne v nové verzi hello se odstraní.</span><span class="sxs-lookup"><span data-stu-id="0c234-158">Default services in hello previous [application manifest](service-fabric-application-model.md#describe-an-application) but not in hello new version are deleted.</span></span> <span data-ttu-id="0c234-159">**Všimněte si, že tento odstraňování výchozích služeb nelze vrátit zpět.**</span><span class="sxs-lookup"><span data-stu-id="0c234-159">**Note that this deleting default services can not be reverted.**</span></span>

<span data-ttu-id="0c234-160">V případě, že aplikace je vrácena upgradu, výchozí služby se stav vrácený toohello před zahájením upgradu.</span><span class="sxs-lookup"><span data-stu-id="0c234-160">In case of an application upgrade is rolled back, default services are reverted toohello status before upgrade started.</span></span> <span data-ttu-id="0c234-161">Ale odstraněné služby nikdy možné vytvořit.</span><span class="sxs-lookup"><span data-stu-id="0c234-161">But deleted services can never be created.</span></span>

## <a name="application-upgrade-flowchart"></a><span data-ttu-id="0c234-162">Vývojový diagram upgradu aplikace</span><span class="sxs-lookup"><span data-stu-id="0c234-162">Application upgrade flowchart</span></span>
<span data-ttu-id="0c234-163">Vývojový diagram Hello níže vám může pomoct pochopit hello upgradu aplikace Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="0c234-163">hello flowchart following this paragraph can help you understand hello upgrade process of a Service Fabric application.</span></span> <span data-ttu-id="0c234-164">Konkrétně hello toku popisuje jak hello vypršení časových limitů, včetně *HealthCheckStableDuration*, *HealthCheckRetryTimeout*, a *UpgradeHealthCheckInterval*, pomáhá řídit při upgradu hello v jedné aktualizační doméně se považuje za úspěch nebo selhání.</span><span class="sxs-lookup"><span data-stu-id="0c234-164">In particular, hello flow describes how hello time-outs, including *HealthCheckStableDuration*, *HealthCheckRetryTimeout*, and *UpgradeHealthCheckInterval*, help control when hello upgrade in one update domain is considered a success or a failure.</span></span>

![Hello upgradu pro Fabric aplikaci služby][image]

## <a name="next-steps"></a><span data-ttu-id="0c234-166">Další kroky</span><span class="sxs-lookup"><span data-stu-id="0c234-166">Next steps</span></span>
<span data-ttu-id="0c234-167">[Upgrade vaší aplikace pomocí sady Visual Studio](service-fabric-application-upgrade-tutorial.md) vás provede upgrade aplikace pomocí sady Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0c234-167">[Upgrading your Application Using Visual Studio](service-fabric-application-upgrade-tutorial.md) walks you through an application upgrade using Visual Studio.</span></span>

<span data-ttu-id="0c234-168">[Upgrade vaší aplikace pomocí prostředí Powershell](service-fabric-application-upgrade-tutorial-powershell.md) vás provede upgrade aplikace pomocí prostředí PowerShell.</span><span class="sxs-lookup"><span data-stu-id="0c234-168">[Upgrading your Application Using Powershell](service-fabric-application-upgrade-tutorial-powershell.md) walks you through an application upgrade using PowerShell.</span></span>

<span data-ttu-id="0c234-169">Řídí, jak vaše aplikace upgraduje pomocí [Upgrade parametry](service-fabric-application-upgrade-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="0c234-169">Control how your application upgrades by using [Upgrade Parameters](service-fabric-application-upgrade-parameters.md).</span></span>

<span data-ttu-id="0c234-170">Aby aplikace upgradů kompatibilní metodou učení jak toouse [serializace dat](service-fabric-application-upgrade-data-serialization.md).</span><span class="sxs-lookup"><span data-stu-id="0c234-170">Make your application upgrades compatible by learning how toouse [Data Serialization](service-fabric-application-upgrade-data-serialization.md).</span></span>

<span data-ttu-id="0c234-171">Zjistěte, jak toouse pokročilé funkce při upgradu vaší aplikace tím, že odkazuje příliš[Pokročilá témata](service-fabric-application-upgrade-advanced.md).</span><span class="sxs-lookup"><span data-stu-id="0c234-171">Learn how toouse advanced functionality while upgrading your application by referring too[Advanced Topics](service-fabric-application-upgrade-advanced.md).</span></span>

<span data-ttu-id="0c234-172">Řešení běžných potíží v upgradů aplikací tím, že odkazuje toohello kroky v [řešení potíží s aplikací upgrady](service-fabric-application-upgrade-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="0c234-172">Fix common problems in application upgrades by referring toohello steps in [Troubleshooting Application Upgrades](service-fabric-application-upgrade-troubleshooting.md).</span></span>

[image]: media/service-fabric-application-upgrade/service-fabric-application-upgrade-flowchart.png
