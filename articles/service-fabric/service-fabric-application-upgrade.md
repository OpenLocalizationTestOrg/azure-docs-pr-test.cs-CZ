---
title: Upgrade aplikace Service Fabric | Microsoft Docs
description: "Tento článek obsahuje úvod do upgradu aplikace Service Fabric, včetně výběrem možnosti upgradu režimy a provádění kontroly stavu."
services: service-fabric
documentationcenter: .net
author: mani-ramaswamy
manager: timlt
editor: 
ms.assetid: 803c9c63-373a-4d6a-8ef2-ea97e16e88dd
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 8/9/2017
ms.author: subramar
ms.openlocfilehash: 4c2752bee8e9a859b23dbf47662d15798b551bb5
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/18/2017
---
# <a name="service-fabric-application-upgrade"></a><span data-ttu-id="e144c-103">Upgrade aplikace Service Fabric</span><span class="sxs-lookup"><span data-stu-id="e144c-103">Service Fabric application upgrade</span></span>
<span data-ttu-id="e144c-104">Aplikace Azure Service Fabric je kolekce služeb.</span><span class="sxs-lookup"><span data-stu-id="e144c-104">An Azure Service Fabric application is a collection of services.</span></span> <span data-ttu-id="e144c-105">Během upgradu, porovná Service Fabric nové [manifest aplikace](service-fabric-application-model.md#describe-an-application) v předchozí verzi a určuje, které služby v uzlu aktualizace vyžadovat aplikace.</span><span class="sxs-lookup"><span data-stu-id="e144c-105">During an upgrade, Service Fabric compares the new [application manifest](service-fabric-application-model.md#describe-an-application) with the previous version and determines which services in the application require updates.</span></span> <span data-ttu-id="e144c-106">Service Fabric porovnává verze čísla ve službě manifesty s čísla verze v předchozí verzi.</span><span class="sxs-lookup"><span data-stu-id="e144c-106">Service Fabric compares the version numbers in the service manifests with the version numbers in the previous version.</span></span> <span data-ttu-id="e144c-107">Je-li služba se nezměnila, není aktualizován dané služby.</span><span class="sxs-lookup"><span data-stu-id="e144c-107">If a service has not changed, that service is not upgraded.</span></span>

## <a name="rolling-upgrades-overview"></a><span data-ttu-id="e144c-108">Vrácení upgradu – přehled</span><span class="sxs-lookup"><span data-stu-id="e144c-108">Rolling upgrades overview</span></span>
<span data-ttu-id="e144c-109">V postupného upgradu aplikace upgradu provádí ve fázích.</span><span class="sxs-lookup"><span data-stu-id="e144c-109">In a rolling application upgrade, the upgrade is performed in stages.</span></span> <span data-ttu-id="e144c-110">V každé fázi upgradu použijí pro dílčí sadu uzlů v clusteru, názvem domény služby aktualizace.</span><span class="sxs-lookup"><span data-stu-id="e144c-110">At each stage, the upgrade is applied to a subset of nodes in the cluster, called an update domain.</span></span> <span data-ttu-id="e144c-111">V důsledku toho zůstává k dispozici v rámci upgradu aplikace.</span><span class="sxs-lookup"><span data-stu-id="e144c-111">As a result, the application remains available throughout the upgrade.</span></span> <span data-ttu-id="e144c-112">Během upgradu clusteru může obsahovat kombinací staré a nové verze.</span><span class="sxs-lookup"><span data-stu-id="e144c-112">During the upgrade, the cluster may contain a mix of the old and new versions.</span></span>

<span data-ttu-id="e144c-113">Z tohoto důvodu musí být dvě verze dopředného a zpětně kompatibilní.</span><span class="sxs-lookup"><span data-stu-id="e144c-113">For that reason, the two versions must be forward and backward compatible.</span></span> <span data-ttu-id="e144c-114">Pokud nejsou kompatibilní, Správce aplikací je zodpovědná za pracovní více fází upgradu údržbu dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="e144c-114">If they are not compatible, the application administrator is responsible for staging a multiple-phase upgrade to maintain availability.</span></span> <span data-ttu-id="e144c-115">V případě více fází upgradu prvním krokem je upgrade zprostředkující verzi aplikace, která je kompatibilní s předchozí verzí.</span><span class="sxs-lookup"><span data-stu-id="e144c-115">In a multiple-phase upgrade, the first step is upgrading to an intermediate version of the application that is compatible with the previous version.</span></span> <span data-ttu-id="e144c-116">Druhým krokem je upgrade finální verzi, která dělí kompatibilitu s verzí před aktualizací, ale je kompatibilní s verzí zprostředkující.</span><span class="sxs-lookup"><span data-stu-id="e144c-116">The second step is to upgrade the final version that breaks compatibility with the pre-update version, but is compatible with the intermediate version.</span></span>

<span data-ttu-id="e144c-117">Aktualizace domény jsou určené v manifestu clusteru při konfiguraci clusteru.</span><span class="sxs-lookup"><span data-stu-id="e144c-117">Update domains are specified in the cluster manifest when you configure the cluster.</span></span> <span data-ttu-id="e144c-118">Aktualizace domén neobdrží aktualizace v určitém pořadí.</span><span class="sxs-lookup"><span data-stu-id="e144c-118">Update domains do not receive updates in a particular order.</span></span> <span data-ttu-id="e144c-119">Doména aktualizace je logická jednotka nasazení pro aplikaci.</span><span class="sxs-lookup"><span data-stu-id="e144c-119">An update domain is a logical unit of deployment for an application.</span></span> <span data-ttu-id="e144c-120">Aktualizace domén povolit služby, aby zůstaly během upgradu na vysokou dostupnost.</span><span class="sxs-lookup"><span data-stu-id="e144c-120">Update domains allow the services to remain at high availability during an upgrade.</span></span>

<span data-ttu-id="e144c-121">Bez vrácení upgrady je možné, pokud je na všech uzlech v clusteru, což je případ, kdy aplikace má pouze jednu aktualizační doménu upgradu.</span><span class="sxs-lookup"><span data-stu-id="e144c-121">Non-rolling upgrades are possible if the upgrade is applied to all nodes in the cluster, which is the case when the application has only one update domain.</span></span> <span data-ttu-id="e144c-122">Tento přístup se nedoporučuje, protože služba přestane fungovat a není k dispozici při upgradu.</span><span class="sxs-lookup"><span data-stu-id="e144c-122">This approach is not recommended, since the service goes down and isn't available at the time of upgrade.</span></span> <span data-ttu-id="e144c-123">Kromě toho Azure neposkytuje žádné záruky, při nastavení clusteru s doménou pouze jednu aktualizaci.</span><span class="sxs-lookup"><span data-stu-id="e144c-123">Additionally, Azure doesn't provide any guarantees when a cluster is set up with only one update domain.</span></span>

## <a name="health-checks-during-upgrades"></a><span data-ttu-id="e144c-124">Kontroly stavu během upgradu</span><span class="sxs-lookup"><span data-stu-id="e144c-124">Health checks during upgrades</span></span>
<span data-ttu-id="e144c-125">Pro upgrade musí být nastaveny zásady stavu (nebo mohou být použity výchozí hodnoty).</span><span class="sxs-lookup"><span data-stu-id="e144c-125">For an upgrade, health policies have to be set (or default values may be used).</span></span> <span data-ttu-id="e144c-126">Upgrade se říká úspěšné, pokud jsou všechny aktualizace domény upgradován během zadaného vypršení časových limitů a pokud všechny domény aktualizace se považují za v pořádku.</span><span class="sxs-lookup"><span data-stu-id="e144c-126">An upgrade is termed successful when all update domains are upgraded within the specified time-outs, and when all update domains are deemed healthy.</span></span>  <span data-ttu-id="e144c-127">Domény v pořádku aktualizace znamená, že aktualizace domény předány všechny kontroly stavu určená v zásadách stavu.</span><span class="sxs-lookup"><span data-stu-id="e144c-127">A healthy update domain means that the update domain passed all the health checks specified in the health policy.</span></span> <span data-ttu-id="e144c-128">Například může zásady stavu vyžádá, musí být všechny služby v rámci instance aplikace *pořádku*, jak je definováno stavu Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="e144c-128">For example, a health policy may mandate that all services within an application instance must be *healthy*, as health is defined by Service Fabric.</span></span>

<span data-ttu-id="e144c-129">Zásady stavu a kontroly během upgradu pomocí Service Fabric se bez ohledu na služby a aplikace.</span><span class="sxs-lookup"><span data-stu-id="e144c-129">Health policies and checks during upgrade by Service Fabric are service and application agnostic.</span></span> <span data-ttu-id="e144c-130">To znamená, že se provádějí žádné testy specifickou pro službu.</span><span class="sxs-lookup"><span data-stu-id="e144c-130">That is, no service-specific tests are done.</span></span>  <span data-ttu-id="e144c-131">Například služby může mít požadavek propustnost, ale Service Fabric nemá informace ke kontrole propustnost.</span><span class="sxs-lookup"><span data-stu-id="e144c-131">For example, your service might have a throughput requirement, but Service Fabric does not have the information to check throughput.</span></span> <span data-ttu-id="e144c-132">Odkazovat [stavu články](service-fabric-health-introduction.md) pro kontroly, které se provádí.</span><span class="sxs-lookup"><span data-stu-id="e144c-132">Refer to the [health articles](service-fabric-health-introduction.md) for the checks that are performed.</span></span> <span data-ttu-id="e144c-133">Kontroly, které dojít během upgradu zahrnout testy pro jestli byl balíček aplikace správně zkopírován, zda byla spuštěna instance a tak dále.</span><span class="sxs-lookup"><span data-stu-id="e144c-133">The checks that happen during an upgrade include tests for whether the application package was copied correctly, whether the instance was started, and so on.</span></span>

<span data-ttu-id="e144c-134">Stav aplikace je agregaci podřízených entit aplikace.</span><span class="sxs-lookup"><span data-stu-id="e144c-134">The application health is an aggregation of the child entities of the application.</span></span> <span data-ttu-id="e144c-135">Stručně řečeno Service Fabric vyhodnocuje stav aplikace prostřednictvím stavu, který je hlášen na aplikaci.</span><span class="sxs-lookup"><span data-stu-id="e144c-135">In short, Service Fabric evaluates the health of the application through the health that is reported on the application.</span></span> <span data-ttu-id="e144c-136">Také vyhodnocuje stav všech služeb pro aplikace tímto způsobem.</span><span class="sxs-lookup"><span data-stu-id="e144c-136">It also evaluates the health of all the services for the application this way.</span></span> <span data-ttu-id="e144c-137">Service Fabric další vyhodnocuje stav aplikačních služeb agregací stav jejich podřízené položky, jako je například služba repliky.</span><span class="sxs-lookup"><span data-stu-id="e144c-137">Service Fabric further evaluates the health of the application services by aggregating the health of their children, such as the service replica.</span></span> <span data-ttu-id="e144c-138">Po splňují zásady stavu aplikace, můžete pokračovat v upgradu.</span><span class="sxs-lookup"><span data-stu-id="e144c-138">Once the application health policy is satisfied, the upgrade can proceed.</span></span> <span data-ttu-id="e144c-139">Pokud je porušení zásad stavu, upgradu aplikace se nezdaří.</span><span class="sxs-lookup"><span data-stu-id="e144c-139">If the health policy is violated, the application upgrade fails.</span></span>

## <a name="upgrade-modes"></a><span data-ttu-id="e144c-140">Upgrade režimy</span><span class="sxs-lookup"><span data-stu-id="e144c-140">Upgrade modes</span></span>
<span data-ttu-id="e144c-141">Režim, který doporučujeme pro upgradu aplikace je monitorovaných režimu, který je běžně používané režimem.</span><span class="sxs-lookup"><span data-stu-id="e144c-141">The mode that we recommend for application upgrade is the monitored mode, which is the commonly used mode.</span></span> <span data-ttu-id="e144c-142">Monitorovaných režimu provede upgrade na jednu aktualizační doménu a pokud kontroluje všechny stavy průchodu (podle zásad určených), přejde k další domény aktualizace automaticky.</span><span class="sxs-lookup"><span data-stu-id="e144c-142">Monitored mode performs the upgrade on one update domain, and if all health checks pass (per the policy specified), moves on to the next update domain automatically.</span></span>  <span data-ttu-id="e144c-143">Pokud selhání kontroly stavu a/nebo se dosáhne vypršení časových limitů, upgrade je pro doménu aktualizace buď vrácena nebo režim se změní na není sledována ručně.</span><span class="sxs-lookup"><span data-stu-id="e144c-143">If health checks fail and/or time-outs are reached, the upgrade is either rolled back for the update domain, or the mode is changed to unmonitored manual.</span></span> <span data-ttu-id="e144c-144">Můžete nakonfigurovat upgrade na vyberte jednu z těchto dvou režimů pro upgrade se nezdařilo.</span><span class="sxs-lookup"><span data-stu-id="e144c-144">You can configure the upgrade to choose one of those two modes for failed upgrades.</span></span> 

<span data-ttu-id="e144c-145">Sledována ruční režim musí ruční zásah po každém upgradu v doméně služby aktualizace, chcete-li ji upgradu na další aktualizaci domény.</span><span class="sxs-lookup"><span data-stu-id="e144c-145">Unmonitored manual mode needs manual intervention after every upgrade on an update domain, to kick off the upgrade on the next update domain.</span></span> <span data-ttu-id="e144c-146">Budou provedeny žádné kontroly stavu Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="e144c-146">No Service Fabric health checks are performed.</span></span> <span data-ttu-id="e144c-147">Správce provádí kontroly stavu nebo stavu před spuštěním upgradu v další aktualizaci domény.</span><span class="sxs-lookup"><span data-stu-id="e144c-147">The administrator performs the health or status checks before starting the upgrade in the next update domain.</span></span>

## <a name="upgrade-default-services"></a><span data-ttu-id="e144c-148">Upgradujte výchozí služby</span><span class="sxs-lookup"><span data-stu-id="e144c-148">Upgrade default services</span></span>
<span data-ttu-id="e144c-149">Během procesu upgradu aplikace lze upgradovat výchozích služeb v rámci aplikace Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="e144c-149">Default services within Service Fabric application can be upgraded during the upgrade process of an application.</span></span> <span data-ttu-id="e144c-150">Výchozí služby jsou definovány v [manifest aplikace](service-fabric-application-model.md#describe-an-application).</span><span class="sxs-lookup"><span data-stu-id="e144c-150">Default services are defined in the [application manifest](service-fabric-application-model.md#describe-an-application).</span></span> <span data-ttu-id="e144c-151">Standardní pravidla upgradu výchozích služeb jsou:</span><span class="sxs-lookup"><span data-stu-id="e144c-151">The standard rules of upgrading default services are:</span></span>

1. <span data-ttu-id="e144c-152">Výchozí služby v novém [manifest aplikace](service-fabric-application-model.md#describe-an-application) které neexistují v clusteru se vytvářejí.</span><span class="sxs-lookup"><span data-stu-id="e144c-152">Default services in the new [application manifest](service-fabric-application-model.md#describe-an-application) that do not exist in the cluster are created.</span></span>
> [!TIP]
> <span data-ttu-id="e144c-153">[EnableDefaultServicesUpgrade](service-fabric-cluster-fabric-settings.md#fabric-settings-that-you-can-customize) musí být nastavena na hodnotu true, chcete-li povolit následující pravidla.</span><span class="sxs-lookup"><span data-stu-id="e144c-153">[EnableDefaultServicesUpgrade](service-fabric-cluster-fabric-settings.md#fabric-settings-that-you-can-customize) needs to be set to true to enable the following rules.</span></span> <span data-ttu-id="e144c-154">Tato funkce je podporovaná ze v5.5.</span><span class="sxs-lookup"><span data-stu-id="e144c-154">This feature is supported from v5.5.</span></span>

2. <span data-ttu-id="e144c-155">Výchozí služby existující v obou předchozích [manifest aplikace](service-fabric-application-model.md#describe-an-application) a jsou aktualizovány novou verzi.</span><span class="sxs-lookup"><span data-stu-id="e144c-155">Default services existing in both previous [application manifest](service-fabric-application-model.md#describe-an-application) and new version are updated.</span></span> <span data-ttu-id="e144c-156">Popis služby v nové verzi by přepsala těch, které již v clusteru.</span><span class="sxs-lookup"><span data-stu-id="e144c-156">Service descriptions in the new version would overwrite those already in the cluster.</span></span> <span data-ttu-id="e144c-157">Upgrade aplikace by vrácení zpět automaticky při aktualizaci selhání výchozí služby.</span><span class="sxs-lookup"><span data-stu-id="e144c-157">Application upgrade would rollback automatically upon updating default service failure.</span></span>
3. <span data-ttu-id="e144c-158">Výchozí služby v předchozím [manifest aplikace](service-fabric-application-model.md#describe-an-application) , ale ne v nové verzi jsou odstraněny.</span><span class="sxs-lookup"><span data-stu-id="e144c-158">Default services in the previous [application manifest](service-fabric-application-model.md#describe-an-application) but not in the new version are deleted.</span></span> <span data-ttu-id="e144c-159">**Všimněte si, že tento odstraňování výchozích služeb nelze vrátit zpět.**</span><span class="sxs-lookup"><span data-stu-id="e144c-159">**Note that this deleting default services can not be reverted.**</span></span>

<span data-ttu-id="e144c-160">V případě aplikace upgradu se vrátí zpátky, výchozí služby se vrátit zpět na stav, před zahájením upgradu.</span><span class="sxs-lookup"><span data-stu-id="e144c-160">In case of an application upgrade is rolled back, default services are reverted to the status before upgrade started.</span></span> <span data-ttu-id="e144c-161">Ale odstraněné služby nikdy možné vytvořit.</span><span class="sxs-lookup"><span data-stu-id="e144c-161">But deleted services can never be created.</span></span>

## <a name="application-upgrade-flowchart"></a><span data-ttu-id="e144c-162">Vývojový diagram upgradu aplikace</span><span class="sxs-lookup"><span data-stu-id="e144c-162">Application upgrade flowchart</span></span>
<span data-ttu-id="e144c-163">Vývojový diagram níže vám může pomoct pochopit proces upgradu aplikace Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="e144c-163">The flowchart following this paragraph can help you understand the upgrade process of a Service Fabric application.</span></span> <span data-ttu-id="e144c-164">Konkrétně toku popisuje jak vypršení časových limitů, včetně *HealthCheckStableDuration*, *HealthCheckRetryTimeout*, a *UpgradeHealthCheckInterval*, pomůže ovládací prvek při upgradu v jedné aktualizační doméně se považuje za úspěch nebo selhání.</span><span class="sxs-lookup"><span data-stu-id="e144c-164">In particular, the flow describes how the time-outs, including *HealthCheckStableDuration*, *HealthCheckRetryTimeout*, and *UpgradeHealthCheckInterval*, help control when the upgrade in one update domain is considered a success or a failure.</span></span>

![Proces upgradu pro Fabric aplikaci služby][image]

## <a name="next-steps"></a><span data-ttu-id="e144c-166">Další kroky</span><span class="sxs-lookup"><span data-stu-id="e144c-166">Next steps</span></span>
<span data-ttu-id="e144c-167">[Upgrade vaší aplikace pomocí sady Visual Studio](service-fabric-application-upgrade-tutorial.md) vás provede upgrade aplikace pomocí sady Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e144c-167">[Upgrading your Application Using Visual Studio](service-fabric-application-upgrade-tutorial.md) walks you through an application upgrade using Visual Studio.</span></span>

<span data-ttu-id="e144c-168">[Upgrade vaší aplikace pomocí prostředí Powershell](service-fabric-application-upgrade-tutorial-powershell.md) vás provede upgrade aplikace pomocí prostředí PowerShell.</span><span class="sxs-lookup"><span data-stu-id="e144c-168">[Upgrading your Application Using Powershell](service-fabric-application-upgrade-tutorial-powershell.md) walks you through an application upgrade using PowerShell.</span></span>

<span data-ttu-id="e144c-169">Řídí, jak vaše aplikace upgraduje pomocí [Upgrade parametry](service-fabric-application-upgrade-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="e144c-169">Control how your application upgrades by using [Upgrade Parameters](service-fabric-application-upgrade-parameters.md).</span></span>

<span data-ttu-id="e144c-170">Zkontrolujte upgradů aplikace kompatibilní podle naučit se používat [serializace dat](service-fabric-application-upgrade-data-serialization.md).</span><span class="sxs-lookup"><span data-stu-id="e144c-170">Make your application upgrades compatible by learning how to use [Data Serialization](service-fabric-application-upgrade-data-serialization.md).</span></span>

<span data-ttu-id="e144c-171">Další informace o použití pokročilých funkcí při upgradu vaší aplikace tím, že odkazuje na [Pokročilá témata](service-fabric-application-upgrade-advanced.md).</span><span class="sxs-lookup"><span data-stu-id="e144c-171">Learn how to use advanced functionality while upgrading your application by referring to [Advanced Topics](service-fabric-application-upgrade-advanced.md).</span></span>

<span data-ttu-id="e144c-172">Řešení běžných potíží v upgradů aplikací podle kroků v části [řešení potíží s aplikací upgrady](service-fabric-application-upgrade-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="e144c-172">Fix common problems in application upgrades by referring to the steps in [Troubleshooting Application Upgrades](service-fabric-application-upgrade-troubleshooting.md).</span></span>

[image]: media/service-fabric-application-upgrade/service-fabric-application-upgrade-flowchart.png
