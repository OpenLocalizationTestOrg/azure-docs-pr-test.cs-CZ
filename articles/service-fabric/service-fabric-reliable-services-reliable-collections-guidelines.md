---
title: "aaaGuidelines & doporučení pro spolehlivé kolekce v Azure Service Fabric | Microsoft Docs"
description: "Pokyny a doporučení pro používání služby Fabric spolehlivé kolekce"
services: service-fabric
documentationcenter: .net
author: mcoskun
manager: timlt
editor: masnider,rajak
ms.assetid: 62857523-604b-434e-bd1c-2141ea4b00d1
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: required
ms.date: 5/3/2017
ms.author: mcoskun
ms.openlocfilehash: bcdbc9d013bc044e06c43761e7f515c7e4bf340c
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="guidelines-and-recommendations-for-reliable-collections-in-azure-service-fabric"></a><span data-ttu-id="becc2-103">Pokyny a doporučení pro spolehlivé kolekce v Azure Service Fabric</span><span class="sxs-lookup"><span data-stu-id="becc2-103">Guidelines and recommendations for Reliable Collections in Azure Service Fabric</span></span>
<span data-ttu-id="becc2-104">Tato část obsahuje pokyny pro použití spolehlivé správce stavu a spolehlivé kolekce.</span><span class="sxs-lookup"><span data-stu-id="becc2-104">This section provides guidelines for using Reliable State Manager and Reliable Collections.</span></span> <span data-ttu-id="becc2-105">Hello cílem je, že uživatelé toohelp vyhnout běžné nástrahy.</span><span class="sxs-lookup"><span data-stu-id="becc2-105">hello goal is toohelp users avoid common pitfalls.</span></span>

<span data-ttu-id="becc2-106">Hello pokyny jsou uspořádána jako jednoduchý doporučení předponu hello podmínky *provést*, *zvažte*, *nepoužívejte* a *nepodporují*.</span><span class="sxs-lookup"><span data-stu-id="becc2-106">hello guidelines are organized as simple recommendations prefixed with hello terms *Do*, *Consider*, *Avoid* and *Do not*.</span></span>

* <span data-ttu-id="becc2-107">Nelze změnit objekt typu vlastní vrácené operací čtení (například `TryPeekAsync` nebo `TryGetValueAsync`).</span><span class="sxs-lookup"><span data-stu-id="becc2-107">Do not modify an object of custom type returned by read operations (for example, `TryPeekAsync` or `TryGetValueAsync`).</span></span> <span data-ttu-id="becc2-108">Spolehlivé kolekcí, stejně jako souběžných kolekcí, vrátí referenční toohello objekty a nelze zkopírovat.</span><span class="sxs-lookup"><span data-stu-id="becc2-108">Reliable Collections, just like Concurrent Collections, return a reference toohello objects and not a copy.</span></span>
* <span data-ttu-id="becc2-109">Provést hloubkové kopie hello vrátil objekt typu vlastní před změnou ho.</span><span class="sxs-lookup"><span data-stu-id="becc2-109">Do deep copy hello returned object of a custom type before modifying it.</span></span> <span data-ttu-id="becc2-110">Vzhledem k tomu, že struktury a vestavěné typy jsou průchodu hodnotu, není nutné toodo kopii hloubkové na ně.</span><span class="sxs-lookup"><span data-stu-id="becc2-110">Since structs and built-in types are pass-by-value, you do not need toodo a deep copy on them.</span></span>
* <span data-ttu-id="becc2-111">Nepoužívejte `TimeSpan.MaxValue` časových limitů.</span><span class="sxs-lookup"><span data-stu-id="becc2-111">Do not use `TimeSpan.MaxValue` for time-outs.</span></span> <span data-ttu-id="becc2-112">Vypršení časových limitů by měl být použité toodetect zablokování.</span><span class="sxs-lookup"><span data-stu-id="becc2-112">Time-outs should be used toodetect deadlocks.</span></span>
* <span data-ttu-id="becc2-113">Nepoužívejte transakce po bylo potvrzeno, byl zrušen nebo zlikvidován.</span><span class="sxs-lookup"><span data-stu-id="becc2-113">Do not use a transaction after it has been committed, aborted, or disposed.</span></span>
* <span data-ttu-id="becc2-114">Nepoužívejte výčet mimo obor hello transakce, který byl vytvořen v.</span><span class="sxs-lookup"><span data-stu-id="becc2-114">Do not use an enumeration outside of hello transaction scope it was created in.</span></span>
* <span data-ttu-id="becc2-115">Nevytvářejte transakce v rámci jiné transakci `using` příkaz vzhledem k tomu může dojít k zablokování.</span><span class="sxs-lookup"><span data-stu-id="becc2-115">Do not create a transaction within another transaction’s `using` statement because it can cause deadlocks.</span></span>
* <span data-ttu-id="becc2-116">Ujistěte se, že vaše `IComparable<TKey>` implementace je správný.</span><span class="sxs-lookup"><span data-stu-id="becc2-116">Do ensure that your `IComparable<TKey>` implementation is correct.</span></span> <span data-ttu-id="becc2-117">Hello systém označí závislost `IComparable<TKey>` ke sloučení kontrolních bodů a řádky.</span><span class="sxs-lookup"><span data-stu-id="becc2-117">hello system takes dependency on `IComparable<TKey>` for merging checkpoints and rows.</span></span>
* <span data-ttu-id="becc2-118">Použití aktualizační zámek při čtení položku se tooupdate záměr ho tooprevent třídu zablokování.</span><span class="sxs-lookup"><span data-stu-id="becc2-118">Do use Update lock when reading an item with an intention tooupdate it tooprevent a certain class of deadlocks.</span></span>
* <span data-ttu-id="becc2-119">Zvažte zachování položek (například TKey + TValue pro spolehlivé slovník) nižší než 80 kB: menší hello lepší.</span><span class="sxs-lookup"><span data-stu-id="becc2-119">Consider keeping your items (for example, TKey + TValue for Reliable Dictionary) below 80 KBytes: smaller hello better.</span></span> <span data-ttu-id="becc2-120">Tím se snižuje množství hello velkého objektu haldy využití a také diskových a síťových vstupně-VÝSTUPNÍMI požadavky.</span><span class="sxs-lookup"><span data-stu-id="becc2-120">This reduces hello amount of Large Object Heap usage as well as disk and network IO requirements.</span></span> <span data-ttu-id="becc2-121">Často snižuje replikace duplicitních dat, je-li aktualizován pouze jeden malou část hodnoty hello.</span><span class="sxs-lookup"><span data-stu-id="becc2-121">Often, it reduces replicating duplicate data when only one small part of hello value is being updated.</span></span> <span data-ttu-id="becc2-122">Běžné tooachieve způsob, jak to spolehlivé slovník je toobreak vaší řádků v toomultiple řádků.</span><span class="sxs-lookup"><span data-stu-id="becc2-122">Common way tooachieve this in Reliable Dictionary, is toobreak your rows in toomultiple rows.</span></span>
* <span data-ttu-id="becc2-123">Zvažte použití zálohování a obnovení po havárii toohave funkce.</span><span class="sxs-lookup"><span data-stu-id="becc2-123">Consider using backup and restore functionality toohave disaster recovery.</span></span>
* <span data-ttu-id="becc2-124">Vyhněte se kombinování jedné entity operací a operací s více entit (např `GetCountAsync`, `CreateEnumerableAsync`) v hello stejné transakci kvůli toohello izolace různé úrovně.</span><span class="sxs-lookup"><span data-stu-id="becc2-124">Avoid mixing single entity operations and multi-entity operations (e.g `GetCountAsync`, `CreateEnumerableAsync`) in hello same transaction due toohello different isolation levels.</span></span>
* <span data-ttu-id="becc2-125">Zpracování výjimkou InvalidOperationException.</span><span class="sxs-lookup"><span data-stu-id="becc2-125">Do handle InvalidOperationException.</span></span> <span data-ttu-id="becc2-126">Uživatelské transakce může být přerušil hello systému různých důvodů.</span><span class="sxs-lookup"><span data-stu-id="becc2-126">User transactions can be aborted by hello system for variety of reasons.</span></span> <span data-ttu-id="becc2-127">Například když hello spolehlivé správce stavu mění jeho roli z primární nebo když dlouhotrvající transakci blokuje zkrácení protokolu transakcí hello.</span><span class="sxs-lookup"><span data-stu-id="becc2-127">For example, when hello Reliable State Manager is changing its role out of Primary or when a long-running transaction is blocking truncation of hello transactional log.</span></span> <span data-ttu-id="becc2-128">V takových případech uživatel obdržet InvalidOperationException, která určuje, že jejich transakce již byla ukončena.</span><span class="sxs-lookup"><span data-stu-id="becc2-128">In such cases, user may receive InvalidOperationException indicating that their transaction has already been terminated.</span></span> <span data-ttu-id="becc2-129">Za předpokladu, hello ukončení transakce hello nebyl požadován uživatelem hello, nejlepší způsob, jak toohandle tuto výjimku je toodispose hello transakce, zkontrolujte, jestli nesignalizuje token zrušení hello (nebo se změnily hello role repliky hello) a pokud ne Vytvořte novou transakci a zkuste to znovu.</span><span class="sxs-lookup"><span data-stu-id="becc2-129">Assuming, hello termination of hello transaction was not requested by hello user, best way toohandle this exception is toodispose hello transaction, check if hello cancellation token has been signaled (or hello role of hello replica has been changed), and if not create a new transaction and retry.</span></span>  

<span data-ttu-id="becc2-130">Zde jsou některé věci tookeep nezapomeňte:</span><span class="sxs-lookup"><span data-stu-id="becc2-130">Here are some things tookeep in mind:</span></span>

* <span data-ttu-id="becc2-131">Výchozí časový limit Hello je čtyři sekund pro všechny hello spolehlivé kolekce rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="becc2-131">hello default time-out is four seconds for all hello Reliable Collection APIs.</span></span> <span data-ttu-id="becc2-132">Většina uživatelů měli používat hello výchozí časový limit.</span><span class="sxs-lookup"><span data-stu-id="becc2-132">Most users should use hello default time-out.</span></span>
* <span data-ttu-id="becc2-133">je technologie Hello výchozí token zrušení `CancellationToken.None` v všechna rozhraní API spolehlivé kolekce.</span><span class="sxs-lookup"><span data-stu-id="becc2-133">hello default cancellation token is `CancellationToken.None` in all Reliable Collections APIs.</span></span>
* <span data-ttu-id="becc2-134">Typ klíče parametr Hello (*TKey*) pro slovník spolehlivé musí správně implementovat `GetHashCode()` a `Equals()`.</span><span class="sxs-lookup"><span data-stu-id="becc2-134">hello key type parameter (*TKey*) for a Reliable Dictionary must correctly implement `GetHashCode()` and `Equals()`.</span></span> <span data-ttu-id="becc2-135">Klíče musí být neměnitelný.</span><span class="sxs-lookup"><span data-stu-id="becc2-135">Keys must be immutable.</span></span>
* <span data-ttu-id="becc2-136">tooachieve vysoká dostupnost pro hello spolehlivé kolekcí, každá služba musí mít alespoň cíl a minimální repliky nastavit velikost 3.</span><span class="sxs-lookup"><span data-stu-id="becc2-136">tooachieve high availability for hello Reliable Collections, each service should have at least a target and minimum replica set size of 3.</span></span>
* <span data-ttu-id="becc2-137">Operace čtení na hello sekundární lze číst verze, které nejsou kvora potvrzené.</span><span class="sxs-lookup"><span data-stu-id="becc2-137">Read operations on hello secondary may read versions that are not quorum committed.</span></span>
  <span data-ttu-id="becc2-138">To znamená, že může být verzi data, která je pro čtení z jedné sekundární false zvýšily.</span><span class="sxs-lookup"><span data-stu-id="becc2-138">This means that a version of data that is read from a single secondary might be false progressed.</span></span>
  <span data-ttu-id="becc2-139">Čtení z primární jsou vždycky stabilní: můžete nikdy být false zvýšily.</span><span class="sxs-lookup"><span data-stu-id="becc2-139">Reads from Primary are always stable: can never be false progressed.</span></span>

### <a name="next-steps"></a><span data-ttu-id="becc2-140">Další kroky</span><span class="sxs-lookup"><span data-stu-id="becc2-140">Next steps</span></span>
* [<span data-ttu-id="becc2-141">Práce s Reliable Collections</span><span class="sxs-lookup"><span data-stu-id="becc2-141">Working with Reliable Collections</span></span>](service-fabric-work-with-reliable-collections.md)
* [<span data-ttu-id="becc2-142">Transakce a zámky.</span><span class="sxs-lookup"><span data-stu-id="becc2-142">Transactions and Locks</span></span>](service-fabric-reliable-services-reliable-collections-transactions-locks.md)
* [<span data-ttu-id="becc2-143">Správce spolehlivé stavu a interní informace o kolekci</span><span class="sxs-lookup"><span data-stu-id="becc2-143">Reliable State Manager and Collection Internals</span></span>](service-fabric-reliable-services-reliable-collections-internals.md)
* <span data-ttu-id="becc2-144">Správa dat</span><span class="sxs-lookup"><span data-stu-id="becc2-144">Managing Data</span></span>
  * [<span data-ttu-id="becc2-145">Zálohování a obnovení</span><span class="sxs-lookup"><span data-stu-id="becc2-145">Backup and Restore</span></span>](service-fabric-reliable-services-backup-restore.md)
  * [<span data-ttu-id="becc2-146">Oznámení</span><span class="sxs-lookup"><span data-stu-id="becc2-146">Notifications</span></span>](service-fabric-reliable-services-notifications.md)
  * [<span data-ttu-id="becc2-147">Serializace a Upgrade</span><span class="sxs-lookup"><span data-stu-id="becc2-147">Serialization and Upgrade</span></span>](service-fabric-application-upgrade-data-serialization.md)
  * [<span data-ttu-id="becc2-148">Configuration Manager spolehlivé stavu</span><span class="sxs-lookup"><span data-stu-id="becc2-148">Reliable State Manager configuration</span></span>](service-fabric-reliable-services-configuration.md)
* <span data-ttu-id="becc2-149">Ostatní</span><span class="sxs-lookup"><span data-stu-id="becc2-149">Others</span></span>
  * [<span data-ttu-id="becc2-150">Spolehlivé služby rychlý start</span><span class="sxs-lookup"><span data-stu-id="becc2-150">Reliable Services quick start</span></span>](service-fabric-reliable-services-quick-start.md)
  * [<span data-ttu-id="becc2-151">Referenční informace pro vývojáře pro spolehlivé kolekce</span><span class="sxs-lookup"><span data-stu-id="becc2-151">Developer reference for Reliable Collections</span></span>](https://msdn.microsoft.com/library/azure/microsoft.servicefabric.data.collections.aspx)
