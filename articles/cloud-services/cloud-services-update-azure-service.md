---
title: "aaaHow tooupdate cloudové služby | Microsoft Docs"
description: "Zjistěte, jak tooupdate cloudových služeb v Azure. Zjistěte, jak aktualizace v cloudové službě pokračuje tooensure dostupnosti."
services: cloud-services
documentationcenter: 
author: Thraka
manager: timlt
editor: 
ms.assetid: c6a8b5e6-5c99-454c-9911-5c7ae8d1af63
ms.service: cloud-services
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 04/19/2017
ms.author: adegeo
ms.openlocfilehash: 7e4c8bd46e51a555b4309ea8927d120e8efcf0ea
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="how-tooupdate-a-cloud-service"></a><span data-ttu-id="5c841-104">Jak tooupdate cloudové služby</span><span class="sxs-lookup"><span data-stu-id="5c841-104">How tooupdate a cloud service</span></span>

<span data-ttu-id="5c841-105">Aktualizace cloudové služby, včetně jeho role a hostovaný operační systém, je proces tři krok.</span><span class="sxs-lookup"><span data-stu-id="5c841-105">Updating a cloud service, including both its roles and guest OS, is a three step process.</span></span> <span data-ttu-id="5c841-106">Nejprve hello binární soubory a konfigurační soubory pro hello novou cloudovou službu nebo verze operačního systému, musí se nahrát.</span><span class="sxs-lookup"><span data-stu-id="5c841-106">First, hello binaries and configuration files for hello new cloud service or OS version must be uploaded.</span></span> <span data-ttu-id="5c841-107">V dalším kroku Azure si vyhrazuje výpočetní a síťové prostředky pro hello cloudové služby na základě požadavků hello hello novou verzi cloud service.</span><span class="sxs-lookup"><span data-stu-id="5c841-107">Next, Azure reserves compute and network resources for hello cloud service based on hello requirements of hello new cloud service version.</span></span> <span data-ttu-id="5c841-108">Nakonec Azure provede nová verze s postupného upgradu tooincrementally aktualizace hello klienta toohello nebo hostovaný operační systém, při zachování vaší dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="5c841-108">Finally, Azure performs a rolling upgrade tooincrementally update hello tenant toohello new version or guest OS, while preserving your availability.</span></span> <span data-ttu-id="5c841-109">Tento článek popisuje hello podrobnosti o tomto posledním kroku – hello vrácení upgradu.</span><span class="sxs-lookup"><span data-stu-id="5c841-109">This article discusses hello details of this last step – hello rolling upgrade.</span></span>

## <a name="update-an-azure-service"></a><span data-ttu-id="5c841-110">Aktualizace služby Azure</span><span class="sxs-lookup"><span data-stu-id="5c841-110">Update an Azure Service</span></span>
<span data-ttu-id="5c841-111">Azure umožňuje instance role uspořádat do logických skupin názvem domén upgradu (UD).</span><span class="sxs-lookup"><span data-stu-id="5c841-111">Azure organizes your role instances into logical groupings called upgrade domains (UD).</span></span> <span data-ttu-id="5c841-112">Upgradu domény (UD) jsou logické skupiny instancí role, které jsou aktualizované jako skupina.</span><span class="sxs-lookup"><span data-stu-id="5c841-112">Upgrade domains (UD) are logical sets of role instances that are updated as a group.</span></span>  <span data-ttu-id="5c841-113">Azure aktualizace a cloudové služby jeden UD současně, což umožňuje instancí v jiných UDs toocontinue obsluhující provoz.</span><span class="sxs-lookup"><span data-stu-id="5c841-113">Azure updates a cloud service one UD at a time, which allows instances in other UDs toocontinue serving traffic.</span></span>

<span data-ttu-id="5c841-114">Hello výchozí počet domén upgradu je 5.</span><span class="sxs-lookup"><span data-stu-id="5c841-114">hello default number of upgrade domains is 5.</span></span> <span data-ttu-id="5c841-115">Můžete zadat jiný počet domén upgradu včetně hello upgradeDomainCount atribut v souboru definice hello služby (.csdef).</span><span class="sxs-lookup"><span data-stu-id="5c841-115">You can specify a different number of upgrade domains by including hello upgradeDomainCount attribute in hello service’s definition file (.csdef).</span></span> <span data-ttu-id="5c841-116">Další informace o atributu upgradeDomainCount hello najdete v tématu [WebRole schématu](https://msdn.microsoft.com/library/azure/gg557553.aspx) nebo [WorkerRole schématu](https://msdn.microsoft.com/library/azure/gg557552.aspx).</span><span class="sxs-lookup"><span data-stu-id="5c841-116">For more information about hello upgradeDomainCount attribute, see [WebRole Schema](https://msdn.microsoft.com/library/azure/gg557553.aspx) or [WorkerRole Schema](https://msdn.microsoft.com/library/azure/gg557552.aspx).</span></span>

<span data-ttu-id="5c841-117">Když provedete aktualizaci na místě jednu nebo více rolí ve službě, aktualizuje Azure sady instancí role podle toowhich toohello upgradovací doméně, ke které patří.</span><span class="sxs-lookup"><span data-stu-id="5c841-117">When you perform an in-place update of one or more roles in your service, Azure updates sets of role instances according toohello upgrade domain toowhich they belong.</span></span> <span data-ttu-id="5c841-118">Azure aktualizací, které se všechny instance hello v dané doméně upgradu –, zastavení, aktualizuje, uvede zpět online – pak se posouvá do další domény hello.</span><span class="sxs-lookup"><span data-stu-id="5c841-118">Azure updates all of hello instances in a given upgrade domain – stopping them, updating them, bringing them back on-line – then moves onto hello next domain.</span></span> <span data-ttu-id="5c841-119">Tím zastavíte pouze hello instancí spuštěných v hello aktuální upgradovací doména, je zajištěno, že dojde k aktualizaci s hello nejmenší dopad toohello službou Azure.</span><span class="sxs-lookup"><span data-stu-id="5c841-119">By stopping only hello instances running in hello current upgrade domain, Azure makes sure that an update occurs with hello least possible impact toohello running service.</span></span> <span data-ttu-id="5c841-120">Další informace najdete v tématu [jak hello aktualizace pokračuje](#howanupgradeproceeds) dále v tomto článku.</span><span class="sxs-lookup"><span data-stu-id="5c841-120">For more information, see [How hello update proceeds](#howanupgradeproceeds) later in this article.</span></span>

> [!NOTE]
> <span data-ttu-id="5c841-121">Při hello podmínky **aktualizace** a **upgrade** mají mírně jiný význam v kontextu hello Azure, mohou být použity zcela zaměnitelným významem pro hello procesů a popisy hello funkcí v tomto dokumentu.</span><span class="sxs-lookup"><span data-stu-id="5c841-121">While hello terms **update** and **upgrade** have slightly different meaning in hello context Azure, they can be used interchangeably for hello processes and descriptions of hello features in this document.</span></span>
>
>

<span data-ttu-id="5c841-122">Služby, musíte definovat alespoň dvě instance role pro tuto roli toobe aktualizovat místní bez výpadků.</span><span class="sxs-lookup"><span data-stu-id="5c841-122">Your service must define at least two instances of a role for that role toobe updated in-place without downtime.</span></span> <span data-ttu-id="5c841-123">Pokud služba hello obsahuje pouze jednu instanci jedné role, služby bude k dispozici, dokud hello místní aktualizace dokončí.</span><span class="sxs-lookup"><span data-stu-id="5c841-123">If hello service consists of only one instance of one role, your service will be unavailable until hello in-place update has finished.</span></span>

<span data-ttu-id="5c841-124">Toto téma obsahuje následující informace o Azure aktualizace hello:</span><span class="sxs-lookup"><span data-stu-id="5c841-124">This topic covers hello following information about Azure updates:</span></span>

* [<span data-ttu-id="5c841-125">Během aktualizace povoleny změny služby</span><span class="sxs-lookup"><span data-stu-id="5c841-125">Allowed service changes during an update</span></span>](#AllowedChanges)
* [<span data-ttu-id="5c841-126">Jak pokračuje upgradu</span><span class="sxs-lookup"><span data-stu-id="5c841-126">How an upgrade proceeds</span></span>](#howanupgradeproceeds)
* [<span data-ttu-id="5c841-127">Vrácení zpět aktualizace</span><span class="sxs-lookup"><span data-stu-id="5c841-127">Rollback of an update</span></span>](#RollbackofanUpdate)
* [<span data-ttu-id="5c841-128">Spouštění více mutating operací na probíhající nasazení</span><span class="sxs-lookup"><span data-stu-id="5c841-128">Initiating multiple mutating operations on an ongoing deployment</span></span>](#multiplemutatingoperations)
* [<span data-ttu-id="5c841-129">Distribuce rolí napříč doménami upgradu</span><span class="sxs-lookup"><span data-stu-id="5c841-129">Distribution of roles across upgrade domains</span></span>](#distributiondfroles)

<a name="AllowedChanges"></a>

## <a name="allowed-service-changes-during-an-update"></a><span data-ttu-id="5c841-130">Během aktualizace povoleny změny služby</span><span class="sxs-lookup"><span data-stu-id="5c841-130">Allowed service changes during an update</span></span>
<span data-ttu-id="5c841-131">Hello následující tabulka uvádí, že hello povolené změny tooa služby během aktualizace:</span><span class="sxs-lookup"><span data-stu-id="5c841-131">hello following table shows hello allowed changes tooa service during an update:</span></span>

| <span data-ttu-id="5c841-132">Změny povoleny toohosting, služeb a rolí</span><span class="sxs-lookup"><span data-stu-id="5c841-132">Changes permitted toohosting, services, and roles</span></span> | <span data-ttu-id="5c841-133">Aktualizace na místě</span><span class="sxs-lookup"><span data-stu-id="5c841-133">In-place update</span></span> | <span data-ttu-id="5c841-134">Dvoufázové instalace (prohození virtuálních IP adres)</span><span class="sxs-lookup"><span data-stu-id="5c841-134">Staged (VIP swap)</span></span> | <span data-ttu-id="5c841-135">Odstranit a znovu nasadit.</span><span class="sxs-lookup"><span data-stu-id="5c841-135">Delete and re-deploy</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="5c841-136">Verze operačního systému</span><span class="sxs-lookup"><span data-stu-id="5c841-136">Operating system version</span></span> |<span data-ttu-id="5c841-137">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-137">Yes</span></span> |<span data-ttu-id="5c841-138">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-138">Yes</span></span> |<span data-ttu-id="5c841-139">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-139">Yes</span></span> |
| <span data-ttu-id="5c841-140">Úrovně důvěryhodnosti .NET</span><span class="sxs-lookup"><span data-stu-id="5c841-140">.NET trust level</span></span> |<span data-ttu-id="5c841-141">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-141">Yes</span></span> |<span data-ttu-id="5c841-142">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-142">Yes</span></span> |<span data-ttu-id="5c841-143">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-143">Yes</span></span> |
| <span data-ttu-id="5c841-144">Velikost virtuálního počítače<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="5c841-144">Virtual machine size<sup>1</sup></span></span> |<span data-ttu-id="5c841-145">Ano<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="5c841-145">Yes<sup>2</sup></span></span> |<span data-ttu-id="5c841-146">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-146">Yes</span></span> |<span data-ttu-id="5c841-147">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-147">Yes</span></span> |
| <span data-ttu-id="5c841-148">Nastavení místního úložiště</span><span class="sxs-lookup"><span data-stu-id="5c841-148">Local storage settings</span></span> |<span data-ttu-id="5c841-149">Pouze zvýšit<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="5c841-149">Increase only<sup>2</sup></span></span> |<span data-ttu-id="5c841-150">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-150">Yes</span></span> |<span data-ttu-id="5c841-151">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-151">Yes</span></span> |
| <span data-ttu-id="5c841-152">Přidání nebo odebrání rolí ve službě</span><span class="sxs-lookup"><span data-stu-id="5c841-152">Add or remove roles in a service</span></span> |<span data-ttu-id="5c841-153">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-153">Yes</span></span> |<span data-ttu-id="5c841-154">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-154">Yes</span></span> |<span data-ttu-id="5c841-155">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-155">Yes</span></span> |
| <span data-ttu-id="5c841-156">Počet instancí určité role</span><span class="sxs-lookup"><span data-stu-id="5c841-156">Number of instances of a particular role</span></span> |<span data-ttu-id="5c841-157">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-157">Yes</span></span> |<span data-ttu-id="5c841-158">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-158">Yes</span></span> |<span data-ttu-id="5c841-159">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-159">Yes</span></span> |
| <span data-ttu-id="5c841-160">Číslo nebo typ koncových bodů pro služby</span><span class="sxs-lookup"><span data-stu-id="5c841-160">Number or type of endpoints for a service</span></span> |<span data-ttu-id="5c841-161">Ano<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="5c841-161">Yes<sup>2</sup></span></span> |<span data-ttu-id="5c841-162">Ne</span><span class="sxs-lookup"><span data-stu-id="5c841-162">No</span></span> |<span data-ttu-id="5c841-163">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-163">Yes</span></span> |
| <span data-ttu-id="5c841-164">Názvy a hodnoty nastavení konfigurace</span><span class="sxs-lookup"><span data-stu-id="5c841-164">Names and values of configuration settings</span></span> |<span data-ttu-id="5c841-165">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-165">Yes</span></span> |<span data-ttu-id="5c841-166">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-166">Yes</span></span> |<span data-ttu-id="5c841-167">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-167">Yes</span></span> |
| <span data-ttu-id="5c841-168">Hodnoty (ale ne názvy) nastavení konfigurace</span><span class="sxs-lookup"><span data-stu-id="5c841-168">Values (but not names) of configuration settings</span></span> |<span data-ttu-id="5c841-169">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-169">Yes</span></span> |<span data-ttu-id="5c841-170">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-170">Yes</span></span> |<span data-ttu-id="5c841-171">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-171">Yes</span></span> |
| <span data-ttu-id="5c841-172">Přidat nové certifikáty</span><span class="sxs-lookup"><span data-stu-id="5c841-172">Add new certificates</span></span> |<span data-ttu-id="5c841-173">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-173">Yes</span></span> |<span data-ttu-id="5c841-174">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-174">Yes</span></span> |<span data-ttu-id="5c841-175">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-175">Yes</span></span> |
| <span data-ttu-id="5c841-176">Změna existující certifikátů</span><span class="sxs-lookup"><span data-stu-id="5c841-176">Change existing certificates</span></span> |<span data-ttu-id="5c841-177">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-177">Yes</span></span> |<span data-ttu-id="5c841-178">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-178">Yes</span></span> |<span data-ttu-id="5c841-179">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-179">Yes</span></span> |
| <span data-ttu-id="5c841-180">Nasazování nového kódu</span><span class="sxs-lookup"><span data-stu-id="5c841-180">Deploy new code</span></span> |<span data-ttu-id="5c841-181">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-181">Yes</span></span> |<span data-ttu-id="5c841-182">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-182">Yes</span></span> |<span data-ttu-id="5c841-183">Ano</span><span class="sxs-lookup"><span data-stu-id="5c841-183">Yes</span></span> |

<span data-ttu-id="5c841-184"><sup>1</sup> Změna velikosti omezená podmnožina toohello velikostí hello cloudové služby k dispozici.</span><span class="sxs-lookup"><span data-stu-id="5c841-184"><sup>1</sup> Size change limited toohello subset of sizes available for hello cloud service.</span></span>

<span data-ttu-id="5c841-185"><sup>2</sup> vyžaduje Azure SDK 1.5 nebo novější verze.</span><span class="sxs-lookup"><span data-stu-id="5c841-185"><sup>2</sup> Requires Azure SDK 1.5 or later versions.</span></span>

> [!WARNING]
> <span data-ttu-id="5c841-186">Změna velikosti virtuálního počítače hello zničí místní data.</span><span class="sxs-lookup"><span data-stu-id="5c841-186">Changing hello virtual machine size will destroy local data.</span></span>
>
>

<span data-ttu-id="5c841-187">během aktualizace nejsou podporovány Hello následující položky:</span><span class="sxs-lookup"><span data-stu-id="5c841-187">hello following items are not supported during an update:</span></span>

* <span data-ttu-id="5c841-188">Změna hello název role.</span><span class="sxs-lookup"><span data-stu-id="5c841-188">Changing hello name of a role.</span></span> <span data-ttu-id="5c841-189">Odeberte a pak přidejte hello role s novým názvem hello.</span><span class="sxs-lookup"><span data-stu-id="5c841-189">Remove and then add hello role with hello new name.</span></span>
* <span data-ttu-id="5c841-190">Změnou hello počet domén upgradu.</span><span class="sxs-lookup"><span data-stu-id="5c841-190">Changing of hello Upgrade Domain count.</span></span>
* <span data-ttu-id="5c841-191">Snížení velikosti hello hello místních prostředků.</span><span class="sxs-lookup"><span data-stu-id="5c841-191">Decreasing hello size of hello local resources.</span></span>

<span data-ttu-id="5c841-192">Pokud provádíte jiné aktualizace definice tooyour služby, jako je například snížení hello velikost místního prostředku, je nutné provést o aktualizaci prohození virtuální IP adresy.</span><span class="sxs-lookup"><span data-stu-id="5c841-192">If you are making other updates tooyour service's definition, such as decreasing hello size of local resource, you must perform a VIP swap update instead.</span></span> <span data-ttu-id="5c841-193">Další informace najdete v tématu [Prohodit nasazení](https://msdn.microsoft.com/library/azure/ee460814.aspx).</span><span class="sxs-lookup"><span data-stu-id="5c841-193">For more information, see [Swap Deployment](https://msdn.microsoft.com/library/azure/ee460814.aspx).</span></span>

<a name="howanupgradeproceeds"></a>

## <a name="how-an-upgrade-proceeds"></a><span data-ttu-id="5c841-194">Jak pokračuje upgradu</span><span class="sxs-lookup"><span data-stu-id="5c841-194">How an upgrade proceeds</span></span>
<span data-ttu-id="5c841-195">Můžete rozhodnout, jestli chcete tooupdate všechny hello role ve službě nebo jedné role ve službě hello.</span><span class="sxs-lookup"><span data-stu-id="5c841-195">You can decide whether you want tooupdate all of hello roles in your service or a single role in hello service.</span></span> <span data-ttu-id="5c841-196">V obou případech jsou všechny instance každé role, probíhá upgrade a musí patřit toohello první doména upgradu byla zastavena, upgradovat a vrátí do režimu online.</span><span class="sxs-lookup"><span data-stu-id="5c841-196">In either case, all instances of each role that is being upgraded and belong toohello first upgrade domain are stopped, upgraded, and brought back online.</span></span> <span data-ttu-id="5c841-197">Jakmile jsou zpět do režimu online, hello instancí v druhé doméně upgradu hello jsou zastavena, upgradovat a znovu online.</span><span class="sxs-lookup"><span data-stu-id="5c841-197">Once they are back online, hello instances in hello second upgrade domain are stopped, upgraded, and brought back online.</span></span> <span data-ttu-id="5c841-198">Cloudové služby může mít maximálně jeden upgradu v každém okamžiku aktivní.</span><span class="sxs-lookup"><span data-stu-id="5c841-198">A cloud service can have at most one upgrade active at a time.</span></span> <span data-ttu-id="5c841-199">Hello upgrade je vždy adresovat hello nejnovější verzi hello cloudové služby.</span><span class="sxs-lookup"><span data-stu-id="5c841-199">hello upgrade is always performed against hello latest version of hello cloud service.</span></span>

<span data-ttu-id="5c841-200">Hello následující diagram ilustruje, jak hello upgradu při upgradu všech hello rolí ve službě hello:</span><span class="sxs-lookup"><span data-stu-id="5c841-200">hello following diagram illustrates how hello upgrade proceeds if you are upgrading all of hello roles in hello service:</span></span>

<span data-ttu-id="5c841-201">![Upgrade služby](media/cloud-services-update-azure-service/IC345879.png "Upgrade služby")</span><span class="sxs-lookup"><span data-stu-id="5c841-201">![Upgrade service](media/cloud-services-update-azure-service/IC345879.png "Upgrade service")</span></span>

<span data-ttu-id="5c841-202">Tento další diagram znázorňuje, jak bude pokračovat aktualizace hello, pokud provádíte upgrade jedné role:</span><span class="sxs-lookup"><span data-stu-id="5c841-202">This next diagram illustrates how hello update proceeds if you are upgrading only a single role:</span></span>

<span data-ttu-id="5c841-203">![Upgrade role](media/cloud-services-update-azure-service/IC345880.png "upgradu role")</span><span class="sxs-lookup"><span data-stu-id="5c841-203">![Upgrade role](media/cloud-services-update-azure-service/IC345880.png "Upgrade role")</span></span>  

<span data-ttu-id="5c841-204">Během automatické aktualizace hello Kontroleru prostředků infrastruktury Azure pravidelně vyhodnocuje stav hello hello cloudové služby toodetermine při bezpečné toowalk hello další UD.</span><span class="sxs-lookup"><span data-stu-id="5c841-204">During an automatic update, hello Azure Fabric Controller periodically evaluates hello health of hello cloud service toodetermine when it’s safe toowalk hello next UD.</span></span> <span data-ttu-id="5c841-205">Tato vyhodnocení stavu se provádí na základě podle rolí a považuje pouze instance v nejnovější verzi hello (tj. instance z UDs, které již byly šel).</span><span class="sxs-lookup"><span data-stu-id="5c841-205">This health evaluation is performed on a per-role basis and considers only instances in hello latest version (i.e. instances from UDs that have already been walked).</span></span> <span data-ttu-id="5c841-206">Ověřuje, že minimální počet instancí role, pro každou roli, jste dosáhli uspokojivé stavu terminálu.</span><span class="sxs-lookup"><span data-stu-id="5c841-206">It verifies that a minimum number of role instances, for each role, have achieved a satisfactory terminal state.</span></span>

### <a name="role-instance-start-timeout"></a><span data-ttu-id="5c841-207">Časový limit spuštění Instance role</span><span class="sxs-lookup"><span data-stu-id="5c841-207">Role Instance Start Timeout</span></span>
<span data-ttu-id="5c841-208">Hello Kontroleru prostředků infrastruktury počká 30 minut pro každou roli instance tooreach do stavu spuštěno.</span><span class="sxs-lookup"><span data-stu-id="5c841-208">hello Fabric Controller will wait 30 minutes for each role instance tooreach a Started state.</span></span> <span data-ttu-id="5c841-209">Pokud dobu trvání časového limitu hello uplyne, hello Kontroleru prostředků infrastruktury bude pokračovat, proti toohello další instance role.</span><span class="sxs-lookup"><span data-stu-id="5c841-209">If hello timeout duration elapses, hello Fabric Controller will continue walking toohello next role instance.</span></span>

### <a name="impact-toodrive-data-during-cloud-service-upgrades"></a><span data-ttu-id="5c841-210">Dopad toodrive dat při upgradech cloudové služby</span><span class="sxs-lookup"><span data-stu-id="5c841-210">Impact toodrive data during Cloud Service upgrades</span></span>

<span data-ttu-id="5c841-211">Při upgradu služby z instance toomultiple jediné instance, které vaše služba bude se snížila při upgradu hello se provádí z důvodu toohello způsob upgradu služby Azure.</span><span class="sxs-lookup"><span data-stu-id="5c841-211">When upgrading a service from a single instance toomultiple instances your service will be brought down while hello upgrade is performed due toohello way Azure upgrades services.</span></span> <span data-ttu-id="5c841-212">Hello smlouvu o úrovni záruční služby dostupnost služeb se vztahuje pouze na tooservices, který se nasadí s více než jednu instanci.</span><span class="sxs-lookup"><span data-stu-id="5c841-212">hello service level agreement guaranteeing service availability only applies tooservices that are deployed with more than one instance.</span></span> <span data-ttu-id="5c841-213">Hello následující seznam popisuje, jak hello data na každém disku je ovlivňován každý scénář upgradu služby Azure:</span><span class="sxs-lookup"><span data-stu-id="5c841-213">hello following list describes how hello data on each drive is affected by each Azure service upgrade scenario:</span></span>

|<span data-ttu-id="5c841-214">Scénář</span><span class="sxs-lookup"><span data-stu-id="5c841-214">Scenario</span></span>|<span data-ttu-id="5c841-215">Jednotka C</span><span class="sxs-lookup"><span data-stu-id="5c841-215">C Drive</span></span>|<span data-ttu-id="5c841-216">Diskovou jednotku d</span><span class="sxs-lookup"><span data-stu-id="5c841-216">D Drive</span></span>|<span data-ttu-id="5c841-217">Jednotce E:</span><span class="sxs-lookup"><span data-stu-id="5c841-217">E Drive</span></span>|
|--------|-------|-------|-------|
|<span data-ttu-id="5c841-218">Restartování virtuálního počítače</span><span class="sxs-lookup"><span data-stu-id="5c841-218">VM reboot</span></span>|<span data-ttu-id="5c841-219">Zachovají</span><span class="sxs-lookup"><span data-stu-id="5c841-219">Preserved</span></span>|<span data-ttu-id="5c841-220">Zachovají</span><span class="sxs-lookup"><span data-stu-id="5c841-220">Preserved</span></span>|<span data-ttu-id="5c841-221">Zachovají</span><span class="sxs-lookup"><span data-stu-id="5c841-221">Preserved</span></span>|
|<span data-ttu-id="5c841-222">Restartování portálu</span><span class="sxs-lookup"><span data-stu-id="5c841-222">Portal reboot</span></span>|<span data-ttu-id="5c841-223">Zachovají</span><span class="sxs-lookup"><span data-stu-id="5c841-223">Preserved</span></span>|<span data-ttu-id="5c841-224">Zachovají</span><span class="sxs-lookup"><span data-stu-id="5c841-224">Preserved</span></span>|<span data-ttu-id="5c841-225">Zničení</span><span class="sxs-lookup"><span data-stu-id="5c841-225">Destroyed</span></span>|
|<span data-ttu-id="5c841-226">Obnovení z Image portálu</span><span class="sxs-lookup"><span data-stu-id="5c841-226">Portal reimage</span></span>|<span data-ttu-id="5c841-227">Zachovají</span><span class="sxs-lookup"><span data-stu-id="5c841-227">Preserved</span></span>|<span data-ttu-id="5c841-228">Zničení</span><span class="sxs-lookup"><span data-stu-id="5c841-228">Destroyed</span></span>|<span data-ttu-id="5c841-229">Zničení</span><span class="sxs-lookup"><span data-stu-id="5c841-229">Destroyed</span></span>|
|<span data-ttu-id="5c841-230">Místní Upgrade</span><span class="sxs-lookup"><span data-stu-id="5c841-230">In-Place Upgrade</span></span>|<span data-ttu-id="5c841-231">Zachovají</span><span class="sxs-lookup"><span data-stu-id="5c841-231">Preserved</span></span>|<span data-ttu-id="5c841-232">Zachovají</span><span class="sxs-lookup"><span data-stu-id="5c841-232">Preserved</span></span>|<span data-ttu-id="5c841-233">Zničení</span><span class="sxs-lookup"><span data-stu-id="5c841-233">Destroyed</span></span>|
|<span data-ttu-id="5c841-234">Migrace uzlu</span><span class="sxs-lookup"><span data-stu-id="5c841-234">Node migration</span></span>|<span data-ttu-id="5c841-235">Zničení</span><span class="sxs-lookup"><span data-stu-id="5c841-235">Destroyed</span></span>|<span data-ttu-id="5c841-236">Zničení</span><span class="sxs-lookup"><span data-stu-id="5c841-236">Destroyed</span></span>|<span data-ttu-id="5c841-237">Zničení</span><span class="sxs-lookup"><span data-stu-id="5c841-237">Destroyed</span></span>|

<span data-ttu-id="5c841-238">Upozorňujeme, že, v hello výše seznamu hello jednotce E: představuje hello role kořenové jednotce a nesmí být pevně.</span><span class="sxs-lookup"><span data-stu-id="5c841-238">Note that, in hello above list, hello E: drive represents hello role’s root drive, and should not be hard-coded.</span></span> <span data-ttu-id="5c841-239">Místo toho použijte hello **RoleRoot %** jednotky hello toorepresent proměnné prostředí.</span><span class="sxs-lookup"><span data-stu-id="5c841-239">Instead, use hello **%RoleRoot%** environment variable toorepresent hello drive.</span></span>

<span data-ttu-id="5c841-240">toominimize hello prostoje při upgradu jedné instance služby, nasaďte nový s více instancemi služby toohello pracovní server a proveďte prohození virtuálních IP adres.</span><span class="sxs-lookup"><span data-stu-id="5c841-240">toominimize hello downtime when upgrading a single-instance service, deploy a new multi-instance service toohello staging server and perform a VIP swap.</span></span>

<a name="RollbackofanUpdate"></a>

## <a name="rollback-of-an-update"></a><span data-ttu-id="5c841-241">Vrácení zpět aktualizace</span><span class="sxs-lookup"><span data-stu-id="5c841-241">Rollback of an update</span></span>
<span data-ttu-id="5c841-242">Azure poskytuje flexibilitu při správě služby během aktualizace tím, že umožňuje zahájit další operace ve službě, po hello počáteční aktualizace žádost přijme hello Kontroleru prostředků infrastruktury Azure.</span><span class="sxs-lookup"><span data-stu-id="5c841-242">Azure provides flexibility in managing services during an update by letting you initiate additional operations on a service, after hello initial update request is accepted by hello Azure Fabric Controller.</span></span> <span data-ttu-id="5c841-243">Vrácení zpět lze provést pouze, pokud by aktualizace (Změna konfigurace) nebo upgradu je v hello **v průběhu** stavu na hello nasazení.</span><span class="sxs-lookup"><span data-stu-id="5c841-243">A rollback can only be performed when an update (configuration change) or upgrade is in hello **in progress** state on hello deployment.</span></span> <span data-ttu-id="5c841-244">Aktualizaci nebo upgradu považuje toobe v průběhu, dokud bude alespoň jedna instance hello služby, který ještě nebylo aktualizované toohello novou verzi.</span><span class="sxs-lookup"><span data-stu-id="5c841-244">An update or upgrade is considered toobe in-progress as long as there is at least one instance of hello service which has not yet been updated toohello new version.</span></span> <span data-ttu-id="5c841-245">tootest povolení vrácení zpět. Zkontrolujte hodnotu hello hello RollbackAllowed příznaku, vrácený [získat nasazení](https://msdn.microsoft.com/library/azure/ee460804.aspx) a [získat vlastnosti cloudové služby](https://msdn.microsoft.com/library/azure/ee460806.aspx) operace, je nastaven tootrue.</span><span class="sxs-lookup"><span data-stu-id="5c841-245">tootest whether a rollback is allowed, check hello value of hello RollbackAllowed flag, returned by [Get Deployment](https://msdn.microsoft.com/library/azure/ee460804.aspx) and [Get Cloud Service Properties](https://msdn.microsoft.com/library/azure/ee460806.aspx) operations, is set tootrue.</span></span>

> [!NOTE]
> <span data-ttu-id="5c841-246">Pouze vytváří smysl toocall vrácení zpět na **na místě** aktualizovat nebo upgradovat, protože upgrady prohození virtuální IP adresy zahrnují nahrazení jednu celý spuštěné instanci služby s jinou.</span><span class="sxs-lookup"><span data-stu-id="5c841-246">It only makes sense toocall Rollback on an **in-place** update or upgrade because VIP swap upgrades involve replacing one entire running instance of your service with another.</span></span>
>
>

<span data-ttu-id="5c841-247">Vrácení změn v průběhu aktualizace má následující důsledky pro nasazení hello hello:</span><span class="sxs-lookup"><span data-stu-id="5c841-247">Rollback of an in-progress update has hello following effects on hello deployment:</span></span>

* <span data-ttu-id="5c841-248">Nejsou žádné instance role, které by ještě nebyl aktualizované nebo upgradované toohello novou verzi aktualizovat nebo upgradovat, protože tato instance je již spuštěn hello cílová verze služby hello.</span><span class="sxs-lookup"><span data-stu-id="5c841-248">Any role instances which had not yet been updated or upgraded toohello new version are not updated or upgraded, because those instances are already running hello target version of hello service.</span></span>
* <span data-ttu-id="5c841-249">Instance žádné role, které už nebyly aktualizovány nebo upgradované toohello novou verzi balíčku služby hello (\*.cspkg) souboru nebo hello konfigurace služby (\*.cscfg) souboru (nebo oba soubory) jsou vrácený toohello před upgradem verze Tyto soubory.</span><span class="sxs-lookup"><span data-stu-id="5c841-249">Any role instances which had already been updated or upgraded toohello new version of hello service package (\*.cspkg) file or hello service configuration (\*.cscfg) file (or both files) are reverted toohello pre-upgrade version of these files.</span></span>

<span data-ttu-id="5c841-250">To funkčně zajišťuje hello následující funkce:</span><span class="sxs-lookup"><span data-stu-id="5c841-250">This functionally is provided by hello following features:</span></span>

* <span data-ttu-id="5c841-251">Hello [vrácení zpět aktualizovat nebo upgradovat](https://msdn.microsoft.com/library/azure/hh403977.aspx) operace, které může zavolat na aktualizaci konfigurace (aktivovány volání [změna konfigurace nasazení](https://msdn.microsoft.com/library/azure/ee460809.aspx)) nebo upgradu (aktivovány volání [ Nasazení upgradu](https://msdn.microsoft.com/library/azure/ee460793.aspx)), dokud existuje alespoň jedna instance ve službě hello která dosud nebyla aktualizována toohello novou verzi.</span><span class="sxs-lookup"><span data-stu-id="5c841-251">hello [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx) operation, which can be called on a configuration update (triggered by calling [Change Deployment Configuration](https://msdn.microsoft.com/library/azure/ee460809.aspx)) or an upgrade (triggered by calling [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx)) as long as there is at least one instance in hello service which has not yet been updated toohello new version.</span></span>
* <span data-ttu-id="5c841-252">Hello elementu uzamčen a hello RollbackAllowed elementu, které se vrátí jako součást text odpovědi hello hello [získat nasazení](https://msdn.microsoft.com/library/azure/ee460804.aspx) a [získat vlastnosti cloudové služby](https://msdn.microsoft.com/library/azure/ee460806.aspx) operace:</span><span class="sxs-lookup"><span data-stu-id="5c841-252">hello Locked element and hello RollbackAllowed element, which are returned as part of hello response body of hello [Get Deployment](https://msdn.microsoft.com/library/azure/ee460804.aspx) and [Get Cloud Service Properties](https://msdn.microsoft.com/library/azure/ee460806.aspx) operations:</span></span>

  1. <span data-ttu-id="5c841-253">element uzamčen Hello umožňuje toodetect při mutating operace může být volána v zadaném nasazení.</span><span class="sxs-lookup"><span data-stu-id="5c841-253">hello Locked element allows you toodetect when a mutating operation can be invoked on a given deployment.</span></span>
  2. <span data-ttu-id="5c841-254">Hello RollbackAllowed element vám umožní toodetect při hello [vrácení zpět aktualizace nebo upgradu](https://msdn.microsoft.com/library/azure/hh403977.aspx) operaci nelze volat u dané nasazení.</span><span class="sxs-lookup"><span data-stu-id="5c841-254">hello RollbackAllowed element allows you toodetect when hello [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx) operation can be called on a given deployment.</span></span>

  <span data-ttu-id="5c841-255">V pořadí tooperform vrácení zpět nemáte toocheck hello uzamčen i hello RollbackAllowed elementy.</span><span class="sxs-lookup"><span data-stu-id="5c841-255">In order tooperform a rollback, you do not have toocheck both hello Locked and hello RollbackAllowed elements.</span></span> <span data-ttu-id="5c841-256">Stačí tooconfirm zda RollbackAllowed nastaveno tootrue.</span><span class="sxs-lookup"><span data-stu-id="5c841-256">It suffices tooconfirm that RollbackAllowed is set tootrue.</span></span> <span data-ttu-id="5c841-257">Tyto prvky jsou vrácena pouze v případě, že tyto metody jsou vyvolány pomocí hello hlavičky žádosti nastavit také "x-ms-version: 2011-10-01" nebo novější.</span><span class="sxs-lookup"><span data-stu-id="5c841-257">These elements are only returned if these methods are invoked by using hello request header set too“x-ms-version: 2011-10-01” or a later version.</span></span> <span data-ttu-id="5c841-258">Další informace o hlavičkách verze najdete v tématu [Správa služby správy verzí](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span><span class="sxs-lookup"><span data-stu-id="5c841-258">For more information about versioning headers, see [Service Management Versioning](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span></span>

<span data-ttu-id="5c841-259">Existují některé situace, kde vrácení zpět aktualizace nebo není upgrade podporován, jedná se o následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="5c841-259">There are some situations where a rollback of an update or upgrade is not supported, these are as follows:</span></span>

* <span data-ttu-id="5c841-260">Snížení místních prostředků – Pokud hello aktualizace zvyšuje hello místních prostředků pro roli hello platformy Azure neumožňuje vrácení zpět.</span><span class="sxs-lookup"><span data-stu-id="5c841-260">Reduction in local resources - If hello update increases hello local resources for a role hello Azure platform does not allow rolling back.</span></span>
* <span data-ttu-id="5c841-261">Omezení kvóty – Pokud hello aktualizace byla vertikálně operace, které jste se už nebude mít dostatečný výpočetní kvóty toocomplete hello vrácení zpět.</span><span class="sxs-lookup"><span data-stu-id="5c841-261">Quota limitations - If hello update was a scale down operation you may no longer have sufficient compute quota toocomplete hello rollback operation.</span></span> <span data-ttu-id="5c841-262">Každé předplatné Azure má quota s ním spojená, která určuje maximální počet jader, které mohou být spotřebovávána všechny hostované služby, které patří toothat předplatné hello.</span><span class="sxs-lookup"><span data-stu-id="5c841-262">Each Azure subscription has a quota associated with it that specifies hello maximum number of cores which can be consumed by all hosted services that belong toothat subscription.</span></span> <span data-ttu-id="5c841-263">Je-li provést vrácení dané aktualizace by měla být umístěna vaše předplatné přes kvóty a která nebude povolen vrácení zpět.</span><span class="sxs-lookup"><span data-stu-id="5c841-263">If performing a rollback of a given update would put your subscription over quota then that a rollback will not be enabled.</span></span>
* <span data-ttu-id="5c841-264">Soupeření podmínku – Pokud hello počáteční aktualizace skončila, vrácení zpět. není možné.</span><span class="sxs-lookup"><span data-stu-id="5c841-264">Race condition - If hello initial update has completed, a rollback is not possible.</span></span>

<span data-ttu-id="5c841-265">Je například při vrácení zpět hello aktualizace mohou být užitečné, pokud používáte hello [nasazení upgradu](https://msdn.microsoft.com/library/azure/ee460793.aspx) operace v ručním režimu toocontrol hello rychlost, jakou hlavní místní upgrade tooyour Azure hostovaná služba se nasazuje.</span><span class="sxs-lookup"><span data-stu-id="5c841-265">An example of when hello rollback of an update might be useful is if you are using hello [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx) operation in manual mode toocontrol hello rate at which a major in-place upgrade tooyour Azure hosted service is rolled out.</span></span>

<span data-ttu-id="5c841-266">Při zavedení hello hello upgradu zavoláte [nasazení upgradu](https://msdn.microsoft.com/library/azure/ee460793.aspx) v ručním režimu a začít toowalk upgradovacích domén.</span><span class="sxs-lookup"><span data-stu-id="5c841-266">During hello rollout of hello upgrade you call [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx) in manual mode and begin toowalk upgrade domains.</span></span> <span data-ttu-id="5c841-267">Pokud v určitém okamžiku při sledování hello upgradu můžete Všimněte si některé instancí rolí ve hello první upgradu domén, které byste zkontrolovat mít přestat reagovat, můžete zavolat hello [vrácení zpět aktualizace nebo upgradu](https://msdn.microsoft.com/library/azure/hh403977.aspx) operace na hello nasazení, který ponechá nezměněný hello instance, které nebyly dosud nebyly upgradovány a vrácení instance, které je upgradovat toohello předchozí balíček služby a konfiguraci.</span><span class="sxs-lookup"><span data-stu-id="5c841-267">If at some point, as you monitor hello upgrade, you note some role instances in hello first upgrade domains that you examine have become unresponsive, you can call hello [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx) operation on hello deployment, which will leave untouched hello instances which had not yet been upgraded and rollback instances which had been upgraded toohello previous service package and configuration.</span></span>

<a name="multiplemutatingoperations"></a>

## <a name="initiating-multiple-mutating-operations-on-an-ongoing-deployment"></a><span data-ttu-id="5c841-268">Spouštění více mutating operací na probíhající nasazení</span><span class="sxs-lookup"><span data-stu-id="5c841-268">Initiating multiple mutating operations on an ongoing deployment</span></span>
<span data-ttu-id="5c841-269">V některých případech může být vhodné tooinitiate více souběžných mutating operací na probíhající nasazení.</span><span class="sxs-lookup"><span data-stu-id="5c841-269">In some cases you may want tooinitiate multiple simultaneous mutating operations on an ongoing deployment.</span></span> <span data-ttu-id="5c841-270">Například může provádět aktualizace služby a během této aktualizace je se nasazuje přes služby, chcete toomake některé změny, například tooroll hello aktualizace zpět, použít jinou aktualizaci nebo odstranění i hello nasazení.</span><span class="sxs-lookup"><span data-stu-id="5c841-270">For example, you may perform a service update and, while that update is being rolled out across your service, you want toomake some change, e.g. tooroll hello update back, apply a different update, or even delete hello deployment.</span></span> <span data-ttu-id="5c841-271">Případ, kdy to může být potřeba je, zda aktualizace služby obsahuje buggy kódu, což způsobí, že při selhání instance toorepeatedly upgradovaná role.</span><span class="sxs-lookup"><span data-stu-id="5c841-271">A case in which this might be necessary is if a service upgrade contains buggy code which causes an upgraded role instance toorepeatedly crash.</span></span> <span data-ttu-id="5c841-272">V takovém případě hello Kontroleru prostředků infrastruktury Azure nebude moct toomake průběh v použití, který upgradovat, protože jsou v pořádku dostatečný počet instancí v upgradované domény hello.</span><span class="sxs-lookup"><span data-stu-id="5c841-272">In this case, hello Azure Fabric Controller will not be able toomake progress in applying that upgrade because an insufficient number of instances in hello upgraded domain are healthy.</span></span> <span data-ttu-id="5c841-273">Tento stav se označují tooas *zablokované nasazení*.</span><span class="sxs-lookup"><span data-stu-id="5c841-273">This state is referred tooas a *stuck deployment*.</span></span> <span data-ttu-id="5c841-274">Vrácení zpět hello aktualizace nebo novou aktualizaci v horní části hello selhání jeden můžete unstick hello nasazení.</span><span class="sxs-lookup"><span data-stu-id="5c841-274">You can unstick hello deployment by rolling back hello update or applying a fresh update over top of hello failing one.</span></span>

<span data-ttu-id="5c841-275">Jakmile hello prvotní žádost tooupdate nebo upgradu hello service obdržel hello Kontroleru prostředků infrastruktury Azure, můžete začít následných mutace operací.</span><span class="sxs-lookup"><span data-stu-id="5c841-275">Once hello initial request tooupdate or upgrade hello service has been received by hello Azure Fabric Controller, you can start subsequent mutating operations.</span></span> <span data-ttu-id="5c841-276">To znamená, že nemáte toowait pro počáteční operaci toocomplete hello před zahájením mutating jiná operace.</span><span class="sxs-lookup"><span data-stu-id="5c841-276">That is, you do not have toowait for hello initial operation toocomplete before you can start another mutating operation.</span></span>

<span data-ttu-id="5c841-277">Inicializace druhá operace aktualizace během probíhající aktualizace první hello provede operaci vrácení zpět podobné toohello.</span><span class="sxs-lookup"><span data-stu-id="5c841-277">Initiating a second update operation while hello first update is ongoing will perform similar toohello rollback operation.</span></span> <span data-ttu-id="5c841-278">Pokud je druhý aktualizace hello v automatickém režimu, první doména upgradu hello upgraduje okamžitě, by mohl vést tooinstances z několika domén upgradu offline v hello stejné bodu v čase.</span><span class="sxs-lookup"><span data-stu-id="5c841-278">If hello second update is in automatic mode, hello first upgrade domain will be upgraded immediately, possibly leading tooinstances from multiple upgrade domains being offline at hello same point in time.</span></span>

<span data-ttu-id="5c841-279">Hello mutace operace jsou následujícím způsobem: [změna konfigurace nasazení](https://msdn.microsoft.com/library/azure/ee460809.aspx), [nasazení upgradu](https://msdn.microsoft.com/library/azure/ee460793.aspx), [stav nasazení aktualizace](https://msdn.microsoft.com/library/azure/ee460808.aspx), [odstranit Nasazení](https://msdn.microsoft.com/library/azure/ee460815.aspx), a [vrácení aktualizaci nebo upgradu](https://msdn.microsoft.com/library/azure/hh403977.aspx).</span><span class="sxs-lookup"><span data-stu-id="5c841-279">hello mutating operations are as follows: [Change Deployment Configuration](https://msdn.microsoft.com/library/azure/ee460809.aspx), [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx), [Update Deployment Status](https://msdn.microsoft.com/library/azure/ee460808.aspx), [Delete Deployment](https://msdn.microsoft.com/library/azure/ee460815.aspx), and [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx).</span></span>

<span data-ttu-id="5c841-280">Dvě operace [získat nasazení](https://msdn.microsoft.com/library/azure/ee460804.aspx) a [získat vlastnosti cloudové služby](https://msdn.microsoft.com/library/azure/ee460806.aspx), vrátí hello uzamčen příznak, který může být toodetermine zkontrolován, zda mutating operace může být volána v zadaném nasazení.</span><span class="sxs-lookup"><span data-stu-id="5c841-280">Two operations, [Get Deployment](https://msdn.microsoft.com/library/azure/ee460804.aspx) and [Get Cloud Service Properties](https://msdn.microsoft.com/library/azure/ee460806.aspx), return hello Locked flag which can be examined toodetermine whether a mutating operation can be invoked on a given deployment.</span></span>

<span data-ttu-id="5c841-281">V pořadí toocall hello verze těchto metod, která vrátí hodnotu hello uzamčen příznak, musíte nastavit hlavička požadavku příliš "x-ms-version: 2011-10-01" nebo pozdější.</span><span class="sxs-lookup"><span data-stu-id="5c841-281">In order toocall hello version of these methods which returns hello Locked flag, you must set request header too“x-ms-version: 2011-10-01” or a later.</span></span> <span data-ttu-id="5c841-282">Další informace o hlavičkách verze najdete v tématu [Správa služby správy verzí](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span><span class="sxs-lookup"><span data-stu-id="5c841-282">For more information about versioning headers, see [Service Management Versioning](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span></span>

<a name="distributiondfroles"></a>

## <a name="distribution-of-roles-across-upgrade-domains"></a><span data-ttu-id="5c841-283">Distribuce rolí napříč doménami upgradu</span><span class="sxs-lookup"><span data-stu-id="5c841-283">Distribution of roles across upgrade domains</span></span>
<span data-ttu-id="5c841-284">Instance role Azure rovnoměrně distribuuje mezi se stanoveným počtem upgradovacích domén, které lze konfigurovat jako součást souboru definice (.csdef) služby hello.</span><span class="sxs-lookup"><span data-stu-id="5c841-284">Azure distributes instances of a role evenly across a set number of upgrade domains, which can be configured as part of hello service definition (.csdef) file.</span></span> <span data-ttu-id="5c841-285">maximální počet domén upgradu Hello je 20 a hello výchozí hodnota je 5.</span><span class="sxs-lookup"><span data-stu-id="5c841-285">hello max number of upgrade domains is 20 and hello default is 5.</span></span> <span data-ttu-id="5c841-286">Další informace o tom, jak toomodify hello souboru definice služby najdete v tématu [Azure schématu definice služby (.csdef souboru)](cloud-services-model-and-package.md#csdef).</span><span class="sxs-lookup"><span data-stu-id="5c841-286">For more information about how toomodify hello service definition file, see [Azure Service Definition Schema (.csdef File)](cloud-services-model-and-package.md#csdef).</span></span>

<span data-ttu-id="5c841-287">Například pokud vaše role má deset instancí, ve výchozím nastavení každé upgradované domény obsahuje dvě instance.</span><span class="sxs-lookup"><span data-stu-id="5c841-287">For example, if your role has ten instances, by default each upgrade domain contains two instances.</span></span> <span data-ttu-id="5c841-288">Pokud vaše role má 14 instancí, potom čtyři domén upgradu hello obsahovat tři instance a páté domény obsahuje dva.</span><span class="sxs-lookup"><span data-stu-id="5c841-288">If your role has 14 instances, then four of hello upgrade domains contain three instances, and a fifth domain contains two.</span></span>

<span data-ttu-id="5c841-289">Domén upgradu jsou označeny index počítaný od nuly: první doména upgradu hello má ID 0, a druhá doména upgradu hello ID 1 a tak dále.</span><span class="sxs-lookup"><span data-stu-id="5c841-289">Upgrade domains are identified with a zero-based index: hello first upgrade domain has an ID of 0, and hello second upgrade domain has an ID of 1, and so on.</span></span>

<span data-ttu-id="5c841-290">Hello následující diagram znázorňuje rozdělení služby než obsahuje dvě role při hello služby definuje dvě domény upgradu.</span><span class="sxs-lookup"><span data-stu-id="5c841-290">hello following diagram illustrates how a service than contains two roles are distributed when hello service defines two upgrade domains.</span></span> <span data-ttu-id="5c841-291">osm instancí hello webovou roli a devět instancí role pracovního procesu hello je spuštěna služba Hello.</span><span class="sxs-lookup"><span data-stu-id="5c841-291">hello service is running eight instances of hello web role and nine instances of hello worker role.</span></span>

<span data-ttu-id="5c841-292">![Distribuce domén upgradu](media/cloud-services-update-azure-service/IC345533.png "distribuce domén upgradu")</span><span class="sxs-lookup"><span data-stu-id="5c841-292">![Distribution of Upgrade Domains](media/cloud-services-update-azure-service/IC345533.png "Distribution of Upgrade Domains")</span></span>

> [!NOTE]
> <span data-ttu-id="5c841-293">Všimněte si, že Azure řídit přidělování instancí napříč doménami upgradu.</span><span class="sxs-lookup"><span data-stu-id="5c841-293">Note that Azure controls how instances are allocated across upgrade domains.</span></span> <span data-ttu-id="5c841-294">Není možné toospecify instancí, které jsou přiděleny toowhich domény.</span><span class="sxs-lookup"><span data-stu-id="5c841-294">It's not possible toospecify which instances are allocated toowhich domain.</span></span>
>
>

## <a name="next-steps"></a><span data-ttu-id="5c841-295">Další kroky</span><span class="sxs-lookup"><span data-stu-id="5c841-295">Next steps</span></span>
[<span data-ttu-id="5c841-296">Jak tooManage cloudových služeb</span><span class="sxs-lookup"><span data-stu-id="5c841-296">How tooManage Cloud Services</span></span>](cloud-services-how-to-manage.md)  
[<span data-ttu-id="5c841-297">Jak tooMonitor cloudových služeb</span><span class="sxs-lookup"><span data-stu-id="5c841-297">How tooMonitor Cloud Services</span></span>](cloud-services-how-to-monitor.md)  
[<span data-ttu-id="5c841-298">Jak tooConfigure cloudových služeb</span><span class="sxs-lookup"><span data-stu-id="5c841-298">How tooConfigure Cloud Services</span></span>](cloud-services-how-to-configure.md)  
