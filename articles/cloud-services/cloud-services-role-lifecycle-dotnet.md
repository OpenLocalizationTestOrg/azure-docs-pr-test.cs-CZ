---
title: "události životního cyklu Cloudová služba aaaHandle | Microsoft Docs"
description: "Zjistěte, jak lze použít metody životního cyklu hello Cloudová služba role v rozhraní .NET"
services: cloud-services
documentationcenter: .net
author: Thraka
manager: timlt
editor: 
ms.assetid: 39b30acd-57b9-48b7-a7c4-40ea3430e451
ms.service: cloud-services
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/18/2017
ms.author: adegeo
ms.openlocfilehash: cc0ccc5f055b965202b6e081a6ab72ad5d39b034
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="customize-hello-lifecycle-of-a-web-or-worker-role-in-net"></a><span data-ttu-id="16d75-103">Přizpůsobení hello životního cyklu Web nebo Worker role v rozhraní .NET</span><span class="sxs-lookup"><span data-stu-id="16d75-103">Customize hello Lifecycle of a Web or Worker role in .NET</span></span>
<span data-ttu-id="16d75-104">Když vytvoříte roli pracovního procesu, můžete rozšířit hello [RoleEntryPoint](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.aspx) třída, která poskytuje metody pro vás toooverride, který vám umožní reagovat toolifecycle události.</span><span class="sxs-lookup"><span data-stu-id="16d75-104">When you create a worker role, you extend hello [RoleEntryPoint](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.aspx) class which provides methods for you toooverride that let you respond toolifecycle events.</span></span> <span data-ttu-id="16d75-105">Pro webové role Tato třída je volitelné, takže je nutné ji toorespond toolifecycle události.</span><span class="sxs-lookup"><span data-stu-id="16d75-105">For web roles this class is optional, so you must use it toorespond toolifecycle events.</span></span>

## <a name="extend-hello-roleentrypoint-class"></a><span data-ttu-id="16d75-106">Rozšíření třídy RoleEntryPoint hello</span><span class="sxs-lookup"><span data-stu-id="16d75-106">Extend hello RoleEntryPoint class</span></span>
<span data-ttu-id="16d75-107">Hello [RoleEntryPoint](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.aspx) třída obsahuje metody, které se nazývají Azure při jeho **spustí**, **spouští**, nebo **zastaví** roli web nebo worker.</span><span class="sxs-lookup"><span data-stu-id="16d75-107">hello [RoleEntryPoint](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.aspx) class includes methods that are called by Azure when it **starts**, **runs**, or **stops** a web or worker role.</span></span> <span data-ttu-id="16d75-108">Volitelně můžete přepsat tyto metody toomanage role inicializace, role vypnutí pořadí nebo hello prováděcí vlákno hello role.</span><span class="sxs-lookup"><span data-stu-id="16d75-108">You can optionally override these methods toomanage role initialization, role shutdown sequences, or hello execution thread of hello role.</span></span> 

<span data-ttu-id="16d75-109">Při rozšiřování **RoleEntryPoint**, byste měli být vědomi následujících chování metod hello hello:</span><span class="sxs-lookup"><span data-stu-id="16d75-109">When extending **RoleEntryPoint**, you should be aware of hello following behaviors of hello methods:</span></span>

* <span data-ttu-id="16d75-110">Hello [OnStart](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.onstart.aspx) a [OnStop](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.onstop.aspx) metody vrátit logickou hodnotu, takže je možné tooreturn **false** z těchto metod.</span><span class="sxs-lookup"><span data-stu-id="16d75-110">hello [OnStart](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.onstart.aspx) and [OnStop](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.onstop.aspx) methods return a boolean value, so it is possible tooreturn **false** from these methods.</span></span>
  
   <span data-ttu-id="16d75-111">Pokud váš kód vrátí **false**neočekávaného ukončení procesu hello role, bez spuštění jakékoli pořadí vypnutí můžete mít na místě.</span><span class="sxs-lookup"><span data-stu-id="16d75-111">If your code returns **false**, hello role process is abruptly terminated, without running any shutdown sequence you may have in place.</span></span> <span data-ttu-id="16d75-112">Obecně platí, neměli byste vrácení **false** z hello **OnStart** metoda.</span><span class="sxs-lookup"><span data-stu-id="16d75-112">In general, you should avoid returning **false** from hello **OnStart** method.</span></span>
* <span data-ttu-id="16d75-113">Žádné nezachycená v rámci přetížení **RoleEntryPoint** metoda je považován za k neošetřené výjimce.</span><span class="sxs-lookup"><span data-stu-id="16d75-113">Any uncaught exception within an overload of a **RoleEntryPoint** method is treated as an unhandled exception.</span></span>
  
   <span data-ttu-id="16d75-114">Pokud dojde k výjimce v rámci jedné z metod hello životního cyklu, Azure vyvolá hello [UnhandledException](https://msdn.microsoft.com/library/system.appdomain.unhandledexception.aspx) události, a pak hello proces bude ukončen.</span><span class="sxs-lookup"><span data-stu-id="16d75-114">If an exception occurs within one of hello lifecycle methods, Azure will raise hello [UnhandledException](https://msdn.microsoft.com/library/system.appdomain.unhandledexception.aspx) event, and then hello process is terminated.</span></span> <span data-ttu-id="16d75-115">Po vaše role je v režimu offline, se restartuje v Azure.</span><span class="sxs-lookup"><span data-stu-id="16d75-115">After your role has been taken offline, it will be restarted by Azure.</span></span> <span data-ttu-id="16d75-116">Když dojde k neošetřené výjimce, hello [zastavení](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleenvironment.stopping.aspx) událostí není vyvolána a hello **OnStop** metoda není volána.</span><span class="sxs-lookup"><span data-stu-id="16d75-116">When an unhandled exception occurs, hello [Stopping](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleenvironment.stopping.aspx) event is not raised, and hello **OnStop** method is not called.</span></span>

<span data-ttu-id="16d75-117">Pokud vaše role se nespustí, nebo je recyklace mezi hello inicializace zaneprázdněn a ukončení stav, může váš kód vyvolání k neošetřené výjimce v rámci jedné události životního cyklu hello, každou roli hello čas se restartuje.</span><span class="sxs-lookup"><span data-stu-id="16d75-117">If your role does not start, or is recycling between hello initializing, busy, and stopping states, your code may be throwing an unhandled exception within one of hello lifecycle events each time hello role restarts.</span></span> <span data-ttu-id="16d75-118">V takovém případě použijte hello [UnhandledException](https://msdn.microsoft.com/library/system.appdomain.unhandledexception.aspx) událostí toodetermine hello příčinou hello výjimky a správně zpracovat.</span><span class="sxs-lookup"><span data-stu-id="16d75-118">In this case, use hello [UnhandledException](https://msdn.microsoft.com/library/system.appdomain.unhandledexception.aspx) event toodetermine hello cause of hello exception and handle it appropriately.</span></span> <span data-ttu-id="16d75-119">Vaše role může být také vrácení z hello [spustit](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.run.aspx) metoda, což způsobí, že hello role toorestart.</span><span class="sxs-lookup"><span data-stu-id="16d75-119">Your role may also be returning from hello [Run](https://msdn.microsoft.com/library/azure/microsoft.windowsazure.serviceruntime.roleentrypoint.run.aspx) method, which causes hello role toorestart.</span></span> <span data-ttu-id="16d75-120">Další informace o stavy nasazení najdete v tématu [běžné problémy které příčina role tooRecycle](cloud-services-troubleshoot-common-issues-which-cause-roles-recycle.md).</span><span class="sxs-lookup"><span data-stu-id="16d75-120">For more information about deployment states, see [Common Issues Which Cause Roles tooRecycle](cloud-services-troubleshoot-common-issues-which-cause-roles-recycle.md).</span></span>

> [!NOTE]
> <span data-ttu-id="16d75-121">Pokud používáte hello **nástroje Azure pro sadu Microsoft Visual Studio** toodevelop vaší aplikace, šablony projektů hello role automaticky rozšířit hello **RoleEntryPoint** třídy, v hello *WebRole.cs* a *WorkerRole.cs* soubory.</span><span class="sxs-lookup"><span data-stu-id="16d75-121">If you are using hello **Azure Tools for Microsoft Visual Studio** toodevelop your application, hello role project templates automatically extend hello **RoleEntryPoint** class for you, in hello *WebRole.cs* and *WorkerRole.cs* files.</span></span>
> 
> 

## <a name="onstart-method"></a><span data-ttu-id="16d75-122">OnStart – metoda</span><span class="sxs-lookup"><span data-stu-id="16d75-122">OnStart method</span></span>
<span data-ttu-id="16d75-123">Hello **OnStart** metoda je volána, když vaše instance role do online režimu Azure.</span><span class="sxs-lookup"><span data-stu-id="16d75-123">hello **OnStart** method is called when your role instance is brought online by Azure.</span></span> <span data-ttu-id="16d75-124">Při spouštění hello OnStart kód hello role instance je označena jako **zaneprázdněn** a žádné externí přenosy budou směrovanou tooit nástroj pro vyrovnávání zatížení hello.</span><span class="sxs-lookup"><span data-stu-id="16d75-124">While hello OnStart code is executing, hello role instance is marked as **Busy** and no external traffic will be directed tooit by hello load balancer.</span></span> <span data-ttu-id="16d75-125">Tato metoda tooperform inicializace práce, například implementace obslužné rutiny událostí a spuštění můžete přepsat [Azure Diagnostics](cloud-services-how-to-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="16d75-125">You can override this method tooperform initialization work, such as implementing event handlers and starting [Azure Diagnostics](cloud-services-how-to-monitor.md).</span></span>

<span data-ttu-id="16d75-126">Pokud **OnStart** vrátí **true**, hello instance je úspěšně inicializován a Azure volá hello **RoleEntryPoint.Run** metoda.</span><span class="sxs-lookup"><span data-stu-id="16d75-126">If **OnStart** returns **true**, hello instance is successfully initialized and Azure calls hello **RoleEntryPoint.Run** method.</span></span> <span data-ttu-id="16d75-127">Pokud **OnStart** vrátí **false**, hello role ukončí okamžitě, bez spuštění jakýchkoli pořadí plánované vypnutí.</span><span class="sxs-lookup"><span data-stu-id="16d75-127">If **OnStart** returns **false**, hello role terminates immediately, without executing any planned shutdown sequences.</span></span>

<span data-ttu-id="16d75-128">Následující příklad ukazuje kód jak Hello toooverride hello **OnStart** metoda.</span><span class="sxs-lookup"><span data-stu-id="16d75-128">hello following code example shows how toooverride hello **OnStart** method.</span></span> <span data-ttu-id="16d75-129">Tato metoda nakonfiguruje a spustí monitorování diagnostiky, když hello role instance spustí a nastaví přenos protokolování účet úložiště tooa dat:</span><span class="sxs-lookup"><span data-stu-id="16d75-129">This method configures and starts a diagnostic monitor when hello role instance starts and sets up a transfer of logging data tooa storage account:</span></span>

```csharp
public override bool OnStart()
{
    var config = DiagnosticMonitor.GetDefaultInitialConfiguration();

    config.DiagnosticInfrastructureLogs.ScheduledTransferLogLevelFilter = LogLevel.Error;
    config.DiagnosticInfrastructureLogs.ScheduledTransferPeriod = TimeSpan.FromMinutes(5);

    DiagnosticMonitor.Start("DiagnosticsConnectionString", config);

    return true;
}
```

## <a name="onstop-method"></a><span data-ttu-id="16d75-130">Onstop – metoda</span><span class="sxs-lookup"><span data-stu-id="16d75-130">OnStop method</span></span>
<span data-ttu-id="16d75-131">Hello **OnStop** metoda je volána po instanci role je v režimu offline v Azure a před k ukončení procesu hello.</span><span class="sxs-lookup"><span data-stu-id="16d75-131">hello **OnStop** method is called after a role instance has been taken offline by Azure and before hello process exits.</span></span> <span data-ttu-id="16d75-132">Tato metoda toocall kódu vyžadovaného pro vaše toocleanly instance role vypnout můžete přepsat.</span><span class="sxs-lookup"><span data-stu-id="16d75-132">You can override this method toocall code required for your role instance toocleanly shut down.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="16d75-133">Kód spuštěný v hello **OnStop** metoda má toofinish omezenou dobu, když je volána z jiných důvodů než vypnutí spuštěné uživatelem.</span><span class="sxs-lookup"><span data-stu-id="16d75-133">Code running in hello **OnStop** method has a limited time toofinish when it is called for reasons other than a user-initiated shutdown.</span></span> <span data-ttu-id="16d75-134">Po uplynutí této doby, hello ukončení procesu, takže je nutné nejprve tento kód v hello **OnStop** metoda lze rychle spustit nebo toleruje toocompletion není spuštěna.</span><span class="sxs-lookup"><span data-stu-id="16d75-134">After this time elapses, hello process is terminated, so you must make sure that code in hello **OnStop** method can run quickly or tolerates not running toocompletion.</span></span> <span data-ttu-id="16d75-135">Hello **OnStop** metoda je volána po hello **zastavení** událost se vyvolá.</span><span class="sxs-lookup"><span data-stu-id="16d75-135">hello **OnStop** method is called after hello **Stopping** event is raised.</span></span>
> 
> 

## <a name="run-method"></a><span data-ttu-id="16d75-136">Run – metoda</span><span class="sxs-lookup"><span data-stu-id="16d75-136">Run method</span></span>
<span data-ttu-id="16d75-137">Můžete přepsat hello **spustit** metoda tooimplement dlouho spuštěných vláken pro instanci role.</span><span class="sxs-lookup"><span data-stu-id="16d75-137">You can override hello **Run** method tooimplement a long-running thread for your role instance.</span></span>

<span data-ttu-id="16d75-138">Přepsání hello **spustit** metoda není vyžadováno; hello výchozí implementace spustí vlákno, které uspí navždy.</span><span class="sxs-lookup"><span data-stu-id="16d75-138">Overriding hello **Run** method is not required; hello default implementation starts a thread that sleeps forever.</span></span> <span data-ttu-id="16d75-139">Pokud přepíšete hello **spustit** metoda, váš kód by měl blokovat po neomezenou dobu.</span><span class="sxs-lookup"><span data-stu-id="16d75-139">If you do override hello **Run** method, your code should block indefinitely.</span></span> <span data-ttu-id="16d75-140">Pokud hello **spustit** metoda vrací výsledek, hello role je automaticky řádně recykluje; jinými slovy, vyvolá Azure hello **zastavení** událostí a volání hello **OnStop** metoda tak aby vaše vypnutí pořadí může být spuštěna před hello role do režimu offline.</span><span class="sxs-lookup"><span data-stu-id="16d75-140">If hello **Run** method returns, hello role is automatically gracefully recycled; in other words, Azure raises hello **Stopping** event and calls hello **OnStop** method so that your shutdown sequences may be executed before hello role is taken offline.</span></span>

### <a name="implementing-hello-aspnet-lifecycle-methods-for-a-web-role"></a><span data-ttu-id="16d75-141">Implementace metody životního cyklu hello ASP.NET pro webové role</span><span class="sxs-lookup"><span data-stu-id="16d75-141">Implementing hello ASP.NET lifecycle methods for a web role</span></span>
<span data-ttu-id="16d75-142">Můžete použít metody životního cyklu ASP.NET hello, kromě toothose poskytované hello **RoleEntryPoint** třídy toomanage inicializace a vypnutí pořadí pro webové role.</span><span class="sxs-lookup"><span data-stu-id="16d75-142">You can use hello ASP.NET lifecycle methods, in addition toothose provided by hello **RoleEntryPoint** class, toomanage initialization and shutdown sequences for a web role.</span></span> <span data-ttu-id="16d75-143">To může být užitečná pro účely kompatibility, pokud jsou portování existující aplikaci tooAzure ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="16d75-143">This may be useful for compatibility purposes if you are porting an existing ASP.NET application tooAzure.</span></span> <span data-ttu-id="16d75-144">metody životního cyklu ASP.NET Hello se volat v rámci hello **RoleEntryPoint** metody.</span><span class="sxs-lookup"><span data-stu-id="16d75-144">hello ASP.NET lifecycle methods are called from within hello **RoleEntryPoint** methods.</span></span> <span data-ttu-id="16d75-145">Hello **aplikace\_spustit** metoda je volána po hello **RoleEntryPoint.OnStart** Metoda dokončení.</span><span class="sxs-lookup"><span data-stu-id="16d75-145">hello **Application\_Start** method is called after hello **RoleEntryPoint.OnStart** method finishes.</span></span> <span data-ttu-id="16d75-146">Hello **aplikace\_End** metoda je volána před provedením hello **RoleEntryPoint.OnStop** metoda je volána.</span><span class="sxs-lookup"><span data-stu-id="16d75-146">hello **Application\_End** method is called before hello **RoleEntryPoint.OnStop** method is called.</span></span>

## <a name="next-steps"></a><span data-ttu-id="16d75-147">Další kroky</span><span class="sxs-lookup"><span data-stu-id="16d75-147">Next steps</span></span>
<span data-ttu-id="16d75-148">Zjistěte, jak příliš[vytvořit balíček služby cloud](cloud-services-model-and-package.md).</span><span class="sxs-lookup"><span data-stu-id="16d75-148">Learn how too[create a cloud service package](cloud-services-model-and-package.md).</span></span>

