---
title: "Azure Active Directory Domain Services: Povolení vynuceného delegování protokolu kerberos | Microsoft Docs"
description: "Povolení vynuceného delegování protokolu kerberos na spravované domény Azure Active Directory Domain Services"
services: active-directory-ds
documentationcenter: 
author: mahesh-unnikrishnan
manager: stevenpo
editor: curtand
ms.assetid: 938a5fbc-2dd1-4759-bcce-628a6e19ab9d
ms.service: active-directory-ds
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 03/06/2017
ms.author: maheshu
ms.openlocfilehash: f36f16a7bb00ace9fd5164eb38ba77f015f22f5c
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 07/11/2017
---
# <a name="configure-kerberos-constrained-delegation-kcd-on-a-managed-domain"></a><span data-ttu-id="79c84-103">Nakonfigurujte omezené delegování protokolu kerberos (použitím KCD) na spravované doméně</span><span class="sxs-lookup"><span data-stu-id="79c84-103">Configure kerberos constrained delegation (KCD) on a managed domain</span></span>
<span data-ttu-id="79c84-104">Mnoho aplikací potřebovat přístup k prostředkům v kontextu uživatele.</span><span class="sxs-lookup"><span data-stu-id="79c84-104">Many applications need to access resources in the context of the user.</span></span> <span data-ttu-id="79c84-105">Služba Active Directory podporuje mechanismus delegování protokolu Kerberos, která umožňuje tento případ použití volat.</span><span class="sxs-lookup"><span data-stu-id="79c84-105">Active Directory supports a mechanism called Kerberos delegation, which enables this use-case.</span></span> <span data-ttu-id="79c84-106">Navíc můžete omezit delegování tak, aby se dalo přistupovat pouze konkrétní prostředky v kontextu uživatele.</span><span class="sxs-lookup"><span data-stu-id="79c84-106">Further, you can restrict delegation so that only specific resources can be accessed in the context of the user.</span></span> <span data-ttu-id="79c84-107">Spravované domény služby Azure AD Domain Services se liší od tradiční domén služby Active Directory, vzhledem k tomu, že jsou zamčené bezpečněji dolů.</span><span class="sxs-lookup"><span data-stu-id="79c84-107">Azure AD Domain Services managed domains are different from traditional Active Directory domains since they are more securely locked down.</span></span>

<span data-ttu-id="79c84-108">Tento článek ukazuje, jak nakonfigurovat omezené delegování protokolu kerberos na spravované doméně služby Azure AD Domain Services.</span><span class="sxs-lookup"><span data-stu-id="79c84-108">This article shows you how to configure kerberos constrained delegation on an Azure AD Domain Services managed domain.</span></span>

## <a name="kerberos-constrained-delegation-kcd"></a><span data-ttu-id="79c84-109">Omezené delegování protokolu Kerberos (použitím KCD)</span><span class="sxs-lookup"><span data-stu-id="79c84-109">Kerberos constrained delegation (KCD)</span></span>
<span data-ttu-id="79c84-110">Delegování protokolu Kerberos umožňuje účet zosobnění jiný objekt zabezpečení (například uživatel) pro přístup k prostředkům.</span><span class="sxs-lookup"><span data-stu-id="79c84-110">Kerberos delegation enables an account to impersonate another security principal (such as a user) to access resources.</span></span> <span data-ttu-id="79c84-111">Vezměte v úvahu webové aplikace, který přistupuje k back endové webové rozhraní API v kontextu uživatele.</span><span class="sxs-lookup"><span data-stu-id="79c84-111">Consider a web application that accesses a back-end web API in the context of a user.</span></span> <span data-ttu-id="79c84-112">V tomto příkladu webové aplikace (spuštěn v kontextu účtu služby nebo účet počítače) zosobňuje uživatele při přístupu k prostředku (back endové webové rozhraní API).</span><span class="sxs-lookup"><span data-stu-id="79c84-112">In this example, the web application (running in the context of a service account or a computer/machine account) impersonates the user when accessing the resource (back-end web API).</span></span> <span data-ttu-id="79c84-113">Delegování protokolu Kerberos je nezabezpečené, protože se neomezuje z prostředků, které vydává za jiný účet přístup v kontextu uživatele.</span><span class="sxs-lookup"><span data-stu-id="79c84-113">Kerberos delegation is insecure since it does not restrict the resources the impersonating account can access in the context of the user.</span></span>

<span data-ttu-id="79c84-114">Omezené delegování protokolu Kerberos (použitím KCD) omezuje služby nebo prostředky, ke kterým může zadaný server fungovat jménem uživatele.</span><span class="sxs-lookup"><span data-stu-id="79c84-114">Kerberos constrained delegation (KCD) restricts the services/resources to which the specified server can act on the behalf of a user.</span></span> <span data-ttu-id="79c84-115">Tradiční použitím KCD vyžaduje oprávnění správce domény nakonfigurovat účet domény pro službu a omezuje účet na jedinou doménu.</span><span class="sxs-lookup"><span data-stu-id="79c84-115">Traditional KCD requires domain administrator privileges to configure a domain account for a service and it restricts the account to a single domain.</span></span>

<span data-ttu-id="79c84-116">Tradiční použitím KCD má také několik problémů, které jsou s ním spojená.</span><span class="sxs-lookup"><span data-stu-id="79c84-116">Traditional KCD also has a few issues associated with it.</span></span> <span data-ttu-id="79c84-117">V dřívějších operačních systémech kde správce domény konfiguroval služby neměl Správce služeb nijak užitečné vědět, které front-endové služby delegované na služby prostředků vlastnil.</span><span class="sxs-lookup"><span data-stu-id="79c84-117">In earlier operating systems where the domain administrator configured the service, the service administrator had no useful way to know which front-end services delegated to the resource services they owned.</span></span> <span data-ttu-id="79c84-118">A všechny front-endová služba, která mohla delegovat na službu prostředků reprezentována potenciální místo pro útok.</span><span class="sxs-lookup"><span data-stu-id="79c84-118">And any front-end service that could delegate to a resource service represented a potential attack point.</span></span> <span data-ttu-id="79c84-119">Pokud serveru, který hostoval front-endové služby došlo k ohrožení, a že byl nakonfigurován pro delegoval na služby, služby prostředků může také dojít k ohrožení.</span><span class="sxs-lookup"><span data-stu-id="79c84-119">If a server that hosted a front-end service was compromised, and it was configured to delegate to resource services, the resource services could also be compromised.</span></span>

> [!NOTE]
> <span data-ttu-id="79c84-120">Na spravované doméně služby Azure AD Domain Services nemáte oprávnění správce domény.</span><span class="sxs-lookup"><span data-stu-id="79c84-120">On an Azure AD Domain Services managed domain, you do not have domain administrator privileges.</span></span> <span data-ttu-id="79c84-121">Proto **tradiční použitím KCD nelze konfigurovat ve spravované doméně**.</span><span class="sxs-lookup"><span data-stu-id="79c84-121">Therefore, **traditional KCD cannot be configured on a managed domain**.</span></span> <span data-ttu-id="79c84-122">Použijte použitím KCD založené na prostředcích, jak je popsáno v tomto článku.</span><span class="sxs-lookup"><span data-stu-id="79c84-122">Use resource-based KCD as described in this article.</span></span> <span data-ttu-id="79c84-123">Tento mechanismus je také bezpečnější.</span><span class="sxs-lookup"><span data-stu-id="79c84-123">This mechanism is also more secure.</span></span>
>
>

## <a name="resource-based-kerberos-constrained-delegation"></a><span data-ttu-id="79c84-124">Na základě prostředků omezené delegování protokolu kerberos</span><span class="sxs-lookup"><span data-stu-id="79c84-124">Resource-based kerberos constrained delegation</span></span>
<span data-ttu-id="79c84-125">V systému Windows Server 2012 R2 a Windows Server 2012 umožňuje konfiguraci omezeného delegování pro službu přesunula ze správce domény na správce služeb.</span><span class="sxs-lookup"><span data-stu-id="79c84-125">In Windows Server 2012 R2 and Windows Server 2012, the ability to configure constrained delegation for the service has been transferred from the domain administrator to the service administrator.</span></span> <span data-ttu-id="79c84-126">Správce služeb back-end tímto způsobem můžete povolit nebo odepřít front-endové služby.</span><span class="sxs-lookup"><span data-stu-id="79c84-126">In this way, the back-end service administrator can allow or deny front-end services.</span></span> <span data-ttu-id="79c84-127">Tento model se označuje jako **omezeného delegování kerberos založené na prostředcích**.</span><span class="sxs-lookup"><span data-stu-id="79c84-127">This model is known as **resource-based kerberos constrained delegation**.</span></span>

<span data-ttu-id="79c84-128">Na základě prostředků použitím KCD je nakonfigurován pomocí prostředí PowerShell.</span><span class="sxs-lookup"><span data-stu-id="79c84-128">Resource-based KCD is configured using PowerShell.</span></span> <span data-ttu-id="79c84-129">Můžete použít rutiny Set-ADComputer nebo Set-ADUser v závislosti na tom, zda je účet zosobnění účtu počítače nebo účet služby nebo účet uživatele.</span><span class="sxs-lookup"><span data-stu-id="79c84-129">You use the Set-ADComputer or Set-ADUser cmdlets, depending on whether the impersonating account is a computer account or a user account/service account.</span></span>

### <a name="configure-resource-based-kcd-for-a-computer-account-on-a-managed-domain"></a><span data-ttu-id="79c84-130">Konfigurace založené na prostředcích použitím KCD pro účet počítače na spravované doméně</span><span class="sxs-lookup"><span data-stu-id="79c84-130">Configure resource-based KCD for a computer account on a managed domain</span></span>
<span data-ttu-id="79c84-131">Předpokládejme, máte webovou aplikaci spuštěné v počítači "contoso100-webapp.contoso100.com'.</span><span class="sxs-lookup"><span data-stu-id="79c84-131">Assume you have a web app running on the computer 'contoso100-webapp.contoso100.com'.</span></span> <span data-ttu-id="79c84-132">Potřebuje pro přístup k prostředku (webového rozhraní API systémem "contoso100-api.contoso100.com') v kontextu uživatele domény.</span><span class="sxs-lookup"><span data-stu-id="79c84-132">It needs to access the resource (a web API running on 'contoso100-api.contoso100.com') in the context of domain users.</span></span> <span data-ttu-id="79c84-133">Zde je, jak by nastavit založené na prostředcích použitím KCD pro tento scénář.</span><span class="sxs-lookup"><span data-stu-id="79c84-133">Here's how you would set up resource-based KCD for this scenario.</span></span>

```
$ImpersonatingAccount = Get-ADComputer -Identity contoso100-webapp.contoso100.com
Set-ADComputer contoso100-api.contoso100.com -PrincipalsAllowedToDelegateToAccount $ImpersonatingAccount
```

### <a name="configure-resource-based-kcd-for-a-user-account-on-a-managed-domain"></a><span data-ttu-id="79c84-134">Konfigurace založené na prostředcích použitím KCD pro uživatelský účet na spravované doméně</span><span class="sxs-lookup"><span data-stu-id="79c84-134">Configure resource-based KCD for a user account on a managed domain</span></span>
<span data-ttu-id="79c84-135">Předpokládejme, že máte webové aplikace spuštěna jako účet služby, appsvc' a musí se přístup k prostředku (web API spuštěna jako účet služby - 'backendsvc') v kontextu uživatele domény.</span><span class="sxs-lookup"><span data-stu-id="79c84-135">Assume you have a web app running as a service account 'appsvc' and it needs to access the resource (a web API running as a service account - 'backendsvc') in the context of domain users.</span></span> <span data-ttu-id="79c84-136">Zde je, jak by nastavit založené na prostředcích použitím KCD pro tento scénář.</span><span class="sxs-lookup"><span data-stu-id="79c84-136">Here's how you would set up resource-based KCD for this scenario.</span></span>

```
$ImpersonatingAccount = Get-ADUser -Identity appsvc
Set-ADUser backendsvc -PrincipalsAllowedToDelegateToAccount $ImpersonatingAccount
```

## <a name="related-content"></a><span data-ttu-id="79c84-137">Související obsah</span><span class="sxs-lookup"><span data-stu-id="79c84-137">Related Content</span></span>
* [<span data-ttu-id="79c84-138">Azure AD Domain Services – Příručka Začínáme</span><span class="sxs-lookup"><span data-stu-id="79c84-138">Azure AD Domain Services - Getting Started guide</span></span>](active-directory-ds-getting-started.md)
* [<span data-ttu-id="79c84-139">Omezené delegování přehled protokolu Kerberos</span><span class="sxs-lookup"><span data-stu-id="79c84-139">Kerberos Constrained Delegation Overview</span></span>](https://technet.microsoft.com/library/jj553400.aspx)
