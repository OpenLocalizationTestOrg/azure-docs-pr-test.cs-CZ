---
title: "Kurz služby Azure Analysis Services – Doplňková lekce: Dynamické zabezpečení | Dokumentace Microsoftu"
description: "Popisuje, jak používat dynamické zabezpečení s využitím filtrů řádků v kurzu služby Azure Analysis Services."
services: analysis-services
documentationcenter: 
author: minewiskan
manager: erikre
editor: 
tags: 
ms.assetid: 
ms.service: analysis-services
ms.devlang: NA
ms.topic: get-started-article
ms.tgt_pltfrm: NA
ms.workload: na
ms.date: 05/26/2017
ms.author: owend
ms.openlocfilehash: 4e97a558ae1a2601b5275a73164b483351f03857
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/03/2017
---
# <a name="supplemental-lesson---dynamic-security"></a><span data-ttu-id="11987-103">Doplňková lekce – Dynamické zabezpečení</span><span class="sxs-lookup"><span data-stu-id="11987-103">Supplemental lesson - Dynamic security</span></span>

[!INCLUDE[analysis-services-appliesto-aas-sql2017-later](../../../includes/analysis-services-appliesto-aas-sql2017-later.md)]

<span data-ttu-id="11987-104">V této doplňkové lekci vytvoříte další roli, která implementuje dynamické zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="11987-104">In this supplemental lesson, you create an additional role that implements dynamic security.</span></span> <span data-ttu-id="11987-105">Dynamické zabezpečení zajišťuje zabezpečení na úrovni řádků na základě uživatelského jména a ID přihlášení aktuálně přihlášeného uživatele.</span><span class="sxs-lookup"><span data-stu-id="11987-105">Dynamic security provides row-level security based on the user name or login id of the user currently logged on.</span></span> 
  
<span data-ttu-id="11987-106">Za účelem implementace dynamického zabezpečení přidáte do svého modelu tabulku obsahující uživatelská jména uživatelů, kteří se můžou připojit k modelu a procházet objekty a data modelu.</span><span class="sxs-lookup"><span data-stu-id="11987-106">To implement dynamic security, you add a table to your model containing the user names of those users that can connect to the model and browse model objects and data.</span></span> <span data-ttu-id="11987-107">Model, který pomocí tohoto kurzu vytvoříte, je v kontextu Adventure Works. Pro absolvování tohoto kurzu však budete muset přidat tabulku obsahující uživatele z vaší vlastní domény.</span><span class="sxs-lookup"><span data-stu-id="11987-107">The model you create using this tutorial is in the context of Adventure Works; however, to complete this lesson, you must add a table containing users from your own domain.</span></span> <span data-ttu-id="11987-108">Pro přidaná uživatelská jména nepotřebujete hesla.</span><span class="sxs-lookup"><span data-stu-id="11987-108">You do not need the passwords for the user names that are added.</span></span> <span data-ttu-id="11987-109">K vytvoření tabulky EmployeeSecurity s malým vzorkem uživatelů z vaší vlastní domény použijete funkci Vložit, pomocí které vložíte data zaměstnanců z tabulky aplikace Excel.</span><span class="sxs-lookup"><span data-stu-id="11987-109">To create an EmployeeSecurity table, with a small sample of users from your own domain, you use the Paste feature, pasting employee data from an Excel spreadsheet.</span></span> <span data-ttu-id="11987-110">V reálném scénáři by tabulka obsahující uživatelská jména obvykle byla tabulka ze skutečné databáze jako zdroje dat, například skutečná tabulka DimEmployee.</span><span class="sxs-lookup"><span data-stu-id="11987-110">In a real-world scenario, the table containing user names would typically be a table from an actual database as a data source; for example, a real DimEmployee table.</span></span>  
  
<span data-ttu-id="11987-111">K implementaci dynamického zabezpečení použijete dvě funkce DAX: [funkci USERNAME (DAX)](http://msdn.microsoft.com/22dddc4b-1648-4c89-8c93-f1151162b93f) a [funkci LOOKUPVALUE (DAX)](http://msdn.microsoft.com/73a51c4d-131c-4c33-a139-b1342d10caab).</span><span class="sxs-lookup"><span data-stu-id="11987-111">To implement dynamic security, you use two DAX functions: [USERNAME Function (DAX)](http://msdn.microsoft.com/22dddc4b-1648-4c89-8c93-f1151162b93f) and [LOOKUPVALUE Function (DAX)](http://msdn.microsoft.com/73a51c4d-131c-4c33-a139-b1342d10caab).</span></span> <span data-ttu-id="11987-112">Tyto funkce použité ve vzorci filtru řádků jsou definované v nové roli.</span><span class="sxs-lookup"><span data-stu-id="11987-112">These functions, applied in a row filter formula, are defined in a new role.</span></span> <span data-ttu-id="11987-113">Pomocí funkce LOOKUPVALUE vzorec určuje hodnotu z tabulky EmployeeSecurity.</span><span class="sxs-lookup"><span data-stu-id="11987-113">By using the LOOKUPVALUE function, the formula specifies a value from the EmployeeSecurity table.</span></span> <span data-ttu-id="11987-114">Vzorec pak tuto hodnotu předá do funkce USERNAME, která určí, jestli uživatelské jméno přihlášeného uživatele patří do této role.</span><span class="sxs-lookup"><span data-stu-id="11987-114">The formula then passes that value to the USERNAME function, which specifies the user name of the user logged on belongs to this role.</span></span> <span data-ttu-id="11987-115">Uživatel pak může procházet pouze data určená filtrem řádků role.</span><span class="sxs-lookup"><span data-stu-id="11987-115">The user can then browse only data specified by the role’s row filters.</span></span> <span data-ttu-id="11987-116">V tomto scénáři určíte, že zaměstnanci prodeje můžou procházet pouze data o internetovém prodeji pro prodejní oblasti, ve kterých jsou členem.</span><span class="sxs-lookup"><span data-stu-id="11987-116">In this scenario, you specify that sales employees can only browse Internet sales data for the sales territories in which they are a member.</span></span>  
  
<span data-ttu-id="11987-117">Úkoly specifické pro tento scénář tabelárního modelu Adventure Works, které se ale nutně netýkají reálného scénáře, jsou jako takové označeny.</span><span class="sxs-lookup"><span data-stu-id="11987-117">Those tasks that are unique to this Adventure Works tabular model scenario, but would not necessarily apply to a real-world scenario are identified as such.</span></span> <span data-ttu-id="11987-118">Každý úkol obsahuje další informace s popisem účelu daného úkolu.</span><span class="sxs-lookup"><span data-stu-id="11987-118">Each task includes additional information describing the purpose of the task.</span></span>  
  
<span data-ttu-id="11987-119">Odhadovaný čas dokončení této lekce: **30 minut**</span><span class="sxs-lookup"><span data-stu-id="11987-119">Estimated time to complete this lesson: **30 minutes**</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="11987-120">Požadavky</span><span class="sxs-lookup"><span data-stu-id="11987-120">Prerequisites</span></span>  
<span data-ttu-id="11987-121">Toto téma doplňkové lekce je součástí kurzu tabelárního modelování, který by se měl dokončit v daném pořadí.</span><span class="sxs-lookup"><span data-stu-id="11987-121">This supplemental lesson topic is part of a tabular modeling tutorial, which should be completed in order.</span></span> <span data-ttu-id="11987-122">Před provedením úkolů v této doplňkové lekci byste měli mít dokončeny všechny předchozí lekce.</span><span class="sxs-lookup"><span data-stu-id="11987-122">Before performing the tasks in this supplemental lesson, you should have completed all previous lessons.</span></span>  
  
## <a name="add-the-dimsalesterritory-table-to-the-aw-internet-sales-tabular-model-project"></a><span data-ttu-id="11987-123">Přidání tabulky DimSalesTerritory do projektu s tabelárním modelem AW Internet Sales</span><span class="sxs-lookup"><span data-stu-id="11987-123">Add the DimSalesTerritory table to the AW Internet Sales Tabular Model Project</span></span>  
<span data-ttu-id="11987-124">Pokud chcete implementovat dynamické zabezpečení pro tento scénář Adventure Works, musíte do modelu přidat další dvě tabulky.</span><span class="sxs-lookup"><span data-stu-id="11987-124">To implement dynamic security for this Adventure Works scenario, you must add two additional tables to your model.</span></span> <span data-ttu-id="11987-125">Jako první přidáte tabulku DimSalesTerritory (jako prodejní oblast) ze stejné databáze AdventureWorksDW.</span><span class="sxs-lookup"><span data-stu-id="11987-125">The first table you add is DimSalesTerritory (as Sales Territory) from the same AdventureWorksDW database.</span></span> <span data-ttu-id="11987-126">Potom na tabulku SalesTerritory použijete filtr řádků definující konkrétní data, která může přihlášený uživatel procházet.</span><span class="sxs-lookup"><span data-stu-id="11987-126">You later apply a row filter to the SalesTerritory table that defines the particular data the logged on user can browse.</span></span>  
  
#### <a name="to-add-the-dimsalesterritory-table"></a><span data-ttu-id="11987-127">Přidání tabulky DimSalesTerritory</span><span class="sxs-lookup"><span data-stu-id="11987-127">To add the DimSalesTerritory table</span></span>  
  
1.  <span data-ttu-id="11987-128">V části Průzkumník tabelárních modelů > **Zdroje Dat** klikněte pravým tlačítkem na vaše připojení a potom klikněte na **Importovat nové tabulky**.</span><span class="sxs-lookup"><span data-stu-id="11987-128">In Tabular Model Explorer > **Data Sources**, right-click your connection, and then click **Import New Tables**.</span></span>  

    <span data-ttu-id="11987-129">Pokud se zobrazí dialogové okno Přihlašovací údaje k zosobnění, zadejte přihlašovací údaje k zosobnění, které jste použili v lekci 2: Přidání dat.</span><span class="sxs-lookup"><span data-stu-id="11987-129">If the Impersonation Credentials dialog box appears, type the impersonation credentials you used in Lesson 2: Add Data.</span></span>
  
2.  <span data-ttu-id="11987-130">V části Navigátor vyberte tabulku **DimSalesTerritory** a klikněte na **OK**.</span><span class="sxs-lookup"><span data-stu-id="11987-130">In Navigator, select the **DimSalesTerritory** table, and then click **OK**.</span></span>    
  
3.  <span data-ttu-id="11987-131">V editoru dotazů klikněte na dotaz **DimSalesTerritory** a potom odeberte sloupec **SalesTerritoryAlternateKey**.</span><span class="sxs-lookup"><span data-stu-id="11987-131">In Query Editor, click the **DimSalesTerritory** query, and then remove **SalesTerritoryAlternateKey** column.</span></span>  
  
7.  <span data-ttu-id="11987-132">Klikněte na **Importovat**.</span><span class="sxs-lookup"><span data-stu-id="11987-132">Click **Import**.</span></span>  
  
    <span data-ttu-id="11987-133">Nová tabulka se přidá do pracovního prostoru modelu.</span><span class="sxs-lookup"><span data-stu-id="11987-133">The new table is added to the model workspace.</span></span> <span data-ttu-id="11987-134">Objekty a data ze zdrojové tabulky DimSalesTerritory se následně naimportují do vašeho tabelárního modelu AW Internet Sales.</span><span class="sxs-lookup"><span data-stu-id="11987-134">Objects and data from the source DimSalesTerritory table are then imported into your AW Internet Sales Tabular Model.</span></span>  
  
9. <span data-ttu-id="11987-135">Jakmile bude tabulka úspěšně importována, klikněte na **Zavřít**.</span><span class="sxs-lookup"><span data-stu-id="11987-135">After the table has been imported successfully, click **Close**.</span></span>  

## <a name="add-a-table-with-user-name-data"></a><span data-ttu-id="11987-136">Přidání tabulky s daty o uživatelských jménech</span><span class="sxs-lookup"><span data-stu-id="11987-136">Add a table with user name data</span></span>  
<span data-ttu-id="11987-137">Tabulka DimEmployee v ukázkové databázi AdventureWorksDW obsahuje uživatele z domény AdventureWorks.</span><span class="sxs-lookup"><span data-stu-id="11987-137">The DimEmployee table in the AdventureWorksDW sample database contains users from the AdventureWorks domain.</span></span> <span data-ttu-id="11987-138">Tato uživatelská jména ve vašem prostředí neexistují.</span><span class="sxs-lookup"><span data-stu-id="11987-138">Those user names do not exist in your own environment.</span></span> <span data-ttu-id="11987-139">Musíte v modelu vytvořit tabulku, která bude obsahovat malý vzorek skutečných uživatelů (alespoň tři) z vaší organizace.</span><span class="sxs-lookup"><span data-stu-id="11987-139">You must create a table in your model that contains a small sample (at least three) of actual users from your organization.</span></span> <span data-ttu-id="11987-140">Potom můžete tyto uživatele přidat jako členy do nové role.</span><span class="sxs-lookup"><span data-stu-id="11987-140">You then add these users as members to the new role.</span></span> <span data-ttu-id="11987-141">Pro ukázková uživatelská jména nepotřebujete hesla, potřebujete ale skutečná uživatelská jména systému Windows z vaší vlastní domény.</span><span class="sxs-lookup"><span data-stu-id="11987-141">You do not need the passwords for the sample user names, but you do need actual Windows user names from your own domain.</span></span>  
  
#### <a name="to-add-an-employeesecurity-table"></a><span data-ttu-id="11987-142">Přidání tabulky EmployeeSecurity</span><span class="sxs-lookup"><span data-stu-id="11987-142">To add an EmployeeSecurity table</span></span>  
  
1.  <span data-ttu-id="11987-143">Otevřete aplikaci Microsoft Excel a vytvořte list.</span><span class="sxs-lookup"><span data-stu-id="11987-143">Open Microsoft Excel, creating a worksheet.</span></span>  
  
2.  <span data-ttu-id="11987-144">Zkopírujte následující tabulku, včetně řádku záhlaví, a vložte ji do listu.</span><span class="sxs-lookup"><span data-stu-id="11987-144">Copy the following table, including the header row, and then paste it into the worksheet.</span></span>  

    ```
      |EmployeeId|SalesTerritoryId|FirstName|LastName|LoginId|  
      |---------------|----------------------|--------------|-------------|------------|  
      |1|2|<user first name>|<user last name>|\<domain\username>|  
      |1|3|<user first name>|<user last name>|\<domain\username>|  
      |2|4|<user first name>|<user last name>|\<domain\username>|  
      |3|5|<user first name>|<user last name>|\<domain\username>|  
    ```

3.  <span data-ttu-id="11987-145">Nahraďte jméno, příjmení a doménu\uživatelské_jméno jménem a ID přihlášení tří uživatelů ve vaší organizaci.</span><span class="sxs-lookup"><span data-stu-id="11987-145">Replace the first name, last name, and domain\username with the names and login ids of three users in your organization.</span></span> <span data-ttu-id="11987-146">Do prvních dvou řádků (EmployeeId 1) vložte stejného uživatele, abyste určili, že tento uživatel patří k více než jedné prodejní oblasti.</span><span class="sxs-lookup"><span data-stu-id="11987-146">Put the same user on the first two rows, for EmployeeId 1, showing this user belongs to more than one sales territory.</span></span> <span data-ttu-id="11987-147">Pole EmployeeId a SalesTerritoryId ponechte tak, jak jsou.</span><span class="sxs-lookup"><span data-stu-id="11987-147">Leave the EmployeeId and SalesTerritoryId fields as they are.</span></span>  
  
4.  <span data-ttu-id="11987-148">Uložte list jako **SampleEmployee**.</span><span class="sxs-lookup"><span data-stu-id="11987-148">Save the worksheet as **SampleEmployee**.</span></span>  
  
5.  <span data-ttu-id="11987-149">V listu vyberte všechny buňky s daty o zaměstnancích, včetně záhlaví, klikněte na vybraná data pravým tlačítkem a potom klikněte na **Kopírovat**.</span><span class="sxs-lookup"><span data-stu-id="11987-149">In the worksheet, select all the cells with employee data, including the headers, then right-click the selected data, and then click **Copy**.</span></span>  
  
6.  <span data-ttu-id="11987-150">V SSDT klikněte na nabídku **Upravit** a potom na **Vložit**.</span><span class="sxs-lookup"><span data-stu-id="11987-150">In SSDT, click the **Edit** menu, and then click **Paste**.</span></span>  
  
    <span data-ttu-id="11987-151">Pokud je možnost Vložit zobrazena šedě, klikněte na jakýkoli sloupec v libovolné tabulce v okně návrháře modelů a zkuste to znovu.</span><span class="sxs-lookup"><span data-stu-id="11987-151">If Paste is grayed out, click any column in any table in the model designer window, and try again.</span></span>  
  
7.  <span data-ttu-id="11987-152">V dialogovém okně **Náhled vložení** do pole **Název tabulky** zadejte **EmployeeSecurity**.</span><span class="sxs-lookup"><span data-stu-id="11987-152">In the **Paste Preview** dialog box, in **Table Name**, type **EmployeeSecurity**.</span></span>  
  
8.  <span data-ttu-id="11987-153">V části **Vkládaná data** ověřte, že data zahrnují veškerá data o uživatelích a záhlaví z listu SampleEmployee.</span><span class="sxs-lookup"><span data-stu-id="11987-153">In **Data to be pasted**, verify the data includes all the user data and headers from the SampleEmployee worksheet.</span></span>  
  
9. <span data-ttu-id="11987-154">Ověřte, že je zaškrtnuté políčko **Použít první řádek jako záhlaví sloupců** a potom klikněte na **Ok**.</span><span class="sxs-lookup"><span data-stu-id="11987-154">Verify **Use first row as column headers** is checked, and then click **Ok**.</span></span>  
  
    <span data-ttu-id="11987-155">Vytvoří se nová tabulka EmployeeSecurity s daty o zaměstnancích zkopírovanými z listu SampleEmployee.</span><span class="sxs-lookup"><span data-stu-id="11987-155">A new table named EmployeeSecurity with employee data copied from the SampleEmployee worksheet is created.</span></span>  
  
## <a name="create-relationships-between-factinternetsales-dimgeography-and-dimsalesterritory-table"></a><span data-ttu-id="11987-156">Vytvoření relací mezi tabulkami FactInternetSales, DimGeography a DimSalesTerritory</span><span class="sxs-lookup"><span data-stu-id="11987-156">Create relationships between FactInternetSales, DimGeography, and DimSalesTerritory table</span></span>  
<span data-ttu-id="11987-157">Tabulky FactInternetSales, DimGeography a DimSalesTerritory všechny obsahují společný sloupec SalesTerritoryId.</span><span class="sxs-lookup"><span data-stu-id="11987-157">The FactInternetSales, DimGeography, and DimSalesTerritory table all contain a common column, SalesTerritoryId.</span></span> <span data-ttu-id="11987-158">Sloupec SalesTerritoryId v tabulce DimSalesTerritory obsahuje hodnoty s jiným ID pro každou prodejní oblast.</span><span class="sxs-lookup"><span data-stu-id="11987-158">The SalesTerritoryId column in the DimSalesTerritory table contains values with a different Id for each sales territory.</span></span>  
  
#### <a name="to-create-relationships-between-the-factinternetsales-dimgeography-and-the-dimsalesterritory-table"></a><span data-ttu-id="11987-159">Vytvoření relací mezi tabulkami FactInternetSales, DimGeography a DimSalesTerritory</span><span class="sxs-lookup"><span data-stu-id="11987-159">To create relationships between the FactInternetSales, DimGeography, and the DimSalesTerritory table</span></span>  
  
1.  <span data-ttu-id="11987-160">V zobrazení diagramu v tabulce **DimGeography** klikněte a přidržte sloupec **SalesTerritoryId**, přesuňte kurzor na sloupec **SalesTerritoryId** v tabulce **DimSalesTerritory** a uvolněte tlačítko.</span><span class="sxs-lookup"><span data-stu-id="11987-160">In Diagram View, in the **DimGeography** table, click, and hold on the **SalesTerritoryId** column, then drag the cursor to the **SalesTerritoryId** column in the **DimSalesTerritory** table, and then release.</span></span>  
  
2.  <span data-ttu-id="11987-161">V tabulce **FactInternetSales** klikněte a přidržte sloupec **SalesTerritoryId**, přesuňte kurzor na sloupec **SalesTerritoryId** v tabulce **DimSalesTerritory** a uvolněte tlačítko.</span><span class="sxs-lookup"><span data-stu-id="11987-161">In the **FactInternetSales** table, click, and hold on the **SalesTerritoryId** column, then drag the cursor to the **SalesTerritoryId** column in the **DimSalesTerritory** table, and then release.</span></span>  
  
    <span data-ttu-id="11987-162">Všimněte si, že vlastnost Aktivní pro tuto relaci má hodnotu False, což znamená, že je relace neaktivní.</span><span class="sxs-lookup"><span data-stu-id="11987-162">Notice the Active property for this relationship is False, meaning it's inactive.</span></span> <span data-ttu-id="11987-163">Tabulka FactInternetSales už má jinou aktivní relaci.</span><span class="sxs-lookup"><span data-stu-id="11987-163">The FactInternetSales table already has another active relationship.</span></span>  
  
## <a name="hide-the-employeesecurity-table-from-client-applications"></a><span data-ttu-id="11987-164">Skrytí tabulky EmployeeSecurity před klientskými aplikacemi</span><span class="sxs-lookup"><span data-stu-id="11987-164">Hide the EmployeeSecurity Table from client applications</span></span>  
<span data-ttu-id="11987-165">V tomto úkolu skryjete tabulku EmployeeSecurity a tím zabráníte jejímu zobrazování v seznamu polí klientských aplikací.</span><span class="sxs-lookup"><span data-stu-id="11987-165">In this task, you hide the EmployeeSecurity table, keeping it from appearing in a client application’s field list.</span></span> <span data-ttu-id="11987-166">Nezapomeňte, že skrytím tabulku nezabezpečíte.</span><span class="sxs-lookup"><span data-stu-id="11987-166">Keep in mind that hiding a table does not secure it.</span></span> <span data-ttu-id="11987-167">Uživatelé pořád můžou dotazovat data v tabulce EmployeeSecurity, pokud ví jak.</span><span class="sxs-lookup"><span data-stu-id="11987-167">Users can still query EmployeeSecurity table data if they know how.</span></span> <span data-ttu-id="11987-168">Pro zabezpečení dat v tabulce EmployeeSecurity a zabránění uživatelům v jejich dotazování použijete v jednom z dalších úkolů filtr.</span><span class="sxs-lookup"><span data-stu-id="11987-168">To secure the EmployeeSecurity table data, preventing users from being able to query any of its data, you apply a filter in a later task.</span></span>  
  
#### <a name="to-hide-the-employeesecurity-table-from-client-applications"></a><span data-ttu-id="11987-169">Skrytí tabulky EmployeeSecurity před klientskými aplikacemi</span><span class="sxs-lookup"><span data-stu-id="11987-169">To hide the EmployeeSecurity table from client applications</span></span>  
  
-   <span data-ttu-id="11987-170">V návrháři modelů klikněte pravým tlačítkem v zobrazení diagramu na záhlaví tabulky **Employee** a potom klikněte na **Skrýt před klientskými nástroji**.</span><span class="sxs-lookup"><span data-stu-id="11987-170">In the model designer, in Diagram View, right-click the **Employee** table heading, and then click **Hide from Client Tools**.</span></span>  
  
## <a name="create-a-sales-employees-by-territory-user-role"></a><span data-ttu-id="11987-171">Vytvoření role uživatele Zaměstnanci prodeje podle oblasti</span><span class="sxs-lookup"><span data-stu-id="11987-171">Create a Sales Employees by Territory user role</span></span>  
<span data-ttu-id="11987-172">V tomto úkolu vytvoříte roli uživatele.</span><span class="sxs-lookup"><span data-stu-id="11987-172">In this task, you create a user role.</span></span> <span data-ttu-id="11987-173">Tato role zahrnuje filtr řádků definující, které řádky tabulky DimSalesTerritory jsou viditelné pro uživatele.</span><span class="sxs-lookup"><span data-stu-id="11987-173">This role includes a row filter defining which rows of the DimSalesTerritory table are visible to users.</span></span> <span data-ttu-id="11987-174">Filtr se pak použije ve směru relace 1:N na všechny další tabulky související s tabulkou DimSalesTerritory.</span><span class="sxs-lookup"><span data-stu-id="11987-174">The filter is then applied in the one-to-many relationship direction to all other tables related to DimSalesTerritory.</span></span> <span data-ttu-id="11987-175">Použijete také filtr, který zabezpečí celou tabulku EmployeeSecurity před dotazy uživatelů, kteří jsou členy této role.</span><span class="sxs-lookup"><span data-stu-id="11987-175">You also apply a filter that secures the entire EmployeeSecurity table from being queryable by any user that is a member of the role.</span></span>  
  
> [!NOTE]  
> <span data-ttu-id="11987-176">Role Zaměstnanci prodeje podle oblasti, kterou vytvoříte v této lekci, omezuje možnost uživatelů procházet (nebo dotazovat) data pouze na prodejní data pro prodejní oblast, ke které patří.</span><span class="sxs-lookup"><span data-stu-id="11987-176">The Sales Employees by Territory role you create in this lesson restricts members to browse (or query) only sales data for the sales territory to which they belong.</span></span> <span data-ttu-id="11987-177">Pokud do role Zaměstnanci prodeje podle oblasti přidáte uživatele, který je zároveň členem role vytvořené v [lekci 11: Vytvoření rolí](../tutorials/aas-lesson-11-create-roles.md), získáte kombinaci oprávnění.</span><span class="sxs-lookup"><span data-stu-id="11987-177">If you add a user as a member to the Sales Employees by Territory role that also exists as a member in a role created in [Lesson 11: Create Roles](../tutorials/aas-lesson-11-create-roles.md), you get a combination of permissions.</span></span> <span data-ttu-id="11987-178">Pokud je uživatel členem více rolí, pak jsou oprávnění a filtry řádků definované pro každou roli kumulativní.</span><span class="sxs-lookup"><span data-stu-id="11987-178">When a user is a member of multiple roles, the permissions, and row filters defined for each role are cumulative.</span></span> <span data-ttu-id="11987-179">To znamená, že uživatel má větší oprávnění daná kombinací rolí.</span><span class="sxs-lookup"><span data-stu-id="11987-179">That is, the user has the greater permissions determined by the combination of roles.</span></span>  
  
#### <a name="to-create-a-sales-employees-by-territory-user-role"></a><span data-ttu-id="11987-180">Vytvoření role uživatele Zaměstnanci prodeje podle oblasti</span><span class="sxs-lookup"><span data-stu-id="11987-180">To create a Sales Employees by Territory user role</span></span>  
  
1.  <span data-ttu-id="11987-181">V SSDT klikněte na nabídku **Model** a potom na **Role**.</span><span class="sxs-lookup"><span data-stu-id="11987-181">In SSDT, click the **Model** menu, and then click **Roles**.</span></span>  
  
2.  <span data-ttu-id="11987-182">Ve **Správci rolí** klikněte na **Nový**.</span><span class="sxs-lookup"><span data-stu-id="11987-182">In **Role Manager**, click **New**.</span></span>  
  
    <span data-ttu-id="11987-183">Do seznamu se přidá nová role bez žádného oprávnění.</span><span class="sxs-lookup"><span data-stu-id="11987-183">A new role with the None permission is added to the list.</span></span>  
  
3.  <span data-ttu-id="11987-184">Klikněte na novou roli a potom ji ve sloupci **Název** přejmenujte na **Zaměstnanci prodeje podle oblasti**.</span><span class="sxs-lookup"><span data-stu-id="11987-184">Click the new role, and then in the **Name** column, rename the role to **Sales Employees by Territory**.</span></span>  
  
4.  <span data-ttu-id="11987-185">Ve sloupci **Oprávnění** klikněte na rozevírací seznam a vyberte oprávnění **Čtení**.</span><span class="sxs-lookup"><span data-stu-id="11987-185">In the **Permissions** column, click the dropdown list, and then select the **Read** permission.</span></span>  
  
5.  <span data-ttu-id="11987-186">Klikněte na kartu **Členové** a pak na **Přidat**.</span><span class="sxs-lookup"><span data-stu-id="11987-186">Click the **Members** tab, and then click **Add**.</span></span>  
  
6.  <span data-ttu-id="11987-187">V dialogovém okně **Vybrat uživatele nebo skupinu** v části **Zadejte názvy objektů k výběru** zadejte první ukázkové uživatelské jméno, které jste použili při vytváření tabulky EmployeeSecurity.</span><span class="sxs-lookup"><span data-stu-id="11987-187">In the **Select User or Group** dialog box, in **Enter the object named to select**, type the first sample user name you used when creating the EmployeeSecurity table.</span></span> <span data-ttu-id="11987-188">Kliknutím na **Zkontrolovat názvy** ověřte platnost uživatelského jména a potom klikněte na **Ok**.</span><span class="sxs-lookup"><span data-stu-id="11987-188">Click **Check Names** to verify the user name is valid, and then click **Ok**.</span></span>  
  
    <span data-ttu-id="11987-189">Opakováním tohoto kroku přidejte další ukázková uživatelská jména, která jste použili při vytváření tabulky EmployeeSecurity.</span><span class="sxs-lookup"><span data-stu-id="11987-189">Repeat this step, adding the other sample user names you used when creating the EmployeeSecurity table.</span></span>  
  
7.  <span data-ttu-id="11987-190">Klikněte na kartu **Filtry řádků**.</span><span class="sxs-lookup"><span data-stu-id="11987-190">Click the **Row Filters** tab.</span></span>  
  
8.  <span data-ttu-id="11987-191">Pro tabulku **EmployeeSecurity** zadejte do sloupce **Filtr DAX** následující vzorec:</span><span class="sxs-lookup"><span data-stu-id="11987-191">For the **EmployeeSecurity** table, in the **DAX Filter** column, type the following formula:</span></span>  
  
    ```
      =FALSE()  
    ```
  
    <span data-ttu-id="11987-192">Tento vzorec určuje, že se všechny sloupce přeloží na logickou podmínku s hodnotou false.</span><span class="sxs-lookup"><span data-stu-id="11987-192">This formula specifies that all columns resolve to the false Boolean condition.</span></span> <span data-ttu-id="11987-193">Členové role uživatele Zaměstnanci prodeje podle oblasti nemůžou dotazovat žádné sloupce tabulky EmployeeSecurity.</span><span class="sxs-lookup"><span data-stu-id="11987-193">No columns for the EmployeeSecurity table can be queried by a member of the Sales Employees by Territory user role.</span></span>  
  
9. <span data-ttu-id="11987-194">Pro tabulku **DimSalesTerritory** zadejte následující vzorec:</span><span class="sxs-lookup"><span data-stu-id="11987-194">For the **DimSalesTerritory** table, type the following formula:</span></span>  

    ```  
    ='Sales Territory'[Sales Territory Id]=LOOKUPVALUE('Employee Security'[Sales Territory Id], 
      'Employee Security'[Login Id], USERNAME(), 
      'Employee Security'[Sales Territory Id], 
      'Sales Territory'[Sales Territory Id]) 
    ```
  
    <span data-ttu-id="11987-195">V tomto vzorci funkce LOOKUPVALUE vrátí všechny hodnoty pro sloupec DimEmployeeSecurity[SalesTerritoryId], kde EmployeeSecurity[LoginId] je stejné jako uživatelské jméno systému Windows aktuálně přihlášeného uživatele a EmployeeSecurity[SalesTerritoryId] je stejné jako DimSalesTerritory[SalesTerritoryId].</span><span class="sxs-lookup"><span data-stu-id="11987-195">In this formula, the LOOKUPVALUE function returns all values for the DimEmployeeSecurity[SalesTerritoryId] column, where the EmployeeSecurity[LoginId] is the same as the current logged on Windows user name, and EmployeeSecurity[SalesTerritoryId] is the same as the DimSalesTerritory[SalesTerritoryId].</span></span>  
  
    <span data-ttu-id="11987-196">Sada ID prodejních oblastí vrácená funkcí LOOKUPVALUE se pak použije k omezení zobrazených řádků v tabulce DimSalesTerritory.</span><span class="sxs-lookup"><span data-stu-id="11987-196">The set of sales territory IDs returned by LOOKUPVALUE is then used to restrict the rows shown in the DimSalesTerritory table.</span></span> <span data-ttu-id="11987-197">Zobrazí se pouze řádky, jejichž SalesTerritoryID se nachází v sadě ID vrácené funkcí LOOKUPVALUE.</span><span class="sxs-lookup"><span data-stu-id="11987-197">Only rows where the SalesTerritoryID for the row is in the set of IDs returned by the LOOKUPVALUE function are displayed.</span></span>  
  
10. <span data-ttu-id="11987-198">Ve Správci rolí klikněte na **Ok**.</span><span class="sxs-lookup"><span data-stu-id="11987-198">In Role Manager, click **Ok**.</span></span>  
  
## <a name="test-the-sales-employees-by-territory-user-role"></a><span data-ttu-id="11987-199">Test role uživatele Zaměstnanci prodeje podle oblasti</span><span class="sxs-lookup"><span data-stu-id="11987-199">Test the Sales Employees by Territory User Role</span></span>  
<span data-ttu-id="11987-200">V tomto úkolu pomocí funkce Analýza v aplikaci Excel v SSDT otestujete efektivnost role uživatele Zaměstnanci prodeje podle oblasti.</span><span class="sxs-lookup"><span data-stu-id="11987-200">In this task, you use the Analyze in Excel feature in SSDT to test the efficacy of the Sales Employees by Territory user role.</span></span> <span data-ttu-id="11987-201">Zadáte jedno z uživatelských jmen, která jste přidali do tabulky EmployeeSecurity a jako člena této role.</span><span class="sxs-lookup"><span data-stu-id="11987-201">You specify one of the user names you added to the EmployeeSecurity table and as a member of the role.</span></span> <span data-ttu-id="11987-202">Toto uživatelské jméno se pak použije jako efektivní uživatelské jméno ve vytvořeném propojení mezi aplikací Excel a modelem.</span><span class="sxs-lookup"><span data-stu-id="11987-202">This user name is then used as the effective user name in the connection created between Excel and the model.</span></span>  
  
#### <a name="to-test-the-sales-employees-by-territory-user-role"></a><span data-ttu-id="11987-203">Test role uživatele Zaměstnanci prodeje podle oblasti</span><span class="sxs-lookup"><span data-stu-id="11987-203">To test the Sales Employees by Territory user role</span></span>  
  
1.  <span data-ttu-id="11987-204">V SSDT klikněte na nabídku **Model** a potom na **Analyzovat v aplikaci Excel**.</span><span class="sxs-lookup"><span data-stu-id="11987-204">In SSDT, click the **Model** menu, and then click **Analyze in Excel**.</span></span>  
  
2.  <span data-ttu-id="11987-205">V dialogovém okně **Analýza v aplikaci Excel** v části **Zadejte uživatelské jméno nebo roli pro připojení k modelu** vyberte **Jiný uživatel systému Windows** a potom klikněte na **Procházet**.</span><span class="sxs-lookup"><span data-stu-id="11987-205">In the **Analyze in Excel** dialog box, in **Specify the user name or role to use to connect to the model**, select **Other Windows User**, and then click **Browse**.</span></span>  
  
3.  <span data-ttu-id="11987-206">V dialogovém okně **Vybrat uživatele nebo skupinu** v části **Zadejte název objektu k výběru** zadejte uživatelské jméno, které jste zahrnuli do tabulky EmployeeSecurity, a potom klikněte na **Zkontrolovat názvy**.</span><span class="sxs-lookup"><span data-stu-id="11987-206">In the **Select User or Group** dialog box, in **Enter the object name to select**, type a user name you included in the EmployeeSecurity table, and then click **Check Names**.</span></span>  
  
4.  <span data-ttu-id="11987-207">Kliknutím na **Ok** zavřete dialogové okno **Vybrat uživatele nebo skupinu** a potom kliknutím na **Ok** zavřete dialogové okno **Analýza v aplikaci Excel**.</span><span class="sxs-lookup"><span data-stu-id="11987-207">Click **Ok** to close the **Select User or Group** dialog box, and then click **Ok** to close the **Analyze in Excel** dialog box.</span></span>  
  
    <span data-ttu-id="11987-208">Otevře se aplikace Excel s novým sešitem.</span><span class="sxs-lookup"><span data-stu-id="11987-208">Excel opens with a new workbook.</span></span> <span data-ttu-id="11987-209">Automaticky se vytvoří kontingenční tabulka.</span><span class="sxs-lookup"><span data-stu-id="11987-209">A PivotTable is automatically created.</span></span> <span data-ttu-id="11987-210">Seznam polí kontingenční tabulky zahrnuje většinu datových polí, která jsou v novém modelu k dispozici.</span><span class="sxs-lookup"><span data-stu-id="11987-210">The PivotTable Fields list includes most of the data fields available in your new model.</span></span>  
  
    <span data-ttu-id="11987-211">Všimněte si, že tabulka EmployeeSecurity se v seznamu polí kontingenční tabulky nezobrazuje.</span><span class="sxs-lookup"><span data-stu-id="11987-211">Notice the EmployeeSecurity table is not visible in the PivotTable Fields list.</span></span> <span data-ttu-id="11987-212">Tuto tabulku jste skryli před klientskými nástroji v jednom z předchozích úkolů.</span><span class="sxs-lookup"><span data-stu-id="11987-212">You hid this table from client tools in a previous task.</span></span>  
  
5.  <span data-ttu-id="11987-213">V seznamu **Pole** v části **∑ Internet Sales** (míry) vyberte míru **InternetTotalSales**.</span><span class="sxs-lookup"><span data-stu-id="11987-213">In the **Fields** list, in **∑ Internet Sales** (measures), select the **InternetTotalSales** measure.</span></span> <span data-ttu-id="11987-214">Tato míra se zadá do polí **Hodnoty**.</span><span class="sxs-lookup"><span data-stu-id="11987-214">The measure is entered into the **Values** fields.</span></span>  
  
6.  <span data-ttu-id="11987-215">Vyberte sloupec **SalesTerritoryId** z tabulky **DimSalesTerritory**.</span><span class="sxs-lookup"><span data-stu-id="11987-215">Select the **SalesTerritoryId** column from the **DimSalesTerritory** table.</span></span> <span data-ttu-id="11987-216">Tento sloupec se zadá do polí **Popisky řádků**.</span><span class="sxs-lookup"><span data-stu-id="11987-216">The column is entered into the **Row Labels** fields.</span></span>  
  
    <span data-ttu-id="11987-217">Všimněte si, že hodnoty internetového prodeje se zobrazí pouze pro jednu oblast, do které patří efektivní uživatelské jméno, které jste použili.</span><span class="sxs-lookup"><span data-stu-id="11987-217">Notice Internet sales figures appear only for the one region to which the effective user name you used belongs.</span></span> <span data-ttu-id="11987-218">Pokud jako pole popisku řádku vyberete jiný sloupec, třeba City z tabulky DimGeography, zobrazí se pouze města v prodejní oblasti, ke které patří efektivní uživatel.</span><span class="sxs-lookup"><span data-stu-id="11987-218">If you select another column, like City from the DimGeography table as Row Label field, only cities in the sales territory to which the effective user belongs are displayed.</span></span>  
  
    <span data-ttu-id="11987-219">Tento uživatel nemůže procházet ani dotazovat žádná data o internetovém prodeji pro jiné oblasti, než do kterých patří.</span><span class="sxs-lookup"><span data-stu-id="11987-219">This user cannot browse or query any Internet sales data for territories other than the one they belong to.</span></span> <span data-ttu-id="11987-220">Důvodem tohoto omezení je, že filtr řádků definovaný pro tabulku DimSalesTerritory v roli uživatele Zaměstnanci prodeje podle oblasti chrání veškerá data související s jinými prodejními oblastmi.</span><span class="sxs-lookup"><span data-stu-id="11987-220">This restriction is because the row filter defined for the DimSalesTerritory table, in the Sales Employees by Territory user role, secures data for all data related to other sales territories.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="11987-221">Viz také</span><span class="sxs-lookup"><span data-stu-id="11987-221">See Also</span></span>  
[<span data-ttu-id="11987-222">Funkce USERNAME (DAX)</span><span class="sxs-lookup"><span data-stu-id="11987-222">USERNAME Function (DAX)</span></span>](https://msdn.microsoft.com/library/hh230954.aspx)  
[<span data-ttu-id="11987-223">Funkce LOOKUPVALUE (DAX)</span><span class="sxs-lookup"><span data-stu-id="11987-223">LOOKUPVALUE Function (DAX)</span></span>](https://msdn.microsoft.com/library/gg492170.aspx)  
[<span data-ttu-id="11987-224">Funkce CUSTOMDATA (DAX)</span><span class="sxs-lookup"><span data-stu-id="11987-224">CUSTOMDATA Function (DAX)</span></span>](https://msdn.microsoft.com/library/hh213140.aspx)  