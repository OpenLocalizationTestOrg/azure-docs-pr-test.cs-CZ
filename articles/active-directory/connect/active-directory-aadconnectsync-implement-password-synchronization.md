---
title: Synchronizace hesel aaaImplement s Azure AD Connect sync | Microsoft Docs
description: Jak funguje synchronizace hesel a poskytuje informace o tooset nahoru.
services: active-directory
documentationcenter: 
author: MarkusVi
manager: femila
editor: 
ms.assetid: 05f16c3e-9d23-45dc-afca-3d0fa9dbf501
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/17/2017
ms.author: billmath
ms.openlocfilehash: a0401640f2a4d914419ee4446f923bb3a972389d
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="implement-password-synchronization-with-azure-ad-connect-sync"></a><span data-ttu-id="bc05a-103">Implementace synchronizace hesel s synchronizace Azure AD Connect</span><span class="sxs-lookup"><span data-stu-id="bc05a-103">Implement password synchronization with Azure AD Connect sync</span></span>
<span data-ttu-id="bc05a-104">Tento článek obsahuje informace, je nutné toosynchronize vaše hesel uživatelů mezi místní instanci Active Directory instance tooa cloudové služby Azure Active Directory (Azure AD).</span><span class="sxs-lookup"><span data-stu-id="bc05a-104">This article provides information that you need toosynchronize your user passwords from an on-premises Active Directory instance tooa cloud-based Azure Active Directory (Azure AD) instance.</span></span>

## <a name="what-is-password-synchronization"></a><span data-ttu-id="bc05a-105">Co je synchronizace hesel</span><span class="sxs-lookup"><span data-stu-id="bc05a-105">What is password synchronization</span></span>
<span data-ttu-id="bc05a-106">Hello pravděpodobnost, že jste se blokovat práce s aplikací z důvodu tooa zapomenete heslo související číslo toohello různá hesla musíte tooremember.</span><span class="sxs-lookup"><span data-stu-id="bc05a-106">hello probability that you're blocked from getting your work done due tooa forgotten password is related toohello number of different passwords you need tooremember.</span></span> <span data-ttu-id="bc05a-107">Hello více hesel, budete potřebovat tooremember hello vyšší hello pravděpodobnosti tooforget jeden.</span><span class="sxs-lookup"><span data-stu-id="bc05a-107">hello more passwords you need tooremember, hello higher hello probability tooforget one.</span></span> <span data-ttu-id="bc05a-108">Dotazy a volání o resetování hesla a další problémy související s hesly vyžádání hello nejvíce zdrojů technickou podporu.</span><span class="sxs-lookup"><span data-stu-id="bc05a-108">Questions and calls about password resets and other password-related issues demand hello most helpdesk resources.</span></span>

<span data-ttu-id="bc05a-109">Synchronizace hesel je že funkce používá toosynchronize hesel uživatelů z místní služby Active Directory instance tooa cloudové služby Azure AD instance.</span><span class="sxs-lookup"><span data-stu-id="bc05a-109">Password synchronization is a feature used toosynchronize user passwords from an on-premises Active Directory instance tooa cloud-based Azure AD instance.</span></span>
<span data-ttu-id="bc05a-110">Pomocí této funkce toosign v tooAzure AD služby, jako je Office 365, Microsoft Intune, CRM Online a Azure Active Directory Domain Services (Azure AD DS).</span><span class="sxs-lookup"><span data-stu-id="bc05a-110">Use this feature toosign in tooAzure AD services like Office 365, Microsoft Intune, CRM Online, and Azure Active Directory Domain Services (Azure AD DS).</span></span> <span data-ttu-id="bc05a-111">Přihlášení služby toohello pomocí hello stejné heslo, které použijete v tooyour toosign místní instanci Active Directory.</span><span class="sxs-lookup"><span data-stu-id="bc05a-111">You sign in toohello service by using hello same password you use toosign in tooyour on-premises Active Directory instance.</span></span>

![Co je služba Azure AD Connect](./media/active-directory-aadconnectsync-implement-password-synchronization/arch1.png)

<span data-ttu-id="bc05a-113">Protože se sníží hello počet hesel, uživatelé potřebovat toomaintain toojust jeden.</span><span class="sxs-lookup"><span data-stu-id="bc05a-113">By reducing hello number of passwords, your users need toomaintain toojust one.</span></span> <span data-ttu-id="bc05a-114">Synchronizace hesel vám pomůže:</span><span class="sxs-lookup"><span data-stu-id="bc05a-114">Password synchronization helps you to:</span></span>

* <span data-ttu-id="bc05a-115">Zvýšení produktivity hello uživatelů.</span><span class="sxs-lookup"><span data-stu-id="bc05a-115">Improve hello productivity of your users.</span></span>
* <span data-ttu-id="bc05a-116">Snižte náklady na technickou podporu.</span><span class="sxs-lookup"><span data-stu-id="bc05a-116">Reduce your helpdesk costs.</span></span>  

<span data-ttu-id="bc05a-117">Navíc pokud se rozhodnete toouse [federační službou Active Directory Federation Services (AD FS)](https://channel9.msdn.com/Series/Azure-Active-Directory-Videos-Demos/Configuring-AD-FS-for-user-sign-in-with-Azure-AD-Connect), můžete volitelně můžete nastavit synchronizaci hesel jako záložní případ selhání infrastruktury služby AD FS.</span><span class="sxs-lookup"><span data-stu-id="bc05a-117">Also, if you decide toouse [Federation with Active Directory Federation Services (AD FS)](https://channel9.msdn.com/Series/Azure-Active-Directory-Videos-Demos/Configuring-AD-FS-for-user-sign-in-with-Azure-AD-Connect), you can optionally set up password synchronization as a backup in case your AD FS infrastructure fails.</span></span>

<span data-ttu-id="bc05a-118">Synchronizace hesel je funkce synchronizace adresáře toohello rozšíření implementované synchronizace Azure AD Connect. Synchronizace hesel toouse ve vašem prostředí, budete muset:</span><span class="sxs-lookup"><span data-stu-id="bc05a-118">Password synchronization is an extension toohello directory synchronization feature implemented by Azure AD Connect sync. toouse password synchronization in your environment, you need to:</span></span>

* <span data-ttu-id="bc05a-119">Instalovat Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="bc05a-119">Install Azure AD Connect.</span></span>  
* <span data-ttu-id="bc05a-120">Konfigurace synchronizace adresářů mezi vaší místní instancí Active Directory a vaše instance služby Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="bc05a-120">Configure directory synchronization between your on-premises Active Directory instance and your Azure Active Directory instance.</span></span>
* <span data-ttu-id="bc05a-121">Povolení synchronizace hesel.</span><span class="sxs-lookup"><span data-stu-id="bc05a-121">Enable password synchronization.</span></span>

<span data-ttu-id="bc05a-122">Podrobnější informace najdete v článku [Integrování místních identit do služby Azure Active Directory](active-directory-aadconnect.md).</span><span class="sxs-lookup"><span data-stu-id="bc05a-122">For more details, see [Integrating your on-premises identities with Azure Active Directory](active-directory-aadconnect.md).</span></span>

> [!NOTE]
> <span data-ttu-id="bc05a-123">Další podrobnosti o Azure Active Directory Domain Services nakonfigurovaná pro synchronizaci FIPS a heslo najdete v části "synchronizace hesel a FIPS" později v tomto článku.</span><span class="sxs-lookup"><span data-stu-id="bc05a-123">For more details about Azure Active Directory Domain Services configured for FIPS and password synchronization, see "Password synchronization and FIPS" later in this article.</span></span>
>
>

## <a name="how-password-synchronization-works"></a><span data-ttu-id="bc05a-124">Princip funkce Synchronizace hesla</span><span class="sxs-lookup"><span data-stu-id="bc05a-124">How password synchronization works</span></span>
<span data-ttu-id="bc05a-125">Hello služba Active Directory domain Services ukládá hesla v podobě hello reprezentace hodnotu hash hello skutečného uživatelského hesla.</span><span class="sxs-lookup"><span data-stu-id="bc05a-125">hello Active Directory domain service stores passwords in hello form of a hash value representation of hello actual user password.</span></span> <span data-ttu-id="bc05a-126">Hodnota hash je výsledek jednosměrné matematické funkce (hello *algoritmus hash*).</span><span class="sxs-lookup"><span data-stu-id="bc05a-126">A hash value is a result of a one-way mathematical function (hello *hashing algorithm*).</span></span> <span data-ttu-id="bc05a-127">Neexistuje žádný metoda toorevert hello výsledek jednosměrné funkce toohello prostý text verze heslo.</span><span class="sxs-lookup"><span data-stu-id="bc05a-127">There is no method toorevert hello result of a one-way function toohello plain text version of a password.</span></span> <span data-ttu-id="bc05a-128">V místní síti tooyour nelze použít toosign hash a heslo.</span><span class="sxs-lookup"><span data-stu-id="bc05a-128">You cannot use a password hash toosign in tooyour on-premises network.</span></span>

<span data-ttu-id="bc05a-129">toosynchronize, které vaše heslo, synchronizace Azure AD Connect extrahuje vaše hodnoty hash hesla z hello místní instanci Active Directory.</span><span class="sxs-lookup"><span data-stu-id="bc05a-129">toosynchronize your password, Azure AD Connect sync extracts your password hash from hello on-premises Active Directory instance.</span></span> <span data-ttu-id="bc05a-130">Další bezpečnostní zpracování je použita hodnota hash hesla toohello předtím, než je synchronizován toohello Služba ověřování v Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="bc05a-130">Extra security processing is applied toohello password hash before it is synchronized toohello Azure Active Directory authentication service.</span></span> <span data-ttu-id="bc05a-131">Hesla se synchronizují na jednotlivé uživatele a v chronologickém pořadí.</span><span class="sxs-lookup"><span data-stu-id="bc05a-131">Passwords are synchronized on a per-user basis and in chronological order.</span></span>

<span data-ttu-id="bc05a-132">Hello samotný datový tok procesu synchronizace hesla hello je podobné toohello synchronizace uživatelských dat, jako je například DisplayName nebo e-mailové adresy.</span><span class="sxs-lookup"><span data-stu-id="bc05a-132">hello actual data flow of hello password synchronization process is similar toohello synchronization of user data such as DisplayName or Email Addresses.</span></span> <span data-ttu-id="bc05a-133">Ale hesla se synchronizují častěji než standardní directory hello časový interval synchronizace pro ostatní atributy.</span><span class="sxs-lookup"><span data-stu-id="bc05a-133">However, passwords are synchronized more frequently than hello standard directory synchronization window for other attributes.</span></span> <span data-ttu-id="bc05a-134">procesu synchronizace hesla Hello spouští každých 2 minut.</span><span class="sxs-lookup"><span data-stu-id="bc05a-134">hello password synchronization process runs every 2 minutes.</span></span> <span data-ttu-id="bc05a-135">Nelze změnit frekvenci hello tohoto procesu.</span><span class="sxs-lookup"><span data-stu-id="bc05a-135">You cannot modify hello frequency of this process.</span></span> <span data-ttu-id="bc05a-136">Při synchronizaci hesla, přepíše stávající heslo cloudu hello.</span><span class="sxs-lookup"><span data-stu-id="bc05a-136">When you synchronize a password, it overwrites hello existing cloud password.</span></span>

<span data-ttu-id="bc05a-137">Hello poprvé povolíte hello funkce Synchronizace hesla, provede počáteční synchronizaci hesel hello všech uživatelů v oboru.</span><span class="sxs-lookup"><span data-stu-id="bc05a-137">hello first time you enable hello password synchronization feature, it performs an initial synchronization of hello passwords of all in-scope users.</span></span> <span data-ttu-id="bc05a-138">Podmnožinu uživatelská hesla, které chcete toosynchronize nemůže explicitně definovat.</span><span class="sxs-lookup"><span data-stu-id="bc05a-138">You cannot explicitly define a subset of user passwords that you want toosynchronize.</span></span>

<span data-ttu-id="bc05a-139">Pokud změníte heslo k místní, hello aktualizovat heslo je synchronizován, nejčastěji během několika minut.</span><span class="sxs-lookup"><span data-stu-id="bc05a-139">When you change an on-premises password, hello updated password is synchronized, most often in a matter of minutes.</span></span>
<span data-ttu-id="bc05a-140">funkce Synchronizace hesla Hello automaticky opakovat pokusy o synchronizaci se nezdařilo.</span><span class="sxs-lookup"><span data-stu-id="bc05a-140">hello password synchronization feature automatically retries failed synchronization attempts.</span></span> <span data-ttu-id="bc05a-141">Pokud dojde k chybě během toosynchronize pokusu o zadání hesla, je váš prohlížeč událostí přihlášení k chybě.</span><span class="sxs-lookup"><span data-stu-id="bc05a-141">If an error occurs during an attempt toosynchronize a password, an error is logged in your event viewer.</span></span>

<span data-ttu-id="bc05a-142">Hello synchronizace hesla nemá žádný vliv na hello uživatele, který je aktuálně přihlášený.</span><span class="sxs-lookup"><span data-stu-id="bc05a-142">hello synchronization of a password has no impact on hello user  who is currently signed in.</span></span>
<span data-ttu-id="bc05a-143">Aktuální relace cloudové služby nemá vliv okamžitě změnu hesla synchronizované, ke kterému dochází, když jste přihlášení tooa cloudové služby.</span><span class="sxs-lookup"><span data-stu-id="bc05a-143">Your current cloud service session is not immediately affected by a synchronized password change that occurs while you are signed in tooa cloud service.</span></span> <span data-ttu-id="bc05a-144">Ale pokud hello Cloudová služba vyžaduje, abyste tooauthenticate znovu, je potřeba tooprovide nové heslo.</span><span class="sxs-lookup"><span data-stu-id="bc05a-144">However, when hello cloud service requires you tooauthenticate again, you need tooprovide your new password.</span></span>

<span data-ttu-id="bc05a-145">Musí uživatel zadat svoje podnikové přihlašovací údaje druhý čas tooauthenticate tooAzure AD, bez ohledu na to, jestli jste přihlášení tootheir podnikové síti.</span><span class="sxs-lookup"><span data-stu-id="bc05a-145">A user must enter their corporate credentials a second time tooauthenticate tooAzure AD, regardless of whether they're signed in tootheir corporate network.</span></span> <span data-ttu-id="bc05a-146">Tyto vzor můžete minimalizovat, ale pokud hello uživatel vybere hello zachovat mi podepsané v políčko (KMSI) při přihlašování.</span><span class="sxs-lookup"><span data-stu-id="bc05a-146">These pattern can be minimized, however, if hello user selects hello Keep me signed in (KMSI) check box at sign in.</span></span> <span data-ttu-id="bc05a-147">Tento výběr nastaví soubor cookie relace, který obchází ověřování na krátkou dobu.</span><span class="sxs-lookup"><span data-stu-id="bc05a-147">This selection sets a session cookie that bypasses authentication for a short period.</span></span> <span data-ttu-id="bc05a-148">Chování KMSI můžete povolit nebo zakázat pomocí Správce Azure AD hello.</span><span class="sxs-lookup"><span data-stu-id="bc05a-148">KMSI behavior can be enabled or disabled by hello Azure AD administrator.</span></span>

> [!NOTE]
> <span data-ttu-id="bc05a-149">Synchronizace hesla je podporována pouze pro uživatele typu hello objektu ve službě Active Directory.</span><span class="sxs-lookup"><span data-stu-id="bc05a-149">Password sync is only supported for hello object type user in Active Directory.</span></span> <span data-ttu-id="bc05a-150">Nepodporuje pro typ objektu iNetOrgPerson hello.</span><span class="sxs-lookup"><span data-stu-id="bc05a-150">It is not supported for hello iNetOrgPerson object type.</span></span>

### <a name="detailed-description-of-how-password-synchronization-works"></a><span data-ttu-id="bc05a-151">Podrobný popis toho, jak funguje synchronizace hesel</span><span class="sxs-lookup"><span data-stu-id="bc05a-151">Detailed description of how password synchronization works</span></span>
<span data-ttu-id="bc05a-152">Hello následující text popisuje podrobný Princip funkce Synchronizace hesla mezi služby Active Directory a Azure AD.</span><span class="sxs-lookup"><span data-stu-id="bc05a-152">hello following describes in-depth how password synchronization works between Active Directory and Azure AD.</span></span>

![Tok podrobné heslo](./media/active-directory-aadconnectsync-implement-password-synchronization/arch3.png)


1. <span data-ttu-id="bc05a-154">Každé dvě minuty, agent synchronizace hesel hello na server hello AD Connect požadavky hodnot hash hesel uložených (atribut unicodePwd hello) z řadiče domény přes standardní hello [MS-DRSR](https://msdn.microsoft.com/library/cc228086.aspx) toosynchronize dat používá replikace protokol mezi řadiče domény.</span><span class="sxs-lookup"><span data-stu-id="bc05a-154">Every two minutes, hello password synchronization agent on hello AD Connect server requests stored password hashes (hello unicodePwd attribute) from a DC via hello standard [MS-DRSR](https://msdn.microsoft.com/library/cc228086.aspx) replication protocol used toosynchronize data between DCs.</span></span> <span data-ttu-id="bc05a-155">Replikovat změny adresáře a replikovat Directory změny všechny AD oprávnění (udělená na instalaci ve výchozím nastavení) tooobtain hello hodnot hash hesel, musí mít účet služby Hello.</span><span class="sxs-lookup"><span data-stu-id="bc05a-155">hello service account must have Replicate Directory Changes and Replicate Directory Changes All AD permissions (granted by default on installation) tooobtain hello password hashes.</span></span>
2. <span data-ttu-id="bc05a-156">Před odesláním, hello řadič domény šifruje hello MD4 hodnoty hash hesla pomocí klíče, který je [MD5](http://www.rfc-editor.org/rfc/rfc1321.txt) hash klíče relace hello RPC a salt.</span><span class="sxs-lookup"><span data-stu-id="bc05a-156">Before sending, hello DC encrypts hello MD4 password hash by using a key that is a [MD5](http://www.rfc-editor.org/rfc/rfc1321.txt) hash of hello RPC session key and a salt.</span></span> <span data-ttu-id="bc05a-157">Pak odešle agent synchronizace hesel toohello výsledek hello prostřednictvím protokolu RPC.</span><span class="sxs-lookup"><span data-stu-id="bc05a-157">It then sends hello result toohello password synchronization agent over RPC.</span></span> <span data-ttu-id="bc05a-158">Hello řadič domény také předá hello řetězce salt toohello synchronizace agenta pomocí protokolu replikace hello řadič domény, takže hello agenta bude možné toodecrypt hello obálky.</span><span class="sxs-lookup"><span data-stu-id="bc05a-158">hello DC also passes hello salt toohello synchronization agent by using hello DC replication protocol, so hello agent will be able toodecrypt hello envelope.</span></span>
3.  <span data-ttu-id="bc05a-159">Po agent synchronizace hesel hello má hello šifrované obálky, používá [MD5CryptoServiceProvider](https://msdn.microsoft.com/library/System.Security.Cryptography.MD5CryptoServiceProvider.aspx) a hello řetězce salt toogenerate MD4 původním formátu back tooits služby klíče toodecrypt hello přijal data.</span><span class="sxs-lookup"><span data-stu-id="bc05a-159">After hello password synchronization agent has hello encrypted envelope, it uses [MD5CryptoServiceProvider](https://msdn.microsoft.com/library/System.Security.Cryptography.MD5CryptoServiceProvider.aspx) and hello salt toogenerate a key toodecrypt hello received data back tooits original MD4 format.</span></span> <span data-ttu-id="bc05a-160">Žádné okamžiku má agent synchronizace hesel hello hesla v nešifrovaném textu toohello přístup.</span><span class="sxs-lookup"><span data-stu-id="bc05a-160">At no point does hello password synchronization agent have access toohello clear text password.</span></span> <span data-ttu-id="bc05a-161">Hello agent synchronizace hesel použití algoritmu MD5 je určené výhradně pro kompatibilitu s protokolem replikace s hello řadiče domény a používá se pouze místní mezi hello řadiče domény a agent synchronizace hesel hello.</span><span class="sxs-lookup"><span data-stu-id="bc05a-161">hello password synchronization agent’s use of MD5 is strictly for replication protocol compatibility with hello DC, and it is only used on premises between hello DC and hello password synchronization agent.</span></span>
4.  <span data-ttu-id="bc05a-162">agent synchronizace hesel Hello rozšíří hello binární heslo 16 bajtů hash too64 bajtů první převodu hello hash tooa 32 bajtů hexadecimální řetězce, pak tento řetězec převod zpět do binární kódování UTF-16.</span><span class="sxs-lookup"><span data-stu-id="bc05a-162">hello password synchronization agent expands hello 16-byte binary password hash too64 bytes by first converting hello hash tooa 32-byte hexadecimal string, then converting this string back into binary with UTF-16 encoding.</span></span>
5.  <span data-ttu-id="bc05a-163">agent synchronizace hesel Hello přidá salt, skládající se z délka v bajtech 10 salt, toohello 64 bajtů binární toofurther chránit hello původní hodnoty hash.</span><span class="sxs-lookup"><span data-stu-id="bc05a-163">hello password synchronization agent adds a salt, consisting of a 10-byte length salt, toohello 64-byte binary toofurther protect hello original hash.</span></span>
6.  <span data-ttu-id="bc05a-164">agent synchronizace hesel Hello pak kombinuje hash hello MD4 plus salt a vstup do hello [PBKDF2](https://www.ietf.org/rfc/rfc2898.txt) funkce.</span><span class="sxs-lookup"><span data-stu-id="bc05a-164">hello password synchronization agent then combines hello MD4 hash plus salt, and inputs it into hello [PBKDF2](https://www.ietf.org/rfc/rfc2898.txt) function.</span></span> <span data-ttu-id="bc05a-165">1000 iterací hello [HMAC SHA256](https://msdn.microsoft.com/library/system.security.cryptography.hmacsha256.aspx) klíčovaný algoritmus hash se používá.</span><span class="sxs-lookup"><span data-stu-id="bc05a-165">1000 iterations of hello [HMAC-SHA256](https://msdn.microsoft.com/library/system.security.cryptography.hmacsha256.aspx) keyed hashing algorithm is used.</span></span> 
7.  <span data-ttu-id="bc05a-166">agent synchronizace hesel Hello trvá hello výsledné 32 bajtů hash, zřetězí obou hello salt a hello počet iterací tooit SHA256 (pro použití služby Azure AD) a pak přenáší hello řetězec z Azure AD Connect tooAzure AD přes protokol SSL.</span><span class="sxs-lookup"><span data-stu-id="bc05a-166">hello password synchronization agent takes hello resulting 32-byte hash, concatenates both hello salt and hello number of SHA256 iterations tooit (for use by Azure AD), then transmits hello string from Azure AD Connect tooAzure AD over SSL.</span></span></br> 
8.  <span data-ttu-id="bc05a-167">Když uživatel pokusí toosign v tooAzure AD a zadá své heslo, hello heslo je spuštění prostřednictvím hello stejné MD4 + řetězce salt + PBKDF2 + HMAC SHA256 procesu.</span><span class="sxs-lookup"><span data-stu-id="bc05a-167">When a user attempts toosign in tooAzure AD and enters their password, hello password is run through hello same MD4+salt+PBKDF2+HMAC-SHA256 process.</span></span> <span data-ttu-id="bc05a-168">Pokud výsledný hash hello odpovídající hodnotě hash hello uložené ve službě Azure AD, hello uživatel zadá hello správné heslo a je ověřen.</span><span class="sxs-lookup"><span data-stu-id="bc05a-168">If hello resulting hash matches hello hash stored in Azure AD, hello user has entered hello correct password and is authenticated.</span></span> 

>[!Note] 
><span data-ttu-id="bc05a-169">Hodnota hash MD4 původní Hello není přenášená tooAzure AD.</span><span class="sxs-lookup"><span data-stu-id="bc05a-169">hello original MD4 hash is not transmitted tooAzure AD.</span></span> <span data-ttu-id="bc05a-170">Místo toho se přenášejí hello hello původní hodnota hash MD4 algoritmus hash SHA256.</span><span class="sxs-lookup"><span data-stu-id="bc05a-170">Instead, hello SHA256 hash of hello original MD4 hash is transmitted.</span></span> <span data-ttu-id="bc05a-171">Výsledkem je pokud je získali hello hash uložené ve službě Azure AD, ho nelze použít při útoku pass-the-hash místně.</span><span class="sxs-lookup"><span data-stu-id="bc05a-171">As a result, if hello hash stored in Azure AD is obtained, it cannot be used in an on-premises pass-the-hash attack.</span></span>

### <a name="how-password-synchronization-works-with-azure-active-directory-domain-services"></a><span data-ttu-id="bc05a-172">Princip funkce Synchronizace hesla s Azure Active Directory Domain Services</span><span class="sxs-lookup"><span data-stu-id="bc05a-172">How password synchronization works with Azure Active Directory Domain Services</span></span>
<span data-ttu-id="bc05a-173">Můžete také použít toosynchronize funkce Synchronizace hesla hello místních hesel příliš[Azure Active Directory Domain Services](../../active-directory-domain-services/active-directory-ds-overview.md).</span><span class="sxs-lookup"><span data-stu-id="bc05a-173">You can also use hello password synchronization feature toosynchronize your on-premises passwords too[Azure Active Directory Domain Services](../../active-directory-domain-services/active-directory-ds-overview.md).</span></span> <span data-ttu-id="bc05a-174">V tomto scénáři instanci Azure Active Directory Domain Services hello ověří vaši uživatelé v cloudu hello všechny metody hello dostupné v místní instanci služby Active Directory.</span><span class="sxs-lookup"><span data-stu-id="bc05a-174">In this scenario, hello Azure Active Directory Domain Services instance authenticates your users in hello cloud with all hello methods available in your on-premises Active Directory instance.</span></span> <span data-ttu-id="bc05a-175">činnost Hello tohoto scénáře se toousing hello podobné migrace nástroj ADMT (Active Directory) v místním prostředí.</span><span class="sxs-lookup"><span data-stu-id="bc05a-175">hello experience of this scenario is similar toousing hello Active Directory Migration Tool (ADMT) in an on-premises environment.</span></span>

### <a name="security-considerations"></a><span data-ttu-id="bc05a-176">Aspekty zabezpečení</span><span class="sxs-lookup"><span data-stu-id="bc05a-176">Security considerations</span></span>
<span data-ttu-id="bc05a-177">Při synchronizaci hesel, není ve formátu prostého textu hello vašeho hesla, funkce Synchronizace hesla zveřejněné toohello, tooAzure AD nebo všechny služby související hello.</span><span class="sxs-lookup"><span data-stu-id="bc05a-177">When synchronizing passwords, hello plain-text version of your password is not exposed toohello password synchronization feature, tooAzure AD, or any of hello associated services.</span></span>

<span data-ttu-id="bc05a-178">Ověření uživatele probíhá služby Azure AD a nikoli proti hello organizace služby Active Directory.</span><span class="sxs-lookup"><span data-stu-id="bc05a-178">User authentication takes place against Azure AD rather than against hello organization's own Active Directory instance.</span></span> <span data-ttu-id="bc05a-179">Pokud má vaše organizace pochybnostmi data hesel v žádný formulář ponechat hello místní, zvažte hello fakt, že hello SHA256 heslo data uložená ve službě Azure AD – hodnota hash hello původní hodnota hash MD4 – je výrazně bezpečnější než co je uložený ve službě Active Directory.</span><span class="sxs-lookup"><span data-stu-id="bc05a-179">If your organization has concerns about password data in any form leaving hello premises, consider hello fact that hello SHA256 password data stored in Azure AD--a hash of hello original MD4 hash--is significantly more secure than what is stored in Active Directory.</span></span> <span data-ttu-id="bc05a-180">Dál platí protože tato hodnota hash SHA256 nelze dešifrovat, nemohou být brzy vrátit prostředí služby Active Directory toohello organizace a zobrazí jako platné uživatelské heslo v rámci útoku pass-the-hash.</span><span class="sxs-lookup"><span data-stu-id="bc05a-180">Further, because this SHA256 hash cannot be decrypted, it cannot be brought back toohello organization's Active Directory environment and presented as a valid user password in a pass-the-hash attack.</span></span>





### <a name="password-policy-considerations"></a><span data-ttu-id="bc05a-181">Aspekty zásad hesel</span><span class="sxs-lookup"><span data-stu-id="bc05a-181">Password policy considerations</span></span>
<span data-ttu-id="bc05a-182">Existují dva typy zásad hesel, které jsou ovlivněné povolení synchronizace hesel:</span><span class="sxs-lookup"><span data-stu-id="bc05a-182">There are two types of password policies that are affected by enabling password synchronization:</span></span>

* <span data-ttu-id="bc05a-183">Zásady složitost hesel</span><span class="sxs-lookup"><span data-stu-id="bc05a-183">Password complexity policy</span></span>
* <span data-ttu-id="bc05a-184">Zásad vypršení platnosti hesla</span><span class="sxs-lookup"><span data-stu-id="bc05a-184">Password expiration policy</span></span>

#### <a name="password-complexity-policy"></a><span data-ttu-id="bc05a-185">Zásady složitost hesel</span><span class="sxs-lookup"><span data-stu-id="bc05a-185">Password complexity policy</span></span>  
<span data-ttu-id="bc05a-186">Pokud je povolená synchronizace hesel, zásady pro složitost hesla hello v místní instanci služby Active Directory přepsat složitost zásady v cloudu hello pro synchronizované uživatele.</span><span class="sxs-lookup"><span data-stu-id="bc05a-186">When password synchronization is enabled, hello password complexity policies in your on-premises Active Directory instance override complexity policies in hello cloud for synchronized users.</span></span> <span data-ttu-id="bc05a-187">Můžete použít všechny platné hesel hello z vaší místní služby Active Directory instance tooaccess služby Azure AD.</span><span class="sxs-lookup"><span data-stu-id="bc05a-187">You can use all of hello valid passwords from your on-premises Active Directory instance tooaccess Azure AD services.</span></span>

> [!NOTE]
> <span data-ttu-id="bc05a-188">Hesla pro uživatele, které jsou vytvořené přímo v cloudu hello jsou stále subjektu toopassword zásady, jak jsou definovány v cloudu hello.</span><span class="sxs-lookup"><span data-stu-id="bc05a-188">Passwords for users that are created directly in hello cloud are still subject toopassword policies as defined in hello cloud.</span></span>

#### <a name="password-expiration-policy"></a><span data-ttu-id="bc05a-189">Zásad vypršení platnosti hesla</span><span class="sxs-lookup"><span data-stu-id="bc05a-189">Password expiration policy</span></span>  
<span data-ttu-id="bc05a-190">Pokud je uživatel v oboru hello synchronizace hesel, je příliš nastavit heslo pro účet cloudu hello*nikdy nevyprší*.</span><span class="sxs-lookup"><span data-stu-id="bc05a-190">If a user is in hello scope of password synchronization, hello cloud account password is set too*Never Expire*.</span></span>

<span data-ttu-id="bc05a-191">Toosign může pokračovat v tooyour cloudové služby s použitím synchronizované heslo, které je vypršení její platnosti v místním prostředí.</span><span class="sxs-lookup"><span data-stu-id="bc05a-191">You can continue toosign in tooyour cloud services by using a synchronized password that is expired in your on-premises environment.</span></span> <span data-ttu-id="bc05a-192">Heslo cloudu se aktualizuje hello příští změně hesla hello v místním prostředí hello.</span><span class="sxs-lookup"><span data-stu-id="bc05a-192">Your cloud password is updated hello next time you change hello password in hello on-premises environment.</span></span>

#### <a name="account-expiration"></a><span data-ttu-id="bc05a-193">Vypršení platnosti účtu</span><span class="sxs-lookup"><span data-stu-id="bc05a-193">Account expiration</span></span>
<span data-ttu-id="bc05a-194">Pokud vaše organizace používá atribut hello AccountExpires zadává jako součást Správa uživatelských účtů, mějte na paměti, že tento atribut není synchronizovaná tooAzure AD.</span><span class="sxs-lookup"><span data-stu-id="bc05a-194">If your organization uses hello accountExpires attribute as part of user account management, be aware that this attribute is not synchronized tooAzure AD.</span></span> <span data-ttu-id="bc05a-195">V důsledku toho vypršenou platností účet služby Active Directory v prostředí nakonfigurovaná pro synchronizaci hesla bude nadále aktivní ve službě Azure AD.</span><span class="sxs-lookup"><span data-stu-id="bc05a-195">As a result, an expired Active Directory account in an environment configured for password synchronization will still be active in Azure AD.</span></span> <span data-ttu-id="bc05a-196">Doporučujeme vám, že pokud vypršela platnost účtu hello, by měly aktivovat akce pracovního postupu, skript prostředí PowerShell, která zakáže účet hello uživatele Azure AD.</span><span class="sxs-lookup"><span data-stu-id="bc05a-196">We recommend that if hello account is expired, a workflow action should trigger a PowerShell script that disables hello user's Azure AD account.</span></span> <span data-ttu-id="bc05a-197">Naopak když účet hello je zapnuté, instance služby Azure AD hello měl by být zapnut.</span><span class="sxs-lookup"><span data-stu-id="bc05a-197">Conversely, when hello account is turned on, hello Azure AD instance should be turned on.</span></span>

### <a name="overwrite-synchronized-passwords"></a><span data-ttu-id="bc05a-198">Přepsat synchronizované hesla</span><span class="sxs-lookup"><span data-stu-id="bc05a-198">Overwrite synchronized passwords</span></span>
<span data-ttu-id="bc05a-199">Správce můžete ručně obnovit heslo pomocí prostředí Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="bc05a-199">An administrator can manually reset your password by using Windows PowerShell.</span></span>

<span data-ttu-id="bc05a-200">V takovém případě nové heslo hello přepíše synchronizované heslo a nové heslo použité toohello jsou definované v cloudu hello všechny zásady pro hesla.</span><span class="sxs-lookup"><span data-stu-id="bc05a-200">In this case, hello new password overrides your synchronized password, and all password policies defined in hello cloud are applied toohello new password.</span></span>

<span data-ttu-id="bc05a-201">Pokud změníte místní heslo, nové heslo hello se synchronizují toohello cloudu a přepíše hello ručně aktualizovat hesla.</span><span class="sxs-lookup"><span data-stu-id="bc05a-201">If you change your on-premises password again, hello new password is synchronized toohello cloud, and it overrides hello manually updated password.</span></span>

<span data-ttu-id="bc05a-202">Hello synchronizace hesla nemá žádný vliv na hello Azure uživatele, který je přihlášený.</span><span class="sxs-lookup"><span data-stu-id="bc05a-202">hello synchronization of a password has no impact on hello Azure user who is signed in.</span></span> <span data-ttu-id="bc05a-203">Aktuální relace cloudové služby nemá vliv okamžitě změnu hesla synchronizované, ke kterému dochází, když jste přihlášení tooa cloudové služby.</span><span class="sxs-lookup"><span data-stu-id="bc05a-203">Your current cloud service session is not immediately affected by a synchronized password change that occurs while you're signed in tooa cloud service.</span></span> <span data-ttu-id="bc05a-204">KMSI rozšiřuje hello trvání tento rozdíl.</span><span class="sxs-lookup"><span data-stu-id="bc05a-204">KMSI extends hello duration of this difference.</span></span> <span data-ttu-id="bc05a-205">Když hello Cloudová služba vyžaduje, abyste tooauthenticate znovu, musíte tooprovide nové heslo.</span><span class="sxs-lookup"><span data-stu-id="bc05a-205">When hello cloud service requires you tooauthenticate again, you need tooprovide your new password.</span></span>

### <a name="additional-advantages"></a><span data-ttu-id="bc05a-206">Další výhody</span><span class="sxs-lookup"><span data-stu-id="bc05a-206">Additional advantages</span></span>

- <span data-ttu-id="bc05a-207">Obecně platí synchronizace hesel je jednodušší tooimplement než federační služby.</span><span class="sxs-lookup"><span data-stu-id="bc05a-207">Generally, password synchronization is simpler tooimplement than a federation service.</span></span> <span data-ttu-id="bc05a-208">Nevyžaduje žádné další servery a eliminuje závislost na vysoce dostupný federační služby tooauthenticate uživatelů.</span><span class="sxs-lookup"><span data-stu-id="bc05a-208">It doesn't require any additional servers, and eliminates dependence on a highly available federation service tooauthenticate users.</span></span> 
- <span data-ttu-id="bc05a-209">Synchronizace hesel se dá taky povolit v přidání toofederation.</span><span class="sxs-lookup"><span data-stu-id="bc05a-209">Password synchronization can also be enabled in addition toofederation.</span></span> <span data-ttu-id="bc05a-210">Mohou být použity jako zálohu Pokud své služby FS dojde k výpadku.</span><span class="sxs-lookup"><span data-stu-id="bc05a-210">It may be used as a fallback if your federation service experiences an outage.</span></span>












## <a name="enable-password-synchronization"></a><span data-ttu-id="bc05a-211">Povolení synchronizace hesel</span><span class="sxs-lookup"><span data-stu-id="bc05a-211">Enable password synchronization</span></span>
<span data-ttu-id="bc05a-212">Při instalaci Azure AD Connect s použitím hello **Expresní nastavení** možnost synchronizace hesel je automaticky povolené.</span><span class="sxs-lookup"><span data-stu-id="bc05a-212">When you install Azure AD Connect by using hello **Express Settings** option, password synchronization is automatically enabled.</span></span> <span data-ttu-id="bc05a-213">Další podrobnosti najdete v tématu [Začínáme s Azure AD Connect pomocí expresního nastavení](active-directory-aadconnect-get-started-express.md).</span><span class="sxs-lookup"><span data-stu-id="bc05a-213">For more details, see [Getting started with Azure AD Connect using express settings](active-directory-aadconnect-get-started-express.md).</span></span>

<span data-ttu-id="bc05a-214">Pokud použijete vlastní nastavení při instalaci Azure AD Connect, synchronizace hesel je k dispozici na stránce přihlášení uživatele hello.</span><span class="sxs-lookup"><span data-stu-id="bc05a-214">If you use custom settings when you install Azure AD Connect, password synchronization is available on hello user sign-in page.</span></span> <span data-ttu-id="bc05a-215">Další podrobnosti najdete v tématu [vlastní instalace Azure AD Connect](active-directory-aadconnect-get-started-custom.md).</span><span class="sxs-lookup"><span data-stu-id="bc05a-215">For more details, see [Custom installation of Azure AD Connect](active-directory-aadconnect-get-started-custom.md).</span></span>

![Povolení synchronizace hesel](./media/active-directory-aadconnectsync-implement-password-synchronization/usersignin.png)

### <a name="password-synchronization-and-fips"></a><span data-ttu-id="bc05a-217">Synchronizace hesel a FIPS</span><span class="sxs-lookup"><span data-stu-id="bc05a-217">Password synchronization and FIPS</span></span>
<span data-ttu-id="bc05a-218">Pokud váš server byl uzamčen podle tooFederal Information Processing Standard (FIPS), je zakázané MD5.</span><span class="sxs-lookup"><span data-stu-id="bc05a-218">If your server has been locked down according tooFederal Information Processing Standard (FIPS), then MD5 is disabled.</span></span>

<span data-ttu-id="bc05a-219">**tooenable MD5 pro synchronizace hesel, proveďte následující kroky hello:**</span><span class="sxs-lookup"><span data-stu-id="bc05a-219">**tooenable MD5 for password synchronization, perform hello following steps:**</span></span>

1. <span data-ttu-id="bc05a-220">Přejděte Sync\Bin too%programfiles%\Azure AD.</span><span class="sxs-lookup"><span data-stu-id="bc05a-220">Go too%programfiles%\Azure AD Sync\Bin.</span></span>
2. <span data-ttu-id="bc05a-221">Otevřete miiserver.exe.config.</span><span class="sxs-lookup"><span data-stu-id="bc05a-221">Open miiserver.exe.config.</span></span>
3. <span data-ttu-id="bc05a-222">Přejděte toohello konfigurace/runtime uzlu na konci hello hello souboru.</span><span class="sxs-lookup"><span data-stu-id="bc05a-222">Go toohello configuration/runtime node at hello end of hello file.</span></span>
4. <span data-ttu-id="bc05a-223">Přidejte hello následující uzly:`<enforceFIPSPolicy enabled="false"/>`</span><span class="sxs-lookup"><span data-stu-id="bc05a-223">Add hello following node: `<enforceFIPSPolicy enabled="false"/>`</span></span>
5. <span data-ttu-id="bc05a-224">Uložte provedené změny.</span><span class="sxs-lookup"><span data-stu-id="bc05a-224">Save your changes.</span></span>

<span data-ttu-id="bc05a-225">Pro srovnání je tento fragment kódu, co by měl vypadat jako:</span><span class="sxs-lookup"><span data-stu-id="bc05a-225">For reference, this snippet is what it should look like:</span></span>

```
    <configuration>
        <runtime>
            <enforceFIPSPolicy enabled="false"/>
        </runtime>
    </configuration>
```

<span data-ttu-id="bc05a-226">Informace o zabezpečení a FIPS najdete v tématu [AAD Sync heslo, šifrování a FIPS dodržování předpisů](https://blogs.technet.microsoft.com/enterprisemobility/2014/06/28/aad-password-sync-encryption-and-fips-compliance/).</span><span class="sxs-lookup"><span data-stu-id="bc05a-226">For information about security and FIPS, see [AAD Password Sync, encryption and FIPS compliance](https://blogs.technet.microsoft.com/enterprisemobility/2014/06/28/aad-password-sync-encryption-and-fips-compliance/).</span></span>

## <a name="troubleshoot-password-synchronization"></a><span data-ttu-id="bc05a-227">Řešení potíží s synchronizace hesel</span><span class="sxs-lookup"><span data-stu-id="bc05a-227">Troubleshoot password synchronization</span></span>
<span data-ttu-id="bc05a-228">Pokud máte problémy s synchronizace hesel, najdete v části [řešení synchronizace hesel](active-directory-aadconnectsync-troubleshoot-password-synchronization.md).</span><span class="sxs-lookup"><span data-stu-id="bc05a-228">If you have problems with password synchronization, see [Troubleshoot password synchronization](active-directory-aadconnectsync-troubleshoot-password-synchronization.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="bc05a-229">Další kroky</span><span class="sxs-lookup"><span data-stu-id="bc05a-229">Next steps</span></span>
* [<span data-ttu-id="bc05a-230">Synchronizace Azure AD Connect: přizpůsobení možnosti synchronizace</span><span class="sxs-lookup"><span data-stu-id="bc05a-230">Azure AD Connect sync: Customizing synchronization options</span></span>](active-directory-aadconnectsync-whatis.md)
* [<span data-ttu-id="bc05a-231">Integrování místních identit do služby Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="bc05a-231">Integrating your on-premises identities with Azure Active Directory</span></span>](active-directory-aadconnect.md)
