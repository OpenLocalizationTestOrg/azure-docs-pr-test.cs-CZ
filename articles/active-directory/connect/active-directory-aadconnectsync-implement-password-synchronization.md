---
title: Implementace synchronizace hesel s Azure AD Connect sync | Microsoft Docs
description: Poskytuje informace o tom, jak funguje synchronizace hesel a jak nastavit.
services: active-directory
documentationcenter: 
author: MarkusVi
manager: femila
editor: 
ms.assetid: 05f16c3e-9d23-45dc-afca-3d0fa9dbf501
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/17/2017
ms.author: billmath
ms.openlocfilehash: db9b1578a235be9018fc1985cc75a0a05ee47b3a
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/03/2017
---
# <a name="implement-password-synchronization-with-azure-ad-connect-sync"></a><span data-ttu-id="6ef78-103">Implementace synchronizace hesel s synchronizace Azure AD Connect</span><span class="sxs-lookup"><span data-stu-id="6ef78-103">Implement password synchronization with Azure AD Connect sync</span></span>
<span data-ttu-id="6ef78-104">Tento článek obsahuje informace, které potřebujete synchronizovat hesla služby uživatele z místní instance služby Active Directory do Azure Active Directory (Azure AD) instance založené na cloudu.</span><span class="sxs-lookup"><span data-stu-id="6ef78-104">This article provides information that you need to synchronize your user passwords from an on-premises Active Directory instance to a cloud-based Azure Active Directory (Azure AD) instance.</span></span>

## <a name="what-is-password-synchronization"></a><span data-ttu-id="6ef78-105">Co je synchronizace hesel</span><span class="sxs-lookup"><span data-stu-id="6ef78-105">What is password synchronization</span></span>
<span data-ttu-id="6ef78-106">Pravděpodobnost, že jste se blokovat práce s aplikací z důvodu zapomenuté heslo souvisí se počet různých hesel, je třeba pamatovat.</span><span class="sxs-lookup"><span data-stu-id="6ef78-106">The probability that you're blocked from getting your work done due to a forgotten password is related to the number of different passwords you need to remember.</span></span> <span data-ttu-id="6ef78-107">Více hesel, budete muset Pamatujte si, že čím vyšší pravděpodobnost zapomenutí jeden.</span><span class="sxs-lookup"><span data-stu-id="6ef78-107">The more passwords you need to remember, the higher the probability to forget one.</span></span> <span data-ttu-id="6ef78-108">Dotazy a volání o resetování hesla a další problémy související s hesly poptávky nejvíce zdrojů technickou podporu.</span><span class="sxs-lookup"><span data-stu-id="6ef78-108">Questions and calls about password resets and other password-related issues demand the most helpdesk resources.</span></span>

<span data-ttu-id="6ef78-109">Synchronizace hesel je funkce používá k synchronizaci hesel uživatelů z místní instance služby Active Directory k Azure cloudové AD instance.</span><span class="sxs-lookup"><span data-stu-id="6ef78-109">Password synchronization is a feature used to synchronize user passwords from an on-premises Active Directory instance to a cloud-based Azure AD instance.</span></span>
<span data-ttu-id="6ef78-110">Tato funkce slouží k přihlášení ke službám Azure AD, jako je Office 365, Microsoft Intune, CRM Online a Azure Active Directory Domain Services (Azure AD DS).</span><span class="sxs-lookup"><span data-stu-id="6ef78-110">Use this feature to sign in to Azure AD services like Office 365, Microsoft Intune, CRM Online, and Azure Active Directory Domain Services (Azure AD DS).</span></span> <span data-ttu-id="6ef78-111">Přihlášení ke službě pomocí stejné heslo, které používáte pro přihlášení k vaší místní instancí Active Directory.</span><span class="sxs-lookup"><span data-stu-id="6ef78-111">You sign in to the service by using the same password you use to sign in to your on-premises Active Directory instance.</span></span>

![Co je služba Azure AD Connect](./media/active-directory-aadconnectsync-implement-password-synchronization/arch1.png)

<span data-ttu-id="6ef78-113">Protože se sníží počet hesel, uživatelé potřebovat udržovat na právě jeden.</span><span class="sxs-lookup"><span data-stu-id="6ef78-113">By reducing the number of passwords, your users need to maintain to just one.</span></span> <span data-ttu-id="6ef78-114">Synchronizace hesel vám pomůže:</span><span class="sxs-lookup"><span data-stu-id="6ef78-114">Password synchronization helps you to:</span></span>

* <span data-ttu-id="6ef78-115">Zvýšení produktivity uživatelů.</span><span class="sxs-lookup"><span data-stu-id="6ef78-115">Improve the productivity of your users.</span></span>
* <span data-ttu-id="6ef78-116">Snižte náklady na technickou podporu.</span><span class="sxs-lookup"><span data-stu-id="6ef78-116">Reduce your helpdesk costs.</span></span>  

<span data-ttu-id="6ef78-117">Navíc pokud se rozhodnete použít [federační službou Active Directory Federation Services (AD FS)](https://channel9.msdn.com/Series/Azure-Active-Directory-Videos-Demos/Configuring-AD-FS-for-user-sign-in-with-Azure-AD-Connect), můžete volitelně můžete nastavit synchronizaci hesel jako záložní případ selhání infrastruktury služby AD FS.</span><span class="sxs-lookup"><span data-stu-id="6ef78-117">Also, if you decide to use [Federation with Active Directory Federation Services (AD FS)](https://channel9.msdn.com/Series/Azure-Active-Directory-Videos-Demos/Configuring-AD-FS-for-user-sign-in-with-Azure-AD-Connect), you can optionally set up password synchronization as a backup in case your AD FS infrastructure fails.</span></span>

<span data-ttu-id="6ef78-118">Synchronizace hesel je rozšíření pro funkci synchronizace adresáře implementované synchronizace Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="6ef78-118">Password synchronization is an extension to the directory synchronization feature implemented by Azure AD Connect sync.</span></span> <span data-ttu-id="6ef78-119">Pokud chcete používat synchronizace hesel ve vašem prostředí, budete muset:</span><span class="sxs-lookup"><span data-stu-id="6ef78-119">To use password synchronization in your environment, you need to:</span></span>

* <span data-ttu-id="6ef78-120">Instalovat Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="6ef78-120">Install Azure AD Connect.</span></span>  
* <span data-ttu-id="6ef78-121">Konfigurace synchronizace adresářů mezi vaší místní instancí Active Directory a vaše instance služby Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="6ef78-121">Configure directory synchronization between your on-premises Active Directory instance and your Azure Active Directory instance.</span></span>
* <span data-ttu-id="6ef78-122">Povolení synchronizace hesel.</span><span class="sxs-lookup"><span data-stu-id="6ef78-122">Enable password synchronization.</span></span>

<span data-ttu-id="6ef78-123">Podrobnější informace najdete v článku [Integrování místních identit do služby Azure Active Directory](active-directory-aadconnect.md).</span><span class="sxs-lookup"><span data-stu-id="6ef78-123">For more details, see [Integrating your on-premises identities with Azure Active Directory](active-directory-aadconnect.md).</span></span>

> [!NOTE]
> <span data-ttu-id="6ef78-124">Další podrobnosti o Azure Active Directory Domain Services nakonfigurovaná pro synchronizaci FIPS a heslo najdete v části "synchronizace hesel a FIPS" později v tomto článku.</span><span class="sxs-lookup"><span data-stu-id="6ef78-124">For more details about Azure Active Directory Domain Services configured for FIPS and password synchronization, see "Password synchronization and FIPS" later in this article.</span></span>
>
>

## <a name="how-password-synchronization-works"></a><span data-ttu-id="6ef78-125">Princip funkce Synchronizace hesla</span><span class="sxs-lookup"><span data-stu-id="6ef78-125">How password synchronization works</span></span>
<span data-ttu-id="6ef78-126">Služba Active Directory domain Services ukládá ve formě reprezentace hodnotu hash hesla skutečného uživatelského hesla.</span><span class="sxs-lookup"><span data-stu-id="6ef78-126">The Active Directory domain service stores passwords in the form of a hash value representation of the actual user password.</span></span> <span data-ttu-id="6ef78-127">Hodnota hash je výsledek jednosměrné matematické funkce ( *algoritmus hash*).</span><span class="sxs-lookup"><span data-stu-id="6ef78-127">A hash value is a result of a one-way mathematical function (the *hashing algorithm*).</span></span> <span data-ttu-id="6ef78-128">Neexistuje žádná metoda vrátit výsledek jednosměrné funkce na prostý text verzi heslo.</span><span class="sxs-lookup"><span data-stu-id="6ef78-128">There is no method to revert the result of a one-way function to the plain text version of a password.</span></span> <span data-ttu-id="6ef78-129">Hodnoty hash hesla nelze použít pro přihlášení k síti na pracovišti.</span><span class="sxs-lookup"><span data-stu-id="6ef78-129">You cannot use a password hash to sign in to your on-premises network.</span></span>

<span data-ttu-id="6ef78-130">Synchronizace Azure AD Connect Pokud chcete synchronizovat hesla, extrahuje vaše hodnoty hash hesla z místní instance služby Active Directory.</span><span class="sxs-lookup"><span data-stu-id="6ef78-130">To synchronize your password, Azure AD Connect sync extracts your password hash from the on-premises Active Directory instance.</span></span> <span data-ttu-id="6ef78-131">Další bezpečnostní zpracování se použije pro hodnoty hash hesla před synchronizací k ověřovací službě Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="6ef78-131">Extra security processing is applied to the password hash before it is synchronized to the Azure Active Directory authentication service.</span></span> <span data-ttu-id="6ef78-132">Hesla se synchronizují na jednotlivé uživatele a v chronologickém pořadí.</span><span class="sxs-lookup"><span data-stu-id="6ef78-132">Passwords are synchronized on a per-user basis and in chronological order.</span></span>

<span data-ttu-id="6ef78-133">Samotný datový tok proces synchronizace hesla je podobná synchronizace uživatelských dat, jako je například DisplayName nebo e-mailové adresy.</span><span class="sxs-lookup"><span data-stu-id="6ef78-133">The actual data flow of the password synchronization process is similar to the synchronization of user data such as DisplayName or Email Addresses.</span></span> <span data-ttu-id="6ef78-134">Ale hesla se synchronizují častěji, než standardní directory okna synchronizace pro ostatní atributy.</span><span class="sxs-lookup"><span data-stu-id="6ef78-134">However, passwords are synchronized more frequently than the standard directory synchronization window for other attributes.</span></span> <span data-ttu-id="6ef78-135">Proces synchronizace hesel spustí každé dvě minuty.</span><span class="sxs-lookup"><span data-stu-id="6ef78-135">The password synchronization process runs every 2 minutes.</span></span> <span data-ttu-id="6ef78-136">Nelze změnit frekvenci tohoto procesu.</span><span class="sxs-lookup"><span data-stu-id="6ef78-136">You cannot modify the frequency of this process.</span></span> <span data-ttu-id="6ef78-137">Při synchronizaci hesla, přepíše stávající heslo cloudu.</span><span class="sxs-lookup"><span data-stu-id="6ef78-137">When you synchronize a password, it overwrites the existing cloud password.</span></span>

<span data-ttu-id="6ef78-138">Při prvním povolení funkce Synchronizace hesla, provede počáteční synchronizaci hesel všech uživatelů v oboru.</span><span class="sxs-lookup"><span data-stu-id="6ef78-138">The first time you enable the password synchronization feature, it performs an initial synchronization of the passwords of all in-scope users.</span></span> <span data-ttu-id="6ef78-139">Nemůže explicitně definovat podmnožinu uživatelská hesla, které chcete synchronizovat.</span><span class="sxs-lookup"><span data-stu-id="6ef78-139">You cannot explicitly define a subset of user passwords that you want to synchronize.</span></span>

<span data-ttu-id="6ef78-140">Pokud změníte heslo k místní, aktualizované heslo je synchronizován, nejčastěji během několika minut.</span><span class="sxs-lookup"><span data-stu-id="6ef78-140">When you change an on-premises password, the updated password is synchronized, most often in a matter of minutes.</span></span>
<span data-ttu-id="6ef78-141">Funkce Synchronizace hesla automaticky opakovat pokusy o synchronizaci se nezdařilo.</span><span class="sxs-lookup"><span data-stu-id="6ef78-141">The password synchronization feature automatically retries failed synchronization attempts.</span></span> <span data-ttu-id="6ef78-142">Pokud dojde k chybě při pokusu o synchronizaci hesla, je váš prohlížeč událostí přihlášení k chybě.</span><span class="sxs-lookup"><span data-stu-id="6ef78-142">If an error occurs during an attempt to synchronize a password, an error is logged in your event viewer.</span></span>

<span data-ttu-id="6ef78-143">Synchronizace hesla nemá žádný vliv na uživatele, který je aktuálně přihlášený.</span><span class="sxs-lookup"><span data-stu-id="6ef78-143">The synchronization of a password has no impact on the user  who is currently signed in.</span></span>
<span data-ttu-id="6ef78-144">Aktuální relace cloudové služby nemá vliv okamžitě změnu hesla synchronizované, ke kterému dochází, když jste přihlášení ke cloudové službě.</span><span class="sxs-lookup"><span data-stu-id="6ef78-144">Your current cloud service session is not immediately affected by a synchronized password change that occurs while you are signed in to a cloud service.</span></span> <span data-ttu-id="6ef78-145">Ale při Cloudová služba vyžaduje, abyste pokus o ověření, musíte zadat nové heslo.</span><span class="sxs-lookup"><span data-stu-id="6ef78-145">However, when the cloud service requires you to authenticate again, you need to provide your new password.</span></span>

<span data-ttu-id="6ef78-146">Uživatel musí zadat svoje podnikové přihlašovací údaje ještě jednou k ověření do služby Azure AD, bez ohledu na to, jestli jsou přihlášení k podnikové síti.</span><span class="sxs-lookup"><span data-stu-id="6ef78-146">A user must enter their corporate credentials a second time to authenticate to Azure AD, regardless of whether they're signed in to their corporate network.</span></span> <span data-ttu-id="6ef78-147">Tyto vzor můžete minimalizovat, ale pokud uživatel vybere zachovat mi podepsané v políčko (KMSI) při přihlašování.</span><span class="sxs-lookup"><span data-stu-id="6ef78-147">These pattern can be minimized, however, if the user selects the Keep me signed in (KMSI) check box at sign in.</span></span> <span data-ttu-id="6ef78-148">Tento výběr nastaví soubor cookie relace, který obchází ověřování na krátkou dobu.</span><span class="sxs-lookup"><span data-stu-id="6ef78-148">This selection sets a session cookie that bypasses authentication for a short period.</span></span> <span data-ttu-id="6ef78-149">Chování KMSI můžete povolit nebo zakázat pomocí Správce Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6ef78-149">KMSI behavior can be enabled or disabled by the Azure AD administrator.</span></span>

> [!NOTE]
> <span data-ttu-id="6ef78-150">Synchronizace hesla je podporována pouze pro uživatele typu objektu ve službě Active Directory.</span><span class="sxs-lookup"><span data-stu-id="6ef78-150">Password sync is only supported for the object type user in Active Directory.</span></span> <span data-ttu-id="6ef78-151">Nepodporuje pro typ objektu iNetOrgPerson.</span><span class="sxs-lookup"><span data-stu-id="6ef78-151">It is not supported for the iNetOrgPerson object type.</span></span>

### <a name="detailed-description-of-how-password-synchronization-works"></a><span data-ttu-id="6ef78-152">Podrobný popis toho, jak funguje synchronizace hesel</span><span class="sxs-lookup"><span data-stu-id="6ef78-152">Detailed description of how password synchronization works</span></span>
<span data-ttu-id="6ef78-153">Následující text popisuje podrobný Princip funkce Synchronizace hesla mezi služby Active Directory a Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6ef78-153">The following describes in-depth how password synchronization works between Active Directory and Azure AD.</span></span>

![Tok podrobné heslo](./media/active-directory-aadconnectsync-implement-password-synchronization/arch3.png)


1. <span data-ttu-id="6ef78-155">Každé dvě minuty, agent synchronizace hesel na server AD Connect požadavky hodnot hash hesel uložených (atribut unicodePwd) z řadiče domény přes standardní [MS-DRSR](https://msdn.microsoft.com/library/cc228086.aspx) replikace protokol použitý k synchronizaci dat mezi Řadiče domény.</span><span class="sxs-lookup"><span data-stu-id="6ef78-155">Every two minutes, the password synchronization agent on the AD Connect server requests stored password hashes (the unicodePwd attribute) from a DC via the standard [MS-DRSR](https://msdn.microsoft.com/library/cc228086.aspx) replication protocol used to synchronize data between DCs.</span></span> <span data-ttu-id="6ef78-156">Účet služby musí mít replikovat změny adresáře a replikovat Directory změny všechna AD oprávnění (udělena na instalaci ve výchozím nastavení) k získání hodnoty hash hesla.</span><span class="sxs-lookup"><span data-stu-id="6ef78-156">The service account must have Replicate Directory Changes and Replicate Directory Changes All AD permissions (granted by default on installation) to obtain the password hashes.</span></span>
2. <span data-ttu-id="6ef78-157">Před odesláním, řadič domény šifruje hodnota hash MD4 hesla pomocí klíče, který je [MD5](http://www.rfc-editor.org/rfc/rfc1321.txt) hash klíče relace RPC a salt.</span><span class="sxs-lookup"><span data-stu-id="6ef78-157">Before sending, the DC encrypts the MD4 password hash by using a key that is a [MD5](http://www.rfc-editor.org/rfc/rfc1321.txt) hash of the RPC session key and a salt.</span></span> <span data-ttu-id="6ef78-158">Potom odesílá výsledek agent synchronizace hesel pomocí protokolu RPC.</span><span class="sxs-lookup"><span data-stu-id="6ef78-158">It then sends the result to the password synchronization agent over RPC.</span></span> <span data-ttu-id="6ef78-159">Řadič domény také předá salt agent synchronizace s využitím protokolu replikace řadiče domény, tak, že agent bude moci dešifrovat obálku.</span><span class="sxs-lookup"><span data-stu-id="6ef78-159">The DC also passes the salt to the synchronization agent by using the DC replication protocol, so the agent will be able to decrypt the envelope.</span></span>
3.  <span data-ttu-id="6ef78-160">Po agent synchronizace hesel je má šifrované obálky, používá [MD5CryptoServiceProvider](https://msdn.microsoft.com/library/System.Security.Cryptography.MD5CryptoServiceProvider.aspx) a salt chcete vygenerovat klíč pro dešifrování přijatých dat. zpět do původního MD4.</span><span class="sxs-lookup"><span data-stu-id="6ef78-160">After the password synchronization agent has the encrypted envelope, it uses [MD5CryptoServiceProvider](https://msdn.microsoft.com/library/System.Security.Cryptography.MD5CryptoServiceProvider.aspx) and the salt to generate a key to decrypt the received data back to its original MD4 format.</span></span> <span data-ttu-id="6ef78-161">Na žádný bod agent synchronizace hesel mít přístup k hesla v nešifrovaném textu.</span><span class="sxs-lookup"><span data-stu-id="6ef78-161">At no point does the password synchronization agent have access to the clear text password.</span></span> <span data-ttu-id="6ef78-162">Agent synchronizace hesel použití algoritmu MD5 je určené výhradně pro kompatibilitu s protokolem replikace se serverem DC a používá se pouze místní mezi řadič domény a agent synchronizace hesel.</span><span class="sxs-lookup"><span data-stu-id="6ef78-162">The password synchronization agent’s use of MD5 is strictly for replication protocol compatibility with the DC, and it is only used on premises between the DC and the password synchronization agent.</span></span>
4.  <span data-ttu-id="6ef78-163">Agent synchronizace hesel rozšíří hodnota hash hesla binární 16 bajtů na 64 bajtů převedením první hodnotu hash na hexadecimální řetězec 32 bajtů, pak převedete tento řetězec zpět do binární kódování UTF-16.</span><span class="sxs-lookup"><span data-stu-id="6ef78-163">The password synchronization agent expands the 16-byte binary password hash to 64 bytes by first converting the hash to a 32-byte hexadecimal string, then converting this string back into binary with UTF-16 encoding.</span></span>
5.  <span data-ttu-id="6ef78-164">Agent synchronizace hesel přidá salt, skládající se z délka v bajtech 10 salt, na binární soubor 64 bajtů dalším stupněm ochrany původní hodnota hash.</span><span class="sxs-lookup"><span data-stu-id="6ef78-164">The password synchronization agent adds a salt, consisting of a 10-byte length salt, to the 64-byte binary to further protect the original hash.</span></span>
6.  <span data-ttu-id="6ef78-165">Agent synchronizace hesel pak kombinuje hodnota hash MD4 plus salt a vstup do [PBKDF2](https://www.ietf.org/rfc/rfc2898.txt) funkce.</span><span class="sxs-lookup"><span data-stu-id="6ef78-165">The password synchronization agent then combines the MD4 hash plus salt, and inputs it into the [PBKDF2](https://www.ietf.org/rfc/rfc2898.txt) function.</span></span> <span data-ttu-id="6ef78-166">1 000 iterací [HMAC SHA256](https://msdn.microsoft.com/library/system.security.cryptography.hmacsha256.aspx) klíčovaný algoritmus hash se používá.</span><span class="sxs-lookup"><span data-stu-id="6ef78-166">1000 iterations of the [HMAC-SHA256](https://msdn.microsoft.com/library/system.security.cryptography.hmacsha256.aspx) keyed hashing algorithm is used.</span></span> 
7.  <span data-ttu-id="6ef78-167">Agent synchronizace hesel trvá výsledná hodnota hash 32 bajtů, zřetězí salt a počet iterací SHA256 k němu (pro použití služby Azure AD) a pak přes protokol SSL přenáší řetězec z Azure AD Connect do služby Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6ef78-167">The password synchronization agent takes the resulting 32-byte hash, concatenates both the salt and the number of SHA256 iterations to it (for use by Azure AD), then transmits the string from Azure AD Connect to Azure AD over SSL.</span></span></br> 
8.  <span data-ttu-id="6ef78-168">Když se uživatel pokusí přihlásit k Azure AD a zadá své heslo, je heslo spusťte pomocí stejné MD4 + řetězce salt + PBKDF2 + HMAC SHA256 procesu.</span><span class="sxs-lookup"><span data-stu-id="6ef78-168">When a user attempts to sign in to Azure AD and enters their password, the password is run through the same MD4+salt+PBKDF2+HMAC-SHA256 process.</span></span> <span data-ttu-id="6ef78-169">Pokud výsledná hodnota hash odpovídající hodnotě hash uložené ve službě Azure AD, uživatel zadá správné heslo a je ověřen.</span><span class="sxs-lookup"><span data-stu-id="6ef78-169">If the resulting hash matches the hash stored in Azure AD, the user has entered the correct password and is authenticated.</span></span> 

>[!Note] 
><span data-ttu-id="6ef78-170">Původní hodnota hash MD4 není přenést do služby Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6ef78-170">The original MD4 hash is not transmitted to Azure AD.</span></span> <span data-ttu-id="6ef78-171">Místo toho je hodnota hash SHA256 původní hodnota hash MD4 nepřenáší.</span><span class="sxs-lookup"><span data-stu-id="6ef78-171">Instead, the SHA256 hash of the original MD4 hash is transmitted.</span></span> <span data-ttu-id="6ef78-172">Výsledkem je pokud je hodnota hash uložené ve službě Azure AD získali, ho nelze použít při útoku pass-the-hash místně.</span><span class="sxs-lookup"><span data-stu-id="6ef78-172">As a result, if the hash stored in Azure AD is obtained, it cannot be used in an on-premises pass-the-hash attack.</span></span>

### <a name="how-password-synchronization-works-with-azure-active-directory-domain-services"></a><span data-ttu-id="6ef78-173">Princip funkce Synchronizace hesla s Azure Active Directory Domain Services</span><span class="sxs-lookup"><span data-stu-id="6ef78-173">How password synchronization works with Azure Active Directory Domain Services</span></span>
<span data-ttu-id="6ef78-174">Pomocí funkce Synchronizace hesla můžete také synchronizovat hesla služby místně do [Azure Active Directory Domain Services](../../active-directory-domain-services/active-directory-ds-overview.md).</span><span class="sxs-lookup"><span data-stu-id="6ef78-174">You can also use the password synchronization feature to synchronize your on-premises passwords to [Azure Active Directory Domain Services](../../active-directory-domain-services/active-directory-ds-overview.md).</span></span> <span data-ttu-id="6ef78-175">V tomto scénáři instanci Azure Active Directory Domain Services se všechny metody dostupné v místní instanci služby Active Directory ověřuje vaši uživatelé v cloudu.</span><span class="sxs-lookup"><span data-stu-id="6ef78-175">In this scenario, the Azure Active Directory Domain Services instance authenticates your users in the cloud with all the methods available in your on-premises Active Directory instance.</span></span> <span data-ttu-id="6ef78-176">Možnosti tohoto scénáře je podobná pomocí migrace nástroj ADMT (Active Directory) v místním prostředí.</span><span class="sxs-lookup"><span data-stu-id="6ef78-176">The experience of this scenario is similar to using the Active Directory Migration Tool (ADMT) in an on-premises environment.</span></span>

### <a name="security-considerations"></a><span data-ttu-id="6ef78-177">Aspekty zabezpečení</span><span class="sxs-lookup"><span data-stu-id="6ef78-177">Security considerations</span></span>
<span data-ttu-id="6ef78-178">Při synchronizaci hesel, není pro funkci Synchronizace hesel do služby Azure AD, ani žádný z přidružených službách zpřístupněná heslo ve formátu prostého textu.</span><span class="sxs-lookup"><span data-stu-id="6ef78-178">When synchronizing passwords, the plain-text version of your password is not exposed to the password synchronization feature, to Azure AD, or any of the associated services.</span></span>

<span data-ttu-id="6ef78-179">Ověření uživatele probíhá služby Azure AD a nikoli proti instanci Active Directory organizace.</span><span class="sxs-lookup"><span data-stu-id="6ef78-179">User authentication takes place against Azure AD rather than against the organization's own Active Directory instance.</span></span> <span data-ttu-id="6ef78-180">Pokud má vaše organizace pochybnostmi data hesel v žádném formuláři a místním, třeba vzít v úvahu, že data heslo SHA256 uložená ve službě Azure AD – hodnota hash původní hodnota hash MD4 – je výrazně bezpečnější než co je uložený ve službě Active Directory.</span><span class="sxs-lookup"><span data-stu-id="6ef78-180">If your organization has concerns about password data in any form leaving the premises, consider the fact that the SHA256 password data stored in Azure AD--a hash of the original MD4 hash--is significantly more secure than what is stored in Active Directory.</span></span> <span data-ttu-id="6ef78-181">Dál platí protože tato hodnota hash SHA256 nelze dešifrovat, nemohou být brzy vrátit do prostředí služby Active Directory organizace a zobrazí jako platné uživatelské heslo v rámci útoku pass-the-hash.</span><span class="sxs-lookup"><span data-stu-id="6ef78-181">Further, because this SHA256 hash cannot be decrypted, it cannot be brought back to the organization's Active Directory environment and presented as a valid user password in a pass-the-hash attack.</span></span>





### <a name="password-policy-considerations"></a><span data-ttu-id="6ef78-182">Aspekty zásad hesel</span><span class="sxs-lookup"><span data-stu-id="6ef78-182">Password policy considerations</span></span>
<span data-ttu-id="6ef78-183">Existují dva typy zásad hesel, které jsou ovlivněné povolení synchronizace hesel:</span><span class="sxs-lookup"><span data-stu-id="6ef78-183">There are two types of password policies that are affected by enabling password synchronization:</span></span>

* <span data-ttu-id="6ef78-184">Zásady složitost hesel</span><span class="sxs-lookup"><span data-stu-id="6ef78-184">Password complexity policy</span></span>
* <span data-ttu-id="6ef78-185">Zásad vypršení platnosti hesla</span><span class="sxs-lookup"><span data-stu-id="6ef78-185">Password expiration policy</span></span>

#### <a name="password-complexity-policy"></a><span data-ttu-id="6ef78-186">Zásady složitost hesel</span><span class="sxs-lookup"><span data-stu-id="6ef78-186">Password complexity policy</span></span>  
<span data-ttu-id="6ef78-187">Pokud je povolená synchronizace hesel, zásady složitost hesel v místní instanci služby Active Directory přepsat zásady složitost v cloudu pro synchronizované uživatele.</span><span class="sxs-lookup"><span data-stu-id="6ef78-187">When password synchronization is enabled, the password complexity policies in your on-premises Active Directory instance override complexity policies in the cloud for synchronized users.</span></span> <span data-ttu-id="6ef78-188">Všechny platné hesel můžete použít z vaší místní instancí Active Directory pro přístup ke službám Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6ef78-188">You can use all of the valid passwords from your on-premises Active Directory instance to access Azure AD services.</span></span>

> [!NOTE]
> <span data-ttu-id="6ef78-189">Hesla pro uživatele, které jsou vytvořené přímo v cloudu se stále vztahují zásady pro hesla, jak jsou definovány v cloudu.</span><span class="sxs-lookup"><span data-stu-id="6ef78-189">Passwords for users that are created directly in the cloud are still subject to password policies as defined in the cloud.</span></span>

#### <a name="password-expiration-policy"></a><span data-ttu-id="6ef78-190">Zásad vypršení platnosti hesla</span><span class="sxs-lookup"><span data-stu-id="6ef78-190">Password expiration policy</span></span>  
<span data-ttu-id="6ef78-191">Pokud je uživatel v rozsahu synchronizace hesel, heslo k účtu cloudu nastavená na *nikdy nevyprší*.</span><span class="sxs-lookup"><span data-stu-id="6ef78-191">If a user is in the scope of password synchronization, the cloud account password is set to *Never Expire*.</span></span>

<span data-ttu-id="6ef78-192">Můžete se přihlásit ke cloudovým službám pomocí synchronizované heslo, které je vypršení její platnosti v místním prostředí.</span><span class="sxs-lookup"><span data-stu-id="6ef78-192">You can continue to sign in to your cloud services by using a synchronized password that is expired in your on-premises environment.</span></span> <span data-ttu-id="6ef78-193">Heslo cloudu je aktualizována při příštím změny hesla v místním prostředí.</span><span class="sxs-lookup"><span data-stu-id="6ef78-193">Your cloud password is updated the next time you change the password in the on-premises environment.</span></span>

#### <a name="account-expiration"></a><span data-ttu-id="6ef78-194">Vypršení platnosti účtu</span><span class="sxs-lookup"><span data-stu-id="6ef78-194">Account expiration</span></span>
<span data-ttu-id="6ef78-195">Pokud vaše organizace používá atribut AccountExpires zadává jako součást Správa uživatelských účtů, mějte na paměti, že tento atribut není synchronizována do Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6ef78-195">If your organization uses the accountExpires attribute as part of user account management, be aware that this attribute is not synchronized to Azure AD.</span></span> <span data-ttu-id="6ef78-196">V důsledku toho vypršenou platností účet služby Active Directory v prostředí nakonfigurovaná pro synchronizaci hesla bude nadále aktivní ve službě Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6ef78-196">As a result, an expired Active Directory account in an environment configured for password synchronization will still be active in Azure AD.</span></span> <span data-ttu-id="6ef78-197">Doporučujeme vám, že pokud účet vypršela platnost, by měly aktivovat akce pracovního postupu, skript prostředí PowerShell, která zakáže účtu uživatele Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6ef78-197">We recommend that if the account is expired, a workflow action should trigger a PowerShell script that disables the user's Azure AD account.</span></span> <span data-ttu-id="6ef78-198">Naopak když účet je zapnuté, instancí Azure AD by měl být zapnut.</span><span class="sxs-lookup"><span data-stu-id="6ef78-198">Conversely, when the account is turned on, the Azure AD instance should be turned on.</span></span>

### <a name="overwrite-synchronized-passwords"></a><span data-ttu-id="6ef78-199">Přepsat synchronizované hesla</span><span class="sxs-lookup"><span data-stu-id="6ef78-199">Overwrite synchronized passwords</span></span>
<span data-ttu-id="6ef78-200">Správce můžete ručně obnovit heslo pomocí prostředí Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="6ef78-200">An administrator can manually reset your password by using Windows PowerShell.</span></span>

<span data-ttu-id="6ef78-201">V takovém případě nové heslo přepíše synchronizované heslo a všechny zásady hesel, které jsou definované v cloudu se použijí k nové heslo.</span><span class="sxs-lookup"><span data-stu-id="6ef78-201">In this case, the new password overrides your synchronized password, and all password policies defined in the cloud are applied to the new password.</span></span>

<span data-ttu-id="6ef78-202">Pokud změníte heslo místní znovu nové heslo se synchronizují do cloudu, a přepíše ručně aktualizované heslo.</span><span class="sxs-lookup"><span data-stu-id="6ef78-202">If you change your on-premises password again, the new password is synchronized to the cloud, and it overrides the manually updated password.</span></span>

<span data-ttu-id="6ef78-203">Synchronizace hesla nemá žádný vliv na Azure uživatele, který je přihlášený.</span><span class="sxs-lookup"><span data-stu-id="6ef78-203">The synchronization of a password has no impact on the Azure user who is signed in.</span></span> <span data-ttu-id="6ef78-204">Aktuální relace cloudové služby nemá vliv okamžitě změnu hesla synchronizované, ke kterému dochází, když jste přihlášení ke cloudové službě.</span><span class="sxs-lookup"><span data-stu-id="6ef78-204">Your current cloud service session is not immediately affected by a synchronized password change that occurs while you're signed in to a cloud service.</span></span> <span data-ttu-id="6ef78-205">KMSI rozšiřuje trvání tento rozdíl.</span><span class="sxs-lookup"><span data-stu-id="6ef78-205">KMSI extends the duration of this difference.</span></span> <span data-ttu-id="6ef78-206">Cloudová služba vyžaduje, abyste provést ověření znovu, budete muset zadat nové heslo.</span><span class="sxs-lookup"><span data-stu-id="6ef78-206">When the cloud service requires you to authenticate again, you need to provide your new password.</span></span>

### <a name="additional-advantages"></a><span data-ttu-id="6ef78-207">Další výhody</span><span class="sxs-lookup"><span data-stu-id="6ef78-207">Additional advantages</span></span>

- <span data-ttu-id="6ef78-208">Obecně platí je jednodušší než federační služby implementace synchronizace hesel.</span><span class="sxs-lookup"><span data-stu-id="6ef78-208">Generally, password synchronization is simpler to implement than a federation service.</span></span> <span data-ttu-id="6ef78-209">Nevyžaduje žádné další servery a eliminuje závislost na vysoce dostupný federační služby k ověřování uživatelů.</span><span class="sxs-lookup"><span data-stu-id="6ef78-209">It doesn't require any additional servers, and eliminates dependence on a highly available federation service to authenticate users.</span></span> 
- <span data-ttu-id="6ef78-210">Kromě federačních může být rovněž povolena synchronizace hesel.</span><span class="sxs-lookup"><span data-stu-id="6ef78-210">Password synchronization can also be enabled in addition to federation.</span></span> <span data-ttu-id="6ef78-211">Mohou být použity jako zálohu Pokud své služby FS dojde k výpadku.</span><span class="sxs-lookup"><span data-stu-id="6ef78-211">It may be used as a fallback if your federation service experiences an outage.</span></span>












## <a name="enable-password-synchronization"></a><span data-ttu-id="6ef78-212">Povolení synchronizace hesel</span><span class="sxs-lookup"><span data-stu-id="6ef78-212">Enable password synchronization</span></span>
<span data-ttu-id="6ef78-213">Při instalaci Azure AD Connect s použitím **Expresní nastavení** možnost synchronizace hesel je automaticky povolené.</span><span class="sxs-lookup"><span data-stu-id="6ef78-213">When you install Azure AD Connect by using the **Express Settings** option, password synchronization is automatically enabled.</span></span> <span data-ttu-id="6ef78-214">Další podrobnosti najdete v tématu [Začínáme s Azure AD Connect pomocí expresního nastavení](active-directory-aadconnect-get-started-express.md).</span><span class="sxs-lookup"><span data-stu-id="6ef78-214">For more details, see [Getting started with Azure AD Connect using express settings](active-directory-aadconnect-get-started-express.md).</span></span>

<span data-ttu-id="6ef78-215">Pokud použijete vlastní nastavení při instalaci Azure AD Connect, synchronizace hesel je k dispozici na přihlašovací stránce uživatele.</span><span class="sxs-lookup"><span data-stu-id="6ef78-215">If you use custom settings when you install Azure AD Connect, password synchronization is available on the user sign-in page.</span></span> <span data-ttu-id="6ef78-216">Další podrobnosti najdete v tématu [vlastní instalace Azure AD Connect](active-directory-aadconnect-get-started-custom.md).</span><span class="sxs-lookup"><span data-stu-id="6ef78-216">For more details, see [Custom installation of Azure AD Connect](active-directory-aadconnect-get-started-custom.md).</span></span>

![Povolení synchronizace hesel](./media/active-directory-aadconnectsync-implement-password-synchronization/usersignin.png)

### <a name="password-synchronization-and-fips"></a><span data-ttu-id="6ef78-218">Synchronizace hesel a FIPS</span><span class="sxs-lookup"><span data-stu-id="6ef78-218">Password synchronization and FIPS</span></span>
<span data-ttu-id="6ef78-219">Pokud váš server byl uzamčen podle informace o zpracování FIPS (Federal Standard), je zakázané MD5.</span><span class="sxs-lookup"><span data-stu-id="6ef78-219">If your server has been locked down according to Federal Information Processing Standard (FIPS), then MD5 is disabled.</span></span>

<span data-ttu-id="6ef78-220">**Povolit synchronizaci hesel MD5, proveďte následující kroky:**</span><span class="sxs-lookup"><span data-stu-id="6ef78-220">**To enable MD5 for password synchronization, perform the following steps:**</span></span>

1. <span data-ttu-id="6ef78-221">Přejděte na Sync\Bin %programfiles%\Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6ef78-221">Go to %programfiles%\Azure AD Sync\Bin.</span></span>
2. <span data-ttu-id="6ef78-222">Otevřete miiserver.exe.config.</span><span class="sxs-lookup"><span data-stu-id="6ef78-222">Open miiserver.exe.config.</span></span>
3. <span data-ttu-id="6ef78-223">Přejděte do uzlu Konfigurace nebo modul runtime na konci souboru.</span><span class="sxs-lookup"><span data-stu-id="6ef78-223">Go to the configuration/runtime node at the end of the file.</span></span>
4. <span data-ttu-id="6ef78-224">Přidejte následující uzly:`<enforceFIPSPolicy enabled="false"/>`</span><span class="sxs-lookup"><span data-stu-id="6ef78-224">Add the following node: `<enforceFIPSPolicy enabled="false"/>`</span></span>
5. <span data-ttu-id="6ef78-225">Uložte provedené změny.</span><span class="sxs-lookup"><span data-stu-id="6ef78-225">Save your changes.</span></span>

<span data-ttu-id="6ef78-226">Pro srovnání je tento fragment kódu, co by měl vypadat jako:</span><span class="sxs-lookup"><span data-stu-id="6ef78-226">For reference, this snippet is what it should look like:</span></span>

```
    <configuration>
        <runtime>
            <enforceFIPSPolicy enabled="false"/>
        </runtime>
    </configuration>
```

<span data-ttu-id="6ef78-227">Informace o zabezpečení a FIPS najdete v tématu [AAD Sync heslo, šifrování a FIPS dodržování předpisů](https://blogs.technet.microsoft.com/enterprisemobility/2014/06/28/aad-password-sync-encryption-and-fips-compliance/).</span><span class="sxs-lookup"><span data-stu-id="6ef78-227">For information about security and FIPS, see [AAD Password Sync, encryption and FIPS compliance](https://blogs.technet.microsoft.com/enterprisemobility/2014/06/28/aad-password-sync-encryption-and-fips-compliance/).</span></span>

## <a name="troubleshoot-password-synchronization"></a><span data-ttu-id="6ef78-228">Řešení potíží s synchronizace hesel</span><span class="sxs-lookup"><span data-stu-id="6ef78-228">Troubleshoot password synchronization</span></span>
<span data-ttu-id="6ef78-229">Pokud máte problémy s synchronizace hesel, najdete v části [řešení synchronizace hesel](active-directory-aadconnectsync-troubleshoot-password-synchronization.md).</span><span class="sxs-lookup"><span data-stu-id="6ef78-229">If you have problems with password synchronization, see [Troubleshoot password synchronization](active-directory-aadconnectsync-troubleshoot-password-synchronization.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="6ef78-230">Další kroky</span><span class="sxs-lookup"><span data-stu-id="6ef78-230">Next steps</span></span>
* [<span data-ttu-id="6ef78-231">Synchronizace Azure AD Connect: přizpůsobení možnosti synchronizace</span><span class="sxs-lookup"><span data-stu-id="6ef78-231">Azure AD Connect sync: Customizing synchronization options</span></span>](active-directory-aadconnectsync-whatis.md)
* [<span data-ttu-id="6ef78-232">Integrování místních identit do služby Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="6ef78-232">Integrating your on-premises identities with Azure Active Directory</span></span>](active-directory-aadconnect.md)
