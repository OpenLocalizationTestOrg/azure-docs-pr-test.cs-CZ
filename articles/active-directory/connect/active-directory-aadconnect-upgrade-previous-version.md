---
title: "Azure AD Connect: Upgrade z předchozí verze | Microsoft Docs"
description: "Vysvětluje různé metody pro upgrade na nejnovější verzi Azure Active Directory Connect, včetně místní upgrade a migrace dráha."
services: active-directory
documentationcenter: 
author: AndKjell
manager: femila
editor: 
ms.assetid: 31f084d8-2b89-478c-9079-76cf92e6618f
ms.service: active-directory
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: Identity
ms.date: 07/12/2017
ms.author: billmath
ms.openlocfilehash: 52fd9375c71c42feaf87f4a0f4220e1cb3889e63
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/03/2017
---
# <a name="azure-ad-connect-upgrade-from-a-previous-version-to-the-latest"></a><span data-ttu-id="c16fe-103">Azure AD Connect: Upgrade z předchozí verze na nejnovější</span><span class="sxs-lookup"><span data-stu-id="c16fe-103">Azure AD Connect: Upgrade from a previous version to the latest</span></span>
<span data-ttu-id="c16fe-104">Toto téma popisuje různé metody, které můžete použít k upgradu vaší instalace služby Azure Active Directory (Azure AD) Connect na nejnovější verzi.</span><span class="sxs-lookup"><span data-stu-id="c16fe-104">This topic describes the different methods that you can use to upgrade your Azure Active Directory (Azure AD) Connect installation to the latest release.</span></span> <span data-ttu-id="c16fe-105">Doporučujeme ponechat si sami aktuální verze služby Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="c16fe-105">We recommend that you keep yourself current with the releases of Azure AD Connect.</span></span> <span data-ttu-id="c16fe-106">Můžete také použít kroky v [kyvu migrace](#swing-migration) části při provedení podstatných změn v konfiguraci.</span><span class="sxs-lookup"><span data-stu-id="c16fe-106">You also use the steps in the [Swing migration](#swing-migration) section when you make a substantial configuration change.</span></span>

<span data-ttu-id="c16fe-107">Pokud chcete provést upgrade z nástroje DirSync, přečtěte si téma [Upgrade ze synchronizačního nástroje služby Azure AD (DirSync)](active-directory-aadconnect-dirsync-upgrade-get-started.md) místo.</span><span class="sxs-lookup"><span data-stu-id="c16fe-107">If you want to upgrade from DirSync, see [Upgrade from Azure AD sync tool (DirSync)](active-directory-aadconnect-dirsync-upgrade-get-started.md) instead.</span></span>

<span data-ttu-id="c16fe-108">Existuje několik různých strategií, které můžete použít k upgradu Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="c16fe-108">There are a few different strategies that you can use to upgrade Azure AD Connect.</span></span>

| <span data-ttu-id="c16fe-109">Metoda</span><span class="sxs-lookup"><span data-stu-id="c16fe-109">Method</span></span> | <span data-ttu-id="c16fe-110">Popis</span><span class="sxs-lookup"><span data-stu-id="c16fe-110">Description</span></span> |
| --- | --- |
| [<span data-ttu-id="c16fe-111">Automatický upgrade</span><span class="sxs-lookup"><span data-stu-id="c16fe-111">Automatic upgrade</span></span>](active-directory-aadconnect-feature-automatic-upgrade.md) |<span data-ttu-id="c16fe-112">Toto je nejsnazší pro zákazníky s rychlé instalace.</span><span class="sxs-lookup"><span data-stu-id="c16fe-112">This is the easiest method for customers with an express installation.</span></span> |
| [<span data-ttu-id="c16fe-113">Místní upgrade</span><span class="sxs-lookup"><span data-stu-id="c16fe-113">In-place upgrade</span></span>](#in-place-upgrade) |<span data-ttu-id="c16fe-114">Pokud máte jeden server, můžete upgradovat instalaci na místě na stejném serveru.</span><span class="sxs-lookup"><span data-stu-id="c16fe-114">If you have a single server, you can upgrade the installation in-place on the same server.</span></span> |
| [<span data-ttu-id="c16fe-115">Dráha migrace</span><span class="sxs-lookup"><span data-stu-id="c16fe-115">Swing migration</span></span>](#swing-migration) |<span data-ttu-id="c16fe-116">Dva servery můžete připravit jeden ze serverů se nová verze nebo konfigurace a změnit aktivního serveru, až budete připraveni.</span><span class="sxs-lookup"><span data-stu-id="c16fe-116">With two servers, you can prepare one of the servers with the new release or configuration, and change the active server when you're ready.</span></span> |

<span data-ttu-id="c16fe-117">Oprávnění informace najdete v tématu [oprávnění vyžadovaná pro upgrade](active-directory-aadconnect-accounts-permissions.md#upgrade).</span><span class="sxs-lookup"><span data-stu-id="c16fe-117">For permissions information, see the [permissions required for an upgrade](active-directory-aadconnect-accounts-permissions.md#upgrade).</span></span>

> [!NOTE]
> <span data-ttu-id="c16fe-118">Poté, co jste povolili nový server Azure AD Connect zahájit synchronizaci změny do Azure AD, můžete nesmí vrátit zpět k použití nástroje DirSync nebo Azure AD Sync.</span><span class="sxs-lookup"><span data-stu-id="c16fe-118">After you've enabled your new Azure AD Connect server to start synchronizing changes to Azure AD, you must not roll back to using DirSync or Azure AD Sync.</span></span> <span data-ttu-id="c16fe-119">Přechod na starší verzi z Azure AD Connect pro starší klienty, včetně nástroje DirSync a Azure AD Sync, není podporována a může vést k problémům, jako je například ztráty dat ve službě Azure AD.</span><span class="sxs-lookup"><span data-stu-id="c16fe-119">Downgrading from Azure AD Connect to legacy clients, including DirSync and Azure AD Sync, isn't supported and can lead to issues such as data loss in Azure AD.</span></span>

## <a name="in-place-upgrade"></a><span data-ttu-id="c16fe-120">Místní upgrade</span><span class="sxs-lookup"><span data-stu-id="c16fe-120">In-place upgrade</span></span>
<span data-ttu-id="c16fe-121">Místní upgrade funguje pro přechod z Azure AD Sync nebo Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="c16fe-121">An in-place upgrade works for moving from Azure AD Sync or Azure AD Connect.</span></span> <span data-ttu-id="c16fe-122">Nefunguje pro přesun z nástroje DirSync nebo řešení s Forefront Identity Manager (FIM) + konektoru služby Azure AD.</span><span class="sxs-lookup"><span data-stu-id="c16fe-122">It doesn't work for moving from DirSync or for a solution with Forefront Identity Manager (FIM) + Azure AD Connector.</span></span>

<span data-ttu-id="c16fe-123">Tato metoda je upřednostňovaný, pokud máte jeden server a o méně než 100 000 objektů.</span><span class="sxs-lookup"><span data-stu-id="c16fe-123">This method is preferred when you have a single server and less than about 100,000 objects.</span></span> <span data-ttu-id="c16fe-124">Pokud se nějak změní out-of-box synchronizační pravidla, úplný import a úplnou synchronizaci vzniknout po upgradu.</span><span class="sxs-lookup"><span data-stu-id="c16fe-124">If there are any changes to the out-of-box sync rules, a full import and full synchronization occur after the upgrade.</span></span> <span data-ttu-id="c16fe-125">Tato metoda zajišťuje, že se nová konfigurace se použije pro všechny existující objekty v systému.</span><span class="sxs-lookup"><span data-stu-id="c16fe-125">This method ensures that the new configuration is applied to all existing objects in the system.</span></span> <span data-ttu-id="c16fe-126">To běžet může trvat několik hodin v závislosti na počet objektů, které jsou v oboru synchronizační modul.</span><span class="sxs-lookup"><span data-stu-id="c16fe-126">This run might take a few hours, depending on the number of objects that are in scope of the sync engine.</span></span> <span data-ttu-id="c16fe-127">Plánovač normální rozdílová synchronizace (který ve výchozím nastavení synchronizuje každých 30 minut) je pozastavená, ale pokračuje v synchronizaci hesel.</span><span class="sxs-lookup"><span data-stu-id="c16fe-127">The normal delta synchronization scheduler (which synchronizes every 30 minutes by default) is suspended, but password synchronization continues.</span></span> <span data-ttu-id="c16fe-128">Můžete uvažovat o provedením upgradu na místě během víkendu.</span><span class="sxs-lookup"><span data-stu-id="c16fe-128">You might consider doing the in-place upgrade during a weekend.</span></span> <span data-ttu-id="c16fe-129">Pokud se, že neexistují že žádné změny konfigurace out-of-box službou Azure AD Connect novou verzi, pak normální rozdílová importu nebo synchronizace spustí místo.</span><span class="sxs-lookup"><span data-stu-id="c16fe-129">If there are no changes to the out-of-box configuration with the new Azure AD Connect release, then a normal delta import/sync starts instead.</span></span>  
![Místní upgrade](./media/active-directory-aadconnect-upgrade-previous-version/inplaceupgrade.png)

<span data-ttu-id="c16fe-131">Pokud jste udělali změny out-of-box synchronizační pravidla, tato pravidla jsou nastavit zpět na výchozí konfiguraci při upgradu.</span><span class="sxs-lookup"><span data-stu-id="c16fe-131">If you've made changes to the out-of-box synchronization rules, then these rules are set back to the default configuration on upgrade.</span></span> <span data-ttu-id="c16fe-132">Abyste měli jistotu, že je mezi upgrady udržována konfiguraci, ujistěte se, provést změny, jak se popisuje v [osvědčené postupy pro změnu výchozí konfigurace](active-directory-aadconnectsync-best-practices-changing-default-configuration.md).</span><span class="sxs-lookup"><span data-stu-id="c16fe-132">To make sure that your configuration is kept between upgrades, make sure that you make changes as they're described in [Best practices for changing the default configuration](active-directory-aadconnectsync-best-practices-changing-default-configuration.md).</span></span>

<span data-ttu-id="c16fe-133">Během upgradu na místě, může být změny zavedl, které vyžadují určité synchronizace aktivity (včetně kroky úplný Import a úplnou synchronizaci) má být proveden po dokončení upgradu.</span><span class="sxs-lookup"><span data-stu-id="c16fe-133">During in-place upgrade, there may be changes introduced that require specific synchronization activities (including Full Import step and Full Synchronization step) to be executed after upgrade completes.</span></span> <span data-ttu-id="c16fe-134">Odložení takových aktivit, informace naleznete v sekci [postup odložení úplnou synchronizaci po upgradu](#how-to-defer-full-synchronization-after-upgrade).</span><span class="sxs-lookup"><span data-stu-id="c16fe-134">To defer such activities, refer to section [How to defer full synchronization after upgrade](#how-to-defer-full-synchronization-after-upgrade).</span></span>

## <a name="swing-migration"></a><span data-ttu-id="c16fe-135">Postupná migrace</span><span class="sxs-lookup"><span data-stu-id="c16fe-135">Swing migration</span></span>
<span data-ttu-id="c16fe-136">Pokud máte komplexní nasazení nebo mnoho objektů, může to být nepraktické provést místní upgrade systému za provozu.</span><span class="sxs-lookup"><span data-stu-id="c16fe-136">If you have a complex deployment or many objects, it might be impractical to do an in-place upgrade on the live system.</span></span> <span data-ttu-id="c16fe-137">Pro některé zákazníky tento proces může trvat několik dní – a během této doby se zpracují žádné rozdílové změny.</span><span class="sxs-lookup"><span data-stu-id="c16fe-137">For some customers, this process might take multiple days--and during this time, no delta changes are processed.</span></span> <span data-ttu-id="c16fe-138">Tato metoda slouží také když máte v plánu provést konfiguraci významné změny a chcete si je vyzkoušet předtím, než se instaluje do cloudu.</span><span class="sxs-lookup"><span data-stu-id="c16fe-138">You can also use this method when you plan to make substantial changes to your configuration and you want to try them out before they're pushed to the cloud.</span></span>

<span data-ttu-id="c16fe-139">Doporučené metody pro tyto scénáře se má používat dráha migrace.</span><span class="sxs-lookup"><span data-stu-id="c16fe-139">The recommended method for these scenarios is to use a swing migration.</span></span> <span data-ttu-id="c16fe-140">Je nutné (aspoň) dva servery – jednu aktivní a jeden pracovní server.</span><span class="sxs-lookup"><span data-stu-id="c16fe-140">You need (at least) two servers--one active server and one staging server.</span></span> <span data-ttu-id="c16fe-141">Aktivní server (ukázka s plnou modré čáry na následujícím obrázku) zodpovídá za active produkční zatížení.</span><span class="sxs-lookup"><span data-stu-id="c16fe-141">The active server (shown with solid blue lines in the following picture) is responsible for the active production load.</span></span> <span data-ttu-id="c16fe-142">Pracovní server (ukázka s přerušované čáry fialové) je připravený pomocí nové verze nebo konfigurace.</span><span class="sxs-lookup"><span data-stu-id="c16fe-142">The staging server (shown with dashed purple lines) is prepared with the new release or configuration.</span></span> <span data-ttu-id="c16fe-143">Pokud je plně připraven, se provádí tento server aktivní.</span><span class="sxs-lookup"><span data-stu-id="c16fe-143">When it's fully ready, this server is made active.</span></span> <span data-ttu-id="c16fe-144">Předchozí aktivního serveru, která teď má předchozí verzi nebo nainstalovaná konfigurace, se provádí na testovacím serveru a upgradu.</span><span class="sxs-lookup"><span data-stu-id="c16fe-144">The previous active server, which now has the old version or configuration installed, is made into the staging server and is upgraded.</span></span>

<span data-ttu-id="c16fe-145">Dva servery můžete použít různé verze.</span><span class="sxs-lookup"><span data-stu-id="c16fe-145">The two servers can use different versions.</span></span> <span data-ttu-id="c16fe-146">Například active server, který chcete vyřadit z provozu můžete použít Azure AD Sync, a nový pracovní server můžete použít Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="c16fe-146">For example, the active server that you plan to decommission can use Azure AD Sync, and the new staging server can use Azure AD Connect.</span></span> <span data-ttu-id="c16fe-147">Pokud používáte migraci dráha vyvíjet novou konfiguraci, je vhodné tak, aby měl shodovat s verzemi na dvou serverech.</span><span class="sxs-lookup"><span data-stu-id="c16fe-147">If you use swing migration to develop a new configuration, it's a good idea to have the same versions on the two servers.</span></span>  
![Pracovní server](./media/active-directory-aadconnect-upgrade-previous-version/stagingserver1.png)

> [!NOTE]
> <span data-ttu-id="c16fe-149">Někteří zákazníci dávají přednost mít tři nebo čtyři servery pro tento scénář.</span><span class="sxs-lookup"><span data-stu-id="c16fe-149">Some customers prefer to have three or four servers for this scenario.</span></span> <span data-ttu-id="c16fe-150">Při upgradu serveru pracovní nemáte záložní server pro [zotavení po havárii](active-directory-aadconnectsync-operations.md#disaster-recovery).</span><span class="sxs-lookup"><span data-stu-id="c16fe-150">When the staging server is upgraded, you don't have a backup server for [disaster recovery](active-directory-aadconnectsync-operations.md#disaster-recovery).</span></span> <span data-ttu-id="c16fe-151">Se tři nebo čtyři servery můžete připravit jednu sadu serverů primární nebo úsporného režimu s novou verzí, které zajišťuje, že existuje vždy pracovní server, který je připravena převzít roli.</span><span class="sxs-lookup"><span data-stu-id="c16fe-151">With three or four servers, you can prepare one set of primary/standby servers with the new version, which ensures that there is always a staging server that's ready to take over.</span></span>

<span data-ttu-id="c16fe-152">Tyto kroky také fungovat pro přesun z Azure AD Sync nebo řešení s FIM + konektoru služby Azure AD.</span><span class="sxs-lookup"><span data-stu-id="c16fe-152">These steps also work to move from Azure AD Sync or a solution with FIM + Azure AD Connector.</span></span> <span data-ttu-id="c16fe-153">Tyto kroky nefungují pro nástroj DirSync, ale je stejnou dráha migrace metodu (také nazývané paralelní nasazení) s kroky pro nástroj DirSync v [Upgrade Azure Active Directory sync (DirSync)](active-directory-aadconnect-dirsync-upgrade-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="c16fe-153">These steps don't work for DirSync, but the same swing migration method (also called parallel deployment) with steps for DirSync is in [Upgrade Azure Active Directory sync (DirSync)](active-directory-aadconnect-dirsync-upgrade-get-started.md).</span></span>

### <a name="use-a-swing-migration-to-upgrade"></a><span data-ttu-id="c16fe-154">Použijte dráha migraci k upgradu</span><span class="sxs-lookup"><span data-stu-id="c16fe-154">Use a swing migration to upgrade</span></span>
1. <span data-ttu-id="c16fe-155">Pokud používáte Azure AD Connect na obou serverech a plánujete provést pouze konfiguraci změnit, ujistěte se, že aktivní server a pracovní server používáte stejnou verzi.</span><span class="sxs-lookup"><span data-stu-id="c16fe-155">If you use Azure AD Connect on both servers and plan to only make a configuration change, make sure that your active server and staging server are both using the same version.</span></span> <span data-ttu-id="c16fe-156">Který usnadňuje porovnat rozdíly později.</span><span class="sxs-lookup"><span data-stu-id="c16fe-156">That makes it easier to compare differences later.</span></span> <span data-ttu-id="c16fe-157">Pokud provádíte upgrade ze služby Azure AD Sync, tyto servery mají různé verze.</span><span class="sxs-lookup"><span data-stu-id="c16fe-157">If you're upgrading from Azure AD Sync, then these servers have different versions.</span></span> <span data-ttu-id="c16fe-158">Pokud provádíte upgrade ze starší verze služby Azure AD Connect, je vhodné spustit s dvěma servery, které používají stejnou verzi, ale není to nutné.</span><span class="sxs-lookup"><span data-stu-id="c16fe-158">If you're upgrading from an older version of Azure AD Connect, it's a good idea to start with the two servers that are using the same version, but it's not required.</span></span>
2. <span data-ttu-id="c16fe-159">Pokud jste udělali vlastní konfiguraci a pracovní server nemá, postupujte podle kroků v části [přesunout vlastní konfiguraci z aktivního serveru k serveru pracovní](#move-custom-configuration-from-active-to-staging-server).</span><span class="sxs-lookup"><span data-stu-id="c16fe-159">If you've made a custom configuration and your staging server doesn't have it, follow the steps under [Move a custom configuration from the active server to the staging server](#move-custom-configuration-from-active-to-staging-server).</span></span>
3. <span data-ttu-id="c16fe-160">Pokud provádíte upgrade ze starší verze služby Azure AD Connect, upgradujte na nejnovější verzi pracovní server.</span><span class="sxs-lookup"><span data-stu-id="c16fe-160">If you're upgrading from an earlier release of Azure AD Connect, upgrade the staging server to the latest version.</span></span> <span data-ttu-id="c16fe-161">Při přesouvání z Azure AD Sync, nainstalujte Azure AD Connect na testovacím serveru.</span><span class="sxs-lookup"><span data-stu-id="c16fe-161">If you're moving from Azure AD Sync, then install Azure AD Connect on your staging server.</span></span>
4. <span data-ttu-id="c16fe-162">Umožní synchronizační modul spustit úplný import a úplnou synchronizaci na testovacím serveru.</span><span class="sxs-lookup"><span data-stu-id="c16fe-162">Let the sync engine run full import and full synchronization on your staging server.</span></span>
5. <span data-ttu-id="c16fe-163">Ověřte, že nová konfigurace nebyla způsobit neočekávané změny pomocí kroků v části "Ověřit" v [ověřte konfiguraci serveru](active-directory-aadconnectsync-operations.md#verify-the-configuration-of-a-server).</span><span class="sxs-lookup"><span data-stu-id="c16fe-163">Verify that the new configuration didn't cause any unexpected changes by using the steps under "Verify" in [Verify the configuration of a server](active-directory-aadconnectsync-operations.md#verify-the-configuration-of-a-server).</span></span> <span data-ttu-id="c16fe-164">Pokud není něco podle očekávání, opravte ji, spusťte import a synchronizaci a ověřit data, dokud ho spokojeni, pomocí následujících kroků.</span><span class="sxs-lookup"><span data-stu-id="c16fe-164">If something isn't as expected, correct it, run the import and sync, and verify the data until it looks good, by following the steps.</span></span>
6. <span data-ttu-id="c16fe-165">Přepínač pracovní serveru, aby se aktivní server.</span><span class="sxs-lookup"><span data-stu-id="c16fe-165">Switch the staging server to be the active server.</span></span> <span data-ttu-id="c16fe-166">Toto je poslední krok "Přepínač aktivního serveru" v [ověřte konfiguraci serveru](active-directory-aadconnectsync-operations.md#verify-the-configuration-of-a-server).</span><span class="sxs-lookup"><span data-stu-id="c16fe-166">This is the final step "Switch active server" in [Verify the configuration of a server](active-directory-aadconnectsync-operations.md#verify-the-configuration-of-a-server).</span></span>
7. <span data-ttu-id="c16fe-167">Pokud upgradujete Azure AD Connect, upgradujte server, který je nyní v pracovním režimu na nejnovější verzi.</span><span class="sxs-lookup"><span data-stu-id="c16fe-167">If you're upgrading Azure AD Connect, upgrade the server that's now in staging mode to the latest release.</span></span> <span data-ttu-id="c16fe-168">Postupujte stejným způsobem jako před dat a konfigurace upgradovat.</span><span class="sxs-lookup"><span data-stu-id="c16fe-168">Follow the same steps as before to get the data and configuration upgraded.</span></span> <span data-ttu-id="c16fe-169">Pokud jste upgradovali z Azure AD Sync, teď můžete vypnout a vyřadit z provozu starý server.</span><span class="sxs-lookup"><span data-stu-id="c16fe-169">If you upgraded from Azure AD Sync, you can now turn off and decommission your old server.</span></span>

### <a name="move-a-custom-configuration-from-the-active-server-to-the-staging-server"></a><span data-ttu-id="c16fe-170">Přesunout vlastní konfiguraci z aktivního serveru pracovní server</span><span class="sxs-lookup"><span data-stu-id="c16fe-170">Move a custom configuration from the active server to the staging server</span></span>
<span data-ttu-id="c16fe-171">Pokud jste provedli změny konfigurace aktivního serveru, budete muset Ujistěte se, že stejné změny se použijí k serveru pracovní.</span><span class="sxs-lookup"><span data-stu-id="c16fe-171">If you've made configuration changes to the active server, you need to make sure that the same changes are applied to the staging server.</span></span> <span data-ttu-id="c16fe-172">Tento přesun usnadní, můžete použít [nástroje Azure AD Connect konfigurace dokumentace](https://github.com/Microsoft/AADConnectConfigDocumenter).</span><span class="sxs-lookup"><span data-stu-id="c16fe-172">To help with this move, you can use the [Azure AD Connect configuration documenter](https://github.com/Microsoft/AADConnectConfigDocumenter).</span></span>

<span data-ttu-id="c16fe-173">Můžete přesunout vlastní synchronizační pravidla, že jste vytvořili pomocí prostředí PowerShell.</span><span class="sxs-lookup"><span data-stu-id="c16fe-173">You can move the custom sync rules that you've created by using PowerShell.</span></span> <span data-ttu-id="c16fe-174">Musíte použít jiné změny stejným způsobem jako ve všech systémech, a nemůžete migrovat, změny.</span><span class="sxs-lookup"><span data-stu-id="c16fe-174">You must apply other changes the same way on both systems, and you can't migrate the changes.</span></span> <span data-ttu-id="c16fe-175">[Konfigurace dokumentace](https://github.com/Microsoft/AADConnectConfigDocumenter) vám může pomoct porovnání těchto dvou systémech, abyste měli jistotu, že jsou identické.</span><span class="sxs-lookup"><span data-stu-id="c16fe-175">The [configuration documenter](https://github.com/Microsoft/AADConnectConfigDocumenter) can help you comparing the two systems to make sure they are identical.</span></span> <span data-ttu-id="c16fe-176">Tento nástroj může také pomoci při automatizaci kroky uvedenými v této části.</span><span class="sxs-lookup"><span data-stu-id="c16fe-176">The tool can also help in automating the steps found in this section.</span></span>

<span data-ttu-id="c16fe-177">Musíte nakonfigurovat stejným způsobem jako následujících akcí na obou serverech:</span><span class="sxs-lookup"><span data-stu-id="c16fe-177">You need to configure the following things the same way on both servers:</span></span>

* <span data-ttu-id="c16fe-178">Připojení ke stejné doménové struktury</span><span class="sxs-lookup"><span data-stu-id="c16fe-178">Connection to the same forests</span></span>
* <span data-ttu-id="c16fe-179">Všechny domény a filtrování organizační jednotky</span><span class="sxs-lookup"><span data-stu-id="c16fe-179">Any domain and OU filtering</span></span>
* <span data-ttu-id="c16fe-180">Stejné volitelné funkce, jako je například synchronizace hesel a zpětný zápis hesla</span><span class="sxs-lookup"><span data-stu-id="c16fe-180">The same optional features, such as password sync and password writeback</span></span>

<span data-ttu-id="c16fe-181">**Přesunout vlastní synchronizační pravidla**</span><span class="sxs-lookup"><span data-stu-id="c16fe-181">**Move custom synchronization rules**</span></span>  
<span data-ttu-id="c16fe-182">Chcete-li přesunout vlastní synchronizační pravidla, postupujte takto:</span><span class="sxs-lookup"><span data-stu-id="c16fe-182">To move custom synchronization rules, do the following:</span></span>

1. <span data-ttu-id="c16fe-183">Otevřete **editoru pravidel synchronizace** na váš aktivní server.</span><span class="sxs-lookup"><span data-stu-id="c16fe-183">Open **Synchronization Rules Editor** on your active server.</span></span>
2. <span data-ttu-id="c16fe-184">Vyberte vlastní pravidlo.</span><span class="sxs-lookup"><span data-stu-id="c16fe-184">Select a custom rule.</span></span> <span data-ttu-id="c16fe-185">Klikněte na tlačítko **exportovat**.</span><span class="sxs-lookup"><span data-stu-id="c16fe-185">Click **Export**.</span></span> <span data-ttu-id="c16fe-186">Otevře okno Poznámkový blok.</span><span class="sxs-lookup"><span data-stu-id="c16fe-186">This brings up a Notepad window.</span></span> <span data-ttu-id="c16fe-187">Uložte dočasný soubor s příponou PS1.</span><span class="sxs-lookup"><span data-stu-id="c16fe-187">Save the temporary file with a PS1 extension.</span></span> <span data-ttu-id="c16fe-188">Díky tomu skript prostředí PowerShell.</span><span class="sxs-lookup"><span data-stu-id="c16fe-188">This makes it a PowerShell script.</span></span> <span data-ttu-id="c16fe-189">Zkopírujte soubor PS1 pracovní server.</span><span class="sxs-lookup"><span data-stu-id="c16fe-189">Copy the PS1 file to the staging server.</span></span>  
   <span data-ttu-id="c16fe-190">![Export pravidla synchronizace](./media/active-directory-aadconnect-upgrade-previous-version/exportrule.png)</span><span class="sxs-lookup"><span data-stu-id="c16fe-190">![Sync rule export](./media/active-directory-aadconnect-upgrade-previous-version/exportrule.png)</span></span>
3. <span data-ttu-id="c16fe-191">Identifikátor GUID konektoru se liší na testovacím serveru a musíte ji změnit.</span><span class="sxs-lookup"><span data-stu-id="c16fe-191">The Connector GUID is different on the staging server, and you must change it.</span></span> <span data-ttu-id="c16fe-192">Chcete-li získat identifikátor GUID, spusťte **editoru pravidel synchronizace**, vyberte jednu z out-of-box pravidla, která představují stejnou připojený systém a klikněte na tlačítko **exportovat**.</span><span class="sxs-lookup"><span data-stu-id="c16fe-192">To get the GUID, start **Synchronization Rules Editor**, select one of the out-of-box rules that represent the same connected system, and click **Export**.</span></span> <span data-ttu-id="c16fe-193">Identifikátor GUID v souboru PS1 nahraďte identifikátor GUID z pracovního serveru.</span><span class="sxs-lookup"><span data-stu-id="c16fe-193">Replace the GUID in your PS1 file with the GUID from the staging server.</span></span>
4. <span data-ttu-id="c16fe-194">V příkazovém řádku prostředí PowerShell spusťte soubor PS1.</span><span class="sxs-lookup"><span data-stu-id="c16fe-194">In a PowerShell prompt, run the PS1 file.</span></span> <span data-ttu-id="c16fe-195">Tím se vytvoří vlastní synchronizačního pravidla na testovacím serveru.</span><span class="sxs-lookup"><span data-stu-id="c16fe-195">This creates the custom synchronization rule on the staging server.</span></span>
5. <span data-ttu-id="c16fe-196">Tento postup opakujte pro všechny vaše vlastní pravidla.</span><span class="sxs-lookup"><span data-stu-id="c16fe-196">Repeat this for all your custom rules.</span></span>

## <a name="how-to-defer-full-synchronization-after-upgrade"></a><span data-ttu-id="c16fe-197">Postup odložení úplnou synchronizaci po upgradu</span><span class="sxs-lookup"><span data-stu-id="c16fe-197">How to defer full synchronization after upgrade</span></span>
<span data-ttu-id="c16fe-198">Během upgradu na místě, může být změny zavedl, které vyžadují konkrétní synchronizace aktivity (včetně kroky úplný Import a úplnou synchronizaci) má být proveden.</span><span class="sxs-lookup"><span data-stu-id="c16fe-198">During in-place upgrade, there may be changes introduced that require specific synchronization activities (including Full Import step and Full Synchronization step) to be executed.</span></span> <span data-ttu-id="c16fe-199">Například vyžadovat změny schématu konektor **úplný import** krok a out-of-box změny pravidlo synchronizace vyžadují **úplné synchronizace** krok provést na ovlivněných konektory.</span><span class="sxs-lookup"><span data-stu-id="c16fe-199">For example, connector schema changes require **full import** step and out-of-box synchronization rule changes require **full synchronization** step to be executed on affected connectors.</span></span> <span data-ttu-id="c16fe-200">Během upgradu, Azure AD Connect určí, jaké aktivity synchronizace se vyžadují a zaznamenává je jako *přepsání*.</span><span class="sxs-lookup"><span data-stu-id="c16fe-200">During upgrade, Azure AD Connect determines what synchronization activities are required and records them as *overrides*.</span></span> <span data-ttu-id="c16fe-201">V následující synchronizační cyklus plánovače synchronizace převezme tato přepsání a spustí je.</span><span class="sxs-lookup"><span data-stu-id="c16fe-201">In the following synchronization cycle, the synchronization scheduler picks up these overrides and executes them.</span></span> <span data-ttu-id="c16fe-202">Jakmile přepsání úspěšně proveden, je odebrána.</span><span class="sxs-lookup"><span data-stu-id="c16fe-202">Once an override is successfully executed, it is removed.</span></span>

<span data-ttu-id="c16fe-203">Mohou nastat situace, kdy nechcete, aby tato přepsání proběhla okamžitě po provedení upgradu.</span><span class="sxs-lookup"><span data-stu-id="c16fe-203">There may be situations where you do not want these overrides to take place immediately after upgrade.</span></span> <span data-ttu-id="c16fe-204">Například máte mnoho synchronizované objekty a chcete tyto kroky synchronizace dochází po pracovní dobu.</span><span class="sxs-lookup"><span data-stu-id="c16fe-204">For example, you have numerous synchronized objects and you would like these synchronization steps to occur after business hours.</span></span> <span data-ttu-id="c16fe-205">Chcete-li odebrat tato přepsání:</span><span class="sxs-lookup"><span data-stu-id="c16fe-205">To remove these overrides:</span></span>

1. <span data-ttu-id="c16fe-206">Během upgradu **zrušte zaškrtnutí políčka** možnost **po dokončení konfigurace spustit proces synchronizace**.</span><span class="sxs-lookup"><span data-stu-id="c16fe-206">During upgrade, **uncheck** the option **Start the synchronization process when configuration completes**.</span></span> <span data-ttu-id="c16fe-207">To zakáže plánovače synchronizace a zabrání synchronizační cyklus probíhají automaticky předtím, než se odeberou přepsání.</span><span class="sxs-lookup"><span data-stu-id="c16fe-207">This disables the synchronization scheduler and prevents synchronization cycle from taking place automatically before the overrides are removed.</span></span>

   ![DisableFullSyncAfterUpgrade](./media/active-directory-aadconnect-upgrade-previous-version/disablefullsync01.png)

2. <span data-ttu-id="c16fe-209">Po dokončení upgradu, spusťte následující rutinu a zjistěte, jaké přepsání byly přidány:`Get-ADSyncSchedulerConnectorOverride | fl`</span><span class="sxs-lookup"><span data-stu-id="c16fe-209">After upgrade completes, run the following cmdlet to find out what overrides have been added: `Get-ADSyncSchedulerConnectorOverride | fl`</span></span>

   >[!NOTE]
   > <span data-ttu-id="c16fe-210">Přepsání jsou specifické pro konektor.</span><span class="sxs-lookup"><span data-stu-id="c16fe-210">The overrides are connector-specific.</span></span> <span data-ttu-id="c16fe-211">V následujícím příkladu kroky úplný Import a úplnou synchronizaci jsou přidané do obou místní konektor AD a Azure AD Connector.</span><span class="sxs-lookup"><span data-stu-id="c16fe-211">In the following example, Full Import step and Full Synchronization step have been added to both the on-premises AD Connector and Azure AD Connector.</span></span>

   ![DisableFullSyncAfterUpgrade](./media/active-directory-aadconnect-upgrade-previous-version/disablefullsync02.png)

3. <span data-ttu-id="c16fe-213">Poznamenejte si stávající přepsání, které byly přidány.</span><span class="sxs-lookup"><span data-stu-id="c16fe-213">Note down the existing overrides that have been added.</span></span>
   
4. <span data-ttu-id="c16fe-214">Chcete-li odebrat přepsání pro úplný import a úplnou synchronizaci v libovolné konektoru, spusťte následující rutinu:`Set-ADSyncSchedulerConnectorOverride -ConnectorIdentifier <Guid-of-ConnectorIdentifier> -FullImportRequired $false -FullSyncRequired $false`</span><span class="sxs-lookup"><span data-stu-id="c16fe-214">To remove the overrides for both full import and full synchronization on an arbitrary connector, run the following cmdlet: `Set-ADSyncSchedulerConnectorOverride -ConnectorIdentifier <Guid-of-ConnectorIdentifier> -FullImportRequired $false -FullSyncRequired $false`</span></span>

   <span data-ttu-id="c16fe-215">Chcete-li odebrat přepsání na všechny konektory, spusťte následující skript prostředí PowerShell:</span><span class="sxs-lookup"><span data-stu-id="c16fe-215">To remove the overrides on all connectors, execute the following PowerShell script:</span></span>

   ```
   foreach ($connectorOverride in Get-ADSyncSchedulerConnectorOverride)
   {
       Set-ADSyncSchedulerConnectorOverride -ConnectorIdentifier $connectorOverride.ConnectorIdentifier.Guid -FullSyncRequired $false -FullImportRequired $false
   }
   ```

5. <span data-ttu-id="c16fe-216">Pokud chcete obnovit Plánovač, spusťte následující rutinu:`Set-ADSyncScheduler -SyncCycleEnabled $true`</span><span class="sxs-lookup"><span data-stu-id="c16fe-216">To resume the scheduler, run the following cmdlet: `Set-ADSyncScheduler -SyncCycleEnabled $true`</span></span>

   >[!IMPORTANT]
   > <span data-ttu-id="c16fe-217">Musíte provést kroky požadované synchronizace v nejdřívější usnadnění práce.</span><span class="sxs-lookup"><span data-stu-id="c16fe-217">Remember to execute the required synchronization steps at your earliest convenience.</span></span> <span data-ttu-id="c16fe-218">Můžete buď ručně provést tyto kroky, pomocí Synchronization Service Manager nebo přidat přepsání zpět pomocí rutiny Set-ADSyncSchedulerConnectorOverride.</span><span class="sxs-lookup"><span data-stu-id="c16fe-218">You can either manually execute these steps using the Synchronization Service Manager or add the overrides back using the Set-ADSyncSchedulerConnectorOverride cmdlet.</span></span>

<span data-ttu-id="c16fe-219">Přepsání pro úplný import a úplnou synchronizaci v libovolné konektoru, spusťte následující rutinu:`Set-ADSyncSchedulerConnectorOverride -ConnectorIdentifier <Guid> -FullImportRequired $true -FullSyncRequired $true`</span><span class="sxs-lookup"><span data-stu-id="c16fe-219">To add the overrides for both full import and full synchronization on an arbitrary connector, run the following cmdlet:  `Set-ADSyncSchedulerConnectorOverride -ConnectorIdentifier <Guid> -FullImportRequired $true -FullSyncRequired $true`</span></span>

## <a name="next-steps"></a><span data-ttu-id="c16fe-220">Další kroky</span><span class="sxs-lookup"><span data-stu-id="c16fe-220">Next steps</span></span>
<span data-ttu-id="c16fe-221">Další informace o [integrace místních identit s Azure Active Directory](active-directory-aadconnect.md).</span><span class="sxs-lookup"><span data-stu-id="c16fe-221">Learn more about [integrating your on-premises identities with Azure Active Directory](active-directory-aadconnect.md).</span></span>
