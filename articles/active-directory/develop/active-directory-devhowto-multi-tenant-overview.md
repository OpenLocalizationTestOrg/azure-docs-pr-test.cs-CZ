---
title: "Jak sestavit aplikaci, která se můžete přihlásit žádné uživatele Azure AD | Microsoft Docs"
description: "Podrobné pokyny pro vytváření aplikace, které můžou přihlásit uživatel jakéhokoli klienta Azure Active Directory, také známé jako aplikaci na více klientů."
services: active-directory
documentationcenter: 
author: dstrockis
manager: mbaldwin
editor: 
ms.assetid: 35af95cb-ced3-46ad-b01d-5d2f6fd064a3
ms.service: active-directory
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 04/26/2017
ms.author: dastrock
ms.custom: aaddev
ms.openlocfilehash: f1c79fa7e3b0e160487b5941741f6a6c677c6b81
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 07/11/2017
---
# <a name="how-to-sign-in-any-azure-active-directory-ad-user-using-the-multi-tenant-application-pattern"></a><span data-ttu-id="3706b-103">Jak se přihlásit žádné uživatele Azure Active Directory (AD) pomocí vzoru víceklientské aplikace</span><span class="sxs-lookup"><span data-stu-id="3706b-103">How to sign in any Azure Active Directory (AD) user using the multi-tenant application pattern</span></span>
<span data-ttu-id="3706b-104">Pokud nabízíte softwaru jako aplikace služby k mnoha organizacích, můžete nakonfigurovat aplikaci tak, aby přijímal přihlášení jakéhokoli klienta Azure AD.</span><span class="sxs-lookup"><span data-stu-id="3706b-104">If you offer a Software as a Service application to many organizations, you can configure your application to accept sign-ins from any Azure AD tenant.</span></span>  <span data-ttu-id="3706b-105">Ve službě Azure AD se nazývá provedení víceklientské vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="3706b-105">In Azure AD this is called making your application multi-tenant.</span></span>  <span data-ttu-id="3706b-106">Uživatelé v jakékoli klientovi Azure AD bude moci přihlásit k aplikaci po souhlas používat svůj účet s vaší aplikací.</span><span class="sxs-lookup"><span data-stu-id="3706b-106">Users in any Azure AD tenant will be able to sign in to your application after consenting to use their account with your application.</span></span>  

<span data-ttu-id="3706b-107">Pokud máte existující aplikaci, která má svůj vlastní účet systému nebo jiných druhů přihlášení od jiných poskytovatelů cloudu podporuje, klepněte přidání Azure AD přihlášení jakéhokoli klienta je jednoduché.</span><span class="sxs-lookup"><span data-stu-id="3706b-107">If you have an existing application that has its own account system, or supports other kinds of sign-in from other cloud providers, adding Azure AD sign-in from any tenant is simple.</span></span> <span data-ttu-id="3706b-108">Právě svou aplikaci zaregistrovat, přidejte kód přihlášení přes OAuth2, OpenID Connect nebo SAML a umístí tlačítko "Přihlášení v with Microsoft" vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="3706b-108">Just register your app, add sign-in code via OAuth2, OpenID Connect, or SAML, and put a "Sign In with Microsoft" button on your application.</span></span> <span data-ttu-id="3706b-109">Klikněte na následující tlačítko Další informace o branding vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="3706b-109">Click the following button to learn more about branding your application.</span></span>

<span data-ttu-id="3706b-110">[! [Přihlašovací tlačítko] [AAD-Sign-In]][AAD-App-Branding]</span><span class="sxs-lookup"><span data-stu-id="3706b-110">[![Sign in button][AAD-Sign-In]][AAD-App-Branding]</span></span>

<span data-ttu-id="3706b-111">Tento článek předpokládá, že jste již obeznámeni s vytvoření jednoho klienta aplikace pro Azure AD.</span><span class="sxs-lookup"><span data-stu-id="3706b-111">This article assumes you’re already familiar with building a single tenant application for Azure AD.</span></span>  <span data-ttu-id="3706b-112">Pokud si nejste, head zpět do [domovské stránce průvodce vývojáře] [ AAD-Dev-Guide] a vyzkoušet některý z našich rychlé zahájení práce!</span><span class="sxs-lookup"><span data-stu-id="3706b-112">If you’re not, head back up to the [developer guide homepage][AAD-Dev-Guide] and try one of our quick starts!</span></span>

<span data-ttu-id="3706b-113">Existují čtyři jednoduché kroky k převedení aplikace do více klientů aplikace Azure AD:</span><span class="sxs-lookup"><span data-stu-id="3706b-113">There are four simple steps to convert your application into an Azure AD multi-tenant app:</span></span>

1. <span data-ttu-id="3706b-114">Aktualizace registrace vaší aplikace na více klientů</span><span class="sxs-lookup"><span data-stu-id="3706b-114">Update your application registration to be multi-tenant</span></span>
2. <span data-ttu-id="3706b-115">Aktualizujte kód a odesílat požadavky / Common koncový bod</span><span class="sxs-lookup"><span data-stu-id="3706b-115">Update your code to send requests to the /common endpoint</span></span> 
3. <span data-ttu-id="3706b-116">Aktualizujte kód pro zpracování více hodnot vystavitele</span><span class="sxs-lookup"><span data-stu-id="3706b-116">Update your code to handle multiple issuer values</span></span>
4. <span data-ttu-id="3706b-117">Rady pro pochopení souhlasu uživatele a správce a proveďte změny správný kód</span><span class="sxs-lookup"><span data-stu-id="3706b-117">Understand user and admin consent and make appropriate code changes</span></span>

<span data-ttu-id="3706b-118">Podívejme se na každý krok podrobně.</span><span class="sxs-lookup"><span data-stu-id="3706b-118">Let’s look at each step in detail.</span></span> <span data-ttu-id="3706b-119">Můžete také přejít přímo na [tento seznam víceklientské ukázky][AAD-Samples-MT].</span><span class="sxs-lookup"><span data-stu-id="3706b-119">You can also jump straight to [this list of multi-tenant samples][AAD-Samples-MT].</span></span>

## <a name="update-registration-to-be-multi-tenant"></a><span data-ttu-id="3706b-120">Aktualizace registrace, která má být více klientů</span><span class="sxs-lookup"><span data-stu-id="3706b-120">Update registration to be multi-tenant</span></span>
<span data-ttu-id="3706b-121">Ve výchozím nastavení jsou webové aplikaci nebo API registrace ve službě Azure AD jednoho klienta.</span><span class="sxs-lookup"><span data-stu-id="3706b-121">By default, web app/API registrations in Azure AD are single tenant.</span></span>  <span data-ttu-id="3706b-122">Můžete provést registrace víceklientské tak, že najdete na stránce Vlastnosti registrace vaší aplikace v "Více nevyužívá dělené tabulky" přepínač [portál Azure] [ AZURE-portal] a jeho nastavení na hodnotu "Ano".</span><span class="sxs-lookup"><span data-stu-id="3706b-122">You can make your registration multi-tenant by finding the “Multi-Tenanted” switch on the properties page of your application registration in the [Azure portal][AZURE-portal] and setting it to “Yes”.</span></span>

<span data-ttu-id="3706b-123">Všimněte si také, než aplikace můžete provedeny více klientů Azure AD vyžaduje identifikátor ID URI aplikace aplikace být globálně jedinečný.</span><span class="sxs-lookup"><span data-stu-id="3706b-123">Also note, before an application can be made multi-tenant, Azure AD requires the App ID URI of the application to be globally unique.</span></span> <span data-ttu-id="3706b-124">Identifikátor ID URI aplikace je jedním ze způsobů, které aplikace je definována ve zprávách protokolu.</span><span class="sxs-lookup"><span data-stu-id="3706b-124">The App ID URI is one of the ways an application is identified in protocol messages.</span></span>  <span data-ttu-id="3706b-125">Aplikace pomocí jednoho klienta je dostačující pro identifikátor ID URI aplikace být jedinečný v rámci tohoto klienta.</span><span class="sxs-lookup"><span data-stu-id="3706b-125">For a single tenant application, it is sufficient for the App ID URI to be unique within that tenant.</span></span>  <span data-ttu-id="3706b-126">Pro více klientů aplikace musí být globálně jedinečné, Azure AD můžete najít aplikaci přes všechny klienty.</span><span class="sxs-lookup"><span data-stu-id="3706b-126">For a multi-tenant application, it must be globally unique so Azure AD can find the application across all tenants.</span></span>  <span data-ttu-id="3706b-127">Globální jedinečnosti se vynucuje tím, že identifikátor ID URI aplikace tak, aby měl název hostitele, který odpovídá ověřené domény klienta Azure AD.</span><span class="sxs-lookup"><span data-stu-id="3706b-127">Global uniqueness is enforced by requiring the App ID URI to have a host name that matches a verified domain of the Azure AD tenant.</span></span>  <span data-ttu-id="3706b-128">Například, pokud název vašeho klienta se contoso.onmicrosoft.com pak platný identifikátor ID URI aplikace by být `https://contoso.onmicrosoft.com/myapp`.</span><span class="sxs-lookup"><span data-stu-id="3706b-128">For example, if the name of your tenant was contoso.onmicrosoft.com then a valid App ID URI would be `https://contoso.onmicrosoft.com/myapp`.</span></span>  <span data-ttu-id="3706b-129">Pokud váš klient měli ověřené domény `contoso.com`, pak by také být platný identifikátor ID URI aplikace `https://contoso.com/myapp`.</span><span class="sxs-lookup"><span data-stu-id="3706b-129">If your tenant had a verified domain of `contoso.com`, then a valid App ID URI would also be `https://contoso.com/myapp`.</span></span>  <span data-ttu-id="3706b-130">Nastavení aplikace jako víceklientské se nezdaří, pokud identifikátor ID URI aplikace není postupujte podle tohoto vzoru.</span><span class="sxs-lookup"><span data-stu-id="3706b-130">Setting an application as multi-tenant will fail if the App ID URI doesn’t follow this pattern.</span></span>

<span data-ttu-id="3706b-131">Registrace nativního klienta jsou víceklientské ve výchozím nastavení.</span><span class="sxs-lookup"><span data-stu-id="3706b-131">Native client registrations are multi-tenant by default.</span></span>  <span data-ttu-id="3706b-132">Není nutné provádět žádnou akci, aby Nativní klient aplikace registrace více klientů.</span><span class="sxs-lookup"><span data-stu-id="3706b-132">You don’t need to take any action to make a native client application registration multi-tenant.</span></span>

## <a name="update-your-code-to-send-requests-to-common"></a><span data-ttu-id="3706b-133">Aktualizujte kód a odesílat žádosti do/Common</span><span class="sxs-lookup"><span data-stu-id="3706b-133">Update your code to send requests to /common</span></span>
<span data-ttu-id="3706b-134">Žádostí o přihlášení k aplikaci jednoho klienta, se odešlou do klienta přihlášení koncový bod.</span><span class="sxs-lookup"><span data-stu-id="3706b-134">In a single tenant application, sign-in requests are sent to the tenant’s sign-in endpoint.</span></span> <span data-ttu-id="3706b-135">Například pro contoso.onmicrosoft.com bude koncový bod:</span><span class="sxs-lookup"><span data-stu-id="3706b-135">For example, for contoso.onmicrosoft.com the endpoint would be:</span></span>

    https://login.microsoftonline.com/contoso.onmicrosoft.com

<span data-ttu-id="3706b-136">Požadavky odeslané na koncový bod klienta můžete přihlásit uživatele (nebo Hosté) v něm k aplikacím v něm.</span><span class="sxs-lookup"><span data-stu-id="3706b-136">Requests sent to a tenant’s endpoint can sign in users (or guests) in that tenant to applications in that tenant.</span></span>  <span data-ttu-id="3706b-137">S více klienty aplikací aplikace neví, předem jaké klienta uživatele je, aby nemohli odesílat žádosti do koncového bodu klienta.</span><span class="sxs-lookup"><span data-stu-id="3706b-137">With a multi-tenant application, the application doesn’t know up front what tenant the user is from, so you can’t send requests to a tenant’s endpoint.</span></span>  <span data-ttu-id="3706b-138">Místo toho jsou odesílány požadavky na koncový bod, který multiplexes napříč všechny klienty Azure AD:</span><span class="sxs-lookup"><span data-stu-id="3706b-138">Instead, requests are sent to an endpoint that multiplexes across all Azure AD tenants:</span></span>

    https://login.microsoftonline.com/common

<span data-ttu-id="3706b-139">Pokud Azure AD přijme požadavek na / Common koncový bod, se uživatel přihlásí a v důsledku zjišťuje klienta, které je uživatel z.</span><span class="sxs-lookup"><span data-stu-id="3706b-139">When Azure AD receives a request on the /common endpoint, it signs the user in and as a consequence discovers which tenant the user is from.</span></span>  <span data-ttu-id="3706b-140">/ Společný koncový bod funguje se všemi ověřovací protokoly podporovaný službou Azure AD: OpenID Connect, OAuth 2.0, SAML 2.0 a WS-Federation.</span><span class="sxs-lookup"><span data-stu-id="3706b-140">The /common endpoint works with all of the authentication protocols supported by Azure AD:  OpenID Connect, OAuth 2.0, SAML 2.0, and WS-Federation.</span></span>

<span data-ttu-id="3706b-141">Odpověď přihlášení do aplikace se pak obsahuje token reprezentující uživatele.</span><span class="sxs-lookup"><span data-stu-id="3706b-141">The sign-in response to the application then contains a token representing the user.</span></span>  <span data-ttu-id="3706b-142">Hodnota vystavitele v tokenu informuje co klienta uživatele je z aplikace.</span><span class="sxs-lookup"><span data-stu-id="3706b-142">The issuer value in the token tells an application what tenant the user is from.</span></span>  <span data-ttu-id="3706b-143">Pokud vrátí odpověď z / Common koncový bod, odpovídat hodnotě vystavitele v tokenu uživatele klienta.</span><span class="sxs-lookup"><span data-stu-id="3706b-143">When a response returns from the /common endpoint, the issuer value in the token will correspond to the user’s tenant.</span></span>  <span data-ttu-id="3706b-144">Je důležité si uvědomit, / Common koncový bod není klienta a není vystavitele, je právě multiplexor.</span><span class="sxs-lookup"><span data-stu-id="3706b-144">It’s important to note the /common endpoint is not a tenant and is not an issuer, it’s just a multiplexer.</span></span>  <span data-ttu-id="3706b-145">Při použití/Common, logiku aplikace k ověření tokeny musí aktualizovat, aby vzít v úvahu.</span><span class="sxs-lookup"><span data-stu-id="3706b-145">When using /common, the logic in your application to validate tokens needs to be updated to take this into account.</span></span> 

<span data-ttu-id="3706b-146">Jak už bylo zmíněno dříve, musí aplikace víceklientské zadat konzistentního prostředí přihlášení pro uživatele, následující aplikace Azure AD branding pokyny.</span><span class="sxs-lookup"><span data-stu-id="3706b-146">As mentioned earlier, multi-tenant applications should also provide a consistent sign-in experience for users, following the Azure AD application branding guidelines.</span></span> <span data-ttu-id="3706b-147">Klikněte na následující tlačítko Další informace o branding vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="3706b-147">Click the following button to learn more about branding your application.</span></span>

<span data-ttu-id="3706b-148">[! [Přihlašovací tlačítko] [AAD-Sign-In]][AAD-App-Branding]</span><span class="sxs-lookup"><span data-stu-id="3706b-148">[![Sign in button][AAD-Sign-In]][AAD-App-Branding]</span></span>

<span data-ttu-id="3706b-149">Podívejme se na používání / Common koncový bod a implementaci kódu podrobněji.</span><span class="sxs-lookup"><span data-stu-id="3706b-149">Let’s take a look at the use of the /common endpoint and your code implementation in more detail.</span></span>

## <a name="update-your-code-to-handle-multiple-issuer-values"></a><span data-ttu-id="3706b-150">Aktualizujte kód pro zpracování více hodnot vystavitele</span><span class="sxs-lookup"><span data-stu-id="3706b-150">Update your code to handle multiple issuer values</span></span>
<span data-ttu-id="3706b-151">Webové aplikace a webové rozhraní API přijímat a ověřovat tokeny z Azure AD.</span><span class="sxs-lookup"><span data-stu-id="3706b-151">Web applications and web APIs receive and validate tokens from Azure AD.</span></span>  

> [!NOTE]
> <span data-ttu-id="3706b-152">Nativní klientské aplikace požadovat a přijímat tokeny z Azure AD, se to provést tak o jejich odeslání do rozhraní API, kde se ověří.</span><span class="sxs-lookup"><span data-stu-id="3706b-152">While native client applications request and receive tokens from Azure AD, they do so to send them to APIs, where they are validated.</span></span>  <span data-ttu-id="3706b-153">Nativní aplikace neověřují tokeny a musí je považovat za neprůhledné.</span><span class="sxs-lookup"><span data-stu-id="3706b-153">Native applications do not validate tokens and must treat them as opaque.</span></span>
> 
> 

<span data-ttu-id="3706b-154">Podívejme se na tom, jak aplikaci ověří tokeny obdrží z Azure AD.</span><span class="sxs-lookup"><span data-stu-id="3706b-154">Let’s look at how an application validates tokens it receives from Azure AD.</span></span>  <span data-ttu-id="3706b-155">Jednoho klienta aplikace bude obvykle trvat hodnotu koncového bodu jako:</span><span class="sxs-lookup"><span data-stu-id="3706b-155">A single tenant application will normally take an endpoint value like:</span></span>

    https://login.microsoftonline.com/contoso.onmicrosoft.com

<span data-ttu-id="3706b-156">a používejte ho vytvořit adresu URL metadat (v tomto případě OpenID Connect) jako:</span><span class="sxs-lookup"><span data-stu-id="3706b-156">and use it to construct a metadata URL (in this case, OpenID Connect) like:</span></span>

    https://login.microsoftonline.com/contoso.onmicrosoft.com/.well-known/openid-configuration

<span data-ttu-id="3706b-157">ke stažení dvě zásadní informace používané k ověření tokeny: klient je podepisování klíče a hodnoty vystavitele.</span><span class="sxs-lookup"><span data-stu-id="3706b-157">to download two critical pieces of information that are used to validate tokens:  the tenant’s signing keys and issuer value.</span></span>  <span data-ttu-id="3706b-158">Každý klient Azure AD má jedinečný vystavitele hodnotu ve formátu:</span><span class="sxs-lookup"><span data-stu-id="3706b-158">Each Azure AD tenant has a unique issuer value of the form:</span></span>

    https://sts.windows.net/31537af4-6d77-4bb9-a681-d2394888ea26/

<span data-ttu-id="3706b-159">kde je hodnota GUID přejmenování bezpečná verze klienta ID klienta.</span><span class="sxs-lookup"><span data-stu-id="3706b-159">where the GUID value is the rename-safe version of the tenant ID of the tenant.</span></span>  <span data-ttu-id="3706b-160">Pokud kliknete na odkaz na předchozí metadata pro `contoso.onmicrosoft.com`, zobrazí se tato hodnota vystavitele v dokumentu.</span><span class="sxs-lookup"><span data-stu-id="3706b-160">If you click on the preceding metadata link for `contoso.onmicrosoft.com`, you can see this issuer value in the document.</span></span>

<span data-ttu-id="3706b-161">Pokud aplikace jednoho klienta ověří token, ověří podpis tokenu proti podpisové klíče z dokumentu metadat.</span><span class="sxs-lookup"><span data-stu-id="3706b-161">When a single tenant application validates a token, it checks the signature of the token against the signing keys from the metadata document.</span></span> <span data-ttu-id="3706b-162">To umožňuje a ujistit se, že ten, který byl nalezen v dokumentu metadat odpovídá hodnotě vystavitele v tokenu.</span><span class="sxs-lookup"><span data-stu-id="3706b-162">This allows it to make sure the issuer value in the token matches the one that was found in the metadata document.</span></span>

<span data-ttu-id="3706b-163">Od / Common koncový bod neodpovídá klienta a není vystavitele, při zkontrolujte hodnotu vystavitele metadat pro/běžné má podle šablony URL namísto skutečné hodnoty:</span><span class="sxs-lookup"><span data-stu-id="3706b-163">Since the /common endpoint doesn’t correspond to a tenant and isn’t an issuer, when you examine the issuer value in the metadata for /common it has a templated URL instead of an actual value:</span></span>

    https://sts.windows.net/{tenantid}/

<span data-ttu-id="3706b-164">Proto nelze ověřit tokeny pouhým odpovídající hodnotě vystavitele v metadatech s víceklientské aplikace `issuer` hodnotu v tokenu.</span><span class="sxs-lookup"><span data-stu-id="3706b-164">Therefore, a multi-tenant application can’t validate tokens just by matching the issuer value in the metadata with the `issuer` value in the token.</span></span>  <span data-ttu-id="3706b-165">Víceklientské aplikace potřebuje logiku rozhodnout vystavitele hodnot, které jsou platné a které jsou není, u klienta na základě ID část hodnoty vystavitele.</span><span class="sxs-lookup"><span data-stu-id="3706b-165">A multi-tenant application needs logic to decide which issuer values are valid and which are not, based on the tenant ID portion of the issuer value.</span></span>  

<span data-ttu-id="3706b-166">Například víceklientské aplikace umožňuje pouze přihlášení z konkrétní klientů, kteří zaregistrovali pro své služby, potom je nutné zkontrolovat hodnotu vystavitele nebo `tid` hodnoty v tokenu a ujistěte se, že klienta je v jejich seznamu odběratelů deklarace identity.</span><span class="sxs-lookup"><span data-stu-id="3706b-166">For example, if a multi-tenant application only allows sign-in from specific tenants who have signed up for their service, then it must check either the issuer value or the `tid` claim value in the token to make sure that tenant is in their list of subscribers.</span></span>  <span data-ttu-id="3706b-167">Pokud aplikace víceklientské pouze se zabývá jednotlivce a není rozhodnutí žádné přístupu na základě na klienty, potom ji můžete ignorovat hodnotě vystavitele zcela.</span><span class="sxs-lookup"><span data-stu-id="3706b-167">If a multi-tenant application only deals with individuals and doesn’t make any access decisions based on tenants, then it can ignore the issuer value altogether.</span></span>

<span data-ttu-id="3706b-168">V víceklientské ukázky [související obsahu](#related-content) část na konci tohoto článku, ověření vystavitele zakázána povolit všechny klienta Azure AD pro přihlášení.</span><span class="sxs-lookup"><span data-stu-id="3706b-168">In the multi-tenant samples in the [Related Content](#related-content) section at the end of this article, issuer validation is disabled to enable any Azure AD tenant to sign in.</span></span>

<span data-ttu-id="3706b-169">Nyní Podíváme se na uživatelské prostředí pro uživatele, kteří se přihlašují k víceklientským aplikacím.</span><span class="sxs-lookup"><span data-stu-id="3706b-169">Now let’s look at the user experience for users that are signing in to multi-tenant applications.</span></span>

## <a name="understanding-user-and-admin-consent"></a><span data-ttu-id="3706b-170">Principy uživatelů a správce souhlasu</span><span class="sxs-lookup"><span data-stu-id="3706b-170">Understanding user and admin consent</span></span>
<span data-ttu-id="3706b-171">Pro uživatele k přihlášení k aplikaci ve službě Azure AD musí být v klientovi uživatele reprezentován aplikace.</span><span class="sxs-lookup"><span data-stu-id="3706b-171">For a user to sign in to an application in Azure AD, the application must be represented in the user’s tenant.</span></span>  <span data-ttu-id="3706b-172">To umožňuje organizace například použít jedinečné zásady po přihlášení uživatelé z jejich klienta pro aplikaci.</span><span class="sxs-lookup"><span data-stu-id="3706b-172">This allows the organization to do things like apply unique policies when users from their tenant sign in to the application.</span></span>  <span data-ttu-id="3706b-173">Pro jednoho klienta aplikace je tato registrace jednoduché. je ten, který se stane, když zaregistrujete aplikaci v [portál Azure][AZURE-portal].</span><span class="sxs-lookup"><span data-stu-id="3706b-173">For a single tenant application, this registration is simple; it’s the one that happens when you register the application in the [Azure portal][AZURE-portal].</span></span>

<span data-ttu-id="3706b-174">Aplikace pomocí víceklientské žije počáteční registrace pro aplikaci v klientovi Azure AD, používá vývojář.</span><span class="sxs-lookup"><span data-stu-id="3706b-174">For a multi-tenant application, the initial registration for the application lives in the Azure AD tenant used by the developer.</span></span>  <span data-ttu-id="3706b-175">Když uživatel z jiné klienta přihlásí k aplikaci poprvé, vyzve Azure AD je k souhlas oprávnění požadované aplikací.</span><span class="sxs-lookup"><span data-stu-id="3706b-175">When a user from a different tenant signs in to the application for the first time, Azure AD asks them to consent to the permissions requested by the application.</span></span>  <span data-ttu-id="3706b-176">Pokud budou souhlasit, pak volat znázornění aplikace *instanční objekt* je vytvořen v klientovi uživatele a přihlášení může pokračovat.</span><span class="sxs-lookup"><span data-stu-id="3706b-176">If they consent, then a representation of the application called a *service principal* is created in the user’s tenant, and sign-in can continue.</span></span> <span data-ttu-id="3706b-177">Delegování je vytvořen také v adresáři, který zaznamenává souhlasu uživatele k aplikaci.</span><span class="sxs-lookup"><span data-stu-id="3706b-177">A delegation is also created in the directory that records the user’s consent to the application.</span></span> <span data-ttu-id="3706b-178">V tématu [objekty aplikací a hlavní objekty služeb] [ AAD-App-SP-Objects] podrobnosti o aplikace aplikace a ServicePrincipal objekty, a jak se vztahují k sobě navzájem.</span><span class="sxs-lookup"><span data-stu-id="3706b-178">See [Application Objects and Service Principal Objects][AAD-App-SP-Objects] for details on the application's Application and ServicePrincipal objects, and how they relate to each other.</span></span>

![Souhlas Jednoúrovňové aplikace][Consent-Single-Tier] 

<span data-ttu-id="3706b-180">Toto prostředí souhlasu je ovlivňován oprávnění požadované aplikací.</span><span class="sxs-lookup"><span data-stu-id="3706b-180">This consent experience is affected by the permissions requested by the application.</span></span>  <span data-ttu-id="3706b-181">Azure AD podporuje dva druhy oprávnění jenom aplikace a delegovaným:</span><span class="sxs-lookup"><span data-stu-id="3706b-181">Azure AD supports two kinds of permissions, app-only and delegated:</span></span>

* <span data-ttu-id="3706b-182">Delegovaná oprávnění uděluje aplikace, které může provádět možnost tak, aby fungoval jako přihlášeného uživatele pro podmnožinu akcí uživatele.</span><span class="sxs-lookup"><span data-stu-id="3706b-182">A delegated permission grants an application the ability to act as a signed in user for a subset of the things the user can do.</span></span>  <span data-ttu-id="3706b-183">Například můžete udělit aplikaci delegovaná oprávnění ke čtení kalendáře přihlášeného uživatele.</span><span class="sxs-lookup"><span data-stu-id="3706b-183">For example, you can grant an application the delegated permission to read the signed in user’s calendar.</span></span>
* <span data-ttu-id="3706b-184">Jen aplikace je povoleno přímo na identitu aplikace.</span><span class="sxs-lookup"><span data-stu-id="3706b-184">An app-only permission is granted directly to the identity of the application.</span></span>  <span data-ttu-id="3706b-185">Například můžete udělit aplikaci jen aplikace oprávnění ke čtení seznamu uživatelů v klientovi, bez ohledu na to, kdo je přihlášený do aplikace.</span><span class="sxs-lookup"><span data-stu-id="3706b-185">For example, you can grant an application the app-only permission to read the list of users in a tenant, regardless of who is signed in to the application.</span></span>

<span data-ttu-id="3706b-186">Některá oprávnění může být souhlas regulární uživatelem, zatímco jiné vyžadují souhlas správce klienta.</span><span class="sxs-lookup"><span data-stu-id="3706b-186">Some permissions can be consented to by a regular user, while others require a tenant administrator’s consent.</span></span> 

### <a name="admin-consent"></a><span data-ttu-id="3706b-187">Správce souhlasu</span><span class="sxs-lookup"><span data-stu-id="3706b-187">Admin consent</span></span>
<span data-ttu-id="3706b-188">Oprávnění jen aplikace vždy vyžadovat souhlas správce klienta.</span><span class="sxs-lookup"><span data-stu-id="3706b-188">App-only permissions always require a tenant administrator’s consent.</span></span>  <span data-ttu-id="3706b-189">Pokud vaše aplikace požaduje oprávnění jen aplikace a uživatel se pokusí přihlásit k aplikaci, chybová zpráva zobrazí se, že uživatel není možné vyjádřit souhlas.</span><span class="sxs-lookup"><span data-stu-id="3706b-189">If your application requests an app-only permission and a user tries to sign in to the application, an error message will be displayed saying the user isn’t able to consent.</span></span>

<span data-ttu-id="3706b-190">Některé přidělená oprávnění také vyžadovat souhlas správce klienta.</span><span class="sxs-lookup"><span data-stu-id="3706b-190">Certain delegated permissions also require a tenant administrator’s consent.</span></span>  <span data-ttu-id="3706b-191">Například možnost ke zpětnému zápisu do Azure AD jako přihlášeného uživatele vyžaduje souhlas správce klienta.</span><span class="sxs-lookup"><span data-stu-id="3706b-191">For example, the ability to write back to Azure AD as the signed in user requires a tenant administrator’s consent.</span></span>  <span data-ttu-id="3706b-192">Jako oprávnění jen pro aplikace Pokud se pokusí přihlásit k aplikaci, která požaduje delegované oprávnění, která vyžaduje souhlas správce běžného uživatele vaší aplikace dojde k chybě.</span><span class="sxs-lookup"><span data-stu-id="3706b-192">Like app-only permissions, if an ordinary user tries to sign in to an application that requests a delegated permission that requires administrator consent, your application will receive an error.</span></span>  <span data-ttu-id="3706b-193">Zda vyžaduje oprávnění správce souhlasu je určen podle vývojáře, která publikuje prostředek a může být v dokumentaci k prostředku.</span><span class="sxs-lookup"><span data-stu-id="3706b-193">Whether or not a permission requires admin consent is determined by the developer that published the resource, and can be found in the documentation for the resource.</span></span>  <span data-ttu-id="3706b-194">Odkazy na témata s popisem dostupná oprávnění pro Azure AD Graph API a rozhraní Microsoft Graph API jsou v [související obsahu](#related-content) tohoto článku.</span><span class="sxs-lookup"><span data-stu-id="3706b-194">Links to topics describing the available permissions for the Azure AD Graph API and Microsoft Graph API are in the [Related Content](#related-content) section of this article.</span></span>

<span data-ttu-id="3706b-195">Pokud vaše aplikace používá oprávnění, která vyžadovat souhlas správce, musíte mít gesto například tlačítko nebo odkaz, kde může správce zahájit akci.</span><span class="sxs-lookup"><span data-stu-id="3706b-195">If your application uses permissions that require admin consent, you need to have a gesture such as a button or link where the admin can initiate the action.</span></span>  <span data-ttu-id="3706b-196">Vaše aplikace odešle pro tato akce je obvykle požadavek ověřování OAuth2/OpenID Connect, ale který také obsahuje požadavek `prompt=admin_consent` parametr řetězce dotazu.</span><span class="sxs-lookup"><span data-stu-id="3706b-196">The request your application sends for this action is a usual OAuth2/OpenID Connect authorization request, but that also includes the `prompt=admin_consent` query string parameter.</span></span>  <span data-ttu-id="3706b-197">Jakmile se dá souhlas správce a instanční objekt se vytvoří v klientovi zákazníka, následných žádostí o přihlášení není nutné `prompt=admin_consent` parametr.</span><span class="sxs-lookup"><span data-stu-id="3706b-197">Once the admin has consented and the service principal is created in the customer’s tenant, subsequent sign-in requests do not need the `prompt=admin_consent` parameter.</span></span> <span data-ttu-id="3706b-198">Vzhledem k tomu, že správce určil, že požadovaná oprávnění jsou přijatelné, bude se žádné jiných uživatelů v klientovi, požádejte ho o souhlas od tohoto okamžiku.</span><span class="sxs-lookup"><span data-stu-id="3706b-198">Since the administrator has decided the requested permissions are acceptable, no other users in the tenant will be prompted for consent from that point forward.</span></span>

<span data-ttu-id="3706b-199">`prompt=admin_consent` Parametru lze také aplikace, které žádostí o oprávnění, které nevyžadují souhlas správce.</span><span class="sxs-lookup"><span data-stu-id="3706b-199">The `prompt=admin_consent` parameter can also be used by applications that request permissions that do not require admin consent.</span></span> <span data-ttu-id="3706b-200">Důvodem je, když aplikace vyžaduje kde klienta správce "zaregistruje" jeden čas a žádné jiné uživatele požádejte ho o souhlas od tohoto okamžiku v prostředí.</span><span class="sxs-lookup"><span data-stu-id="3706b-200">This is done when the applicaton requires an experience where the tenant admin “signs up” one time, and no other users are prompted for consent from that point on.</span></span>

<span data-ttu-id="3706b-201">Pokud aplikace vyžaduje souhlas správce a správce přihlášení ale `prompt=admin_consent` parametr neposílají, aplikace se úspěšně souhlas správce **pouze ke svému uživatelskému účtu**.</span><span class="sxs-lookup"><span data-stu-id="3706b-201">If an application requires admin consent, and an admin signs in but the `prompt=admin_consent` parameter is not sent, the admin will successfully consent to the application **only for their user account**.</span></span>  <span data-ttu-id="3706b-202">Stále běžní uživatelé nebudou moci přihlásit a souhlas k aplikaci.</span><span class="sxs-lookup"><span data-stu-id="3706b-202">Regular users will still not be able to sign in and consent to the application.</span></span>  <span data-ttu-id="3706b-203">To je užitečné, pokud chcete poskytnout možnost prozkoumat aplikace před povolením přístupu jiných uživatelů správce klienta.</span><span class="sxs-lookup"><span data-stu-id="3706b-203">This is useful if you want to give the tenant administrator the ability to explore your application before allowing other users access.</span></span>

<span data-ttu-id="3706b-204">Správce klienta můžete zakázat možnost pro regulární uživatele o souhlas pro aplikace.</span><span class="sxs-lookup"><span data-stu-id="3706b-204">A tenant administrator can disable the ability for regular users to consent to applications.</span></span>  <span data-ttu-id="3706b-205">Pokud tato možnost je vypnuta, je vyžadováno pro aplikaci, aby byl nastavený v klientovi vždy souhlas správce.</span><span class="sxs-lookup"><span data-stu-id="3706b-205">If this capability is disabled, admin consent is always required for the application to be set up in the tenant.</span></span>  <span data-ttu-id="3706b-206">Pokud chcete testování vaší aplikace pomocí běžných uživatelských souhlasu zakázaná, můžete najít konfigurace přepínače v klientovi Azure AD oddílu konfigurace [portál Azure][AZURE-portal].</span><span class="sxs-lookup"><span data-stu-id="3706b-206">If you want to test your application with regular user consent disabled, you can find the configuration switch in the Azure AD tenant configuration section of the [Azure portal][AZURE-portal].</span></span>

> [!NOTE]
> <span data-ttu-id="3706b-207">Některé aplikace mají prostředí, kde jsou běžní uživatelé moct souhlas původně a později aplikace může zahrnovat oprávnění správce a požadavku, která vyžadovat souhlas správce.</span><span class="sxs-lookup"><span data-stu-id="3706b-207">Some applications want an experience where regular users are able to consent initially, and later the application can involve the administrator and request permissions that require admin consent.</span></span>  <span data-ttu-id="3706b-208">Neexistuje žádný způsob, jak to provést pomocí jedné aplikace registrace ve službě Azure AD ještě dnes.</span><span class="sxs-lookup"><span data-stu-id="3706b-208">There is no way to do this with a single application registration in Azure AD today.</span></span>  <span data-ttu-id="3706b-209">Na nadcházející akci koncového bodu Azure AD v2 bude během registrace, která vám umožní tento scénář povolit aplikace a požádat o oprávnění za běhu, místo.</span><span class="sxs-lookup"><span data-stu-id="3706b-209">The upcoming Azure AD v2 endpoint will allow applications to request permissions at runtime, instead of at registration time, which will enable this scenario.</span></span>  <span data-ttu-id="3706b-210">Další informace najdete v tématu [Příručka vývojáře v2 modelu aplikace Azure AD][AAD-V2-Dev-Guide].</span><span class="sxs-lookup"><span data-stu-id="3706b-210">For more information, see the [Azure AD App Model v2 Developer Guide][AAD-V2-Dev-Guide].</span></span>
> 
> 

### <a name="consent-and-multi-tier-applications"></a><span data-ttu-id="3706b-211">Souhlasu a vícevrstvé aplikace</span><span class="sxs-lookup"><span data-stu-id="3706b-211">Consent and multi-tier applications</span></span>
<span data-ttu-id="3706b-212">Aplikace může mít několik vrstev, každý reprezentován vlastní registraci ve službě Azure AD.</span><span class="sxs-lookup"><span data-stu-id="3706b-212">Your application may have multiple tiers, each represented by its own registration in Azure AD.</span></span>  <span data-ttu-id="3706b-213">Nativní aplikace, která volá webové rozhraní API nebo webovou aplikaci, například volání webového rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="3706b-213">For example, a native application that calls a web API, or a web application that calls a web API.</span></span>  <span data-ttu-id="3706b-214">V obou případech klienta (nativní aplikaci nebo webové aplikace) vyžaduje oprávnění k volání prostředků (webového rozhraní API).</span><span class="sxs-lookup"><span data-stu-id="3706b-214">In both of these cases, the client (native app or web app) requests permissions to call the resource (web API).</span></span>  <span data-ttu-id="3706b-215">Klient se úspěšně dá souhlas, do klienta zákazníka všechny prostředky, ke kterým se vyžaduje oprávnění již musí existovat v klientovi zákazníka.</span><span class="sxs-lookup"><span data-stu-id="3706b-215">For the client to be successfully consented into a customer’s tenant, all resources to which it requests permissions must already exist in the customer’s tenant.</span></span>  <span data-ttu-id="3706b-216">Pokud není tato podmínka splněná, Azure AD vrátí chybu prostředek musí být nejprve přidán.</span><span class="sxs-lookup"><span data-stu-id="3706b-216">If this condition isn’t met, Azure AD will return an error that the resource must be added first.</span></span>

<span data-ttu-id="3706b-217">**Několik vrstev v jednoho klienta**</span><span class="sxs-lookup"><span data-stu-id="3706b-217">**Multiple tiers in a single tenant**</span></span>

<span data-ttu-id="3706b-218">Může to být problém, pokud vaše logické aplikace se skládá ze dvou nebo více aplikací registrace, například klienta a prostředků.</span><span class="sxs-lookup"><span data-stu-id="3706b-218">This can be a problem if your logical application consists of two or more application registrations, for example a separate client and resource.</span></span>  <span data-ttu-id="3706b-219">Jak můžete získat prostředek do klienta zákazníka první?</span><span class="sxs-lookup"><span data-stu-id="3706b-219">How do you get the resource into the customer tenant first?</span></span>  <span data-ttu-id="3706b-220">Azure AD se popisuje tento případ povolením klienta a prostředku se dá souhlas v jediném kroku.</span><span class="sxs-lookup"><span data-stu-id="3706b-220">Azure AD covers this case by enabling client and resource to be consented in a single step.</span></span> <span data-ttu-id="3706b-221">Uživateli se zobrazí celkový součet oprávnění požadovaná klientem a prostředků na stránce souhlasu.</span><span class="sxs-lookup"><span data-stu-id="3706b-221">The user sees the sum total of the permissions requested by both the client and resource on the consent page.</span></span>  <span data-ttu-id="3706b-222">Chcete-li toto chování, registrace aplikace prostředku musí obsahovat ID klienta aplikace jako `knownClientApplications` v manifestu aplikace.</span><span class="sxs-lookup"><span data-stu-id="3706b-222">To enable this behavior, the resource’s application registration must include the client’s App ID as a `knownClientApplications` in its application manifest.</span></span>  <span data-ttu-id="3706b-223">Například:</span><span class="sxs-lookup"><span data-stu-id="3706b-223">For example:</span></span>

    knownClientApplications": ["94da0930-763f-45c7-8d26-04d5938baab2"]

<span data-ttu-id="3706b-224">Tuto vlastnost lze aktualizovat prostřednictvím prostředek [manifestu aplikace][AAD-App-Manifest].</span><span class="sxs-lookup"><span data-stu-id="3706b-224">This property can be updated via the resource [application’s manifest][AAD-App-Manifest].</span></span> <span data-ttu-id="3706b-225">Tento postup je znázorněn v vícevrstvé nativního klienta volání ukázkové webové rozhraní API v [související obsahu](#related-content) na konci tohoto článku.</span><span class="sxs-lookup"><span data-stu-id="3706b-225">This is demonstrated in a multi-tier native client calling web API sample in the [Related Content](#related-content) section at the end of this article.</span></span> <span data-ttu-id="3706b-226">Následující diagram přehledně souhlasu pro vícevrstvé aplikace s zaregistrovaný v jednoho klienta:</span><span class="sxs-lookup"><span data-stu-id="3706b-226">The following diagram provides an overview of consent for a multi-tier app registered in a single tenant :</span></span>

![Souhlas známé klienta vícevrstvé aplikace][Consent-Multi-Tier-Known-Client] 

<span data-ttu-id="3706b-228">**Několik vrstev v několika klientech**</span><span class="sxs-lookup"><span data-stu-id="3706b-228">**Multiple tiers in multiple tenants**</span></span>

<span data-ttu-id="3706b-229">Podobný případ se stane, když jsou v jiných klientů zaregistrované různých vrstev aplikace.</span><span class="sxs-lookup"><span data-stu-id="3706b-229">A similar case happens if the different tiers of an application are registered in different tenants.</span></span>  <span data-ttu-id="3706b-230">Představte si třeba v případě vytváření nativní klientskou aplikaci, která volá Online rozhraní API sady Office 365 Exchange.</span><span class="sxs-lookup"><span data-stu-id="3706b-230">For example, consider the case of building a native client application that calls the Office 365 Exchange Online API.</span></span>  <span data-ttu-id="3706b-231">K vývoji nativní aplikaci a novějším pro nativní aplikace spuštěna v klientovi zákazníka, musí být objekt služby Exchange Online.</span><span class="sxs-lookup"><span data-stu-id="3706b-231">To develop the native application, and later for the native application to run in a customer’s tenant, the Exchange Online service principal must be present.</span></span>  <span data-ttu-id="3706b-232">V takovém případě se developer a zákazník musí zakoupit Exchange Online pro službu objektu vytvořeny v svým klientům.</span><span class="sxs-lookup"><span data-stu-id="3706b-232">In this case, the developer and customer must purchase Exchange Online for the service principal to be created in their tenants.</span></span>  

<span data-ttu-id="3706b-233">V případě rozhraní API vytvořené v organizaci než Microsoft musí vývojář rozhraní API poskytují způsob, jak zákazníkům o souhlas aplikaci do klientů svým zákazníkům.</span><span class="sxs-lookup"><span data-stu-id="3706b-233">In the case of an API built by an organization other than Microsoft, the developer of the API needs to provide a way for their customers to consent the application into their customers' tenants.</span></span> <span data-ttu-id="3706b-234">Doporučený návrh je pro vývojáře 3. stran k vytvoření rozhraní API, tak, aby také může fungovat jako webový klient k implementaci registrace:</span><span class="sxs-lookup"><span data-stu-id="3706b-234">The recommended design is for the 3rd party developer to build the API such that it can also function as a web client to implement sign-up :</span></span>

1. <span data-ttu-id="3706b-235">Postupujte podle předchozích částech k zajištění, že požadavky na registraci nebo kód víceklientské aplikace implementuje rozhraní API</span><span class="sxs-lookup"><span data-stu-id="3706b-235">Follow the earlier sections to ensure the API implements the multi-tenant application registration/code requirements</span></span>
2. <span data-ttu-id="3706b-236">Kromě vystavení rozhraní API obory nebo role, ujistěte se, zahrnuje registrace "přihlášení a čtení profilu uživatele" oprávnění Azure AD (poskytuje se ve výchozím nastavení)</span><span class="sxs-lookup"><span data-stu-id="3706b-236">In addition to exposing the API's scopes/roles, ensure the registration includes the "Sign in and read user profile" Azure AD permission (provided by default)</span></span>
3. <span data-ttu-id="3706b-237">Implementace sign v nebo registrace-množství stránky v webovému klientovi, následující [souhlas správce](#admin-consent) pokyny uvedenými výše</span><span class="sxs-lookup"><span data-stu-id="3706b-237">Implement a sign-in/sign-up page in the web client, following the [admin consent](#admin-consent) guidance discussed earlier</span></span> 
4. <span data-ttu-id="3706b-238">Když uživatel souhlasí k aplikaci, odkazy service principal a souhlasu delegování jsou vytvořené v jejich klienta a nativní aplikace mohou získat tokeny pro rozhraní API</span><span class="sxs-lookup"><span data-stu-id="3706b-238">Once the user consents to the application, the service principal and consent delegation links are created in their tenant, and the native application can get tokens for the API</span></span>

<span data-ttu-id="3706b-239">Následující diagram přehledně souhlasu pro vícevrstvé aplikace s zaregistrovaný v jiných klientů:</span><span class="sxs-lookup"><span data-stu-id="3706b-239">The following diagram provides an overview of consent for a multi-tier app registered in different tenants:</span></span>

![Souhlas vícevrstvé aplikace s více stran][Consent-Multi-Tier-Multi-Party] 

### <a name="revoking-consent"></a><span data-ttu-id="3706b-241">Odvolání souhlasu</span><span class="sxs-lookup"><span data-stu-id="3706b-241">Revoking Consent</span></span>
<span data-ttu-id="3706b-242">Uživatelé a správci můžete odvolat souhlas k vaší aplikaci kdykoli:</span><span class="sxs-lookup"><span data-stu-id="3706b-242">Users and administrators can revoke consent to your application at any time:</span></span>

* <span data-ttu-id="3706b-243">Uživatelé odvolat přístup k jednotlivých aplikací odstraněním těchto z jejich [přístup k aplikacím panely] [ AAD-Access-Panel] seznamu.</span><span class="sxs-lookup"><span data-stu-id="3706b-243">Users revoke access to individual applications by removing them from their [Access Panel Applications][AAD-Access-Panel] list.</span></span>
* <span data-ttu-id="3706b-244">Správci odvolat přístup k aplikacím je odstranit z Azure AD pomocí části Správa Azure AD [portál Azure][AZURE-portal].</span><span class="sxs-lookup"><span data-stu-id="3706b-244">Administrators revoke access to applications by removing them from Azure AD using the Azure AD management section of the [Azure portal][AZURE-portal].</span></span>

<span data-ttu-id="3706b-245">Pokud správce souhlasí k aplikaci pro všechny uživatele v klientovi, uživatelé nelze odvolat přístup jednotlivě.</span><span class="sxs-lookup"><span data-stu-id="3706b-245">If an administrator consents to an application for all users in a tenant, users cannot revoke access individually.</span></span>  <span data-ttu-id="3706b-246">Pouze správce můžete odvolat přístup a jenom pro celou aplikaci.</span><span class="sxs-lookup"><span data-stu-id="3706b-246">Only the administrator can revoke access, and only for the whole application.</span></span>

### <a name="consent-and-protocol-support"></a><span data-ttu-id="3706b-247">Souhlasu a podpora protokolu</span><span class="sxs-lookup"><span data-stu-id="3706b-247">Consent and Protocol Support</span></span>
<span data-ttu-id="3706b-248">Souhlas se podporuje ve službě Azure AD pomocí OAuth, OpenID Connect, WS-Federation a protokoly SAML.</span><span class="sxs-lookup"><span data-stu-id="3706b-248">Consent is supported in Azure AD via the OAuth, OpenID Connect, WS-Federation, and SAML protocols.</span></span>  <span data-ttu-id="3706b-249">Protokoly SAML a WS-Federation nepodporují `prompt=admin_consent` parametr, tak je možné pomocí OAuth a OpenID Connect jenom souhlas správce.</span><span class="sxs-lookup"><span data-stu-id="3706b-249">The SAML and WS-Federation protocols do not support the `prompt=admin_consent` parameter, so admin consent is only possible via OAuth and OpenID Connect.</span></span>

## <a name="multi-tenant-applications-and-caching-access-tokens"></a><span data-ttu-id="3706b-250">Víceklientské aplikace a ukládání do mezipaměti přístupové tokeny</span><span class="sxs-lookup"><span data-stu-id="3706b-250">Multi-Tenant Applications and Caching Access Tokens</span></span>
<span data-ttu-id="3706b-251">Víceklientským aplikacím můžete také získat přístupové tokeny k volání rozhraní API, které jsou chráněné službou Azure AD.</span><span class="sxs-lookup"><span data-stu-id="3706b-251">Multi-tenant applications can also get access tokens to call APIs that are protected by Azure AD.</span></span>  <span data-ttu-id="3706b-252">Běžnou chybou při Active Directory Authentication Library (ADAL) pomocí víceklientské aplikace, je nejdřív požádat o token pro uživatele s využitím/Common, obdrží odpověď a potom požádat o další token pro tomuto uživateli také pomocí/Common.</span><span class="sxs-lookup"><span data-stu-id="3706b-252">A common error when using the Active Directory Authentication Library (ADAL) with a multi-tenant application, is to initially request a token for a user using /common, receive a response, then request a subsequent token for that same user also using /common.</span></span>  <span data-ttu-id="3706b-253">Vzhledem k tomu, že odpověď z Azure AD pochází z klienta, není nebo běžné, ADAL ukládá do mezipaměti token, že je z klienta.</span><span class="sxs-lookup"><span data-stu-id="3706b-253">Since the response from Azure AD comes from a tenant, not /common, ADAL caches the token as being from the tenant.</span></span> <span data-ttu-id="3706b-254">Další volání/Common získat přístupový token pro uživatele neúspěšných přístupů do položky mezipaměti a uživatel je vyzván se znovu přihlásit.</span><span class="sxs-lookup"><span data-stu-id="3706b-254">The subsequent call to /common to get an access token for the user misses the cache entry, and the user is prompted to sign in again.</span></span>  <span data-ttu-id="3706b-255">Abyste se vyhnuli chybí mezipaměti, zkontrolujte, zda koncový bod klienta jsou provedeny následující volání pro již přihlášeného uživatele.</span><span class="sxs-lookup"><span data-stu-id="3706b-255">To avoid missing the cache, make sure subsequent calls for an already signed in user are made to the tenant’s endpoint.</span></span>

## <a name="next-steps"></a><span data-ttu-id="3706b-256">Další kroky</span><span class="sxs-lookup"><span data-stu-id="3706b-256">Next steps</span></span>
<span data-ttu-id="3706b-257">V tomto článku jste zjistili, jak sestavit aplikaci, která se může přihlásit uživatel jakéhokoli klienta Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="3706b-257">In this article, you learned how to build an application that can sign in a user from any Azure Active Directory tenant.</span></span> <span data-ttu-id="3706b-258">Po povolení jednotného přihlašování mezi aplikací a Azure Active Directory, můžete také aktualizovat aplikaci pro přístup k rozhraní API vystavené zdroje společnosti Microsoft, jako je Office 365.</span><span class="sxs-lookup"><span data-stu-id="3706b-258">After enabling Single Sign-On between your app and Azure Active Directory, you can also update your application to access APIs exposed by Microsoft resources, like Office 365.</span></span> <span data-ttu-id="3706b-259">Přizpůsobené rozhraní můžete tak nabízet ve vaší aplikaci, například zobrazení kontextové informace pro uživatele, jako je jejich profilový obrázek nebo jejich další událost kalendáře.</span><span class="sxs-lookup"><span data-stu-id="3706b-259">So you can offer a personalized experience in your application, for example showing contextual information to the users, like their profile picture or their next calendar appointment.</span></span> <span data-ttu-id="3706b-260">Další informace o volání rozhraní API služby Azure Active Directory a Office 365, jako je Exchange, SharePoint, OneDrive, OneNote, Planner, Excel a další, navštivte: [Microsoft Graph API][MSFT-Graph-overview].</span><span class="sxs-lookup"><span data-stu-id="3706b-260">To learn more about making API calls to Azure Active Directory and Office 365 services like Exchange, SharePoint, OneDrive, OneNote, Planner, Excel and more, visit: [Microsoft Graph API][MSFT-Graph-overview].</span></span>


## <a name="related-content"></a><span data-ttu-id="3706b-261">Související obsah</span><span class="sxs-lookup"><span data-stu-id="3706b-261">Related content</span></span>
* <span data-ttu-id="3706b-262">[Ukázky víceklientské aplikace][AAD-Samples-MT]</span><span class="sxs-lookup"><span data-stu-id="3706b-262">[Multi-tenant application samples][AAD-Samples-MT]</span></span>
* <span data-ttu-id="3706b-263">[Branding pokyny pro aplikace][AAD-App-Branding]</span><span class="sxs-lookup"><span data-stu-id="3706b-263">[Branding Guidelines for Applications][AAD-App-Branding]</span></span>
* <span data-ttu-id="3706b-264">[Průvodce Azure AD vývojáře][AAD-Dev-Guide]</span><span class="sxs-lookup"><span data-stu-id="3706b-264">[Azure AD Developer's Guide][AAD-Dev-Guide]</span></span>
* <span data-ttu-id="3706b-265">[Objekty aplikací a hlavní objekty služeb][AAD-App-SP-Objects]</span><span class="sxs-lookup"><span data-stu-id="3706b-265">[Application Objects and Service Principal Objects][AAD-App-SP-Objects]</span></span>
* <span data-ttu-id="3706b-266">[Integrace aplikací s Azure Active Directory][AAD-Integrating-Apps]</span><span class="sxs-lookup"><span data-stu-id="3706b-266">[Integrating Applications with Azure Active Directory][AAD-Integrating-Apps]</span></span>
* <span data-ttu-id="3706b-267">[Přehled rozhraní souhlasu][AAD-Consent-Overview]</span><span class="sxs-lookup"><span data-stu-id="3706b-267">[Overview of the Consent Framework][AAD-Consent-Overview]</span></span>
* <span data-ttu-id="3706b-268">[Obory oprávnění Microsoft Graph API][MSFT-Graph-permision-scopes]</span><span class="sxs-lookup"><span data-stu-id="3706b-268">[Microsoft Graph API Permission Scopes][MSFT-Graph-permision-scopes]</span></span>
* <span data-ttu-id="3706b-269">[Obory oprávnění rozhraní Azure AD Graph API][AAD-Graph-Perm-Scopes]</span><span class="sxs-lookup"><span data-stu-id="3706b-269">[Azure AD Graph API Permission Scopes][AAD-Graph-Perm-Scopes]</span></span>

<span data-ttu-id="3706b-270">Použijte následující sekci komentáře k poskytnutí zpětné vazby a Pomozte nám vylepšit a utvářejí náš obsah.</span><span class="sxs-lookup"><span data-stu-id="3706b-270">Please use the following comments section to provide feedback and help us refine and shape our content.</span></span>

<!--Reference style links IN USE -->
[AAD-Access-Panel]:  https://myapps.microsoft.com
[AAD-App-Branding]: ./active-directory-branding-guidelines.md
[AAD-App-Manifest]: ./active-directory-application-manifest.md
[AAD-App-SP-Objects]: ./active-directory-application-objects.md
[AAD-Auth-Scenarios]: ./active-directory-authentication-scenarios.md
[AAD-Consent-Overview]: ./active-directory-integrating-applications.md#overview-of-the-consent-framework
[AAD-Dev-Guide]: ./active-directory-developers-guide.md
[AAD-Graph-Overview]: https://azure.microsoft.com/en-us/documentation/articles/active-directory-graph-api/
[AAD-Graph-Perm-Scopes]: https://msdn.microsoft.com/library/azure/ad/graph/howto/azure-ad-graph-api-permission-scopes
[AAD-Integrating-Apps]: ./active-directory-integrating-applications.md
[AAD-Samples-MT]: https://azure.microsoft.com/documentation/samples/?service=active-directory&term=multitenant
[AAD-Why-To-Integrate]: ./active-directory-how-to-integrate.md
[AZURE-portal]: https://portal.azure.com
[MSFT-Graph-overview]: https://graph.microsoft.io/en-us/docs/overview/overview
[MSFT-Graph-permision-scopes]: https://graph.microsoft.io/en-us/docs/authorization/permission_scopes

<!--Image references-->
[AAD-Sign-In]: ./media/active-directory-devhowto-multi-tenant-overview/sign-in-with-microsoft-light.png
[Consent-Single-Tier]: ./media/active-directory-devhowto-multi-tenant-overview/consent-flow-single-tier.png
[Consent-Multi-Tier-Known-Client]: ./media/active-directory-devhowto-multi-tenant-overview/consent-flow-multi-tier-known-clients.png
[Consent-Multi-Tier-Multi-Party]: ./media/active-directory-devhowto-multi-tenant-overview/consent-flow-multi-tier-multi-party.png

<!--Reference style links -->
[AAD-App-Manifest]: ./active-directory-application-manifest.md
[AAD-App-SP-Objects]: ./active-directory-application-objects.md
[AAD-Auth-Scenarios]: ./active-directory-authentication-scenarios.md
[AAD-Integrating-Apps]: ./active-directory-integrating-applications.md
[AAD-Dev-Guide]: ./active-directory-developers-guide.md
[AAD-Graph-Perm-Scopes]: https://msdn.microsoft.com/library/azure/ad/graph/howto/azure-ad-graph-api-permission-scopes
[AAD-Graph-App-Entity]: https://msdn.microsoft.com/Library/Azure/Ad/Graph/api/entity-and-complex-type-reference#application-entity
[AAD-Graph-Sp-Entity]: https://msdn.microsoft.com/Library/Azure/Ad/Graph/api/entity-and-complex-type-reference#serviceprincipal-entity
[AAD-Graph-User-Entity]: https://msdn.microsoft.com/Library/Azure/Ad/Graph/api/entity-and-complex-type-reference#user-entity
[AAD-How-To-Integrate]: ./active-directory-how-to-integrate.md
[AAD-Security-Token-Claims]: ./active-directory-authentication-scenarios/#claims-in-azure-ad-security-tokens
[AAD-Tokens-Claims]: ./active-directory-token-and-claims.md
[AAD-V2-Dev-Guide]: ../active-directory-appmodel-v2-overview.md
[AZURE-portal]: https://portal.azure.com
[Duyshant-Role-Blog]: http://www.dushyantgill.com/blog/2014/12/10/roles-based-access-control-in-cloud-applications-using-azure-ad/
[JWT]: https://tools.ietf.org/html/draft-ietf-oauth-json-web-token-32
[O365-Perm-Ref]: https://msdn.microsoft.com/en-us/office/office365/howto/application-manifest
[OAuth2-Access-Token-Scopes]: https://tools.ietf.org/html/rfc6749#section-3.3
[OAuth2-AuthZ-Code-Grant-Flow]: https://msdn.microsoft.com/library/azure/dn645542.aspx
[OAuth2-AuthZ-Grant-Types]: https://tools.ietf.org/html/rfc6749#section-1.3 
[OAuth2-Client-Types]: https://tools.ietf.org/html/rfc6749#section-2.1
[OAuth2-Role-Def]: https://tools.ietf.org/html/rfc6749#page-6
[OpenIDConnect]: http://openid.net/specs/openid-connect-core-1_0.html
[OpenIDConnect-ID-Token]: http://openid.net/specs/openid-connect-core-1_0.html#IDToken














