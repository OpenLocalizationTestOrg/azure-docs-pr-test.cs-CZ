---
title: "přihlašování aaaSingle pomocí Proxy aplikací | Microsoft Docs"
description: "Popisuje, jak tooprovide jednotného přihlašování pomocí proxy aplikace služby Azure AD."
services: active-directory
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: ded0d9c9-45f6-47d7-bd0f-3f7fd99ab621
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/25/2017
ms.author: kgremban
ms.reviewer: harshja
ms.custom: H1Hack27Feb2017, it-pro
ms.openlocfilehash: 0047e834cd42e057a75ebc0c5dcf860734464a05
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="kerberos-constrained-delegation-for-single-sign-on-tooyour-apps-with-application-proxy"></a><span data-ttu-id="838e1-103">Omezené delegování Kerberos tooyour přihlašování aplikací pomocí Proxy aplikace</span><span class="sxs-lookup"><span data-stu-id="838e1-103">Kerberos Constrained Delegation for single sign-on tooyour apps with Application Proxy</span></span>

<span data-ttu-id="838e1-104">Můžete zadat jednotné přihlašování pro místní aplikace publikované prostřednictvím Proxy aplikace, které jsou zabezpečené integrované ověřování systému Windows.</span><span class="sxs-lookup"><span data-stu-id="838e1-104">You can provide single sign-on for on-premises applications published through Application Proxy that are secured with Integrated Windows Authentication.</span></span> <span data-ttu-id="838e1-105">Tyto aplikace vyžadují lístek protokolu Kerberos pro přístup.</span><span class="sxs-lookup"><span data-stu-id="838e1-105">These applications require a Kerberos ticket for access.</span></span> <span data-ttu-id="838e1-106">Proxy aplikací používá protokol Kerberos vynuceným delegování použitím (KCD) toosupport tyto aplikace.</span><span class="sxs-lookup"><span data-stu-id="838e1-106">Application Proxy uses Kerberos Constrained Delegation (KCD) toosupport these applications.</span></span> 

<span data-ttu-id="838e1-107">Můžete povolit tooyour přihlášení aplikace, které používají integrované ověřování systému Windows (IWA) tím, že oprávnění konektory Proxy aplikace v tooimpersonate uživatelů služby Active Directory.</span><span class="sxs-lookup"><span data-stu-id="838e1-107">You can enable single sign-on tooyour applications using Integrated Windows Authentication (IWA) by giving Application Proxy connectors permission in Active Directory tooimpersonate users.</span></span> <span data-ttu-id="838e1-108">konektory Hello použijte tato oprávnění toosend a přijímat tokeny jejich jménem.</span><span class="sxs-lookup"><span data-stu-id="838e1-108">hello connectors use this permission toosend and receive tokens on their behalf.</span></span>

## <a name="how-single-sign-on-with-kcd-works"></a><span data-ttu-id="838e1-109">Jak jednotné přihlašování s použitím KCD funguje</span><span class="sxs-lookup"><span data-stu-id="838e1-109">How single sign-on with KCD works</span></span>
<span data-ttu-id="838e1-110">Tento diagram vysvětluje hello toku, když se uživatel pokusí tooaccess místní aplikace, která používá integrované ověřování systému Windows.</span><span class="sxs-lookup"><span data-stu-id="838e1-110">This diagram explains hello flow when a user attempts tooaccess an on-prem application that uses IWA.</span></span>

![Microsoft AAD ověřování vývojový diagram](./media/active-directory-application-proxy-sso-using-kcd/AuthDiagram.png)

1. <span data-ttu-id="838e1-112">Hello uživatel zadá hello URL tooaccess hello místní aplikace prostřednictvím Proxy aplikace.</span><span class="sxs-lookup"><span data-stu-id="838e1-112">hello user enters hello URL tooaccess hello on-prem application through Application Proxy.</span></span>
2. <span data-ttu-id="838e1-113">Proxy aplikace přesměruje hello požadavek tooAzure AD ověřování služby toopreauthenticate.</span><span class="sxs-lookup"><span data-stu-id="838e1-113">Application Proxy redirects hello request tooAzure AD authentication services toopreauthenticate.</span></span> <span data-ttu-id="838e1-114">V tomto okamžiku Azure AD platí všechny použitelné ověřování a zásady autorizace, jako například vícefaktorové ověřování.</span><span class="sxs-lookup"><span data-stu-id="838e1-114">At this point, Azure AD applies any applicable authentication and authorization policies, such as multifactor authentication.</span></span> <span data-ttu-id="838e1-115">Pokud ověření hello uživatele Azure AD vytvoří token a odešle ho toohello uživatele.</span><span class="sxs-lookup"><span data-stu-id="838e1-115">If hello user is validated, Azure AD creates a token and sends it toohello user.</span></span>
3. <span data-ttu-id="838e1-116">uživatel Hello předá hello tokenu tooApplication proxy serveru.</span><span class="sxs-lookup"><span data-stu-id="838e1-116">hello user passes hello token tooApplication Proxy.</span></span>
4. <span data-ttu-id="838e1-117">Proxy aplikací ověří hello token a načte z něj hello hlavní název uživatele (UPN) a poté odešle hello požadavku, hello UPN a hello hlavní název služby (SPN) toohello konektor prostřednictvím obousměrně ověřené zabezpečeného kanálu.</span><span class="sxs-lookup"><span data-stu-id="838e1-117">Application Proxy validates hello token and retrieves hello User Principal Name (UPN) from it, and then sends hello request, hello UPN, and hello Service Principal Name (SPN) toohello Connector through a dually authenticated secure channel.</span></span>
5. <span data-ttu-id="838e1-118">Hello konektor provede vyjednávání protokolu Kerberos vynuceným delegování použitím (KCD) s hello místní AD, zosobňování uživatele tooget hello k aplikaci tokenu toohello protokolu Kerberos.</span><span class="sxs-lookup"><span data-stu-id="838e1-118">hello Connector performs Kerberos Constrained Delegation (KCD) negotiation with hello on-prem AD, impersonating hello user tooget a Kerberos token toohello application.</span></span>
6. <span data-ttu-id="838e1-119">Služby Active Directory odešle hello token protokolu Kerberos pro toohello aplikace hello konektor.</span><span class="sxs-lookup"><span data-stu-id="838e1-119">Active Directory sends hello Kerberos token for hello application toohello Connector.</span></span>
7. <span data-ttu-id="838e1-120">Hello konektor odešle hello původní žádost toohello aplikační server, pomocí tokenu hello protokolu Kerberos, obdrženého ze služby Active Directory.</span><span class="sxs-lookup"><span data-stu-id="838e1-120">hello Connector sends hello original request toohello application server, using hello Kerberos token it received from AD.</span></span>
8. <span data-ttu-id="838e1-121">aplikace Hello odešle odpověď toohello hello konektor, který je pak vrácen toohello Proxy aplikace služby a v neposlední řadě toohello uživatele.</span><span class="sxs-lookup"><span data-stu-id="838e1-121">hello application sends hello response toohello Connector, which is then returned toohello Application Proxy service and finally toohello user.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="838e1-122">Požadavky</span><span class="sxs-lookup"><span data-stu-id="838e1-122">Prerequisites</span></span>
<span data-ttu-id="838e1-123">Před zahájením práce s jednotné přihlašování pro aplikace, integrované ověřování systému Windows, ujistěte se, je prostředí připravené s hello následující nastavení a konfigurace:</span><span class="sxs-lookup"><span data-stu-id="838e1-123">Before you get started with single sign-on for IWA applications, make sure your environment is ready with hello following settings and configurations:</span></span>

* <span data-ttu-id="838e1-124">Aplikace, jako jsou aplikace webové služby SharePoint, jsou nastavené toouse integrované ověřování systému Windows.</span><span class="sxs-lookup"><span data-stu-id="838e1-124">Your apps, like SharePoint Web apps, are set toouse Integrated Windows Authentication.</span></span> <span data-ttu-id="838e1-125">Další informace najdete v tématu [povolení podpory pro ověřování protokolem Kerberos](https://technet.microsoft.com/library/dd759186.aspx), nebo SharePoint najdete v tématu [plánování pro ověřování protokolem Kerberos v SharePoint 2013](https://technet.microsoft.com/library/ee806870.aspx).</span><span class="sxs-lookup"><span data-stu-id="838e1-125">For more information, see [Enable Support for Kerberos Authentication](https://technet.microsoft.com/library/dd759186.aspx), or for SharePoint see [Plan for Kerberos authentication in SharePoint 2013](https://technet.microsoft.com/library/ee806870.aspx).</span></span>
* <span data-ttu-id="838e1-126">Všechny aplikace mají [hlavní názvy služby](https://social.technet.microsoft.com/wiki/contents/articles/717.service-principal-names-spns-setspn-syntax-setspn-exe.aspx).</span><span class="sxs-lookup"><span data-stu-id="838e1-126">All your apps have [Service Principal Names](https://social.technet.microsoft.com/wiki/contents/articles/717.service-principal-names-spns-setspn-syntax-setspn-exe.aspx).</span></span>
* <span data-ttu-id="838e1-127">spuštěné hello Hello serveru konektoru a hello serveru se systémem hello aplikace jsou připojené k doméně a součástí hello stejné doméně nebo důvěryhodné domény.</span><span class="sxs-lookup"><span data-stu-id="838e1-127">hello server running hello Connector and hello server running hello app are domain joined and part of hello same domain or trusting domains.</span></span> <span data-ttu-id="838e1-128">Další informace o připojení k doméně, najdete v části [připojení k počítači tooa domény](https://technet.microsoft.com/library/dd807102.aspx).</span><span class="sxs-lookup"><span data-stu-id="838e1-128">For more information on domain join, see [Join a Computer tooa Domain](https://technet.microsoft.com/library/dd807102.aspx).</span></span>
* <span data-ttu-id="838e1-129">Hello serveru se systémem hello konektor má přístup tooread hello TokenGroupsGlobalAndUniversal atribut pro uživatele.</span><span class="sxs-lookup"><span data-stu-id="838e1-129">hello server running hello Connector has access tooread hello TokenGroupsGlobalAndUniversal attribute for users.</span></span> <span data-ttu-id="838e1-130">Toto výchozí nastavení může mít vliv zabezpečení posílení zabezpečení hello prostředí.</span><span class="sxs-lookup"><span data-stu-id="838e1-130">This default setting might have been impacted by security hardening hello environment.</span></span>

### <a name="configure-active-directory"></a><span data-ttu-id="838e1-131">Konfigurace Active Directory</span><span class="sxs-lookup"><span data-stu-id="838e1-131">Configure Active Directory</span></span>
<span data-ttu-id="838e1-132">Konfigurace služby Active Directory Hello se liší, v závislosti na tom, jestli vaše konektor Proxy aplikace a hello aplikačního serveru jsou v hello stejné doméně, nebo ne.</span><span class="sxs-lookup"><span data-stu-id="838e1-132">hello Active Directory configuration varies, depending on whether your Application Proxy connector and hello application server are in hello same domain or not.</span></span>

#### <a name="connector-and-application-server-in-hello-same-domain"></a><span data-ttu-id="838e1-133">Konektor a aplikační server v hello stejné doméně</span><span class="sxs-lookup"><span data-stu-id="838e1-133">Connector and application server in hello same domain</span></span>
1. <span data-ttu-id="838e1-134">Ve službě Active Directory, přejděte příliš**nástroje** > **uživatelé a počítače**.</span><span class="sxs-lookup"><span data-stu-id="838e1-134">In Active Directory, go too**Tools** > **Users and Computers**.</span></span>
2. <span data-ttu-id="838e1-135">Vyberte server hello spuštěným konektorem hello.</span><span class="sxs-lookup"><span data-stu-id="838e1-135">Select hello server running hello connector.</span></span>
3. <span data-ttu-id="838e1-136">Klikněte pravým tlačítkem a vyberte **vlastnosti** > **delegování**.</span><span class="sxs-lookup"><span data-stu-id="838e1-136">Right-click and select **Properties** > **Delegation**.</span></span>
4. <span data-ttu-id="838e1-137">Vyberte **důvěřovat tomuto počítači pro delegování pouze toospecified službám**.</span><span class="sxs-lookup"><span data-stu-id="838e1-137">Select **Trust this computer for delegation toospecified services only**.</span></span> 
5. <span data-ttu-id="838e1-138">V části **toowhich služby tento účet může prokázat delegovanými přihlašovacími údaji** přidejte hello hodnotu pro hello identita SPN hello aplikačního serveru.</span><span class="sxs-lookup"><span data-stu-id="838e1-138">Under **Services toowhich this account can present delegated credentials** add hello value for hello SPN identity of hello application server.</span></span> <span data-ttu-id="838e1-139">To umožňuje hello konektor Proxy aplikace tooimpersonate uživatelů ve službě AD proti aplikace hello definované v seznamu hello.</span><span class="sxs-lookup"><span data-stu-id="838e1-139">This enables hello Application Proxy Connector tooimpersonate users in AD against hello applications defined in hello list.</span></span>

   ![Snímek obrazovky okna vlastností konektoru SVR](./media/active-directory-application-proxy-sso-using-kcd/Properties.jpg)

#### <a name="connector-and-application-server-in-different-domains"></a><span data-ttu-id="838e1-141">Konektor a aplikační server v různých doménách</span><span class="sxs-lookup"><span data-stu-id="838e1-141">Connector and application server in different domains</span></span>
1. <span data-ttu-id="838e1-142">Seznam požadavků pro práci s použitím KCD napříč doménami, najdete v části [omezené delegování Kerberos mezi doménami](https://technet.microsoft.com/library/hh831477.aspx).</span><span class="sxs-lookup"><span data-stu-id="838e1-142">For a list of prerequisites for working with KCD across domains, see [Kerberos Constrained Delegation across domains](https://technet.microsoft.com/library/hh831477.aspx).</span></span>
2. <span data-ttu-id="838e1-143">Použití hello `principalsallowedtodelegateto` vlastnost hello konektor serveru tooenable hello Proxy aplikace toodelegate hello serveru konektoru.</span><span class="sxs-lookup"><span data-stu-id="838e1-143">Use hello `principalsallowedtodelegateto` property on hello Connector server tooenable hello Application Proxy toodelegate for hello Connector server.</span></span> <span data-ttu-id="838e1-144">Aplikační server Hello `sharepointserviceaccount` a delegování server hello je `connectormachineaccount`.</span><span class="sxs-lookup"><span data-stu-id="838e1-144">hello application server is `sharepointserviceaccount` and hello delegating server is `connectormachineaccount`.</span></span> <span data-ttu-id="838e1-145">Pro systém Windows 2012 R2 tento kód použijte jako příklad:</span><span class="sxs-lookup"><span data-stu-id="838e1-145">For Windows 2012 R2, use this code as an example:</span></span>

        $connector= Get-ADComputer -Identity connectormachineaccount -server dc.connectordomain.com

        Set-ADComputer -Identity sharepointserviceaccount -PrincipalsAllowedToDelegateToAccount $connector

        Get-ADComputer sharepointserviceaccount -Properties PrincipalsAllowedToDelegateToAccount

<span data-ttu-id="838e1-146">Sharepointserviceaccount může být účet počítače hello aktualizace Service Pack nebo účet služby, pod které hello aktualizace Service Pack běží fondu aplikací.</span><span class="sxs-lookup"><span data-stu-id="838e1-146">Sharepointserviceaccount can be hello SPS machine account or a service account under which hello SPS app pool is running.</span></span>

## <a name="configure-single-sign-on"></a><span data-ttu-id="838e1-147">Konfigurovat jednotné přihlašování</span><span class="sxs-lookup"><span data-stu-id="838e1-147">Configure single sign-on</span></span> 
1. <span data-ttu-id="838e1-148">Publikování aplikace podle toohello pokynů v tématu [publikování aplikací pomocí Proxy aplikace](application-proxy-publish-azure-portal.md).</span><span class="sxs-lookup"><span data-stu-id="838e1-148">Publish your application according toohello instructions described in [Publish applications with Application Proxy](application-proxy-publish-azure-portal.md).</span></span> <span data-ttu-id="838e1-149">Ujistěte se, že tooselect **Azure Active Directory** jako hello **metoda předběžného ověření**.</span><span class="sxs-lookup"><span data-stu-id="838e1-149">Make sure tooselect **Azure Active Directory** as hello **Preauthentication Method**.</span></span>
2. <span data-ttu-id="838e1-150">Když vaše aplikace se zobrazí v seznamu hello podnikové aplikace, vyberte ho a klikněte na **jednotného přihlašování**.</span><span class="sxs-lookup"><span data-stu-id="838e1-150">After your application appears in hello list of enterprise applications, select it and click **Single sign-on**.</span></span>
3. <span data-ttu-id="838e1-151">Nastavení příliš hello jeden přihlašování v režimu**integrované ověřování systému Windows**.</span><span class="sxs-lookup"><span data-stu-id="838e1-151">Set hello single sign-on mode too**Integrated Windows Authentication**.</span></span>  
4. <span data-ttu-id="838e1-152">Zadejte hello **interní aplikace SPN** hello aplikačního serveru.</span><span class="sxs-lookup"><span data-stu-id="838e1-152">Enter hello **Internal Application SPN** of hello application server.</span></span> <span data-ttu-id="838e1-153">V tomto příkladu je hello SPN pro naše publikovaná aplikace http/www.contoso.com. Tento hlavní název služby musí toobe v hello seznam služeb toowhich hello konektoru může prokázat delegovanými přihlašovacími údaji.</span><span class="sxs-lookup"><span data-stu-id="838e1-153">In this example, hello SPN for our published application is http/www.contoso.com. This SPN needs toobe in hello list of services toowhich hello connector can present delegated credentials.</span></span> 
5. <span data-ttu-id="838e1-154">Zvolte hello **delegované Identity přihlášení** pro konektor toouse hello jménem uživatele.</span><span class="sxs-lookup"><span data-stu-id="838e1-154">Choose hello **Delegated Login Identity** for hello connector toouse on behalf of your users.</span></span> <span data-ttu-id="838e1-155">Další informace najdete v tématu [práce s jinou místní a cloudové identity](#Working-with-different-on-premises-and-cloud-identities)</span><span class="sxs-lookup"><span data-stu-id="838e1-155">For more information, see [Working with different on-premises and cloud identities](#Working-with-different-on-premises-and-cloud-identities)</span></span>

   ![Konfigurace pokročilé aplikace](./media/active-directory-application-proxy-sso-using-kcd/cwap_auth2.png)  


## <a name="sso-for-non-windows-apps"></a><span data-ttu-id="838e1-157">Jednotné přihlašování pro aplikace systému Windows</span><span class="sxs-lookup"><span data-stu-id="838e1-157">SSO for non-Windows apps</span></span>
<span data-ttu-id="838e1-158">Hello tok delegování protokolu Kerberos v Azure AD Application Proxy spustí, když služba Azure AD ověřuje uživatele hello v cloudu hello.</span><span class="sxs-lookup"><span data-stu-id="838e1-158">hello Kerberos delegation flow in Azure AD Application Proxy starts when Azure AD authenticates hello user in hello cloud.</span></span> <span data-ttu-id="838e1-159">Jakmile požadavek hello dorazí na místě, hello hello Azure AD Application Proxy connector vystavuje lístek protokolu Kerberos jménem uživatele hello interakcí s místní službou Active Directory.</span><span class="sxs-lookup"><span data-stu-id="838e1-159">Once hello request arrives on-premises, hello Azure AD Application Proxy connector issues a Kerberos ticket on behalf of hello user by interacting with hello local Active Directory.</span></span> <span data-ttu-id="838e1-160">Tento proces je odkazované tooas Kerberos vynuceným delegování použitím (KCD).</span><span class="sxs-lookup"><span data-stu-id="838e1-160">This process is referred tooas Kerberos Constrained Delegation (KCD).</span></span> <span data-ttu-id="838e1-161">V hello další fázi, že je požadavek odeslán toohello back-end aplikace s Tento lístek protokolu Kerberos.</span><span class="sxs-lookup"><span data-stu-id="838e1-161">In hello next phase, a request is sent toohello backend application with this Kerberos ticket.</span></span> <span data-ttu-id="838e1-162">Existuje několik protokolů, které definují, jak se toosend například požadavky.</span><span class="sxs-lookup"><span data-stu-id="838e1-162">There are several protocols that define how toosend such requests.</span></span> <span data-ttu-id="838e1-163">Většina serverů jiný systém než Windows očekávat Negotiate/SPNego, který se teď podporuje v Azure AD Application Proxy.</span><span class="sxs-lookup"><span data-stu-id="838e1-163">Most non-Windows servers expect Negotiate/SPNego that is now supported on Azure AD Application Proxy.</span></span>

<span data-ttu-id="838e1-164">Další informace o protokolu Kerberos najdete v tématu [všechny chcete tooknow o použitím protokolu Kerberos omezené delegování (KCD)](https://blogs.technet.microsoft.com/applicationproxyblog/2015/09/21/all-you-want-to-know-about-kerberos-constrained-delegation-kcd).</span><span class="sxs-lookup"><span data-stu-id="838e1-164">For more information about Kerberos, see [All you want tooknow about Kerberos Constrained Delegation (KCD)](https://blogs.technet.microsoft.com/applicationproxyblog/2015/09/21/all-you-want-to-know-about-kerberos-constrained-delegation-kcd).</span></span>

<span data-ttu-id="838e1-165">Aplikace pro Windows bez obvykle uživatelská jména uživatelů a názvy účtů SAM místo domény e-mailové adresy.</span><span class="sxs-lookup"><span data-stu-id="838e1-165">Non-Windows apps typically user usernames or SAM account names instead of domain email addresses.</span></span> <span data-ttu-id="838e1-166">Pokud tato situace vztahuje tooyour aplikace, musíte tooconfigure hello delegovaný přihlášení identity pole tooconnect cloudové identity tooyour aplikace identity.</span><span class="sxs-lookup"><span data-stu-id="838e1-166">If that situation applies tooyour applications, you need tooconfigure hello delegated login identity field tooconnect your cloud identities tooyour application identities.</span></span> 

## <a name="working-with-different-on-premises-and-cloud-identities"></a><span data-ttu-id="838e1-167">Práce s jinou místní a cloudové identity</span><span class="sxs-lookup"><span data-stu-id="838e1-167">Working with different on-premises and cloud identities</span></span>
<span data-ttu-id="838e1-168">Proxy aplikace se předpokládá, že uživatelé mají přesně hello stejnou identitu v hello cloudu a místně.</span><span class="sxs-lookup"><span data-stu-id="838e1-168">Application Proxy assumes that users have exactly hello same identity in hello cloud and on-premises.</span></span> <span data-ttu-id="838e1-169">Pokud to není hello případ, může stále můžete použitím KCD pro jednotné přihlašování.</span><span class="sxs-lookup"><span data-stu-id="838e1-169">If that's not hello case, you can can still use KCD for single sign-on.</span></span> <span data-ttu-id="838e1-170">Konfigurace **delegované identity přihlášení** pro každou aplikaci toospecify identity, které se mají použít, při provádění jednotné přihlašování.</span><span class="sxs-lookup"><span data-stu-id="838e1-170">Configure a **Delegated login identity** for each application toospecify which identity should be used when performing single sign-on.</span></span>  

<span data-ttu-id="838e1-171">Tato možnost umožňuje řada organizací, které mají různých místních a cloudových identit toohave jednotného přihlašování z hello cloudové tooon místní aplikace bez nutnosti hello uživatelé tooenter různých uživatelských jmen a hesel.</span><span class="sxs-lookup"><span data-stu-id="838e1-171">This capability allows many organizations that have different on-premises and cloud identities toohave SSO from hello cloud tooon-premises apps without requiring hello users tooenter different usernames and passwords.</span></span> <span data-ttu-id="838e1-172">To zahrnuje organizace který:</span><span class="sxs-lookup"><span data-stu-id="838e1-172">This includes organizations that:</span></span>

* <span data-ttu-id="838e1-173">Interně mají několik domén (joe@us.contoso.com, joe@eu.contoso.com) a jednu doménu v cloudu hello (joe@contoso.com).</span><span class="sxs-lookup"><span data-stu-id="838e1-173">Have multiple domains internally (joe@us.contoso.com, joe@eu.contoso.com) and a single domain in hello cloud (joe@contoso.com).</span></span>
* <span data-ttu-id="838e1-174">Interně mít název směrovat domény (joe@contoso.usa) a právní jeden v cloudu hello.</span><span class="sxs-lookup"><span data-stu-id="838e1-174">Have non-routable domain name internally (joe@contoso.usa) and a legal one in hello cloud.</span></span>
* <span data-ttu-id="838e1-175">Nepoužívejte názvy domén interně (Jan)</span><span class="sxs-lookup"><span data-stu-id="838e1-175">Do not use domain names internally (joe)</span></span>
* <span data-ttu-id="838e1-176">Použít různé aliasy místní a v cloudu hello.</span><span class="sxs-lookup"><span data-stu-id="838e1-176">Use different aliases on-prem and in hello cloud.</span></span> <span data-ttu-id="838e1-177">Například joe-johns@contoso.com vs.joej@contoso.com</span><span class="sxs-lookup"><span data-stu-id="838e1-177">For example, joe-johns@contoso.com vs. joej@contoso.com</span></span>  

<span data-ttu-id="838e1-178">Pomocí Proxy aplikace můžete vybrat které identity toouse tooobtain hello lístek protokolu Kerberos.</span><span class="sxs-lookup"><span data-stu-id="838e1-178">With Application Proxy, you can select which identity toouse tooobtain hello Kerberos ticket.</span></span> <span data-ttu-id="838e1-179">Toto nastavení je na aplikaci.</span><span class="sxs-lookup"><span data-stu-id="838e1-179">This setting is per application.</span></span> <span data-ttu-id="838e1-180">Některé z těchto možností jsou vhodné pro systémy, které nepřijímá formát e-mailové adresy, jiné jsou navržené pro alternativní přihlášení.</span><span class="sxs-lookup"><span data-stu-id="838e1-180">Some of these options are suitable for systems that do not accept email address format, others are designed for alternative login.</span></span>

![Snímek obrazovky parametr identity delegované přihlášení](./media/active-directory-application-proxy-sso-using-kcd/app_proxy_sso_diff_id_upn.png)

<span data-ttu-id="838e1-182">Pokud se používá k přihlášení delegované identity, nemusí být hodnota hello jedinečný mezi všechny hello doménami nebo doménovými strukturami ve vaší organizaci.</span><span class="sxs-lookup"><span data-stu-id="838e1-182">If delegated login identity is used, hello value might not be unique across all hello domains or forests in your organization.</span></span> <span data-ttu-id="838e1-183">Tento problém se můžete vyhnout tím, že publikujete tyto aplikace dvakrát pomocí dvou různých skupin konektor.</span><span class="sxs-lookup"><span data-stu-id="838e1-183">You can avoid this issue by publishing these applications twice using two different Connector groups.</span></span> <span data-ttu-id="838e1-184">Vzhledem k tomu, že každá aplikace má cílovou skupinu jiného uživatele, můžete připojit k jeho konektory tooa jinou doménu.</span><span class="sxs-lookup"><span data-stu-id="838e1-184">Since each application has a different user audience, you can join its Connectors tooa different domain.</span></span>

### <a name="configure-sso-for-different-identities"></a><span data-ttu-id="838e1-185">Konfigurovat jednotné přihlašování pro různé identity</span><span class="sxs-lookup"><span data-stu-id="838e1-185">Configure SSO for different identities</span></span>
1. <span data-ttu-id="838e1-186">Konfigurace nastavení Azure AD Connect, tak, aby hlavní identita hello hello e-mailovou adresu (e-mailu).</span><span class="sxs-lookup"><span data-stu-id="838e1-186">Configure Azure AD Connect settings so hello main identity is hello email address (mail).</span></span> <span data-ttu-id="838e1-187">To slouží jako součást hello přizpůsobení procesu, změna hello **hlavní název uživatele** pole v nastavení synchronizace hello.</span><span class="sxs-lookup"><span data-stu-id="838e1-187">This is done as part of hello customize process, by changing hello **User Principal Name** field in hello sync settings.</span></span> <span data-ttu-id="838e1-188">Tato nastavení taky určit, jak uživatelé přihlašovat tooOffice365, Windows10 zařízení a jiných aplikací, které používají Azure AD jako své úložiště identit.</span><span class="sxs-lookup"><span data-stu-id="838e1-188">These settings also determine how users log in tooOffice365, Windows10 devices, and other applications that use Azure AD as their identity store.</span></span>  
   <span data-ttu-id="838e1-189">![Identifikace uživatelů – snímek obrazovky - rozevírací hlavní název uživatele](./media/active-directory-application-proxy-sso-using-kcd/app_proxy_sso_diff_id_connect_settings.png)</span><span class="sxs-lookup"><span data-stu-id="838e1-189">![Identifying users screenshot - User Principal Name dropdown](./media/active-directory-application-proxy-sso-using-kcd/app_proxy_sso_diff_id_connect_settings.png)</span></span>  
2. <span data-ttu-id="838e1-190">V nastavení konfigurace aplikace hello aplikace hello byste chtěli toomodify, vyberte hello **delegované Identity přihlášení** toobe použít:</span><span class="sxs-lookup"><span data-stu-id="838e1-190">In hello Application Configuration settings for hello application you would like toomodify, select hello **Delegated Login Identity** toobe used:</span></span>

   * <span data-ttu-id="838e1-191">Hlavní název uživatele (například joe@contoso.com)</span><span class="sxs-lookup"><span data-stu-id="838e1-191">User Principal Name (for example, joe@contoso.com)</span></span>
   * <span data-ttu-id="838e1-192">Alternativní hlavní název uživatele (například joed@contoso.local)</span><span class="sxs-lookup"><span data-stu-id="838e1-192">Alternate User Principal Name (for example, joed@contoso.local)</span></span>
   * <span data-ttu-id="838e1-193">Uživatelské jméno součástí hlavní název uživatele (například Jan)</span><span class="sxs-lookup"><span data-stu-id="838e1-193">Username part of User Principal Name (for example, joe)</span></span>
   * <span data-ttu-id="838e1-194">Uživatelské jméno součástí alternativní hlavní název uživatele (například joed)</span><span class="sxs-lookup"><span data-stu-id="838e1-194">Username part of Alternate User Principal Name (for example, joed)</span></span>
   * <span data-ttu-id="838e1-195">Název účtu SAM místní (závisí na konfiguraci řadiče domény hello)</span><span class="sxs-lookup"><span data-stu-id="838e1-195">On-premises SAM account name (depends on hello domain controller configuration)</span></span>

### <a name="troubleshooting-sso-for-different-identities"></a><span data-ttu-id="838e1-196">Řešení potíží s jednotného přihlašování pro různé identity</span><span class="sxs-lookup"><span data-stu-id="838e1-196">Troubleshooting SSO for different identities</span></span>
<span data-ttu-id="838e1-197">Pokud dojde k chybě v hello proces jednotné přihlašování, zobrazí se v protokolu událostí počítače hello konektor jak je popsáno v [Poradce při potížích s](application-proxy-back-end-kerberos-constrained-delegation-how-to.md).</span><span class="sxs-lookup"><span data-stu-id="838e1-197">If there is an error in hello SSO process, it appears in hello connector machine event log as explained in [Troubleshooting](application-proxy-back-end-kerberos-constrained-delegation-how-to.md).</span></span>
<span data-ttu-id="838e1-198">Ale v některých případech hello je požadavek úspěšně odeslán toohello back-end aplikace během této aplikace reaguje v různých dalších odpovědi HTTP.</span><span class="sxs-lookup"><span data-stu-id="838e1-198">But, in some cases, hello request is successfully sent toohello backend application while this application replies in various other HTTP responses.</span></span> <span data-ttu-id="838e1-199">Řešení potíží s těchto případech by se měl spustit tak, že prověří číslo události 24029 na počítači konektor hello v protokolu událostí relaci Proxy aplikace hello.</span><span class="sxs-lookup"><span data-stu-id="838e1-199">Troubleshooting these cases should start by examining event number 24029 on hello connector machine in hello Application Proxy session event log.</span></span> <span data-ttu-id="838e1-200">v poli "user" hello v rámci hello podrobnosti události se zobrazí Hello identitu uživatele, která byla použita pro delegování.</span><span class="sxs-lookup"><span data-stu-id="838e1-200">hello user identity that was used for delegation appears in hello “user” field within hello event details.</span></span> <span data-ttu-id="838e1-201">Vyberte tooturn v relaci protokolu **ukazují analytické a ladicí protokoly** v nabídce Zobrazit prohlížeč událostí hello.</span><span class="sxs-lookup"><span data-stu-id="838e1-201">tooturn on session log, select **Show analytic and debug logs** in hello event viewer view menu.</span></span>

## <a name="next-steps"></a><span data-ttu-id="838e1-202">Další kroky</span><span class="sxs-lookup"><span data-stu-id="838e1-202">Next steps</span></span>

* [<span data-ttu-id="838e1-203">Jak tooconfigure toouse aplikace Proxy aplikace omezené delegování Kerberos</span><span class="sxs-lookup"><span data-stu-id="838e1-203">How tooconfigure an Application Proxy application toouse Kerberos Constrained Delegation</span></span>](application-proxy-back-end-kerberos-constrained-delegation-how-to.md)
* [<span data-ttu-id="838e1-204">Řešení problémů, které máte s pomocí Proxy aplikace</span><span class="sxs-lookup"><span data-stu-id="838e1-204">Troubleshoot issues you're having with Application Proxy</span></span>](active-directory-application-proxy-troubleshoot.md)


<span data-ttu-id="838e1-205">Hello nejnovější novinky a aktualizace, najdete na naší hello [blogu Proxy aplikace](http://blogs.technet.com/b/applicationproxyblog/)</span><span class="sxs-lookup"><span data-stu-id="838e1-205">For hello latest news and updates, check out hello [Application Proxy blog](http://blogs.technet.com/b/applicationproxyblog/)</span></span>

