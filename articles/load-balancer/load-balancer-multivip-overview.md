---
title: "aaaMultiple VIP pro vyrovnávání zatížení Azure | Microsoft Docs"
description: "Přehled několika virtuálními IP adresami v nástroji pro vyrovnávání zatížení Azure"
services: load-balancer
documentationcenter: na
author: chkuhtz
manager: narayan
editor: 
ms.assetid: 748e50cd-3087-4c2e-a9e1-ac0ecce4f869
ms.service: load-balancer
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 08/11/2016
ms.author: chkuhtz
ms.openlocfilehash: e186e1248e7d187e7efd0668dc3244465ce3e156
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="multiple-vips-for-azure-load-balancer"></a><span data-ttu-id="9f995-103">Více virtuálních IP adres pro Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="9f995-103">Multiple VIPs for Azure Load Balancer</span></span>

<span data-ttu-id="9f995-104">Azure nástroj pro vyrovnávání zatížení můžete tooload vyrovnat služby na více porty, více IP adres nebo obojí.</span><span class="sxs-lookup"><span data-stu-id="9f995-104">Azure Load Balancer allows you tooload balance services on multiple ports, multiple IP addresses, or both.</span></span> <span data-ttu-id="9f995-105">Můžete vytvořit veřejné a interní zatížení vyrovnávání definice tooload vyrovnávání toků mezi sadu virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="9f995-105">You can use public and internal load balancer definitions tooload balance flows across a set of VMs.</span></span>

<span data-ttu-id="9f995-106">Tento článek popisuje hello základy tuto možnost, důležité koncepty a omezení.</span><span class="sxs-lookup"><span data-stu-id="9f995-106">This article describes hello fundamentals of this ability, important concepts, and constraints.</span></span> <span data-ttu-id="9f995-107">Pokud hodláte tooexpose služby pouze na jednu IP adresu, můžete najít zjednodušené pokyny pro [veřejné](load-balancer-get-started-internet-portal.md) nebo [interní](load-balancer-get-started-ilb-arm-portal.md) konfigurací služby Vyrovnávání zatížení.</span><span class="sxs-lookup"><span data-stu-id="9f995-107">If you only intend tooexpose services on one IP address, you can find simplified instructions for [public](load-balancer-get-started-internet-portal.md) or [internal](load-balancer-get-started-ilb-arm-portal.md) load balancer configurations.</span></span> <span data-ttu-id="9f995-108">Přidání několika virtuálními IP adresami je přírůstkové tooa jednu VIP konfigurace.</span><span class="sxs-lookup"><span data-stu-id="9f995-108">Adding Multiple VIPs is incremental tooa single VIP configuration.</span></span> <span data-ttu-id="9f995-109">Pomocí hello koncepty v tomto článku, můžete rozbalit zjednodušená konfigurace kdykoli.</span><span class="sxs-lookup"><span data-stu-id="9f995-109">Using hello concepts in this article, you can expand a simplified configuration at any time.</span></span>

<span data-ttu-id="9f995-110">Když definujete k pro vyrovnávání zatížení Azure, front-end a back-end konfigurace jsou připojené pomocí pravidel.</span><span class="sxs-lookup"><span data-stu-id="9f995-110">When you define an Azure Load Balancer, a frontend and a backend configuration are connected with rules.</span></span> <span data-ttu-id="9f995-111">Hello test stavu odkazuje hello pravidlo je použité toodetermine jak nové toky jsou odesílány tooa uzlu ve fondu back-end hello.</span><span class="sxs-lookup"><span data-stu-id="9f995-111">hello health probe referenced by hello rule is used toodetermine how new flows are sent tooa node in hello backend pool.</span></span> <span data-ttu-id="9f995-112">front-endu Hello je definována pomocí virtuální IP (VIP), což je 3 řazené kolekce členů skládá z adresy IP (veřejné nebo interní), přenosový protokol (UDP nebo TCP) a číslo portu.</span><span class="sxs-lookup"><span data-stu-id="9f995-112">hello frontend is defined by a Virtual IP (VIP), which is a 3-tuple comprised of an IP address (public or internal), a transport protocol (UDP or TCP), and a port number.</span></span> <span data-ttu-id="9f995-113">Vyhrazené IP adresy je, že IP adresu na Azure virtuálního síťového adaptéru připojený tooa virtuálního počítače ve fondu back-end hello.</span><span class="sxs-lookup"><span data-stu-id="9f995-113">A DIP is an IP address on an Azure virtual NIC attached tooa VM in hello backend pool.</span></span>

<span data-ttu-id="9f995-114">Hello následující tabulka obsahuje některé příklady front-endové konfigurace:</span><span class="sxs-lookup"><span data-stu-id="9f995-114">hello following table contains some example frontend configurations:</span></span>

| <span data-ttu-id="9f995-115">VIRTUÁLNÍ ADRESA IP.</span><span class="sxs-lookup"><span data-stu-id="9f995-115">VIP</span></span> | <span data-ttu-id="9f995-116">IP adresa</span><span class="sxs-lookup"><span data-stu-id="9f995-116">IP address</span></span> | <span data-ttu-id="9f995-117">Protokol</span><span class="sxs-lookup"><span data-stu-id="9f995-117">protocol</span></span> | <span data-ttu-id="9f995-118">port</span><span class="sxs-lookup"><span data-stu-id="9f995-118">port</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="9f995-119">1</span><span class="sxs-lookup"><span data-stu-id="9f995-119">1</span></span> |<span data-ttu-id="9f995-120">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="9f995-120">65.52.0.1</span></span> |<span data-ttu-id="9f995-121">TCP</span><span class="sxs-lookup"><span data-stu-id="9f995-121">TCP</span></span> |<span data-ttu-id="9f995-122">80</span><span class="sxs-lookup"><span data-stu-id="9f995-122">80</span></span> |
| <span data-ttu-id="9f995-123">2</span><span class="sxs-lookup"><span data-stu-id="9f995-123">2</span></span> |<span data-ttu-id="9f995-124">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="9f995-124">65.52.0.1</span></span> |<span data-ttu-id="9f995-125">TCP</span><span class="sxs-lookup"><span data-stu-id="9f995-125">TCP</span></span> |<span data-ttu-id="9f995-126">*8080*</span><span class="sxs-lookup"><span data-stu-id="9f995-126">*8080*</span></span> |
| <span data-ttu-id="9f995-127">3</span><span class="sxs-lookup"><span data-stu-id="9f995-127">3</span></span> |<span data-ttu-id="9f995-128">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="9f995-128">65.52.0.1</span></span> |<span data-ttu-id="9f995-129">*UDP*</span><span class="sxs-lookup"><span data-stu-id="9f995-129">*UDP*</span></span> |<span data-ttu-id="9f995-130">80</span><span class="sxs-lookup"><span data-stu-id="9f995-130">80</span></span> |
| <span data-ttu-id="9f995-131">4</span><span class="sxs-lookup"><span data-stu-id="9f995-131">4</span></span> |<span data-ttu-id="9f995-132">*65.52.0.2*</span><span class="sxs-lookup"><span data-stu-id="9f995-132">*65.52.0.2*</span></span> |<span data-ttu-id="9f995-133">TCP</span><span class="sxs-lookup"><span data-stu-id="9f995-133">TCP</span></span> |<span data-ttu-id="9f995-134">80</span><span class="sxs-lookup"><span data-stu-id="9f995-134">80</span></span> |

<span data-ttu-id="9f995-135">Hello tabulka obsahuje čtyři různé frontends.</span><span class="sxs-lookup"><span data-stu-id="9f995-135">hello table shows four different frontends.</span></span> <span data-ttu-id="9f995-136">Frontends č. 1, #2 a #3 jsou jedné virtuální IP adresy s více pravidel.</span><span class="sxs-lookup"><span data-stu-id="9f995-136">Frontends #1, #2 and #3 are a single VIP with multiple rules.</span></span> <span data-ttu-id="9f995-137">Hello stejnou IP adresu se používá ale hello portu nebo protokolu se liší pro každý front-endu.</span><span class="sxs-lookup"><span data-stu-id="9f995-137">hello same IP address is used but hello port or protocol is different for each frontend.</span></span> <span data-ttu-id="9f995-138">Frontends č. 1 a #4 jsou příklad několika virtuálními IP adresami, kde hello stejný front-endu protokol a port se opětovně použít napříč několika virtuálními IP adresami.</span><span class="sxs-lookup"><span data-stu-id="9f995-138">Frontends #1 and #4 are an example of Multiple VIPs, where hello same frontend protocol and port are reused across multiple VIPs.</span></span>

<span data-ttu-id="9f995-139">Azure Vyrovnávání zatížení poskytuje flexibilitu při definování pravidel Vyrovnávání zatížení hello.</span><span class="sxs-lookup"><span data-stu-id="9f995-139">Azure Load Balancer provides flexibility in defining hello load balancing rules.</span></span> <span data-ttu-id="9f995-140">Pravidlo deklaruje, jak adresu a port na front-endu hello je namapované toohello cílovou adresu a port na back-end hello.</span><span class="sxs-lookup"><span data-stu-id="9f995-140">A rule declares how an address and port on hello frontend is mapped toohello destination address and port on hello backend.</span></span> <span data-ttu-id="9f995-141">Zda jsou porty back-end opětovně použít napříč pravidla závisí na typu hello hello pravidla.</span><span class="sxs-lookup"><span data-stu-id="9f995-141">Whether or not backend ports are reused across rules depends on hello type of hello rule.</span></span> <span data-ttu-id="9f995-142">Každý typ pravidla má specifické požadavky, které můžou ovlivnit návrh a konfigurace testu hostitele.</span><span class="sxs-lookup"><span data-stu-id="9f995-142">Each type of rule has specific requirements that can affect host configuration and probe design.</span></span> <span data-ttu-id="9f995-143">Existují dva typy pravidel:</span><span class="sxs-lookup"><span data-stu-id="9f995-143">There are two types of rules:</span></span>

1. <span data-ttu-id="9f995-144">znovu použít výchozí pravidlo Hello s žádné back-endový port</span><span class="sxs-lookup"><span data-stu-id="9f995-144">hello default rule with no backend port reuse</span></span>
2. <span data-ttu-id="9f995-145">pravidlo Hello plovoucí IP adresa, kde jsou opakovaně porty back-end</span><span class="sxs-lookup"><span data-stu-id="9f995-145">hello Floating IP rule where backend ports are reused</span></span>

<span data-ttu-id="9f995-146">Azure Vyrovnávání zatížení můžete toomix oba typy pravidel na hello stejné konfigurace služby Vyrovnávání zatížení.</span><span class="sxs-lookup"><span data-stu-id="9f995-146">Azure Load Balancer allows you toomix both rule types on hello same load balancer configuration.</span></span> <span data-ttu-id="9f995-147">Nástroj pro vyrovnávání zatížení Hello můžete je používat současně pro daný virtuální počítač nebo libovolnou kombinaci tak dlouho, dokud dodržovat hello omezení hello pravidla.</span><span class="sxs-lookup"><span data-stu-id="9f995-147">hello load balancer can use them simultaneously for a given VM, or any combination, as long as you abide by hello constraints of hello rule.</span></span> <span data-ttu-id="9f995-148">Jaký typ pravidla můžete zvolit, závisí na hello požadavky vaší aplikace a hello složitosti podpora této konfigurace.</span><span class="sxs-lookup"><span data-stu-id="9f995-148">Which rule type you choose depends on hello requirements of your application and hello complexity of supporting that configuration.</span></span> <span data-ttu-id="9f995-149">Byste měli zvážit typů pravidlo, které jsou vhodné pro váš scénář.</span><span class="sxs-lookup"><span data-stu-id="9f995-149">You should evaluate which rule types are best for your scenario.</span></span>

<span data-ttu-id="9f995-150">Nám prozkoumat tyto další scénáře od hello výchozí chování.</span><span class="sxs-lookup"><span data-stu-id="9f995-150">We explore these scenarios further by starting with hello default behavior.</span></span>

## <a name="rule-type-1-no-backend-port-reuse"></a><span data-ttu-id="9f995-151">Pravidlo typu #1: žádné opakované použití portu back-end</span><span class="sxs-lookup"><span data-stu-id="9f995-151">Rule type #1: No backend port reuse</span></span>

![Obrázek víc virtuálními IP adresami](./media/load-balancer-multivip-overview/load-balancer-multivip.png)

<span data-ttu-id="9f995-153">V tomto scénáři jsou hello front-endu VIP nakonfigurovány takto:</span><span class="sxs-lookup"><span data-stu-id="9f995-153">In this scenario, hello frontend VIPs are configured as follows:</span></span>

| <span data-ttu-id="9f995-154">VIRTUÁLNÍ ADRESA IP.</span><span class="sxs-lookup"><span data-stu-id="9f995-154">VIP</span></span> | <span data-ttu-id="9f995-155">IP adresa</span><span class="sxs-lookup"><span data-stu-id="9f995-155">IP address</span></span> | <span data-ttu-id="9f995-156">Protokol</span><span class="sxs-lookup"><span data-stu-id="9f995-156">protocol</span></span> | <span data-ttu-id="9f995-157">port</span><span class="sxs-lookup"><span data-stu-id="9f995-157">port</span></span> |
| --- | --- | --- | --- |
| ![VIRTUÁLNÍ ADRESA IP.](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="9f995-159">1</span><span class="sxs-lookup"><span data-stu-id="9f995-159">1</span></span> |<span data-ttu-id="9f995-160">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="9f995-160">65.52.0.1</span></span> |<span data-ttu-id="9f995-161">TCP</span><span class="sxs-lookup"><span data-stu-id="9f995-161">TCP</span></span> |<span data-ttu-id="9f995-162">80</span><span class="sxs-lookup"><span data-stu-id="9f995-162">80</span></span> |
| ![VIRTUÁLNÍ ADRESA IP.](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="9f995-164">2</span><span class="sxs-lookup"><span data-stu-id="9f995-164">2</span></span> |<span data-ttu-id="9f995-165">*65.52.0.2*</span><span class="sxs-lookup"><span data-stu-id="9f995-165">*65.52.0.2*</span></span> |<span data-ttu-id="9f995-166">TCP</span><span class="sxs-lookup"><span data-stu-id="9f995-166">TCP</span></span> |<span data-ttu-id="9f995-167">80</span><span class="sxs-lookup"><span data-stu-id="9f995-167">80</span></span> |

<span data-ttu-id="9f995-168">Hello vyhrazené IP adresy je cílem hello hello příchozí tok.</span><span class="sxs-lookup"><span data-stu-id="9f995-168">hello DIP is hello destination of hello inbound flow.</span></span> <span data-ttu-id="9f995-169">Ve fondu back-end hello každý virtuální počítač zpřístupňuje hello potřeby službu na jedinečný port vyhrazené IP adresy.</span><span class="sxs-lookup"><span data-stu-id="9f995-169">In hello backend pool, each VM exposes hello desired service on a unique port on a DIP.</span></span> <span data-ttu-id="9f995-170">Tato služba je spojeno s front-endu hello prostřednictvím definice pravidla.</span><span class="sxs-lookup"><span data-stu-id="9f995-170">This service is associated with hello frontend through a rule definition.</span></span>

<span data-ttu-id="9f995-171">Jsme definovali dvě pravidla:</span><span class="sxs-lookup"><span data-stu-id="9f995-171">We define two rules:</span></span>

| <span data-ttu-id="9f995-172">Pravidlo</span><span class="sxs-lookup"><span data-stu-id="9f995-172">Rule</span></span> | <span data-ttu-id="9f995-173">Mapování front-endu</span><span class="sxs-lookup"><span data-stu-id="9f995-173">Map frontend</span></span> | <span data-ttu-id="9f995-174">toobackend fondu</span><span class="sxs-lookup"><span data-stu-id="9f995-174">toobackend pool</span></span> |
| --- | --- | --- |
| <span data-ttu-id="9f995-175">1</span><span class="sxs-lookup"><span data-stu-id="9f995-175">1</span></span> |![VIRTUÁLNÍ ADRESA IP.](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="9f995-177">VIP1:80</span><span class="sxs-lookup"><span data-stu-id="9f995-177">VIP1:80</span></span> |![back-end](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="9f995-179">DIP1:80,</span><span class="sxs-lookup"><span data-stu-id="9f995-179">DIP1:80,</span></span> ![back-end](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="9f995-181">DIP2:80</span><span class="sxs-lookup"><span data-stu-id="9f995-181">DIP2:80</span></span> |
| <span data-ttu-id="9f995-182">2</span><span class="sxs-lookup"><span data-stu-id="9f995-182">2</span></span> |![VIRTUÁLNÍ ADRESA IP.](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="9f995-184">VIP2:80</span><span class="sxs-lookup"><span data-stu-id="9f995-184">VIP2:80</span></span> |![back-end](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="9f995-186">DIP1:81,</span><span class="sxs-lookup"><span data-stu-id="9f995-186">DIP1:81,</span></span> ![back-end](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="9f995-188">DIP2:81</span><span class="sxs-lookup"><span data-stu-id="9f995-188">DIP2:81</span></span> |

<span data-ttu-id="9f995-189">dokončení mapování Hello nástroji pro vyrovnávání zatížení Azure je teď následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="9f995-189">hello complete mapping in Azure Load Balancer is now as follows:</span></span>

| <span data-ttu-id="9f995-190">Pravidlo</span><span class="sxs-lookup"><span data-stu-id="9f995-190">Rule</span></span> | <span data-ttu-id="9f995-191">Virtuální IP adresy IP adresu</span><span class="sxs-lookup"><span data-stu-id="9f995-191">VIP IP address</span></span> | <span data-ttu-id="9f995-192">Protokol</span><span class="sxs-lookup"><span data-stu-id="9f995-192">protocol</span></span> | <span data-ttu-id="9f995-193">port</span><span class="sxs-lookup"><span data-stu-id="9f995-193">port</span></span> | <span data-ttu-id="9f995-194">Cíl</span><span class="sxs-lookup"><span data-stu-id="9f995-194">Destination</span></span> | <span data-ttu-id="9f995-195">port</span><span class="sxs-lookup"><span data-stu-id="9f995-195">port</span></span> |
| --- | --- | --- | --- | --- | --- |
| ![Pravidlo](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="9f995-197">1</span><span class="sxs-lookup"><span data-stu-id="9f995-197">1</span></span> |<span data-ttu-id="9f995-198">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="9f995-198">65.52.0.1</span></span> |<span data-ttu-id="9f995-199">TCP</span><span class="sxs-lookup"><span data-stu-id="9f995-199">TCP</span></span> |<span data-ttu-id="9f995-200">80</span><span class="sxs-lookup"><span data-stu-id="9f995-200">80</span></span> |<span data-ttu-id="9f995-201">Vyhrazené IP adresy IP adresu</span><span class="sxs-lookup"><span data-stu-id="9f995-201">DIP IP Address</span></span> |<span data-ttu-id="9f995-202">80</span><span class="sxs-lookup"><span data-stu-id="9f995-202">80</span></span> |
| ![Pravidlo](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="9f995-204">2</span><span class="sxs-lookup"><span data-stu-id="9f995-204">2</span></span> |<span data-ttu-id="9f995-205">65.52.0.2</span><span class="sxs-lookup"><span data-stu-id="9f995-205">65.52.0.2</span></span> |<span data-ttu-id="9f995-206">TCP</span><span class="sxs-lookup"><span data-stu-id="9f995-206">TCP</span></span> |<span data-ttu-id="9f995-207">80</span><span class="sxs-lookup"><span data-stu-id="9f995-207">80</span></span> |<span data-ttu-id="9f995-208">Vyhrazené IP adresy IP adresu</span><span class="sxs-lookup"><span data-stu-id="9f995-208">DIP IP Address</span></span> |<span data-ttu-id="9f995-209">81</span><span class="sxs-lookup"><span data-stu-id="9f995-209">81</span></span> |

<span data-ttu-id="9f995-210">Každé pravidlo musí vytvořit toku s jedinečnou kombinaci cílové IP adresy a cílového portu.</span><span class="sxs-lookup"><span data-stu-id="9f995-210">Each rule must produce a flow with a unique combination of destination IP address and destination port.</span></span> <span data-ttu-id="9f995-211">Podle různých cílový port hello hello toku můžete více pravidel poskytovat toky toohello stejné vyhrazené IP adresy na jiné porty.</span><span class="sxs-lookup"><span data-stu-id="9f995-211">By varying hello destination port of hello flow, multiple rules can deliver flows toohello same DIP on different ports.</span></span>

<span data-ttu-id="9f995-212">Sondy stavu jsou vždy směrovanou toohello vyhrazené IP adresy virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="9f995-212">Health probes are always directed toohello DIP of a VM.</span></span> <span data-ttu-id="9f995-213">Musíte si zajistěte, aby vaše testu odráží stav hello hello virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="9f995-213">You must ensure you that your probe reflects hello health of hello VM.</span></span>

## <a name="rule-type-2-backend-port-reuse-by-using-floating-ip"></a><span data-ttu-id="9f995-214">Pravidlo typu #2: opakované použití portu back-end pomocí plovoucí IP adresa</span><span class="sxs-lookup"><span data-stu-id="9f995-214">Rule type #2: backend port reuse by using Floating IP</span></span>

<span data-ttu-id="9f995-215">Azure nástroj pro vyrovnávání zatížení poskytuje flexibilitu hello tooreuse hello front-endový port mezi několika virtuálními IP adresami bez ohledu na typ pravidla hello používá.</span><span class="sxs-lookup"><span data-stu-id="9f995-215">Azure Load Balancer provides hello flexibility tooreuse hello frontend port across multiple VIPs regardless of hello rule type used.</span></span> <span data-ttu-id="9f995-216">Kromě toho některé aplikace scénáře přednost nebo vyžadovat hello stejný port toobe používá více instancí aplikace na jeden virtuální počítač ve fondu back-end hello.</span><span class="sxs-lookup"><span data-stu-id="9f995-216">Additionally, some application scenarios prefer or require hello same port toobe used by multiple application instances on a single VM in hello backend pool.</span></span> <span data-ttu-id="9f995-217">Běžných příkladů opakované použití portu obsahovat clustering pro vysokou dostupnost, sítě, virtuální zařízení a vystavení několik koncových bodů protokolu TLS bez znova šifrovat.</span><span class="sxs-lookup"><span data-stu-id="9f995-217">Common examples of port reuse include clustering for high availability, network virtual appliances, and exposing multiple TLS endpoints without re-encryption.</span></span>

<span data-ttu-id="9f995-218">Pokud chcete tooreuse hello back-endový port napříč více pravidel, je nutné povolit plovoucí IP adresa v hello Definice pravidla.</span><span class="sxs-lookup"><span data-stu-id="9f995-218">If you want tooreuse hello backend port across multiple rules, you must enable Floating IP in hello rule definition.</span></span>

<span data-ttu-id="9f995-219">Plovoucí IP adresa je část, která se označuje jako přímý Server vrátit (DSR).</span><span class="sxs-lookup"><span data-stu-id="9f995-219">Floating IP is a portion of what is known as Direct Server Return (DSR).</span></span> <span data-ttu-id="9f995-220">DSR se skládá ze dvou částí: topologii toku a IP adres schéma mapování.</span><span class="sxs-lookup"><span data-stu-id="9f995-220">DSR consists of two parts: a flow topology and an IP address mapping scheme.</span></span> <span data-ttu-id="9f995-221">Na úrovni platformy nástroj pro vyrovnávání zatížení Azure vždy funguje v topologii DSR toku bez ohledu na to, jestli je zapnutá plovoucí IP adresa, nebo ne.</span><span class="sxs-lookup"><span data-stu-id="9f995-221">At a platform level, Azure Load Balancer always operates in a DSR flow topology regardless of whether Floating IP is enabled or not.</span></span> <span data-ttu-id="9f995-222">Znamená, že hello odchozí součástí tokem je vždy správně přepsaná tooflow přímo back toohello původu.</span><span class="sxs-lookup"><span data-stu-id="9f995-222">This means that hello outbound part of a flow is always correctly rewritten tooflow directly back toohello origin.</span></span>

<span data-ttu-id="9f995-223">S hello výchozí pravidlo typ zpřístupní Azure tradiční schéma mapování IP adres pro snadné použití vyrovnávání zatížení.</span><span class="sxs-lookup"><span data-stu-id="9f995-223">With hello default rule type, Azure exposes a traditional load balancing IP address mapping scheme for ease of use.</span></span> <span data-ttu-id="9f995-224">Povolení plovoucí IP adresa změní tooallow schéma mapování IP adres hello za účelem vyšší flexibility, jak je vysvětleno níže.</span><span class="sxs-lookup"><span data-stu-id="9f995-224">Enabling Floating IP changes hello IP address mapping scheme tooallow for additional flexibility as explained below.</span></span>

<span data-ttu-id="9f995-225">Hello následující diagram znázorňuje tuto konfiguraci:</span><span class="sxs-lookup"><span data-stu-id="9f995-225">hello following diagram illustrates this configuration:</span></span>

![Obrázek víc virtuálními IP adresami](./media/load-balancer-multivip-overview/load-balancer-multivip-dsr.png)

<span data-ttu-id="9f995-227">V tomto scénáři má každý virtuální počítač ve fondu back-end hello tři síťových rozhraní:</span><span class="sxs-lookup"><span data-stu-id="9f995-227">For this scenario, every VM in hello backend pool has three network interfaces:</span></span>

* <span data-ttu-id="9f995-228">Vyhrazené IP adresy: virtuální síťový adaptér přidružený hello virtuálního počítače (IP konfigurace Síťových prostředků Azure)</span><span class="sxs-lookup"><span data-stu-id="9f995-228">DIP: a Virtual NIC associated with hello VM (IP configuration of Azure's NIC resource)</span></span>
* <span data-ttu-id="9f995-229">VIP1: rozhraní zpětné smyčky v rámci hostovaného operačního systému, který je nakonfigurovaný s IP adresou VIP1</span><span class="sxs-lookup"><span data-stu-id="9f995-229">VIP1: a loopback interface within guest OS that is configured with IP address of VIP1</span></span>
* <span data-ttu-id="9f995-230">VIP2: rozhraní zpětné smyčky v rámci hostovaného operačního systému, který je nakonfigurovaný s IP adresou VIP2</span><span class="sxs-lookup"><span data-stu-id="9f995-230">VIP2: a loopback interface within guest OS that is configured with IP address of VIP2</span></span>

> [!IMPORTANT]
> <span data-ttu-id="9f995-231">Konfigurace Hello hello logické rozhraní se provádí v rámci hello hostovaný operační systém.</span><span class="sxs-lookup"><span data-stu-id="9f995-231">hello configuration of hello logical interfaces is performed within hello guest OS.</span></span> <span data-ttu-id="9f995-232">Tato konfigurace není provést nebo spravované přes Azure.</span><span class="sxs-lookup"><span data-stu-id="9f995-232">This configuration is not performed or managed by Azure.</span></span> <span data-ttu-id="9f995-233">Bez této konfiguraci nebude fungovat hello pravidla.</span><span class="sxs-lookup"><span data-stu-id="9f995-233">Without this configuration, hello rules will not function.</span></span> <span data-ttu-id="9f995-234">Stav testu definice použít hello DIP hello virtuálních počítačů nemusí hello logické VIP.</span><span class="sxs-lookup"><span data-stu-id="9f995-234">Health probe definitions use hello DIP of hello VM rather than hello logical VIP.</span></span> <span data-ttu-id="9f995-235">Proto služby, musíte zadat odpovědi testu portu vyhrazené IP adresy, které odpovídala hello stav služby hello nabízí v logické VIP hello.</span><span class="sxs-lookup"><span data-stu-id="9f995-235">Therefore, your service must provide probe responses on a DIP port that reflect hello status of hello service offered on hello logical VIP.</span></span>

<span data-ttu-id="9f995-236">Předpokládejme hello stejný front-endovou konfiguraci jako v předchozím scénáři hello:</span><span class="sxs-lookup"><span data-stu-id="9f995-236">Let's assume hello same frontend configuration as in hello previous scenario:</span></span>

| <span data-ttu-id="9f995-237">VIRTUÁLNÍ ADRESA IP.</span><span class="sxs-lookup"><span data-stu-id="9f995-237">VIP</span></span> | <span data-ttu-id="9f995-238">IP adresa</span><span class="sxs-lookup"><span data-stu-id="9f995-238">IP address</span></span> | <span data-ttu-id="9f995-239">Protokol</span><span class="sxs-lookup"><span data-stu-id="9f995-239">protocol</span></span> | <span data-ttu-id="9f995-240">port</span><span class="sxs-lookup"><span data-stu-id="9f995-240">port</span></span> |
| --- | --- | --- | --- |
| ![VIRTUÁLNÍ ADRESA IP.](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="9f995-242">1</span><span class="sxs-lookup"><span data-stu-id="9f995-242">1</span></span> |<span data-ttu-id="9f995-243">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="9f995-243">65.52.0.1</span></span> |<span data-ttu-id="9f995-244">TCP</span><span class="sxs-lookup"><span data-stu-id="9f995-244">TCP</span></span> |<span data-ttu-id="9f995-245">80</span><span class="sxs-lookup"><span data-stu-id="9f995-245">80</span></span> |
| ![VIRTUÁLNÍ ADRESA IP.](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="9f995-247">2</span><span class="sxs-lookup"><span data-stu-id="9f995-247">2</span></span> |<span data-ttu-id="9f995-248">*65.52.0.2*</span><span class="sxs-lookup"><span data-stu-id="9f995-248">*65.52.0.2*</span></span> |<span data-ttu-id="9f995-249">TCP</span><span class="sxs-lookup"><span data-stu-id="9f995-249">TCP</span></span> |<span data-ttu-id="9f995-250">80</span><span class="sxs-lookup"><span data-stu-id="9f995-250">80</span></span> |

<span data-ttu-id="9f995-251">Jsme definovali dvě pravidla:</span><span class="sxs-lookup"><span data-stu-id="9f995-251">We define two rules:</span></span>

| <span data-ttu-id="9f995-252">Pravidlo</span><span class="sxs-lookup"><span data-stu-id="9f995-252">Rule</span></span> | <span data-ttu-id="9f995-253">Mapování front-endu</span><span class="sxs-lookup"><span data-stu-id="9f995-253">Map frontend</span></span> | <span data-ttu-id="9f995-254">toobackend fondu</span><span class="sxs-lookup"><span data-stu-id="9f995-254">toobackend pool</span></span> |
| --- | --- | --- |
| <span data-ttu-id="9f995-255">1</span><span class="sxs-lookup"><span data-stu-id="9f995-255">1</span></span> |![Pravidlo](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="9f995-257">VIP1:80</span><span class="sxs-lookup"><span data-stu-id="9f995-257">VIP1:80</span></span> |![back-end](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="9f995-259">VIP1:80 (v VM1 a virtuálního počítače 2)</span><span class="sxs-lookup"><span data-stu-id="9f995-259">VIP1:80 (in VM1 and VM2)</span></span> |
| <span data-ttu-id="9f995-260">2</span><span class="sxs-lookup"><span data-stu-id="9f995-260">2</span></span> |![Pravidlo](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="9f995-262">VIP2:80</span><span class="sxs-lookup"><span data-stu-id="9f995-262">VIP2:80</span></span> |![back-end](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="9f995-264">VIP2:80 (v VM1 a virtuálního počítače 2)</span><span class="sxs-lookup"><span data-stu-id="9f995-264">VIP2:80 (in VM1 and VM2)</span></span> |

<span data-ttu-id="9f995-265">Hello následující tabulka ukazuje dokončení mapování hello nástroji pro vyrovnávání zatížení hello:</span><span class="sxs-lookup"><span data-stu-id="9f995-265">hello following table shows hello complete mapping in hello load balancer:</span></span>

| <span data-ttu-id="9f995-266">Pravidlo</span><span class="sxs-lookup"><span data-stu-id="9f995-266">Rule</span></span> | <span data-ttu-id="9f995-267">Virtuální IP adresy IP adresu</span><span class="sxs-lookup"><span data-stu-id="9f995-267">VIP IP address</span></span> | <span data-ttu-id="9f995-268">Protokol</span><span class="sxs-lookup"><span data-stu-id="9f995-268">protocol</span></span> | <span data-ttu-id="9f995-269">port</span><span class="sxs-lookup"><span data-stu-id="9f995-269">port</span></span> | <span data-ttu-id="9f995-270">Cíl</span><span class="sxs-lookup"><span data-stu-id="9f995-270">Destination</span></span> | <span data-ttu-id="9f995-271">port</span><span class="sxs-lookup"><span data-stu-id="9f995-271">port</span></span> |
| --- | --- | --- | --- | --- | --- |
| ![VIRTUÁLNÍ ADRESA IP.](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="9f995-273">1</span><span class="sxs-lookup"><span data-stu-id="9f995-273">1</span></span> |<span data-ttu-id="9f995-274">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="9f995-274">65.52.0.1</span></span> |<span data-ttu-id="9f995-275">TCP</span><span class="sxs-lookup"><span data-stu-id="9f995-275">TCP</span></span> |<span data-ttu-id="9f995-276">80</span><span class="sxs-lookup"><span data-stu-id="9f995-276">80</span></span> |<span data-ttu-id="9f995-277">stejné jako VIP (65.52.0.1)</span><span class="sxs-lookup"><span data-stu-id="9f995-277">same as VIP (65.52.0.1)</span></span> |<span data-ttu-id="9f995-278">stejné jako VIP (80)</span><span class="sxs-lookup"><span data-stu-id="9f995-278">same as VIP (80)</span></span> |
| ![VIRTUÁLNÍ ADRESA IP.](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="9f995-280">2</span><span class="sxs-lookup"><span data-stu-id="9f995-280">2</span></span> |<span data-ttu-id="9f995-281">65.52.0.2</span><span class="sxs-lookup"><span data-stu-id="9f995-281">65.52.0.2</span></span> |<span data-ttu-id="9f995-282">TCP</span><span class="sxs-lookup"><span data-stu-id="9f995-282">TCP</span></span> |<span data-ttu-id="9f995-283">80</span><span class="sxs-lookup"><span data-stu-id="9f995-283">80</span></span> |<span data-ttu-id="9f995-284">stejné jako VIP (65.52.0.2)</span><span class="sxs-lookup"><span data-stu-id="9f995-284">same as VIP (65.52.0.2)</span></span> |<span data-ttu-id="9f995-285">stejné jako VIP (80)</span><span class="sxs-lookup"><span data-stu-id="9f995-285">same as VIP (80)</span></span> |

<span data-ttu-id="9f995-286">Cílový Hello hello příchozí tok je hello virtuální adresy IP adresu na hello rozhraní zpětné smyčky v hello virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="9f995-286">hello destination of hello inbound flow is hello VIP address on hello loopback interface in hello VM.</span></span> <span data-ttu-id="9f995-287">Každé pravidlo musí vytvořit toku s jedinečnou kombinaci cílové IP adresy a cílového portu.</span><span class="sxs-lookup"><span data-stu-id="9f995-287">Each rule must produce a flow with a unique combination of destination IP address and destination port.</span></span> <span data-ttu-id="9f995-288">Pomocí různých hello cílové IP adresy hello toku, je možné na opakované použití portu hello stejného virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="9f995-288">By varying hello destination IP address of hello flow, port reuse is possible on hello same VM.</span></span> <span data-ttu-id="9f995-289">Služby je nástroj pro vyrovnávání zatížení zveřejněné toohello pomocí vytvoření vazby toohello virtuálních IP adres pro IP adresu a port hello příslušných zpětné smyčky rozhraní.</span><span class="sxs-lookup"><span data-stu-id="9f995-289">Your service is exposed toohello load balancer by binding it toohello VIP’s IP address and port of hello respective loopback interface.</span></span>

<span data-ttu-id="9f995-290">Všimněte si, že v tomto příkladu nezmění hello cílový port.</span><span class="sxs-lookup"><span data-stu-id="9f995-290">Notice that this example does not change hello destination port.</span></span> <span data-ttu-id="9f995-291">I když se jedná o scénář plovoucí IP adresa, nástroj pro vyrovnávání zatížení Azure podporuje také definovat pravidlo toorewrite hello back-end cílový port a toomake se liší od hello front-endu cílový port.</span><span class="sxs-lookup"><span data-stu-id="9f995-291">Even though this is a Floating IP scenario, Azure Load Balancer also supports defining a rule toorewrite hello backend destination port and toomake it different from hello frontend destination port.</span></span>

<span data-ttu-id="9f995-292">Hello typ pravidla plovoucí IP adresa je hello foundation několik schémat konfigurace služby Vyrovnávání zatížení.</span><span class="sxs-lookup"><span data-stu-id="9f995-292">hello Floating IP rule type is hello foundation of several load balancer configuration patterns.</span></span> <span data-ttu-id="9f995-293">Příkladem, který je aktuálně k dispozici je hello [technologie AlwaysOn serveru SQL s více naslouchací procesy](../virtual-machines/windows/sql/virtual-machines-windows-portal-sql-ps-alwayson-int-listener.md) konfigurace.</span><span class="sxs-lookup"><span data-stu-id="9f995-293">One example that is currently available is hello [SQL AlwaysOn with Multiple Listeners](../virtual-machines/windows/sql/virtual-machines-windows-portal-sql-ps-alwayson-int-listener.md) configuration.</span></span> <span data-ttu-id="9f995-294">V průběhu času jsme se dokumentů z uvedených scénářů.</span><span class="sxs-lookup"><span data-stu-id="9f995-294">Over time, we will document more of these scenarios.</span></span>

## <a name="limitations"></a><span data-ttu-id="9f995-295">Omezení</span><span class="sxs-lookup"><span data-stu-id="9f995-295">Limitations</span></span>

* <span data-ttu-id="9f995-296">Více konfigurací virtuálních IP adres jsou podporovány pouze s virtuální počítače IaaS.</span><span class="sxs-lookup"><span data-stu-id="9f995-296">Multiple VIP configurations are only supported with IaaS VMs.</span></span>
* <span data-ttu-id="9f995-297">S pravidlem hello plovoucí IP adresa musí vaše aplikace používat hello vyhrazené IP adresy pro odchozí toky.</span><span class="sxs-lookup"><span data-stu-id="9f995-297">With hello Floating IP rule, your application must use hello DIP for outbound flows.</span></span> <span data-ttu-id="9f995-298">Pokud vaše aplikace vytvoří vazbu toohello virtuální adresy IP adresou nakonfigurovanou na hello rozhraní zpětné smyčky v hello hostovaný operační systém, pak překládat pomocí SNAT není k dispozici toorewrite hello odchozího toku a hello toku nezdaří.</span><span class="sxs-lookup"><span data-stu-id="9f995-298">If your application binds toohello VIP address configured on hello loopback interface in hello guest OS, then SNAT is not available toorewrite hello outbound flow and hello flow fails.</span></span>
* <span data-ttu-id="9f995-299">Veřejné IP adresy mají vliv na fakturace.</span><span class="sxs-lookup"><span data-stu-id="9f995-299">Public IP addresses have an effect on billing.</span></span> <span data-ttu-id="9f995-300">Další informace najdete v tématu [ceny IP adresu](https://azure.microsoft.com/pricing/details/ip-addresses/)</span><span class="sxs-lookup"><span data-stu-id="9f995-300">For more information, see [IP Address pricing](https://azure.microsoft.com/pricing/details/ip-addresses/)</span></span>
* <span data-ttu-id="9f995-301">Limity předplatného použít.</span><span class="sxs-lookup"><span data-stu-id="9f995-301">Subscription limits apply.</span></span> <span data-ttu-id="9f995-302">Další informace najdete v tématu [omezení služby](../azure-subscription-service-limits.md#networking-limits) podrobnosti.</span><span class="sxs-lookup"><span data-stu-id="9f995-302">For more information, see [Service limits](../azure-subscription-service-limits.md#networking-limits) for details.</span></span>
