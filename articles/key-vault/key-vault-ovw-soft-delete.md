---
ms.assetid: 
title: "Azure Key Vault obnovitelného odstranění | Microsoft Docs"
ms.service: key-vault
author: BrucePerlerMS
ms.author: bruceper
manager: mbaldwin
ms.date: 07/10/2017
ms.openlocfilehash: c873b153ef9c7d5f55672a5918c9dc4fb7256701
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/03/2017
---
# <a name="azure-key-vault-soft-delete-overview"></a><span data-ttu-id="11eaf-102">Přehled konfigurace soft odstranění služby Azure Key Vault</span><span class="sxs-lookup"><span data-stu-id="11eaf-102">Azure Key Vault soft-delete overview</span></span>

<span data-ttu-id="11eaf-103">Key Vault obnovitelného odstranění funkce umožňuje obnovení odstraněné trezory a objekty trezoru, označuje jako obnovitelného odstranění.</span><span class="sxs-lookup"><span data-stu-id="11eaf-103">Key Vault's soft delete feature allows recovery of the deleted vaults and vault objects, known as soft-delete.</span></span> <span data-ttu-id="11eaf-104">Konkrétně tento problém řeší následující scénáře:</span><span class="sxs-lookup"><span data-stu-id="11eaf-104">Specifically, we address the following scenarios:</span></span>

- <span data-ttu-id="11eaf-105">Podpora pro obnovitelné odstranění trezoru klíčů</span><span class="sxs-lookup"><span data-stu-id="11eaf-105">Support for recoverable deletion of a key vault</span></span>
- <span data-ttu-id="11eaf-106">Podpora pro obnovitelné odstranění trezoru klíčů objektů (např.</span><span class="sxs-lookup"><span data-stu-id="11eaf-106">Support for recoverable deletion of key vault objects (ex.</span></span> <span data-ttu-id="11eaf-107">klíče, certifikáty a tajné klíče)</span><span class="sxs-lookup"><span data-stu-id="11eaf-107">keys, secrets, certificates)</span></span>

## <a name="supporting-interfaces"></a><span data-ttu-id="11eaf-108">Podpora rozhraní</span><span class="sxs-lookup"><span data-stu-id="11eaf-108">Supporting interfaces</span></span>

<span data-ttu-id="11eaf-109">Funkci soft odstranění je původně k dispozici prostřednictvím REST, .NET / C# a prostředí PowerShell rozhraní.</span><span class="sxs-lookup"><span data-stu-id="11eaf-109">The soft-delete feature is initially available through the REST, .NET/C# and PowerShell interfaces.</span></span> <span data-ttu-id="11eaf-110">Najdete odkazy na tyto další podrobnosti, [Key Vault Reference](https://docs.microsoft.com/azure/key-vault/).</span><span class="sxs-lookup"><span data-stu-id="11eaf-110">Refer to the references for these for more details, [Key Vault Reference](https://docs.microsoft.com/azure/key-vault/).</span></span>

## <a name="scenarios"></a><span data-ttu-id="11eaf-111">Scénáře</span><span class="sxs-lookup"><span data-stu-id="11eaf-111">Scenarios</span></span>

<span data-ttu-id="11eaf-112">Azure trezory klíč jsou sledované prostředky, spravovat pomocí Správce prostředků Azure.</span><span class="sxs-lookup"><span data-stu-id="11eaf-112">Azure Key Vaults are tracked resources, managed by Azure Resource Manager.</span></span> <span data-ttu-id="11eaf-113">Azure Resource Manager určuje také dobře definovaný chování pro odstranění, které vyžaduje, aby úspěšná operace odstranění musí mít za následek prostředku nebude přístupný už.</span><span class="sxs-lookup"><span data-stu-id="11eaf-113">Azure Resource Manager also specifies a well-defined behavior for deletion, which requires that a successful DELETE operation must result in that resource not being accessible anymore.</span></span> <span data-ttu-id="11eaf-114">Funkci soft odstranění řeší obnovení odstraněného objektu, zda byl odstraněn náhodnému nebo záměrnému.</span><span class="sxs-lookup"><span data-stu-id="11eaf-114">The soft-delete feature addresses the recovery of the deleted object, whether the deletion was accidental or intentional.</span></span>

1. <span data-ttu-id="11eaf-115">V typických možností uživatele nechtěně odstraněno trezoru klíčů nebo objekt trezoru klíčů; Pokud, klíč trezoru, nebo klíč trezoru objekt měla být použitelná pro obnovení po předem určenou dobu, může odstranění vrátit zpět a obnovit svá data uživatele.</span><span class="sxs-lookup"><span data-stu-id="11eaf-115">In the typical scenario, a user may have inadvertently deleted a key vault or a key vault object; if that key vault or key vault object were to be recoverable for a predetermined period, the user may undo the deletion and recover their data.</span></span>

2. <span data-ttu-id="11eaf-116">V případě různých neautorizovaný uživatel může pokusu o odstranění trezoru klíčů nebo objekt trezoru klíčů, například klíč v trezoru, způsobit přerušení obchodní.</span><span class="sxs-lookup"><span data-stu-id="11eaf-116">In a different scenario, a rogue user may attempt to delete a key vault or a key vault object, such as a key inside a vault, to cause a business disruption.</span></span> <span data-ttu-id="11eaf-117">Oddělení odstranění trezoru klíčů nebo objekt trezoru klíčů ze skutečného odstranění zadaných dat můžete použít jako bezpečnostní opatření, například omezení oprávnění k odstranění dat na jiný důvěryhodné role.</span><span class="sxs-lookup"><span data-stu-id="11eaf-117">Separating the deletion of the key vault or key vault object from the actual deletion of the underlying data can be used as a safety measure by, for instance, restricting permissions on data deletion to a different, trusted role.</span></span> <span data-ttu-id="11eaf-118">Tento přístup efektivně vyžaduje kvora pro operace, které může jinak dojít ke ztrátě okamžité data.</span><span class="sxs-lookup"><span data-stu-id="11eaf-118">This approach effectively requires quorum for an operation which might otherwise result in an immediate data loss.</span></span>

### <a name="soft-delete-behavior"></a><span data-ttu-id="11eaf-119">Chování konfigurace soft odstranění</span><span class="sxs-lookup"><span data-stu-id="11eaf-119">Soft-delete behavior</span></span>

<span data-ttu-id="11eaf-120">Pomocí této funkce je operace odstranění trezoru klíčů objektů nebo trezoru klíčů konfigurace soft odstranění, efektivně podržíte prostředky pro danou uchování období, při poskytnutí vzhled, že je tento objekt odstranit.</span><span class="sxs-lookup"><span data-stu-id="11eaf-120">With this feature, the DELETE operation on a key vault or key vault object is a soft-delete, effectively holding the resources for a given retention period, while giving the appearance that the object is deleted.</span></span> <span data-ttu-id="11eaf-121">Další služby poskytuje mechanismus pro obnovení odstraněného objektu, a to v podstatě vrácení zpět k odstranění.</span><span class="sxs-lookup"><span data-stu-id="11eaf-121">The service further provides a mechanism for recovering the deleted object, essentially undoing the deletion.</span></span> 

<span data-ttu-id="11eaf-122">Konfigurace soft odstranění je volitelné chování Key Vault a je **není ve výchozím nastavení povolené** v této verzi.</span><span class="sxs-lookup"><span data-stu-id="11eaf-122">Soft-delete is an optional Key Vault behavior and is **not enabled by default** in this release.</span></span> <span data-ttu-id="11eaf-123">Podrobnosti o povolení konfigurace soft odstranění pro váš trezor klíčů najdete v tématu konkrétní pokyny v dokumentaci pro rozhraní podle svého výběru [Key Vault Reference](https://docs.microsoft.com/azure/key-vault/).</span><span class="sxs-lookup"><span data-stu-id="11eaf-123">For details on enabling soft-delete for your key vault, see the specific guidance in the reference for the interface of your choice, [Key Vault Reference](https://docs.microsoft.com/azure/key-vault/).</span></span>

### <a name="key-vault-recovery"></a><span data-ttu-id="11eaf-124">Obnovení klíče trezoru</span><span class="sxs-lookup"><span data-stu-id="11eaf-124">Key vault recovery</span></span>

<span data-ttu-id="11eaf-125">Po odstranění trezoru klíčů, vytvoří služba proxy prostředků v rámci předplatného, přidání dostatečná metadata pro obnovení.</span><span class="sxs-lookup"><span data-stu-id="11eaf-125">Upon deleting a key vault, the service creates a proxy resource under the subscription, adding sufficient metadata for recovery.</span></span> <span data-ttu-id="11eaf-126">Prostředek proxy je objekt uložené, k dispozici ve stejném umístění jako trezor klíčů odstraněné.</span><span class="sxs-lookup"><span data-stu-id="11eaf-126">The proxy resource is a stored object, available in the same location as the deleted key vault.</span></span> 

### <a name="key-vault-object-recovery"></a><span data-ttu-id="11eaf-127">Obnovení objektu trezoru klíčů</span><span class="sxs-lookup"><span data-stu-id="11eaf-127">Key vault object recovery</span></span>

<span data-ttu-id="11eaf-128">Při odstraňování objekt trezoru klíčů, například klíč, službu umístí objekt v odstraněném stavu, díky čemuž dostupná pro všechny operace načtení.</span><span class="sxs-lookup"><span data-stu-id="11eaf-128">Upon deleting a key vault object, such as a key, the service will place the object in a deleted state, thus making it inaccessible to any retrieval operations.</span></span> <span data-ttu-id="11eaf-129">V tomto stavu, objekt trezoru klíčů může pouze být uvedený, obnovené nebo vynuceně nebo trvale odstraněn.</span><span class="sxs-lookup"><span data-stu-id="11eaf-129">While in this state, the key vault object can only be listed, recovered, or forcefully/permanently deleted.</span></span> 

<span data-ttu-id="11eaf-130">Ve stejnou dobu bude Key Vault naplánovat odstranění základní data odpovídající odstraněné trezoru klíčů nebo objekt trezoru klíčů pro provádění po předem určenou dobu.</span><span class="sxs-lookup"><span data-stu-id="11eaf-130">At the same time, Key Vault will schedule the deletion of the underlying data corresponding to the deleted key vault or key vault object for execution after a predetermined retention interval.</span></span> <span data-ttu-id="11eaf-131">Záznam DNS odpovídající úložišti se také uchovávají po dobu trvání intervalu uchování.</span><span class="sxs-lookup"><span data-stu-id="11eaf-131">The DNS record corresponding to the vault is also retained for the duration of the retention interval.</span></span>

### <a name="soft-delete-retention-period"></a><span data-ttu-id="11eaf-132">Doba uchování dat konfigurace soft odstranění</span><span class="sxs-lookup"><span data-stu-id="11eaf-132">Soft-delete retention period</span></span>

<span data-ttu-id="11eaf-133">Logicky odstraněné prostředky jsou uchovány nastavte dobu, 90 dní.</span><span class="sxs-lookup"><span data-stu-id="11eaf-133">Soft deleted resources are retained for a set period of time, 90 days.</span></span> <span data-ttu-id="11eaf-134">Během intervalu uchování konfigurace soft odstranění následujících podmínek:</span><span class="sxs-lookup"><span data-stu-id="11eaf-134">During the soft-delete retention interval, the following apply:</span></span>

- <span data-ttu-id="11eaf-135">Můžete seznam všech trezorů klíčů a klíče trezoru objekty ve stavu obnovitelného odstranění pro vaše předplatné a také přístup k odstranění a obnovení informace o nich.</span><span class="sxs-lookup"><span data-stu-id="11eaf-135">You may list all of the key vaults and key vault objects in the soft-delete state for your subscription as well as access deletion and recovery information about them.</span></span>
    - <span data-ttu-id="11eaf-136">Pouze uživatelé s speciální oprávnění vytvořit seznam odstraněných trezorů.</span><span class="sxs-lookup"><span data-stu-id="11eaf-136">Only users with special permissions can list deleted vaults.</span></span> <span data-ttu-id="11eaf-137">Doporučujeme uživatelům vytvořit vlastní roli s tyto speciální oprávnění pro zpracování odstranit trezorů.</span><span class="sxs-lookup"><span data-stu-id="11eaf-137">We recommend that our users create a custom role with these special permissions for handling deleted vaults.</span></span>
- <span data-ttu-id="11eaf-138">Nelze vytvořit trezoru klíčů se stejným názvem do stejného umístění; odpovídajícím způsobem trezor klíčů objekt nelze vytvořit v dané trezoru Pokud tento trezor klíčů obsahuje objekt se stejným názvem a který je v odstraněném stavu</span><span class="sxs-lookup"><span data-stu-id="11eaf-138">A key vault with the same name cannot be created in the same location; correspondingly, a key vault object cannot be created in a given vault if that key vault contains an object with the same name and which is in a deleted state</span></span> 
- <span data-ttu-id="11eaf-139">Jenom uživatel, konkrétně privilegované může obnovit trezoru klíčů nebo objekt trezoru klíčů vydání příkazu Obnovit na odpovídající prostředek proxy serveru.</span><span class="sxs-lookup"><span data-stu-id="11eaf-139">Only a specifically privileged user may restore a key vault or key vault object by issuing a recover command on the corresponding proxy resource.</span></span>
    - <span data-ttu-id="11eaf-140">Uživatel členem vlastní role, který má oprávnění k vytvoření trezoru klíčů ve skupině prostředků, můžete obnovit trezoru.</span><span class="sxs-lookup"><span data-stu-id="11eaf-140">The user, member of the custom role, who has the privilege to create a key vault under the resource group can restore the vault.</span></span>
- <span data-ttu-id="11eaf-141">Jenom uživatel, konkrétně privilegované může vynuceně odstranění trezoru klíčů nebo trezoru klíčů objektu po vydání příkazu delete na odpovídající prostředek proxy serveru.</span><span class="sxs-lookup"><span data-stu-id="11eaf-141">Only a specifically privileged user may forcibly delete a key vault or key vault object by issuing a delete command on the corresponding proxy resource.</span></span>

<span data-ttu-id="11eaf-142">Pokud je obnovena na trezor klíčů nebo objekt trezoru klíčů, provádí služba na konci intervalu uchování vyprazdňování obnovitelné odstranění trezoru klíčů nebo objekt trezoru klíčů a její obsah.</span><span class="sxs-lookup"><span data-stu-id="11eaf-142">Unless a key vault or key vault object is recovered, at the end of the retention interval the service performs a purge of the soft-deleted key vault or key vault object and its content.</span></span> <span data-ttu-id="11eaf-143">Odstranění prostředku nemusí přeplánovat.</span><span class="sxs-lookup"><span data-stu-id="11eaf-143">Resource deletion may not be rescheduled.</span></span>

### <a name="permitted-purge"></a><span data-ttu-id="11eaf-144">Povolené vyprázdnění</span><span class="sxs-lookup"><span data-stu-id="11eaf-144">Permitted purge</span></span>

<span data-ttu-id="11eaf-145">Trvale odstraníte, čištění, trezoru klíčů je možné prostřednictvím operaci POST na prostředku proxy serveru a vyžaduje speciální oprávnění.</span><span class="sxs-lookup"><span data-stu-id="11eaf-145">Permanently deleting, purging, a key vault is possible via a POST operation on the proxy resource and requires special privileges.</span></span> <span data-ttu-id="11eaf-146">Obecně platí pouze vlastník předplatného bude moci mazání trezoru klíčů.</span><span class="sxs-lookup"><span data-stu-id="11eaf-146">Generally, only the subscription owner will be able to purge a key vault.</span></span> <span data-ttu-id="11eaf-147">Operaci POST spustí okamžitou a nezotavitelné odstranění tohoto trezoru.</span><span class="sxs-lookup"><span data-stu-id="11eaf-147">The POST operation triggers the immediate and irrecoverable deletion of that vault.</span></span> 

<span data-ttu-id="11eaf-148">Výjimkou je případ, kdy Azure odběr byl označen jako *neodstranitelný*.</span><span class="sxs-lookup"><span data-stu-id="11eaf-148">An exception to this is the case when the Azure subscription has been marked as *undeletable*.</span></span> <span data-ttu-id="11eaf-149">V takovém případě pouze služby pak může provádět skutečného odstranění a nemá tak jako naplánované proces.</span><span class="sxs-lookup"><span data-stu-id="11eaf-149">In this case, only the service may then perform the actual deletion, and does so as a scheduled process.</span></span> 



