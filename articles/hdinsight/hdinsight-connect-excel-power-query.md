---
title: "aaaConnect tooHadoop aplikace Excel pomocí doplňku Power Query - Azure HDInsight | Microsoft Docs"
description: "Zjistěte, jak tootake výhod komponenty business intelligence a používání doplňku Power Query pro Excel tooaccess data uložená v Hadoop v HDInsight."
services: hdinsight
documentationcenter: 
tags: azure-portal
author: mumian
manager: jhubbard
editor: cgronlun
ms.assetid: 01ad2f90-7520-44d9-8c16-4d936faaff9b
ms.service: hdinsight
ms.custom: hdinsightactive
ms.workload: big-data
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/11/2017
ms.author: jgao
ms.openlocfilehash: 1213849f1bc04e0ed206750b80766ff2268664b4
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="connect-excel-toohadoop-by-using-power-query"></a><span data-ttu-id="92afb-103">Připojení aplikace Excel tooHadoop pomocí doplňku Power Query</span><span class="sxs-lookup"><span data-stu-id="92afb-103">Connect Excel tooHadoop by using Power Query</span></span>
<span data-ttu-id="92afb-104">Klíčovou vlastností řešení velkých objemů dat společnosti Microsoft hello je hello integrace komponenty Microsoft business intelligence (BI) s clustery systému Hadoop v prostředí Azure HDInsight.</span><span class="sxs-lookup"><span data-stu-id="92afb-104">One key feature of hello Microsoft big-data solution is hello integration of Microsoft business intelligence (BI) components with Hadoop clusters in Azure HDInsight.</span></span> <span data-ttu-id="92afb-105">Primární příkladem je hello možnost tooconnect Excel toohello účet úložiště Azure, který obsahuje data hello přidruženého k vašemu clusteru Hadoop pomocí hello Microsoft Power Query pro doplněk aplikace Excel.</span><span class="sxs-lookup"><span data-stu-id="92afb-105">A primary example is hello ability tooconnect Excel toohello Azure Storage account that contains hello data associated with your Hadoop cluster by using hello Microsoft Power Query for Excel add-in.</span></span> <span data-ttu-id="92afb-106">Tento článek vás provede tooset nahoru a používání doplňku Power Query tooquery data přidružená k clusteru Hadoop spravováni s HDInsight.</span><span class="sxs-lookup"><span data-stu-id="92afb-106">This article walks you through how tooset up and use Power Query tooquery data associated with a Hadoop cluster managed with HDInsight.</span></span>

### <a name="prerequisites"></a><span data-ttu-id="92afb-107">Požadavky</span><span class="sxs-lookup"><span data-stu-id="92afb-107">Prerequisites</span></span>
<span data-ttu-id="92afb-108">Před zahájením tohoto článku, musíte mít hello následující položky:</span><span class="sxs-lookup"><span data-stu-id="92afb-108">Before you begin this article, you must have hello following items:</span></span>

* <span data-ttu-id="92afb-109">**Cluster služby HDInsight**.</span><span class="sxs-lookup"><span data-stu-id="92afb-109">**An HDInsight cluster**.</span></span> <span data-ttu-id="92afb-110">tooconfigure, najdete v části [Začínáme s Azure HDInsight][hdinsight-get-started].</span><span class="sxs-lookup"><span data-stu-id="92afb-110">tooconfigure one, see [Get started with Azure HDInsight][hdinsight-get-started].</span></span>
* <span data-ttu-id="92afb-111">**Pracovní stanice** se systémem Windows 7, Windows Server 2008 R2 nebo novějším operačním systémem.</span><span class="sxs-lookup"><span data-stu-id="92afb-111">**A workstation** that is running Windows 7, Windows Server 2008 R2, or a later operating system.</span></span>
* <span data-ttu-id="92afb-112">**Office 2016, Office Professional 2013 Plus, Office 365 ProPlus, samostatné aplikace Excel 2013 nebo Office 2010 Professional Plus**.</span><span class="sxs-lookup"><span data-stu-id="92afb-112">**Office 2016, Office 2013 Professional Plus, Office 365 ProPlus, Excel 2013 Standalone, or Office 2010 Professional Plus**.</span></span>

## <a name="install-power-query"></a><span data-ttu-id="92afb-113">Instalace doplňku Power Query</span><span class="sxs-lookup"><span data-stu-id="92afb-113">Install Power Query</span></span>
<span data-ttu-id="92afb-114">Power Query můžete importovat data, která má výstup, nebo které byla vygenerována v rámci Hadoop úlohy spuštěné v clusteru služby HDInsight.</span><span class="sxs-lookup"><span data-stu-id="92afb-114">Power Query can import data that has been output or that has been generated by a Hadoop job running on an HDInsight cluster.</span></span>

<span data-ttu-id="92afb-115">V aplikaci Excel 2016 Power Query integrovány do hello Data pásu karet v části hello Get & části transformace.</span><span class="sxs-lookup"><span data-stu-id="92afb-115">In Excel 2016, Power Query has been integrated into hello Data ribbon under hello Get & Transform section.</span></span> <span data-ttu-id="92afb-116">Pro starší verze aplikace Excel, stáhnout Microsoft Power Query pro Excel z hello [Microsoft Download Center] [ powerquery-download] a nainstalujte ji.</span><span class="sxs-lookup"><span data-stu-id="92afb-116">For older Excel versions, download Microsoft Power Query for Excel from hello [Microsoft Download Center][powerquery-download] and install it.</span></span>

## <a name="import-hdinsight-data-into-excel"></a><span data-ttu-id="92afb-117">Importovat HDInsight data do aplikace Excel</span><span class="sxs-lookup"><span data-stu-id="92afb-117">Import HDInsight data into Excel</span></span>
<span data-ttu-id="92afb-118">Hello doplňku Power Query pro Excel umožňuje snadno tooimport data z clusteru HDInsight do Excelu, kde můžete nástrojů BI, například doplňku PowerPivot a mapa Power být použité tooinspect, analyzovat a prezentují hello data.</span><span class="sxs-lookup"><span data-stu-id="92afb-118">hello Power Query add-in for Excel makes it easy tooimport data from your HDInsight cluster into Excel, where BI tools such as PowerPivot and Power Map can be used tooinspect, analyze, and present hello data.</span></span>

<span data-ttu-id="92afb-119">**tooimport data z clusteru služby HDInsight**</span><span class="sxs-lookup"><span data-stu-id="92afb-119">**tooimport data from an HDInsight cluster**</span></span>

1. <span data-ttu-id="92afb-120">Otevřete aplikaci Excel.</span><span class="sxs-lookup"><span data-stu-id="92afb-120">Open Excel.</span></span>
2. <span data-ttu-id="92afb-121">Vytvoření nového prázdného sešitu.</span><span class="sxs-lookup"><span data-stu-id="92afb-121">Create a new blank workbook.</span></span>
3. <span data-ttu-id="92afb-122">Proveďte následující kroky, které jsou založeny na verzi aplikace Excel hello hello:</span><span class="sxs-lookup"><span data-stu-id="92afb-122">Perform hello following steps based on hello Excel version:</span></span>

    - <span data-ttu-id="92afb-123">Excel 2016</span><span class="sxs-lookup"><span data-stu-id="92afb-123">Excel 2016</span></span>

        - <span data-ttu-id="92afb-124">Klikněte na tlačítko hello **Data** nabídky, klikněte na tlačítko **načíst Data** z hello **Get & transformace dat** pásu karet, klikněte na tlačítko **z Azure**a pak klikněte na tlačítko  **Z Azure HDInsight(HDFS)**.</span><span class="sxs-lookup"><span data-stu-id="92afb-124">Click hello **Data** menu, click **Get Data** from hello **Get & Transform Data** ribbon, click **From Azure**, and then click **From Azure HDInsight(HDFS)**.</span></span>

        ![HDI. PowerQuery.SelectHdiSource](./media/hdinsight-connect-excel-power-query/hdi.powerquery.selecthdisource.excel2016.png)

    - <span data-ttu-id="92afb-126">Excel 2013/2010</span><span class="sxs-lookup"><span data-stu-id="92afb-126">Excel 2013/2010</span></span>

        - <span data-ttu-id="92afb-127">Klikněte na tlačítko hello **Power Query** nabídky, klikněte na tlačítko **z Azure**a potom klikněte na **z Microsoft Azure HDInsight**.</span><span class="sxs-lookup"><span data-stu-id="92afb-127">Click hello **Power Query** menu, click **From Azure**, and then click **From Microsoft Azure HDInsight**.</span></span>
   
        ![HDI. PowerQuery.SelectHdiSource][image-hdi-powerquery-hdi-source]
       
        <span data-ttu-id="92afb-129">**Poznámka:** Pokud nevidíte hello **Power Query** nabídky, přejděte příliš**soubor** > **možnosti** > **doplňky**a vyberte **COM Doplňky** z rozevíracího seznamu hello **spravovat** pole v hello dolní části stránky hello.</span><span class="sxs-lookup"><span data-stu-id="92afb-129">**Note:** If you don't see hello **Power Query** menu, go too**File** > **Options** > **Add-Ins**, and select **COM Add-ins** from hello drop-down **Manage** box at hello bottom of hello page.</span></span> <span data-ttu-id="92afb-130">Vyberte hello **přejděte...**  tlačítko a ověřte dané pole hello, byl vrácen hello Power Query pro Excel add-in.</span><span class="sxs-lookup"><span data-stu-id="92afb-130">Select hello **Go...** button and verify that hello box for hello Power Query for Excel add-in has been checked.</span></span>
       
        <span data-ttu-id="92afb-131">**Poznámka:** Power Query lze také tooimport data z HDFS kliknutím **z jiných zdrojů**.</span><span class="sxs-lookup"><span data-stu-id="92afb-131">**Note:** Power Query also allows you tooimport data from HDFS by clicking **From Other Sources**.</span></span>
4. <span data-ttu-id="92afb-132">Pro **název účtu**zadejte hello název účtu úložiště objektů Blob v Azure hello přidruženého k vašemu clusteru a pak klikněte na tlačítko **OK**.</span><span class="sxs-lookup"><span data-stu-id="92afb-132">For **Account Name**, enter hello name of hello Azure Blob storage account associated with your cluster, and then click **OK**.</span></span> <span data-ttu-id="92afb-133">Tento účet může být hello [výchozí účet úložiště](hdinsight-administer-use-management-portal.md#find-the-default-storage-account) nebo propojený účet úložiště.</span><span class="sxs-lookup"><span data-stu-id="92afb-133">This account can be hello [default storage account](hdinsight-administer-use-management-portal.md#find-the-default-storage-account) or a linked storage account.</span></span>  <span data-ttu-id="92afb-134">Formát Hello je *https://&lt;StorageAccountName >.blob.core.windows.net/*.</span><span class="sxs-lookup"><span data-stu-id="92afb-134">hello format is *https://&lt;StorageAccountName>.blob.core.windows.net/*.</span></span>
5. <span data-ttu-id="92afb-135">Pro **klíč účtu**zadejte hello klíč pro hello účtu úložiště Blob a pak klikněte na tlačítko **Uložit**.</span><span class="sxs-lookup"><span data-stu-id="92afb-135">For **Account Key**, enter hello key for hello Blob storage account, and then click **Save**.</span></span> <span data-ttu-id="92afb-136">(Potřebujete tooenter hello účet informace pouze hello prvním přístupu k tomuto úložišti.)</span><span class="sxs-lookup"><span data-stu-id="92afb-136">(You need tooenter hello account information only hello first time you access this store.)</span></span>
6. <span data-ttu-id="92afb-137">V hello **Navigátor** levé podokno na hello hello editoru dotazů, dvakrát klikněte na název kontejneru úložiště objektů Blob hello.</span><span class="sxs-lookup"><span data-stu-id="92afb-137">In hello **Navigator** pane on hello left of hello Query Editor, double-click hello Blob storage container name.</span></span> <span data-ttu-id="92afb-138">Ve výchozím nastavení, je název kontejneru hello hello stejný název jako název clusteru hello.</span><span class="sxs-lookup"><span data-stu-id="92afb-138">By default, hello container name is hello same name as hello cluster name.</span></span>
7. <span data-ttu-id="92afb-139">Vyhledejte **HiveSampleData.txt** v hello **název** sloupce (je cesta ke složce hello **... / hive/skladu/hivesampletable/**) a potom klikněte na **binární** na hello nalevo od HiveSampleData.txt.</span><span class="sxs-lookup"><span data-stu-id="92afb-139">Locate **HiveSampleData.txt** in hello **Name** column (hello folder path is **../hive/warehouse/hivesampletable/**), and then click **Binary** on hello left of HiveSampleData.txt.</span></span> <span data-ttu-id="92afb-140">HiveSampleData.txt obsahuje všechny hello clusteru.</span><span class="sxs-lookup"><span data-stu-id="92afb-140">HiveSampleData.txt comes with all hello cluster.</span></span> <span data-ttu-id="92afb-141">Volitelně můžete vytvořit svůj vlastní soubor.</span><span class="sxs-lookup"><span data-stu-id="92afb-141">Optionally, you can use your own file.</span></span>
   
    ![HDI. PowerQuery.ImportData][image-hdi-powerquery-importdata]
8. <span data-ttu-id="92afb-143">Pokud chcete, můžete přejmenovat hello názvy sloupců.</span><span class="sxs-lookup"><span data-stu-id="92afb-143">If you want, you can rename hello column names.</span></span> <span data-ttu-id="92afb-144">Až budete připravení, klikněte na tlačítko **zavřete & načíst**.</span><span class="sxs-lookup"><span data-stu-id="92afb-144">When you are ready, click **Close & Load**.</span></span>  <span data-ttu-id="92afb-145">načíst tooyour sešitu byla Hello data:</span><span class="sxs-lookup"><span data-stu-id="92afb-145">hello data has been loaded tooyour workbook:</span></span>
   
    ![HDI. PowerQuery.ImportedTable][image-hdi-powerquery-imported-table]

## <a name="next-steps"></a><span data-ttu-id="92afb-147">Další kroky</span><span class="sxs-lookup"><span data-stu-id="92afb-147">Next steps</span></span>
<span data-ttu-id="92afb-148">V tomto článku jste se naučili jak toouse Power Query tooretrieve data z HDInsight do aplikace Excel.</span><span class="sxs-lookup"><span data-stu-id="92afb-148">In this article, you learned how toouse Power Query tooretrieve data from HDInsight into Excel.</span></span> <span data-ttu-id="92afb-149">Podobně můžete data načíst z prostředí HDInsight do Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="92afb-149">Similarly, you can retrieve data from HDInsight into Azure SQL Database.</span></span> <span data-ttu-id="92afb-150">Je také možné tooupload data do HDInsight.</span><span class="sxs-lookup"><span data-stu-id="92afb-150">It is also possible tooupload data into HDInsight.</span></span> <span data-ttu-id="92afb-151">toolearn více, najdete v části hello následující články:</span><span class="sxs-lookup"><span data-stu-id="92afb-151">toolearn more, see hello following articles:</span></span>

* <span data-ttu-id="92afb-152">[Připojení aplikace Excel tooHDInsight s hello ovladače ODBC Microsoft Hive][hdinsight-ODBC]</span><span class="sxs-lookup"><span data-stu-id="92afb-152">[Connect Excel tooHDInsight with hello Microsoft Hive ODBC Driver][hdinsight-ODBC]</span></span>
* <span data-ttu-id="92afb-153">[Nahrání dat tooHDInsight][hdinsight-upload-data]</span><span class="sxs-lookup"><span data-stu-id="92afb-153">[Upload Data tooHDInsight][hdinsight-upload-data]</span></span>

[hdinsight-ODBC]: hdinsight-connect-excel-hive-odbc-driver.md
[hdinsight-get-started]: hdinsight-hadoop-linux-tutorial-get-started.md
[hdinsight-upload-data]: hdinsight-upload-data.md

[image-hdi-powerquery-hdi-source]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.selecthdisource.png
[image-hdi-powerquery-importdata]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.importdata.png
[image-hdi-powerquery-imported-table]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.importedtable.PNG

[powerquery-download]: http://go.microsoft.com/fwlink/?LinkID=286689
