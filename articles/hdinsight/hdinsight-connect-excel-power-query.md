---
title: "Připojení aplikace Excel k systému Hadoop pomocí Power Query - Azure HDInsight | Microsoft Docs"
description: "Zjistěte, jak využít výhod komponenty business intelligence a použijte Power Query pro Excel přístup k datům uloženým v Hadoop v HDInsight."
services: hdinsight
documentationcenter: 
tags: azure-portal
author: mumian
manager: jhubbard
editor: cgronlun
ms.assetid: 01ad2f90-7520-44d9-8c16-4d936faaff9b
ms.service: hdinsight
ms.custom: hdinsightactive
ms.workload: big-data
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/11/2017
ms.author: jgao
ms.openlocfilehash: 6a15efb091b4faaa7305bb8faa362c62fac595cb
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/03/2017
---
# <a name="connect-excel-to-hadoop-by-using-power-query"></a><span data-ttu-id="a29cf-103">Připojení aplikace Excel k systému Hadoop pomocí Power Query</span><span class="sxs-lookup"><span data-stu-id="a29cf-103">Connect Excel to Hadoop by using Power Query</span></span>
<span data-ttu-id="a29cf-104">Klíčovou vlastností řešení velkých objemů dat společnosti Microsoft je integrace komponenty Microsoft business intelligence (BI) s clustery systému Hadoop v prostředí Azure HDInsight.</span><span class="sxs-lookup"><span data-stu-id="a29cf-104">One key feature of the Microsoft big-data solution is the integration of Microsoft business intelligence (BI) components with Hadoop clusters in Azure HDInsight.</span></span> <span data-ttu-id="a29cf-105">Primární příkladem je možnost připojit Excel k účtu úložiště Azure, který obsahuje data přidruženého k vašemu clusteru Hadoop pomocí Microsoft Power Query pro doplněk aplikace Excel.</span><span class="sxs-lookup"><span data-stu-id="a29cf-105">A primary example is the ability to connect Excel to the Azure Storage account that contains the data associated with your Hadoop cluster by using the Microsoft Power Query for Excel add-in.</span></span> <span data-ttu-id="a29cf-106">Tento článek vás provede procesem nastavení a použití doplňku Power Query k dotazování na data související s clusterem Hadoop spravované s HDInsight.</span><span class="sxs-lookup"><span data-stu-id="a29cf-106">This article walks you through how to set up and use Power Query to query data associated with a Hadoop cluster managed with HDInsight.</span></span>

### <a name="prerequisites"></a><span data-ttu-id="a29cf-107">Požadavky</span><span class="sxs-lookup"><span data-stu-id="a29cf-107">Prerequisites</span></span>
<span data-ttu-id="a29cf-108">Před zahájením tohoto článku, musíte mít následující položky:</span><span class="sxs-lookup"><span data-stu-id="a29cf-108">Before you begin this article, you must have the following items:</span></span>

* <span data-ttu-id="a29cf-109">**Cluster služby HDInsight**.</span><span class="sxs-lookup"><span data-stu-id="a29cf-109">**An HDInsight cluster**.</span></span> <span data-ttu-id="a29cf-110">Nakonfigurujte jeden, najdete v tématu [Začínáme s Azure HDInsight][hdinsight-get-started].</span><span class="sxs-lookup"><span data-stu-id="a29cf-110">To configure one, see [Get started with Azure HDInsight][hdinsight-get-started].</span></span>
* <span data-ttu-id="a29cf-111">**Pracovní stanice** se systémem Windows 7, Windows Server 2008 R2 nebo novějším operačním systémem.</span><span class="sxs-lookup"><span data-stu-id="a29cf-111">**A workstation** that is running Windows 7, Windows Server 2008 R2, or a later operating system.</span></span>
* <span data-ttu-id="a29cf-112">**Office 2016, Office Professional 2013 Plus, Office 365 ProPlus, samostatné aplikace Excel 2013 nebo Office 2010 Professional Plus**.</span><span class="sxs-lookup"><span data-stu-id="a29cf-112">**Office 2016, Office 2013 Professional Plus, Office 365 ProPlus, Excel 2013 Standalone, or Office 2010 Professional Plus**.</span></span>

## <a name="install-power-query"></a><span data-ttu-id="a29cf-113">Instalace doplňku Power Query</span><span class="sxs-lookup"><span data-stu-id="a29cf-113">Install Power Query</span></span>
<span data-ttu-id="a29cf-114">Power Query můžete importovat data, která má výstup, nebo které byla vygenerována v rámci Hadoop úlohy spuštěné v clusteru služby HDInsight.</span><span class="sxs-lookup"><span data-stu-id="a29cf-114">Power Query can import data that has been output or that has been generated by a Hadoop job running on an HDInsight cluster.</span></span>

<span data-ttu-id="a29cf-115">V aplikaci Excel 2016 Power Query integrovány do dat pásu karet v části Get & transformace.</span><span class="sxs-lookup"><span data-stu-id="a29cf-115">In Excel 2016, Power Query has been integrated into the Data ribbon under the Get & Transform section.</span></span> <span data-ttu-id="a29cf-116">Starší verze Excelu, stáhněte si Microsoft Power Query pro Excel z [Microsoft Download Center] [ powerquery-download] a nainstalujte ji.</span><span class="sxs-lookup"><span data-stu-id="a29cf-116">For older Excel versions, download Microsoft Power Query for Excel from the [Microsoft Download Center][powerquery-download] and install it.</span></span>

## <a name="import-hdinsight-data-into-excel"></a><span data-ttu-id="a29cf-117">Importovat HDInsight data do aplikace Excel</span><span class="sxs-lookup"><span data-stu-id="a29cf-117">Import HDInsight data into Excel</span></span>
<span data-ttu-id="a29cf-118">Doplněk Power Query pro Excel lze snadno importovat data z clusteru HDInsight do Excelu, kde BI nástroje, jako je doplňku PowerPivot a mapa Power slouží ke kontrole, analyzovat a data k dispozici.</span><span class="sxs-lookup"><span data-stu-id="a29cf-118">The Power Query add-in for Excel makes it easy to import data from your HDInsight cluster into Excel, where BI tools such as PowerPivot and Power Map can be used to inspect, analyze, and present the data.</span></span>

<span data-ttu-id="a29cf-119">**Při importu dat z clusteru služby HDInsight**</span><span class="sxs-lookup"><span data-stu-id="a29cf-119">**To import data from an HDInsight cluster**</span></span>

1. <span data-ttu-id="a29cf-120">Otevřete aplikaci Excel.</span><span class="sxs-lookup"><span data-stu-id="a29cf-120">Open Excel.</span></span>
2. <span data-ttu-id="a29cf-121">Vytvoření nového prázdného sešitu.</span><span class="sxs-lookup"><span data-stu-id="a29cf-121">Create a new blank workbook.</span></span>
3. <span data-ttu-id="a29cf-122">Proveďte následující kroky založeny na verzi aplikace Excel:</span><span class="sxs-lookup"><span data-stu-id="a29cf-122">Perform the following steps based on the Excel version:</span></span>

    - <span data-ttu-id="a29cf-123">Excel 2016</span><span class="sxs-lookup"><span data-stu-id="a29cf-123">Excel 2016</span></span>

        - <span data-ttu-id="a29cf-124">Klikněte na tlačítko **Data** nabídky, klikněte na tlačítko **načíst Data** z **Get & transformace dat** pásu karet, klikněte na tlačítko **z Azure**a potom klikněte na **z Azure HDInsight(HDFS)**.</span><span class="sxs-lookup"><span data-stu-id="a29cf-124">Click the **Data** menu, click **Get Data** from the **Get & Transform Data** ribbon, click **From Azure**, and then click **From Azure HDInsight(HDFS)**.</span></span>

        ![HDI. PowerQuery.SelectHdiSource](./media/hdinsight-connect-excel-power-query/hdi.powerquery.selecthdisource.excel2016.png)

    - <span data-ttu-id="a29cf-126">Excel 2013/2010</span><span class="sxs-lookup"><span data-stu-id="a29cf-126">Excel 2013/2010</span></span>

        - <span data-ttu-id="a29cf-127">Klikněte na tlačítko **Power Query** nabídky, klikněte na tlačítko **z Azure**a potom klikněte na **z Microsoft Azure HDInsight**.</span><span class="sxs-lookup"><span data-stu-id="a29cf-127">Click the **Power Query** menu, click **From Azure**, and then click **From Microsoft Azure HDInsight**.</span></span>
   
        ![HDI. PowerQuery.SelectHdiSource][image-hdi-powerquery-hdi-source]
       
        <span data-ttu-id="a29cf-129">**Poznámka:** Pokud nevidíte **Power Query** nabídky, přejděte na **soubor** > **možnosti** > **doplňky**a vyberte **COM Doplňky** z rozevíracího seznamu **spravovat** pole v dolní části stránky.</span><span class="sxs-lookup"><span data-stu-id="a29cf-129">**Note:** If you don't see the **Power Query** menu, go to **File** > **Options** > **Add-Ins**, and select **COM Add-ins** from the drop-down **Manage** box at the bottom of the page.</span></span> <span data-ttu-id="a29cf-130">Vyberte **přejděte...**  tlačítko a ověřte, že bylo zaškrtnuté políčko pro Power Query pro doplněk aplikace Excel.</span><span class="sxs-lookup"><span data-stu-id="a29cf-130">Select the **Go...** button and verify that the box for the Power Query for Excel add-in has been checked.</span></span>
       
        <span data-ttu-id="a29cf-131">**Poznámka:** Power Query taky umožňuje importovat data z HDFS kliknutím **z jiných zdrojů**.</span><span class="sxs-lookup"><span data-stu-id="a29cf-131">**Note:** Power Query also allows you to import data from HDFS by clicking **From Other Sources**.</span></span>
4. <span data-ttu-id="a29cf-132">Pro **název účtu**, zadejte název účtu úložiště objektů Blob Azure přidruženého k vašemu clusteru a pak klikněte na tlačítko **OK**.</span><span class="sxs-lookup"><span data-stu-id="a29cf-132">For **Account Name**, enter the name of the Azure Blob storage account associated with your cluster, and then click **OK**.</span></span> <span data-ttu-id="a29cf-133">Tento účet může být [výchozí účet úložiště](hdinsight-administer-use-management-portal.md#find-the-default-storage-account) nebo propojený účet úložiště.</span><span class="sxs-lookup"><span data-stu-id="a29cf-133">This account can be the [default storage account](hdinsight-administer-use-management-portal.md#find-the-default-storage-account) or a linked storage account.</span></span>  <span data-ttu-id="a29cf-134">Formát je *https://&lt;StorageAccountName >.blob.core.windows.net/*.</span><span class="sxs-lookup"><span data-stu-id="a29cf-134">The format is *https://&lt;StorageAccountName>.blob.core.windows.net/*.</span></span>
5. <span data-ttu-id="a29cf-135">Pro **klíč účtu**, zadejte klíč pro účet úložiště Blob a pak klikněte na tlačítko **Uložit**.</span><span class="sxs-lookup"><span data-stu-id="a29cf-135">For **Account Key**, enter the key for the Blob storage account, and then click **Save**.</span></span> <span data-ttu-id="a29cf-136">(Potřebujete zadejte čas informace pouze první účet přístupu k tomuto úložišti.)</span><span class="sxs-lookup"><span data-stu-id="a29cf-136">(You need to enter the account information only the first time you access this store.)</span></span>
6. <span data-ttu-id="a29cf-137">V **Navigátor** podokna na levé straně editoru dotazů, dvakrát klikněte na název kontejneru úložiště objektů Blob.</span><span class="sxs-lookup"><span data-stu-id="a29cf-137">In the **Navigator** pane on the left of the Query Editor, double-click the Blob storage container name.</span></span> <span data-ttu-id="a29cf-138">Ve výchozím nastavení je název kontejneru stejný název jako název clusteru.</span><span class="sxs-lookup"><span data-stu-id="a29cf-138">By default, the container name is the same name as the cluster name.</span></span>
7. <span data-ttu-id="a29cf-139">Vyhledejte **HiveSampleData.txt** v **název** sloupce (je cesta ke složce **... / hive/skladu/hivesampletable/**) a potom klikněte na **binární** na levé straně HiveSampleData.txt.</span><span class="sxs-lookup"><span data-stu-id="a29cf-139">Locate **HiveSampleData.txt** in the **Name** column (the folder path is **../hive/warehouse/hivesampletable/**), and then click **Binary** on the left of HiveSampleData.txt.</span></span> <span data-ttu-id="a29cf-140">HiveSampleData.txt obsahuje všechny clusteru.</span><span class="sxs-lookup"><span data-stu-id="a29cf-140">HiveSampleData.txt comes with all the cluster.</span></span> <span data-ttu-id="a29cf-141">Volitelně můžete vytvořit svůj vlastní soubor.</span><span class="sxs-lookup"><span data-stu-id="a29cf-141">Optionally, you can use your own file.</span></span>
   
    ![HDI. PowerQuery.ImportData][image-hdi-powerquery-importdata]
8. <span data-ttu-id="a29cf-143">Pokud chcete, můžete přejmenovat názvy sloupců.</span><span class="sxs-lookup"><span data-stu-id="a29cf-143">If you want, you can rename the column names.</span></span> <span data-ttu-id="a29cf-144">Až budete připravení, klikněte na tlačítko **zavřete & načíst**.</span><span class="sxs-lookup"><span data-stu-id="a29cf-144">When you are ready, click **Close & Load**.</span></span>  <span data-ttu-id="a29cf-145">Data se načetl do vašeho sešitu:</span><span class="sxs-lookup"><span data-stu-id="a29cf-145">The data has been loaded to your workbook:</span></span>
   
    ![HDI. PowerQuery.ImportedTable][image-hdi-powerquery-imported-table]

## <a name="next-steps"></a><span data-ttu-id="a29cf-147">Další kroky</span><span class="sxs-lookup"><span data-stu-id="a29cf-147">Next steps</span></span>
<span data-ttu-id="a29cf-148">V tomto článku jste zjistili, jak k získání dat z prostředí HDInsight do aplikace Excel pomocí doplňku Power Query.</span><span class="sxs-lookup"><span data-stu-id="a29cf-148">In this article, you learned how to use Power Query to retrieve data from HDInsight into Excel.</span></span> <span data-ttu-id="a29cf-149">Podobně můžete data načíst z prostředí HDInsight do Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="a29cf-149">Similarly, you can retrieve data from HDInsight into Azure SQL Database.</span></span> <span data-ttu-id="a29cf-150">Je také možné nahrát data do HDInsight.</span><span class="sxs-lookup"><span data-stu-id="a29cf-150">It is also possible to upload data into HDInsight.</span></span> <span data-ttu-id="a29cf-151">Další informace naleznete v následujících článcích:</span><span class="sxs-lookup"><span data-stu-id="a29cf-151">To learn more, see the following articles:</span></span>

* <span data-ttu-id="a29cf-152">[Připojení aplikace Excel do HDInsight pomocí ovladače ODBC Microsoft Hive][hdinsight-ODBC]</span><span class="sxs-lookup"><span data-stu-id="a29cf-152">[Connect Excel to HDInsight with the Microsoft Hive ODBC Driver][hdinsight-ODBC]</span></span>
* <span data-ttu-id="a29cf-153">[Nahrání dat do HDInsight][hdinsight-upload-data]</span><span class="sxs-lookup"><span data-stu-id="a29cf-153">[Upload Data to HDInsight][hdinsight-upload-data]</span></span>

[hdinsight-ODBC]: hdinsight-connect-excel-hive-odbc-driver.md
[hdinsight-get-started]: hdinsight-hadoop-linux-tutorial-get-started.md
[hdinsight-upload-data]: hdinsight-upload-data.md

[image-hdi-powerquery-hdi-source]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.selecthdisource.png
[image-hdi-powerquery-importdata]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.importdata.png
[image-hdi-powerquery-imported-table]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.importedtable.PNG

[powerquery-download]: http://go.microsoft.com/fwlink/?LinkID=286689
