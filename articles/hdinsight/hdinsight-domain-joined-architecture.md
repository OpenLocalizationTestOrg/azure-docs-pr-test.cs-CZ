---
title: "připojené k aaaDomain architektura Azure HDInsight | Microsoft Docs"
description: "Zjistěte, jak tooplan doméně HDInsight."
services: hdinsight
documentationcenter: 
author: saurinsh
manager: jhubbard
editor: cgronlun
tags: azure-portal
ms.assetid: 7dc6847d-10d4-4b5c-9c83-cc513cf91965
ms.service: hdinsight
ms.custom: hdinsightactive
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 02/03/2017
ms.author: saurinsh
ms.openlocfilehash: 1c3ecedf3739b4f8fa54160225be9c1d6e2ca6cc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="plan-azure-domain-joined-hadoop-clusters-in-hdinsight"></a><span data-ttu-id="2ed70-103">Plánování clusterů Azure Hadoop připojených k doméně ve službě HDInsight</span><span class="sxs-lookup"><span data-stu-id="2ed70-103">Plan Azure domain-joined Hadoop clusters in HDInsight</span></span>

<span data-ttu-id="2ed70-104">Hello tradiční Hadoop je cluster jednoho uživatele.</span><span class="sxs-lookup"><span data-stu-id="2ed70-104">hello traditional Hadoop is a single-user cluster.</span></span> <span data-ttu-id="2ed70-105">Je vhodný pro většinu společností, které mají menší aplikační týmy sestavující úlohy velkých objemů dat.</span><span class="sxs-lookup"><span data-stu-id="2ed70-105">It is suitable for most companies that have smaller application teams building large data workloads.</span></span> <span data-ttu-id="2ed70-106">Jak Hadoop získává na oblíbenosti, mnoho podniků přechází k modelu, kdy clustery spravují IT týmy a sdílí je několik aplikačních týmů.</span><span class="sxs-lookup"><span data-stu-id="2ed70-106">As Hadoop gains popularity, many enterprises are moving toward a model in which clusters are managed by IT teams and multiple application teams share clusters.</span></span> <span data-ttu-id="2ed70-107">Proto funkce, které zahrnující clustery s více uživateli patří mezi hello nejvíce požadované funkce v Azure HDInsight.</span><span class="sxs-lookup"><span data-stu-id="2ed70-107">Thus, functionalities involving multiuser clusters are among hello most requested functionalities in Azure HDInsight.</span></span>

<span data-ttu-id="2ed70-108">Místo vytváření vlastní víceuživatelská ověřování a autorizaci, HDInsight využívá hello nejoblíbenější zprostředkovatele identity – Active Directory (AD).</span><span class="sxs-lookup"><span data-stu-id="2ed70-108">Instead of building its own multiuser authentication and authorization, HDInsight relies on hello most popular identity provider--Active Directory (AD).</span></span> <span data-ttu-id="2ed70-109">Funkce Hello efektivní zabezpečení ve službě AD může být použité toomanage víceuživatelská autorizace v HDInsight.</span><span class="sxs-lookup"><span data-stu-id="2ed70-109">hello powerful security functionality in AD can be used toomanage multiuser authorization in HDInsight.</span></span> <span data-ttu-id="2ed70-110">Integrací HDInsight s AD může komunikovat s clustery hello pomocí svých přihlašovacích údajů AD.</span><span class="sxs-lookup"><span data-stu-id="2ed70-110">By integrating HDInsight with AD, you can communicate with hello clusters by using your AD credentials.</span></span> <span data-ttu-id="2ed70-111">HDInsight mapuje uživatele tooa místní Hadoop uživatel, takže všechny hello služby spuštěné v HDInsight (Ambari, Hive serveru škálu, Spark thrift serveru a dalších) pracovní bezproblémově pro hello ověřeného uživatele.</span><span class="sxs-lookup"><span data-stu-id="2ed70-111">HDInsight maps an AD user tooa local Hadoop user, so all hello services running on HDInsight (Ambari, Hive server, Ranger, Spark thrift server, and others) work seamlessly for hello authenticated user.</span></span>

## <a name="integrate-hdinsight-with-ad-and-ad-on-iaas-vm"></a><span data-ttu-id="2ed70-112">HDInsight integrovat AD a služby AD na virtuální počítač IaaS</span><span class="sxs-lookup"><span data-stu-id="2ed70-112">Integrate HDInsight with AD and AD on IaaS VM</span></span>

<span data-ttu-id="2ed70-113">Díky integraci s Azure AD ani AD pro virtuální počítač Iaas HDInsight, jsou uzly clusteru HDInsight hello domény tooa připojený k doméně.</span><span class="sxs-lookup"><span data-stu-id="2ed70-113">By integrating HDInsight with Azure AD or AD on Iaas VM, hello HDInsight cluster nodes are domain-joined tooa domain.</span></span> <span data-ttu-id="2ed70-114">HDInsight vytvoří objekty služby pro hello Hadoop běžící v clusteru hello a umístí se do zadané organizační jednotce (OU) v Azure AD ani AD pro virtuální počítač IaaS.</span><span class="sxs-lookup"><span data-stu-id="2ed70-114">HDInsight creates service principals for hello Hadoop services running on hello cluster and places them within a specified organizational unit (OU) in Azure AD or AD on IaaS VM.</span></span> <span data-ttu-id="2ed70-115">HDInsight vytvoří také zpětné mapování DNS v doméně hello hello IP adresy hello uzlů, které jsou připojené k toohello domény.</span><span class="sxs-lookup"><span data-stu-id="2ed70-115">HDInsight also creates reverse DNS mappings in hello domain for hello IP addresses of hello nodes that are joined toohello domain.</span></span>

<span data-ttu-id="2ed70-116">Tohoto uspořádání můžete docílit pomocí několika architektur.</span><span class="sxs-lookup"><span data-stu-id="2ed70-116">You can achieve this setup by using multiple architectures.</span></span> <span data-ttu-id="2ed70-117">Můžete zvolit z následujících architektury hello.</span><span class="sxs-lookup"><span data-stu-id="2ed70-117">You can choose from hello following architectures.</span></span>

<span data-ttu-id="2ed70-118">**Integrované s AD běžících na Azure IaaS HDInsight**</span><span class="sxs-lookup"><span data-stu-id="2ed70-118">**HDInsight integrated with AD running on Azure IaaS**</span></span>

<span data-ttu-id="2ed70-119">Toto je nejjednodušší architektura hello pro HDInsight integraci se službou Active Directory.</span><span class="sxs-lookup"><span data-stu-id="2ed70-119">This is hello simplest architecture for integrating HDInsight with Active Directory.</span></span> <span data-ttu-id="2ed70-120">Hello řadič domény AD se spouští na jednu (nebo víc) virtuálních počítačů (VM) v Azure.</span><span class="sxs-lookup"><span data-stu-id="2ed70-120">hello AD domain controller runs on one (or multiple) virtual machines (VMs) in Azure.</span></span> <span data-ttu-id="2ed70-121">Tyto virtuální počítače se obvykle nacházejí v rámci virtuální sítě.</span><span class="sxs-lookup"><span data-stu-id="2ed70-121">These VMs are usually in a virtual network.</span></span> <span data-ttu-id="2ed70-122">Nastavit jinou virtuální sítí pro hello HDInsight cluster.</span><span class="sxs-lookup"><span data-stu-id="2ed70-122">You set up another virtual network for hello HDInsight cluster.</span></span> <span data-ttu-id="2ed70-123">Pro HDInsight toohave směrem pohledu tooActive Directory, je třeba toopeer tyto virtuální sítě pomocí [VNet-to-VNet peering](../virtual-network/virtual-network-create-peering.md).</span><span class="sxs-lookup"><span data-stu-id="2ed70-123">For HDInsight toohave a line of sight tooActive Directory, you need toopeer these virtual networks by using [VNet-to-VNet peering](../virtual-network/virtual-network-create-peering.md).</span></span> <span data-ttu-id="2ed70-124">Pokud vytvoříte hello služby Active Directory v ARM, pak můžete vytvořit hello služby Active Directory a HDInsight v hello stejnou virtuální síť a nepotřebujete toodo partnerský vztah.</span><span class="sxs-lookup"><span data-stu-id="2ed70-124">If you create hello Active Directory in ARM, then you can create hello Active Directory and HDInsight in hello same VNet and you don't need toodo peering.</span></span> 

![Topologie clusteru HDInsight připojeného k doméně](./media/hdinsight-domain-joined-architecture/hdinsight-domain-joined-architecture_1.png)

> [!NOTE]
> <span data-ttu-id="2ed70-126">V této architektuře nemůžete použít Azure Data Lake Store s clusterem HDInsight hello.</span><span class="sxs-lookup"><span data-stu-id="2ed70-126">In this architecture, you cannot use Azure Data Lake Store with hello HDInsight cluster.</span></span>


<span data-ttu-id="2ed70-127">Předpoklady pro službu Active Directory:</span><span class="sxs-lookup"><span data-stu-id="2ed70-127">Prerequisites for Active Directory:</span></span>

* <span data-ttu-id="2ed70-128">[Organizační jednotky](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) musí být vytvořen, v rámci které umístíte hello virtuální počítače clusteru HDInsight a hello objekty služby používá hello cluster.</span><span class="sxs-lookup"><span data-stu-id="2ed70-128">An [organizational unit](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) must be created, within which you place hello HDInsight cluster VMs and hello service principals used by hello cluster.</span></span>
* <span data-ttu-id="2ed70-129">[Protokoly přístup Lightweight Directory](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) (LDAPs) musí být nastavení pro komunikaci se službou AD.</span><span class="sxs-lookup"><span data-stu-id="2ed70-129">[Lightweight Directory Access Protocols](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) (LDAPs) must be set up for communicating with AD.</span></span> <span data-ttu-id="2ed70-130">certifikát používaný tooset Hello až LDAPS musí být skutečné certifikátu (ne certifikát podepsaný svým držitelem).</span><span class="sxs-lookup"><span data-stu-id="2ed70-130">hello certificate used tooset up LDAPS must be a real certificate (not a self-signed certificate).</span></span>
* <span data-ttu-id="2ed70-131">Zpětné zóny DNS musí být vytvořeny na hello domény pro rozsah IP adres hello hello HDInsight podsítě (například 10.2.0.0/24 na předchozím obrázku hello).</span><span class="sxs-lookup"><span data-stu-id="2ed70-131">Reverse DNS zones must be created on hello domain for hello IP address range of hello HDInsight subnet (for example, 10.2.0.0/24 in hello previous picture).</span></span>
* <span data-ttu-id="2ed70-132">Je potřeba účet služby nebo účet uživatele.</span><span class="sxs-lookup"><span data-stu-id="2ed70-132">A service account or a user account is needed.</span></span> <span data-ttu-id="2ed70-133">Použijte tento cluster HDInsight hello toocreate účtu.</span><span class="sxs-lookup"><span data-stu-id="2ed70-133">Use this account toocreate hello HDInsight cluster.</span></span> <span data-ttu-id="2ed70-134">Tento účet musí mít hello následující oprávnění:</span><span class="sxs-lookup"><span data-stu-id="2ed70-134">This account must have hello following permissions:</span></span>

    - <span data-ttu-id="2ed70-135">Hlavní objekty služby toocreate oprávnění a objekty počítačů v rámci hello organizační jednotky</span><span class="sxs-lookup"><span data-stu-id="2ed70-135">Permissions toocreate service principal objects and machine objects within hello organizational unit</span></span>
    - <span data-ttu-id="2ed70-136">Oprávnění toocreate zpětné DNS proxy pravidla</span><span class="sxs-lookup"><span data-stu-id="2ed70-136">Permissions toocreate reverse DNS proxy rules</span></span>
    - <span data-ttu-id="2ed70-137">Doménu služby Active Directory toohello počítače toojoin oprávnění</span><span class="sxs-lookup"><span data-stu-id="2ed70-137">Permissions toojoin machines toohello Active Directory domain</span></span>

<span data-ttu-id="2ed70-138">**Služba HDInsight integrovaná s výhradně cloudovou službou Azure AD**</span><span class="sxs-lookup"><span data-stu-id="2ed70-138">**HDInsight integrated with cloud-only Azure AD**</span></span>

<span data-ttu-id="2ed70-139">Pro výhradně cloudovou službu Azure AD nakonfigurujte řadič domény tak, aby HDInsight bylo možné integrovat s Azure AD.</span><span class="sxs-lookup"><span data-stu-id="2ed70-139">For cloud-only Azure AD, configure a domain controller so that HDInsight can be integrated with Azure AD.</span></span> <span data-ttu-id="2ed70-140">Toho dosáhnete pomocí [Azure Active Directory Domain Services](../active-directory-domain-services/active-directory-ds-overview.md) (Azure AD DS).</span><span class="sxs-lookup"><span data-stu-id="2ed70-140">This is achieved by using [Azure Active Directory Domain Services](../active-directory-domain-services/active-directory-ds-overview.md) (Azure AD DS).</span></span> <span data-ttu-id="2ed70-141">Azure AD DS vytvoří počítače řadiče domény v cloudu hello a poskytuje IP adresy pro ně.</span><span class="sxs-lookup"><span data-stu-id="2ed70-141">Azure AD DS creates domain controller machines on hello cloud and provides IP addresses for them.</span></span> <span data-ttu-id="2ed70-142">Kvůli vyšší dostupnosti vytvoří dva řadiče domény.</span><span class="sxs-lookup"><span data-stu-id="2ed70-142">It creates two domain controllers for high availability.</span></span>

<span data-ttu-id="2ed70-143">Azure AD DS v současné době existuje pouze v klasických virtuálních sítích.</span><span class="sxs-lookup"><span data-stu-id="2ed70-143">Currently, Azure AD DS exists only in classic virtual networks.</span></span> <span data-ttu-id="2ed70-144">Jenom je přístupné pomocí hello portál Azure classic.</span><span class="sxs-lookup"><span data-stu-id="2ed70-144">It is only accessible by using hello Azure classic portal.</span></span> <span data-ttu-id="2ed70-145">Hello HDInsight virtuální sítě existuje v hello portál Azure, který se musí toobe peered s hello klasickou virtuální síť pomocí VNet-to-VNet partnerský vztah.</span><span class="sxs-lookup"><span data-stu-id="2ed70-145">hello HDInsight virtual network exists in hello Azure portal, which needs toobe peered with hello classic virtual network by using VNet-to-VNet peering.</span></span>

> [!NOTE]
> <span data-ttu-id="2ed70-146">Partnerský vztah mezi klasickou virtuální síť a virtuální síť vyžaduje, že jsou obě virtuální sítě v Azure Resource Manageru hello stejné oblasti a v části hello stejné předplatné Azure.</span><span class="sxs-lookup"><span data-stu-id="2ed70-146">Peering between a classic virtual network and an Azure Resource Manager virtual network requires that both virtual networks are in hello same region and under hello same Azure subscription.</span></span>

![Topologie clusteru HDInsight připojeného k doméně](./media/hdinsight-domain-joined-architecture/hdinsight-domain-joined-architecture_2.png)

<span data-ttu-id="2ed70-148">Požadavky pro Azure AD:</span><span class="sxs-lookup"><span data-stu-id="2ed70-148">Prerequisites for Azure AD:</span></span>

* <span data-ttu-id="2ed70-149">[Organizační jednotky](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) musí být vytvořen v rámci které umístíte hello virtuální počítače clusteru HDInsight a hello objekty služby používá hello cluster.</span><span class="sxs-lookup"><span data-stu-id="2ed70-149">An [organizational unit](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) must be created within which you place hello HDInsight cluster VMs and hello service principals used by hello cluster.</span></span>
* <span data-ttu-id="2ed70-150">Při konfiguraci služby Azure AD DS musí být nastavený protokol [LDAPS](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md).</span><span class="sxs-lookup"><span data-stu-id="2ed70-150">[LDAPS](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) must be set up when you configure Azure AD DS.</span></span> <span data-ttu-id="2ed70-151">certifikát používaný tooset Hello až LDAPS musí být skutečné certifikátu (ne certifikát podepsaný svým držitelem).</span><span class="sxs-lookup"><span data-stu-id="2ed70-151">hello certificate used tooset up LDAPS must be a real certificate (not a self-signed certificate).</span></span>
* <span data-ttu-id="2ed70-152">Zpětné zóny DNS musí být vytvořeny na hello domény pro rozsah IP adres hello hello HDInsight podsítě (například 10.2.0.0/24 na předchozím obrázku hello).</span><span class="sxs-lookup"><span data-stu-id="2ed70-152">Reverse DNS zones must be created on hello domain for hello IP address range of hello HDInsight subnet (for example, 10.2.0.0/24 in hello previous picture).</span></span>
* <span data-ttu-id="2ed70-153">[Hodnoty hash hesla](../active-directory-domain-services/active-directory-ds-getting-started-password-sync.md) musí být synchronizované z Azure AD tooAzure služby AD DS.</span><span class="sxs-lookup"><span data-stu-id="2ed70-153">[Password hashes](../active-directory-domain-services/active-directory-ds-getting-started-password-sync.md) must be synced from Azure AD tooAzure AD DS.</span></span>
* <span data-ttu-id="2ed70-154">Je potřeba účet služby nebo účet uživatele.</span><span class="sxs-lookup"><span data-stu-id="2ed70-154">A service account or a user account is needed.</span></span> <span data-ttu-id="2ed70-155">Použijte tento cluster HDInsight hello toocreate účtu.</span><span class="sxs-lookup"><span data-stu-id="2ed70-155">Use this account toocreate hello HDInsight cluster.</span></span> <span data-ttu-id="2ed70-156">Tento účet musí mít hello následující oprávnění:</span><span class="sxs-lookup"><span data-stu-id="2ed70-156">This account must have hello following permissions:</span></span>

    - <span data-ttu-id="2ed70-157">Hlavní objekty služby toocreate oprávnění a objekty počítačů v rámci hello organizační jednotky</span><span class="sxs-lookup"><span data-stu-id="2ed70-157">Permissions toocreate service principal objects and machine objects within hello organizational unit</span></span>
    - <span data-ttu-id="2ed70-158">Oprávnění toocreate zpětné DNS proxy pravidla</span><span class="sxs-lookup"><span data-stu-id="2ed70-158">Permissions toocreate reverse DNS proxy rules</span></span>
    - <span data-ttu-id="2ed70-159">Oprávnění toojoin počítače toohello Azure AD domény</span><span class="sxs-lookup"><span data-stu-id="2ed70-159">Permissions toojoin machines toohello Azure AD domain</span></span>

## <a name="next-steps"></a><span data-ttu-id="2ed70-160">Další kroky</span><span class="sxs-lookup"><span data-stu-id="2ed70-160">Next steps</span></span>
* <span data-ttu-id="2ed70-161">tooconfigure cluster HDInsight připojený k doméně, najdete v části [nakonfigurovat připojený k doméně clusterů HDInsight](hdinsight-domain-joined-configure.md).</span><span class="sxs-lookup"><span data-stu-id="2ed70-161">tooconfigure a domain-joined HDInsight cluster, see [Configure domain-joined HDInsight clusters](hdinsight-domain-joined-configure.md).</span></span>
* <span data-ttu-id="2ed70-162">toomanage připojený k doméně clusterů HDInsight, najdete v části [Správa clusterů HDInsight připojený k doméně](hdinsight-domain-joined-manage.md).</span><span class="sxs-lookup"><span data-stu-id="2ed70-162">toomanage domain-joined HDInsight clusters, see [Manage domain-joined HDInsight clusters](hdinsight-domain-joined-manage.md).</span></span>
* <span data-ttu-id="2ed70-163">zásady tooconfigure Hive a spouštění dotazů Hive, najdete v části [konfigurace Hive zásady pro připojené k doméně clustery služby HDInsight](hdinsight-domain-joined-run-hive.md).</span><span class="sxs-lookup"><span data-stu-id="2ed70-163">tooconfigure Hive policies and run Hive queries, see [Configure Hive policies for domain-joined HDInsight clusters](hdinsight-domain-joined-run-hive.md).</span></span>
* <span data-ttu-id="2ed70-164">toorun dotazů Hive pomocí protokolu SSH na clusterech HDInsight připojený k doméně, najdete v části [použití SSH s HDInsight](hdinsight-hadoop-linux-use-ssh-unix.md).</span><span class="sxs-lookup"><span data-stu-id="2ed70-164">toorun Hive queries by using SSH on domain-joined HDInsight clusters, see [Use SSH with HDInsight](hdinsight-hadoop-linux-use-ssh-unix.md).</span></span>
