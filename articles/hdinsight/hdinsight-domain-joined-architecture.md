---
title: "Architektura Azure HDInsight připojený k doméně | Microsoft Docs"
description: "Naučte se plánovat službu HDInsight připojenou k doméně."
services: hdinsight
documentationcenter: 
author: saurinsh
manager: jhubbard
editor: cgronlun
tags: azure-portal
ms.assetid: 7dc6847d-10d4-4b5c-9c83-cc513cf91965
ms.service: hdinsight
ms.custom: hdinsightactive
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 02/03/2017
ms.author: saurinsh
ms.openlocfilehash: 7e34f47f09466a40993b4cc797ff1cad2bdaeafe
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 07/11/2017
---
# <a name="plan-azure-domain-joined-hadoop-clusters-in-hdinsight"></a><span data-ttu-id="dba5f-103">Plánování clusterů Azure Hadoop připojených k doméně ve službě HDInsight</span><span class="sxs-lookup"><span data-stu-id="dba5f-103">Plan Azure domain-joined Hadoop clusters in HDInsight</span></span>

<span data-ttu-id="dba5f-104">Tradiční Hadoop je jednouživatelský cluster.</span><span class="sxs-lookup"><span data-stu-id="dba5f-104">The traditional Hadoop is a single-user cluster.</span></span> <span data-ttu-id="dba5f-105">Je vhodný pro většinu společností, které mají menší aplikační týmy sestavující úlohy velkých objemů dat.</span><span class="sxs-lookup"><span data-stu-id="dba5f-105">It is suitable for most companies that have smaller application teams building large data workloads.</span></span> <span data-ttu-id="dba5f-106">Jak Hadoop získává na oblíbenosti, mnoho podniků přechází k modelu, kdy clustery spravují IT týmy a sdílí je několik aplikačních týmů.</span><span class="sxs-lookup"><span data-stu-id="dba5f-106">As Hadoop gains popularity, many enterprises are moving toward a model in which clusters are managed by IT teams and multiple application teams share clusters.</span></span> <span data-ttu-id="dba5f-107">Proto jsou funkce zahrnující víceuživatelské clustery mezi nejžádanějšími funkcemi ve službě Azure HDInsight.</span><span class="sxs-lookup"><span data-stu-id="dba5f-107">Thus, functionalities involving multiuser clusters are among the most requested functionalities in Azure HDInsight.</span></span>

<span data-ttu-id="dba5f-108">Místo vytváření vlastní víceuživatelská ověřování a autorizaci, HDInsight využívá nejoblíbenější zprostředkovatele identity – Active Directory (AD).</span><span class="sxs-lookup"><span data-stu-id="dba5f-108">Instead of building its own multiuser authentication and authorization, HDInsight relies on the most popular identity provider--Active Directory (AD).</span></span> <span data-ttu-id="dba5f-109">Funkci efektivní zabezpečení ve službě Active Directory lze použít ke správě více uživatelů autorizace v HDInsight.</span><span class="sxs-lookup"><span data-stu-id="dba5f-109">The powerful security functionality in AD can be used to manage multiuser authorization in HDInsight.</span></span> <span data-ttu-id="dba5f-110">Integrací HDInsight s AD může komunikovat s clustery pomocí svých přihlašovacích údajů AD.</span><span class="sxs-lookup"><span data-stu-id="dba5f-110">By integrating HDInsight with AD, you can communicate with the clusters by using your AD credentials.</span></span> <span data-ttu-id="dba5f-111">HDInsight mapuje Active Directory na místní uživatel Hadoop, takže všechny služby spuštěné v HDInsight (Ambari, Hive serveru škálu, Spark thrift serveru a dalších) pracovní bezproblémově pro ověřené uživatele.</span><span class="sxs-lookup"><span data-stu-id="dba5f-111">HDInsight maps an AD user to a local Hadoop user, so all the services running on HDInsight (Ambari, Hive server, Ranger, Spark thrift server, and others) work seamlessly for the authenticated user.</span></span>

## <a name="integrate-hdinsight-with-ad-and-ad-on-iaas-vm"></a><span data-ttu-id="dba5f-112">HDInsight integrovat AD a služby AD na virtuální počítač IaaS</span><span class="sxs-lookup"><span data-stu-id="dba5f-112">Integrate HDInsight with AD and AD on IaaS VM</span></span>

<span data-ttu-id="dba5f-113">Díky integraci s Azure AD ani AD pro virtuální počítač Iaas HDInsight, jsou uzly clusteru HDInsight, připojený k doméně.</span><span class="sxs-lookup"><span data-stu-id="dba5f-113">By integrating HDInsight with Azure AD or AD on Iaas VM, the HDInsight cluster nodes are domain-joined to a domain.</span></span> <span data-ttu-id="dba5f-114">HDInsight vytvoří objekty služby pro služby Hadoop běžící v clusteru a umístí se do zadané organizační jednotce (OU) v Azure AD ani AD pro virtuální počítač IaaS.</span><span class="sxs-lookup"><span data-stu-id="dba5f-114">HDInsight creates service principals for the Hadoop services running on the cluster and places them within a specified organizational unit (OU) in Azure AD or AD on IaaS VM.</span></span> <span data-ttu-id="dba5f-115">HDInsight vytvoří také zpětné mapování DNS v doméně pro IP adresy uzly, které jsou připojené k doméně.</span><span class="sxs-lookup"><span data-stu-id="dba5f-115">HDInsight also creates reverse DNS mappings in the domain for the IP addresses of the nodes that are joined to the domain.</span></span>

<span data-ttu-id="dba5f-116">Tohoto uspořádání můžete docílit pomocí několika architektur.</span><span class="sxs-lookup"><span data-stu-id="dba5f-116">You can achieve this setup by using multiple architectures.</span></span> <span data-ttu-id="dba5f-117">Můžete si vybrat z následujících architektur.</span><span class="sxs-lookup"><span data-stu-id="dba5f-117">You can choose from the following architectures.</span></span>

<span data-ttu-id="dba5f-118">**Integrované s AD běžících na Azure IaaS HDInsight**</span><span class="sxs-lookup"><span data-stu-id="dba5f-118">**HDInsight integrated with AD running on Azure IaaS**</span></span>

<span data-ttu-id="dba5f-119">Toto je nejjednodušší architektura pro integraci služby HDInsight s Active Directory.</span><span class="sxs-lookup"><span data-stu-id="dba5f-119">This is the simplest architecture for integrating HDInsight with Active Directory.</span></span> <span data-ttu-id="dba5f-120">Řadič domény AD běží na jednu (nebo víc) virtuálních počítačů (VM) v Azure.</span><span class="sxs-lookup"><span data-stu-id="dba5f-120">The AD domain controller runs on one (or multiple) virtual machines (VMs) in Azure.</span></span> <span data-ttu-id="dba5f-121">Tyto virtuální počítače se obvykle nacházejí v rámci virtuální sítě.</span><span class="sxs-lookup"><span data-stu-id="dba5f-121">These VMs are usually in a virtual network.</span></span> <span data-ttu-id="dba5f-122">Vytvoříte další virtuální síť pro cluster HDInsight.</span><span class="sxs-lookup"><span data-stu-id="dba5f-122">You set up another virtual network for the HDInsight cluster.</span></span> <span data-ttu-id="dba5f-123">Pro HDInsight tak, aby měl směrem pohledu do služby Active Directory, budete muset peer tyto virtuální sítě pomocí [VNet-to-VNet peering](../virtual-network/virtual-network-create-peering.md).</span><span class="sxs-lookup"><span data-stu-id="dba5f-123">For HDInsight to have a line of sight to Active Directory, you need to peer these virtual networks by using [VNet-to-VNet peering](../virtual-network/virtual-network-create-peering.md).</span></span> <span data-ttu-id="dba5f-124">Pokud vytvoříte služby Active Directory v ARM, potom můžete vytvořit služby Active Directory a prostředí HDInsight ve stejné virtuální síti a vy nemusíte dělat partnerský vztah.</span><span class="sxs-lookup"><span data-stu-id="dba5f-124">If you create the Active Directory in ARM, then you can create the Active Directory and HDInsight in the same VNet and you don't need to do peering.</span></span> 

![Topologie clusteru HDInsight připojeného k doméně](./media/hdinsight-domain-joined-architecture/hdinsight-domain-joined-architecture_1.png)

> [!NOTE]
> <span data-ttu-id="dba5f-126">V této architektuře nemůžete použít Azure Data Lake Store s clusterem HDInsight.</span><span class="sxs-lookup"><span data-stu-id="dba5f-126">In this architecture, you cannot use Azure Data Lake Store with the HDInsight cluster.</span></span>


<span data-ttu-id="dba5f-127">Předpoklady pro službu Active Directory:</span><span class="sxs-lookup"><span data-stu-id="dba5f-127">Prerequisites for Active Directory:</span></span>

* <span data-ttu-id="dba5f-128">Musí být vytvořená [organizační jednotka](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md), ve které umístíte virtuální počítače clusteru HDInsight a instanční objekty používané clusterem.</span><span class="sxs-lookup"><span data-stu-id="dba5f-128">An [organizational unit](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) must be created, within which you place the HDInsight cluster VMs and the service principals used by the cluster.</span></span>
* <span data-ttu-id="dba5f-129">[Protokoly přístup Lightweight Directory](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) (LDAPs) musí být nastavení pro komunikaci se službou AD.</span><span class="sxs-lookup"><span data-stu-id="dba5f-129">[Lightweight Directory Access Protocols](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) (LDAPs) must be set up for communicating with AD.</span></span> <span data-ttu-id="dba5f-130">Certifikát použitý k nastavení protokolu LDAPS musí být skutečný certifikát (ne certifikát podepsaný svým držitelem).</span><span class="sxs-lookup"><span data-stu-id="dba5f-130">The certificate used to set up LDAPS must be a real certificate (not a self-signed certificate).</span></span>
* <span data-ttu-id="dba5f-131">V doméně musí být vytvořené reverzní zóny DNS pro rozsah IP adres podsítě HDInsight (například 10.2.0.0/24 na předchozím obrázku).</span><span class="sxs-lookup"><span data-stu-id="dba5f-131">Reverse DNS zones must be created on the domain for the IP address range of the HDInsight subnet (for example, 10.2.0.0/24 in the previous picture).</span></span>
* <span data-ttu-id="dba5f-132">Je potřeba účet služby nebo účet uživatele.</span><span class="sxs-lookup"><span data-stu-id="dba5f-132">A service account or a user account is needed.</span></span> <span data-ttu-id="dba5f-133">Pomocí tohoto účtu vytvoříte cluster HDInsight.</span><span class="sxs-lookup"><span data-stu-id="dba5f-133">Use this account to create the HDInsight cluster.</span></span> <span data-ttu-id="dba5f-134">Tento účet musí mít následující oprávnění:</span><span class="sxs-lookup"><span data-stu-id="dba5f-134">This account must have the following permissions:</span></span>

    - <span data-ttu-id="dba5f-135">Oprávnění k vytvoření instančních objektů a objektů počítačů v rámci organizační jednotky</span><span class="sxs-lookup"><span data-stu-id="dba5f-135">Permissions to create service principal objects and machine objects within the organizational unit</span></span>
    - <span data-ttu-id="dba5f-136">Oprávnění k vytvoření pravidel reverzního proxy serveru DNS</span><span class="sxs-lookup"><span data-stu-id="dba5f-136">Permissions to create reverse DNS proxy rules</span></span>
    - <span data-ttu-id="dba5f-137">Oprávnění k připojení počítačů k doméně služby Active Directory</span><span class="sxs-lookup"><span data-stu-id="dba5f-137">Permissions to join machines to the Active Directory domain</span></span>

<span data-ttu-id="dba5f-138">**Služba HDInsight integrovaná s výhradně cloudovou službou Azure AD**</span><span class="sxs-lookup"><span data-stu-id="dba5f-138">**HDInsight integrated with cloud-only Azure AD**</span></span>

<span data-ttu-id="dba5f-139">Pro výhradně cloudovou službu Azure AD nakonfigurujte řadič domény tak, aby HDInsight bylo možné integrovat s Azure AD.</span><span class="sxs-lookup"><span data-stu-id="dba5f-139">For cloud-only Azure AD, configure a domain controller so that HDInsight can be integrated with Azure AD.</span></span> <span data-ttu-id="dba5f-140">Toho dosáhnete pomocí [Azure Active Directory Domain Services](../active-directory-domain-services/active-directory-ds-overview.md) (Azure AD DS).</span><span class="sxs-lookup"><span data-stu-id="dba5f-140">This is achieved by using [Azure Active Directory Domain Services](../active-directory-domain-services/active-directory-ds-overview.md) (Azure AD DS).</span></span> <span data-ttu-id="dba5f-141">Azure AD DS vytvoří počítače řadiče domény v cloudu a poskytne vám jejich IP adresy.</span><span class="sxs-lookup"><span data-stu-id="dba5f-141">Azure AD DS creates domain controller machines on the cloud and provides IP addresses for them.</span></span> <span data-ttu-id="dba5f-142">Kvůli vyšší dostupnosti vytvoří dva řadiče domény.</span><span class="sxs-lookup"><span data-stu-id="dba5f-142">It creates two domain controllers for high availability.</span></span>

<span data-ttu-id="dba5f-143">Azure AD DS v současné době existuje pouze v klasických virtuálních sítích.</span><span class="sxs-lookup"><span data-stu-id="dba5f-143">Currently, Azure AD DS exists only in classic virtual networks.</span></span> <span data-ttu-id="dba5f-144">Je dostupná jenom pomocí portálu Azure Classic.</span><span class="sxs-lookup"><span data-stu-id="dba5f-144">It is only accessible by using the Azure classic portal.</span></span> <span data-ttu-id="dba5f-145">Virtuální síť HDInsight existuje na webu Azure Portal, takže bude potřeba vytvořit partnerský vztah dvou virtuálních sítí s klasickou virtuální sítí.</span><span class="sxs-lookup"><span data-stu-id="dba5f-145">The HDInsight virtual network exists in the Azure portal, which needs to be peered with the classic virtual network by using VNet-to-VNet peering.</span></span>

> [!NOTE]
> <span data-ttu-id="dba5f-146">Partnerský vztah mezi klasickou virtuální sítí a virtuální sítí Azure Resource Manageru vyžaduje, aby obě virtuální sítě byly ve stejné oblasti a obě spadaly pod stejné předplatné Azure.</span><span class="sxs-lookup"><span data-stu-id="dba5f-146">Peering between a classic virtual network and an Azure Resource Manager virtual network requires that both virtual networks are in the same region and under the same Azure subscription.</span></span>

![Topologie clusteru HDInsight připojeného k doméně](./media/hdinsight-domain-joined-architecture/hdinsight-domain-joined-architecture_2.png)

<span data-ttu-id="dba5f-148">Požadavky pro Azure AD:</span><span class="sxs-lookup"><span data-stu-id="dba5f-148">Prerequisites for Azure AD:</span></span>

* <span data-ttu-id="dba5f-149">Musí být vytvořená [organizační jednotka](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md), ve které umístíte virtuální počítače clusteru HDInsight a instanční objekty používané clusterem.</span><span class="sxs-lookup"><span data-stu-id="dba5f-149">An [organizational unit](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) must be created within which you place the HDInsight cluster VMs and the service principals used by the cluster.</span></span>
* <span data-ttu-id="dba5f-150">Při konfiguraci služby Azure AD DS musí být nastavený protokol [LDAPS](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md).</span><span class="sxs-lookup"><span data-stu-id="dba5f-150">[LDAPS](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) must be set up when you configure Azure AD DS.</span></span> <span data-ttu-id="dba5f-151">Certifikát použitý k nastavení protokolu LDAPS musí být skutečný certifikát (ne certifikát podepsaný svým držitelem).</span><span class="sxs-lookup"><span data-stu-id="dba5f-151">The certificate used to set up LDAPS must be a real certificate (not a self-signed certificate).</span></span>
* <span data-ttu-id="dba5f-152">V doméně musí být vytvořené reverzní zóny DNS pro rozsah IP adres podsítě HDInsight (například 10.2.0.0/24 na předchozím obrázku).</span><span class="sxs-lookup"><span data-stu-id="dba5f-152">Reverse DNS zones must be created on the domain for the IP address range of the HDInsight subnet (for example, 10.2.0.0/24 in the previous picture).</span></span>
* <span data-ttu-id="dba5f-153">Musí se synchronizovat [hodnoty hash hesel](../active-directory-domain-services/active-directory-ds-getting-started-password-sync.md) ze služby Azure AD do Azure AD DS.</span><span class="sxs-lookup"><span data-stu-id="dba5f-153">[Password hashes](../active-directory-domain-services/active-directory-ds-getting-started-password-sync.md) must be synced from Azure AD to Azure AD DS.</span></span>
* <span data-ttu-id="dba5f-154">Je potřeba účet služby nebo účet uživatele.</span><span class="sxs-lookup"><span data-stu-id="dba5f-154">A service account or a user account is needed.</span></span> <span data-ttu-id="dba5f-155">Pomocí tohoto účtu vytvoříte cluster HDInsight.</span><span class="sxs-lookup"><span data-stu-id="dba5f-155">Use this account to create the HDInsight cluster.</span></span> <span data-ttu-id="dba5f-156">Tento účet musí mít následující oprávnění:</span><span class="sxs-lookup"><span data-stu-id="dba5f-156">This account must have the following permissions:</span></span>

    - <span data-ttu-id="dba5f-157">Oprávnění k vytvoření instančních objektů a objektů počítačů v rámci organizační jednotky</span><span class="sxs-lookup"><span data-stu-id="dba5f-157">Permissions to create service principal objects and machine objects within the organizational unit</span></span>
    - <span data-ttu-id="dba5f-158">Oprávnění k vytvoření pravidel reverzního proxy serveru DNS</span><span class="sxs-lookup"><span data-stu-id="dba5f-158">Permissions to create reverse DNS proxy rules</span></span>
    - <span data-ttu-id="dba5f-159">Oprávnění k připojení počítačů k doméně služby Azure AD</span><span class="sxs-lookup"><span data-stu-id="dba5f-159">Permissions to join machines to the Azure AD domain</span></span>

## <a name="next-steps"></a><span data-ttu-id="dba5f-160">Další kroky</span><span class="sxs-lookup"><span data-stu-id="dba5f-160">Next steps</span></span>
* <span data-ttu-id="dba5f-161">Pokud chcete konfigurovat cluster HDInsight připojený k doméně, přečtěte si téma [Konfigurace clusterů HDInsight připojených k doméně](hdinsight-domain-joined-configure.md).</span><span class="sxs-lookup"><span data-stu-id="dba5f-161">To configure a domain-joined HDInsight cluster, see [Configure domain-joined HDInsight clusters](hdinsight-domain-joined-configure.md).</span></span>
* <span data-ttu-id="dba5f-162">Pokud chcete spravovat clustery HDInsight připojené k doméně, přečtěte si téma [Správa clusterů HDInsight připojených k doméně](hdinsight-domain-joined-manage.md).</span><span class="sxs-lookup"><span data-stu-id="dba5f-162">To manage domain-joined HDInsight clusters, see [Manage domain-joined HDInsight clusters](hdinsight-domain-joined-manage.md).</span></span>
* <span data-ttu-id="dba5f-163">Pokud chcete konfigurovat zásady Hivu a spouštět dotazy Hivu, přečtěte si téma [Konfigurace zásad Hivu pro clustery HDInsight připojené k doméně](hdinsight-domain-joined-run-hive.md).</span><span class="sxs-lookup"><span data-stu-id="dba5f-163">To configure Hive policies and run Hive queries, see [Configure Hive policies for domain-joined HDInsight clusters](hdinsight-domain-joined-run-hive.md).</span></span>
* <span data-ttu-id="dba5f-164">Ke spouštění dotazů Hive pomocí protokolu SSH na doméně clusterů HDInsight, najdete v části [použití SSH s HDInsight](hdinsight-hadoop-linux-use-ssh-unix.md).</span><span class="sxs-lookup"><span data-stu-id="dba5f-164">To run Hive queries by using SSH on domain-joined HDInsight clusters, see [Use SSH with HDInsight](hdinsight-hadoop-linux-use-ssh-unix.md).</span></span>
