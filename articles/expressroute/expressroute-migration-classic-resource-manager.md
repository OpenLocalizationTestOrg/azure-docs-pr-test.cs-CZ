---
title: "Migrovat ExpressRoute přidružené virtuální sítě z classic do Resource Manager: Azure: prostředí PowerShell | Microsoft Docs"
description: "Tato stránka popisuje, jak migrovat přidružený virtuálních sítí do Resource Manager po přesunutí okruhu."
documentationcenter: na
services: expressroute
author: ganesr
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 
ms.service: expressroute
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 07/06/2017
ms.author: ganesr;cherylmc
ms.openlocfilehash: 964ea38569062a7127f60dd6309b328db263bf6f
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/03/2017
---
# <a name="migrate-expressroute-associated-virtual-networks-from-classic-to-resource-manager"></a><span data-ttu-id="3dc04-103">Migrovat ExpressRoute přidružené virtuální sítě z classic do Resource Manager</span><span class="sxs-lookup"><span data-stu-id="3dc04-103">Migrate ExpressRoute associated virtual networks from classic to Resource Manager</span></span>

<span data-ttu-id="3dc04-104">Tento článek vysvětluje, jak migrovat virtuálních sítí Azure ExpressRoute přidružené z modelu nasazení classic do modelu nasazení Azure Resource Manager po přesunutí okruhu ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="3dc04-104">This article explains how to migrate Azure ExpressRoute associated virtual networks from the classic deployment model to the Azure Resource Manager deployment model after moving your ExpressRoute circuit.</span></span> 


## <a name="before-you-begin"></a><span data-ttu-id="3dc04-105">Než začnete</span><span class="sxs-lookup"><span data-stu-id="3dc04-105">Before you begin</span></span>
* <span data-ttu-id="3dc04-106">Ověřte, zda máte nejnovější verzi modulů prostředí Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="3dc04-106">Verify that you have the latest version of the Azure PowerShell modules.</span></span> <span data-ttu-id="3dc04-107">Další informace najdete v tématu [Instalace a konfigurace Azure PowerShellu](/powershell/azure/overview).</span><span class="sxs-lookup"><span data-stu-id="3dc04-107">For more information, see [How to install and configure Azure PowerShell](/powershell/azure/overview).</span></span>
* <span data-ttu-id="3dc04-108">Ujistěte se, že jste si přečetli [požadavky](expressroute-prerequisites.md), [požadavky na směrování](expressroute-routing.md), a [pracovních](expressroute-workflows.md) před zahájením konfigurace.</span><span class="sxs-lookup"><span data-stu-id="3dc04-108">Make sure that you have reviewed the [prerequisites](expressroute-prerequisites.md), [routing requirements](expressroute-routing.md), and [workflows](expressroute-workflows.md) before you begin configuration.</span></span>
* <span data-ttu-id="3dc04-109">Zkontrolujte informace, které jsou poskytovány na základě [přesun okruhu ExpressRoute z classic do Resource Manager](expressroute-move.md).</span><span class="sxs-lookup"><span data-stu-id="3dc04-109">Review the information that is provided under [Moving an ExpressRoute circuit from classic to Resource Manager](expressroute-move.md).</span></span> <span data-ttu-id="3dc04-110">Ujistěte se, že rozumíte plně limity a omezení.</span><span class="sxs-lookup"><span data-stu-id="3dc04-110">Make sure that you fully understand the limits and limitations.</span></span>
* <span data-ttu-id="3dc04-111">Ověřte, že je okruh v modelu nasazení classic plně funkční.</span><span class="sxs-lookup"><span data-stu-id="3dc04-111">Verify that the circuit is fully operational in the classic deployment model.</span></span>
* <span data-ttu-id="3dc04-112">Ujistěte se, že máte skupinu prostředků, který byl vytvořen v modelu nasazení Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="3dc04-112">Ensure that you have a resource group that was created in the Resource Manager deployment model.</span></span>
* <span data-ttu-id="3dc04-113">Přečtěte si následující dokumentaci k migraci prostředků:</span><span class="sxs-lookup"><span data-stu-id="3dc04-113">Review the following resource-migration documentation:</span></span>

    * [<span data-ttu-id="3dc04-114">Platforma podporovaná migrace z klasického do Azure Resource Manageru prostředků IaaS</span><span class="sxs-lookup"><span data-stu-id="3dc04-114">Platform-supported migration of IaaS resources from classic to Azure Resource Manager</span></span>](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager.md)
    * [<span data-ttu-id="3dc04-115">Technické podrobné informace o platformy podporované migrace z klasického do Azure Resource Manageru</span><span class="sxs-lookup"><span data-stu-id="3dc04-115">Technical deep dive on platform-supported migration from classic to Azure Resource Manager</span></span>](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager-deep-dive.md)
    * [<span data-ttu-id="3dc04-116">Nejčastější dotazy: Migrace z klasického do Azure Resource Manageru prostředky infrastruktury podporované platformy</span><span class="sxs-lookup"><span data-stu-id="3dc04-116">FAQs: Platform-supported migration of IaaS resources from classic to Azure Resource Manager</span></span>](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager.md)
    * [<span data-ttu-id="3dc04-117">Zkontrolujte nejběžnějších chyb, migrace a jejich zmírnění</span><span class="sxs-lookup"><span data-stu-id="3dc04-117">Review most common migration errors and mitigations</span></span>](../virtual-machines/windows/migration-classic-resource-manager-errors.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)

## <a name="supported-and-unsupported-scenarios"></a><span data-ttu-id="3dc04-118">Podporované a nepodporované scénáře</span><span class="sxs-lookup"><span data-stu-id="3dc04-118">Supported and unsupported scenarios</span></span>

* <span data-ttu-id="3dc04-119">Okruh ExpressRoute můžete přesunout z klasického správce prostředků prostředí bez odstávky.</span><span class="sxs-lookup"><span data-stu-id="3dc04-119">An ExpressRoute circuit can be moved from the classic to the Resource Manager environment without any downtime.</span></span> <span data-ttu-id="3dc04-120">Jakýkoli okruh ExpressRoute můžete přesunout z classic do Resource Manager prostředí bez výpadků.</span><span class="sxs-lookup"><span data-stu-id="3dc04-120">You can move any ExpressRoute circuit from the classic to the Resource Manager environment with no downtime.</span></span> <span data-ttu-id="3dc04-121">Postupujte podle pokynů v [přesun okruhů ExpressRoute z klasického modelu nasazení Resource Manager pomocí prostředí PowerShell](expressroute-howto-move-arm.md).</span><span class="sxs-lookup"><span data-stu-id="3dc04-121">Follow the instructions in [moving ExpressRoute circuits from the classic to the Resource Manager deployment model using PowerShell](expressroute-howto-move-arm.md).</span></span> <span data-ttu-id="3dc04-122">Toto je předpokladem pro přesunout prostředky, které jsou připojené k virtuální síti.</span><span class="sxs-lookup"><span data-stu-id="3dc04-122">This is a prerequisite to move resources connected to the virtual network.</span></span>
* <span data-ttu-id="3dc04-123">Virtuální sítě, bran a související nasazení v rámci virtuální sítě, které jsou připojené k okruhu ExpressRoute v rámci stejného předplatného, mohou být migrovány do prostředí Resource Manager bez odstávky.</span><span class="sxs-lookup"><span data-stu-id="3dc04-123">Virtual networks, gateways, and associated deployments within the virtual network that are attached to an ExpressRoute circuit in the same subscription can be migrated to the Resource Manager environment without any downtime.</span></span> <span data-ttu-id="3dc04-124">Můžete provést kroky popsané dál migrovat prostředkům, například virtuální sítě, bran a virtuálních počítačů nasazených v rámci virtuální sítě.</span><span class="sxs-lookup"><span data-stu-id="3dc04-124">You can follow the steps described later to migrate resources such as virtual networks, gateways, and virtual machines deployed within the virtual network.</span></span> <span data-ttu-id="3dc04-125">Je nutné zajistit, že virtuální sítě jsou správně nakonfigurovaná, před jejich migrací.</span><span class="sxs-lookup"><span data-stu-id="3dc04-125">You must ensure that the virtual networks are configured correctly before they are migrated.</span></span> 
* <span data-ttu-id="3dc04-126">Virtuální sítě, bran a související nasazení v rámci virtuální sítě, které nejsou ve stejném předplatném jako okruh ExpressRoute vyžadují výpadky k dokončení migrace.</span><span class="sxs-lookup"><span data-stu-id="3dc04-126">Virtual networks, gateways, and associated deployments within the virtual network that are not in the same subscription as the ExpressRoute circuit require some downtime to complete the migration.</span></span> <span data-ttu-id="3dc04-127">Poslední část dokumentu popisuje kroky pro migraci prostředků.</span><span class="sxs-lookup"><span data-stu-id="3dc04-127">The last section of the document describes the steps to be followed to migrate resources.</span></span>
* <span data-ttu-id="3dc04-128">Nelze migrovat virtuální síť s bránu ExpressRoute i bránu VPN.</span><span class="sxs-lookup"><span data-stu-id="3dc04-128">A virtual network with both ExpressRoute Gateway and VPN Gateway can't be migrated.</span></span>

## <a name="move-an-expressroute-circuit-from-classic-to-resource-manager"></a><span data-ttu-id="3dc04-129">Přesun okruhu ExpressRoute z classic do Resource Manager</span><span class="sxs-lookup"><span data-stu-id="3dc04-129">Move an ExpressRoute circuit from classic to Resource Manager</span></span>
<span data-ttu-id="3dc04-130">Okruh ExpressRoute z klasického je třeba přesunout do prostředí Resource Manager předtím, než se pokusíte migrovat prostředky, které jsou připojené k okruhu ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="3dc04-130">You must move an ExpressRoute circuit from the classic to the Resource Manager environment before you try to migrate resources that are attached to the ExpressRoute circuit.</span></span> <span data-ttu-id="3dc04-131">K provedení této úlohy, najdete v následujících článcích:</span><span class="sxs-lookup"><span data-stu-id="3dc04-131">To accomplish this task, see the following articles:</span></span>

* <span data-ttu-id="3dc04-132">Zkontrolujte informace, které jsou poskytovány na základě [přesun okruhu ExpressRoute z classic do Resource Manager](expressroute-move.md).</span><span class="sxs-lookup"><span data-stu-id="3dc04-132">Review the information that is provided under [Moving an ExpressRoute circuit from classic to Resource Manager](expressroute-move.md).</span></span>
* <span data-ttu-id="3dc04-133">[Přesun okruhu z classic do Resource Manager pomocí Azure PowerShell](expressroute-howto-move-arm.md).</span><span class="sxs-lookup"><span data-stu-id="3dc04-133">[Move a circuit from classic to Resource Manager using Azure PowerShell](expressroute-howto-move-arm.md).</span></span>
* <span data-ttu-id="3dc04-134">Pomocí portálu pro správu služby Azure.</span><span class="sxs-lookup"><span data-stu-id="3dc04-134">Use the Azure Service Management portal.</span></span> <span data-ttu-id="3dc04-135">Můžete postupovat podle pracovního postupu [vytvořit nové okruh ExpressRoute](expressroute-howto-circuit-portal-resource-manager.md) a zvolte možnost importovat.</span><span class="sxs-lookup"><span data-stu-id="3dc04-135">You can follow the workflow to [create a new ExpressRoute circuit](expressroute-howto-circuit-portal-resource-manager.md) and select the import option.</span></span> 

<span data-ttu-id="3dc04-136">Tato operace nezahrnuje výpadku.</span><span class="sxs-lookup"><span data-stu-id="3dc04-136">This operation does not involve downtime.</span></span> <span data-ttu-id="3dc04-137">Můžete pokračovat k přenosu dat mezi vaší místní a společnosti Microsoft, když probíhá migrace.</span><span class="sxs-lookup"><span data-stu-id="3dc04-137">You can continue to transfer data between your premises and Microsoft while the migration is in progress.</span></span>

## <a name="migrate-virtual-networks-gateways-and-associated-deployments"></a><span data-ttu-id="3dc04-138">Migrovat virtuální sítě, bran a související nasazení</span><span class="sxs-lookup"><span data-stu-id="3dc04-138">Migrate virtual networks, gateways, and associated deployments</span></span>

<span data-ttu-id="3dc04-139">Kroky, které při migraci závisí na tom, jestli vaše prostředky jsou ve stejném předplatném a různých předplatných.</span><span class="sxs-lookup"><span data-stu-id="3dc04-139">The steps you follow to migrate depend on whether your resources are in the same subscription, different subscriptions, or both.</span></span>

### <a name="migrate-virtual-networks-gateways-and-associated-deployments-in-the-same-subscription-as-the-expressroute-circuit"></a><span data-ttu-id="3dc04-140">Migrovat virtuální sítě, bran a související nasazení ve stejném předplatném jako okruh ExpressRoute</span><span class="sxs-lookup"><span data-stu-id="3dc04-140">Migrate virtual networks, gateways, and associated deployments in the same subscription as the ExpressRoute circuit</span></span>
<span data-ttu-id="3dc04-141">Tato část popisuje kroky pro migraci virtuální sítě, bránu a přidružené nasazení ve stejném předplatném jako okruh ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="3dc04-141">This section describes the steps to be followed to migrate a virtual network, gateway, and associated deployments in the same subscription as the ExpressRoute circuit.</span></span> <span data-ttu-id="3dc04-142">Odstávka je přidružen k této migrace.</span><span class="sxs-lookup"><span data-stu-id="3dc04-142">No downtime is associated with this migration.</span></span> <span data-ttu-id="3dc04-143">Můžete nadále používat všechny prostředky prostřednictvím procesu migrace.</span><span class="sxs-lookup"><span data-stu-id="3dc04-143">You can continue to use all resources through the migration process.</span></span> <span data-ttu-id="3dc04-144">Správu roviny uzamčeno, když probíhá migrace.</span><span class="sxs-lookup"><span data-stu-id="3dc04-144">The management plane is locked while the migration is in progress.</span></span> 

1. <span data-ttu-id="3dc04-145">Ujistěte se, že okruh ExpressRoute byl přesunut z klasického prostředí Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="3dc04-145">Ensure that the ExpressRoute circuit has been moved from the classic to the Resource Manager environment.</span></span>
2. <span data-ttu-id="3dc04-146">Ujistěte se, jestli virtuální sítě má správně připravené pro migraci.</span><span class="sxs-lookup"><span data-stu-id="3dc04-146">Ensure that the virtual network has been prepared appropriately for the migration.</span></span>
3. <span data-ttu-id="3dc04-147">Registrace předplatného pro migraci prostředků.</span><span class="sxs-lookup"><span data-stu-id="3dc04-147">Register your subscription for resource migration.</span></span> <span data-ttu-id="3dc04-148">Chcete-li zaregistrovat předplatné pro migraci prostředků, použijte následující fragment kódu prostředí PowerShell:</span><span class="sxs-lookup"><span data-stu-id="3dc04-148">To register your subscription for resource migration, use the following PowerShell snippet:</span></span>

  ```powershell 
  Select-AzureRmSubscription -SubscriptionName <Your Subscription Name>
  Register-AzureRmResourceProvider -ProviderNamespace Microsoft.ClassicInfrastructureMigrate
  Get-AzureRmResourceProvider -ProviderNamespace Microsoft.ClassicInfrastructureMigrate
  ```
4. <span data-ttu-id="3dc04-149">Ověření, přípravě a migrovat.</span><span class="sxs-lookup"><span data-stu-id="3dc04-149">Validate, prepare, and migrate.</span></span> <span data-ttu-id="3dc04-150">Chcete-li přesunout virtuální síť, použijte následující fragment kódu prostředí PowerShell:</span><span class="sxs-lookup"><span data-stu-id="3dc04-150">To move the virtual network, use the following PowerShell snippet:</span></span>

  ```powershell
  Move-AzureVirtualNetwork -Prepare $vnetName  
  Move-AzureVirtualNetwork -Commit $vnetName
  ```

  <span data-ttu-id="3dc04-151">Migrace může přerušit také spuštěním následující rutiny prostředí PowerShell:</span><span class="sxs-lookup"><span data-stu-id="3dc04-151">You can also abort migration by running the following PowerShell cmdlet:</span></span>

  ```powershell
  Move-AzureVirtualNetwork -Abort $vnetName
  ```

## <a name="next-steps"></a><span data-ttu-id="3dc04-152">Další kroky</span><span class="sxs-lookup"><span data-stu-id="3dc04-152">Next steps</span></span>
* [<span data-ttu-id="3dc04-153">Platforma podporovaná migrace z klasického do Azure Resource Manageru prostředků IaaS</span><span class="sxs-lookup"><span data-stu-id="3dc04-153">Platform-supported migration of IaaS resources from classic to Azure Resource Manager</span></span>](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager.md)
* [<span data-ttu-id="3dc04-154">Technické podrobné informace o platformy podporované migrace z klasického do Azure Resource Manageru</span><span class="sxs-lookup"><span data-stu-id="3dc04-154">Technical deep dive on platform-supported migration from classic to Azure Resource Manager</span></span>](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager-deep-dive.md)
* [<span data-ttu-id="3dc04-155">Nejčastější dotazy: Migrace z klasického do Azure Resource Manageru prostředky infrastruktury podporované platformy</span><span class="sxs-lookup"><span data-stu-id="3dc04-155">FAQs: Platform-supported migration of IaaS resources from classic to Azure Resource Manager</span></span>](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager.md)
* [<span data-ttu-id="3dc04-156">Zkontrolujte nejběžnějších chyb, migrace a jejich zmírnění</span><span class="sxs-lookup"><span data-stu-id="3dc04-156">Review most common migration errors and mitigations</span></span>](../virtual-machines/windows/migration-classic-resource-manager-errors.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)
