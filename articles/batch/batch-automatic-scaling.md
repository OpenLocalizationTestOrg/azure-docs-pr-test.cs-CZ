---
title: "aaaAutomatically škálování výpočetních uzlů ve fondu Azure Batch | Microsoft Docs"
description: "Povolit automatické škálování na toodynamically fondu cloudu upravit hello počet výpočetních uzlů ve fondu hello."
services: batch
documentationcenter: 
author: tamram
manager: timlt
editor: tysonn
ms.assetid: c624cdfc-c5f2-4d13-a7d7-ae080833b779
ms.service: batch
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: multiple
ms.date: 06/20/2017
ms.author: tamram
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: b6d1e0c5d8e0e56e15a4d3588150f2466a689f19
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="create-an-automatic-scaling-formula-for-scaling-compute-nodes-in-a-batch-pool"></a><span data-ttu-id="f96cb-103">Vytvořit automatické škálování vzorec škálování výpočetních uzlů ve fondu služby Batch</span><span class="sxs-lookup"><span data-stu-id="f96cb-103">Create an automatic scaling formula for scaling compute nodes in a Batch pool</span></span>

<span data-ttu-id="f96cb-104">Azure Batch může automaticky škálovat fondů na základě parametrů, které definujete.</span><span class="sxs-lookup"><span data-stu-id="f96cb-104">Azure Batch can automatically scale pools based on parameters that you define.</span></span> <span data-ttu-id="f96cb-105">Automatické škálování, uzly tooa fondu Batch dynamicky přidá jako zvýšení požadavky úloh a odebere výpočetní uzly, jak se snížit.</span><span class="sxs-lookup"><span data-stu-id="f96cb-105">With automatic scaling, Batch dynamically adds nodes tooa pool as task demands increase, and removes compute nodes as they decrease.</span></span> <span data-ttu-id="f96cb-106">Čas a peníze můžete uložit tak, že automaticky upraví hello počet výpočetních uzlů, které používá vaše aplikace Batch.</span><span class="sxs-lookup"><span data-stu-id="f96cb-106">You can save both time and money by automatically adjusting hello number of compute nodes used by your Batch application.</span></span> 

<span data-ttu-id="f96cb-107">Povolit automatické škálování ve fondu výpočetních uzlů tím, že přidružíte ho *vzorec škálování* , které definujete.</span><span class="sxs-lookup"><span data-stu-id="f96cb-107">You enable automatic scaling on a pool of compute nodes by associating with it an *autoscale formula* that you define.</span></span> <span data-ttu-id="f96cb-108">Hello služba Batch používá hello škálování vzorce toodetermine hello počet výpočetních uzlů, které jsou potřebné tooexecute úlohy.</span><span class="sxs-lookup"><span data-stu-id="f96cb-108">hello Batch service uses hello autoscale formula toodetermine hello number of compute nodes that are needed tooexecute your workload.</span></span> <span data-ttu-id="f96cb-109">Výpočetní uzly může být vyhrazený uzly nebo [nízkou prioritu uzly](batch-low-pri-vms.md).</span><span class="sxs-lookup"><span data-stu-id="f96cb-109">Compute nodes may be dedicated nodes or [low-priority nodes](batch-low-pri-vms.md).</span></span> <span data-ttu-id="f96cb-110">Batch odpovídá tooservice metriky data, která se shromažďují pravidelně.</span><span class="sxs-lookup"><span data-stu-id="f96cb-110">Batch responds tooservice metrics data that is collected periodically.</span></span> <span data-ttu-id="f96cb-111">Na základě těchto dat metriky Batch upraví hello počet výpočetních uzlů ve fondu hello založenou na vzorec a v konfigurovatelných intervalech.</span><span class="sxs-lookup"><span data-stu-id="f96cb-111">Using this metrics data, Batch adjusts hello number of compute nodes in hello pool based on your formula and at a configurable interval.</span></span>

<span data-ttu-id="f96cb-112">Můžete povolit automatické škálování buď při vytváření fondu, nebo na existující fond.</span><span class="sxs-lookup"><span data-stu-id="f96cb-112">You can enable automatic scaling either when a pool is created, or on an existing pool.</span></span> <span data-ttu-id="f96cb-113">Můžete také změnit existující vzorec ve fondu, který je nakonfigurován pro automatické škálování.</span><span class="sxs-lookup"><span data-stu-id="f96cb-113">You can also change an existing formula on a pool that is configured for autoscaling.</span></span> <span data-ttu-id="f96cb-114">Batch umožňuje tooevaluate běží vaše vzorce před přiřazením je stav hello toopools a toomonitor automatické škálování.</span><span class="sxs-lookup"><span data-stu-id="f96cb-114">Batch enables you tooevaluate your formulas before assigning them toopools and toomonitor hello status of automatic scaling runs.</span></span>

<span data-ttu-id="f96cb-115">Tento článek popisuje hello různými entitami, které tvoří vaše vzorce automatického škálování, včetně proměnné, operátory, operace a funkce.</span><span class="sxs-lookup"><span data-stu-id="f96cb-115">This article discusses hello various entities that make up your autoscale formulas, including variables, operators, operations, and functions.</span></span> <span data-ttu-id="f96cb-116">Probereme jak tooobtain různé výpočetní prostředek a úloha metriky v rámci dávky.</span><span class="sxs-lookup"><span data-stu-id="f96cb-116">We discuss how tooobtain various compute resource and task metrics within Batch.</span></span> <span data-ttu-id="f96cb-117">Můžete použít tyto metriky tooadjust váš fond počet uzlů na základě prostředků využití a úlohy stavu.</span><span class="sxs-lookup"><span data-stu-id="f96cb-117">You can use these metrics tooadjust your pool's node count based on resource usage and task status.</span></span> <span data-ttu-id="f96cb-118">Potom popisují, jak tooconstruct vzorec a povolit automatické škálování ve fondu pomocí obou hello Batch REST a rozhraní API technologie .NET.</span><span class="sxs-lookup"><span data-stu-id="f96cb-118">We then describe how tooconstruct a formula and enable automatic scaling on a pool by using both hello Batch REST and .NET APIs.</span></span> <span data-ttu-id="f96cb-119">Dokončíme nakonec, se několik vzorci příklad.</span><span class="sxs-lookup"><span data-stu-id="f96cb-119">Finally, we finish up with a few example formulas.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="f96cb-120">Při vytváření účtu Batch, můžete zadat hello [konfigurace účtu](batch-api-basics.md#account), která určuje, zda jsou fondy přidělené v předplatném služby Batch (hello výchozí nastavení) nebo ve vašem předplatném uživatele.</span><span class="sxs-lookup"><span data-stu-id="f96cb-120">When you create a Batch account, you can specify hello [account configuration](batch-api-basics.md#account), which determines whether pools are allocated in a Batch service subscription (hello default), or in your user subscription.</span></span> <span data-ttu-id="f96cb-121">Pokud jste vytvořili vašeho účtu Batch s hello výchozí služba Batch konfigurace, váš účet je omezená tooa maximální počet jader, které lze použít ke zpracování.</span><span class="sxs-lookup"><span data-stu-id="f96cb-121">If you created your Batch account with hello default Batch Service configuration, then your account is limited tooa maximum number of cores that can be used for processing.</span></span> <span data-ttu-id="f96cb-122">Hello služba Batch škáluje výpočetní uzly pouze až toothat základní omezení.</span><span class="sxs-lookup"><span data-stu-id="f96cb-122">hello Batch service scales compute nodes only up toothat core limit.</span></span> <span data-ttu-id="f96cb-123">Z tohoto důvodu nemusí hello služba Batch dosáhnout hello cílovým počtem výpočetních uzlů určeného vzorec škálování.</span><span class="sxs-lookup"><span data-stu-id="f96cb-123">For this reason, hello Batch service may not reach hello target number of compute nodes specified by an autoscale formula.</span></span> <span data-ttu-id="f96cb-124">V tématu [kvóty a omezení pro hello služby Azure Batch](batch-quota-limit.md) informace o prohlížení a zvýšení kvóty vašeho účtu.</span><span class="sxs-lookup"><span data-stu-id="f96cb-124">See [Quotas and limits for hello Azure Batch service](batch-quota-limit.md) for information on viewing and increasing your account quotas.</span></span>
>
><span data-ttu-id="f96cb-125">Pokud jste vytvořili účet s konfigurací hello uživatele předplatného, váš účet sdílí v hello základní kvóta pro předplatné hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-125">If you created your account with hello User Subscription configuration, then your account shares in hello core quota for hello subscription.</span></span> <span data-ttu-id="f96cb-126">Další informace najdete v tématu [Omezení virtuálních počítačů](../azure-subscription-service-limits.md#virtual-machines-limits) v tématu [Limity, kvóty a omezení předplatného a služeb Azure](../azure-subscription-service-limits.md).</span><span class="sxs-lookup"><span data-stu-id="f96cb-126">For more information, see [Virtual Machines limits](../azure-subscription-service-limits.md#virtual-machines-limits) in [Azure subscription and service limits, quotas, and constraints](../azure-subscription-service-limits.md).</span></span>
>
>

## <a name="automatic-scaling-formulas"></a><span data-ttu-id="f96cb-127">Automatické škálování vzorce</span><span class="sxs-lookup"><span data-stu-id="f96cb-127">Automatic scaling formulas</span></span>
<span data-ttu-id="f96cb-128">Vzorec automatického škálování je řetězcová hodnota, kterou definujete, který obsahuje jeden nebo více příkazů.</span><span class="sxs-lookup"><span data-stu-id="f96cb-128">An automatic scaling formula is a string value that you define that contains one or more statements.</span></span> <span data-ttu-id="f96cb-129">Vzorec škálování Hello je přiřazen fondu tooa [autoScaleFormula] [ rest_autoscaleformula] – element (Batch REST) nebo [CloudPool.AutoScaleFormula] [ net_cloudpool_autoscaleformula] vlastnost (Batch .NET).</span><span class="sxs-lookup"><span data-stu-id="f96cb-129">hello autoscale formula is assigned tooa pool's [autoScaleFormula][rest_autoscaleformula] element (Batch REST) or [CloudPool.AutoScaleFormula][net_cloudpool_autoscaleformula] property (Batch .NET).</span></span> <span data-ttu-id="f96cb-130">Hello služba Batch používá vaše vzorce toodetermine hello cílovým počtem výpočetních uzlů ve fondu hello hello další interval zpracování.</span><span class="sxs-lookup"><span data-stu-id="f96cb-130">hello Batch service uses your formula toodetermine hello target number of compute nodes in hello pool for hello next interval of processing.</span></span> <span data-ttu-id="f96cb-131">Hello vzorce řetězec nesmí být delší než 8 KB, může obsahovat až too100 příkazy, které jsou odděleny středníky a může obsahovat konce řádků a komentáře.</span><span class="sxs-lookup"><span data-stu-id="f96cb-131">hello formula string cannot exceed 8 KB, can include up too100 statements that are separated by semicolons, and can include line breaks and comments.</span></span>

<span data-ttu-id="f96cb-132">Automatické škálování vzorců si můžete představit jako Batch škálování "jazyk."</span><span class="sxs-lookup"><span data-stu-id="f96cb-132">You can think of automatic scaling formulas as a Batch autoscale "language."</span></span> <span data-ttu-id="f96cb-133">Vzorce příkazy jsou volné formátovaných výrazů, které můžou zahrnovat proměnných definovaných servisu (proměnné definované služba Batch hello) a uživatelem definované proměnné (proměnné, které definujete).</span><span class="sxs-lookup"><span data-stu-id="f96cb-133">Formula statements are free-formed expressions that can include both service-defined variables (variables defined by hello Batch service) and user-defined variables (variables that you define).</span></span> <span data-ttu-id="f96cb-134">Pomocí předdefinovaných typů, operátory a funkce můžou dělat různé operace na tyto hodnoty.</span><span class="sxs-lookup"><span data-stu-id="f96cb-134">They can perform various operations on these values by using built-in types, operators, and functions.</span></span> <span data-ttu-id="f96cb-135">Příkaz může například trvat hello následující formulář:</span><span class="sxs-lookup"><span data-stu-id="f96cb-135">For example, a statement might take hello following form:</span></span>

```
$myNewVariable = function($ServiceDefinedVariable, $myCustomVariable);
```

<span data-ttu-id="f96cb-136">Vzorce obvykle obsahují více příkazů, které provádějí operace na hodnotách, které byly získány v předchozích příkazech.</span><span class="sxs-lookup"><span data-stu-id="f96cb-136">Formulas generally contain multiple statements that perform operations on values that are obtained in previous statements.</span></span> <span data-ttu-id="f96cb-137">Například nejprve jsme získat hodnotu `variable1`, předejte ji tooa funkce toopopulate `variable2`:</span><span class="sxs-lookup"><span data-stu-id="f96cb-137">For example, first we obtain a value for `variable1`, then pass it tooa function toopopulate `variable2`:</span></span>

```
$variable1 = function1($ServiceDefinedVariable);
$variable2 = function2($OtherServiceDefinedVariable, $variable1);
```

<span data-ttu-id="f96cb-138">Zahrňte tyto příkazy vaše vzorce tooarrive škálování na cílovým počtem výpočetních uzlů.</span><span class="sxs-lookup"><span data-stu-id="f96cb-138">Include these statements in your autoscale formula tooarrive at a target number of compute nodes.</span></span> <span data-ttu-id="f96cb-139">Vyhrazené uzlů a uzly nízkou prioritu mít vlastní nastavení cílové tak, aby můžete definovat cíl pro každý typ uzlu.</span><span class="sxs-lookup"><span data-stu-id="f96cb-139">Dedicated nodes and low-priority nodes each have their own target settings, so that you can define a target for each type of node.</span></span> <span data-ttu-id="f96cb-140">Vzorec škálování může zahrnovat cílovou hodnotu pro vyhrazené uzly a cílovou hodnotu pro uzly nízkou prioritu.</span><span class="sxs-lookup"><span data-stu-id="f96cb-140">An autoscale formula can include a target value for dedicated nodes, a target value for low-priority nodes, or both.</span></span>

<span data-ttu-id="f96cb-141">Hello cílový počet uzlů může být vyšší, menší nebo stejná jako aktuální počet uzlů typu ve fondu hello hello hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-141">hello target number of nodes may be higher, lower, or hello same as hello current number of nodes of that type in hello pool.</span></span> <span data-ttu-id="f96cb-142">Batch vyhodnocuje vzorec škálování fondu v určitých intervalech (viz [automatického škálování intervaly](#automatic-scaling-interval)).</span><span class="sxs-lookup"><span data-stu-id="f96cb-142">Batch evaluates a pool's autoscale formula at a specific interval (see [automatic scaling intervals](#automatic-scaling-interval)).</span></span> <span data-ttu-id="f96cb-143">Batch upraví hello cílový počet každý typ uzlu v hello fondu toohello číslo, které určuje vzorec škálování v době vyhodnocení hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-143">Batch adjusts hello target number of each type of node in hello pool toohello number that your autoscale formula specifies at hello time of evaluation.</span></span>

### <a name="sample-autoscale-formula"></a><span data-ttu-id="f96cb-144">Vzorec škálování ukázka</span><span class="sxs-lookup"><span data-stu-id="f96cb-144">Sample autoscale formula</span></span>

<span data-ttu-id="f96cb-145">Tady je příklad vzorec škálování, který může být upravenou toowork pro většinu scénářů.</span><span class="sxs-lookup"><span data-stu-id="f96cb-145">Here is an example of an autoscale formula that can be adjusted toowork for most scenarios.</span></span> <span data-ttu-id="f96cb-146">Hello proměnné `startingNumberOfVMs` a `maxNumberofVMs` v hello může být například vzorec upravenou tooyour potřebám.</span><span class="sxs-lookup"><span data-stu-id="f96cb-146">hello variables `startingNumberOfVMs` and `maxNumberofVMs` in hello example formula can be adjusted tooyour needs.</span></span> <span data-ttu-id="f96cb-147">Tento vzorec škáluje vyhrazené uzly, ale může být upravený tooapply tooscale nízkou prioritu také uzly.</span><span class="sxs-lookup"><span data-stu-id="f96cb-147">This formula scales dedicated nodes, but can be modified tooapply tooscale low-priority nodes as well.</span></span> 

```
startingNumberOfVMs = 1;
maxNumberofVMs = 25;
pendingTaskSamplePercent = $PendingTasks.GetSamplePercent(180 * TimeInterval_Second);
pendingTaskSamples = pendingTaskSamplePercent < 70 ? startingNumberOfVMs : avg($PendingTasks.GetSample(180 * TimeInterval_Second));
$TargetDedicatedNodes=min(maxNumberofVMs, pendingTaskSamples);
```

<span data-ttu-id="f96cb-148">Pomocí tohoto vzorce automatického škálování je původně vytvořen fond hello se jeden virtuální počítač.</span><span class="sxs-lookup"><span data-stu-id="f96cb-148">With this autoscale formula, hello pool is initially created with a single VM.</span></span> <span data-ttu-id="f96cb-149">Hello `$PendingTasks` metrika definuje hello počet úloh, které jsou spuštěné nebo zařazené ve frontě.</span><span class="sxs-lookup"><span data-stu-id="f96cb-149">hello `$PendingTasks` metric defines hello number of tasks that are running or queued.</span></span> <span data-ttu-id="f96cb-150">Vzorec Hello najde hello průměrný počet úkolů čekajících na zpracování v hello posledních 180 sekund a nastaví hello `$TargetDedicatedNodes` proměnná odpovídajícím způsobem.</span><span class="sxs-lookup"><span data-stu-id="f96cb-150">hello formula finds hello average number of pending tasks in hello last 180 seconds and sets hello `$TargetDedicatedNodes` variable accordingly.</span></span> <span data-ttu-id="f96cb-151">Vzorec Hello zajistí, že hello cílový počet uzlů vyhrazené nikdy nepřesáhne 25 virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="f96cb-151">hello formula ensures that hello target number of dedicated nodes never exceeds 25 VMs.</span></span> <span data-ttu-id="f96cb-152">Nové úkoly jsou předloženy, hello fondu automaticky rozšiřovat.</span><span class="sxs-lookup"><span data-stu-id="f96cb-152">As new tasks are submitted, hello pool automatically grows.</span></span> <span data-ttu-id="f96cb-153">Jako dokončení úkolů virtuální počítače se stanou volné jeden po druhém a vzorec automatického škálování hello zmenšuje hello fondu.</span><span class="sxs-lookup"><span data-stu-id="f96cb-153">As tasks complete, VMs become free one by one and hello autoscaling formula shrinks hello pool.</span></span>

## <a name="variables"></a><span data-ttu-id="f96cb-154">Proměnné</span><span class="sxs-lookup"><span data-stu-id="f96cb-154">Variables</span></span>
<span data-ttu-id="f96cb-155">Můžete je používat **služby definované** a **uživatelem definované** proměnné ve vzorcích škálování.</span><span class="sxs-lookup"><span data-stu-id="f96cb-155">You can use both **service-defined** and **user-defined** variables in your autoscale formulas.</span></span> <span data-ttu-id="f96cb-156">proměnné definované služby Hello jsou integrované v toohello služby Batch.</span><span class="sxs-lookup"><span data-stu-id="f96cb-156">hello service-defined variables are built in toohello Batch service.</span></span> <span data-ttu-id="f96cb-157">Některé proměnné definované služby jsou pro čtení a zápis a některé jsou jen pro čtení.</span><span class="sxs-lookup"><span data-stu-id="f96cb-157">Some service-defined variables are read-write, and some are read-only.</span></span> <span data-ttu-id="f96cb-158">Uživatelem definované proměnné jsou proměnné, které definujete.</span><span class="sxs-lookup"><span data-stu-id="f96cb-158">User-defined variables are variables that you define.</span></span> <span data-ttu-id="f96cb-159">Ve vzorci příklad hello uvedené v předchozí části hello `$TargetDedicatedNodes` a `$PendingTasks` jsou proměnných definovaných servisu.</span><span class="sxs-lookup"><span data-stu-id="f96cb-159">In hello example formula shown in hello previous section, `$TargetDedicatedNodes` and `$PendingTasks` are service-defined variables.</span></span> <span data-ttu-id="f96cb-160">Proměnné `startingNumberOfVMs` a `maxNumberofVMs` jsou uživatelem definované proměnné.</span><span class="sxs-lookup"><span data-stu-id="f96cb-160">Variables `startingNumberOfVMs` and `maxNumberofVMs` are user-defined variables.</span></span>

> [!NOTE]
> <span data-ttu-id="f96cb-161">Proměnné definované služby jsou vždy uvedeny znak dolaru ($).</span><span class="sxs-lookup"><span data-stu-id="f96cb-161">Service-defined variables are always preceded by a dollar sign ($).</span></span> <span data-ttu-id="f96cb-162">Uživatelem definované proměnné dolaru hello je volitelné.</span><span class="sxs-lookup"><span data-stu-id="f96cb-162">For user-defined variables, hello dollar sign is optional.</span></span>
>
>

<span data-ttu-id="f96cb-163">Hello následující tabulky ukazují, jak pro čtení a zápis a jen pro čtení proměnné, které jsou definovány hello služby Batch.</span><span class="sxs-lookup"><span data-stu-id="f96cb-163">hello following tables show both read-write and read-only variables that are defined by hello Batch service.</span></span>

<span data-ttu-id="f96cb-164">Můžete získat a nastavit hodnoty těchto proměnných definovaných servisu hello toomanage hello počet výpočetních uzlů ve fondu:</span><span class="sxs-lookup"><span data-stu-id="f96cb-164">You can get and set hello values of these service-defined variables toomanage hello number of compute nodes in a pool:</span></span>

| <span data-ttu-id="f96cb-165">Proměnné definované služby pro čtení a zápis</span><span class="sxs-lookup"><span data-stu-id="f96cb-165">Read-write service-defined variables</span></span> | <span data-ttu-id="f96cb-166">Popis</span><span class="sxs-lookup"><span data-stu-id="f96cb-166">Description</span></span> |
| --- | --- |
| <span data-ttu-id="f96cb-167">$TargetDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="f96cb-167">$TargetDedicatedNodes</span></span> |<span data-ttu-id="f96cb-168">Hello cílový počet vyhrazených výpočetní uzly fondu hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-168">hello target number of dedicated compute nodes for hello pool.</span></span> <span data-ttu-id="f96cb-169">Hello počet vyhrazených uzlů je zadán jako cíl, protože fond nemusí vždy dosáhnout hello požadovaného počtu uzlů.</span><span class="sxs-lookup"><span data-stu-id="f96cb-169">hello number of dedicated nodes is specified as a target because a pool may not always achieve hello desired number of nodes.</span></span> <span data-ttu-id="f96cb-170">Například pokud je upraven hello cílový počet vyhrazených uzlů ve zkušební verzi škálování před hello fond dosáhla hello počáteční cíl a potom hello fondu nemusí dosáhnout cílového hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-170">For example, if hello target number of dedicated nodes is modified by an autoscale evaluation before hello pool has reached hello initial target, then hello pool may not reach hello target.</span></span> <br /><br /> <span data-ttu-id="f96cb-171">Fond na účtu vytvoří s konfigurací služby Batch hello nemusí dosáhnout cíli, pokud cílový hello překročí kvótu uzlu nebo core účtu Batch.</span><span class="sxs-lookup"><span data-stu-id="f96cb-171">A pool in an account created with hello Batch Service configuration may not achieve its target if hello target exceeds a Batch account node or core quota.</span></span> <span data-ttu-id="f96cb-172">Fond na účtu vytvořené pomocí konfigurace odběru uživatele hello nemusí dosáhnout cíli, pokud cílový hello překračuje hello sdílené základní kvóta pro předplatné hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-172">A pool in an account created with hello User Subscription configuration may not achieve its target if hello target exceeds hello shared core quota for hello subscription.</span></span>|
| <span data-ttu-id="f96cb-173">$TargetLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="f96cb-173">$TargetLowPriorityNodes</span></span> |<span data-ttu-id="f96cb-174">Hello cílový počet nízkou prioritu výpočetní uzly fondu hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-174">hello target number of low-priority compute nodes for hello pool.</span></span> <span data-ttu-id="f96cb-175">Hello počet uzlů nízkou prioritu je zadán jako cíl, protože fond nemusí vždy dosáhnout hello požadovaného počtu uzlů.</span><span class="sxs-lookup"><span data-stu-id="f96cb-175">hello number of low-priority nodes is specified as a target because a pool may not always achieve hello desired number of nodes.</span></span> <span data-ttu-id="f96cb-176">Například pokud je upraven hello cílový počet uzlů nízkou prioritu ve zkušební verzi škálování před hello fond dosáhla hello počáteční cíl a potom hello fondu nemusí dosáhnout cílového hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-176">For example, if hello target number of low-priority nodes is modified by an autoscale evaluation before hello pool has reached hello initial target, then hello pool may not reach hello target.</span></span> <span data-ttu-id="f96cb-177">Fond nemusí také dosáhnout cíli, pokud cílový hello překročí kvótu uzlu nebo core účtu Batch.</span><span class="sxs-lookup"><span data-stu-id="f96cb-177">A pool may also not achieve its target if hello target exceeds a Batch account node or core quota.</span></span> <br /><br /> <span data-ttu-id="f96cb-178">Další informace na nízkou prioritu výpočetních uzlů najdete v tématu [použít nízkou prioritu virtuálních počítačů pomocí služby Batch (Preview)](batch-low-pri-vms.md).</span><span class="sxs-lookup"><span data-stu-id="f96cb-178">For more information on low-priority compute nodes, see [Use low-priority VMs with Batch (Preview)](batch-low-pri-vms.md).</span></span> |
| <span data-ttu-id="f96cb-179">$NodeDeallocationOption</span><span class="sxs-lookup"><span data-stu-id="f96cb-179">$NodeDeallocationOption</span></span> |<span data-ttu-id="f96cb-180">Hello akce, která nastane, když se odebere z fondu, výpočetních uzlů.</span><span class="sxs-lookup"><span data-stu-id="f96cb-180">hello action that occurs when compute nodes are removed from a pool.</span></span> <span data-ttu-id="f96cb-181">Možné hodnoty:</span><span class="sxs-lookup"><span data-stu-id="f96cb-181">Possible values are:</span></span><ul><li><span data-ttu-id="f96cb-182">**requeue**– okamžitě ukončí úlohy a vloží je zpět ve frontě úloh hello tak, aby se přeplánovat.</span><span class="sxs-lookup"><span data-stu-id="f96cb-182">**requeue**--Terminates tasks immediately and puts them back on hello job queue so that they are rescheduled.</span></span><li><span data-ttu-id="f96cb-183">**Ukončit**– okamžitě ukončí úlohy a odebere je ze fronty úloh hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-183">**terminate**--Terminates tasks immediately and removes them from hello job queue.</span></span><li><span data-ttu-id="f96cb-184">**taskcompletion**– čeká aktuálně spuštěných úloh toofinish a pak odebere hello uzel z fondu hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-184">**taskcompletion**--Waits for currently running tasks toofinish and then removes hello node from hello pool.</span></span><li><span data-ttu-id="f96cb-185">**retaineddata**– čeká pro všechna hello místní úloh uchovávají data na uzlu toobe hello vyčistit před odebráním hello uzel z fondu hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-185">**retaineddata**--Waits for all hello local task-retained data on hello node toobe cleaned up before removing hello node from hello pool.</span></span></ul> |

<span data-ttu-id="f96cb-186">Můžete získat hodnotu hello těchto proměnných definovaných servisu toomake úpravy, které jsou založeny na metriky ze služby Batch hello:</span><span class="sxs-lookup"><span data-stu-id="f96cb-186">You can get hello value of these service-defined variables toomake adjustments that are based on metrics from hello Batch service:</span></span>

| <span data-ttu-id="f96cb-187">Jen pro čtení služby definované proměnné</span><span class="sxs-lookup"><span data-stu-id="f96cb-187">Read-only service-defined variables</span></span> | <span data-ttu-id="f96cb-188">Popis</span><span class="sxs-lookup"><span data-stu-id="f96cb-188">Description</span></span> |
| --- | --- |
| <span data-ttu-id="f96cb-189">$CPUPercent</span><span class="sxs-lookup"><span data-stu-id="f96cb-189">$CPUPercent</span></span> |<span data-ttu-id="f96cb-190">Hello průměrné procento využití procesoru.</span><span class="sxs-lookup"><span data-stu-id="f96cb-190">hello average percentage of CPU usage.</span></span> |
| <span data-ttu-id="f96cb-191">$WallClockSeconds</span><span class="sxs-lookup"><span data-stu-id="f96cb-191">$WallClockSeconds</span></span> |<span data-ttu-id="f96cb-192">Hello počet sekund využívat.</span><span class="sxs-lookup"><span data-stu-id="f96cb-192">hello number of seconds consumed.</span></span> |
| <span data-ttu-id="f96cb-193">$MemoryBytes</span><span class="sxs-lookup"><span data-stu-id="f96cb-193">$MemoryBytes</span></span> |<span data-ttu-id="f96cb-194">Hello průměrný počet MB použít.</span><span class="sxs-lookup"><span data-stu-id="f96cb-194">hello average number of megabytes used.</span></span> |
| <span data-ttu-id="f96cb-195">$DiskBytes</span><span class="sxs-lookup"><span data-stu-id="f96cb-195">$DiskBytes</span></span> |<span data-ttu-id="f96cb-196">Hello průměrný počet gigabajtů použít na místní disky hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-196">hello average number of gigabytes used on hello local disks.</span></span> |
| <span data-ttu-id="f96cb-197">$DiskReadBytes</span><span class="sxs-lookup"><span data-stu-id="f96cb-197">$DiskReadBytes</span></span> |<span data-ttu-id="f96cb-198">Hello počet přečtených bajtů.</span><span class="sxs-lookup"><span data-stu-id="f96cb-198">hello number of bytes read.</span></span> |
| <span data-ttu-id="f96cb-199">$DiskWriteBytes</span><span class="sxs-lookup"><span data-stu-id="f96cb-199">$DiskWriteBytes</span></span> |<span data-ttu-id="f96cb-200">Hello počet zapsaných bajtů.</span><span class="sxs-lookup"><span data-stu-id="f96cb-200">hello number of bytes written.</span></span> |
| <span data-ttu-id="f96cb-201">$DiskReadOps</span><span class="sxs-lookup"><span data-stu-id="f96cb-201">$DiskReadOps</span></span> |<span data-ttu-id="f96cb-202">provést Hello počet operací čtení disku.</span><span class="sxs-lookup"><span data-stu-id="f96cb-202">hello count of read disk operations performed.</span></span> |
| <span data-ttu-id="f96cb-203">$DiskWriteOps</span><span class="sxs-lookup"><span data-stu-id="f96cb-203">$DiskWriteOps</span></span> |<span data-ttu-id="f96cb-204">Hello počet operací zápisu disku provést.</span><span class="sxs-lookup"><span data-stu-id="f96cb-204">hello count of write disk operations performed.</span></span> |
| <span data-ttu-id="f96cb-205">$NetworkInBytes</span><span class="sxs-lookup"><span data-stu-id="f96cb-205">$NetworkInBytes</span></span> |<span data-ttu-id="f96cb-206">Hello počet přijatých bajtů.</span><span class="sxs-lookup"><span data-stu-id="f96cb-206">hello number of inbound bytes.</span></span> |
| <span data-ttu-id="f96cb-207">$NetworkOutBytes</span><span class="sxs-lookup"><span data-stu-id="f96cb-207">$NetworkOutBytes</span></span> |<span data-ttu-id="f96cb-208">Hello počet bajtů.</span><span class="sxs-lookup"><span data-stu-id="f96cb-208">hello number of outbound bytes.</span></span> |
| <span data-ttu-id="f96cb-209">$SampleNodeCount</span><span class="sxs-lookup"><span data-stu-id="f96cb-209">$SampleNodeCount</span></span> |<span data-ttu-id="f96cb-210">Hello počet výpočetních uzlů.</span><span class="sxs-lookup"><span data-stu-id="f96cb-210">hello count of compute nodes.</span></span> |
| <span data-ttu-id="f96cb-211">$ActiveTasks</span><span class="sxs-lookup"><span data-stu-id="f96cb-211">$ActiveTasks</span></span> |<span data-ttu-id="f96cb-212">Hello počet úloh, které jsou připravené tooexecute, ale ještě nejsou provádění.</span><span class="sxs-lookup"><span data-stu-id="f96cb-212">hello number of tasks that are ready tooexecute but are not yet executing.</span></span> <span data-ttu-id="f96cb-213">počet Hello $ActiveTasks zahrnuje všechny úlohy, které jsou v aktivním stavu hello a jehož závislosti byly splněny.</span><span class="sxs-lookup"><span data-stu-id="f96cb-213">hello $ActiveTasks count includes all tasks that are in hello active state and whose dependencies have been satisfied.</span></span> <span data-ttu-id="f96cb-214">Všechny úlohy, které jsou v aktivním stavu hello, ale nebyly splněny jehož závislosti jsou vyloučeny z hello $ActiveTasks počet.</span><span class="sxs-lookup"><span data-stu-id="f96cb-214">Any tasks that are in hello active state but whose dependencies have not been satisfied are excluded from hello $ActiveTasks count.</span></span>|
| <span data-ttu-id="f96cb-215">$RunningTasks</span><span class="sxs-lookup"><span data-stu-id="f96cb-215">$RunningTasks</span></span> |<span data-ttu-id="f96cb-216">Hello počet úloh ve spuštěném stavu.</span><span class="sxs-lookup"><span data-stu-id="f96cb-216">hello number of tasks in a running state.</span></span> |
| <span data-ttu-id="f96cb-217">$PendingTasks</span><span class="sxs-lookup"><span data-stu-id="f96cb-217">$PendingTasks</span></span> |<span data-ttu-id="f96cb-218">Hello součet $ActiveTasks a $RunningTasks.</span><span class="sxs-lookup"><span data-stu-id="f96cb-218">hello sum of $ActiveTasks and $RunningTasks.</span></span> |
| <span data-ttu-id="f96cb-219">$SucceededTasks</span><span class="sxs-lookup"><span data-stu-id="f96cb-219">$SucceededTasks</span></span> |<span data-ttu-id="f96cb-220">Hello počet úloh, které bylo úspěšně dokončeno.</span><span class="sxs-lookup"><span data-stu-id="f96cb-220">hello number of tasks that finished successfully.</span></span> |
| <span data-ttu-id="f96cb-221">$FailedTasks</span><span class="sxs-lookup"><span data-stu-id="f96cb-221">$FailedTasks</span></span> |<span data-ttu-id="f96cb-222">Hello počet úloh, které se nezdařilo.</span><span class="sxs-lookup"><span data-stu-id="f96cb-222">hello number of tasks that failed.</span></span> |
| <span data-ttu-id="f96cb-223">$CurrentDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="f96cb-223">$CurrentDedicatedNodes</span></span> |<span data-ttu-id="f96cb-224">Hello aktuální počet vyhrazených výpočetních uzlů.</span><span class="sxs-lookup"><span data-stu-id="f96cb-224">hello current number of dedicated compute nodes.</span></span> |
| <span data-ttu-id="f96cb-225">$CurrentLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="f96cb-225">$CurrentLowPriorityNodes</span></span> |<span data-ttu-id="f96cb-226">Aktuální počet nízkou prioritu Hello výpočetní uzly, včetně všech uzlech, které byly zrušeny.</span><span class="sxs-lookup"><span data-stu-id="f96cb-226">hello current number of low-priority compute nodes, including any nodes that have been pre-empted.</span></span> |
| <span data-ttu-id="f96cb-227">$PreemptedNodeCount</span><span class="sxs-lookup"><span data-stu-id="f96cb-227">$PreemptedNodeCount</span></span> | <span data-ttu-id="f96cb-228">Hello počet uzlů ve fondu hello, které jsou ve stavu, zrušeny.</span><span class="sxs-lookup"><span data-stu-id="f96cb-228">hello number of nodes in hello pool that are in a pre-empted state.</span></span> |

> [!TIP]
> <span data-ttu-id="f96cb-229">Hello jen pro čtení, služby definované proměnné, které jsou uvedené v předchozí tabulce hello jsou *objekty* které tooaccess data související s jednotlivými poskytují různé metody.</span><span class="sxs-lookup"><span data-stu-id="f96cb-229">hello read-only, service-defined variables that are shown in hello previous table are *objects* that provide various methods tooaccess data associated with each.</span></span> <span data-ttu-id="f96cb-230">Další informace najdete v tématu [získat ukázková data](#getsampledata) dále v tomto článku.</span><span class="sxs-lookup"><span data-stu-id="f96cb-230">For more information, see [Obtain sample data](#getsampledata) later in this article.</span></span>
>
>

## <a name="types"></a><span data-ttu-id="f96cb-231">Typy</span><span class="sxs-lookup"><span data-stu-id="f96cb-231">Types</span></span>
<span data-ttu-id="f96cb-232">Tyto typy jsou podporovány v vzorec:</span><span class="sxs-lookup"><span data-stu-id="f96cb-232">These types are supported in a formula:</span></span>

* <span data-ttu-id="f96cb-233">Double</span><span class="sxs-lookup"><span data-stu-id="f96cb-233">double</span></span>
* <span data-ttu-id="f96cb-234">doubleVec</span><span class="sxs-lookup"><span data-stu-id="f96cb-234">doubleVec</span></span>
* <span data-ttu-id="f96cb-235">doubleVecList</span><span class="sxs-lookup"><span data-stu-id="f96cb-235">doubleVecList</span></span>
* <span data-ttu-id="f96cb-236">Řetězec</span><span class="sxs-lookup"><span data-stu-id="f96cb-236">string</span></span>
* <span data-ttu-id="f96cb-237">časové razítko – časové razítko je složené struktura, která obsahuje hello následující členy:</span><span class="sxs-lookup"><span data-stu-id="f96cb-237">timestamp--timestamp is a compound structure that contains hello following members:</span></span>

  * <span data-ttu-id="f96cb-238">Rok</span><span class="sxs-lookup"><span data-stu-id="f96cb-238">year</span></span>
  * <span data-ttu-id="f96cb-239">měsíc (1-12)</span><span class="sxs-lookup"><span data-stu-id="f96cb-239">month (1-12)</span></span>
  * <span data-ttu-id="f96cb-240">den (1-31)</span><span class="sxs-lookup"><span data-stu-id="f96cb-240">day (1-31)</span></span>
  * <span data-ttu-id="f96cb-241">den v týdnu (ve formátu hello čísla; příklad: 1 pro pondělí)</span><span class="sxs-lookup"><span data-stu-id="f96cb-241">weekday (in hello format of number; for example, 1 for Monday)</span></span>
  * <span data-ttu-id="f96cb-242">hodinu (ve 24hodinovém formátu číslo; například 13 znamená 13: 00)</span><span class="sxs-lookup"><span data-stu-id="f96cb-242">hour (in 24-hour number format; for example, 13 means 1 PM)</span></span>
  * <span data-ttu-id="f96cb-243">minut (00-59)</span><span class="sxs-lookup"><span data-stu-id="f96cb-243">minute (00-59)</span></span>
  * <span data-ttu-id="f96cb-244">druhý (00-59)</span><span class="sxs-lookup"><span data-stu-id="f96cb-244">second (00-59)</span></span>
* <span data-ttu-id="f96cb-245">TimeInterval</span><span class="sxs-lookup"><span data-stu-id="f96cb-245">timeinterval</span></span>

  * <span data-ttu-id="f96cb-246">TimeInterval_Zero</span><span class="sxs-lookup"><span data-stu-id="f96cb-246">TimeInterval_Zero</span></span>
  * <span data-ttu-id="f96cb-247">TimeInterval_100ns</span><span class="sxs-lookup"><span data-stu-id="f96cb-247">TimeInterval_100ns</span></span>
  * <span data-ttu-id="f96cb-248">TimeInterval_Microsecond</span><span class="sxs-lookup"><span data-stu-id="f96cb-248">TimeInterval_Microsecond</span></span>
  * <span data-ttu-id="f96cb-249">TimeInterval_Millisecond</span><span class="sxs-lookup"><span data-stu-id="f96cb-249">TimeInterval_Millisecond</span></span>
  * <span data-ttu-id="f96cb-250">TimeInterval_Second</span><span class="sxs-lookup"><span data-stu-id="f96cb-250">TimeInterval_Second</span></span>
  * <span data-ttu-id="f96cb-251">TimeInterval_Minute</span><span class="sxs-lookup"><span data-stu-id="f96cb-251">TimeInterval_Minute</span></span>
  * <span data-ttu-id="f96cb-252">TimeInterval_Hour</span><span class="sxs-lookup"><span data-stu-id="f96cb-252">TimeInterval_Hour</span></span>
  * <span data-ttu-id="f96cb-253">TimeInterval_Day</span><span class="sxs-lookup"><span data-stu-id="f96cb-253">TimeInterval_Day</span></span>
  * <span data-ttu-id="f96cb-254">TimeInterval_Week</span><span class="sxs-lookup"><span data-stu-id="f96cb-254">TimeInterval_Week</span></span>
  * <span data-ttu-id="f96cb-255">TimeInterval_Year</span><span class="sxs-lookup"><span data-stu-id="f96cb-255">TimeInterval_Year</span></span>

## <a name="operations"></a><span data-ttu-id="f96cb-256">Operace</span><span class="sxs-lookup"><span data-stu-id="f96cb-256">Operations</span></span>
<span data-ttu-id="f96cb-257">Tyto operace jsou povoleny na hello typy, které jsou uvedeny v předchozí části hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-257">These operations are allowed on hello types that are listed in hello previous section.</span></span>

| <span data-ttu-id="f96cb-258">Operace</span><span class="sxs-lookup"><span data-stu-id="f96cb-258">Operation</span></span> | <span data-ttu-id="f96cb-259">Podporované operátory</span><span class="sxs-lookup"><span data-stu-id="f96cb-259">Supported operators</span></span> | <span data-ttu-id="f96cb-260">Typ výsledku</span><span class="sxs-lookup"><span data-stu-id="f96cb-260">Result type</span></span> |
| --- | --- | --- |
| <span data-ttu-id="f96cb-261">dvojité *operátor* double</span><span class="sxs-lookup"><span data-stu-id="f96cb-261">double *operator* double</span></span> |<span data-ttu-id="f96cb-262">+, -, *, /</span><span class="sxs-lookup"><span data-stu-id="f96cb-262">+, -, *, /</span></span> |<span data-ttu-id="f96cb-263">Double</span><span class="sxs-lookup"><span data-stu-id="f96cb-263">double</span></span> |
| <span data-ttu-id="f96cb-264">dvojité *operátor* timeinterval</span><span class="sxs-lookup"><span data-stu-id="f96cb-264">double *operator* timeinterval</span></span> |* |<span data-ttu-id="f96cb-265">TimeInterval</span><span class="sxs-lookup"><span data-stu-id="f96cb-265">timeinterval</span></span> |
| <span data-ttu-id="f96cb-266">doubleVec *operátor* double</span><span class="sxs-lookup"><span data-stu-id="f96cb-266">doubleVec *operator* double</span></span> |<span data-ttu-id="f96cb-267">+, -, *, /</span><span class="sxs-lookup"><span data-stu-id="f96cb-267">+, -, *, /</span></span> |<span data-ttu-id="f96cb-268">doubleVec</span><span class="sxs-lookup"><span data-stu-id="f96cb-268">doubleVec</span></span> |
| <span data-ttu-id="f96cb-269">doubleVec *operátor* doubleVec</span><span class="sxs-lookup"><span data-stu-id="f96cb-269">doubleVec *operator* doubleVec</span></span> |<span data-ttu-id="f96cb-270">+, -, *, /</span><span class="sxs-lookup"><span data-stu-id="f96cb-270">+, -, *, /</span></span> |<span data-ttu-id="f96cb-271">doubleVec</span><span class="sxs-lookup"><span data-stu-id="f96cb-271">doubleVec</span></span> |
| <span data-ttu-id="f96cb-272">TimeInterval *operátor* double</span><span class="sxs-lookup"><span data-stu-id="f96cb-272">timeinterval *operator* double</span></span> |<span data-ttu-id="f96cb-273">*, /</span><span class="sxs-lookup"><span data-stu-id="f96cb-273">*, /</span></span> |<span data-ttu-id="f96cb-274">TimeInterval</span><span class="sxs-lookup"><span data-stu-id="f96cb-274">timeinterval</span></span> |
| <span data-ttu-id="f96cb-275">TimeInterval *operátor* timeinterval</span><span class="sxs-lookup"><span data-stu-id="f96cb-275">timeinterval *operator* timeinterval</span></span> |<span data-ttu-id="f96cb-276">+, -</span><span class="sxs-lookup"><span data-stu-id="f96cb-276">+, -</span></span> |<span data-ttu-id="f96cb-277">TimeInterval</span><span class="sxs-lookup"><span data-stu-id="f96cb-277">timeinterval</span></span> |
| <span data-ttu-id="f96cb-278">TimeInterval *operátor* časové razítko</span><span class="sxs-lookup"><span data-stu-id="f96cb-278">timeinterval *operator* timestamp</span></span> |+ |<span data-ttu-id="f96cb-279">časové razítko</span><span class="sxs-lookup"><span data-stu-id="f96cb-279">timestamp</span></span> |
| <span data-ttu-id="f96cb-280">časové razítko *operátor* timeinterval</span><span class="sxs-lookup"><span data-stu-id="f96cb-280">timestamp *operator* timeinterval</span></span> |+ |<span data-ttu-id="f96cb-281">časové razítko</span><span class="sxs-lookup"><span data-stu-id="f96cb-281">timestamp</span></span> |
| <span data-ttu-id="f96cb-282">časové razítko *operátor* časové razítko</span><span class="sxs-lookup"><span data-stu-id="f96cb-282">timestamp *operator* timestamp</span></span> |- |<span data-ttu-id="f96cb-283">TimeInterval</span><span class="sxs-lookup"><span data-stu-id="f96cb-283">timeinterval</span></span> |
| <span data-ttu-id="f96cb-284">*operátor*double</span><span class="sxs-lookup"><span data-stu-id="f96cb-284">*operator*double</span></span> |<span data-ttu-id="f96cb-285">-, !</span><span class="sxs-lookup"><span data-stu-id="f96cb-285">-, !</span></span> |<span data-ttu-id="f96cb-286">Double</span><span class="sxs-lookup"><span data-stu-id="f96cb-286">double</span></span> |
| <span data-ttu-id="f96cb-287">*operátor*timeinterval</span><span class="sxs-lookup"><span data-stu-id="f96cb-287">*operator*timeinterval</span></span> |- |<span data-ttu-id="f96cb-288">TimeInterval</span><span class="sxs-lookup"><span data-stu-id="f96cb-288">timeinterval</span></span> |
| <span data-ttu-id="f96cb-289">dvojité *operátor* double</span><span class="sxs-lookup"><span data-stu-id="f96cb-289">double *operator* double</span></span> |<span data-ttu-id="f96cb-290"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="f96cb-290"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="f96cb-291">Double</span><span class="sxs-lookup"><span data-stu-id="f96cb-291">double</span></span> |
| <span data-ttu-id="f96cb-292">řetězec *operátor* řetězec</span><span class="sxs-lookup"><span data-stu-id="f96cb-292">string *operator* string</span></span> |<span data-ttu-id="f96cb-293"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="f96cb-293"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="f96cb-294">Double</span><span class="sxs-lookup"><span data-stu-id="f96cb-294">double</span></span> |
| <span data-ttu-id="f96cb-295">časové razítko *operátor* časové razítko</span><span class="sxs-lookup"><span data-stu-id="f96cb-295">timestamp *operator* timestamp</span></span> |<span data-ttu-id="f96cb-296"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="f96cb-296"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="f96cb-297">Double</span><span class="sxs-lookup"><span data-stu-id="f96cb-297">double</span></span> |
| <span data-ttu-id="f96cb-298">TimeInterval *operátor* timeinterval</span><span class="sxs-lookup"><span data-stu-id="f96cb-298">timeinterval *operator* timeinterval</span></span> |<span data-ttu-id="f96cb-299"><, <=, ==, >=, >, !=</span><span class="sxs-lookup"><span data-stu-id="f96cb-299"><, <=, ==, >=, >, !=</span></span> |<span data-ttu-id="f96cb-300">Double</span><span class="sxs-lookup"><span data-stu-id="f96cb-300">double</span></span> |
| <span data-ttu-id="f96cb-301">dvojité *operátor* double</span><span class="sxs-lookup"><span data-stu-id="f96cb-301">double *operator* double</span></span> |<span data-ttu-id="f96cb-302">&&, &#124;&#124;</span><span class="sxs-lookup"><span data-stu-id="f96cb-302">&&, &#124;&#124;</span></span> |<span data-ttu-id="f96cb-303">Double</span><span class="sxs-lookup"><span data-stu-id="f96cb-303">double</span></span> |

<span data-ttu-id="f96cb-304">Při testování dvojitou s Ternární operátor (`double ? statement1 : statement2`), nenulové hodnoty je **true**, a je nula **false**.</span><span class="sxs-lookup"><span data-stu-id="f96cb-304">When testing a double with a ternary operator (`double ? statement1 : statement2`), nonzero is **true**, and zero is **false**.</span></span>

## <a name="functions"></a><span data-ttu-id="f96cb-305">Funkce</span><span class="sxs-lookup"><span data-stu-id="f96cb-305">Functions</span></span>
<span data-ttu-id="f96cb-306">Tyto předdefinované **funkce** jsou k dispozici pro toouse k definování vzorec automatické škálování.</span><span class="sxs-lookup"><span data-stu-id="f96cb-306">These predefined **functions** are available for you toouse in defining an automatic scaling formula.</span></span>

| <span data-ttu-id="f96cb-307">Funkce</span><span class="sxs-lookup"><span data-stu-id="f96cb-307">Function</span></span> | <span data-ttu-id="f96cb-308">Návratový typ</span><span class="sxs-lookup"><span data-stu-id="f96cb-308">Return type</span></span> | <span data-ttu-id="f96cb-309">Popis</span><span class="sxs-lookup"><span data-stu-id="f96cb-309">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="f96cb-310">AVG(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="f96cb-310">avg(doubleVecList)</span></span> |<span data-ttu-id="f96cb-311">Double</span><span class="sxs-lookup"><span data-stu-id="f96cb-311">double</span></span> |<span data-ttu-id="f96cb-312">Vrátí hello průměrnou hodnotu pro všechny hodnoty v hello doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="f96cb-312">Returns hello average value for all values in hello doubleVecList.</span></span> |
| <span data-ttu-id="f96cb-313">Len(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="f96cb-313">len(doubleVecList)</span></span> |<span data-ttu-id="f96cb-314">Double</span><span class="sxs-lookup"><span data-stu-id="f96cb-314">double</span></span> |<span data-ttu-id="f96cb-315">Vrátí hello délka hello vektor, který je vytvořený z hello doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="f96cb-315">Returns hello length of hello vector that is created from hello doubleVecList.</span></span> |
| <span data-ttu-id="f96cb-316">LG(Double)</span><span class="sxs-lookup"><span data-stu-id="f96cb-316">lg(double)</span></span> |<span data-ttu-id="f96cb-317">Double</span><span class="sxs-lookup"><span data-stu-id="f96cb-317">double</span></span> |<span data-ttu-id="f96cb-318">Vrátí hodnotu hello protokolu základní 2 hello double.</span><span class="sxs-lookup"><span data-stu-id="f96cb-318">Returns hello log base 2 of hello double.</span></span> |
| <span data-ttu-id="f96cb-319">LG(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="f96cb-319">lg(doubleVecList)</span></span> |<span data-ttu-id="f96cb-320">doubleVec</span><span class="sxs-lookup"><span data-stu-id="f96cb-320">doubleVec</span></span> |<span data-ttu-id="f96cb-321">Vrátí základní 2 hello doubleVecList hello component-wise protokolu.</span><span class="sxs-lookup"><span data-stu-id="f96cb-321">Returns hello component-wise log base 2 of hello doubleVecList.</span></span> <span data-ttu-id="f96cb-322">Vec(double) musí být explicitně předán parametru hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-322">A vec(double) must be explicitly passed for hello parameter.</span></span> <span data-ttu-id="f96cb-323">Předpokládá se, jinak hodnota hello dvojité lg(double) verze.</span><span class="sxs-lookup"><span data-stu-id="f96cb-323">Otherwise, hello double lg(double) version is assumed.</span></span> |
| <span data-ttu-id="f96cb-324">ln(Double)</span><span class="sxs-lookup"><span data-stu-id="f96cb-324">ln(double)</span></span> |<span data-ttu-id="f96cb-325">Double</span><span class="sxs-lookup"><span data-stu-id="f96cb-325">double</span></span> |<span data-ttu-id="f96cb-326">Vrátí hello přirozené protokolu hello double.</span><span class="sxs-lookup"><span data-stu-id="f96cb-326">Returns hello natural log of hello double.</span></span> |
| <span data-ttu-id="f96cb-327">ln(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="f96cb-327">ln(doubleVecList)</span></span> |<span data-ttu-id="f96cb-328">doubleVec</span><span class="sxs-lookup"><span data-stu-id="f96cb-328">doubleVec</span></span> |<span data-ttu-id="f96cb-329">Vrátí základní 2 hello doubleVecList hello component-wise protokolu.</span><span class="sxs-lookup"><span data-stu-id="f96cb-329">Returns hello component-wise log base 2 of hello doubleVecList.</span></span> <span data-ttu-id="f96cb-330">Vec(double) musí být explicitně předán parametru hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-330">A vec(double) must be explicitly passed for hello parameter.</span></span> <span data-ttu-id="f96cb-331">Předpokládá se, jinak hodnota hello dvojité lg(double) verze.</span><span class="sxs-lookup"><span data-stu-id="f96cb-331">Otherwise, hello double lg(double) version is assumed.</span></span> |
| <span data-ttu-id="f96cb-332">log(Double)</span><span class="sxs-lookup"><span data-stu-id="f96cb-332">log(double)</span></span> |<span data-ttu-id="f96cb-333">Double</span><span class="sxs-lookup"><span data-stu-id="f96cb-333">double</span></span> |<span data-ttu-id="f96cb-334">Vrátí hodnotu hello protokolu základní 10 hello double.</span><span class="sxs-lookup"><span data-stu-id="f96cb-334">Returns hello log base 10 of hello double.</span></span> |
| <span data-ttu-id="f96cb-335">log(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="f96cb-335">log(doubleVecList)</span></span> |<span data-ttu-id="f96cb-336">doubleVec</span><span class="sxs-lookup"><span data-stu-id="f96cb-336">doubleVec</span></span> |<span data-ttu-id="f96cb-337">Vrátí hello component-wise protokolu základní 10 hello doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="f96cb-337">Returns hello component-wise log base 10 of hello doubleVecList.</span></span> <span data-ttu-id="f96cb-338">Vec(double) musí být explicitně předán jeden dvojité parametru hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-338">A vec(double) must be explicitly passed for hello single double parameter.</span></span> <span data-ttu-id="f96cb-339">Předpokládá se, jinak hodnota hello dvojité log(double) verze.</span><span class="sxs-lookup"><span data-stu-id="f96cb-339">Otherwise, hello double log(double) version is assumed.</span></span> |
| <span data-ttu-id="f96cb-340">Max(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="f96cb-340">max(doubleVecList)</span></span> |<span data-ttu-id="f96cb-341">Double</span><span class="sxs-lookup"><span data-stu-id="f96cb-341">double</span></span> |<span data-ttu-id="f96cb-342">Vrátí hello maximální hodnota v hello doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="f96cb-342">Returns hello maximum value in hello doubleVecList.</span></span> |
| <span data-ttu-id="f96cb-343">min(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="f96cb-343">min(doubleVecList)</span></span> |<span data-ttu-id="f96cb-344">Double</span><span class="sxs-lookup"><span data-stu-id="f96cb-344">double</span></span> |<span data-ttu-id="f96cb-345">Vrátí hello minimální hodnota v hello doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="f96cb-345">Returns hello minimum value in hello doubleVecList.</span></span> |
| <span data-ttu-id="f96cb-346">Norm(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="f96cb-346">norm(doubleVecList)</span></span> |<span data-ttu-id="f96cb-347">Double</span><span class="sxs-lookup"><span data-stu-id="f96cb-347">double</span></span> |<span data-ttu-id="f96cb-348">Vrátí hello dva norm hello vektor, který je vytvořený z hello doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="f96cb-348">Returns hello two-norm of hello vector that is created from hello doubleVecList.</span></span> |
| <span data-ttu-id="f96cb-349">percentil (doubleVec v dvojité p)</span><span class="sxs-lookup"><span data-stu-id="f96cb-349">percentile(doubleVec v, double p)</span></span> |<span data-ttu-id="f96cb-350">Double</span><span class="sxs-lookup"><span data-stu-id="f96cb-350">double</span></span> |<span data-ttu-id="f96cb-351">Vrátí hello percentilu element hello vektoru v.</span><span class="sxs-lookup"><span data-stu-id="f96cb-351">Returns hello percentile element of hello vector v.</span></span> |
| <span data-ttu-id="f96cb-352">rand()</span><span class="sxs-lookup"><span data-stu-id="f96cb-352">rand()</span></span> |<span data-ttu-id="f96cb-353">Double</span><span class="sxs-lookup"><span data-stu-id="f96cb-353">double</span></span> |<span data-ttu-id="f96cb-354">Vrátí náhodná hodnota mezi 0,0 a 1,0.</span><span class="sxs-lookup"><span data-stu-id="f96cb-354">Returns a random value between 0.0 and 1.0.</span></span> |
| <span data-ttu-id="f96cb-355">Range(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="f96cb-355">range(doubleVecList)</span></span> |<span data-ttu-id="f96cb-356">Double</span><span class="sxs-lookup"><span data-stu-id="f96cb-356">double</span></span> |<span data-ttu-id="f96cb-357">Vrátí hello rozdíl mezi hello minimální a maximální hodnoty v hello doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="f96cb-357">Returns hello difference between hello min and max values in hello doubleVecList.</span></span> |
| <span data-ttu-id="f96cb-358">STD(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="f96cb-358">std(doubleVecList)</span></span> |<span data-ttu-id="f96cb-359">Double</span><span class="sxs-lookup"><span data-stu-id="f96cb-359">double</span></span> |<span data-ttu-id="f96cb-360">Vrátí hello ukázka směrodatnou odchylku hodnot hello v hello doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="f96cb-360">Returns hello sample standard deviation of hello values in hello doubleVecList.</span></span> |
| <span data-ttu-id="f96cb-361">stop()</span><span class="sxs-lookup"><span data-stu-id="f96cb-361">stop()</span></span> | |<span data-ttu-id="f96cb-362">Zastaví vyhodnocování výrazu hello automatické škálování.</span><span class="sxs-lookup"><span data-stu-id="f96cb-362">Stops evaluation of hello autoscaling expression.</span></span> |
| <span data-ttu-id="f96cb-363">SUM(doubleVecList)</span><span class="sxs-lookup"><span data-stu-id="f96cb-363">sum(doubleVecList)</span></span> |<span data-ttu-id="f96cb-364">Double</span><span class="sxs-lookup"><span data-stu-id="f96cb-364">double</span></span> |<span data-ttu-id="f96cb-365">Vrátí hello součet všech součástí hello hello doubleVecList.</span><span class="sxs-lookup"><span data-stu-id="f96cb-365">Returns hello sum of all hello components of hello doubleVecList.</span></span> |
| <span data-ttu-id="f96cb-366">čas (řetězce data a času = "")</span><span class="sxs-lookup"><span data-stu-id="f96cb-366">time(string dateTime="")</span></span> |<span data-ttu-id="f96cb-367">časové razítko</span><span class="sxs-lookup"><span data-stu-id="f96cb-367">timestamp</span></span> |<span data-ttu-id="f96cb-368">Vrátí hello časového razítka hello aktuální čas, pokud žádné parametry jsou předávány nebo hello časové razítko hello řetězce data a času, je-li předán.</span><span class="sxs-lookup"><span data-stu-id="f96cb-368">Returns hello time stamp of hello current time if no parameters are passed, or hello time stamp of hello dateTime string if it is passed.</span></span> <span data-ttu-id="f96cb-369">Data a času podporované formáty jsou W3C DTF a RFC 1123.</span><span class="sxs-lookup"><span data-stu-id="f96cb-369">Supported dateTime formats are W3C-DTF and RFC 1123.</span></span> |
| <span data-ttu-id="f96cb-370">Val (doubleVec v dvojité i)</span><span class="sxs-lookup"><span data-stu-id="f96cb-370">val(doubleVec v, double i)</span></span> |<span data-ttu-id="f96cb-371">Double</span><span class="sxs-lookup"><span data-stu-id="f96cb-371">double</span></span> |<span data-ttu-id="f96cb-372">Vrátí hodnotu hello hello element, který je v umístění i u funkce vector v, počáteční index nula.</span><span class="sxs-lookup"><span data-stu-id="f96cb-372">Returns hello value of hello element that is at location i in vector v, with a starting index of zero.</span></span> |

<span data-ttu-id="f96cb-373">Seznam některých hello funkcí, které jsou popsané v předchozí tabulce hello může přijmout jako argument.</span><span class="sxs-lookup"><span data-stu-id="f96cb-373">Some of hello functions that are described in hello previous table can accept a list as an argument.</span></span> <span data-ttu-id="f96cb-374">seznam oddělený čárkami Hello je libovolnou kombinaci *dvojité* a *doubleVec*.</span><span class="sxs-lookup"><span data-stu-id="f96cb-374">hello comma-separated list is any combination of *double* and *doubleVec*.</span></span> <span data-ttu-id="f96cb-375">Například:</span><span class="sxs-lookup"><span data-stu-id="f96cb-375">For example:</span></span>

`doubleVecList := ( (double | doubleVec)+(, (double | doubleVec) )* )?`

<span data-ttu-id="f96cb-376">Hello *doubleVecList* hodnota je převeden tooa jeden *doubleVec* před vyhodnocení.</span><span class="sxs-lookup"><span data-stu-id="f96cb-376">hello *doubleVecList* value is converted tooa single *doubleVec* before evaluation.</span></span> <span data-ttu-id="f96cb-377">Například pokud `v = [1,2,3]`, pak volání `avg(v)` je ekvivalentní toocalling `avg(1,2,3)`.</span><span class="sxs-lookup"><span data-stu-id="f96cb-377">For example, if `v = [1,2,3]`, then calling `avg(v)` is equivalent toocalling `avg(1,2,3)`.</span></span> <span data-ttu-id="f96cb-378">Volání metody `avg(v, 7)` je ekvivalentní toocalling `avg(1,2,3,7)`.</span><span class="sxs-lookup"><span data-stu-id="f96cb-378">Calling `avg(v, 7)` is equivalent toocalling `avg(1,2,3,7)`.</span></span>

## <span data-ttu-id="f96cb-379"><a name="getsampledata"></a>Získat ukázková data</span><span class="sxs-lookup"><span data-stu-id="f96cb-379"><a name="getsampledata"></a>Obtain sample data</span></span>
<span data-ttu-id="f96cb-380">Vzorce automatického škálování fungují na data metriky (Ukázky), která zajišťuje hello služby Batch.</span><span class="sxs-lookup"><span data-stu-id="f96cb-380">Autoscale formulas act on metrics data (samples) that is provided by hello Batch service.</span></span> <span data-ttu-id="f96cb-381">Vzorec zvětšováním nebo zmenšováním velikost fondu na základě hello hodnot, které se získá od služby hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-381">A formula grows or shrinks pool size based on hello values that it obtains from hello service.</span></span> <span data-ttu-id="f96cb-382">Hello služby-proměnných definovaných popsané dříve jsou objekty, které poskytují různé metody tooaccess dat, který je přidružený tento objekt.</span><span class="sxs-lookup"><span data-stu-id="f96cb-382">hello service-defined variables that were described previously are objects that provide various methods tooaccess data that is associated with that object.</span></span> <span data-ttu-id="f96cb-383">Například hello následující výraz ukazuje žádost tooget hello posledních pět minut využití procesoru:</span><span class="sxs-lookup"><span data-stu-id="f96cb-383">For example, hello following expression shows a request tooget hello last five minutes of CPU usage:</span></span>

```
$CPUPercent.GetSample(TimeInterval_Minute * 5)
```

| <span data-ttu-id="f96cb-384">Metoda</span><span class="sxs-lookup"><span data-stu-id="f96cb-384">Method</span></span> | <span data-ttu-id="f96cb-385">Popis</span><span class="sxs-lookup"><span data-stu-id="f96cb-385">Description</span></span> |
| --- | --- |
| <span data-ttu-id="f96cb-386">GetSample()</span><span class="sxs-lookup"><span data-stu-id="f96cb-386">GetSample()</span></span> |<span data-ttu-id="f96cb-387">Hello `GetSample()` metoda vrátí Vektor vzorků dat.</span><span class="sxs-lookup"><span data-stu-id="f96cb-387">hello `GetSample()` method returns a vector of data samples.</span></span><br/><br/><span data-ttu-id="f96cb-388">Ukázka je 30 sekund vhodné dat metriky.</span><span class="sxs-lookup"><span data-stu-id="f96cb-388">A sample is 30 seconds worth of metrics data.</span></span> <span data-ttu-id="f96cb-389">Jinými slovy ukázky jsou získávány každých 30 sekund.</span><span class="sxs-lookup"><span data-stu-id="f96cb-389">In other words, samples are obtained every 30 seconds.</span></span> <span data-ttu-id="f96cb-390">Ale dole uvedených položek, dochází ke zpoždění mezi při shromažďování ukázku a kdy je k dispozici tooa vzorec.</span><span class="sxs-lookup"><span data-stu-id="f96cb-390">But as noted below, there is a delay between when a sample is collected and when it is available tooa formula.</span></span> <span data-ttu-id="f96cb-391">Ne všechny ukázky pro dané časové období jako takový, může být dostupné pro vyhodnocení podle vzorce.</span><span class="sxs-lookup"><span data-stu-id="f96cb-391">As such, not all samples for a given time period may be available for evaluation by a formula.</span></span><ul><li>`doubleVec GetSample(double count)`<br/><span data-ttu-id="f96cb-392">Určuje počet hello tooobtain ukázky z hello nejnovější vzorků, které byly shromážděny.</span><span class="sxs-lookup"><span data-stu-id="f96cb-392">Specifies hello number of samples tooobtain from hello most recent samples that were collected.</span></span><br/><br/><span data-ttu-id="f96cb-393">`GetSample(1)`vrací posledního vzorku dostupné hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-393">`GetSample(1)` returns hello last available sample.</span></span> <span data-ttu-id="f96cb-394">Pro metriky `$CPUPercent`, ale to nesmí použít, protože je možné tooknow *při* hello ukázka nebyla shromážděna.</span><span class="sxs-lookup"><span data-stu-id="f96cb-394">For metrics like `$CPUPercent`, however, this should not be used because it is impossible tooknow *when* hello sample was collected.</span></span> <span data-ttu-id="f96cb-395">Může to být poslední, nebo kvůli problémům s systému, může být mnohem starší.</span><span class="sxs-lookup"><span data-stu-id="f96cb-395">It might be recent, or, because of system issues, it might be much older.</span></span> <span data-ttu-id="f96cb-396">Je lepší v takových případech toouse časový interval, jak je uvedeno níže.</span><span class="sxs-lookup"><span data-stu-id="f96cb-396">It is better in such cases toouse a time interval as shown below.</span></span><li>`doubleVec GetSample((timestamp or timeinterval) startTime [, double samplePercent])`<br/><span data-ttu-id="f96cb-397">Určuje časový rámec pro shromažďování ukázková data.</span><span class="sxs-lookup"><span data-stu-id="f96cb-397">Specifies a time frame for gathering sample data.</span></span> <span data-ttu-id="f96cb-398">Volitelně můžete také určuje procento hello vzorků, které musí být k dispozici v hello požadovanou časového rámce.</span><span class="sxs-lookup"><span data-stu-id="f96cb-398">Optionally, it also specifies hello percentage of samples that must be available in hello requested time frame.</span></span><br/><br/><span data-ttu-id="f96cb-399">`$CPUPercent.GetSample(TimeInterval_Minute * 10)`Vrátí 20 vzorků v případě všechny ukázky pro hello posledních 10 minut se nacházejí v historii CPUPercent hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-399">`$CPUPercent.GetSample(TimeInterval_Minute * 10)` would return 20 samples if all samples for hello last 10 minutes are present in hello CPUPercent history.</span></span> <span data-ttu-id="f96cb-400">Pokud hello poslední minutu historie nebyl k dispozici, ale pouze 18 ukázky by byla vrácena.</span><span class="sxs-lookup"><span data-stu-id="f96cb-400">If hello last minute of history was not available, however, only 18 samples would be returned.</span></span> <span data-ttu-id="f96cb-401">V takovém případě:</span><span class="sxs-lookup"><span data-stu-id="f96cb-401">In this case:</span></span><br/><br/><span data-ttu-id="f96cb-402">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 95)`selže, protože nejsou k dispozici pouze 90 procent hello ukázky.</span><span class="sxs-lookup"><span data-stu-id="f96cb-402">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 95)` would fail because only 90 percent of hello samples are available.</span></span><br/><br/><span data-ttu-id="f96cb-403">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 80)`mohla být úspěšná.</span><span class="sxs-lookup"><span data-stu-id="f96cb-403">`$CPUPercent.GetSample(TimeInterval_Minute * 10, 80)` would succeed.</span></span><li>`doubleVec GetSample((timestamp or timeinterval) startTime, (timestamp or timeinterval) endTime [, double samplePercent])`<br/><span data-ttu-id="f96cb-404">Určuje časový rámec pro shromažďování dat, s počáteční čas a koncový čas.</span><span class="sxs-lookup"><span data-stu-id="f96cb-404">Specifies a time frame for gathering data, with both a start time and an end time.</span></span><br/><br/><span data-ttu-id="f96cb-405">Jak je uvedeno nahoře, dochází ke zpoždění mezi při shromažďování ukázku a kdy je k dispozici tooa vzorec.</span><span class="sxs-lookup"><span data-stu-id="f96cb-405">As mentioned above, there is a delay between when a sample is collected and when it is available tooa formula.</span></span> <span data-ttu-id="f96cb-406">Vezměte v úvahu tato prodleva při použití hello `GetSample` metoda.</span><span class="sxs-lookup"><span data-stu-id="f96cb-406">Consider this delay when you use hello `GetSample` method.</span></span> <span data-ttu-id="f96cb-407">V tématu `GetSamplePercent` níže.</span><span class="sxs-lookup"><span data-stu-id="f96cb-407">See `GetSamplePercent` below.</span></span> |
| <span data-ttu-id="f96cb-408">GetSamplePeriod()</span><span class="sxs-lookup"><span data-stu-id="f96cb-408">GetSamplePeriod()</span></span> |<span data-ttu-id="f96cb-409">Vrátí hello období vzorků, které byly provedeny v datové sadě historických ukázka.</span><span class="sxs-lookup"><span data-stu-id="f96cb-409">Returns hello period of samples that were taken in a historical sample data set.</span></span> |
| <span data-ttu-id="f96cb-410">Count()</span><span class="sxs-lookup"><span data-stu-id="f96cb-410">Count()</span></span> |<span data-ttu-id="f96cb-411">Vrátí hello celkového počtu vzorků v historii metriky hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-411">Returns hello total number of samples in hello metric history.</span></span> |
| <span data-ttu-id="f96cb-412">HistoryBeginTime()</span><span class="sxs-lookup"><span data-stu-id="f96cb-412">HistoryBeginTime()</span></span> |<span data-ttu-id="f96cb-413">Vrátí hello časové razítko hello nejstarší dostupných dat ukázky pro metriku hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-413">Returns hello time stamp of hello oldest available data sample for hello metric.</span></span> |
| <span data-ttu-id="f96cb-414">GetSamplePercent()</span><span class="sxs-lookup"><span data-stu-id="f96cb-414">GetSamplePercent()</span></span> |<span data-ttu-id="f96cb-415">Vrátí hello procento vzorků, které jsou k dispozici v daném časovém intervalu.</span><span class="sxs-lookup"><span data-stu-id="f96cb-415">Returns hello percentage of samples that are available for a given time interval.</span></span> <span data-ttu-id="f96cb-416">Například:</span><span class="sxs-lookup"><span data-stu-id="f96cb-416">For example:</span></span><br/><br/>`doubleVec GetSamplePercent( (timestamp or timeinterval) startTime [, (timestamp or timeinterval) endTime] )`<br/><br/><span data-ttu-id="f96cb-417">Protože hello `GetSample` metoda selže, pokud procento hello vrátil vzorků, které je menší než hello `samplePercent` zadána, můžete použít hello `GetSamplePercent` metoda toocheck první.</span><span class="sxs-lookup"><span data-stu-id="f96cb-417">Because hello `GetSample` method fails if hello percentage of samples returned is less than hello `samplePercent` specified, you can use hello `GetSamplePercent` method toocheck first.</span></span> <span data-ttu-id="f96cb-418">Poté můžete provádět alternativní akce když dostatek ukázky jsou přítomny, bez zastavení hello automatické škálování vyhodnocení.</span><span class="sxs-lookup"><span data-stu-id="f96cb-418">Then you can perform an alternate action if insufficient samples are present, without halting hello automatic scaling evaluation.</span></span> |

### <a name="samples-sample-percentage-and-hello-getsample-method"></a><span data-ttu-id="f96cb-419">Ukázky, ukázka procento a hello *GetSample()* – metoda</span><span class="sxs-lookup"><span data-stu-id="f96cb-419">Samples, sample percentage, and hello *GetSample()* method</span></span>
<span data-ttu-id="f96cb-420">Hello základní provoz od vzorce automatického škálování je tooobtain úlohy a prostředku metriky dat a upravte velikost fondu podle data.</span><span class="sxs-lookup"><span data-stu-id="f96cb-420">hello core operation of an autoscale formula is tooobtain task and resource metric data and then adjust pool size based on that data.</span></span> <span data-ttu-id="f96cb-421">Jako takový je důležité toohave vědět, jak vzorce automatického škálování pracovat s daty metrik (Ukázky).</span><span class="sxs-lookup"><span data-stu-id="f96cb-421">As such, it is important toohave a clear understanding of how autoscale formulas interact with metrics data (samples).</span></span>

<span data-ttu-id="f96cb-422">**Ukázky**</span><span class="sxs-lookup"><span data-stu-id="f96cb-422">**Samples**</span></span>

<span data-ttu-id="f96cb-423">Hello služba Batch pravidelně využívá ukázky úlohy a prostředku metriky a zajišťuje je k dispozici tooyour vzorce automatického škálování.</span><span class="sxs-lookup"><span data-stu-id="f96cb-423">hello Batch service periodically takes samples of task and resource metrics and makes them available tooyour autoscale formulas.</span></span> <span data-ttu-id="f96cb-424">Tyto ukázky zaznamenávají každých 30 sekund podle hello služby Batch.</span><span class="sxs-lookup"><span data-stu-id="f96cb-424">These samples are recorded every 30 seconds by hello Batch service.</span></span> <span data-ttu-id="f96cb-425">Je však obvykle zpoždění mezi při nebyly zaznamenány tyto ukázky a když jsou k dispozici příliš (a mohou být přečteny) vzorcích škálování.</span><span class="sxs-lookup"><span data-stu-id="f96cb-425">However, there is typically a delay between when those samples were recorded and when they are made available too(and can be read by) your autoscale formulas.</span></span> <span data-ttu-id="f96cb-426">Kromě toho kvůli toovarious faktorech, například sítě nebo jiných problémů s infrastrukturou, nemusí být ukázky zaznamenány pro konkrétním intervalu.</span><span class="sxs-lookup"><span data-stu-id="f96cb-426">Additionally, due toovarious factors such as network or other infrastructure issues, samples may not be recorded for a particular interval.</span></span>

<span data-ttu-id="f96cb-427">**Ukázka procento**</span><span class="sxs-lookup"><span data-stu-id="f96cb-427">**Sample percentage**</span></span>

<span data-ttu-id="f96cb-428">Když `samplePercent` je předán toohello `GetSample()` metoda nebo hello `GetSamplePercent()` metoda je volána, _procent_ odkazuje tooa srovnání hello celkový možný počet vzorků, které jsou zaznamenány hello služby Batch a Hello počet vzorků, které jsou k dispozici tooyour vzorec škálování.</span><span class="sxs-lookup"><span data-stu-id="f96cb-428">When `samplePercent` is passed toohello `GetSample()` method or hello `GetSamplePercent()` method is called, _percent_ refers tooa comparison between hello total possible number of samples that are recorded by hello Batch service and hello number of samples that are available tooyour autoscale formula.</span></span>

<span data-ttu-id="f96cb-429">Podívejme se na časový interval 10 minut jako příklad.</span><span class="sxs-lookup"><span data-stu-id="f96cb-429">Let's look at a 10-minute timespan as an example.</span></span> <span data-ttu-id="f96cb-430">Protože vzorky se zaznamenávají každých 30 sekund v rámci časový interval 10 minut, bude hello maximální celkový počet vzorků, které se zaznamenávají dávkou 20 vzorků (2 za minutu).</span><span class="sxs-lookup"><span data-stu-id="f96cb-430">Because samples are recorded every 30 seconds within a 10-minute timespan, hello maximum total number of samples that are recorded by Batch would be 20 samples (2 per minute).</span></span> <span data-ttu-id="f96cb-431">Ale kvůli toohello vyplývajících latence hello reporting mechanismus a další problémy v rámci Azure, může existovat pouze 15 vzorků, které jsou k dispozici tooyour vzorec škálování pro čtení.</span><span class="sxs-lookup"><span data-stu-id="f96cb-431">However, due toohello inherent latency of hello reporting mechanism and other issues within Azure, there may be only 15 samples that are available tooyour autoscale formula for reading.</span></span> <span data-ttu-id="f96cb-432">Ano například tuto dobu 10 minut 75 % hello celkový počet vzorků, které zaznamenávají může být k dispozici tooyour vzorec.</span><span class="sxs-lookup"><span data-stu-id="f96cb-432">So, for example, for that 10-minute period, only 75% of hello total number of samples recorded may be available tooyour formula.</span></span>

<span data-ttu-id="f96cb-433">**GetSample() a ukázkové rozsahů**</span><span class="sxs-lookup"><span data-stu-id="f96cb-433">**GetSample() and sample ranges**</span></span>

<span data-ttu-id="f96cb-434">Vaše vzorce automatického škálování jsou probíhající toobe zvětšování a zmenšování fondech &mdash; uzly pro přidání nebo odebrání uzlů.</span><span class="sxs-lookup"><span data-stu-id="f96cb-434">Your autoscale formulas are going toobe growing and shrinking your pools &mdash; adding nodes or removing nodes.</span></span> <span data-ttu-id="f96cb-435">Vzhledem k tomu, že uzly náklady peníze, budete chtít tooensure, který vzorcích používat metodu inteligentního analýzy, která je založená na dostatečného množství dat.</span><span class="sxs-lookup"><span data-stu-id="f96cb-435">Because nodes cost you money, you want tooensure that your formulas use an intelligent method of analysis that is based on sufficient data.</span></span> <span data-ttu-id="f96cb-436">Proto doporučujeme použít k analýze trendů typu ve vzorcích.</span><span class="sxs-lookup"><span data-stu-id="f96cb-436">Therefore, we recommend that you use a trending-type analysis in your formulas.</span></span> <span data-ttu-id="f96cb-437">Tento typ zvětšování a zmenší fondech na základě rozsahu shromažďovaných vzorků.</span><span class="sxs-lookup"><span data-stu-id="f96cb-437">This type grows and shrinks your pools based on a range of collected samples.</span></span>

<span data-ttu-id="f96cb-438">Ano, použít toodo `GetSample(interval look-back start, interval look-back end)` tooreturn vektoru vzorků:</span><span class="sxs-lookup"><span data-stu-id="f96cb-438">toodo so, use `GetSample(interval look-back start, interval look-back end)` tooreturn a vector of samples:</span></span>

```
$runningTasksSample = $RunningTasks.GetSample(1 * TimeInterval_Minute, 6 * TimeInterval_Minute);
```

<span data-ttu-id="f96cb-439">Vyhodnocena hello nad řádkem dávkou vrátí oblast ukázky vektor hodnot.</span><span class="sxs-lookup"><span data-stu-id="f96cb-439">When hello above line is evaluated by Batch, it returns a range of samples as a vector of values.</span></span> <span data-ttu-id="f96cb-440">Například:</span><span class="sxs-lookup"><span data-stu-id="f96cb-440">For example:</span></span>

```
$runningTasksSample=[1,1,1,1,1,1,1,1,1,1];
```

<span data-ttu-id="f96cb-441">Jakmile jste získány hello vektor ukázky, pak můžete použít funkce jako `min()`, `max()`, a `avg()` tooderive smysluplný hodnoty z hello shromážděných rozsahu.</span><span class="sxs-lookup"><span data-stu-id="f96cb-441">Once you've collected hello vector of samples, you can then use functions like `min()`, `max()`, and `avg()` tooderive meaningful values from hello collected range.</span></span>

<span data-ttu-id="f96cb-442">Pro dodatečné zabezpečení můžete vynutit vzorců toofail nižší než určité procento ukázka je dostupná pro konkrétní časové období.</span><span class="sxs-lookup"><span data-stu-id="f96cb-442">For additional security, you can force a formula evaluation toofail if less than a certain sample percentage is available for a particular time period.</span></span> <span data-ttu-id="f96cb-443">Pokud vynutíte toofail vzorců, požádejte Batch toocease další vyhodnocení hello vzorec Pokud hello zadané procento vzorků, které není k dispozici.</span><span class="sxs-lookup"><span data-stu-id="f96cb-443">When you force a formula evaluation toofail, you instruct Batch toocease further evaluation of hello formula if hello specified percentage of samples is not available.</span></span> <span data-ttu-id="f96cb-444">V takovém případě je provedena žádná změna toohello velikost fondu.</span><span class="sxs-lookup"><span data-stu-id="f96cb-444">In this case, no change is made toohello pool size.</span></span> <span data-ttu-id="f96cb-445">toospecify požadované procento ukázky pro vyhodnocení toosucceed hello, zadejte ji jako hello třetí parametr příliš`GetSample()`.</span><span class="sxs-lookup"><span data-stu-id="f96cb-445">toospecify a required percentage of samples for hello evaluation toosucceed, specify it as hello third parameter too`GetSample()`.</span></span> <span data-ttu-id="f96cb-446">Zde je zadán požadavek 75 procent ukázky:</span><span class="sxs-lookup"><span data-stu-id="f96cb-446">Here, a requirement of 75 percent of samples is specified:</span></span>

```
$runningTasksSample = $RunningTasks.GetSample(60 * TimeInterval_Second, 120 * TimeInterval_Second, 75);
```

<span data-ttu-id="f96cb-447">Protože ukázka dostupnosti může dojít ke zpoždění, je důležité, tooalways zadejte časový interval s časem zahájení vzhled zpět, která jsou starší než jedna minuta.</span><span class="sxs-lookup"><span data-stu-id="f96cb-447">Because there may be a delay in sample availability, it is important tooalways specify a time range with a look-back start time that is older than one minute.</span></span> <span data-ttu-id="f96cb-448">Jak dlouho trvá přibližně jednu minutu pro ukázky toopropagate prostřednictvím systému hello, takže ukázky v rozsahu hello `(0 * TimeInterval_Second, 60 * TimeInterval_Second)` nemusí být k dispozici.</span><span class="sxs-lookup"><span data-stu-id="f96cb-448">It takes approximately one minute for samples toopropagate through hello system, so samples in hello range `(0 * TimeInterval_Second, 60 * TimeInterval_Second)` may not be available.</span></span> <span data-ttu-id="f96cb-449">Znovu, můžete použít parametr procento hello `GetSample()` tooforce požadavek procento konkrétní vzorek.</span><span class="sxs-lookup"><span data-stu-id="f96cb-449">Again, you can use hello percentage parameter of `GetSample()` tooforce a particular sample percentage requirement.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="f96cb-450">Jsme **důrazně doporučujeme** , které **se spoléhat *pouze* na `GetSample(1)` ve vzorcích škálování**.</span><span class="sxs-lookup"><span data-stu-id="f96cb-450">We **strongly recommend** that you **avoid relying *only* on `GetSample(1)` in your autoscale formulas**.</span></span> <span data-ttu-id="f96cb-451">Důvodem je, že `GetSample(1)` v podstatě uvádí toohello služby Batch, "Udělení mi hello posledního vzorku máte, bez ohledu na dobu načíst."</span><span class="sxs-lookup"><span data-stu-id="f96cb-451">This is because `GetSample(1)` essentially says toohello Batch service, "Give me hello last sample you have, no matter how long ago you retrieved it."</span></span> <span data-ttu-id="f96cb-452">Vzhledem k tomu, že je pouze jeden vzorku a může být starší ukázkové, nemusí být zástupce hello větší přehled o poslední úlohu nebo stav prostředku.</span><span class="sxs-lookup"><span data-stu-id="f96cb-452">Since it is only a single sample, and it may be an older sample, it may not be representative of hello larger picture of recent task or resource state.</span></span> <span data-ttu-id="f96cb-453">Pokud používáte `GetSample(1)`, ujistěte se, že je součástí větší příkazu a není hello pouze datový bod, který vzorec spoléhá na.</span><span class="sxs-lookup"><span data-stu-id="f96cb-453">If you do use `GetSample(1)`, make sure that it's part of a larger statement and not hello only data point that your formula relies on.</span></span>
>
>

## <a name="metrics"></a><span data-ttu-id="f96cb-454">Metriky</span><span class="sxs-lookup"><span data-stu-id="f96cb-454">Metrics</span></span>
<span data-ttu-id="f96cb-455">Prostředek a úloha metriky můžete použít, když definujete vzorec.</span><span class="sxs-lookup"><span data-stu-id="f96cb-455">You can use both resource and task metrics when you're defining a formula.</span></span> <span data-ttu-id="f96cb-456">Můžete upravit hello cílový počet vyhrazených uzlů ve fondu hello na základě hello metriky dat, který můžete získat a vyhodnocení.</span><span class="sxs-lookup"><span data-stu-id="f96cb-456">You adjust hello target number of dedicated nodes in hello pool based on hello metrics data that you obtain and evaluate.</span></span> <span data-ttu-id="f96cb-457">V tématu hello [proměnné](#variables) části výše pro další informace o jednotlivé metriky.</span><span class="sxs-lookup"><span data-stu-id="f96cb-457">See hello [Variables](#variables) section above for more information on each metric.</span></span>

<table>
  <tr>
    <th><span data-ttu-id="f96cb-458">Metrika</span><span class="sxs-lookup"><span data-stu-id="f96cb-458">Metric</span></span></th>
    <th><span data-ttu-id="f96cb-459">Popis</span><span class="sxs-lookup"><span data-stu-id="f96cb-459">Description</span></span></th>
  </tr>
  <tr>
    <td><span data-ttu-id="f96cb-460"><b>Prostředek</b></span><span class="sxs-lookup"><span data-stu-id="f96cb-460"><b>Resource</b></span></span></td>
    <td><p><span data-ttu-id="f96cb-461">Metrika prostředků jsou založené na hello procesoru, šířky pásma hello, využití paměti hello výpočetních uzlů a hello počet uzlů.</span><span class="sxs-lookup"><span data-stu-id="f96cb-461">Resource metrics are based on hello CPU, hello bandwidth, hello memory usage of compute nodes, and hello number of nodes.</span></span></p>
        <p> <span data-ttu-id="f96cb-462">Tyto proměnné definované služby jsou užitečné pro provádění úprav na základě počtu uzlu:</span><span class="sxs-lookup"><span data-stu-id="f96cb-462">These service-defined variables are useful for making adjustments based on node count:</span></span></p>
    <p><ul>
            <li><span data-ttu-id="f96cb-463">$TargetDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="f96cb-463">$TargetDedicatedNodes</span></span></li>
            <li><span data-ttu-id="f96cb-464">$TargetLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="f96cb-464">$TargetLowPriorityNodes</span></span></li>
            <li><span data-ttu-id="f96cb-465">$CurrentDedicatedNodes</span><span class="sxs-lookup"><span data-stu-id="f96cb-465">$CurrentDedicatedNodes</span></span></li>
            <li><span data-ttu-id="f96cb-466">$CurrentLowPriorityNodes</span><span class="sxs-lookup"><span data-stu-id="f96cb-466">$CurrentLowPriorityNodes</span></span></li>
            <li><span data-ttu-id="f96cb-467">$preemptedNodeCount</span><span class="sxs-lookup"><span data-stu-id="f96cb-467">$preemptedNodeCount</span></span></li>
            <li><span data-ttu-id="f96cb-468">$SampleNodeCount</span><span class="sxs-lookup"><span data-stu-id="f96cb-468">$SampleNodeCount</span></span></li>
    </ul></p>
    <p><span data-ttu-id="f96cb-469">Tyto proměnné definované služby jsou užitečné pro provádění úprav na základě využití prostředků uzlu:</span><span class="sxs-lookup"><span data-stu-id="f96cb-469">These service-defined variables are useful for making adjustments based on node resource usage:</span></span></p>
    <p><ul>
      <li><span data-ttu-id="f96cb-470">$CPUPercent</span><span class="sxs-lookup"><span data-stu-id="f96cb-470">$CPUPercent</span></span></li>
      <li><span data-ttu-id="f96cb-471">$WallClockSeconds</span><span class="sxs-lookup"><span data-stu-id="f96cb-471">$WallClockSeconds</span></span></li>
      <li><span data-ttu-id="f96cb-472">$MemoryBytes</span><span class="sxs-lookup"><span data-stu-id="f96cb-472">$MemoryBytes</span></span></li>
      <li><span data-ttu-id="f96cb-473">$DiskBytes</span><span class="sxs-lookup"><span data-stu-id="f96cb-473">$DiskBytes</span></span></li>
      <li><span data-ttu-id="f96cb-474">$DiskReadBytes</span><span class="sxs-lookup"><span data-stu-id="f96cb-474">$DiskReadBytes</span></span></li>
      <li><span data-ttu-id="f96cb-475">$DiskWriteBytes</span><span class="sxs-lookup"><span data-stu-id="f96cb-475">$DiskWriteBytes</span></span></li>
      <li><span data-ttu-id="f96cb-476">$DiskReadOps</span><span class="sxs-lookup"><span data-stu-id="f96cb-476">$DiskReadOps</span></span></li>
      <li><span data-ttu-id="f96cb-477">$DiskWriteOps</span><span class="sxs-lookup"><span data-stu-id="f96cb-477">$DiskWriteOps</span></span></li>
      <li><span data-ttu-id="f96cb-478">$NetworkInBytes</span><span class="sxs-lookup"><span data-stu-id="f96cb-478">$NetworkInBytes</span></span></li>
      <li><span data-ttu-id="f96cb-479">$NetworkOutBytes</span><span class="sxs-lookup"><span data-stu-id="f96cb-479">$NetworkOutBytes</span></span></li></ul></p>
  </tr>
  <tr>
    <td><span data-ttu-id="f96cb-480"><b>Úkol</b></span><span class="sxs-lookup"><span data-stu-id="f96cb-480"><b>Task</b></span></span></td>
    <td><p><span data-ttu-id="f96cb-481">Metriky úloh jsou na základě hello stavu úkolů, například aktivní, čeká na vyřízení a byla dokončena.</span><span class="sxs-lookup"><span data-stu-id="f96cb-481">Task metrics are based on hello status of tasks, such as Active, Pending, and Completed.</span></span> <span data-ttu-id="f96cb-482">Hello následující proměnné definované služby jsou užitečné pro provádění úprav velikost fondu na základě metriky úloh:</span><span class="sxs-lookup"><span data-stu-id="f96cb-482">hello following service-defined variables are useful for making pool-size adjustments based on task metrics:</span></span></p>
    <p><ul>
      <li><span data-ttu-id="f96cb-483">$ActiveTasks</span><span class="sxs-lookup"><span data-stu-id="f96cb-483">$ActiveTasks</span></span></li>
      <li><span data-ttu-id="f96cb-484">$RunningTasks</span><span class="sxs-lookup"><span data-stu-id="f96cb-484">$RunningTasks</span></span></li>
      <li><span data-ttu-id="f96cb-485">$PendingTasks</span><span class="sxs-lookup"><span data-stu-id="f96cb-485">$PendingTasks</span></span></li>
      <li><span data-ttu-id="f96cb-486">$SucceededTasks</span><span class="sxs-lookup"><span data-stu-id="f96cb-486">$SucceededTasks</span></span></li>
            <li><span data-ttu-id="f96cb-487">$FailedTasks</span><span class="sxs-lookup"><span data-stu-id="f96cb-487">$FailedTasks</span></span></li></ul></p>
        </td>
  </tr>
</table>

## <a name="write-an-autoscale-formula"></a><span data-ttu-id="f96cb-488">Zápis vzorec škálování</span><span class="sxs-lookup"><span data-stu-id="f96cb-488">Write an autoscale formula</span></span>
<span data-ttu-id="f96cb-489">Sestavení se vzorec škálování vytvořením příkazy, které používají hello výše součásti a potom kombinace těchto příkazů do dokončení vzorce.</span><span class="sxs-lookup"><span data-stu-id="f96cb-489">You build an autoscale formula by forming statements that use hello above components, then combine those statements into a complete formula.</span></span> <span data-ttu-id="f96cb-490">V této části vytvoříme vzorec škálování příklad, který může provádět některé reálného škálování rozhodnutí.</span><span class="sxs-lookup"><span data-stu-id="f96cb-490">In this section, we create an example autoscale formula that can perform some real-world scaling decisions.</span></span>

<span data-ttu-id="f96cb-491">Nejdříve definujme hello požadavky pro naše nové vzorec škálování.</span><span class="sxs-lookup"><span data-stu-id="f96cb-491">First, let's define hello requirements for our new autoscale formula.</span></span> <span data-ttu-id="f96cb-492">Vzorec Hello proveďte následující kroky:</span><span class="sxs-lookup"><span data-stu-id="f96cb-492">hello formula should:</span></span>

1. <span data-ttu-id="f96cb-493">Zvýšit číslo cílového hello vyhrazené výpočetních uzlů ve fondu, pokud využití CPU je vysoké.</span><span class="sxs-lookup"><span data-stu-id="f96cb-493">Increase hello target number of dedicated compute nodes in a pool if CPU usage is high.</span></span>
2. <span data-ttu-id="f96cb-494">Hello cílový počet vyhrazených výpočetních uzlů ve fondu snížit, až bude malé využití procesoru.</span><span class="sxs-lookup"><span data-stu-id="f96cb-494">Decrease hello target number of dedicated compute nodes in a pool when CPU usage is low.</span></span>
3. <span data-ttu-id="f96cb-495">Vždy omezte maximální počet vyhrazených uzlů too400 hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-495">Always restrict hello maximum number of dedicated nodes too400.</span></span>

<span data-ttu-id="f96cb-496">tooincrease hello počet uzlů během vysoké využití procesoru, zadejte příkaz hello, které naplňuje uživatelem definované proměnné (`$totalDedicatedNodes`) s hodnotou, která je 110 procent hello aktuální cílový počet vyhrazených uzlů, ale pouze pokud hello minimální průměrné využití procesoru během hello posledních 10 minut byla vyšší než 70 procent.</span><span class="sxs-lookup"><span data-stu-id="f96cb-496">tooincrease hello number of nodes during high CPU usage, define hello statement that populates a user-defined variable (`$totalDedicatedNodes`) with a value that is 110 percent of hello current target number of dedicated nodes, but only if hello minimum average CPU usage during hello last 10 minutes was above 70 percent.</span></span> <span data-ttu-id="f96cb-497">Jinak použijte hello hodnotu pro hello aktuální počet vyhrazených uzlů.</span><span class="sxs-lookup"><span data-stu-id="f96cb-497">Otherwise, use hello value for hello current number of dedicated nodes.</span></span>

```
$totalDedicatedNodes =
    (min($CPUPercent.GetSample(TimeInterval_Minute * 10)) > 0.7) ?
    ($CurrentDedicatedNodes * 1.1) : $CurrentDedicatedNodes;
```

<span data-ttu-id="f96cb-498">příliš*snížit* hello počet vyhrazených uzlů při nízkém zatížení procesoru, hello další příkaz v našich hello vzorce nastaví stejné `$totalDedicatedNodes` proměnné too90 procent hello aktuální cílový počet vyhrazených uzlů Pokud hello průměrné využití procesoru v hello byla za posledních 60 minut v části 20 procent.</span><span class="sxs-lookup"><span data-stu-id="f96cb-498">too*decrease* hello number of dedicated nodes during low CPU usage, hello next statement in our formula sets hello same `$totalDedicatedNodes` variable too90 percent of hello current target number of dedicated nodes if hello average CPU usage in hello past 60 minutes was under 20 percent.</span></span> <span data-ttu-id="f96cb-499">Jinak použijte hello aktuální hodnota `$totalDedicatedNodes` , jsme vložené do hello příkaz výše.</span><span class="sxs-lookup"><span data-stu-id="f96cb-499">Otherwise, use hello current value of `$totalDedicatedNodes` that we populated in hello statement above.</span></span>

```
$totalDedicatedNodes =
    (avg($CPUPercent.GetSample(TimeInterval_Minute * 60)) < 0.2) ?
    ($CurrentDedicatedNodes * 0.9) : $totalDedicatedNodes;
```

<span data-ttu-id="f96cb-500">Nyní omezte hello cílový počet vyhrazených výpočetní uzly tooa maximum 400:</span><span class="sxs-lookup"><span data-stu-id="f96cb-500">Now limit hello target number of dedicated compute nodes tooa maximum of 400:</span></span>

```
$TargetDedicatedNodes = min(400, $totalDedicatedNodes)
```

<span data-ttu-id="f96cb-501">Tady je hello dokončení vzorec:</span><span class="sxs-lookup"><span data-stu-id="f96cb-501">Here's hello complete formula:</span></span>

```
$totalDedicatedNodes =
    (min($CPUPercent.GetSample(TimeInterval_Minute * 10)) > 0.7) ?
    ($CurrentDedicatedNodes * 1.1) : $CurrentDedicatedNodes;
$totalDedicatedNodes =
    (avg($CPUPercent.GetSample(TimeInterval_Minute * 60)) < 0.2) ?
    ($CurrentDedicatedNodes * 0.9) : $totalDedicatedNodes;
$TargetDedicatedNodes = min(400, $totalDedicatedNodes)
```

## <a name="create-an-autoscale-enabled-pool-with-net"></a><span data-ttu-id="f96cb-502">Vytvoření fondu povoleno škálování s rozhraním .NET</span><span class="sxs-lookup"><span data-stu-id="f96cb-502">Create an autoscale-enabled pool with .NET</span></span>

<span data-ttu-id="f96cb-503">toocreate fond s automatické škálování povolené v rozhraní .NET, postupujte takto:</span><span class="sxs-lookup"><span data-stu-id="f96cb-503">toocreate a pool with autoscaling enabled in .NET, follow these steps:</span></span>

1. <span data-ttu-id="f96cb-504">Vytvoření fondu hello s [BatchClient.PoolOperations.CreatePool](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.createpool).</span><span class="sxs-lookup"><span data-stu-id="f96cb-504">Create hello pool with [BatchClient.PoolOperations.CreatePool](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.createpool).</span></span>
2. <span data-ttu-id="f96cb-505">Sada hello [CloudPool.AutoScaleEnabled](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleenabled) vlastnost příliš`true`.</span><span class="sxs-lookup"><span data-stu-id="f96cb-505">Set hello [CloudPool.AutoScaleEnabled](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleenabled) property too`true`.</span></span>
3. <span data-ttu-id="f96cb-506">Sada hello [CloudPool.AutoScaleFormula](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleformula) vlastnost s vzorec škálování.</span><span class="sxs-lookup"><span data-stu-id="f96cb-506">Set hello [CloudPool.AutoScaleFormula](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleformula) property with your autoscale formula.</span></span>
4. <span data-ttu-id="f96cb-507">(Volitelné) Sada hello [CloudPool.AutoScaleEvaluationInterval](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleevaluationinterval) vlastnosti (výchozí hodnota je 15 minut).</span><span class="sxs-lookup"><span data-stu-id="f96cb-507">(Optional) Set hello [CloudPool.AutoScaleEvaluationInterval](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleevaluationinterval) property (default is 15 minutes).</span></span>
5. <span data-ttu-id="f96cb-508">Potvrdit hello fond s [CloudPool.Commit](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commit) nebo [CommitAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commitasync).</span><span class="sxs-lookup"><span data-stu-id="f96cb-508">Commit hello pool with [CloudPool.Commit](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commit) or [CommitAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.commitasync).</span></span>

<span data-ttu-id="f96cb-509">Hello následující fragment kódu vytvoří fond škálování povolené v rozhraní .NET.</span><span class="sxs-lookup"><span data-stu-id="f96cb-509">hello following code snippet creates an autoscale-enabled pool in .NET.</span></span> <span data-ttu-id="f96cb-510">Hello vzorec škálování fondu nastaví hello cílový počet vyhrazených uzlů too5 v pondělí a 1 na každý druhý den v týdnu hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-510">hello pool's autoscale formula sets hello target number of dedicated nodes too5 on Mondays, and 1 on every other day of hello week.</span></span> <span data-ttu-id="f96cb-511">Hello [interval automatického škálování](#automatic-scaling-interval) je nastavit too30 minut.</span><span class="sxs-lookup"><span data-stu-id="f96cb-511">hello [automatic scaling interval](#automatic-scaling-interval) is set too30 minutes.</span></span> <span data-ttu-id="f96cb-512">V tomto a dalších fragmenty C# v tomto článku hello `myBatchClient` je správně inicializována instanci hello [BatchClient] [ net_batchclient] třídy.</span><span class="sxs-lookup"><span data-stu-id="f96cb-512">In this and hello other C# snippets in this article, `myBatchClient` is a properly initialized instance of hello [BatchClient][net_batchclient] class.</span></span>

```csharp
CloudPool pool = myBatchClient.PoolOperations.CreatePool(
                    poolId: "mypool",
                    virtualMachineSize: "small", // single-core, 1.75 GB memory, 225 GB disk
                    cloudServiceConfiguration: new CloudServiceConfiguration(osFamily: "5"));    
pool.AutoScaleEnabled = true;
pool.AutoScaleFormula = "$TargetDedicatedNodes = (time().weekday == 1 ? 5:1);";
pool.AutoScaleEvaluationInterval = TimeSpan.FromMinutes(30);
await pool.CommitAsync();
```

> [!IMPORTANT]
> <span data-ttu-id="f96cb-513">Když vytvoříte fond povoleno automatické škálování, nezadávejte hello _targetDedicatedComputeNodes_ parametr nebo hello _targetLowPriorityComputeNodes_ parametr na hello volání příliš **CreatePool**.</span><span class="sxs-lookup"><span data-stu-id="f96cb-513">When you create an autoscale-enabled pool, do not specify hello _targetDedicatedComputeNodes_ parameter or hello _targetLowPriorityComputeNodes_ parameter on hello call too**CreatePool**.</span></span> <span data-ttu-id="f96cb-514">Místo toho zadejte hello **AutoScaleEnabled** a **AutoScaleFormula** vlastnosti fondu hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-514">Instead, specify hello **AutoScaleEnabled** and **AutoScaleFormula** properties on hello pool.</span></span> <span data-ttu-id="f96cb-515">Hello hodnoty pro tyto vlastnosti určují hello cílový počet každý typ uzlu.</span><span class="sxs-lookup"><span data-stu-id="f96cb-515">hello values for these properties determine hello target number of each type of node.</span></span> <span data-ttu-id="f96cb-516">Navíc toomanually změnit velikost fondu škálování povolené (například s [BatchClient.PoolOperations.ResizePoolAsync][net_poolops_resizepoolasync]), první **zakázat** automatické škálování na Hello fondu a pak jeho velikost.</span><span class="sxs-lookup"><span data-stu-id="f96cb-516">Also, toomanually resize an autoscale-enabled pool (for example, with [BatchClient.PoolOperations.ResizePoolAsync][net_poolops_resizepoolasync]), first **disable** automatic scaling on hello pool, then resize it.</span></span>
>
>

<span data-ttu-id="f96cb-517">Kromě toho tooBatch .NET, můžete použít některý z dalších hello [SDK služby Batch](batch-apis-tools.md#azure-accounts-for-batch-development), [Batch REST](https://docs.microsoft.com/rest/api/batchservice/), [rutiny prostředí PowerShell Batch](batch-powershell-cmdlets-get-started.md)a hello [Batch CLI](batch-cli-get-started.md)tooconfigure automatické škálování.</span><span class="sxs-lookup"><span data-stu-id="f96cb-517">In addition tooBatch .NET, you can use any of hello other [Batch SDKs](batch-apis-tools.md#azure-accounts-for-batch-development), [Batch REST](https://docs.microsoft.com/rest/api/batchservice/), [Batch PowerShell cmdlets](batch-powershell-cmdlets-get-started.md), and hello [Batch CLI](batch-cli-get-started.md) tooconfigure autoscaling.</span></span>


### <a name="automatic-scaling-interval"></a><span data-ttu-id="f96cb-518">Interval automatického škálování</span><span class="sxs-lookup"><span data-stu-id="f96cb-518">Automatic scaling interval</span></span>
<span data-ttu-id="f96cb-519">Ve výchozím nastavení služba Batch hello upraví velikost fondu podle tooits vzorec škálování každých 15 minut.</span><span class="sxs-lookup"><span data-stu-id="f96cb-519">By default, hello Batch service adjusts a pool's size according tooits autoscale formula every 15 minutes.</span></span> <span data-ttu-id="f96cb-520">Tento interval je možné konfigurovat pomocí hello následující vlastnosti fondu:</span><span class="sxs-lookup"><span data-stu-id="f96cb-520">This interval is configurable by using hello following pool properties:</span></span>

* <span data-ttu-id="f96cb-521">[CloudPool.AutoScaleEvaluationInterval] [ net_cloudpool_autoscaleevalinterval] (Batch .NET)</span><span class="sxs-lookup"><span data-stu-id="f96cb-521">[CloudPool.AutoScaleEvaluationInterval][net_cloudpool_autoscaleevalinterval] (Batch .NET)</span></span>
* <span data-ttu-id="f96cb-522">[autoScaleEvaluationInterval] [ rest_autoscaleinterval] (REST API)</span><span class="sxs-lookup"><span data-stu-id="f96cb-522">[autoScaleEvaluationInterval][rest_autoscaleinterval] (REST API)</span></span>

<span data-ttu-id="f96cb-523">minimální interval Hello je pět minut a maximální hello je 168 hodin.</span><span class="sxs-lookup"><span data-stu-id="f96cb-523">hello minimum interval is five minutes, and hello maximum is 168 hours.</span></span> <span data-ttu-id="f96cb-524">Pokud je zadán interval mimo tento rozsah, hello služba Batch vrátí chybu chybný požadavek (400).</span><span class="sxs-lookup"><span data-stu-id="f96cb-524">If an interval outside this range is specified, hello Batch service returns a Bad Request (400) error.</span></span>

> [!NOTE]
> <span data-ttu-id="f96cb-525">Automatické škálování není aktuálně určený toorespond toochanges za méně než minutu, ale spíše je určena tooadjust hello velikost fondu postupně po spuštění zatížení.</span><span class="sxs-lookup"><span data-stu-id="f96cb-525">Autoscaling is not currently intended toorespond toochanges in less than a minute, but rather is intended tooadjust hello size of your pool gradually as you run a workload.</span></span>
>
>

## <a name="enable-autoscaling-on-an-existing-pool"></a><span data-ttu-id="f96cb-526">Povolit automatické škálování na existující fond</span><span class="sxs-lookup"><span data-stu-id="f96cb-526">Enable autoscaling on an existing pool</span></span>

<span data-ttu-id="f96cb-527">Každý Batch SDK poskytuje automatické škálování způsob tooenable.</span><span class="sxs-lookup"><span data-stu-id="f96cb-527">Each Batch SDK provides a way tooenable autoscaling.</span></span> <span data-ttu-id="f96cb-528">Například:</span><span class="sxs-lookup"><span data-stu-id="f96cb-528">For example:</span></span>

* <span data-ttu-id="f96cb-529">[BatchClient.PoolOperations.EnableAutoScaleAsync] [ net_enableautoscaleasync] (Batch .NET)</span><span class="sxs-lookup"><span data-stu-id="f96cb-529">[BatchClient.PoolOperations.EnableAutoScaleAsync][net_enableautoscaleasync] (Batch .NET)</span></span>
* <span data-ttu-id="f96cb-530">[Povolit automatické škálování ve fondu] [ rest_enableautoscale] (REST API)</span><span class="sxs-lookup"><span data-stu-id="f96cb-530">[Enable automatic scaling on a pool][rest_enableautoscale] (REST API)</span></span>

<span data-ttu-id="f96cb-531">Když povolíte automatické škálování na existující fond, mějte na paměti hello následující body:</span><span class="sxs-lookup"><span data-stu-id="f96cb-531">When you enable autoscaling on an existing pool, keep in mind hello following points:</span></span>

* <span data-ttu-id="f96cb-532">Pokud automatické škálování je aktuálně zakázáno ve fondu hello při vydání hello požadavek tooenable automatické škálování, je nutné zadat platný škálování vzorec Pokud vydáte požadavek hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-532">If automatic scaling is currently disabled on hello pool when you issue hello request tooenable autoscaling, you must specify a valid autoscale formula when you issue hello request.</span></span> <span data-ttu-id="f96cb-533">Volitelně můžete zadat interval testování škálování.</span><span class="sxs-lookup"><span data-stu-id="f96cb-533">You can optionally specify an autoscale evaluation interval.</span></span> <span data-ttu-id="f96cb-534">Pokud nezadáte intervalu, je použita výchozí hodnota hello 15 minut.</span><span class="sxs-lookup"><span data-stu-id="f96cb-534">If you do not specify an interval, hello default value of 15 minutes is used.</span></span>
* <span data-ttu-id="f96cb-535">Pokud automatického škálování je nyní povolena na hello fondu, můžete vzorec škálování, intervalu vyhodnocení nebo obojí.</span><span class="sxs-lookup"><span data-stu-id="f96cb-535">If autoscale is currently enabled on hello pool, you can specify an autoscale formula, an evaluation interval, or both.</span></span> <span data-ttu-id="f96cb-536">Musíte zadat alespoň jednu z těchto vlastností.</span><span class="sxs-lookup"><span data-stu-id="f96cb-536">You must specify at least one of these properties.</span></span>

  * <span data-ttu-id="f96cb-537">Pokud zadáte nový vyhodnocení interval škálování, je zastavena hello existující plán vyhodnocení a spuštění nový plán.</span><span class="sxs-lookup"><span data-stu-id="f96cb-537">If you specify a new autoscale evaluation interval, then hello existing evaluation schedule is stopped and a new schedule is started.</span></span> <span data-ttu-id="f96cb-538">čas zahájení Hello nový plán je hello čas, na které hello byl vydán požadavek tooenable automatické škálování.</span><span class="sxs-lookup"><span data-stu-id="f96cb-538">hello new schedule's start time is hello time at which hello request tooenable autoscaling was issued.</span></span>
  * <span data-ttu-id="f96cb-539">Pokud vynecháte interval buď hello škálování vzorec nebo vyhodnocení, pokračuje hello služba Batch toouse hello aktuální hodnota tohoto nastavení.</span><span class="sxs-lookup"><span data-stu-id="f96cb-539">If you omit either hello autoscale formula or evaluation interval, hello Batch service continues toouse hello current value of that setting.</span></span>

> [!NOTE]
> <span data-ttu-id="f96cb-540">Pokud jste zadali hodnoty pro hello *targetDedicatedComputeNodes* nebo *targetLowPriorityComputeNodes* parametry hello **CreatePool** metoda při vytváření hello fond v rozhraní .NET, nebo pro hello porovnatelný z hlediska parametrů v jiném jazyce, pak tyto hodnoty se ignorují vyhodnocena hello vzorce automatického škálování.</span><span class="sxs-lookup"><span data-stu-id="f96cb-540">If you specified values for hello *targetDedicatedComputeNodes* or *targetLowPriorityComputeNodes* parameters of hello **CreatePool** method when you created hello pool in .NET, or for hello comparable parameters in another language, then those values are ignored when hello automatic scaling formula is evaluated.</span></span>
>
>

<span data-ttu-id="f96cb-541">Tento fragment kódu jazyka C# používá hello [Batch .NET] [ net_api] automatické škálování tooenable knihovny na existující fond:</span><span class="sxs-lookup"><span data-stu-id="f96cb-541">This C# code snippet uses hello [Batch .NET][net_api] library tooenable autoscaling on an existing pool:</span></span>

```csharp
// Define hello autoscaling formula. This formula sets hello target number of nodes
// too5 on Mondays, and 1 on every other day of hello week
string myAutoScaleFormula = "$TargetDedicatedNodes = (time().weekday == 1 ? 5:1);";

// Set hello autoscale formula on hello existing pool
await myBatchClient.PoolOperations.EnableAutoScaleAsync(
    "myexistingpool",
    autoscaleFormula: myAutoScaleFormula);
```

### <a name="update-an-autoscale-formula"></a><span data-ttu-id="f96cb-542">Aktualizace se vzorec škálování</span><span class="sxs-lookup"><span data-stu-id="f96cb-542">Update an autoscale formula</span></span>

<span data-ttu-id="f96cb-543">Vzorec hello tooupdate na existující škálování povolené fond, volání hello operace automatické škálování tooenable znovu s novou vzorec hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-543">tooupdate hello formula on an existing autoscale-enabled pool, call hello operation tooenable autoscaling again with hello new formula.</span></span> <span data-ttu-id="f96cb-544">Například, pokud je již zapnuta automatické škálování `myexistingpool` po provedení hello následující kód .NET se jeho vzorec škálování nahradí obsah hello `myNewFormula`.</span><span class="sxs-lookup"><span data-stu-id="f96cb-544">For example, if autoscaling is already enabled on `myexistingpool` when hello following .NET code is executed, its autoscale formula is replaced with hello contents of `myNewFormula`.</span></span>

```csharp
await myBatchClient.PoolOperations.EnableAutoScaleAsync(
    "myexistingpool",
    autoscaleFormula: myNewFormula);
```

### <a name="update-hello-autoscale-interval"></a><span data-ttu-id="f96cb-545">Interval automatického škálování hello aktualizace</span><span class="sxs-lookup"><span data-stu-id="f96cb-545">Update hello autoscale interval</span></span>

<span data-ttu-id="f96cb-546">tooupdate hello škálování vyhodnocení interval existujícího povoleno škálování fondu, volání hello operace automatické škálování tooenable znovu s novou interval hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-546">tooupdate hello autoscale evaluation interval of an existing autoscale-enabled pool, call hello operation tooenable autoscaling again with hello new interval.</span></span> <span data-ttu-id="f96cb-547">Například tooset hello škálování vyhodnocení too60 minut určený v intervalu pro fond, který je již povolen škálování v rozhraní .NET:</span><span class="sxs-lookup"><span data-stu-id="f96cb-547">For example, tooset hello autoscale evaluation interval too60 minutes for a pool that's already autoscale-enabled in .NET:</span></span>

```csharp
await myBatchClient.PoolOperations.EnableAutoScaleAsync(
    "myexistingpool",
    autoscaleEvaluationInterval: TimeSpan.FromMinutes(60));
```

## <a name="evaluate-an-autoscale-formula"></a><span data-ttu-id="f96cb-548">Vyhodnocení se vzorec škálování</span><span class="sxs-lookup"><span data-stu-id="f96cb-548">Evaluate an autoscale formula</span></span>

<span data-ttu-id="f96cb-549">Vzorce můžete vyhodnotit před každým jejím použitím tooa fondu.</span><span class="sxs-lookup"><span data-stu-id="f96cb-549">You can evaluate a formula before applying it tooa pool.</span></span> <span data-ttu-id="f96cb-550">Tímto způsobem můžete otestovat hello vzorce toosee jak vyhodnotit jeho příkazy před uvedení hello vzorec do produkčního prostředí.</span><span class="sxs-lookup"><span data-stu-id="f96cb-550">In this way, you can test hello formula toosee how its statements evaluate before you put hello formula into production.</span></span>

<span data-ttu-id="f96cb-551">tooevaluate vzorec škálování, musíte nejdřív povolit automatické škálování na fond hello se platný vzorec.</span><span class="sxs-lookup"><span data-stu-id="f96cb-551">tooevaluate an autoscale formula, you must first enable autoscaling on hello pool with a valid formula.</span></span> <span data-ttu-id="f96cb-552">povoleno tootest vzorec na fond, který ještě nemá automatické škálování, použijte hello jednořádkové vzorec `$TargetDedicatedNodes = 0` když poprvé povolíte automatické škálování.</span><span class="sxs-lookup"><span data-stu-id="f96cb-552">tootest a formula on a pool that doesn't yet have autoscaling enabled, use hello one-line formula `$TargetDedicatedNodes = 0` when you first enable autoscaling.</span></span> <span data-ttu-id="f96cb-553">Pak použijte jednu z následujících vzorec hello tooevaluate chcete tootest hello:</span><span class="sxs-lookup"><span data-stu-id="f96cb-553">Then, use one of hello following tooevaluate hello formula you want tootest:</span></span>

* <span data-ttu-id="f96cb-554">[BatchClient.PoolOperations.EvaluateAutoScale](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscale) nebo [EvaluateAutoScaleAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscaleasync)</span><span class="sxs-lookup"><span data-stu-id="f96cb-554">[BatchClient.PoolOperations.EvaluateAutoScale](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscale) or [EvaluateAutoScaleAsync](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.evaluateautoscaleasync)</span></span>

    <span data-ttu-id="f96cb-555">Tyto metody Batch .NET, vyžadují ID hello existující fond a řetězec obsahující tooevaluate vzorce automatického škálování hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-555">These Batch .NET methods require hello ID of an existing pool and a string containing hello autoscale formula tooevaluate.</span></span>

* [<span data-ttu-id="f96cb-556">Vyhodnocení vzorec automatické škálování</span><span class="sxs-lookup"><span data-stu-id="f96cb-556">Evaluate an automatic scaling formula</span></span>](https://docs.microsoft.com/rest/api/batchservice/evaluate-an-automatic-scaling-formula)

    <span data-ttu-id="f96cb-557">V této žádosti o volání rozhraní REST API, zadejte ID fondu hello v hello URI a hello vzorec škálování v hello *autoScaleFormula* element textu hello žádost.</span><span class="sxs-lookup"><span data-stu-id="f96cb-557">In this REST API request, specify hello pool ID in hello URI, and hello autoscale formula in hello *autoScaleFormula* element of hello request body.</span></span> <span data-ttu-id="f96cb-558">Hello odpověď operace hello obsahuje všechny informace o chybě, který může být související toohello vzorec.</span><span class="sxs-lookup"><span data-stu-id="f96cb-558">hello response of hello operation contains any error information that might be related toohello formula.</span></span>

<span data-ttu-id="f96cb-559">V tomto [Batch .NET] [ net_api] fragment kódu, vyhodnocení se vzorec škálování.</span><span class="sxs-lookup"><span data-stu-id="f96cb-559">In this [Batch .NET][net_api] code snippet, we evaluate an autoscale formula.</span></span> <span data-ttu-id="f96cb-560">Pokud fond hello nemá povoleno automatické škálování, jsme ji povolit nejdřív.</span><span class="sxs-lookup"><span data-stu-id="f96cb-560">If hello pool does not have autoscaling enabled, we enable it first.</span></span>

```csharp
// First obtain a reference tooan existing pool
CloudPool pool = await batchClient.PoolOperations.GetPoolAsync("myExistingPool");

// If autoscaling isn't already enabled on hello pool, enable it.
// You can't evaluate an autoscale formula on non-autoscale-enabled pool.
if (pool.AutoScaleEnabled == false)
{
    // We need a valid autoscale formula tooenable autoscaling on the
    // pool. This formula is valid, but won't resize hello pool:
    await pool.EnableAutoScaleAsync(
        autoscaleFormula: "$TargetDedicatedNodes = {pool.CurrentDedicatedNodes};",
        autoscaleEvaluationInterval: TimeSpan.FromMinutes(5));

    // Batch limits EnableAutoScaleAsync calls tooonce every 30 seconds.
    // Because we want tooapply our new autoscale formula below if it
    // evaluates successfully, and we *just* enabled autoscaling on
    // this pool, we pause here tooensure we pass that threshold.
    Thread.Sleep(TimeSpan.FromSeconds(31));

    // Refresh hello properties of hello pool so that we've got the
    // latest value for AutoScaleEnabled
    await pool.RefreshAsync();
}

// We must ensure that autoscaling is enabled on hello pool prior to
// evaluating a formula
if (pool.AutoScaleEnabled == true)
{
    // hello formula tooevaluate - adjusts target number of nodes based on
    // day of week and time of day
    string myFormula = @"
        $curTime = time();
        $workHours = $curTime.hour >= 8 && $curTime.hour < 18;
        $isWeekday = $curTime.weekday >= 1 && $curTime.weekday <= 5;
        $isWorkingWeekdayHour = $workHours && $isWeekday;
        $TargetDedicatedNodes = $isWorkingWeekdayHour ? 20:10;
    ";

    // Perform hello autoscale formula evaluation. Note that this code does not
    // actually apply hello formula toohello pool.
    AutoScaleRun eval =
        await batchClient.PoolOperations.EvaluateAutoScaleAsync(pool.Id, myFormula);

    if (eval.Error == null)
    {
        // Evaluation success - print hello results of hello AutoScaleRun.
        // This will display hello values of each variable as evaluated by the
        // autoscale formula.
        Console.WriteLine("AutoScaleRun.Results: " +
            eval.Results.Replace("$", "\n    $"));

        // Apply hello formula toohello pool since it evaluated successfully
        await batchClient.PoolOperations.EnableAutoScaleAsync(pool.Id, myFormula);
    }
    else
    {
        // Evaluation failed, output hello message associated with hello error
        Console.WriteLine("AutoScaleRun.Error.Message: " +
            eval.Error.Message);
    }
}
```

<span data-ttu-id="f96cb-561">Úspěšné vyhodnocení hello vzorec tento fragment kódu ukazuje vytváří výsledky podobně jako:</span><span class="sxs-lookup"><span data-stu-id="f96cb-561">Successful evaluation of hello formula shown in this code snippet produces results similar to:</span></span>

```
AutoScaleRun.Results:
    $TargetDedicatedNodes=10;
    $NodeDeallocationOption=requeue;
    $curTime=2016-10-13T19:18:47.805Z;
    $isWeekday=1;
    $isWorkingWeekdayHour=0;
    $workHours=0
```

## <a name="get-information-about-autoscale-runs"></a><span data-ttu-id="f96cb-562">Získat informace o spuštění automatického škálování</span><span class="sxs-lookup"><span data-stu-id="f96cb-562">Get information about autoscale runs</span></span>

<span data-ttu-id="f96cb-563">byl očekáván tooensure, který provádí vzorec jako, doporučujeme vám, že pravidelně kontrolovat hello výsledky spustí hello automatické škálování, které Batch provádí fondu.</span><span class="sxs-lookup"><span data-stu-id="f96cb-563">tooensure that your formula is performing as expected, we recommend that you periodically check hello results of hello autoscaling runs that Batch performs on your pool.</span></span> <span data-ttu-id="f96cb-564">toodo tedy získat (nebo aktualizujte) toohello odkaz na fond a zkontrolujte vlastnosti hello jeho poslední škálování spustit.</span><span class="sxs-lookup"><span data-stu-id="f96cb-564">toodo so, get (or refresh) a reference toohello pool, and examine hello properties of its last autoscale run.</span></span>

<span data-ttu-id="f96cb-565">V Batch .NET, hello [CloudPool.AutoScaleRun](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscalerun) vlastnost má několik vlastností, které obsahují informace o hello nejnovější automatické škálování spustit provádět ve fondu hello:</span><span class="sxs-lookup"><span data-stu-id="f96cb-565">In Batch .NET, hello [CloudPool.AutoScaleRun](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscalerun) property has several properties that provide information about hello latest automatic scaling run performed on hello pool:</span></span>

* [<span data-ttu-id="f96cb-566">AutoScaleRun.Timestamp</span><span class="sxs-lookup"><span data-stu-id="f96cb-566">AutoScaleRun.Timestamp</span></span>](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.autoscalerun.timestamp)
* [<span data-ttu-id="f96cb-567">AutoScaleRun.Results</span><span class="sxs-lookup"><span data-stu-id="f96cb-567">AutoScaleRun.Results</span></span>](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.autoscalerun.results)
* [<span data-ttu-id="f96cb-568">AutoScaleRun.Error</span><span class="sxs-lookup"><span data-stu-id="f96cb-568">AutoScaleRun.Error</span></span>](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.autoscalerun.error)

<span data-ttu-id="f96cb-569">V hello REST API, hello [získat informace o fondu](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool) požadavek vrací informace o hello fondu, který zahrnuje hello nejnovější automatické škálování spouštění informace v hello [autoScaleRun](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool#bk_autrun) vlastnost.</span><span class="sxs-lookup"><span data-stu-id="f96cb-569">In hello REST API, hello [Get information about a pool](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool) request returns information about hello pool, which includes hello latest automatic scaling run information in hello [autoScaleRun](https://docs.microsoft.com/rest/api/batchservice/get-information-about-a-pool#bk_autrun) property.</span></span>

<span data-ttu-id="f96cb-570">Hello následující fragment kódu jazyka C# používá hello Batch .NET knihovny tooprint informace o hello poslední automatické škálování, spusťte na fond _myPool_:</span><span class="sxs-lookup"><span data-stu-id="f96cb-570">hello following C# code snippet uses hello Batch .NET library tooprint information about hello last autoscaling run on pool _myPool_:</span></span>

```csharp
await Cloud pool = myBatchClient.PoolOperations.GetPoolAsync("myPool");
Console.WriteLine("Last execution: " + pool.AutoScaleRun.Timestamp);
Console.WriteLine("Result:" + pool.AutoScaleRun.Results.Replace("$", "\n  $"));
Console.WriteLine("Error: " + pool.AutoScaleRun.Error);
```

<span data-ttu-id="f96cb-571">Ukázkový výstup hello předcházející fragment kódu:</span><span class="sxs-lookup"><span data-stu-id="f96cb-571">Sample output of hello preceding snippet:</span></span>

```
Last execution: 10/14/2016 18:36:43
Result:
  $TargetDedicatedNodes=10;
  $NodeDeallocationOption=requeue;
  $curTime=2016-10-14T18:36:43.282Z;
  $isWeekday=1;
  $isWorkingWeekdayHour=0;
  $workHours=0
Error:
```

## <a name="example-autoscale-formulas"></a><span data-ttu-id="f96cb-572">Příklad vzorce automatického škálování</span><span class="sxs-lookup"><span data-stu-id="f96cb-572">Example autoscale formulas</span></span>
<span data-ttu-id="f96cb-573">Podívejme se na několik vzorce, které se zobrazí různé způsoby tooadjust hello množství výpočetních prostředků v rámci fondu.</span><span class="sxs-lookup"><span data-stu-id="f96cb-573">Let's look at a few formulas that show different ways tooadjust hello amount of compute resources in a pool.</span></span>

### <a name="example-1-time-based-adjustment"></a><span data-ttu-id="f96cb-574">Příklad 1: Založené na čase úpravy</span><span class="sxs-lookup"><span data-stu-id="f96cb-574">Example 1: Time-based adjustment</span></span>
<span data-ttu-id="f96cb-575">Předpokládejme, že chcete velikost fondu hello tooadjust na základě hello den v týdnu hello a denní dobu.</span><span class="sxs-lookup"><span data-stu-id="f96cb-575">Suppose you want tooadjust hello pool size based on hello day of hello week and time of day.</span></span> <span data-ttu-id="f96cb-576">Tento příklad ukazuje, jak tooincrease nebo snížení hello počet uzlů v hello fond odpovídajícím způsobem.</span><span class="sxs-lookup"><span data-stu-id="f96cb-576">This example shows how tooincrease or decrease hello number of nodes in hello pool accordingly.</span></span>

<span data-ttu-id="f96cb-577">Vzorec Hello nejdřív získá hello aktuální čas.</span><span class="sxs-lookup"><span data-stu-id="f96cb-577">hello formula first obtains hello current time.</span></span> <span data-ttu-id="f96cb-578">Pokud je jeden den v týdnu (1-5) a v rámci pracovní dobu (too6 8: 00 PM), velikost fondu cíl hello je nastavit too20 uzly.</span><span class="sxs-lookup"><span data-stu-id="f96cb-578">If it's a weekday (1-5) and within working hours (8 AM too6 PM), hello target pool size is set too20 nodes.</span></span> <span data-ttu-id="f96cb-579">V opačném nastavil too10 uzlů.</span><span class="sxs-lookup"><span data-stu-id="f96cb-579">Otherwise, it's set too10 nodes.</span></span>

```
$curTime = time();
$workHours = $curTime.hour >= 8 && $curTime.hour < 18;
$isWeekday = $curTime.weekday >= 1 && $curTime.weekday <= 5;
$isWorkingWeekdayHour = $workHours && $isWeekday;
$TargetDedicatedNodes = $isWorkingWeekdayHour ? 20:10;
```

### <a name="example-2-task-based-adjustment"></a><span data-ttu-id="f96cb-580">Příklad 2: Úprava založený na úlohách</span><span class="sxs-lookup"><span data-stu-id="f96cb-580">Example 2: Task-based adjustment</span></span>
<span data-ttu-id="f96cb-581">V tomto příkladu se upraví velikost fondu hello podle hello počet úloh ve frontě hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-581">In this example, hello pool size is adjusted based on hello number of tasks in hello queue.</span></span> <span data-ttu-id="f96cb-582">Komentáře a zalomení řádků jsou přípustné v řetězcích vzorce.</span><span class="sxs-lookup"><span data-stu-id="f96cb-582">Both comments and line breaks are acceptable in formula strings.</span></span>

```csharp
// Get pending tasks for hello past 15 minutes.
$samples = $ActiveTasks.GetSamplePercent(TimeInterval_Minute * 15);
// If we have fewer than 70 percent data points, we use hello last sample point,
// otherwise we use hello maximum of last sample point and hello history average.
$tasks = $samples < 70 ? max(0,$ActiveTasks.GetSample(1)) : max( $ActiveTasks.GetSample(1), avg($ActiveTasks.GetSample(TimeInterval_Minute * 15)));
// If number of pending tasks is not 0, set targetVM toopending tasks, otherwise
// half of current dedicated.
$targetVMs = $tasks > 0? $tasks:max(0, $TargetDedicatedNodes/2);
// hello pool size is capped at 20, if target VM value is more than that, set it
// too20. This value should be adjusted according tooyour use case.
$TargetDedicatedNodes = max(0, min($targetVMs, 20));
// Set node deallocation mode - keep nodes active only until tasks finish
$NodeDeallocationOption = taskcompletion;
```

### <a name="example-3-accounting-for-parallel-tasks"></a><span data-ttu-id="f96cb-583">Příklad 3: Monitorování účtů pro paralelní úlohy</span><span class="sxs-lookup"><span data-stu-id="f96cb-583">Example 3: Accounting for parallel tasks</span></span>
<span data-ttu-id="f96cb-584">Tento příklad upraví hello velikost fondu na základě hello počtu úloh.</span><span class="sxs-lookup"><span data-stu-id="f96cb-584">This example adjusts hello pool size based on hello number of tasks.</span></span> <span data-ttu-id="f96cb-585">Tento vzorec zohledňuje také účet hello [MaxTasksPerComputeNode] [ net_maxtasks] hodnotu, která je nastavená pro fond hello.</span><span class="sxs-lookup"><span data-stu-id="f96cb-585">This formula also takes into account hello [MaxTasksPerComputeNode][net_maxtasks] value that has been set for hello pool.</span></span> <span data-ttu-id="f96cb-586">Tento přístup je užitečné v situacích, kde [paralelní provádění úkolů](batch-parallel-node-tasks.md) bylo povoleno na váš fond.</span><span class="sxs-lookup"><span data-stu-id="f96cb-586">This approach is useful in situations where [parallel task execution](batch-parallel-node-tasks.md) has been enabled on your pool.</span></span>

```csharp
// Determine whether 70 percent of hello samples have been recorded in hello past
// 15 minutes; if not, use last sample
$samples = $ActiveTasks.GetSamplePercent(TimeInterval_Minute * 15);
$tasks = $samples < 70 ? max(0,$ActiveTasks.GetSample(1)) : max( $ActiveTasks.GetSample(1),avg($ActiveTasks.GetSample(TimeInterval_Minute * 15)));
// Set hello number of nodes tooadd tooone-fourth hello number of active tasks (the
// MaxTasksPerComputeNode property on this pool is set too4, adjust this number
// for your use case)
$cores = $TargetDedicatedNodes * 4;
$extraVMs = (($tasks - $cores) + 3) / 4;
$targetVMs = ($TargetDedicatedNodes + $extraVMs);
// Attempt toogrow hello number of compute nodes toomatch hello number of active
// tasks, with a maximum of 3
$TargetDedicatedNodes = max(0,min($targetVMs,3));
// Keep hello nodes active until hello tasks finish
$NodeDeallocationOption = taskcompletion;
```

### <a name="example-4-setting-an-initial-pool-size"></a><span data-ttu-id="f96cb-587">Příklad 4: Nastavení velikosti počáteční fondu</span><span class="sxs-lookup"><span data-stu-id="f96cb-587">Example 4: Setting an initial pool size</span></span>
<span data-ttu-id="f96cb-588">Tento příklad, že zobrazuje fragment kódu pomocí vzorce automatického škálování, který nastaví kódu jazyka C# hello tooa velikost fondu zadaný počet uzlů na počáteční čas období.</span><span class="sxs-lookup"><span data-stu-id="f96cb-588">This example shows a C# code snippet with an autoscale formula that sets hello pool size tooa specified number of nodes for an initial time period.</span></span> <span data-ttu-id="f96cb-589">Pak se upraví hello velikost fondu na základě počtu hello spuštěná a aktivních úloh po hello počáteční čas období uplynul.</span><span class="sxs-lookup"><span data-stu-id="f96cb-589">Then it adjusts hello pool size based on hello number of running and active tasks after hello initial time period has elapsed.</span></span>

<span data-ttu-id="f96cb-590">Vzorec Hello v hello následující fragment kódu:</span><span class="sxs-lookup"><span data-stu-id="f96cb-590">hello formula in hello following code snippet:</span></span>

* <span data-ttu-id="f96cb-591">Nastaví počáteční fondu hello velikost toofour uzlů.</span><span class="sxs-lookup"><span data-stu-id="f96cb-591">Sets hello initial pool size toofour nodes.</span></span>
* <span data-ttu-id="f96cb-592">Nepřizpůsobí hello velikost fondu v rámci hello první 10 minut životního cyklu hello fondu.</span><span class="sxs-lookup"><span data-stu-id="f96cb-592">Does not adjust hello pool size within hello first 10 minutes of hello pool's lifecycle.</span></span>
* <span data-ttu-id="f96cb-593">Po 10 minutách, získá maximální hodnotu hello hello počet spuštění a aktivní úlohy v rámci hello za posledních 60 minut.</span><span class="sxs-lookup"><span data-stu-id="f96cb-593">After 10 minutes, obtains hello max value of hello number of running and active tasks within hello past 60 minutes.</span></span>
  * <span data-ttu-id="f96cb-594">Pokud jsou obě hodnoty 0 (což znamená, že žádné úlohy byly spuštěné nebo aktivní v hello posledních 60 minut), je nastavit velikost fondu hello too0.</span><span class="sxs-lookup"><span data-stu-id="f96cb-594">If both values are 0 (indicating that no tasks were running or active in hello last 60 minutes), hello pool size is set too0.</span></span>
  * <span data-ttu-id="f96cb-595">Pokud je buď hodnota větší než nula, nebudou provedeny žádné změny.</span><span class="sxs-lookup"><span data-stu-id="f96cb-595">If either value is greater than zero, no change is made.</span></span>

```csharp
string now = DateTime.UtcNow.ToString("r");
string formula = string.Format(@"
    $TargetDedicatedNodes = {1};
    lifespan         = time() - time(""{0}"");
    span             = TimeInterval_Minute * 60;
    startup          = TimeInterval_Minute * 10;
    ratio            = 50;

    $TargetDedicatedNodes = (lifespan > startup ? (max($RunningTasks.GetSample(span, ratio), $ActiveTasks.GetSample(span, ratio)) == 0 ? 0 : $TargetDedicatedNodes) : {1});
    ", now, 4);
```

## <a name="next-steps"></a><span data-ttu-id="f96cb-596">Další kroky</span><span class="sxs-lookup"><span data-stu-id="f96cb-596">Next steps</span></span>
* <span data-ttu-id="f96cb-597">[Maximalizovat využití prostředků Azure Batch výpočetní uzel souběžných úloh](batch-parallel-node-tasks.md) obsahuje podrobnosti o tom, jak můžete spustit více úloh s současně na hello výpočetních uzlů ve fondu.</span><span class="sxs-lookup"><span data-stu-id="f96cb-597">[Maximize Azure Batch compute resource usage with concurrent node tasks](batch-parallel-node-tasks.md) contains details about how you can execute multiple tasks simultaneously on hello compute nodes in your pool.</span></span> <span data-ttu-id="f96cb-598">Kromě tooautoscaling, tato funkce může pomoct toolower dobu trvání úlohy pro některé úlohy, ušetřit peníze.</span><span class="sxs-lookup"><span data-stu-id="f96cb-598">In addition tooautoscaling, this feature may help toolower job duration for some workloads, saving you money.</span></span>
* <span data-ttu-id="f96cb-599">Pro jiné podpůrná efektivitu Ujistěte se, že vaše dotazy aplikace Batch hello služba Batch v hello většina optimální způsob.</span><span class="sxs-lookup"><span data-stu-id="f96cb-599">For another efficiency booster, ensure that your Batch application queries hello Batch service in hello most optimal way.</span></span> <span data-ttu-id="f96cb-600">V tématu [efektivní dotazování služby Azure Batch hello](batch-efficient-list-queries.md) toolearn jak toolimit hello množství dat, když dotazujete hello stav potenciálně tisíce protne hello přenosová výpočetní uzly nebo úlohy.</span><span class="sxs-lookup"><span data-stu-id="f96cb-600">See [Query hello Azure Batch service efficiently](batch-efficient-list-queries.md) toolearn how toolimit hello amount of data that crosses hello wire when you query hello status of potentially thousands of compute nodes or tasks.</span></span>

[net_api]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch
[net_batchclient]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.batchclient
[net_cloudpool_autoscaleformula]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleformula
[net_cloudpool_autoscaleevalinterval]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.autoscaleevaluationinterval
[net_enableautoscaleasync]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.enableautoscaleasync
[net_maxtasks]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudpool.maxtaskspercomputenode
[net_poolops_resizepoolasync]: https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.pooloperations.resizepoolasync

[rest_api]: https://docs.microsoft.com/rest/api/batchservice/
[rest_autoscaleformula]: https://docs.microsoft.com/rest/api/batchservice/enable-automatic-scaling-on-a-pool
[rest_autoscaleinterval]: https://docs.microsoft.com/rest/api/batchservice/enable-automatic-scaling-on-a-pool
[rest_enableautoscale]: https://docs.microsoft.com/rest/api/batchservice/enable-automatic-scaling-on-a-pool
