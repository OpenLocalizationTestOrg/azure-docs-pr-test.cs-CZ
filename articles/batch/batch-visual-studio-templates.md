---
title: "sestavování řešení Batch s použitím šablony projektů Visual Studio – Azure aaaStart | Microsoft Docs"
description: "Zjistěte, jak pomocí šablony projektů Visual Studio můžete implementovat a spouštět úlohy náročné na Azure Batch."
services: batch
documentationcenter: .net
author: fayora
manager: timlt
editor: 
ms.assetid: 5e041ae2-25af-4882-a79e-3aa63c4bfb20
ms.service: batch
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: big-compute
ms.date: 02/27/2017
ms.author: tamram
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: a61c480ddc4dffd66c01220a137a3e852e39c338
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="use-visual-studio-project-templates-toojump-start-batch-solutions"></a><span data-ttu-id="091bd-103">Pomocí řešení Batch toojump-start šablony projektů sady Visual Studio</span><span class="sxs-lookup"><span data-stu-id="091bd-103">Use Visual Studio project templates toojump-start Batch solutions</span></span>

<span data-ttu-id="091bd-104">Hello **Správce úloh** a **šablony sady Visual Studio úloh procesoru** pro dávku zadejte kód toohelp jste tooimplement a spusťte úlohy náročné na dávce s hello alespoň úsilí.</span><span class="sxs-lookup"><span data-stu-id="091bd-104">hello **Job Manager** and **Task Processor Visual Studio templates** for Batch provide code toohelp you tooimplement and run your compute-intensive workloads on Batch with hello least amount of effort.</span></span> <span data-ttu-id="091bd-105">Tento dokument popisuje tyto šablony a poskytuje pokyny, jak toouse je.</span><span class="sxs-lookup"><span data-stu-id="091bd-105">This document describes these templates and provides guidance for how toouse them.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="091bd-106">Tento článek popisuje pouze informace toothese použít dvě šablony a předpokládá, že jste obeznámeni s služba Batch hello a související tooit klíčové koncepty: fondy, výpočetní uzly, úlohy a úlohy, úkolech Správce úloh, proměnné prostředí a další důležité informace.</span><span class="sxs-lookup"><span data-stu-id="091bd-106">This article discusses only information applicable toothese two templates, and assumes that you are familiar with hello Batch service and key concepts related tooit: pools, compute nodes, jobs and tasks, job manager tasks, environment variables, and other relevant information.</span></span> <span data-ttu-id="091bd-107">Můžete najít další informace v [základy Azure Batch](batch-technical-overview.md), [přehled funkcí Batch pro vývojáře](batch-api-basics.md), a [Začínáme s knihovnou Azure Batch hello pro .NET](batch-dotnet-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="091bd-107">You can find more information in [Basics of Azure Batch](batch-technical-overview.md), [Batch feature overview for developers](batch-api-basics.md), and [Get started with hello Azure Batch library for .NET](batch-dotnet-get-started.md).</span></span>
> 
> 

## <a name="high-level-overview"></a><span data-ttu-id="091bd-108">Podrobný přehled</span><span class="sxs-lookup"><span data-stu-id="091bd-108">High-level overview</span></span>
<span data-ttu-id="091bd-109">Hello Správce úloh a úloh procesoru šablony může být použité toocreate dvě užitečné součásti:</span><span class="sxs-lookup"><span data-stu-id="091bd-109">hello Job Manager and Task Processor templates can be used toocreate two useful components:</span></span>

* <span data-ttu-id="091bd-110">Úkolu Správce úloh, který implementuje rozdělovače úlohy, který můžete rozdělit úlohu na více úkolů, které můžete spustit samostatně, paralelně.</span><span class="sxs-lookup"><span data-stu-id="091bd-110">A job manager task that implements a job splitter that can break a job down into multiple tasks that can run independently, in parallel.</span></span>
* <span data-ttu-id="091bd-111">Procesor úloh, které lze použít tooperform předběžné zpracování a po zpracování kolem příkazového řádku s aplikací.</span><span class="sxs-lookup"><span data-stu-id="091bd-111">A task processor that can be used tooperform pre-processing and post-processing around an application command line.</span></span>

<span data-ttu-id="091bd-112">Například v případě vykreslování film by hello úlohy rozdělovače zapněte úlohu jeden film do stovkami nebo tisíci samostatné úkoly, které by jednotlivé snímky zpracovávají odděleně.</span><span class="sxs-lookup"><span data-stu-id="091bd-112">For example, in a movie rendering scenario, hello job splitter would turn a single movie job into hundreds or thousands of separate tasks that would process individual frames separately.</span></span> <span data-ttu-id="091bd-113">Odpovídajícím způsobem procesoru úloh hello by vyvolání hello vykreslování aplikace a všechny závislé procesy, které jsou potřebné toorender každý snímek, jakož i provádět žádné další akce (například kopírování hello vykresluje rámce tooa umístění úložiště).</span><span class="sxs-lookup"><span data-stu-id="091bd-113">Correspondingly, hello task processor would invoke hello rendering application and all dependent processes that are needed toorender each frame, as well as perform any additional actions (for example, copying hello rendered frame tooa storage location).</span></span>

> [!NOTE]
> <span data-ttu-id="091bd-114">Hello Správce úloh a úloh procesoru šablony jsou nezávisle na sobě navzájem, abyste si mohli vybrat toouse oba, nebo jenom jeden z nich, v závislosti na požadavcích hello výpočetní úlohy a vaše předvolby.</span><span class="sxs-lookup"><span data-stu-id="091bd-114">hello Job Manager and Task Processor templates are independent of each other, so you can choose toouse both, or only one of them, depending on hello requirements of your compute job and on your preferences.</span></span>
> 
> 

<span data-ttu-id="091bd-115">Jak je znázorněno v následujícím diagramu hello, bude výpočetní úlohu, která používá tyto šablony projít tří fází:</span><span class="sxs-lookup"><span data-stu-id="091bd-115">As shown in hello diagram below, a compute job that uses these templates will go through three stages:</span></span>

1. <span data-ttu-id="091bd-116">Kód klienta Hello (např. aplikace, webové služby atd.) odešle toohello úlohy služby Batch v Azure, a jako jeho úlohy správce úloh hello úlohy správce program.</span><span class="sxs-lookup"><span data-stu-id="091bd-116">hello client code (e.g., application, web service, etc.) submits a job toohello Batch service on Azure, specifying as its job manager task hello job manager program.</span></span>
2. <span data-ttu-id="091bd-117">Služba Batch Hello spouští hello úkolu Správce úloh na výpočetním uzlu a hello hello spustí úlohu rozdělovače zadaný počet úloh procesoru úlohy, na jako mnoho výpočetních uzlech podle potřeby, na základě specifikací v hello úlohy rozdělovače kódu a parametry hello.</span><span class="sxs-lookup"><span data-stu-id="091bd-117">hello Batch service runs hello job manager task on a compute node and hello job splitter launches hello specified number of task processor tasks, on as many compute nodes as required, based on hello parameters and specifications in hello job splitter code.</span></span>
3. <span data-ttu-id="091bd-118">Hello úloh procesoru úlohy spustit samostatně, paralelní, tooprocess hello vstupní data a vygenerovat výstupní data hello.</span><span class="sxs-lookup"><span data-stu-id="091bd-118">hello task processor tasks run independently, in parallel, tooprocess hello input data and generate hello output data.</span></span>

![Diagram znázorňující, jak kód klienta komunikuje s hello služby Batch][diagram01]

## <a name="prerequisites"></a><span data-ttu-id="091bd-120">Požadavky</span><span class="sxs-lookup"><span data-stu-id="091bd-120">Prerequisites</span></span>
<span data-ttu-id="091bd-121">toouse hello Batch šablony, budete potřebovat následující hello:</span><span class="sxs-lookup"><span data-stu-id="091bd-121">toouse hello Batch templates, you will need hello following:</span></span>

* <span data-ttu-id="091bd-122">Počítač s nainstalovaná sada Visual Studio 2015.</span><span class="sxs-lookup"><span data-stu-id="091bd-122">A computer with Visual Studio 2015 installed.</span></span> <span data-ttu-id="091bd-123">Šablony batch jsou aktuálně podporovány pouze pro Visual Studio 2015.</span><span class="sxs-lookup"><span data-stu-id="091bd-123">Batch templates are currently only supported for Visual Studio 2015.</span></span>
* <span data-ttu-id="091bd-124">Hello Batch šablony, které jsou k dispozici na hello [Galerie sady Visual Studio] [ vs_gallery] jako rozšíření Visual Studia.</span><span class="sxs-lookup"><span data-stu-id="091bd-124">hello Batch templates, which are available from hello [Visual Studio Gallery][vs_gallery] as Visual Studio extensions.</span></span> <span data-ttu-id="091bd-125">Existují dva způsoby tooget hello šablony:</span><span class="sxs-lookup"><span data-stu-id="091bd-125">There are two ways tooget hello templates:</span></span>
  
  * <span data-ttu-id="091bd-126">Instalace šablony hello používá hello **rozšíření a aktualizace** dialogové okno v sadě Visual Studio (Další informace najdete v tématu [hledání a používání rozšíření Visual Studia][vs_find_use_ext]).</span><span class="sxs-lookup"><span data-stu-id="091bd-126">Install hello templates using hello **Extensions and Updates** dialog box in Visual Studio (for more information, see [Finding and Using Visual Studio Extensions][vs_find_use_ext]).</span></span> <span data-ttu-id="091bd-127">V hello **rozšíření a aktualizace** dialogové okno, hledání a stahování hello následující dvě rozšíření:</span><span class="sxs-lookup"><span data-stu-id="091bd-127">In hello **Extensions and Updates** dialog box, search and download hello following two extensions:</span></span>
    
    * <span data-ttu-id="091bd-128">Správce úloh Azure Batch pomocí rozdělovače úlohy</span><span class="sxs-lookup"><span data-stu-id="091bd-128">Azure Batch Job Manager with Job Splitter</span></span>
    * <span data-ttu-id="091bd-129">Procesor úlohy Azure Batch</span><span class="sxs-lookup"><span data-stu-id="091bd-129">Azure Batch Task Processor</span></span>
  * <span data-ttu-id="091bd-130">Stahování šablon hello z online galerie hello pro sadu Visual Studio: [projektu šablony aplikace Microsoft Azure Batch][vs_gallery_templates]</span><span class="sxs-lookup"><span data-stu-id="091bd-130">Download hello templates from hello online gallery for Visual Studio: [Microsoft Azure Batch Project Templates][vs_gallery_templates]</span></span>
* <span data-ttu-id="091bd-131">Pokud máte v plánu toouse hello [balíčky aplikací](batch-application-packages.md) Správce úloh hello toodeploy funkce a toohello procesoru úlohy Batch výpočetní uzly, musíte toolink tooyour účet úložiště účtu Batch.</span><span class="sxs-lookup"><span data-stu-id="091bd-131">If you plan toouse hello [Application Packages](batch-application-packages.md) feature toodeploy hello job manager and task processor toohello Batch compute nodes, you need toolink a storage account tooyour Batch account.</span></span>

## <a name="preparation"></a><span data-ttu-id="091bd-132">Příprava</span><span class="sxs-lookup"><span data-stu-id="091bd-132">Preparation</span></span>
<span data-ttu-id="091bd-133">Doporučujeme vytvářet řešení, které může obsahovat váš správce úloh a také vaše úloha procesoru, protože to může být snazší kód tooshare mezi Správce úloh a úloh procesoru programy.</span><span class="sxs-lookup"><span data-stu-id="091bd-133">We recommend creating a solution that can contain your job manager as well as your task processor, because this can make it easier tooshare code between your job manager and task processor programs.</span></span> <span data-ttu-id="091bd-134">toocreate toto řešení, postupujte takto:</span><span class="sxs-lookup"><span data-stu-id="091bd-134">toocreate this solution, follow these steps:</span></span>

1. <span data-ttu-id="091bd-135">Otevřete Visual Studio a vyberte **soubor** > **nový** > **projektu**.</span><span class="sxs-lookup"><span data-stu-id="091bd-135">Open Visual Studio and select **File** > **New** > **Project**.</span></span>
2. <span data-ttu-id="091bd-136">V části **šablony**, rozbalte položku **jiné typy projektů**, klikněte na tlačítko **řešení sady Visual Studio**a potom vyberte **prázdného řešení**.</span><span class="sxs-lookup"><span data-stu-id="091bd-136">Under **Templates**, expand **Other Project Types**, click **Visual Studio Solutions**, and then select **Blank Solution**.</span></span>
3. <span data-ttu-id="091bd-137">Zadejte název, který popisuje účel vaší aplikace a hello tohoto řešení (například "LitwareBatchTaskPrograms").</span><span class="sxs-lookup"><span data-stu-id="091bd-137">Type a name that describes your application and hello purpose of this solution (e.g., "LitwareBatchTaskPrograms").</span></span>
4. <span data-ttu-id="091bd-138">toocreate hello nové řešení, klikněte na tlačítko **OK**.</span><span class="sxs-lookup"><span data-stu-id="091bd-138">toocreate hello new solution, click **OK**.</span></span>

## <a name="job-manager-template"></a><span data-ttu-id="091bd-139">Správce úloh šablony</span><span class="sxs-lookup"><span data-stu-id="091bd-139">Job Manager template</span></span>
<span data-ttu-id="091bd-140">Správce úloh šablony Hello pomáhá tooimplement úkolu Správce úloh, které můžete provádět následující akce hello:</span><span class="sxs-lookup"><span data-stu-id="091bd-140">hello Job Manager template helps you tooimplement a job manager task that can perform hello following actions:</span></span>

* <span data-ttu-id="091bd-141">Úlohu rozdělte do několika úloh.</span><span class="sxs-lookup"><span data-stu-id="091bd-141">Split a job into multiple tasks.</span></span>
* <span data-ttu-id="091bd-142">Odešlete toorun tyto úlohy v dávce.</span><span class="sxs-lookup"><span data-stu-id="091bd-142">Submit those tasks toorun on Batch.</span></span>

> [!NOTE]
> <span data-ttu-id="091bd-143">Další informace o úkolech Správce úloh najdete v tématu [přehled funkcí Batch pro vývojáře](batch-api-basics.md#job-manager-task).</span><span class="sxs-lookup"><span data-stu-id="091bd-143">For more information about job manager tasks, see [Batch feature overview for developers](batch-api-basics.md#job-manager-task).</span></span>
> 
> 

### <a name="create-a-job-manager-using-hello-template"></a><span data-ttu-id="091bd-144">Vytvoření správce úloh, pomocí šablony hello</span><span class="sxs-lookup"><span data-stu-id="091bd-144">Create a Job Manager using hello template</span></span>
<span data-ttu-id="091bd-145">tooadd řešení toohello Správce úloh, které jste vytvořili dříve, postupujte takto:</span><span class="sxs-lookup"><span data-stu-id="091bd-145">tooadd a job manager toohello solution that you created earlier, follow these steps:</span></span>

1. <span data-ttu-id="091bd-146">Otevřete existující řešení v sadě Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="091bd-146">Open your existing solution in Visual Studio.</span></span>
2. <span data-ttu-id="091bd-147">V Průzkumníku řešení klikněte pravým tlačítkem na řešení hello, klikněte na tlačítko **přidat** > **nový projekt**.</span><span class="sxs-lookup"><span data-stu-id="091bd-147">In Solution Explorer, right-click hello solution, click **Add** > **New Project**.</span></span>
3. <span data-ttu-id="091bd-148">V části **Visual C#**, klikněte na tlačítko **cloudu**a potom klikněte na **Správce úloh Azure Batch pomocí úlohy rozdělovače**.</span><span class="sxs-lookup"><span data-stu-id="091bd-148">Under **Visual C#**, click **Cloud**, and then click **Azure Batch Job Manager with Job Splitter**.</span></span>
4. <span data-ttu-id="091bd-149">Zadejte název, který popisuje vaší aplikace a identifikuje tohoto projektu jako správce úloh hello (např.) "LitwareJobManager").</span><span class="sxs-lookup"><span data-stu-id="091bd-149">Type a name that describes your application and identifies this project as hello job manager (e.g. "LitwareJobManager").</span></span>
5. <span data-ttu-id="091bd-150">toocreate hello projektu, klikněte na tlačítko **OK**.</span><span class="sxs-lookup"><span data-stu-id="091bd-150">toocreate hello project, click **OK**.</span></span>
6. <span data-ttu-id="091bd-151">Nakonec odkazovaná sestavení hello projektu tooforce Visual Studio tooload všech balíčků NuGet a tooverify, který hello projektu je platná, než začnete, provádění úprav.</span><span class="sxs-lookup"><span data-stu-id="091bd-151">Finally, build hello project tooforce Visual Studio tooload all referenced NuGet packages and tooverify that hello project is valid before you start modifying it.</span></span>

### <a name="job-manager-template-files-and-their-purpose"></a><span data-ttu-id="091bd-152">Soubory šablon Správce úloh a jejich účel</span><span class="sxs-lookup"><span data-stu-id="091bd-152">Job Manager template files and their purpose</span></span>
<span data-ttu-id="091bd-153">Při vytváření projektu pomocí šablony Správce úloh hello generuje tři skupiny soubory kódu:</span><span class="sxs-lookup"><span data-stu-id="091bd-153">When you create a project using hello Job Manager template, it generates three groups of code files:</span></span>

* <span data-ttu-id="091bd-154">hlavní programový soubor Hello (Program.cs).</span><span class="sxs-lookup"><span data-stu-id="091bd-154">hello main program file (Program.cs).</span></span> <span data-ttu-id="091bd-155">Tato položka obsahuje hello program Vstupní bod a nejvyšší úrovně výjimek.</span><span class="sxs-lookup"><span data-stu-id="091bd-155">This contains hello program entry point and top-level exception handling.</span></span> <span data-ttu-id="091bd-156">Neměli byste potřebovat normálně toomodify to.</span><span class="sxs-lookup"><span data-stu-id="091bd-156">You shouldn't normally need toomodify this.</span></span>
* <span data-ttu-id="091bd-157">adresář Framework Hello.</span><span class="sxs-lookup"><span data-stu-id="091bd-157">hello Framework directory.</span></span> <span data-ttu-id="091bd-158">Tato položka obsahuje soubory hello zodpovědná za pracovní, často používaný text"hello provádí program Správce úloh hello – vybalení parametry, přidávání úlohy toohello dávkovou úlohu, atd. Neměli byste potřebovat normálně toomodify tyto soubory.</span><span class="sxs-lookup"><span data-stu-id="091bd-158">This contains hello files responsible for hello 'boilerplate' work done by hello job manager program – unpacking parameters, adding tasks toohello Batch job, etc. You shouldn't normally need toomodify these files.</span></span>
* <span data-ttu-id="091bd-159">Hello úlohy rozdělovače soubor (JobSplitter.cs).</span><span class="sxs-lookup"><span data-stu-id="091bd-159">hello job splitter file (JobSplitter.cs).</span></span> <span data-ttu-id="091bd-160">Toto je, kam jste umístili specifické pro aplikaci logiky k rozdělení úlohu do úlohy.</span><span class="sxs-lookup"><span data-stu-id="091bd-160">This is where you will put your application-specific logic for splitting a job into tasks.</span></span>

<span data-ttu-id="091bd-161">Samozřejmě můžete přidat další soubory jako požadované toosupport kódu rozdělovače úlohy, v závislosti na složitosti hello hello úlohu, rozdělování logiku.</span><span class="sxs-lookup"><span data-stu-id="091bd-161">Of course you can add additional files as required toosupport your job splitter code, depending on hello complexity of hello job splitting logic.</span></span>

<span data-ttu-id="091bd-162">Šablona Hello generuje také standardní soubory rozhraní .NET projektu, například souboru .csproj, app.config, souboru packages.config, atd.</span><span class="sxs-lookup"><span data-stu-id="091bd-162">hello template also generates standard .NET project files such as a .csproj file, app.config, packages.config, etc.</span></span>

<span data-ttu-id="091bd-163">Hello zbývající část tohoto oddílu popisuje hello různých souborů a jejich struktura kódu a vysvětluje, jaké jsou jednotlivé třídy.</span><span class="sxs-lookup"><span data-stu-id="091bd-163">hello rest of this section describes hello different files and their code structure, and explains what each class does.</span></span>

![Visual Studio Průzkumník řešení zobrazující hello Správce úloh šablony řešení][solution_explorer01]

<span data-ttu-id="091bd-165">**Soubory Framework**</span><span class="sxs-lookup"><span data-stu-id="091bd-165">**Framework files**</span></span>

* <span data-ttu-id="091bd-166">`Configuration.cs`: Zapouzdří hello načítání úlohy konfiguračních dat, jako je například Podrobnosti účtu Batch, přihlašovací údaje účtu propojené úložiště, úlohy a úkolů informace a parametry úlohy.</span><span class="sxs-lookup"><span data-stu-id="091bd-166">`Configuration.cs`: Encapsulates hello loading of job configuration data such as Batch account details, linked storage account credentials, job and task information, and job parameters.</span></span> <span data-ttu-id="091bd-167">Také poskytuje přístup tooBatch definované proměnné prostředí (viz nastavení prostředí pro úkoly v dokumentaci Batch hello) prostřednictvím třídy Configuration.EnvironmentVariable hello.</span><span class="sxs-lookup"><span data-stu-id="091bd-167">It also provides access tooBatch-defined environment variables (see Environment settings for tasks, in hello Batch documentation) via hello Configuration.EnvironmentVariable class.</span></span>
* <span data-ttu-id="091bd-168">`IConfiguration.cs`: Přehledů hello implementace hello třída konfigurace, aby bylo možné jednotkové testování vaší rozdělovače úlohy pomocí falešných nebo imitované konfiguraci objektu.</span><span class="sxs-lookup"><span data-stu-id="091bd-168">`IConfiguration.cs`: Abstracts hello implementation of hello Configuration class, so that you can unit test your job splitter using a fake or mock configuration object.</span></span>
* <span data-ttu-id="091bd-169">`JobManager.cs`: Orchestruje hello součásti programu Správce úloh hello.</span><span class="sxs-lookup"><span data-stu-id="091bd-169">`JobManager.cs`: Orchestrates hello components of hello job manager program.</span></span> <span data-ttu-id="091bd-170">Zodpovídá za inicializaci hello úlohy rozdělovače, vyvolání hello úlohy rozdělovače, hello a odeslání úlohy hello vrácený odesílatel úlohy toohello rozdělovače úlohy hello.</span><span class="sxs-lookup"><span data-stu-id="091bd-170">It is responsible for hello initializing hello job splitter, invoking hello job splitter, and dispatching hello tasks returned by hello job splitter toohello task submitter.</span></span>
* <span data-ttu-id="091bd-171">`JobManagerException.cs`: Představuje chybu, která vyžaduje hello úlohy správce tooterminate.</span><span class="sxs-lookup"><span data-stu-id="091bd-171">`JobManagerException.cs`: Represents an error that requires hello job manager tooterminate.</span></span> <span data-ttu-id="091bd-172">JobManagerException je použité toowrap 'očekávání, chyby, kde lze zadat konkrétní diagnostické informace jako součást ukončení.</span><span class="sxs-lookup"><span data-stu-id="091bd-172">JobManagerException is used toowrap 'expected' errors where specific diagnostic information can be provided as part of termination.</span></span>
* <span data-ttu-id="091bd-173">`TaskSubmitter.cs`: Tato třída je odpovědný tooadding úlohy vrácený hello úlohy rozdělovače toohello dávkovou úlohu.</span><span class="sxs-lookup"><span data-stu-id="091bd-173">`TaskSubmitter.cs`: This class is responsible tooadding tasks returned by hello job splitter toohello Batch job.</span></span> <span data-ttu-id="091bd-174">Třída JobManager Hello agreguje hello pořadí úloh do dávek pro efektivní, ale včas přidání toohello úlohu a potom volá TaskSubmitter.SubmitTasks vlákna na pozadí pro každou dávku.</span><span class="sxs-lookup"><span data-stu-id="091bd-174">hello JobManager class aggregates hello sequence of tasks into batches for efficient but timely addition toohello job, then calls TaskSubmitter.SubmitTasks on a background thread for each batch.</span></span>

<span data-ttu-id="091bd-175">**Úloha rozdělovače**</span><span class="sxs-lookup"><span data-stu-id="091bd-175">**Job Splitter**</span></span>

<span data-ttu-id="091bd-176">`JobSplitter.cs`: Tato třída obsahuje konkrétní aplikace logiky k rozdělení hello úlohy do úlohy.</span><span class="sxs-lookup"><span data-stu-id="091bd-176">`JobSplitter.cs`: This class contains application-specific logic for splitting hello job into tasks.</span></span> <span data-ttu-id="091bd-177">Hello framework vyvolá hello JobSplitter.Split metoda tooobtain sekvenci úlohy, které přidá vrátí tyto adresy úlohy toohello jako metodu hello.</span><span class="sxs-lookup"><span data-stu-id="091bd-177">hello framework invokes hello JobSplitter.Split method tooobtain a sequence of tasks, which it adds toohello job as hello method returns them.</span></span> <span data-ttu-id="091bd-178">Toto je třída hello, kde bude vložit hello logiku úlohy.</span><span class="sxs-lookup"><span data-stu-id="091bd-178">This is hello class where you will inject hello logic of your job.</span></span> <span data-ttu-id="091bd-179">Implementujte hello rozdělení metoda tooreturn posloupnost instancí CloudTask představující hello úlohy, do kterých chcete, aby úloha toopartition hello.</span><span class="sxs-lookup"><span data-stu-id="091bd-179">Implement hello Split method tooreturn a sequence of CloudTask instances representing hello tasks into which you want toopartition hello job.</span></span>

<span data-ttu-id="091bd-180">**Standardní soubory projektu příkazového řádku .NET**</span><span class="sxs-lookup"><span data-stu-id="091bd-180">**Standard .NET command line project files**</span></span>

* <span data-ttu-id="091bd-181">`App.config`: Standardní soubor konfigurace aplikace .NET.</span><span class="sxs-lookup"><span data-stu-id="091bd-181">`App.config`: Standard .NET application configuration file.</span></span>
* <span data-ttu-id="091bd-182">`Packages.config`: Standardní soubor závislost balíčku NuGet.</span><span class="sxs-lookup"><span data-stu-id="091bd-182">`Packages.config`: Standard NuGet package dependency file.</span></span>
* <span data-ttu-id="091bd-183">`Program.cs`: Obsahuje hello program Vstupní bod a nejvyšší úrovně výjimek.</span><span class="sxs-lookup"><span data-stu-id="091bd-183">`Program.cs`: Contains hello program entry point and top-level exception handling.</span></span>

### <a name="implementing-hello-job-splitter"></a><span data-ttu-id="091bd-184">Implementace rozdělovače úlohy hello</span><span class="sxs-lookup"><span data-stu-id="091bd-184">Implementing hello job splitter</span></span>
<span data-ttu-id="091bd-185">Když otevřete projekt šablony hello Správce úloh, bude mít hello projektu hello JobSplitter.cs soubor otevřete ve výchozím nastavení.</span><span class="sxs-lookup"><span data-stu-id="091bd-185">When you open hello Job Manager template project, hello project will have hello JobSplitter.cs file open by default.</span></span> <span data-ttu-id="091bd-186">Můžete implementovat hello rozdělení logiku pro úlohy hello v vaše úlohy pomocí hello Split() metoda zobrazit níže:</span><span class="sxs-lookup"><span data-stu-id="091bd-186">You can implement hello split logic for hello tasks in your workload by using hello Split() method show below:</span></span>

```csharp
/// <summary>
/// Gets hello tasks into which toosplit hello job. This is where you inject
/// your application-specific logic for decomposing hello job into tasks.
///
/// hello job manager framework invokes hello Split method for you; you need
/// only tooimplement it, not toocall it yourself. Typically, your
/// implementation should return tasks lazily, for example using a C#
/// iterator and hello "yield return" statement; this allows tasks toobe added
/// and toostart running while splitting is still in progress.
/// </summary>
/// <returns>hello tasks toobe added toohello job. Tasks are added automatically
/// by hello job manager framework as they are returned by this method.</returns>
public IEnumerable<CloudTask> Split()
{
    // Your code for hello split logic goes here.
    int startFrame = Convert.ToInt32(_parameters["StartFrame"]);
    int endFrame = Convert.ToInt32(_parameters["EndFrame"]);

    for (int i = startFrame; i <= endFrame; i++)
    {
        yield return new CloudTask("myTask" + i, "cmd /c dir");
    }
}
```

> [!NOTE]
> <span data-ttu-id="091bd-187">Hello opatřeny poznámkami v hello části `Split()` metoda je hello pouze část hello kód šablony Správce úloh, který je určený pro toomodify můžete přidáním hello logiku toosplit úloh do různých úloh.</span><span class="sxs-lookup"><span data-stu-id="091bd-187">hello annotated section in hello `Split()` method is hello only section of hello Job Manager template code that is intended for you toomodify by adding hello logic toosplit your jobs into different tasks.</span></span> <span data-ttu-id="091bd-188">Pokud chcete toomodify různé části hello šablony, zkontrolujte, zda jsou familiarized s fungování Batch a vyzkoušejte několik hello [ukázky kódu služby Batch][github_samples].</span><span class="sxs-lookup"><span data-stu-id="091bd-188">If you want toomodify a different section of hello template, please ensure you are familiarized with how Batch works, and try out a few of hello [Batch code samples][github_samples].</span></span>
> 
> 

<span data-ttu-id="091bd-189">Implementace Split() má přístup k:</span><span class="sxs-lookup"><span data-stu-id="091bd-189">Your Split() implementation has access to:</span></span>

* <span data-ttu-id="091bd-190">Parametry úlohy prostřednictvím hello Hello `_parameters` pole.</span><span class="sxs-lookup"><span data-stu-id="091bd-190">hello job parameters, via hello `_parameters` field.</span></span>
* <span data-ttu-id="091bd-191">objekt představující úlohu hello prostřednictvím hello Hello CloudJob `_job` pole.</span><span class="sxs-lookup"><span data-stu-id="091bd-191">hello CloudJob object representing hello job, via hello `_job` field.</span></span>
* <span data-ttu-id="091bd-192">objekt představující hello úkolu Správce úloh, prostřednictvím hello Hello CloudTask `_jobManagerTask` pole.</span><span class="sxs-lookup"><span data-stu-id="091bd-192">hello CloudTask object representing hello job manager task, via hello `_jobManagerTask` field.</span></span>

<span data-ttu-id="091bd-193">Vaše `Split()` implementace nemusí tooadd úlohy toohello úlohy přímo.</span><span class="sxs-lookup"><span data-stu-id="091bd-193">Your `Split()` implementation does not need tooadd tasks toohello job directly.</span></span> <span data-ttu-id="091bd-194">Místo toho kódu by měla vrátit pořadí objektů CloudTask a tyto úlohy toohello automaticky přidá hello framework třídy, které vyvolají rozdělovače úlohy hello.</span><span class="sxs-lookup"><span data-stu-id="091bd-194">Instead, your code should return a sequence of CloudTask objects, and these will be added toohello job automatically by hello framework classes that invoke hello job splitter.</span></span> <span data-ttu-id="091bd-195">Je běžné toouse C# na iterator (`yield return`) funkci příčky tooimplement úlohy, jako to umožňuje toostart hello úlohy s co možná nejdříve než čekání na všechny úlohy toobe vypočítat.</span><span class="sxs-lookup"><span data-stu-id="091bd-195">It's common toouse C#'s iterator (`yield return`) feature tooimplement job splitters as this allows hello tasks toostart running as soon as possible rather than waiting for all tasks toobe calculated.</span></span>

<span data-ttu-id="091bd-196">**Selhání úlohy rozdělovače**</span><span class="sxs-lookup"><span data-stu-id="091bd-196">**Job splitter failure**</span></span>

<span data-ttu-id="091bd-197">Pokud vaše úlohy rozdělovače dojde k chybě, měli buď:</span><span class="sxs-lookup"><span data-stu-id="091bd-197">If your job splitter encounters an error, it should either:</span></span>

* <span data-ttu-id="091bd-198">Ukončit hello pořadí pomocí hello C# `yield break` příkaz, ve kterém bude Správce úloh případu hello jednal jako úspěšné; nebo</span><span class="sxs-lookup"><span data-stu-id="091bd-198">Terminate hello sequence using hello C# `yield break` statement, in which case hello job manager will be treated as successful; or</span></span>
* <span data-ttu-id="091bd-199">Způsobí výjimku, ve kterém případu hello Správce úloh bude považován za se nezdařilo a může v závislosti na klienta hello konfiguraci ji opakovat).</span><span class="sxs-lookup"><span data-stu-id="091bd-199">Throw an exception, in which case hello job manager will be treated as failed and may be retried depending on how hello client has configured it).</span></span>

<span data-ttu-id="091bd-200">V obou případech všechny úlohy již vrácený rozdělovače hello úlohy a přidané toohello dávkové úlohy bude vhodné toorun.</span><span class="sxs-lookup"><span data-stu-id="091bd-200">In both cases, any tasks already returned by hello job splitter and added toohello Batch job will be eligible toorun.</span></span> <span data-ttu-id="091bd-201">Pokud nechcete, aby tento toohappen, pak vám může:</span><span class="sxs-lookup"><span data-stu-id="091bd-201">If you don't want this toohappen, then you could:</span></span>

* <span data-ttu-id="091bd-202">Ukončit úlohu hello před návratem od hello úlohy rozdělovače</span><span class="sxs-lookup"><span data-stu-id="091bd-202">Terminate hello job before returning from hello job splitter</span></span>
* <span data-ttu-id="091bd-203">Formulovali hello celý úkol kolekcí před jejím vrácením (tedy vrátit `ICollection<CloudTask>` nebo `IList<CloudTask>` místo implementace rozdělovače vaše úlohy pomocí iterator C#)</span><span class="sxs-lookup"><span data-stu-id="091bd-203">Formulate hello entire task collection before returning it (that is, return an `ICollection<CloudTask>` or `IList<CloudTask>` instead of implementing your job splitter using a C# iterator)</span></span>
* <span data-ttu-id="091bd-204">Použít toomake závislosti úkolů, všechny úlohy jsou závislé na úspěšné dokončení hello hello Správce úloh</span><span class="sxs-lookup"><span data-stu-id="091bd-204">Use task dependencies toomake all tasks depend on hello successful completion of hello job manager</span></span>

<span data-ttu-id="091bd-205">**Opakování úlohy správce**</span><span class="sxs-lookup"><span data-stu-id="091bd-205">**Job manager retries**</span></span>

<span data-ttu-id="091bd-206">Správce úloh hello selže, může být opakovat hello služba Batch v závislosti na nastavení opakování hello klienta.</span><span class="sxs-lookup"><span data-stu-id="091bd-206">If hello job manager fails, it may be retried by hello Batch service depending on hello client retry settings.</span></span> <span data-ttu-id="091bd-207">Obecně platí to je bezpečné, protože při hello framework přidá úlohy toohello úlohy, je ignorováno jakékoli úlohy, které již existují.</span><span class="sxs-lookup"><span data-stu-id="091bd-207">In general, this is safe, because when hello framework adds tasks toohello job, it ignores any tasks that already exist.</span></span> <span data-ttu-id="091bd-208">Ale pokud výpočet úlohy je náročná, nemusí chcete tooincur hello náklady přepočítání úlohy, které již byly přidány toohello úlohy; Naopak pokud hello spusťte znovu není zaručenou toogenerate hello stejné ID úloh pak nebude nové chování 'ignorovat duplicity' hello.</span><span class="sxs-lookup"><span data-stu-id="091bd-208">However, if calculating tasks is expensive, you may not wish tooincur hello cost of recalculating tasks that have already been added toohello job; conversely, if hello re-run is not guaranteed toogenerate hello same task IDs then hello 'ignore duplicates' behavior will not kick in.</span></span> <span data-ttu-id="091bd-209">V těchto případech měli navrhnout vaše úlohy rozdělovače toodetect hello práci, kterou již bylo provedeno a neopakuje, například provedením CloudJob.ListTasks před zahájením tooyield úlohy.</span><span class="sxs-lookup"><span data-stu-id="091bd-209">In these cases you should design your job splitter toodetect hello work that has already been done and not repeat it, for example by performing a CloudJob.ListTasks before starting tooyield tasks.</span></span>

### <a name="exit-codes-and-exceptions-in-hello-job-manager-template"></a><span data-ttu-id="091bd-210">Ukončete kódy a výjimky v šabloně hello Správce úloh</span><span class="sxs-lookup"><span data-stu-id="091bd-210">Exit codes and exceptions in hello Job Manager template</span></span>
<span data-ttu-id="091bd-211">Kódy ukončení a výjimky zadejte mechanismus toodetermine hello výsledek spuštění programu, a můžou pomoct tooidentify případné potíže s hello spuštění programu hello.</span><span class="sxs-lookup"><span data-stu-id="091bd-211">Exit codes and exceptions provide a mechanism toodetermine hello outcome of running a program, and they can help tooidentify any problems with hello execution of hello program.</span></span> <span data-ttu-id="091bd-212">Správce úloh šablony Hello implementuje hello ukončovacích kódů a výjimek popsaných v této části.</span><span class="sxs-lookup"><span data-stu-id="091bd-212">hello Job Manager template implements hello exit codes and exceptions described in this section.</span></span>

<span data-ttu-id="091bd-213">Úkolu Správce úloh, která je implementována pomocí šablony Správce úloh hello vrátit tři možné ukončovací kód:</span><span class="sxs-lookup"><span data-stu-id="091bd-213">A job manager task that is implemented with hello Job Manager template can return three possible exit codes:</span></span>

| <span data-ttu-id="091bd-214">Kód</span><span class="sxs-lookup"><span data-stu-id="091bd-214">Code</span></span> | <span data-ttu-id="091bd-215">Popis</span><span class="sxs-lookup"><span data-stu-id="091bd-215">Description</span></span> |
| --- | --- |
| <span data-ttu-id="091bd-216">0</span><span class="sxs-lookup"><span data-stu-id="091bd-216">0</span></span> |<span data-ttu-id="091bd-217">Správce úloh Hello byla úspěšně dokončena.</span><span class="sxs-lookup"><span data-stu-id="091bd-217">hello job manager completed successfully.</span></span> <span data-ttu-id="091bd-218">Kód rozdělovače úloha byla spuštěna toocompletion a všechny úlohy byly přidány toohello úlohy.</span><span class="sxs-lookup"><span data-stu-id="091bd-218">Your job splitter code ran toocompletion, and all tasks were added toohello job.</span></span> |
| <span data-ttu-id="091bd-219">1</span><span class="sxs-lookup"><span data-stu-id="091bd-219">1</span></span> |<span data-ttu-id="091bd-220">Hello úkolu Správce úloh se nezdařilo s výjimkou v 'očekávané' součást programu hello.</span><span class="sxs-lookup"><span data-stu-id="091bd-220">hello job manager task failed with an exception in an 'expected' part of hello program.</span></span> <span data-ttu-id="091bd-221">Výjimka Hello nebyla přeložený tooa JobManagerException s diagnostické informace a, kde je to možné, návrhy na řešení hello selhání.</span><span class="sxs-lookup"><span data-stu-id="091bd-221">hello exception was translated tooa JobManagerException with diagnostic information and, where possible, suggestions for resolving hello failure.</span></span> |
| <span data-ttu-id="091bd-222">2</span><span class="sxs-lookup"><span data-stu-id="091bd-222">2</span></span> |<span data-ttu-id="091bd-223">Hello úkolu Správce úloh se nezdařilo s výjimkou 'neočekávané'.</span><span class="sxs-lookup"><span data-stu-id="091bd-223">hello job manager task failed with an 'unexpected' exception.</span></span> <span data-ttu-id="091bd-224">Hello výjimka zaznamenané toostandard výstup, ale Správce úloh hello byl nelze tooadd jakékoli další diagnostiky nebo nápravnou informace.</span><span class="sxs-lookup"><span data-stu-id="091bd-224">hello exception was logged toostandard output, but hello job manager was unable tooadd any additional diagnostic or remediation information.</span></span> |

<span data-ttu-id="091bd-225">V případě hello úlohy správce úloh selhání některé úlohy mohou stále byly přidány toohello služby před hello došlo k chybě.</span><span class="sxs-lookup"><span data-stu-id="091bd-225">In hello case of job manager task failure, some tasks may still have been added toohello service before hello error occurred.</span></span> <span data-ttu-id="091bd-226">Tyto úlohy se spustí normálně.</span><span class="sxs-lookup"><span data-stu-id="091bd-226">These tasks will run as normal.</span></span> <span data-ttu-id="091bd-227">Najdete v části "Selhání úlohy rozdělovače" nad diskuzi o tuto cestu kódu.</span><span class="sxs-lookup"><span data-stu-id="091bd-227">See "Job Splitter Failure" above for discussion of this code path.</span></span>

<span data-ttu-id="091bd-228">Všechny informace hello vrácený výjimky jsou zapsány do stdout.txt a stderr.txt souborů.</span><span class="sxs-lookup"><span data-stu-id="091bd-228">All hello information returned by exceptions is written into stdout.txt and stderr.txt files.</span></span> <span data-ttu-id="091bd-229">Další informace najdete v tématu [zpracování chyb](batch-api-basics.md#error-handling).</span><span class="sxs-lookup"><span data-stu-id="091bd-229">For more information, see [Error Handling](batch-api-basics.md#error-handling).</span></span>

### <a name="client-considerations"></a><span data-ttu-id="091bd-230">Důležité informace o klientech</span><span class="sxs-lookup"><span data-stu-id="091bd-230">Client considerations</span></span>
<span data-ttu-id="091bd-231">Tato část popisuje některé požadavky na implementaci klienta při vyvolání Správce úloh, na základě této šablony.</span><span class="sxs-lookup"><span data-stu-id="091bd-231">This section describes some client implementation requirements when invoking a job manager based on this template.</span></span> <span data-ttu-id="091bd-232">V tématu [jak toopass parametry a proměnné prostředí z hello kód klienta](#pass-environment-settings) podrobnosti o předání parametry a nastavení prostředí.</span><span class="sxs-lookup"><span data-stu-id="091bd-232">See [How toopass parameters and environment variables from hello client code](#pass-environment-settings) for details on passing parameters and environment settings.</span></span>

<span data-ttu-id="091bd-233">**Povinné přihlašovací údaje**</span><span class="sxs-lookup"><span data-stu-id="091bd-233">**Mandatory credentials**</span></span>

<span data-ttu-id="091bd-234">V úloze pořadí tooadd úlohy toohello Azure Batch hello úkolu Správce úloh vyžaduje adresa URL účtu Azure Batch a klíč.</span><span class="sxs-lookup"><span data-stu-id="091bd-234">In order tooadd tasks toohello Azure Batch job, hello job manager task requires your Azure Batch account URL and key.</span></span> <span data-ttu-id="091bd-235">Je nutné předat v proměnné prostředí s názvem YOUR_BATCH_URL a YOUR_BATCH_KEY.</span><span class="sxs-lookup"><span data-stu-id="091bd-235">You must pass these in environment variables named YOUR_BATCH_URL and YOUR_BATCH_KEY.</span></span> <span data-ttu-id="091bd-236">Můžete nastavit v hello Správce úloh nastavení prostředí úloh.</span><span class="sxs-lookup"><span data-stu-id="091bd-236">You can set these in hello Job Manager task environment settings.</span></span> <span data-ttu-id="091bd-237">Například v C# klienta:</span><span class="sxs-lookup"><span data-stu-id="091bd-237">For example, in a C# client:</span></span>

```csharp
job.JobManagerTask.EnvironmentSettings = new [] {
    new EnvironmentSetting("YOUR_BATCH_URL", "https://account.region.batch.azure.com"),
    new EnvironmentSetting("YOUR_BATCH_KEY", "{your_base64_encoded_account_key}"),
};
```
<span data-ttu-id="091bd-238">**Přihlašovací údaje úložiště**</span><span class="sxs-lookup"><span data-stu-id="091bd-238">**Storage credentials**</span></span>

<span data-ttu-id="091bd-239">Obvykle hello klient nemusí tooprovide hello propojené úložiště účet pověření toohello úkolu Správce úloh, protože správců (a) většinu úloh nepotřebují přístup tooexplicitly, hello propojený účet úložiště a (b) hello propojený účet úložiště se často poskytuje úlohy tooall jako běžné nastavení prostředí pro úlohu hello.</span><span class="sxs-lookup"><span data-stu-id="091bd-239">Typically, hello client does not need tooprovide hello linked storage account credentials toohello job manager task because (a) most job managers do not need tooexplicitly access hello linked storage account and (b) hello linked storage account is often provided tooall tasks as a common environment setting for hello job.</span></span> <span data-ttu-id="091bd-240">Pokud nejsou poskytování hello propojený účet úložiště prostřednictvím hello běžných nastavení prostředí a hello Správce úloh vyžaduje přístup k úložišti toolinked, pak by měl zadat přihlašovací údaje storage hello propojené následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="091bd-240">If you are not providing hello linked storage account via hello common environment settings, and hello job manager requires access toolinked storage, then you should supply hello linked storage credentials as follows:</span></span>

```csharp
job.JobManagerTask.EnvironmentSettings = new [] {
    /* other environment settings */
    new EnvironmentSetting("LINKED_STORAGE_ACCOUNT", "{storageAccountName}"),
    new EnvironmentSetting("LINKED_STORAGE_KEY", "{storageAccountKey}"),
};
```

<span data-ttu-id="091bd-241">**Nastavení úloh Správce úloh**</span><span class="sxs-lookup"><span data-stu-id="091bd-241">**Job manager task settings**</span></span>

<span data-ttu-id="091bd-242">Hello klienta musí nastavit správce úloh hello *killJobOnCompletion* příznak příliš**false**.</span><span class="sxs-lookup"><span data-stu-id="091bd-242">hello client should set hello job manager *killJobOnCompletion* flag too**false**.</span></span>

<span data-ttu-id="091bd-243">Je obvykle bezpečné pro přístup z hello klienta tooset *runExclusive* příliš**false**.</span><span class="sxs-lookup"><span data-stu-id="091bd-243">It is usually safe for hello client tooset *runExclusive* too**false**.</span></span>

<span data-ttu-id="091bd-244">Hello klient musí použít hello *resourceFiles* nebo *applicationPackageReferences* Správce úloh hello kolekce toohave je spustitelný soubor (a její požadované knihovny DLL) nasazené toohello výpočetním uzlu.</span><span class="sxs-lookup"><span data-stu-id="091bd-244">hello client should use hello *resourceFiles* or *applicationPackageReferences* collection toohave hello job manager executable (and its required DLLs) deployed toohello compute node.</span></span>

<span data-ttu-id="091bd-245">Ve výchozím nastavení nebude Správce úloh hello zopakován, pokud se nezdaří.</span><span class="sxs-lookup"><span data-stu-id="091bd-245">By default, hello job manager will not be retried if it fails.</span></span> <span data-ttu-id="091bd-246">V závislosti na logice manager úlohy hello klienta může chtít tooenable opakování prostřednictvím *omezení*/*maxTaskRetryCount*.</span><span class="sxs-lookup"><span data-stu-id="091bd-246">Depending on your job manager logic, hello client may want tooenable retries via *constraints*/*maxTaskRetryCount*.</span></span>

<span data-ttu-id="091bd-247">**Nastavení úloh**</span><span class="sxs-lookup"><span data-stu-id="091bd-247">**Job settings**</span></span>

<span data-ttu-id="091bd-248">Pokud hello úlohy rozdělovače vysílá úlohy se závislostmi, musíte nastavit hello klienta tootrue usesTaskDependencies hello úlohy.</span><span class="sxs-lookup"><span data-stu-id="091bd-248">If hello job splitter emits tasks with dependencies, hello client must set hello job's usesTaskDependencies tootrue.</span></span>

<span data-ttu-id="091bd-249">V modelu rozdělovače úlohy hello neobvyklé, že klienti toowish tooadd úlohy toojobs nad rámec vytvoří jaké úlohu rozdělovače hello.</span><span class="sxs-lookup"><span data-stu-id="091bd-249">In hello job splitter model, it is unusual for clients toowish tooadd tasks toojobs over and above what hello job splitter creates.</span></span> <span data-ttu-id="091bd-250">Hello klienta by měl proto obvykle nastavit hello úlohy *onAllTasksComplete* příliš**terminatejob**.</span><span class="sxs-lookup"><span data-stu-id="091bd-250">hello client should therefore normally set hello job's *onAllTasksComplete* too**terminatejob**.</span></span>

## <a name="task-processor-template"></a><span data-ttu-id="091bd-251">Šablony úloh procesoru</span><span class="sxs-lookup"><span data-stu-id="091bd-251">Task Processor template</span></span>
<span data-ttu-id="091bd-252">Šablony úloh procesoru vám pomůže tooimplement procesor úloh, které můžete provádět následující akce hello:</span><span class="sxs-lookup"><span data-stu-id="091bd-252">A Task Processor template helps you tooimplement a task processor that can perform hello following actions:</span></span>

* <span data-ttu-id="091bd-253">Nastavení informací hello vyžaduje každý toorun úlohy Batch.</span><span class="sxs-lookup"><span data-stu-id="091bd-253">Set up hello information required by each Batch task toorun.</span></span>
* <span data-ttu-id="091bd-254">Spusťte všechny akce, které vyžaduje každý úkol Batch.</span><span class="sxs-lookup"><span data-stu-id="091bd-254">Run all actions required by each Batch task.</span></span>
* <span data-ttu-id="091bd-255">Uložte výstupy úlohy toopersistent úložiště.</span><span class="sxs-lookup"><span data-stu-id="091bd-255">Save task outputs toopersistent storage.</span></span>

<span data-ttu-id="091bd-256">I když procesor úloh není požadovaná toorun úlohy na Batch, hello klíče výhodou použití procesor úloh je, že poskytuje obálku tooimplement všechny akce provádění úkolů na jednom místě.</span><span class="sxs-lookup"><span data-stu-id="091bd-256">Although a task processor is not required toorun tasks on Batch, hello key advantage of using a task processor is that it provides a wrapper tooimplement all task execution actions in one location.</span></span> <span data-ttu-id="091bd-257">Například pokud potřebujete toorun více aplikacemi v kontextu hello každý úkol, nebo pokud potřebujete úložiště toopersistent toocopy dat po dokončení každé úlohy.</span><span class="sxs-lookup"><span data-stu-id="091bd-257">For example, if you need toorun several applications in hello context of each task, or if you need toocopy data toopersistent storage after completing each task.</span></span>

<span data-ttu-id="091bd-258">Hello akce prováděné procesorem hello úloha může být jako jednoduché nebo komplexní a jako mnoho nebo jako několika podle požadavků vaší zatížení.</span><span class="sxs-lookup"><span data-stu-id="091bd-258">hello actions performed by hello task processor can be as simple or complex, and as many or as few, as required by your workload.</span></span> <span data-ttu-id="091bd-259">Kromě toho implementací všechny akce úkolů do jednoho procesoru úloh můžete snadno aktualizovat nebo přidejte akce na základě požadavků změny tooapplications nebo zatížení.</span><span class="sxs-lookup"><span data-stu-id="091bd-259">Additionally, by implementing all task actions into one task processor, you can readily update or add actions based on changes tooapplications or workload requirements.</span></span> <span data-ttu-id="091bd-260">Ale v některých případech procesor úloh nemusí být hello optimální řešení týkající se vaší implementace jako ji můžete přidat nepotřebné složitost, například při spuštění úlohy, které lze rychle spustit z příkazového řádku jednoduché.</span><span class="sxs-lookup"><span data-stu-id="091bd-260">However, in some cases a task processor might not be hello optimal solution for your implementation as it can add unnecessary complexity, for example when running jobs that can be quickly started from a simple command line.</span></span>

### <a name="create-a-task-processor-using-hello-template"></a><span data-ttu-id="091bd-261">Vytvoření úloh procesor pomocí šablony hello</span><span class="sxs-lookup"><span data-stu-id="091bd-261">Create a Task Processor using hello template</span></span>
<span data-ttu-id="091bd-262">tooadd řešení toohello procesoru úloh, které jste vytvořili dříve, postupujte takto:</span><span class="sxs-lookup"><span data-stu-id="091bd-262">tooadd a task processor toohello solution that you created earlier, follow these steps:</span></span>

1. <span data-ttu-id="091bd-263">Otevřete existující řešení v sadě Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="091bd-263">Open your existing solution in Visual Studio.</span></span>
2. <span data-ttu-id="091bd-264">V Průzkumníku řešení klikněte pravým tlačítkem na řešení hello, klikněte na tlačítko **přidat**a potom klikněte na **nový projekt**.</span><span class="sxs-lookup"><span data-stu-id="091bd-264">In Solution Explorer, right-click hello solution, click **Add**, and then click **New Project**.</span></span>
3. <span data-ttu-id="091bd-265">V části **Visual C#**, klikněte na tlačítko **cloudu**a potom klikněte na **Azure Batch úloh procesoru**.</span><span class="sxs-lookup"><span data-stu-id="091bd-265">Under **Visual C#**, click **Cloud**, and then click **Azure Batch Task Processor**.</span></span>
4. <span data-ttu-id="091bd-266">Zadejte název, který popisuje vaší aplikace a identifikuje tohoto projektu jako hello úloh procesoru (např.) "LitwareTaskProcessor").</span><span class="sxs-lookup"><span data-stu-id="091bd-266">Type a name that describes your application and identifies this project as hello task processor (e.g. "LitwareTaskProcessor").</span></span>
5. <span data-ttu-id="091bd-267">toocreate hello projektu, klikněte na tlačítko **OK**.</span><span class="sxs-lookup"><span data-stu-id="091bd-267">toocreate hello project, click **OK**.</span></span>
6. <span data-ttu-id="091bd-268">Nakonec odkazovaná sestavení hello projektu tooforce Visual Studio tooload všech balíčků NuGet a tooverify, který hello projektu je platná, než začnete, provádění úprav.</span><span class="sxs-lookup"><span data-stu-id="091bd-268">Finally, build hello project tooforce Visual Studio tooload all referenced NuGet packages and tooverify that hello project is valid before you start modifying it.</span></span>

### <a name="task-processor-template-files-and-their-purpose"></a><span data-ttu-id="091bd-269">Soubory šablon procesoru úloh a jejich účel</span><span class="sxs-lookup"><span data-stu-id="091bd-269">Task Processor template files and their purpose</span></span>
<span data-ttu-id="091bd-270">Při vytváření projektu pomocí šablony procesoru úloh hello generuje tři skupiny soubory kódu:</span><span class="sxs-lookup"><span data-stu-id="091bd-270">When you create a project using hello task processor template, it generates three groups of code files:</span></span>

* <span data-ttu-id="091bd-271">hlavní programový soubor Hello (Program.cs).</span><span class="sxs-lookup"><span data-stu-id="091bd-271">hello main program file (Program.cs).</span></span> <span data-ttu-id="091bd-272">Tato položka obsahuje hello program Vstupní bod a nejvyšší úrovně výjimek.</span><span class="sxs-lookup"><span data-stu-id="091bd-272">This contains hello program entry point and top-level exception handling.</span></span> <span data-ttu-id="091bd-273">Neměli byste potřebovat normálně toomodify to.</span><span class="sxs-lookup"><span data-stu-id="091bd-273">You shouldn't normally need toomodify this.</span></span>
* <span data-ttu-id="091bd-274">adresář Framework Hello.</span><span class="sxs-lookup"><span data-stu-id="091bd-274">hello Framework directory.</span></span> <span data-ttu-id="091bd-275">Tato položka obsahuje soubory hello zodpovědná za pracovní, často používaný text"hello provádí program Správce úloh hello – vybalení parametry, přidávání úlohy toohello dávkovou úlohu, atd. Neměli byste potřebovat normálně toomodify tyto soubory.</span><span class="sxs-lookup"><span data-stu-id="091bd-275">This contains hello files responsible for hello 'boilerplate' work done by hello job manager program – unpacking parameters, adding tasks toohello Batch job, etc. You shouldn't normally need toomodify these files.</span></span>
* <span data-ttu-id="091bd-276">procesor soubor úkolů Hello (TaskProcessor.cs).</span><span class="sxs-lookup"><span data-stu-id="091bd-276">hello task processor file (TaskProcessor.cs).</span></span> <span data-ttu-id="091bd-277">Toto je, kam jste umístili logika specifické pro aplikaci pro provádění úlohy (obvykle při volání na existující spustitelný soubor tooan).</span><span class="sxs-lookup"><span data-stu-id="091bd-277">This is where you will put your application-specific logic for executing a task (typically by calling out tooan existing executable).</span></span> <span data-ttu-id="091bd-278">Před a po zpracování kódu, třeba stahování další data nebo nahrávání souborů výsledek také zde bude.</span><span class="sxs-lookup"><span data-stu-id="091bd-278">Pre- and post-processing code, such as downloading additional data or uploading result files, also goes here.</span></span>

<span data-ttu-id="091bd-279">Samozřejmě můžete přidat další soubory jako požadované toosupport kódu procesoru úloh, v závislosti na složitosti hello hello úlohu, rozdělování logiku.</span><span class="sxs-lookup"><span data-stu-id="091bd-279">Of course you can add additional files as required toosupport your task processor code, depending on hello complexity of hello job splitting logic.</span></span>

<span data-ttu-id="091bd-280">Šablona Hello generuje také standardní soubory rozhraní .NET projektu, například souboru .csproj, app.config, souboru packages.config, atd.</span><span class="sxs-lookup"><span data-stu-id="091bd-280">hello template also generates standard .NET project files such as a .csproj file, app.config, packages.config, etc.</span></span>

<span data-ttu-id="091bd-281">Hello zbývající část tohoto oddílu popisuje hello různých souborů a jejich struktura kódu a vysvětluje, jaké jsou jednotlivé třídy.</span><span class="sxs-lookup"><span data-stu-id="091bd-281">hello rest of this section describes hello different files and their code structure, and explains what each class does.</span></span>

![Visual Studio Průzkumníku řešení zobrazující řešení šablony úloh procesoru hello][solution_explorer02]

<span data-ttu-id="091bd-283">**Soubory Framework**</span><span class="sxs-lookup"><span data-stu-id="091bd-283">**Framework files**</span></span>

* <span data-ttu-id="091bd-284">`Configuration.cs`: Zapouzdří hello načítání úlohy konfiguračních dat, jako je například Podrobnosti účtu Batch, přihlašovací údaje účtu propojené úložiště, úlohy a úkolů informace a parametry úlohy.</span><span class="sxs-lookup"><span data-stu-id="091bd-284">`Configuration.cs`: Encapsulates hello loading of job configuration data such as Batch account details, linked storage account credentials, job and task information, and job parameters.</span></span> <span data-ttu-id="091bd-285">Také poskytuje přístup tooBatch definované proměnné prostředí (viz nastavení prostředí pro úkoly v dokumentaci Batch hello) prostřednictvím třídy Configuration.EnvironmentVariable hello.</span><span class="sxs-lookup"><span data-stu-id="091bd-285">It also provides access tooBatch-defined environment variables (see Environment settings for tasks, in hello Batch documentation) via hello Configuration.EnvironmentVariable class.</span></span>
* <span data-ttu-id="091bd-286">`IConfiguration.cs`: Přehledů hello implementace hello třída konfigurace, aby bylo možné jednotkové testování vaší rozdělovače úlohy pomocí falešných nebo imitované konfiguraci objektu.</span><span class="sxs-lookup"><span data-stu-id="091bd-286">`IConfiguration.cs`: Abstracts hello implementation of hello Configuration class, so that you can unit test your job splitter using a fake or mock configuration object.</span></span>
* <span data-ttu-id="091bd-287">`TaskProcessorException.cs`: Představuje chybu, která vyžaduje hello úlohy správce tooterminate.</span><span class="sxs-lookup"><span data-stu-id="091bd-287">`TaskProcessorException.cs`: Represents an error that requires hello job manager tooterminate.</span></span> <span data-ttu-id="091bd-288">TaskProcessorException je použité toowrap 'očekávání, chyby, kde lze zadat konkrétní diagnostické informace jako součást ukončení.</span><span class="sxs-lookup"><span data-stu-id="091bd-288">TaskProcessorException is used toowrap 'expected' errors where specific diagnostic information can be provided as part of termination.</span></span>

<span data-ttu-id="091bd-289">**Úloha procesoru**</span><span class="sxs-lookup"><span data-stu-id="091bd-289">**Task Processor**</span></span>

* <span data-ttu-id="091bd-290">`TaskProcessor.cs`: Spustí úlohu hello.</span><span class="sxs-lookup"><span data-stu-id="091bd-290">`TaskProcessor.cs`: Runs hello task.</span></span> <span data-ttu-id="091bd-291">Hello framework vyvolá metodu TaskProcessor.Run hello.</span><span class="sxs-lookup"><span data-stu-id="091bd-291">hello framework invokes hello TaskProcessor.Run method.</span></span> <span data-ttu-id="091bd-292">Toto je třída hello, kde bude vložit hello specifické pro aplikaci logiky vaše úlohy.</span><span class="sxs-lookup"><span data-stu-id="091bd-292">This is hello class where you will inject hello application-specific logic of your task.</span></span> <span data-ttu-id="091bd-293">Implementujte metodu spustit hello:</span><span class="sxs-lookup"><span data-stu-id="091bd-293">Implement hello Run method to:</span></span>
  * <span data-ttu-id="091bd-294">Analýza a ověření žádné parametry úlohy</span><span class="sxs-lookup"><span data-stu-id="091bd-294">Parse and validate any task parameters</span></span>
  * <span data-ttu-id="091bd-295">Napište hello příkazového řádku pro jakýkoli externí program chcete tooinvoke</span><span class="sxs-lookup"><span data-stu-id="091bd-295">Compose hello command line for any external program you want tooinvoke</span></span>
  * <span data-ttu-id="091bd-296">Přihlaste se další diagnostické informace, které můžete potřebovat pro účely ladění</span><span class="sxs-lookup"><span data-stu-id="091bd-296">Log any diagnostic information you may require for debugging purposes</span></span>
  * <span data-ttu-id="091bd-297">Spustit proces, který používá tento příkazový řádek</span><span class="sxs-lookup"><span data-stu-id="091bd-297">Start a process using that command line</span></span>
  * <span data-ttu-id="091bd-298">Počkejte tooexit proces hello</span><span class="sxs-lookup"><span data-stu-id="091bd-298">Wait for hello process tooexit</span></span>
  * <span data-ttu-id="091bd-299">Zaznamenat hello ukončovací kód procesu toodetermine hello, pokud ji byla úspěšná nebo neúspěšná</span><span class="sxs-lookup"><span data-stu-id="091bd-299">Capture hello exit code of hello process toodetermine if it succeeded or failed</span></span>
  * <span data-ttu-id="091bd-300">Výstupní soubory, které chcete uložit tookeep toopersistent úložiště</span><span class="sxs-lookup"><span data-stu-id="091bd-300">Save any output files you want tookeep toopersistent storage</span></span>

<span data-ttu-id="091bd-301">**Standardní soubory projektu příkazového řádku .NET**</span><span class="sxs-lookup"><span data-stu-id="091bd-301">**Standard .NET command line project files**</span></span>

* <span data-ttu-id="091bd-302">`App.config`: Standardní soubor konfigurace aplikace .NET.</span><span class="sxs-lookup"><span data-stu-id="091bd-302">`App.config`: Standard .NET application configuration file.</span></span>
* <span data-ttu-id="091bd-303">`Packages.config`: Standardní soubor závislost balíčku NuGet.</span><span class="sxs-lookup"><span data-stu-id="091bd-303">`Packages.config`: Standard NuGet package dependency file.</span></span>
* <span data-ttu-id="091bd-304">`Program.cs`: Obsahuje hello program Vstupní bod a nejvyšší úrovně výjimek.</span><span class="sxs-lookup"><span data-stu-id="091bd-304">`Program.cs`: Contains hello program entry point and top-level exception handling.</span></span>

## <a name="implementing-hello-task-processor"></a><span data-ttu-id="091bd-305">Implementace hello úloh procesoru</span><span class="sxs-lookup"><span data-stu-id="091bd-305">Implementing hello task processor</span></span>
<span data-ttu-id="091bd-306">Když otevřete projekt šablony úloh procesoru hello, bude mít hello projektu hello TaskProcessor.cs soubor otevřete ve výchozím nastavení.</span><span class="sxs-lookup"><span data-stu-id="091bd-306">When you open hello Task Processor template project, hello project will have hello TaskProcessor.cs file open by default.</span></span> <span data-ttu-id="091bd-307">Můžete implementovat logiku hello spuštění pro úlohy hello v vaše úlohy pomocí metody Run() hello vidíte níže:</span><span class="sxs-lookup"><span data-stu-id="091bd-307">You can implement hello run logic for hello tasks in your workload by using hello Run() method shown below:</span></span>

```csharp
/// <summary>
/// Runs hello task processing logic. This is where you inject
/// your application-specific logic for decomposing hello job into tasks.
///
/// hello task processor framework invokes hello Run method for you; you need
/// only tooimplement it, not toocall it yourself. Typically, your
/// implementation will execute an external program (from resource files or
/// an application package), check hello exit code of that program and
/// save output files toopersistent storage.
/// </summary>
public async Task<int> Run()

{
    try
    {
        //Your code for hello task processor goes here.
        var command = $"compare {_parameters["Frame1"]} {_parameters["Frame2"]} compare.gif";
        using (var process = Process.Start($"cmd /c {command}"))
        {
            process.WaitForExit();
            var taskOutputStorage = new TaskOutputStorage(
            _configuration.StorageAccount,
            _configuration.JobId,
            _configuration.TaskId
            );
            await taskOutputStorage.SaveAsync(
            TaskOutputKind.TaskOutput,
            @"..\stdout.txt",
            @"stdout.txt"
            );
            return process.ExitCode;
        }
    }
    catch (Exception ex)
    {
        throw new TaskProcessorException(
        $"{ex.GetType().Name} exception in run task processor: {ex.Message}",
        ex
        );
    }
}
```
> [!NOTE]
> <span data-ttu-id="091bd-308">Hello poznámkou část v hello metodu Run() se hello pouze část hello procesoru úloh šablony kód, který je určený pro toomodify můžete přidáním hello spustit logiku pro úlohy hello vaše úlohy.</span><span class="sxs-lookup"><span data-stu-id="091bd-308">hello annotated section in hello Run() method is hello only section of hello Task Processor template code that is intended for you toomodify by adding hello run logic for hello tasks in your workload.</span></span> <span data-ttu-id="091bd-309">Pokud chcete toomodify různé části hello šablony, prosím nejdřív Seznamte se s fungování Batch přečtení dokumentace hello Batch a vyzkoušení několik ukázek kódu služby Batch hello.</span><span class="sxs-lookup"><span data-stu-id="091bd-309">If you want toomodify a different section of hello template, please first familiarize yourself with how Batch works by reviewing hello Batch documentation and trying out a few of hello Batch code samples.</span></span>
> 
> 

<span data-ttu-id="091bd-310">Hello metodu Run() je zodpovědná za spuštění hello příkazového řádku, od jednoho nebo více procesů, čekání na všechny toocomplete procesu, ukládání hello výsledky a nakonec vrácení s ukončovacím kódem.</span><span class="sxs-lookup"><span data-stu-id="091bd-310">hello Run() method is responsible for launching hello command line, starting one or more processes, waiting for all process toocomplete, saving hello results, and finally returning with an exit code.</span></span> <span data-ttu-id="091bd-311">Hello metodu Run() je, kde budete implementovat hello zpracování logiku pro vaše úkoly.</span><span class="sxs-lookup"><span data-stu-id="091bd-311">hello Run() method is where you implement hello processing logic for your tasks.</span></span> <span data-ttu-id="091bd-312">Hello úloh procesoru framework vyvolá metodu Run() hello vám; není nutné toocall ho sami.</span><span class="sxs-lookup"><span data-stu-id="091bd-312">hello task processor framework invokes hello Run() method for you; you do not need toocall it yourself.</span></span>

<span data-ttu-id="091bd-313">Implementace Run() má přístup k:</span><span class="sxs-lookup"><span data-stu-id="091bd-313">Your Run() implementation has access to:</span></span>

* <span data-ttu-id="091bd-314">Parametry úlohy prostřednictvím hello Hello `_parameters` pole.</span><span class="sxs-lookup"><span data-stu-id="091bd-314">hello task parameters, via hello `_parameters` field.</span></span>
* <span data-ttu-id="091bd-315">ID úlohy a úkolů, prostřednictvím hello Hello `_jobId` a `_taskId` pole.</span><span class="sxs-lookup"><span data-stu-id="091bd-315">hello job and task ids, via hello `_jobId` and `_taskId` fields.</span></span>
* <span data-ttu-id="091bd-316">konfigurace úlohy Hello, prostřednictvím hello `_configuration` pole.</span><span class="sxs-lookup"><span data-stu-id="091bd-316">hello task configuration, via hello `_configuration` field.</span></span>

<span data-ttu-id="091bd-317">**Selhání úlohy**</span><span class="sxs-lookup"><span data-stu-id="091bd-317">**Task failure**</span></span>

<span data-ttu-id="091bd-318">V případě selhání můžete k ukončení metodu Run() hello došlo k výjimce, ale zůstane obslužná rutina výjimky nejvyšší úrovně hello kontrolu nad hello úloh ukončovací kód.</span><span class="sxs-lookup"><span data-stu-id="091bd-318">In case of failure, you can exit hello Run() method by throwing an exception, but this leaves hello top level exception handler in control of hello task exit code.</span></span> <span data-ttu-id="091bd-319">Pokud potřebujete toocontrol hello ukončovací kód, aby mohl rozlišit různé typy selhání, například k diagnostickým účelům nebo protože některé selhání režimy musí ukončit hello úlohy a další neměli a pak musí ukončit metodu Run() hello vrácením nenulový ukončovací kód.</span><span class="sxs-lookup"><span data-stu-id="091bd-319">If you need toocontrol hello exit code so that you can distinguish different types of failure, for example for diagnostic purposes or because some failure modes should terminate hello job and others should not, then you should exit hello Run() method by returning a non-zero exit code.</span></span> <span data-ttu-id="091bd-320">To se stane hello úloh ukončovací kód.</span><span class="sxs-lookup"><span data-stu-id="091bd-320">This becomes hello task exit code.</span></span>

### <a name="exit-codes-and-exceptions-in-hello-task-processor-template"></a><span data-ttu-id="091bd-321">Ukončete kódy a výjimky v šabloně úlohy procesoru hello</span><span class="sxs-lookup"><span data-stu-id="091bd-321">Exit codes and exceptions in hello Task Processor template</span></span>
<span data-ttu-id="091bd-322">Kódy ukončení a výjimky zadejte mechanismus toodetermine hello výsledek spuštění programu, a můžou pomoct zjistit případné problémy s hello spuštění programu hello.</span><span class="sxs-lookup"><span data-stu-id="091bd-322">Exit codes and exceptions provide a mechanism toodetermine hello outcome of running a program, and they can help identify any problems with hello execution of hello program.</span></span> <span data-ttu-id="091bd-323">šablony úloh procesoru Hello implementuje hello ukončovacích kódů a výjimek popsaných v této části.</span><span class="sxs-lookup"><span data-stu-id="091bd-323">hello Task Processor template implements hello exit codes and exceptions described in this section.</span></span>

<span data-ttu-id="091bd-324">Úloha procesoru úloh, která je implementována pomocí šablony úloh procesoru hello vrátit tři možné ukončovací kód:</span><span class="sxs-lookup"><span data-stu-id="091bd-324">A task processor task that is implemented with hello Task Processor template can return three possible exit codes:</span></span>

| <span data-ttu-id="091bd-325">Kód</span><span class="sxs-lookup"><span data-stu-id="091bd-325">Code</span></span> | <span data-ttu-id="091bd-326">Popis</span><span class="sxs-lookup"><span data-stu-id="091bd-326">Description</span></span> |
| --- | --- |
| <span data-ttu-id="091bd-327">[Process.ExitCode][process_exitcode]</span><span class="sxs-lookup"><span data-stu-id="091bd-327">[Process.ExitCode][process_exitcode]</span></span> |<span data-ttu-id="091bd-328">procesor úloh Hello spustili toocompletion.</span><span class="sxs-lookup"><span data-stu-id="091bd-328">hello task processor ran toocompletion.</span></span> <span data-ttu-id="091bd-329">Všimněte si, že to neznamená, že tento program hello, vyvolaná proběhla úspěšně – tento hello úloh procesor úspěšně volat a provést jakékoli po zpracování bez výjimek.</span><span class="sxs-lookup"><span data-stu-id="091bd-329">Note that this does not imply that hello program you invoked was successful – only that hello task processor invoked it successfully and performed any post-processing without exceptions.</span></span> <span data-ttu-id="091bd-330">Hello význam hello ukončovací kód závisí na programu hello vyvolat – obvykle ukončovací kód 0 znamená programu hello úspěšná a znamená jiných ukončovací kód programu hello se nezdařilo.</span><span class="sxs-lookup"><span data-stu-id="091bd-330">hello meaning of hello exit code depends on hello invoked program – typically exit code 0 means hello program succeeded and any other exit code means hello program failed.</span></span> |
| <span data-ttu-id="091bd-331">1</span><span class="sxs-lookup"><span data-stu-id="091bd-331">1</span></span> |<span data-ttu-id="091bd-332">Hello úloh procesoru se nezdařilo s výjimkou v 'očekávané' součást programu hello.</span><span class="sxs-lookup"><span data-stu-id="091bd-332">hello task processor failed with an exception in an 'expected' part of hello program.</span></span> <span data-ttu-id="091bd-333">Hello se výjimka přeložený tooa `TaskProcessorException` s diagnostické informace a, kde je to možné, návrhy na řešení hello selhání.</span><span class="sxs-lookup"><span data-stu-id="091bd-333">hello exception was translated tooa `TaskProcessorException` with diagnostic information and, where possible, suggestions for resolving hello failure.</span></span> |
| <span data-ttu-id="091bd-334">2</span><span class="sxs-lookup"><span data-stu-id="091bd-334">2</span></span> |<span data-ttu-id="091bd-335">Hello úloh procesoru se nezdařilo s 'neočekávané' výjimky.</span><span class="sxs-lookup"><span data-stu-id="091bd-335">hello task processor failed with an 'unexpected' exception.</span></span> <span data-ttu-id="091bd-336">Hello výjimka zaznamenané toostandard výstup, ale hello úloh procesor byl nelze tooadd jakékoli další diagnostiky nebo nápravnou informace.</span><span class="sxs-lookup"><span data-stu-id="091bd-336">hello exception was logged toostandard output, but hello task processor was unable tooadd any additional diagnostic or remediation information.</span></span> |

> [!NOTE]
> <span data-ttu-id="091bd-337">Pokud program hello vyvolání používá ukončovací kódy 1 a 2 tooindicate konkrétní chyby režimy, pak pomocí ukončovací kód 1 a 2 pro procesoru chybám úloh je nejednoznačný.</span><span class="sxs-lookup"><span data-stu-id="091bd-337">If hello program you invoke uses exit codes 1 and 2 tooindicate specific failure modes, then using exit codes 1 and 2 for task processor errors is ambiguous.</span></span> <span data-ttu-id="091bd-338">Tyto úlohy procesoru kódy toodistinctive ukončovací kódy chyb můžete změnit úpravou hello případů výjimka v souboru Program.cs hello.</span><span class="sxs-lookup"><span data-stu-id="091bd-338">You can change these task processor error codes toodistinctive exit codes by editing hello exception cases in hello Program.cs file.</span></span>
> 
> 

<span data-ttu-id="091bd-339">Všechny informace hello vrácený výjimky jsou zapsány do stdout.txt a stderr.txt souborů.</span><span class="sxs-lookup"><span data-stu-id="091bd-339">All hello information returned by exceptions is written into stdout.txt and stderr.txt files.</span></span> <span data-ttu-id="091bd-340">Další informace najdete v tématu zpracování chyb, v hello Batch dokumentaci.</span><span class="sxs-lookup"><span data-stu-id="091bd-340">For more information, see Error Handling, in hello Batch documentation.</span></span>

### <a name="client-considerations"></a><span data-ttu-id="091bd-341">Důležité informace o klientech</span><span class="sxs-lookup"><span data-stu-id="091bd-341">Client considerations</span></span>
<span data-ttu-id="091bd-342">**Přihlašovací údaje úložiště**</span><span class="sxs-lookup"><span data-stu-id="091bd-342">**Storage credentials**</span></span>

<span data-ttu-id="091bd-343">Pokud procesor úloh používá výstupy toopersist úložiště objektů blob v Azure, například pomocí hello souboru konvence pomocné knihovny, pak potřebuje přístup příliš*buď* hello přihlašovacích údajů účtu úložiště cloudu *nebo* adresu URL kontejneru objektů blob, která zahrnuje sdílený přístupový podpis (SAS).</span><span class="sxs-lookup"><span data-stu-id="091bd-343">If your task processor uses Azure blob storage toopersist outputs, for example using hello file conventions helper library, then it needs access too*either* hello cloud storage account credentials *or* a blob container URL that includes a shared access signature (SAS).</span></span> <span data-ttu-id="091bd-344">Šablona Hello zahrnuje podporu poskytování pověření prostřednictvím společné proměnné prostředí.</span><span class="sxs-lookup"><span data-stu-id="091bd-344">hello template includes support for providing credentials via common environment variables.</span></span> <span data-ttu-id="091bd-345">Váš klient může předat hello přihlašovacích údajů úložiště následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="091bd-345">Your client can pass hello storage credentials as follows:</span></span>

```csharp
job.CommonEnvironmentSettings = new [] {
    new EnvironmentSetting("LINKED_STORAGE_ACCOUNT", "{storageAccountName}"),
    new EnvironmentSetting("LINKED_STORAGE_KEY", "{storageAccountKey}"),
};
```

<span data-ttu-id="091bd-346">účet úložiště Hello je pak k dispozici v hello TaskProcessor třída prostřednictvím hello `_configuration.StorageAccount` vlastnost.</span><span class="sxs-lookup"><span data-stu-id="091bd-346">hello storage account is then available in hello TaskProcessor class via hello `_configuration.StorageAccount` property.</span></span>

<span data-ttu-id="091bd-347">Pokud dáváte přednost toouse URL adresa kontejneru s tokenem SAS, můžete to taky předat prostřednictvím nastavení prostředí běžné úlohy, ale hello úloh procesoru šablona neobsahuje aktuálně integrovanou podporu pro tento.</span><span class="sxs-lookup"><span data-stu-id="091bd-347">If you prefer toouse a container URL with SAS, you can also pass this via an job common environment setting, but hello task processor template does not currently include built-in support for this.</span></span>

<span data-ttu-id="091bd-348">**Instalační program úložiště**</span><span class="sxs-lookup"><span data-stu-id="091bd-348">**Storage setup**</span></span>

<span data-ttu-id="091bd-349">Doporučuje se, že hello klienta nebo úloha úkol Správce úloh vytvořit žádné kontejnery požadované úlohami před přidáním hello úlohy toohello úlohy.</span><span class="sxs-lookup"><span data-stu-id="091bd-349">It is recommended that hello client or job manager task create any containers required by tasks before adding hello tasks toohello job.</span></span> <span data-ttu-id="091bd-350">Toto je povinné, že pokud použijete adresu URL kontejneru s tokenem SAS, jako například adresu URL nezahrnuje oprávnění toocreate hello kontejneru.</span><span class="sxs-lookup"><span data-stu-id="091bd-350">This is mandatory if you use a container URL with SAS, as such a URL does not include permission toocreate hello container.</span></span> <span data-ttu-id="091bd-351">I v případě, že předáváte přihlašovacích údajů účtu úložiště, doporučujeme jako ukládá každý úkol s toocall CloudBlobContainer.CreateIfNotExistsAsync na kontejneru hello.</span><span class="sxs-lookup"><span data-stu-id="091bd-351">It is recommended even if you pass storage account credentials, as it saves every task having toocall CloudBlobContainer.CreateIfNotExistsAsync on hello container.</span></span>

## <a name="pass-parameters-and-environment-variables"></a><span data-ttu-id="091bd-352">Předávání parametrů a proměnných prostředí</span><span class="sxs-lookup"><span data-stu-id="091bd-352">Pass parameters and environment variables</span></span>
### <a name="pass-environment-settings"></a><span data-ttu-id="091bd-353">Předat nastavení prostředí</span><span class="sxs-lookup"><span data-stu-id="091bd-353">Pass environment settings</span></span>
<span data-ttu-id="091bd-354">Klienta můžete předat informace toohello úkolu Správce úloh v podobě hello nastavení prostředí.</span><span class="sxs-lookup"><span data-stu-id="091bd-354">A client can pass information toohello job manager task in hello form of environment settings.</span></span> <span data-ttu-id="091bd-355">Tyto informace pak může být použit hello úkol správce při generování hello úloh procesoru úlohy, které se spustí jako součást hello výpočetní úlohy.</span><span class="sxs-lookup"><span data-stu-id="091bd-355">This information can then be used by hello job manager task when generating hello task processor tasks that will run as part of hello compute job.</span></span> <span data-ttu-id="091bd-356">Příklady hello informace, které můžete předat jako nastavení prostředí:</span><span class="sxs-lookup"><span data-stu-id="091bd-356">Examples of hello information that you can pass as environment settings are:</span></span>

* <span data-ttu-id="091bd-357">Klíče pro účet a název účtu úložiště</span><span class="sxs-lookup"><span data-stu-id="091bd-357">Storage account name and account keys</span></span>
* <span data-ttu-id="091bd-358">Adresa URL účtu batch</span><span class="sxs-lookup"><span data-stu-id="091bd-358">Batch account URL</span></span>
* <span data-ttu-id="091bd-359">Klíč účtu batch</span><span class="sxs-lookup"><span data-stu-id="091bd-359">Batch account key</span></span>

<span data-ttu-id="091bd-360">Hello služba Batch má jednoduché mechanismus toopass prostředí nastavení tooa úkol správce pomocí hello `EnvironmentSettings` vlastnost [Microsoft.Azure.Batch.JobManagerTask][net_jobmanagertask].</span><span class="sxs-lookup"><span data-stu-id="091bd-360">hello Batch service has a simple mechanism toopass environment settings tooa job manager task by using hello `EnvironmentSettings` property in [Microsoft.Azure.Batch.JobManagerTask][net_jobmanagertask].</span></span>

<span data-ttu-id="091bd-361">Například tooget hello `BatchClient` instance pro účet Batch můžete předat jako proměnné prostředí z klienta hello kód hello adresy URL a sdíleného klíče přihlašovací údaje pro účet Batch hello.</span><span class="sxs-lookup"><span data-stu-id="091bd-361">For example, tooget hello `BatchClient` instance for a Batch account, you can pass as environment variables from hello client code hello URL and shared key credentials for hello Batch account.</span></span> <span data-ttu-id="091bd-362">Podobně tooaccess hello úložiště účtu, který je propojený účet Batch toohello, můžete předat hello název účtu úložiště a klíč účtu úložiště hello jako proměnné prostředí.</span><span class="sxs-lookup"><span data-stu-id="091bd-362">Likewise, tooaccess hello storage account that is linked toohello Batch account, you can pass hello storage account name and hello storage account key as environment variables.</span></span>

### <a name="pass-parameters-toohello-job-manager-template"></a><span data-ttu-id="091bd-363">Předávání parametrů toohello Správce úloh šablony</span><span class="sxs-lookup"><span data-stu-id="091bd-363">Pass parameters toohello Job Manager template</span></span>
<span data-ttu-id="091bd-364">V mnoha případech je užitečné toopass na úlohu parametry toohello úkolu Správce úloh, buď úlohu hello toocontrol rozdělení procesu nebo hello tooconfigure hello úlohy pro úlohu.</span><span class="sxs-lookup"><span data-stu-id="091bd-364">In many cases, it's useful toopass per-job parameters toohello job manager task, either toocontrol hello job splitting process or tooconfigure hello tasks for hello job.</span></span> <span data-ttu-id="091bd-365">To provedete tím, že nahrajete soubor JSON s názvem parameters.JSON tímto kódem jako soubor prostředků pro hello úkolu Správce úloh.</span><span class="sxs-lookup"><span data-stu-id="091bd-365">You can do this by uploading a JSON file named parameters.json as a resource file for hello job manager task.</span></span> <span data-ttu-id="091bd-366">Parametry Hello se pak můžou stát k dispozici v hello `JobSplitter._parameters` pole v šabloně hello Správce úloh.</span><span class="sxs-lookup"><span data-stu-id="091bd-366">hello parameters can then become available in hello `JobSplitter._parameters` field in hello Job Manager template.</span></span>

> [!NOTE]
> <span data-ttu-id="091bd-367">Obslužná rutina předdefinované parametru Hello podporuje pouze slovník řetězec řetězec.</span><span class="sxs-lookup"><span data-stu-id="091bd-367">hello built-in parameter handler supports only string-to-string dictionaries.</span></span> <span data-ttu-id="091bd-368">Pokud chcete toopass komplexní JSON hodnoty jako hodnoty parametrů, bude nutné toopass jako řetězce a analyzovat je ve hello úlohy rozdělovače ani upravovat hello framework `Configuration.GetJobParameters` metoda.</span><span class="sxs-lookup"><span data-stu-id="091bd-368">If you want toopass complex JSON values as parameter values, you will need toopass these as strings and parse them in hello job splitter, or modify hello framework's `Configuration.GetJobParameters` method.</span></span>
> 
> 

### <a name="pass-parameters-toohello-task-processor-template"></a><span data-ttu-id="091bd-369">Předávání parametrů toohello procesoru úloh šablony</span><span class="sxs-lookup"><span data-stu-id="091bd-369">Pass parameters toohello Task Processor template</span></span>
<span data-ttu-id="091bd-370">Můžete také předat parametry úlohy tooindividual implementovaná pomocí šablony úloh procesoru hello.</span><span class="sxs-lookup"><span data-stu-id="091bd-370">You can also pass parameters tooindividual tasks implemented using hello Task Processor template.</span></span> <span data-ttu-id="091bd-371">Stejně jako s hello šablonu Správce úloh, hello úloh procesoru šablona hledá soubor prostředků s názvem</span><span class="sxs-lookup"><span data-stu-id="091bd-371">Just as with hello job manager template, hello task processor template looks for a resource file named</span></span>

<span data-ttu-id="091bd-372">Parameters.JSON tímto kódem a pokud zjistila, že ho načte jako slovník parametrů hello.</span><span class="sxs-lookup"><span data-stu-id="091bd-372">parameters.json, and if found it loads it as hello parameters dictionary.</span></span> <span data-ttu-id="091bd-373">Existuje několik možností pro jak toopass parametry toohello procesoru úkoly úloh:</span><span class="sxs-lookup"><span data-stu-id="091bd-373">There are a couple of options for how toopass parameters toohello task processor tasks:</span></span>

* <span data-ttu-id="091bd-374">Znovu použít parametry úlohy hello JSON.</span><span class="sxs-lookup"><span data-stu-id="091bd-374">Reuse hello job parameters JSON.</span></span> <span data-ttu-id="091bd-375">Tento postup funguje dobře v případě, že jsou jenom parametry hello ty úlohy celou (pro příklad, vykreslení výška a šířka).</span><span class="sxs-lookup"><span data-stu-id="091bd-375">This works well if hello only parameters are job-wide ones (for example, a render height and width).</span></span> <span data-ttu-id="091bd-376">toodo, při vytváření CloudTask v hello úlohy rozdělovače, přidání objektu odkaz toohello Parameters.JSON tímto kódem prostředků souboru z hello úkolu Správce úloh je ResourceFiles (`JobSplitter._jobManagerTask.ResourceFiles`) kolekce ResourceFiles toohello CloudTask.</span><span class="sxs-lookup"><span data-stu-id="091bd-376">toodo this, when creating a CloudTask in hello job splitter, add a reference toohello parameters.json resource file object from hello job manager task's ResourceFiles (`JobSplitter._jobManagerTask.ResourceFiles`) toohello CloudTask's ResourceFiles collection.</span></span>
* <span data-ttu-id="091bd-377">Generování a nahrávání dokumentu Parameters.JSON tímto kódem specifických úkolů při provádění úlohy rozdělovače a odkazovat na tento objekt blob v kolekci souborů prostředků hello úloh.</span><span class="sxs-lookup"><span data-stu-id="091bd-377">Generate and upload a task-specific parameters.json document as part of job splitter execution, and reference that blob in hello task's resource files collection.</span></span> <span data-ttu-id="091bd-378">To je nezbytné, pokud jiné úlohy s odlišnými parametry.</span><span class="sxs-lookup"><span data-stu-id="091bd-378">This is necessary if different tasks have different parameters.</span></span> <span data-ttu-id="091bd-379">Příkladem může být 3D vykreslování scénář, kde je index rámečku hello předán toohello úloh jako parametr.</span><span class="sxs-lookup"><span data-stu-id="091bd-379">An example might be a 3D rendering scenario where hello frame index is passed toohello task as a parameter.</span></span>

> [!NOTE]
> <span data-ttu-id="091bd-380">Obslužná rutina předdefinované parametru Hello podporuje pouze slovník řetězec řetězec.</span><span class="sxs-lookup"><span data-stu-id="091bd-380">hello built-in parameter handler supports only string-to-string dictionaries.</span></span> <span data-ttu-id="091bd-381">Pokud chcete toopass komplexní JSON hodnoty jako hodnoty parametrů, bude nutné toopass jako řetězce a analyzovat je procesor úloh hello ani upravovat hello framework `Configuration.GetTaskParameters` metoda.</span><span class="sxs-lookup"><span data-stu-id="091bd-381">If you want toopass complex JSON values as parameter values, you will need toopass these as strings and parse them in hello task processor, or modify hello framework's `Configuration.GetTaskParameters` method.</span></span>
> 
> 

## <a name="next-steps"></a><span data-ttu-id="091bd-382">Další kroky</span><span class="sxs-lookup"><span data-stu-id="091bd-382">Next steps</span></span>
### <a name="persist-job-and-task-output-tooazure-storage"></a><span data-ttu-id="091bd-383">Zachovat úlohy a úkolů tooAzure výstup úložiště</span><span class="sxs-lookup"><span data-stu-id="091bd-383">Persist job and task output tooAzure Storage</span></span>
<span data-ttu-id="091bd-384">Další užitečné nástroje při vývoji řešení Batch je [Azure Batch souboru konvence][nuget_package].</span><span class="sxs-lookup"><span data-stu-id="091bd-384">Another helpful tool in Batch solution development is [Azure Batch File Conventions][nuget_package].</span></span> <span data-ttu-id="091bd-385">Pomocí této knihovně tříd rozhraní .NET (momentálně ve verzi preview) v úložišti tooeasily aplikací Batch .NET a načíst tooand výstupy úlohy ze služby Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="091bd-385">Use this .NET class library (currently in preview) in your Batch .NET applications tooeasily store and retrieve task outputs tooand from Azure Storage.</span></span> <span data-ttu-id="091bd-386">[Zachovat výstup úlohy a úlohy Azure Batch](batch-task-output.md) obsahuje úplnou diskusi hello knihovně a jeho použití.</span><span class="sxs-lookup"><span data-stu-id="091bd-386">[Persist Azure Batch job and task output](batch-task-output.md) contains a full discussion of hello library and its usage.</span></span>

### <a name="batch-forum"></a><span data-ttu-id="091bd-387">Fórum batch</span><span class="sxs-lookup"><span data-stu-id="091bd-387">Batch Forum</span></span>
<span data-ttu-id="091bd-388">Hello [fóru služby Azure Batch] [ forum] na webu MSDN je skvělá umístit toodiscuss Batch a klást otázky týkající se služby hello.</span><span class="sxs-lookup"><span data-stu-id="091bd-388">hello [Azure Batch Forum][forum] on MSDN is a great place toodiscuss Batch and ask questions about hello service.</span></span> <span data-ttu-id="091bd-389">HEAD na přes pro užitečné "rychlé" příspěvky a při jejich vzniku při sestavování řešení Batch zveřejněte svoje otázky.</span><span class="sxs-lookup"><span data-stu-id="091bd-389">Head on over for helpful "sticky" posts, and post your questions as they arise while you build your Batch solutions.</span></span>

[forum]: https://social.msdn.microsoft.com/forums/azure/en-US/home?forum=azurebatch
[net_jobmanagertask]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.jobmanagertask.aspx
[github_samples]: https://github.com/Azure/azure-batch-samples
[nuget_package]: https://www.nuget.org/packages/Microsoft.Azure.Batch.Conventions.Files
[process_exitcode]: https://msdn.microsoft.com/library/system.diagnostics.process.exitcode.aspx
[vs_gallery]: https://visualstudiogallery.msdn.microsoft.com/
[vs_gallery_templates]: https://go.microsoft.com/fwlink/?linkid=820714
[vs_find_use_ext]: https://msdn.microsoft.com/library/dd293638.aspx

[diagram01]: ./media/batch-visual-studio-templates/diagram01.png
[solution_explorer01]: ./media/batch-visual-studio-templates/solution_explorer01.png
[solution_explorer02]: ./media/batch-visual-studio-templates/solution_explorer02.png
