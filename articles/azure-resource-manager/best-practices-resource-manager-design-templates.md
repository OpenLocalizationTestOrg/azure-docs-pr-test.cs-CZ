---
title: "Návrh šablony Azure pro komplexní řešení | Microsoft Docs"
description: "Ukazuje osvědčené postupy pro navrhování šablon Azure Resource Manageru pro komplexní scénáře"
services: azure-resource-manager
documentationcenter: 
author: tfitzmac
manager: timlt
editor: tysonn
ms.assetid: ce1141d6-ece7-4976-acea-1db1f775409e
ms.service: azure-resource-manager
ms.workload: multiple
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 12/19/2016
ms.author: tomfitz
ms.openlocfilehash: dcc31f7a8c85a8f7fbd554371a66fb1e348bca17
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/03/2017
---
# <a name="design-patterns-for-azure-resource-manager-templates-when-deploying-complex-solutions"></a><span data-ttu-id="2a7e4-103">Vzory návrhu pro šablony Azure Resource Manager při nasazení komplexní řešení</span><span class="sxs-lookup"><span data-stu-id="2a7e4-103">Design patterns for Azure Resource Manager templates when deploying complex solutions</span></span>
<span data-ttu-id="2a7e4-104">Pomocí flexibilní přístup na základě šablon Azure Resource Manager, můžete nasadit komplexních topologiích rychle a konzistentně.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-104">Using a flexible approach based on Azure Resource Manager templates, you can deploy complex topologies quickly and consistently.</span></span> <span data-ttu-id="2a7e4-105">Můžete přizpůsobit tato nasazení snadno jako základní nabídky momentální nebo aby bylo možné ošetřit varianty pro scénáře outlier nebo zákazníků.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-105">You can adapt these deployments easily as core offerings evolve or to accommodate variants for outlier scenarios or customers.</span></span>

<span data-ttu-id="2a7e4-106">Toto téma je součástí větší dokument White Paper.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-106">This topic is part of a larger whitepaper.</span></span> <span data-ttu-id="2a7e4-107">Číst úplnou dokumentu, stáhněte si [World – třída Azure Resource Manager šablony požadavky a osvědčené postupy](http://download.microsoft.com/download/8/E/1/8E1DBEFA-CECE-4DC9-A813-93520A5D7CFE/World Class ARM Templates - Considerations and Proven Practices.pdf).</span><span class="sxs-lookup"><span data-stu-id="2a7e4-107">To read the full paper, download [World Class Azure Resource Manager Templates Considerations and Proven Practices](http://download.microsoft.com/download/8/E/1/8E1DBEFA-CECE-4DC9-A813-93520A5D7CFE/World Class ARM Templates - Considerations and Proven Practices.pdf).</span></span>

<span data-ttu-id="2a7e4-108">Šablony kombinovat výhody z základní Azure Resource Manager s přizpůsobivost a čitelnost z JSON JavaScript Object Notation ().</span><span class="sxs-lookup"><span data-stu-id="2a7e4-108">Templates combine the benefits of the underlying Azure Resource Manager with the adaptability and readability of JavaScript Object Notation (JSON).</span></span> <span data-ttu-id="2a7e4-109">Pomocí šablony, můžete:</span><span class="sxs-lookup"><span data-stu-id="2a7e4-109">Using templates, you can:</span></span>

* <span data-ttu-id="2a7e4-110">Topologie a jejich úloh nasaďte konzistentně.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-110">Deploy topologies and their workloads consistently.</span></span>
* <span data-ttu-id="2a7e4-111">Spravovat všechny prostředky v aplikaci společně použití skupin prostředků.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-111">Manage all your resources in an application together using resource groups.</span></span>
* <span data-ttu-id="2a7e4-112">Použití řízení přístupu na základě role (RBAC) k udělení přístupu příslušné uživatelům, skupinám a službám.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-112">Apply role-based access control (RBAC) to grant appropriate access to users, groups, and services.</span></span>
* <span data-ttu-id="2a7e4-113">Použijte označování přidružení ke zjednodušení úlohy, jako je fakturace souhrny.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-113">Use tagging associations to streamline tasks such as billing rollups.</span></span>

<span data-ttu-id="2a7e4-114">Tento článek poskytuje podrobné informace o spotřebě scénáře, architekturu a vzory implementace identifikované při našich relace návrhu a implementace reálného šablony u zákazníků Azure poradní tým (AzureCAT).</span><span class="sxs-lookup"><span data-stu-id="2a7e4-114">This article provides details on consumption scenarios, architecture, and implementation patterns identified during our design sessions and real-world template implementations with Azure Customer Advisory Team (AzureCAT) customers.</span></span> <span data-ttu-id="2a7e4-115">Daleko od academic, jsou tyto přístupy osvědčené postupy o tom informováni prostřednictvím vývoj šablon pro 12 technologií horní operačních systémů se systémem Linux, včetně: Apache Kafka, Apache Spark, Cloudera, Couchbase, Hortonworks HDP, Enterprise DataStax používá technologii Apache Cassandra, Elasticsearch, volaných, MongoDB, PostgreSQL, Redis a Nagios.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-115">Far from academic, these approaches are proven practices informed by the development of templates for 12 of the top Linux-based OSS technologies, including: Apache Kafka, Apache Spark, Cloudera, Couchbase, Hortonworks HDP, DataStax Enterprise powered by Apache Cassandra, Elasticsearch, Jenkins, MongoDB, PostgreSQL, Redis, and Nagios.</span></span> 

<span data-ttu-id="2a7e4-116">Tento článek sdílí tyto osvědčené postupy při architektury šablony Azure Resource Manager třídy world.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-116">This article shares these proven practices to help you architect world class Azure Resource Manager templates.</span></span>  

<span data-ttu-id="2a7e4-117">V našem práce se zákazníky jsme určili několik možnosti spotřeby šablony správce prostředků mezi podniky, s systémových Integrátorech (SI) a sdílené svazky clusteru.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-117">In our work with customers, we have identified several Resource Manager template consumption experiences across enterprises, System Integrators (SI)s, and CSVs.</span></span> <span data-ttu-id="2a7e4-118">Následující části obsahují základní přehled běžné scénáře a vzory pro typy různých zákazníků.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-118">The following sections provide a high-level overview of common scenarios and patterns for different customer types.</span></span>

## <a name="enterprises-and-system-integrators"></a><span data-ttu-id="2a7e4-119">Podniky a integrátory systémů</span><span class="sxs-lookup"><span data-stu-id="2a7e4-119">Enterprises and system integrators</span></span>
<span data-ttu-id="2a7e4-120">Ve velkých organizacích, vidíme běžně dvě příjemci šablony Resource Manageru: vnitřní softwaru vývojové týmy a podnikové IT.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-120">Within large organizations, we commonly see two consumers of Resource Manager templates: internal software development teams and corporate IT.</span></span> <span data-ttu-id="2a7e4-121">Jsme zjistili, scénáře pro mapu SIs scénáře pro firmy, abyste použít stejné aspekty.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-121">We've found that the scenarios for the SIs map to the scenarios for Enterprises, so the same considerations apply.</span></span>

### <a name="internal-software-development-teams"></a><span data-ttu-id="2a7e4-122">Interní softwaru vývojové týmy</span><span class="sxs-lookup"><span data-stu-id="2a7e4-122">Internal software development teams</span></span>
<span data-ttu-id="2a7e4-123">Pokud váš tým sama vyvinula softwaru pro podporu vaší firmě, šablony poskytují snadný způsob, jak rychle nasadit technologie pro použití v řešeních pro specifické pro firmy.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-123">If your team develops software to support your business, templates provide an easy way to quickly deploy technologies for use in business-specific solutions.</span></span> <span data-ttu-id="2a7e4-124">Můžete také použít šablony rychle vytvořit školení prostředí, které umožňují členové týmu pro získání dovednosti nezbytné.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-124">You can also use templates to rapidly create training environments that enable team members to gain necessary skills.</span></span>

<span data-ttu-id="2a7e4-125">Můžete použít šablony jako-je rozšířit nebo tvoří jejich přizpůsobí vašim potřebám.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-125">You can use templates as-is or extend or compose them to accommodate your needs.</span></span> <span data-ttu-id="2a7e4-126">Pomocí označování šablony, můžete poskytnout fakturace souhrn různých zobrazení, například jako tým, projektu, jednotlivé a vzdělávání.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-126">Using tagging within templates, you can provide a billing summary with various views such as team, project, individual, and education.</span></span>

<span data-ttu-id="2a7e4-127">Podniky mají často softwaru vývojové týmy k vytvoření šablony pro konzistentní nasazení řešení.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-127">Businesses often want software development teams to create a template for consistent deployment of a solution.</span></span> <span data-ttu-id="2a7e4-128">Šablona usnadňuje omezení tak, aby některé položky v rámci prostředí pevná a nelze přepsat.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-128">The template facilitates constraints so certain items within that environment remain fixed and can't be overridden.</span></span> <span data-ttu-id="2a7e4-129">Banka může například vyžadovat šablonu, která má obsahovat RBAC tak programátorem nelze zkontrolovat, jestli řešení bankovní k odesílání dat do účtu osobní úložiště.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-129">For example, a bank might require a template to include RBAC so a programmer can’t revise a banking solution to send data to a personal storage account.</span></span>

### <a name="corporate-it"></a><span data-ttu-id="2a7e4-130">Podnikové IT</span><span class="sxs-lookup"><span data-stu-id="2a7e4-130">Corporate IT</span></span>
<span data-ttu-id="2a7e4-131">Podniková oddělení IT se obvykle používají šablony pro doručování cloudu možnosti kapacity a hostovaných v cloudu.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-131">Corporate IT organizations typically use templates for delivering cloud capacity and cloud-hosted capabilities.</span></span>

#### <a name="cloud-capacity"></a><span data-ttu-id="2a7e4-132">Kapacita cloudu</span><span class="sxs-lookup"><span data-stu-id="2a7e4-132">Cloud capacity</span></span>
<span data-ttu-id="2a7e4-133">Běžný způsob pro podnikové IT skupiny k zajištění kapacity cloudu pro týmy je s "tričko velikostí", které jsou standardní nabídky velikosti například malé, střední a velké.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-133">A common way for corporate IT groups to provide cloud capacity for teams is with "t-shirt sizes", which are standard offering sizes such as small, medium, and large.</span></span> <span data-ttu-id="2a7e4-134">Nabídky tričko velikost můžete kombinovat různé typy prostředků a počty při současném poskytování úrovně standardizaci, který umožňuje použití šablon.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-134">The t-shirt sized offerings can mix different resource types and quantities while providing a level of standardization that makes it possible to use templates.</span></span> <span data-ttu-id="2a7e4-135">Šablony poskytovat kapacity konzistentní způsobem, který vynucuje podnikové zásady a používá označení zajistit vrácení peněz na využívání organizace.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-135">The templates deliver capacity in a consistent way that enforces corporate policies and uses tagging to provide chargeback to consuming organizations.</span></span>

<span data-ttu-id="2a7e4-136">Potřebujete například poskytovat vývoj, testovací nebo produkční prostředí v rámci, které můžete nasadit software vývojové týmy jejich řešení.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-136">For example, you may need to provide development, test, or production environments within which the software development teams can deploy their solutions.</span></span> <span data-ttu-id="2a7e4-137">Prostředí obsahuje předdefinované síťové topologie a elementy, které nelze změnit vývojové týmy softwaru, jako například pravidla pro přístup k veřejného Internetu a paketu kontroly.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-137">The environment has a predefined network topology and elements that the software development teams cannot change, such as rules governing access to the public internet and packet inspection.</span></span> <span data-ttu-id="2a7e4-138">Můžete mít rovněž organizace specifické role u těchto prostředí s odlišné přístupová práva pro prostředí.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-138">You may also have organization-specific roles for these environments with distinct access rights for the environment.</span></span>

#### <a name="cloud-hosted-capabilities"></a><span data-ttu-id="2a7e4-139">Možnosti hostovaných v cloudu</span><span class="sxs-lookup"><span data-stu-id="2a7e4-139">Cloud-hosted capabilities</span></span>
<span data-ttu-id="2a7e4-140">Šablony můžete použít k podpoře funkce hostovaných v cloudu, včetně jednotlivých softwarových balíčků nebo složený nabídky, které jsou nabízeny interní odvětví podnikání.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-140">You can use templates to support cloud-hosted capabilities, including individual software packages or composite offerings that are offered to internal lines of business.</span></span> <span data-ttu-id="2a7e4-141">Příkladem složené nabídky může být analýza jako služby – analýzy, vizualizace a další technologie – doručit v konfiguraci optimalizované, propojených na předdefinované síťové topologie.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-141">An example of a composite offering would be analytics-as-a-service—analytics, visualization, and other technologies—delivered in an optimized, connected configuration on a predefined network topology.</span></span>

<span data-ttu-id="2a7e4-142">Aspekty zabezpečení a role vymezenému kapacitu cloudu, na kterém jste vytvořené nabídky se týká funkcí hostovaných v cloudu.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-142">Cloud-hosted capabilities are affected by the security and role considerations established by the cloud capacity offering on which they’re built.</span></span> <span data-ttu-id="2a7e4-143">Tyto možnosti jsou nabízena, jak jsou, nebo jako spravovanou službu.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-143">These capabilities are offered as is or as a managed service.</span></span> <span data-ttu-id="2a7e4-144">K povolení přístupu do prostředí pro účely správy jsou potřeba pro pozdější, omezeného přístupu role.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-144">For the latter, access-constrained roles are required to enable access into the environment for management purposes.</span></span>

## <a name="cloud-service-vendors"></a><span data-ttu-id="2a7e4-145">Dodavatelé cloudové služby</span><span class="sxs-lookup"><span data-stu-id="2a7e4-145">Cloud service vendors</span></span>
<span data-ttu-id="2a7e4-146">Až po rozhovoru s mnoha sdílené svazky clusteru, myslíme, že více přístupů, které můžete použít k nasazení služeb pro vaše zákazníky a přidružené požadavky.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-146">After talking to many CSVs, we identified multiple approaches you can take to deploy services for your customers and associated requirements.</span></span>

### <a name="csv-hosted-offering"></a><span data-ttu-id="2a7e4-147">CSV hostované nabídky</span><span class="sxs-lookup"><span data-stu-id="2a7e4-147">CSV-hosted offering</span></span>
<span data-ttu-id="2a7e4-148">Pokud hostujete vaší nabídky v předplatného Azure, jsou společné hostování dva přístupy: nasazení odlišné nasazení pro každý zákazníka nebo nasazování jednotek škálování, které jsou základem sdílené infrastruktury používá pro všechny zákazníky.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-148">If you host your offering in your own Azure subscription, two hosting approaches are common: deploying a distinct deployment for every customer or deploying scale units that underpin a shared infrastructure used for all customers.</span></span>

* <span data-ttu-id="2a7e4-149">**Odlišné nasazení pro každého zákazníka.**</span><span class="sxs-lookup"><span data-stu-id="2a7e4-149">**Distinct deployments for each customer.**</span></span> <span data-ttu-id="2a7e4-150">Odlišné nasazení na zákazníka vyžadují pevné topologie různé známé konfigurace.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-150">Distinct deployments per customer require fixed topologies of different known configurations.</span></span> <span data-ttu-id="2a7e4-151">Tato nasazení může mít jiný virtuální počítač (VM) velikosti, proměnlivým počtem uzlů a různé množství přidruženého úložiště.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-151">These deployments may have different virtual machine (VM) sizes, varying numbers of nodes, and different amounts of associated storage.</span></span> <span data-ttu-id="2a7e4-152">Označení nasazení se používá pro fakturaci souhrnné jednotlivých zákazníků.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-152">Tagging of deployments is used for roll-up billing of each customer.</span></span> <span data-ttu-id="2a7e4-153">RBAC lze ho zapnout pro povolení přístupu k aspekty jejich cloudového prostředí zákazníků.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-153">RBAC may be enabled to allow customers access to aspects of their cloud environment.</span></span>
* <span data-ttu-id="2a7e4-154">**Jednotky škálování ve sdíleném víceklientské prostředí.**</span><span class="sxs-lookup"><span data-stu-id="2a7e4-154">**Scale units in shared multi-tenant environments.**</span></span> <span data-ttu-id="2a7e4-155">Jednotka škálování pro prostředí s více klientů může představovat šablonu.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-155">A template can represent a scale unit for multi-tenant environments.</span></span> <span data-ttu-id="2a7e4-156">V takovém případě se používá stejnou infrastrukturu pro podporu všem zákazníkům.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-156">In this case, the same infrastructure is used to support all customers.</span></span> <span data-ttu-id="2a7e4-157">Nasazení představují skupinu prostředků, které doručují úroveň kapacity pro hostované nabídky, jako je počet uživatelů a počet transakcí.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-157">The deployments represent a group of resources that deliver a level of capacity for the hosted offering, such as number of users and number of transactions.</span></span> <span data-ttu-id="2a7e4-158">Tyto jednotky škálování jsou zvětšit nebo zmenšit, protože vyžaduje.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-158">These scale units are increased or decreased as demand requires.</span></span>

### <a name="csv-offering-injected-into-customer-subscription"></a><span data-ttu-id="2a7e4-159">Nabídka CSV vloženy do předplatné zákazníka</span><span class="sxs-lookup"><span data-stu-id="2a7e4-159">CSV offering injected into customer subscription</span></span>
<span data-ttu-id="2a7e4-160">Můžete k nasazení softwaru do odběrů vlastníkem koncovým zákazníkům.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-160">You may want to deploy your software into subscriptions owned by end customers.</span></span> <span data-ttu-id="2a7e4-161">Šablony můžete použít k nasazení odlišné nasazení do Azure účtu zákazníka.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-161">You can use templates to deploy distinct deployments into a customer’s Azure account.</span></span>

<span data-ttu-id="2a7e4-162">Tato nasazení používat funkci RBAC, abyste mohli aktualizovat a spravovat nasazení v rámci účtu zákazníka.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-162">These deployments use RBAC so you can update and manage the deployment within the customer’s account.</span></span>

### <a name="azure-marketplace"></a><span data-ttu-id="2a7e4-163">Azure Marketplace</span><span class="sxs-lookup"><span data-stu-id="2a7e4-163">Azure Marketplace</span></span>
<span data-ttu-id="2a7e4-164">Inzerovat a prodeje nabídkami přes marketplace, jako je například Azure Marketplace můžete vyvíjet šablony k poskytování odlišné typy nasazení, které běží v Azure účtu zákazníka.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-164">To advertise and sell your offerings through a marketplace, such as Azure Marketplace, you can develop templates to deliver distinct types of deployments that run in a customer’s Azure account.</span></span> <span data-ttu-id="2a7e4-165">Tato odlišné nasazení mohou obvykle popsané jako velikost trička (malé, střední, velký), typ produktu nebo cílové skupiny (komunity, developer, enterprise) nebo typ funkce (základní, vysoké dostupnosti).</span><span class="sxs-lookup"><span data-stu-id="2a7e4-165">These distinct deployments can be typically described as a t-shirt size (small, medium, large), product/audience type (community, developer, enterprise), or feature type (basic, high availability).</span></span>  <span data-ttu-id="2a7e4-166">V některých případech se tyto typy umožňují určit určité atributy nasazení, například typ virtuálního počítače nebo počet disků.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-166">In some cases, these types allow you to specify certain attributes of the deployment, such as VM type or number of disks.</span></span>

## <a name="oss-projects"></a><span data-ttu-id="2a7e4-167">Projekty operačních systémů</span><span class="sxs-lookup"><span data-stu-id="2a7e4-167">OSS projects</span></span>
<span data-ttu-id="2a7e4-168">V rámci projekty s otevřeným zdrojem povolte šablony Resource Manageru komunita nasazení řešení rychle pomocí osvědčené postupy.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-168">Within open source projects, Resource Manager templates enable a community to deploy a solution quickly using proven practices.</span></span> <span data-ttu-id="2a7e4-169">Šablony můžete ukládat v úložišti GitHub, komunity můžete zkontrolovat, jestli je v čase.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-169">You can store templates in a GitHub repository so the community can revise them over time.</span></span> <span data-ttu-id="2a7e4-170">Uživatelé nasazení těchto šablon do svých vlastních předplatných Azure.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-170">Users deploy these templates in their own Azure subscriptions.</span></span>

<span data-ttu-id="2a7e4-171">V následujících částech akcí, které je potřeba vzít v úvahu před navržením řešení.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-171">The following sections identify the things you need to consider before designing your solution.</span></span>

## <a name="identifying-what-is-outside-and-inside-a-vm"></a><span data-ttu-id="2a7e4-172">Identifikace, co je mimo a uvnitř virtuálního počítače</span><span class="sxs-lookup"><span data-stu-id="2a7e4-172">Identifying what is outside and inside a VM</span></span>
<span data-ttu-id="2a7e4-173">Při navrhování vaší šablony, je vhodné podívat se na požadavky z hlediska novinky mimo a ve virtuálních počítačích (VM):</span><span class="sxs-lookup"><span data-stu-id="2a7e4-173">As you design your template, it’s helpful to look at the requirements in terms of what's outside and inside the virtual machines (VMs):</span></span>

* <span data-ttu-id="2a7e4-174">Mimo znamená virtuálních počítačů a dalším prostředkům vaše nasazení, například síťové topologie, označování, odkazuje na certifikátů nebo tajných klíčů a řízení přístupu na základě rolí.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-174">Outside means the VMs and other resources of your deployment, such as the network topology, tagging, references to the certs/secrets, and role-based access control.</span></span> <span data-ttu-id="2a7e4-175">Všechny tyto prostředky jsou součástí šablony.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-175">All these resources are part of your template.</span></span>
* <span data-ttu-id="2a7e4-176">Uvnitř znamená nainstalovaného softwaru a celkové požadovaný stav konfigurace.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-176">Inside means the installed software and overall desired state configuration.</span></span> <span data-ttu-id="2a7e4-177">Jiné mechanismy, jako je například rozšíření virtuálního počítače nebo skripty, se používají v celé nebo částečně.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-177">Other mechanisms, such as VM extensions or scripts, are used in whole or in part.</span></span> <span data-ttu-id="2a7e4-178">Tyto mechanismy může identifikovat a provést šablonou, ale nejsou v ní.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-178">These mechanisms may be identified and executed by the template but aren’t in it.</span></span>

<span data-ttu-id="2a7e4-179">Běžné činnosti, které by se "uvnitř pole" Příklady-</span><span class="sxs-lookup"><span data-stu-id="2a7e4-179">Common examples of activities you would do “inside the box” include -</span></span>  

* <span data-ttu-id="2a7e4-180">Instalace nebo odebrání rolí a funkcí serveru</span><span class="sxs-lookup"><span data-stu-id="2a7e4-180">Install or remove server roles and features</span></span>
* <span data-ttu-id="2a7e4-181">Instalace a konfigurace softwaru na úrovni uzlu nebo clusteru</span><span class="sxs-lookup"><span data-stu-id="2a7e4-181">Install and configure software at the node or cluster level</span></span>
* <span data-ttu-id="2a7e4-182">Nasazení webů na webovém serveru</span><span class="sxs-lookup"><span data-stu-id="2a7e4-182">Deploy websites on a web server</span></span>
* <span data-ttu-id="2a7e4-183">Nasazení databáze schémata</span><span class="sxs-lookup"><span data-stu-id="2a7e4-183">Deploy database schemas</span></span>
* <span data-ttu-id="2a7e4-184">Správa registru nebo jiné typy nastavení konfigurace</span><span class="sxs-lookup"><span data-stu-id="2a7e4-184">Manage registry or other types of configuration settings</span></span>
* <span data-ttu-id="2a7e4-185">Správa souborů a adresářů</span><span class="sxs-lookup"><span data-stu-id="2a7e4-185">Manage files and directories</span></span>
* <span data-ttu-id="2a7e4-186">Spuštění, zastavení a správu procesů a služeb</span><span class="sxs-lookup"><span data-stu-id="2a7e4-186">Start, stop, and manage processes and services</span></span>
* <span data-ttu-id="2a7e4-187">Správa místních skupin a uživatelských účtů</span><span class="sxs-lookup"><span data-stu-id="2a7e4-187">Manage local groups and user accounts</span></span>
* <span data-ttu-id="2a7e4-188">Instalaci a správě balíčků (.msi, .exe, yum atd.)</span><span class="sxs-lookup"><span data-stu-id="2a7e4-188">Install and manage packages (.msi, .exe, yum, etc.)</span></span>
* <span data-ttu-id="2a7e4-189">Spravovat proměnné prostředí</span><span class="sxs-lookup"><span data-stu-id="2a7e4-189">Manage environment variables</span></span>
* <span data-ttu-id="2a7e4-190">Spouštění skriptů nativní (prostředí Windows PowerShell, bash, atd.)</span><span class="sxs-lookup"><span data-stu-id="2a7e4-190">Run native scripts (Windows PowerShell, bash, etc.)</span></span>

### <a name="desired-state-configuration-dsc"></a><span data-ttu-id="2a7e4-191">Konfigurace požadovaného stavu (DSC)</span><span class="sxs-lookup"><span data-stu-id="2a7e4-191">Desired state configuration (DSC)</span></span>
<span data-ttu-id="2a7e4-192">Přemýšlíte o vnitřní stav virtuálních počítačů nad rámec nasazení, chcete zajistěte, aby toto nasazení nebude "soubor" z konfigurace, který jste definovali a zaškrtnutí do správy zdrojového kódu.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-192">Thinking about the internal state of your VMs beyond deployment, you want to make sure this deployment doesn’t "drift" from the configuration that you have defined and checked into source control.</span></span> <span data-ttu-id="2a7e4-193">Tento přístup zajišťuje vaše vývojáři nebo provozní personál nemusíte měnit ad-hoc prostředí, které nejsou vetted, testovat nebo zaznamenávají do správy zdrojového kódu.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-193">This approach ensures your developers or operations staff don’t make ad-hoc changes to an environment that are not vetted, tested, or recorded in source control.</span></span> <span data-ttu-id="2a7e4-194">Tento ovládací prvek je důležité, protože nejsou ručních změn ve správě zdrojového kódu.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-194">This control is important, because the manual changes are not in source control.</span></span> <span data-ttu-id="2a7e4-195">Nejsou také součástí standardního nasazení a ovlivní budoucí automatizované nasazení softwaru.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-195">They are also not part of the standard deployment and will impact future automated deployments of the software.</span></span>

<span data-ttu-id="2a7e4-196">Nad rámec zaměstnancům vnitřní konfigurace požadovaného stavu taky je důležité z hlediska zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-196">Beyond your internal employees, desired state configuration is also important from a security perspective.</span></span> <span data-ttu-id="2a7e4-197">Hackery jsou pravidelně pokusu o ohrožení a zneužití systémy softwaru.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-197">Hackers are regularly trying to compromise and exploit software systems.</span></span> <span data-ttu-id="2a7e4-198">Po úspěšné, je běžné instalace souborů a v opačném případě změňte stavu ohrožení zabezpečení systému.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-198">When successful, it's common to install files and otherwise change the state of a compromised system.</span></span> <span data-ttu-id="2a7e4-199">Konfigurace požadovaného stavu můžete identifikovat rozdílů mezi požadované a aktuální stav a obnovení známé konfigurace.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-199">Using desired state configuration, you can identify deltas between the desired and actual state and restore a known configuration.</span></span>

<span data-ttu-id="2a7e4-200">Existují rozšíření prostředků pro nejoblíbenější mechanismy pro DSC - PowerShell DSC, Chef a Puppet.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-200">There are resource extensions for the most popular mechanisms for DSC - PowerShell DSC, Chef, and Puppet.</span></span> <span data-ttu-id="2a7e4-201">Každý z těchto rozšíření můžete nasadit počáteční stav virtuálního počítače a také použít k Ujistěte se, že se zachová požadovaný stav.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-201">Each of these extensions can deploy the initial state of your VM and also be used to make sure the desired state is maintained.</span></span>

## <a name="common-template-scopes"></a><span data-ttu-id="2a7e4-202">Běžné obory šablony</span><span class="sxs-lookup"><span data-stu-id="2a7e4-202">Common template scopes</span></span>
<span data-ttu-id="2a7e4-203">V našich zkušeností jsme viděli tři obory šablony klíče řešení vznikat.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-203">In our experience, we’ve seen three key solution templates scopes emerge.</span></span> <span data-ttu-id="2a7e4-204">Tyto tři obory – kapacitu, funkce a řešení pro kompletní – jsou popsané v následujících částech.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-204">These three scopes – capacity, capability, and end-to-end solution – are described in the following sections.</span></span>

### <a name="capacity-scope"></a><span data-ttu-id="2a7e4-205">Kapacity oboru</span><span class="sxs-lookup"><span data-stu-id="2a7e4-205">Capacity scope</span></span>
<span data-ttu-id="2a7e4-206">Obor kapacity přináší sadu prostředků v topologii standardní, který je předem nakonfigurovaný k dosažení souladu s předpisy a zásadami.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-206">A capacity scope delivers a set of resources in a standard topology that is pre-configured to be in compliance with regulations and policies.</span></span> <span data-ttu-id="2a7e4-207">Nejčastější nasazuje ve scénáři s Enterprise IT nebo ve standardním vývojovém prostředí.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-207">The most common example is deploying a standard development environment in an Enterprise IT or SI scenario.</span></span>

### <a name="capability-scope"></a><span data-ttu-id="2a7e4-208">Obor funkce</span><span class="sxs-lookup"><span data-stu-id="2a7e4-208">Capability scope</span></span>
<span data-ttu-id="2a7e4-209">Obor funkce se zaměřuje na nasazení a konfiguraci topologie pro danou technologii.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-209">A capability scope is focused on deploying and configuring a topology for a given technology.</span></span> <span data-ttu-id="2a7e4-210">Běžné scénáře, včetně technologií, jako je například SQL Server, Cassandra, Hadoop.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-210">Common scenarios including technologies such as SQL Server, Cassandra, Hadoop.</span></span>

### <a name="end-to-end-solution-scope"></a><span data-ttu-id="2a7e4-211">Komplexní řešení rozsahu</span><span class="sxs-lookup"><span data-stu-id="2a7e4-211">End-to-end solution scope</span></span>
<span data-ttu-id="2a7e4-212">V oboru začátku do konce řešení je cílem nad rámec jednoho schopnosti a místo toho se zaměřuje na řešení s koncová skládá z více možností.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-212">An End-to-End Solution Scope is targeted beyond a single capability, and instead focused on delivering an end to end solution comprised of multiple capabilities.</span></span>  

<span data-ttu-id="2a7e4-213">Obor s rozsahem řešení šablony projevuje jako sadu jeden nebo více obor funkce šablon s prostředky pro konkrétní řešení, logiku a požadovaný stav.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-213">A solution-scoped template scope manifests itself as a set of one or more capability-scoped templates with solution-specific resources, logic, and desired state.</span></span> <span data-ttu-id="2a7e4-214">Příklad šablony obor řešení je šablonu koncová datového kanálu řešení.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-214">An example of a solution-scoped template is an end to end data pipeline solution template.</span></span> <span data-ttu-id="2a7e4-215">Šablona může kombinovat specifické řešení topologie a stavu s více šablon funkce obor řešení například Kafka, Storm a Hadoop.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-215">The template might mix solution-specific topology and state with multiple capability-scoped solution templates such as Kafka, Storm, and Hadoop.</span></span>

## <a name="choosing-free-form-vs-known-configurations"></a><span data-ttu-id="2a7e4-216">Výběr vlastní oproti známé konfigurace</span><span class="sxs-lookup"><span data-stu-id="2a7e4-216">Choosing free-form vs. known configurations</span></span>
<span data-ttu-id="2a7e4-217">Zpočátku byste očekávali šablonu měl dát příjemci co nejvíce flexibilitu, ale volba, jestli se má použít vlastní konfigurace oproti známé konfigurace ovlivnit několik rozhodnutí.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-217">You might initially think a template should give consumers the utmost flexibility, but many considerations affect the choice of whether to use free-form configurations vs. known configurations.</span></span> <span data-ttu-id="2a7e4-218">Tato část popisuje požadavky zákazníků a technické aspekty, které ve tvaru přístup sdílené v tomto dokumentu.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-218">This section identifies the key customer requirements and technical considerations that shaped the approach shared in this document.</span></span>

### <a name="free-form-configurations"></a><span data-ttu-id="2a7e4-219">Vlastní konfigurace</span><span class="sxs-lookup"><span data-stu-id="2a7e4-219">Free-form configurations</span></span>
<span data-ttu-id="2a7e4-220">Na ploše zvukových ideální vlastní konfigurace.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-220">On the surface, free-form configurations sound ideal.</span></span> <span data-ttu-id="2a7e4-221">Se vám umožní vybrat typ virtuálního počítače a zadat libovolný počet uzlů a připojené disky pro tyto uzly – a to provést jako parametry do šablony.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-221">They allow you to select a VM type and provide an arbitrary number of nodes and attached disks for those nodes — and do so as parameters to a template.</span></span> <span data-ttu-id="2a7e4-222">Tento přístup je však není ideální pro některé scénáře.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-222">However, this approach is not ideal for some scenarios.</span></span>

<span data-ttu-id="2a7e4-223">V [velikosti virtuálních počítačů](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json), jsou identifikovány různé typy virtuálních počítačů a dostupných velikostí a každý počtu trvale disky (2, 4, 8, 16 nebo 32), který lze připojit.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-223">In [Sizes for virtual machines](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json), the different VM types and available sizes are identified, and each of the number of durable disks (2, 4, 8, 16, or 32) that can be attached.</span></span> <span data-ttu-id="2a7e4-224">Každý připojený disk poskytuje 500 IOPS a násobků, které z těchto disků může být ve fondu pro násobitel tohoto počtu IOPS.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-224">Each attached disk provides 500 IOPS and multiples of these disks can be pooled for a multiplier of that number of IOPS.</span></span> <span data-ttu-id="2a7e4-225">16 disků může být například ve fondu, zajistit 8000 IOPS.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-225">For example, 16 disks can be pooled to provide 8,000 IOPS.</span></span> <span data-ttu-id="2a7e4-226">Sdružování se provádí s konfigurací v operačním systému, pomocí prostorů úložiště Microsoft Windows nebo redundantní pole málo nákladných disků (RAID) v systému Linux.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-226">Pooling is done with configuration in the operating system, using Microsoft Windows Storage Spaces or redundant array of inexpensive disks (RAID) in Linux.</span></span>

<span data-ttu-id="2a7e4-227">Vlastní konfigurace umožňuje výběr několik instancí virtuálních počítačů, virtuální počítač různé typy a velikosti pro ty instance, různých disků pro typ virtuálního počítače a jeden nebo více skripty ke konfiguraci virtuálních počítačů obsah.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-227">A free-form configuration enables the selection several VM instances, various VM types and sizes for those instances, various disks for the VM type, and one or more scripts to configure the VM contents.</span></span>

<span data-ttu-id="2a7e4-228">Je běžné, že nasazení může mít víc typů uzlů, jako je hlavní server a datové uzly, tak tuto flexibilitu potřebují je často poskytnuté pro každý typ uzlu.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-228">It is common that a deployment may have multiple types of nodes, such as master and data nodes, so this flexibility is often provided for every node type.</span></span>

<span data-ttu-id="2a7e4-229">Když začnete nasazení clusterů žádné násobek, začnete pracovat s tyto složité scénáře.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-229">As you start to deploy clusters of any significance, you begin to work with these complex scenarios.</span></span> <span data-ttu-id="2a7e4-230">Pokud byly nasazení clusteru Hadoop, například s 8 řídicí uzly a uzly 200 dat a ve fondu 4 připojených disků na každý hlavní uzel a ve fondu 16 připojených disků na jeden uzel dat by máte 208 virtuální počítače a 3,232 disky, které slouží ke správě.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-230">If you were deploying a Hadoop cluster, for example, with 8 master nodes and 200 data nodes, and pooled 4 attached disks on each master node and pooled 16 attached disks per data node, you would have 208 VMs and 3,232 disks to manage.</span></span>

<span data-ttu-id="2a7e4-231">Účet úložiště bude omezení výše uvedené požadavky jeho identifikovaných 20 000 transakcí za sekundu omezit, tak, aby měli podívejte se na vytváření oddílů účtu úložiště a výpočty použijte k určení odpovídající počet účtů úložiště pro umístění této topologii.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-231">A storage account will throttle requests above its identified 20,000 transactions/second limit, so you should look at storage account partitioning and use calculations to determine the appropriate number of storage accounts to accommodate this topology.</span></span> <span data-ttu-id="2a7e4-232">Zadána velkého množství kombinace nepodporuje vlastní přístup dynamické výpočty vyžadovaných pro určení příslušné oddíly.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-232">Given the multitude of combinations supported by the free-form approach, dynamic calculations are required to determine the appropriate partitioning.</span></span> <span data-ttu-id="2a7e4-233">Jazyk šablony Azure Resource Manager v současné době neposkytuje matematické funkce, takže je nutné provést tyto výpočty v kódu, generování šablonu jedinečné, pevně s příslušné podrobnosti.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-233">The Azure Resource Manager Template Language does not presently provide mathematical functions, so you must perform these calculations in code, generating a unique, hard-coded template with the appropriate details.</span></span>

<span data-ttu-id="2a7e4-234">V podnikovém IT a ve scénářích někdo musí udržovat šablony a podporovat nasazené topologie pro jeden nebo více organizace.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-234">In enterprise IT and SI scenarios, someone must maintain the templates and support the deployed topologies for one or more organizations.</span></span> <span data-ttu-id="2a7e4-235">Tato další režii – různých konfigurací a šablony pro každého zákazníka – je daleko od žádoucí.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-235">This additional overhead — different configurations and templates for each customer — is far from desirable.</span></span>

<span data-ttu-id="2a7e4-236">Tyto šablony můžete použít k nasazení prostředí v rámci předplatného Azure vašich zákazníků, ale podnikové IT týmy i sdílené svazky clusteru obvykle nasazení je do svých vlastních předplatných, pomocí funkce vrácení peněz k vyúčtování zákazníků.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-236">You can use these templates to deploy environments in your customer’s Azure subscription, but both corporate IT teams and CSVs typically deploy them into their own subscriptions, using a chargeback function to bill their customers.</span></span> <span data-ttu-id="2a7e4-237">V těchto scénářích cílem je nasazení kapacity pro několik zákazníků v rámci fondu předplatných a udržovat nasazení hustě importují do odběrů minimalizovat živelný předplatné růst – to znamená, více odběrů ke správě.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-237">In these scenarios, the goal is to deploy capacity for multiple customers across a pool of subscriptions and keep deployments densely populated into the subscriptions to minimize subscription sprawl—that is, more subscriptions to manage.</span></span> <span data-ttu-id="2a7e4-238">S velikostí skutečně dynamické nasazení dosažení tento typ hustotu vyžaduje pečlivé plánování a další vývoj pro generování uživatelského rozhraní pracovní jménem organizace.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-238">With truly dynamic deployment sizes, achieving this type of density requires careful planning and additional development for scaffolding work on behalf of the organization.</span></span>

<span data-ttu-id="2a7e4-239">Kromě toho nelze vytvářet odběry prostřednictvím volání rozhraní API ale musíte to provést ručně přes portál.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-239">In addition, you can’t create subscriptions via an API call but must do so manually through the portal.</span></span> <span data-ttu-id="2a7e4-240">Jak se zvyšuje počet odběrů, všechny výsledné živelný růst předplatné vyžaduje lidského zásahu – nelze je možné automatizovat.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-240">As the number of subscriptions increases, any resulting subscription sprawl requires human intervention—it can’t be automated.</span></span> <span data-ttu-id="2a7e4-241">S mnoho variabilita velikosti nasazení by musel předem poskytnout několik odběrů ručně ověřte, že odběry jsou k dispozici.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-241">With so much variability in the sizes of deployments, you would have to pre-provision a number of subscriptions manually to ensure subscriptions are available.</span></span>

<span data-ttu-id="2a7e4-242">S ohledem na tyto faktory je přitažlivými méně než v první blush skutečně vlastní konfigurace.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-242">Considering all these factors, a truly free-form configuration is less appealing than at first blush.</span></span>

### <a name="known-configurations--the-t-shirt-sizing-approach"></a><span data-ttu-id="2a7e4-243">Známé konfigurace – přístup nastavení velikosti tričko</span><span class="sxs-lookup"><span data-stu-id="2a7e4-243">Known configurations — the t-shirt sizing approach</span></span>
<span data-ttu-id="2a7e4-244">Spíše než nabízí šablonu, která poskytuje celkový flexibilitu a obrovském množství variant, v našich zkušeností běžný vzor je poskytnout možnost vybrat známé konfigurace – ve skutečnosti standardní tričko velikosti například izolovaného prostoru, malé, střední a velké.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-244">Rather than offer a template that provides total flexibility and countless variations, in our experience a common pattern is to provide the ability to select known configurations — in effect, standard t-shirt sizes such as sandbox, small, medium, and large.</span></span> <span data-ttu-id="2a7e4-245">Další příklady tričko velikosti jsou nabídky produktů, jako je například community edition nebo enterprise edition.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-245">Other examples of t-shirt sizes are product offerings, such as community edition or enterprise edition.</span></span>  <span data-ttu-id="2a7e4-246">V jiných případech může být určeného pro konkrétní úlohy konfigurace technologii – například mapy snížit nebo žádné sql.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-246">In other cases, it may be workload-specific configurations of a technology – such as map reduce or no sql.</span></span>

<span data-ttu-id="2a7e4-247">Mnoho podnikových IT organizace, operačních systémů dodavatelů a SIs zpřístupnit jejich nabídky dnes tímto způsobem ve virtualizovaných prostředích (podniky) na místě, nebo jako nabídek softwaru jako služby (SaaS), (sdílené svazky clusteru a OSVs).</span><span class="sxs-lookup"><span data-stu-id="2a7e4-247">Many enterprise IT organizations, OSS vendors, and SIs make their offerings available today in this way in on-premises, virtualized environments (enterprises) or as software-as-a-service (SaaS) offerings (CSVs and OSVs).</span></span>

<span data-ttu-id="2a7e4-248">Tento přístup poskytuje dobrý, známé konfigurace různou velikost předem konfigurovaných pro zákazníky.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-248">This approach provides good, known configurations of varying sizes that are preconfigured for customers.</span></span> <span data-ttu-id="2a7e4-249">Bez známé konfigurace musí koncovým zákazníkům určit cluster pro změnu velikosti na své vlastní, zohlednit v omezení prostředků platformy a proveďte matematické k identifikaci výsledné oddíly účty úložiště a dalším prostředkům (z důvodu velikost clusteru a prostředků omezení).</span><span class="sxs-lookup"><span data-stu-id="2a7e4-249">Without known configurations, end customers must determine cluster sizing on their own, factor in platform resource constraints, and do math to identify the resulting partitioning of storage accounts and other resources (due to cluster size and resource constraints).</span></span> <span data-ttu-id="2a7e4-250">Známé konfigurace umožňují zákazníkům snadno vybrat správnou velikost tričko – to znamená, dané nasazení.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-250">Known configurations enable customers to easily select the right t-shirt size—that is, a given deployment.</span></span> <span data-ttu-id="2a7e4-251">Kromě vytváření lepší podmínky pro zákazníka, je snazší malý počet známé konfigurace podporují a můžete poskytovat vyšší úroveň hustotou.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-251">In addition to making a better experience for the customer, a small number of known configurations is easier to support and can help you deliver a higher level of density.</span></span>

<span data-ttu-id="2a7e4-252">O přístupu známé konfigurace zaměřené na velikosti tričko také může mít různý počet uzlů v rámci velikost.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-252">A known configuration approach focused on t-shirt sizes may also have varying number of nodes within a size.</span></span> <span data-ttu-id="2a7e4-253">Malá velikost trička může být například mezi uzly 3 až 10.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-253">For example, a small t-shirt size may be between 3 and 10 nodes.</span></span>  <span data-ttu-id="2a7e4-254">Velikost trička by být navržena k uložení až 10 uzly a zadejte příjemce možnost volného formátu možnosti až po maximální velikost identifikovat.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-254">The t-shirt size would be designed to accommodate up to 10 nodes and provide the consumer the ability to make free form selections up to the maximum size identified.</span></span>  

<span data-ttu-id="2a7e4-255">Velikost trička, v závislosti na typu úloh, může být více volného formátu ve své podstatě z hlediska počtu uzlů, které mohou být nasazeny, ale bude mít odlišné uzlu velikost pracovního vytížení a konfigurace softwaru na uzlu.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-255">A t-shirt size based on workload type, may be more free form in nature in terms of the number of nodes that can be deployed but will have workload distinct node size and configuration of the software on the node.</span></span>

<span data-ttu-id="2a7e4-256">Tričko velikosti podle nabídky produktů, například komunity nebo Enterprise, může mít typy různých prostředků a maximální počet uzlů, které mohou být nasazeny, obvykle svázané s licencování aspekty nebo dostupnosti funkce napříč jiné nabídky.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-256">T-shirt sizes based on product offerings, such as community or Enterprise, may have distinct resource types and maximum number of nodes that can be deployed, typically tied to licensing considerations or feature availability across the different offerings.</span></span>

<span data-ttu-id="2a7e4-257">Bylo možné ošetřit zákazníků s jedinečný variant pomocí šablony založené na JSON.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-257">You can also accommodate customers with unique variants using the JSON-based templates.</span></span> <span data-ttu-id="2a7e4-258">Při plánování práce s odlehlé hodnoty, můžete začlenit na příslušné plánování a důležité informace pro vývoj, podpory a výpočet nákladů.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-258">When dealing with outliers, you can incorporate the appropriate planning and considerations for development, support, and costing.</span></span>

<span data-ttu-id="2a7e4-259">Na základě scénáře spotřeba šablon zákazníka a požadavky na začátku tohoto dokumentu identifikovat, myslíme, vzor šablony rozložením.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-259">Based on the customer template consumption scenarios, and requirements identified at the start of this document, we identified a pattern for template decomposition.</span></span>

## <a name="capacity-and-capability-scoped-solution-templates"></a><span data-ttu-id="2a7e4-260">Kapacity a schopností obor řešení šablony</span><span class="sxs-lookup"><span data-stu-id="2a7e4-260">Capacity and capability-scoped solution templates</span></span>
<span data-ttu-id="2a7e4-261">Rozložením poskytuje modulární přístup ke vývoj šablon, že podporuje opakovaně, rozšiřitelnosti, testování a nástrojů.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-261">Decomposition provides a modular approach to template development that supports reuse, extensibility, testing, and tooling.</span></span> <span data-ttu-id="2a7e4-262">Tato část obsahuje podrobnosti o rozložením přístup jak lze použít pro šablony s rozsahem kapacity nebo funkce.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-262">This section provides detail on how a decomposition approach can be applied to templates with a Capacity or Capability scope.</span></span>

<span data-ttu-id="2a7e4-263">V tento postup hlavní šablonu přijímá hodnoty parametrů z šablony příjemce, a potom odkazuje na několik typů šablon a skripty po proudu, jak je uvedeno níže.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-263">In this approach, a main template receives parameter values from a template consumer, then links to several types of templates and scripts downstream as shown below.</span></span> <span data-ttu-id="2a7e4-264">Parametry, statické proměnné a vygenerovaný proměnné se používají k zadání hodnot a deaktivovat propojených šablon.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-264">Parameters, static variables, and generated variables are used to provide values in and out of the linked templates.</span></span>

![Parametry šablony](./media/best-practices-resource-manager-design-templates/template-parameters.png)

<span data-ttu-id="2a7e4-266">**Parametry jsou předány hlavní šablonu, která pak má propojených šablon**</span><span class="sxs-lookup"><span data-stu-id="2a7e4-266">**Parameters are passed to a main template then to linked templates**</span></span>

<span data-ttu-id="2a7e4-267">V následujících částech se zaměřit na typů šablon a skripty, které je jediné šabloně rozložit na.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-267">The following sections focus on the types of templates and scripts that a single template is decomposed into.</span></span> <span data-ttu-id="2a7e4-268">V části jsou uvedeny přístupy k předání informace o stavu z šablon.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-268">The sections present approaches for passing state information among the templates.</span></span> <span data-ttu-id="2a7e4-269">Každé šablony a typy skript v bitové kopii jsou popsány společně s příklady.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-269">Each template and the script types in the image are described along with examples.</span></span> <span data-ttu-id="2a7e4-270">Kontextová příklad najdete v tématu "jeho uvedení společně: Ukázka implementace" dále v tomto dokumentu.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-270">For a contextual example, see "Putting it together: a sample implementation" later in this document.</span></span>

### <a name="template-metadata"></a><span data-ttu-id="2a7e4-271">Metadata šablony</span><span class="sxs-lookup"><span data-stu-id="2a7e4-271">Template metadata</span></span>
<span data-ttu-id="2a7e4-272">Metadata šablony (soubor metadata.json) obsahuje dvojice klíč/hodnota, které popisují šablonu ve formátu JSON, který může číst člověkem a systémy softwaru.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-272">Template metadata (the metadata.json file) contains key/value pairs that describe a template in JSON, which can be read by humans and software systems.</span></span>

![Metadata šablony](./media/best-practices-resource-manager-design-templates/template-metadata.png)

<span data-ttu-id="2a7e4-274">**Metadata šablony je popsaný v souboru metadata.json**</span><span class="sxs-lookup"><span data-stu-id="2a7e4-274">**Template metadata is described in the metadata.json file**</span></span>

<span data-ttu-id="2a7e4-275">Agenti softwaru můžete načíst soubor metadata.json a publikovat informace a odkaz na šablonu v webové stránky nebo adresář.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-275">Software agents can retrieve the metadata.json file and publish the information and a link to the template in a web page or directory.</span></span> <span data-ttu-id="2a7e4-276">Prvky patří *itemDisplayName*, *popis*, *souhrnné*, *githubUsername*, a *dateUpdated*.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-276">Elements include *itemDisplayName*, *description*, *summary*, *githubUsername*, and *dateUpdated*.</span></span>

<span data-ttu-id="2a7e4-277">Příklad souboru jsou uvedeny níže v celé jeho šíři.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-277">An example file is shown below in its entirety.</span></span>

    {
        "itemDisplayName": "PostgreSQL 9.3 on Ubuntu VMs",
        "description": "This template creates a PostgreSQL streaming-replication between a master and one or more slave servers each with 2 striped data disks. The database servers are deployed into a private-only subnet with one publicly accessible jumpbox VM in a DMZ subnet with public IP.",
        "summary": "PostgreSQL stream-replication with multiple slave servers and a publicly accessible jumpbox VM",
        "githubUsername": "arsenvlad",
        "dateUpdated": "2015-04-24"
    }

### <a name="main-template"></a><span data-ttu-id="2a7e4-278">Hlavní šablony</span><span class="sxs-lookup"><span data-stu-id="2a7e4-278">Main template</span></span>
<span data-ttu-id="2a7e4-279">Hlavní šablona přijímá parametry od uživatele, používá tyto informace k vyplnění komplexní objektové proměnné a provede propojených šablon.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-279">The main template receives parameters from a user, uses that information to populate complex object variables, and executes the linked templates.</span></span>

![Hlavní šablony](./media/best-practices-resource-manager-design-templates/main-template.png)

<span data-ttu-id="2a7e4-281">**Hlavní šablonu přijímá parametry od uživatele.**</span><span class="sxs-lookup"><span data-stu-id="2a7e4-281">**The main template receives parameters from a user**</span></span>

<span data-ttu-id="2a7e4-282">Jeden parametr, který je k dispozici je typ známé konfigurace také označované jako parametr velikosti tričko z důvodu jeho standardizované hodnoty, například malé, střední nebo velké.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-282">One parameter that is provided is a known configuration type also known as the t-shirt size parameter because of its standardized values such as small, medium, or large.</span></span> <span data-ttu-id="2a7e4-283">V praxi můžete tento parametr několika způsoby.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-283">In practice, you can use this parameter in multiple ways.</span></span> <span data-ttu-id="2a7e4-284">Podrobnosti najdete v tématu "Známé konfigurace prostředků šablona" dál v tomto dokumentu.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-284">For details, see "Known configuration resources template" later in this document.</span></span>

<span data-ttu-id="2a7e4-285">Některé prostředky nasadí bez ohledu na to známé konfigurace určený parametrem uživatele.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-285">Some resources are deployed regardless of the known configuration specified by a user parameter.</span></span> <span data-ttu-id="2a7e4-286">Tyto prostředky se zřizují pomocí šablony jeden sdílený prostředek a jsou sdíleny jiné šablony, takže sdílený prostředek šablony je spustit jako první.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-286">These resources are provisioned using a single shared resource template and are shared by other templates, so the shared resource template is run first.</span></span>

<span data-ttu-id="2a7e4-287">Některé prostředky bez ohledu na zadaný známé konfigurace nasazených volitelně.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-287">Some resources are deployed optionally regardless of the specified known configuration.</span></span>

### <a name="shared-resources-template"></a><span data-ttu-id="2a7e4-288">Sdílené prostředky šablony</span><span class="sxs-lookup"><span data-stu-id="2a7e4-288">Shared resources template</span></span>
<span data-ttu-id="2a7e4-289">Tato šablona poskytuje prostředky, které jsou společné pro všechny známé konfigurace.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-289">This template delivers resources that are common across all known configurations.</span></span> <span data-ttu-id="2a7e4-290">Obsahuje virtuální síť, skupiny dostupnosti a další prostředky, které se vyžadují bez ohledu na šabloně známé konfigurace, která je nasazena.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-290">It contains the virtual network, availability sets, and other resources that are required regardless of the known configuration template that is deployed.</span></span>

![Šablony prostředků](./media/best-practices-resource-manager-design-templates/template-resources.png)

<span data-ttu-id="2a7e4-292">**Sdílené prostředky šablony**</span><span class="sxs-lookup"><span data-stu-id="2a7e4-292">**Shared resources template**</span></span>

<span data-ttu-id="2a7e4-293">Názvy prostředků, jako je například název virtuální sítě, jsou založené na šabloně hlavní.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-293">Resource names, such as the virtual network name, are based on the main template.</span></span> <span data-ttu-id="2a7e4-294">Můžete je zadat jako proměnné v rámci dané šablony nebo přijímat jako parametr od uživatele, podle požadavků vaší organizace.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-294">You can specify them as a variable within that template or receive them as a parameter from the user, as required by your organization.</span></span>

### <a name="optional-resources-template"></a><span data-ttu-id="2a7e4-295">Volitelné prostředků šablony</span><span class="sxs-lookup"><span data-stu-id="2a7e4-295">Optional resources template</span></span>
<span data-ttu-id="2a7e4-296">Šablona volitelné prostředků obsahuje prostředky, které jsou nasazeny prostřednictvím kódu programu na základě hodnoty, parametr nebo proměnná.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-296">The optional resources template contains resources that are programmatically deployed based on the value of a parameter or variable.</span></span>

![Volitelné prostředky](./media/best-practices-resource-manager-design-templates/optional-resources.png)

<span data-ttu-id="2a7e4-298">**Volitelné prostředků šablony**</span><span class="sxs-lookup"><span data-stu-id="2a7e4-298">**Optional resources template**</span></span>

<span data-ttu-id="2a7e4-299">Například můžete použít šablonu volitelné prostředky ke konfiguraci jumpbox, která umožňuje nepřímý přístup k prostředí nasazené z veřejného Internetu.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-299">For example, you can use an optional resources template to configure a jumpbox that enables indirect access to a deployed environment from the public Internet.</span></span> <span data-ttu-id="2a7e4-300">Parametr nebo proměnná byste použili k určení, zda by měla být povolená jumpbox a *concat* funkce k sestavení cílová pro danou šablonu, jako například *jumpbox_enabled.json*.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-300">You would use a parameter or variable to identify whether the jumpbox should be enabled and the *concat* function to build the target name for the template, such as *jumpbox_enabled.json*.</span></span> <span data-ttu-id="2a7e4-301">Propojování šablony by proměnnou výsledné použít k instalaci jumpbox.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-301">Template linking would use the resulting variable to install the jumpbox.</span></span>

<span data-ttu-id="2a7e4-302">Můžete propojit šabloně volitelné prostředky z několika míst:</span><span class="sxs-lookup"><span data-stu-id="2a7e4-302">You can link the optional resources template from multiple places:</span></span>

* <span data-ttu-id="2a7e4-303">V případě potřeby pro každé nasazení vytvořte propojení řízené parametry z šablony sdílených prostředků.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-303">When applicable to every deployment, create a parameter-driven link from the shared resources template.</span></span>
* <span data-ttu-id="2a7e4-304">V případě potřeby vyberte známé konfigurace – například nainstalovat pouze na velkých nasazeních – vytvořte odkaz řízené parametr nebo proměnná řízené ze známé konfigurace šablony.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-304">When applicable to select known configurations—for example, only install on large deployments—create a parameter-driven or variable-driven link from the known configuration template.</span></span>

<span data-ttu-id="2a7e4-305">Jestli daný prostředek volitelné nemusí být vycházejí z šablony příjemce ale zprostředkovatelem šablony.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-305">Whether a given resource is optional may not be driven by the template consumer but instead by the template provider.</span></span> <span data-ttu-id="2a7e4-306">Například může potřebovat nesplňuje požadavek na konkrétní produkt nebo doplňkem produktu (společné pro sdílené svazky clusteru) a vynucování zásad (common pro službu SIs a enterprise IT skupiny).</span><span class="sxs-lookup"><span data-stu-id="2a7e4-306">For example, you may need to satisfy a particular product requirement or product add-on (common for CSVs) or to enforce policies (common for SIs and enterprise IT groups).</span></span> <span data-ttu-id="2a7e4-307">Proměnnou v těchto případech můžete použít k určení, zda prostředek by měl být nasazen.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-307">In these cases, you can use a variable to identify whether the resource should be deployed.</span></span>

### <a name="known-configuration-resources-template"></a><span data-ttu-id="2a7e4-308">Známé konfigurace prostředků šablony</span><span class="sxs-lookup"><span data-stu-id="2a7e4-308">Known configuration resources template</span></span>
<span data-ttu-id="2a7e4-309">V šabloně hlavní mohou být zpřístupněny parametr umožnit příjemci šablony zadejte požadovanou známé konfiguraci, kterou chcete nasadit.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-309">In the main template, a parameter can be exposed to allow the template consumer to specify a desired known configuration to deploy.</span></span> <span data-ttu-id="2a7e4-310">Tato známé konfigurace často používá o přístupu velikost tričko s nastavenou velikostí pevné konfigurace, například izolovaného prostoru, malé, střední a velké.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-310">Often, this known configuration uses a t-shirt size approach with a set of fixed configuration sizes such as sandbox, small, medium, and large.</span></span>

![Známé konfigurace prostředků](./media/best-practices-resource-manager-design-templates/known-config.png)

<span data-ttu-id="2a7e4-312">**Známé konfigurace prostředků šablony**</span><span class="sxs-lookup"><span data-stu-id="2a7e4-312">**Known configuration resources template**</span></span>

<span data-ttu-id="2a7e4-313">Přístup velikost tričko se běžně používá, ale parametry může představovat libovolnou sadu známé konfigurace.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-313">The t-shirt size approach is commonly used, but the parameters can represent any set of known configurations.</span></span> <span data-ttu-id="2a7e4-314">Můžete například zadat sadu prostředí pro podniková aplikace například vývoj, testování a produktu.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-314">For example, you can specify a set of environments for an enterprise application such as Development, Test, and Product.</span></span> <span data-ttu-id="2a7e4-315">Nebo můžete použít pro cloudové služby představující jednotky různých škálování, verze produktu nebo konfigurace produktu, jako je například komunity, Developer a Enterprise.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-315">Or you could use it for a cloud service to represent different scale units, product versions, or product configurations such as Community, Developer, or Enterprise.</span></span>

<span data-ttu-id="2a7e4-316">Stejně jako u šabloně sdílený prostředek, jsou buď z proměnné předaný šabloně známé konfigurace:</span><span class="sxs-lookup"><span data-stu-id="2a7e4-316">As with the shared resource template, variables are passed to the known configurations template from either:</span></span>

* <span data-ttu-id="2a7e4-317">Koncový uživatel – to znamená, parametry, které jsou odeslána do hlavní šablony.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-317">An end user—that is, the parameters sent to the main template.</span></span>
* <span data-ttu-id="2a7e4-318">Organizace – to znamená, proměnné v šabloně hlavní představující interní požadavky nebo zásady.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-318">An organization—that is, the variables in the main template that represent internal requirements or policies.</span></span>

### <a name="member-resources-template"></a><span data-ttu-id="2a7e4-319">Člen prostředků šablony</span><span class="sxs-lookup"><span data-stu-id="2a7e4-319">Member resources template</span></span>
<span data-ttu-id="2a7e4-320">V rámci známé konfigurace jsou často jeden nebo více typů člen uzlu zahrnuty.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-320">Within a known configuration, one or more member node types are often included.</span></span> <span data-ttu-id="2a7e4-321">Například s Hadoop máte řídicí uzly a datové uzly.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-321">For example, with Hadoop you have master nodes and data nodes.</span></span> <span data-ttu-id="2a7e4-322">Pokud instalujete MongoDB, máte datové uzly a arbiter.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-322">If you are installing MongoDB, you have data nodes and an arbiter.</span></span> <span data-ttu-id="2a7e4-323">Pokud nasazujete DataStax, máte datové uzly a virtuální počítač s OpsCenter nainstalována.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-323">If you are deploying DataStax, you have data nodes and a VM with OpsCenter installed.</span></span>

![Členové zdroje](./media/best-practices-resource-manager-design-templates/member-resources.png)

<span data-ttu-id="2a7e4-325">**Člen prostředků šablony**</span><span class="sxs-lookup"><span data-stu-id="2a7e4-325">**Member resources template**</span></span>

<span data-ttu-id="2a7e4-326">Každý typ uzlů může mít různé velikosti virtuálních počítačů, počtu připojených disků, skripty, které instalace a nastavení uzly, konfigurace portů pro virtuální počítače, počet instancí a další podrobnosti.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-326">Each type of nodes can have different sizes of VMs, numbers of attached disks, scripts to install and set up the nodes, port configurations for the VMs, number of instances, and other details.</span></span> <span data-ttu-id="2a7e4-327">Takže každý typ uzlu získá svůj vlastní člen prostředku šablony, která obsahuje podrobné informace o nasazení a konfiguraci infrastruktury a také provádění skriptů pro nasazení a konfigurace softwaru v rámci virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-327">So each node type gets its own member resource template, which contains the details for deploying and configuring an infrastructure as well as executing scripts to deploy and configure software within the VM.</span></span>

<span data-ttu-id="2a7e4-328">U virtuálních počítačů jsou obvykle dva typy skripty použité, široce opakovaně použitelný a vlastní skripty.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-328">For VMs, typically two types of scripts are used, widely reusable and custom scripts.</span></span>

### <a name="widely-reusable-scripts"></a><span data-ttu-id="2a7e4-329">Široce opakovaně použitelné skripty</span><span class="sxs-lookup"><span data-stu-id="2a7e4-329">Widely reusable scripts</span></span>
<span data-ttu-id="2a7e4-330">Široce opakovaně použitelné skripty lze napříč více typů šablon.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-330">Widely reusable scripts can be used across multiple types of templates.</span></span> <span data-ttu-id="2a7e4-331">Jeden z lepší příklady tyto skripty široce opakovaně použitelné nastaví RAID v systému Linux fondu disků a získat větší počet IOPS.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-331">One of the better examples of these widely reusable scripts sets up RAID on Linux to pool disks and gain a greater number of IOPS.</span></span> <span data-ttu-id="2a7e4-332">Bez ohledu na software instalován ve virtuálním počítači poskytuje tento skript opakované použití osvědčené postupy pro běžné scénáře.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-332">Regardless of the software being installed in the VM, this script provides reuse of proven practices for common scenarios.</span></span>

![Skriptů pro opakované použití](./media/best-practices-resource-manager-design-templates/reusable-scripts.png)

<span data-ttu-id="2a7e4-334">**Šablony členských prostředků můžete volat široce opakovaně použitelné skripty**</span><span class="sxs-lookup"><span data-stu-id="2a7e4-334">**Member resources templates can call widely reusable scripts**</span></span>

### <a name="custom-scripts"></a><span data-ttu-id="2a7e4-335">Vlastní skripty</span><span class="sxs-lookup"><span data-stu-id="2a7e4-335">Custom scripts</span></span>
<span data-ttu-id="2a7e4-336">Šablony běžně volání jeden nebo více skripty, které instalace a konfigurace softwaru v rámci virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-336">Templates commonly call one or more scripts that install and configure software within VMs.</span></span> <span data-ttu-id="2a7e4-337">Běžný vzor se seznámili s velké topologie, kde jsou nasazeny více instancí jedné nebo více typy členů.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-337">A common pattern is seen with large topologies where multiple instances of one or more member types are deployed.</span></span> <span data-ttu-id="2a7e4-338">Instalační skript se zahájí pro každý virtuální počítač, který může běžet paralelně, za nímž následuje instalační skript, která je volána po všech virtuálních počítačů (nebo všech virtuálních počítačů typu daný člen) jsou nasazeny.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-338">An installation script is initiated for every VM that can be run in parallel, followed by a setup script that is called after all VMs (or all VMs of a given member type) are deployed.</span></span>

![Vlastní skripty](./media/best-practices-resource-manager-design-templates/custom-scripts.png)

<span data-ttu-id="2a7e4-340">**Šablony členských prostředků můžete volat skripty pro specifické účely, například konfigurace virtuálního počítače**</span><span class="sxs-lookup"><span data-stu-id="2a7e4-340">**Member resources templates can call scripts for a specific purpose such as VM configuration**</span></span>

## <a name="capability-scoped-solution-template-example---redis"></a><span data-ttu-id="2a7e4-341">Příklad šablony funkce obor řešení - Redis</span><span class="sxs-lookup"><span data-stu-id="2a7e4-341">Capability-scoped solution template example - Redis</span></span>
<span data-ttu-id="2a7e4-342">Pokud chcete zobrazit, jak mohou fungovat implementace, podíváme se na praktický příklad vytvoření šablony, která usnadňuje nasazení a konfiguraci Redis v standardní tričko velikosti.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-342">To show how an implementation might work, let's look at a practical example of building a template that facilitates the deployment and configuration of Redis in standard t-shirt sizes.</span></span>  

<span data-ttu-id="2a7e4-343">Pro nasazení jsou sadu sdílené prostředky (virtuální sítě, účet úložiště, skupiny dostupnosti) a prostředek volitelné (jumpbox).</span><span class="sxs-lookup"><span data-stu-id="2a7e4-343">For the deployment, there are a set of shared resources (virtual network, storage account, availability sets) and an optional resource (jumpbox).</span></span> <span data-ttu-id="2a7e4-344">Existuje více známé konfigurace vyjádřené tričko velikosti (malé, střední, velký), ale každý do jednoho uzlu zadejte.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-344">There are multiple known configurations represented as t-shirt sizes (small, medium, large) but each with a single node type.</span></span> <span data-ttu-id="2a7e4-345">Existují také dva skripty zaměřené na konkrétní účel (instalace, konfigurace).</span><span class="sxs-lookup"><span data-stu-id="2a7e4-345">There are also two purpose-specific scripts (installation, configuration).</span></span>

### <a name="creating-the-template-files"></a><span data-ttu-id="2a7e4-346">Vytváření soubory šablon</span><span class="sxs-lookup"><span data-stu-id="2a7e4-346">Creating the template files</span></span>
<span data-ttu-id="2a7e4-347">Vytvoříte hlavní šablonu s názvem azuredeploy.json.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-347">You would create a Main Template named azuredeploy.json.</span></span>

<span data-ttu-id="2a7e4-348">Vytvoření sdílené prostředky šablony s názvem sdílené resources.json</span><span class="sxs-lookup"><span data-stu-id="2a7e4-348">You create Shared Resources Template named shared-resources.json</span></span>

<span data-ttu-id="2a7e4-349">Vytvoření šablony umožňující nasazení jumpbox, s názvem jumpbox_enabled.json aplikace volitelné prostředků</span><span class="sxs-lookup"><span data-stu-id="2a7e4-349">You create an Optional Resource Template to enable the deployment of a jumpbox, named jumpbox_enabled.json</span></span>

<span data-ttu-id="2a7e4-350">Redis používá jenom jeden uzel typu, takže vytvoříte jeden šablonu prostředků člen s názvem resources.json uzlu.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-350">Redis uses just a single node type, so you create a single Member Resource Template named node-resources.json.</span></span>

<span data-ttu-id="2a7e4-351">S Redis budete chtít nainstalovat každého jednotlivého uzlu a pak nastavte cluster.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-351">With Redis, you want to install each individual node, and then set up the cluster.</span></span>  <span data-ttu-id="2a7e4-352">Máte skripty k přizpůsobení instalace a nastavení, redis-cluster-install.sh a redis-cluster-setup.sh.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-352">You have scripts to accommodate the installation and set up, redis-cluster-install.sh and redis-cluster-setup.sh.</span></span>

### <a name="linking-the-templates"></a><span data-ttu-id="2a7e4-353">Propojování šablony</span><span class="sxs-lookup"><span data-stu-id="2a7e4-353">Linking the templates</span></span>
<span data-ttu-id="2a7e4-354">Pomocí šablony propojení na hlavní šablonu odkazy na šablony sdílené prostředky, která vytvoří virtuální síť.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-354">Using template linking, the main template links out to the shared resources template, which establishes the virtual network.</span></span>

<span data-ttu-id="2a7e4-355">V rámci hlavní šablony k povolení příjemcům šablony k určení, zda mají být nasazeny jumpbox je přidat logiku.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-355">Logic is added within the main template to enable consumers of the template to specify whether a jumpbox should be deployed.</span></span> <span data-ttu-id="2a7e4-356">*Povoleno* hodnota *EnableJumpbox* parametr označuje, že zákazník chce nasadit jumpbox.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-356">An *enabled* value for the *EnableJumpbox* parameter indicates that the customer wants to deploy a jumpbox.</span></span> <span data-ttu-id="2a7e4-357">Pokud je tato hodnota je zadaný, šablony zřetězí *_enabled* jako přípona názvu základní šablony pro funkci jumpbox.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-357">When this value is provided, the template concatenates *_enabled* as a suffix to a base template name for the jumpbox capability.</span></span>

<span data-ttu-id="2a7e4-358">Hlavní šablona platí *velké* hodnota parametru jako příponu na název základní šablony tričko velikosti a pak používá tuto hodnotu v šabloně odkaz na *technology_on_os_large.json*.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-358">The main template applies the *large* parameter value as a suffix to a base template name for t-shirt sizes, and then uses that value in a template link out to *technology_on_os_large.json*.</span></span>

<span data-ttu-id="2a7e4-359">Topologie by vypadat podobně jako na obrázku.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-359">The topology would resemble this illustration.</span></span>

![Redis šablony](./media/best-practices-resource-manager-design-templates/redis-template.png)

<span data-ttu-id="2a7e4-361">**Struktura šablony pro šablonu Redis**</span><span class="sxs-lookup"><span data-stu-id="2a7e4-361">**Template structure for a Redis template**</span></span>

### <a name="configuring-state"></a><span data-ttu-id="2a7e4-362">Konfigurace stavu</span><span class="sxs-lookup"><span data-stu-id="2a7e4-362">Configuring state</span></span>
<span data-ttu-id="2a7e4-363">Pro uzly v clusteru jsou dva kroky ke konfiguraci stavu, obě reprezentována skriptů pro konkrétní účel.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-363">For the nodes in the cluster, there are two steps to configuring the state, both represented by Purpose Specific Scripts.</span></span>  <span data-ttu-id="2a7e4-364">nainstaluje Redis "redis-cluster-install.sh" a "redis-cluster-setup.sh" nastavuje clusteru.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-364">"redis-cluster-install.sh" installs Redis and "redis-cluster-setup.sh" sets up the cluster.</span></span>

### <a name="supporting-different-size-deployments"></a><span data-ttu-id="2a7e4-365">Podpora nasazení jinou velikost</span><span class="sxs-lookup"><span data-stu-id="2a7e4-365">Supporting Different Size Deployments</span></span>
<span data-ttu-id="2a7e4-366">Uvnitř proměnné, šablona velikost tričko určuje počet uzlů každého typu nasazení pro zadané velikosti (*velké*).</span><span class="sxs-lookup"><span data-stu-id="2a7e4-366">Inside variables, the t-shirt size template specifies the number of nodes of each type to deploy for the specified size (*large*).</span></span> <span data-ttu-id="2a7e4-367">Se pak nasadí počet instancí virtuálního počítače pomocí smyčky prostředků, poskytuje jedinečné názvy k prostředkům připojením název uzlu s číslem číselného pořadí z *copyIndex()*.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-367">It then deploys that number of VM instances using resource loops, providing unique names to resources by appending a node name with a numeric sequence number from *copyIndex()*.</span></span> <span data-ttu-id="2a7e4-368">Provede tyto kroky úrovněmi horkého a záložním zóny virtuálních počítačů, jak jsou definovány v šabloně tričko název</span><span class="sxs-lookup"><span data-stu-id="2a7e4-368">It does these steps for both hot and warm zone VMs, as defined in the t-shirt name template</span></span>

## <a name="decomposition-and-end-to-end-solution-scoped-templates"></a><span data-ttu-id="2a7e4-369">Rozložením a začátku do konce řešení obor šablony</span><span class="sxs-lookup"><span data-stu-id="2a7e4-369">Decomposition and end-to-end solution scoped templates</span></span>
<span data-ttu-id="2a7e4-370">Šablona řešení s oborem začátku do konce řešení se zaměřuje na-komplexní řešení.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-370">A solution template with an end-to-end solution scope is focused on delivering an end-to-end solution.</span></span>  <span data-ttu-id="2a7e4-371">Tento přístup je obvykle složení více šablon funkce obor s další prostředky, logiku a stavu.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-371">This approach is typically a composition of multiple capability-scoped templates with additional resources, logic, and state.</span></span>

<span data-ttu-id="2a7e4-372">Jak je znázorněno na obrázku níže je stejný model používá pro šablony funkce obor rozšířeno pro šablony s oborem řešení začátku do konce.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-372">As highlighted in the image below, the same model used for capability scoped templates is extended for templates with an End-to-End Solution Scope.</span></span>

<span data-ttu-id="2a7e4-373">Sdílené prostředky šablony a volitelné šablony prostředků slouží stejnou funkci jako kapacity a schopností obor přístupy šablony, ale jsou určené pro komplexní řešení.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-373">A Shared Resources Template and Optional Resources Templates serve the same function as in the capacity and capability scoped template approaches, but are scoped for the end to end solution.</span></span>

<span data-ttu-id="2a7e4-374">Jako obor koncová řešení šablony také můžete obvykle mají i tričko velikosti, známé konfigurace prostředků šablony odráží se požaduje pro danou konfiguraci známé řešení.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-374">As end to end solution scoped templates also can typically have t-shirt sizes, the Known Configuration Resources template reflects what is required for a given known configuration of the solution.</span></span>

<span data-ttu-id="2a7e4-375">Známé konfigurace prostředků šablony odkazy na jeden nebo více schopností obor šablony řešení, které jsou relevantní pro komplexní řešení, a také šablony členských prostředků, které jsou požadovány pro komplexní řešení.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-375">The Known Configuration Resources Template links to one or more capability scoped solution templates that are relevant to the end to end solution as well as the Member Resource Templates that are required for the end to end solution.</span></span>

<span data-ttu-id="2a7e4-376">Jako velikost trička řešení může být jiný než jednotlivé funkce obor šablona, proměnné v rámci šablony známé prostředky konfigurace slouží k zadejte odpovídající hodnoty pro podřízené schopností obor řešení šablony Nasaďte odpovídající velikost tričko.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-376">As the t-shirt size of the solution may be different than the individual capability-scoped template, variables within the Known Configuration Resources Template are used to provide the appropriate values for downstream capability scoped solution templates to deploy the appropriate t-shirt size.</span></span>

![Klient server](./media/best-practices-resource-manager-design-templates/end-to-end.png)

<span data-ttu-id="2a7e4-378">**Model použitý pro kapacitu nebo schopnosti obor řešení, které šablony lze snadno rozšířit pro komplexní řešení šablony obory**</span><span class="sxs-lookup"><span data-stu-id="2a7e4-378">**The model used for capacity or capability scoped solution templates can be readily extended for end to end solution template scopes**</span></span>

## <a name="preparing-templates-for-the-marketplace"></a><span data-ttu-id="2a7e4-379">Příprava šablony pro Marketplace.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-379">Preparing templates for the Marketplace</span></span>
<span data-ttu-id="2a7e4-380">Předchozí postup snadno přizpůsobí scénáře, kde podniky, SIs a sdílené svazky clusteru chcete nasazení šablon sami nebo povolit zákazníkům nasadit na své vlastní.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-380">The preceding approach readily accommodates scenarios where Enterprises, SIs, and CSVs want to either deploy the templates themselves or enable their customers to deploy on their own.</span></span>

<span data-ttu-id="2a7e4-381">Jiné potřeby, že je scénář nasazení šablony prostřednictvím marketplace.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-381">Another desired scenario is deploying a template via the marketplace.</span></span>  <span data-ttu-id="2a7e4-382">Tento přístup rozložením funguje pro marketplace taky s menšími změnami.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-382">This decomposition approach works for the marketplace as well, with some minor changes.</span></span>

<span data-ttu-id="2a7e4-383">Jak je uvedeno nahoře, šablony umožňuje nabídnout různých typů pro prodej v marketplace.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-383">As mentioned previously, templates can be used to offer distinct deployment types for sale in the marketplace.</span></span> <span data-ttu-id="2a7e4-384">Typy nasazení DISTINCT může být tričko velikosti (malé, střední, velký), typ produktu nebo cílové skupiny (komunity, developer, enterprise) nebo typ funkce (základní, vysoké dostupnosti).</span><span class="sxs-lookup"><span data-stu-id="2a7e4-384">Distinct deployment types may be t-shirt sizes (small, medium, large), product/audience type (community, developer, enterprise), or feature type (basic, high availability).</span></span>

<span data-ttu-id="2a7e4-385">Jak vidíte níže, existující komplexní řešení nebo šablon funkce obor, můžete snadno použít seznam různých známé konfigurace v marketplace.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-385">As shown below, the existing end to end solution or capability scoped templates can be readily utilized to list the different known configurations in the marketplace.</span></span>

<span data-ttu-id="2a7e4-386">Parametry, které chcete hlavní šablony jsou nejprve upravit tak, aby příchozí parametr s názvem tshirtSize odebrat.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-386">The parameters to the main template are first modified to remove the inbound parameter named tshirtSize.</span></span>

<span data-ttu-id="2a7e4-387">Při různých typů mapovat do šablony známé konfigurace prostředků, potřebují také běžných prostředků a konfigurace v šabloně sdílené prostředky a potenciálně těmi ve volitelné prostředku šablony nalezen.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-387">While the distinct deployment types map to the Known Configuration Resources Template, they also need the common resources and configuration found in the Shared Resources Template and potentially those in Optional Resource Templates.</span></span>

<span data-ttu-id="2a7e4-388">Pokud chcete publikovat šablony na marketplace, můžete vytvořit odlišné kopie vaší hlavní šablony, který nahrazuje parametr dříve k dispozici příchozí tshirtSize proměnné vložených v rámci šablony.</span><span class="sxs-lookup"><span data-stu-id="2a7e4-388">If you want to publish your template to the marketplace, you establish distinct copies of your Main template that replaces the previously available inbound parameter of tshirtSize to a variable embedded within the template.</span></span>

![Marketplace](./media/best-practices-resource-manager-design-templates/marketplace.png)

<span data-ttu-id="2a7e4-390">**Přizpůsobení řešení obor šablonu pro marketplace.**</span><span class="sxs-lookup"><span data-stu-id="2a7e4-390">**Adapting a solution scoped template for the marketplace**</span></span>

## <a name="next-steps"></a><span data-ttu-id="2a7e4-391">Další kroky</span><span class="sxs-lookup"><span data-stu-id="2a7e4-391">Next steps</span></span>
* <span data-ttu-id="2a7e4-392">Další informace o stavu sdílení do a z šablony najdete v tématu [sdílení stavu v šablonách Azure Resource Manager](best-practices-resource-manager-state.md).</span><span class="sxs-lookup"><span data-stu-id="2a7e4-392">To learn about sharing state into and out of templates, see [Sharing state in Azure Resource Manager templates](best-practices-resource-manager-state.md).</span></span>
* <span data-ttu-id="2a7e4-393">Pokyny k tomu, jak můžou podniky používat Resource Manager k efektivní správě předplatných, najdete v části [Základní kostra Azure Enterprise – zásady správného řízení pro předplatná](resource-manager-subscription-governance.md).</span><span class="sxs-lookup"><span data-stu-id="2a7e4-393">For guidance on how enterprises can use Resource Manager to effectively manage subscriptions, see [Azure enterprise scaffold - prescriptive subscription governance](resource-manager-subscription-governance.md).</span></span>

