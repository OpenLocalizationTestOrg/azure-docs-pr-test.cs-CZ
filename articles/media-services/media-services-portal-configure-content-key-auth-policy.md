---
title: "Konfigurace obsahu zásad autorizace pro klíč pomocí portálu Azure | Microsoft Docs"
description: "Zjistěte, jak nakonfigurovat zásady autorizace pro klíč obsahu."
services: media-services
documentationcenter: 
author: juliako
manager: cfowler
editor: 
ms.assetid: ee82a3fa-c34b-48f2-a108-8ba321f1691e
ms.service: media-services
ms.workload: media
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/09/2017
ms.author: juliako
ms.openlocfilehash: 5a35c7255a1c30a693862589c14f6a22a1900790
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/29/2017
---
# <a name="configure-content-key-authorization-policy"></a><span data-ttu-id="4bffb-103">Nakonfigurujte zásady autorizace klíče obsahu</span><span class="sxs-lookup"><span data-stu-id="4bffb-103">Configure Content Key Authorization Policy</span></span>
[!INCLUDE [media-services-selector-content-key-auth-policy](../../includes/media-services-selector-content-key-auth-policy.md)]

## <a name="overview"></a><span data-ttu-id="4bffb-104">Přehled</span><span class="sxs-lookup"><span data-stu-id="4bffb-104">Overview</span></span>
<span data-ttu-id="4bffb-105">Microsoft Azure Media Services umožňuje doručovat datové proudy MPEG-DASH, technologie Smooth Streaming a HTTP-Live-Streaming (HLS) chráněné pomocí Standard AES (Advanced Encryption) (pomocí klíče 128bitové šifrování) nebo [Microsoft PlayReady DRM](https://www.microsoft.com/playready/overview/).</span><span class="sxs-lookup"><span data-stu-id="4bffb-105">Microsoft Azure Media Services enables you to deliver MPEG-DASH, Smooth Streaming, and HTTP-Live-Streaming (HLS) streams protected with Advanced Encryption Standard (AES) (using 128-bit encryption keys) or [Microsoft PlayReady DRM](https://www.microsoft.com/playready/overview/).</span></span> <span data-ttu-id="4bffb-106">AMS také umožňuje doručovat datové proudy DASH šifrované pomocí Widevine DRM.</span><span class="sxs-lookup"><span data-stu-id="4bffb-106">AMS also enables you to deliver DASH streams encrypted with Widevine DRM.</span></span> <span data-ttu-id="4bffb-107">Technologie PlayReady a Widevine jsou šifrované podle specifikace Common Encryption (ISO/IEC CENC 23001-7).</span><span class="sxs-lookup"><span data-stu-id="4bffb-107">Both PlayReady and Widevine are encrypted per the Common Encryption (ISO/IEC 23001-7 CENC) specification.</span></span>

<span data-ttu-id="4bffb-108">Služba Media Services také poskytuje **klíč nebo licenční služby doručení** klienty, kteří mohou získat klíče AES nebo licence PlayReady nebo Widevine přehrávání šifrovaný obsah.</span><span class="sxs-lookup"><span data-stu-id="4bffb-108">Media Services also provides a **Key/License Delivery Service** from which clients can obtain AES keys or PlayReady/Widevine licenses to play the encrypted content.</span></span>

<span data-ttu-id="4bffb-109">Toto téma ukazuje, jak pomocí portálu Azure a nakonfigurujte zásady autorizace klíče obsahu.</span><span class="sxs-lookup"><span data-stu-id="4bffb-109">This topic shows how to use the Azure portal to configure the content key authorization policy.</span></span> <span data-ttu-id="4bffb-110">Klíč lze později dynamicky šifrovat obsah.</span><span class="sxs-lookup"><span data-stu-id="4bffb-110">The key can later be used to dynamically encrypt your content.</span></span> <span data-ttu-id="4bffb-111">Všimněte si, že teď můžete šifrovat následující streamování formáty: HLS, MPEG DASH a technologie Smooth Streaming.</span><span class="sxs-lookup"><span data-stu-id="4bffb-111">Note that currently you can encrypt the following streaming formats: HLS, MPEG DASH, and Smooth Streaming.</span></span> <span data-ttu-id="4bffb-112">Nelze zašifrovat progresivní stahování.</span><span class="sxs-lookup"><span data-stu-id="4bffb-112">You cannot encrypt progressive downloads.</span></span>

<span data-ttu-id="4bffb-113">Když přehrávač vyžádá datový proud, který je nastaven na dynamicky šifrovat, používá služba Media Services nakonfigurovaný klíč dynamicky šifrovat obsah s šifrováním AES nebo DRM.</span><span class="sxs-lookup"><span data-stu-id="4bffb-113">When a player requests a stream that is set to be dynamically encrypted, Media Services uses the configured key to dynamically encrypt your content using AES or DRM encryption.</span></span> <span data-ttu-id="4bffb-114">K dešifrování datového proudu, bude přehrávač požadovat klíč ze služby doručení klíče.</span><span class="sxs-lookup"><span data-stu-id="4bffb-114">To decrypt the stream, the player will request the key from the key delivery service.</span></span> <span data-ttu-id="4bffb-115">Při rozhodování, zda je uživatel oprávnění k získání klíče, služba vyhodnocuje zásady autorizace, které jste zadali pro klíč.</span><span class="sxs-lookup"><span data-stu-id="4bffb-115">To decide whether or not the user is authorized to get the key, the service evaluates the authorization policies that you specified for the key.</span></span>

<span data-ttu-id="4bffb-116">Pokud budete chtít mít několik klíčů obsah nebo chcete zadat **klíč nebo licenční služby doručení** URL než doručení klíče služby Media Services, pomocí sady Media Services .NET SDK nebo rozhraní REST API.</span><span class="sxs-lookup"><span data-stu-id="4bffb-116">If you plan to have multiple content keys or want to specify a **Key/License Delivery Service** URL other than the Media Services key delivery service, use Media Services .NET SDK or REST APIs.</span></span>

[<span data-ttu-id="4bffb-117">Konfigurace obsahu zásad autorizace pro klíč pomocí sady Media Services .NET SDK</span><span class="sxs-lookup"><span data-stu-id="4bffb-117">Configure Content Key Authorization Policy using Media Services .NET SDK</span></span>](media-services-dotnet-configure-content-key-auth-policy.md)

[<span data-ttu-id="4bffb-118">Konfigurace obsahu zásad autorizace pro klíč pomocí Media Services REST API</span><span class="sxs-lookup"><span data-stu-id="4bffb-118">Configure Content Key Authorization Policy using Media Services REST API</span></span>](media-services-rest-configure-content-key-auth-policy.md)

### <a name="some-considerations-apply"></a><span data-ttu-id="4bffb-119">Musí být splněny určité předpoklady:</span><span class="sxs-lookup"><span data-stu-id="4bffb-119">Some considerations apply:</span></span>
* <span data-ttu-id="4bffb-120">Při vytvoření účtu AMS **výchozí** koncový bod streamování je přidána k vašemu účtu v **Zastaveno** stavu.</span><span class="sxs-lookup"><span data-stu-id="4bffb-120">When your AMS account is created a **default** streaming endpoint is added  to your account in the **Stopped** state.</span></span> <span data-ttu-id="4bffb-121">Pokud chcete spustit streamování vašeho obsahu a využít výhod dynamického balení a dynamické šifrování, musí být v koncovém bodu streamování **systémem** stavu.</span><span class="sxs-lookup"><span data-stu-id="4bffb-121">To start streaming your content and take advantage of dynamic packaging and dynamic encryption, your streaming endpoint has to be in the **Running** state.</span></span> 
* <span data-ttu-id="4bffb-122">Váš asset musí obsahovat sadu s adaptivní přenosovou rychlostí soubory MP4 s rychlostmi nebo soubory technologie Smooth Streaming s adaptivní přenosovou rychlostí.</span><span class="sxs-lookup"><span data-stu-id="4bffb-122">Your asset must contain a set of adaptive bitrate MP4s or adaptive bitrate Smooth Streaming files.</span></span> <span data-ttu-id="4bffb-123">Další informace najdete v tématu [kódovat asset](media-services-encode-asset.md).</span><span class="sxs-lookup"><span data-stu-id="4bffb-123">For more information, see [Encode an asset](media-services-encode-asset.md).</span></span>
* <span data-ttu-id="4bffb-124">Službu doručování klíč ukládá do mezipaměti ContentKeyAuthorizationPolicy a související objekty (Možnosti zásad a omezení) pro 15 minut.</span><span class="sxs-lookup"><span data-stu-id="4bffb-124">The Key Delivery service caches ContentKeyAuthorizationPolicy and its related objects (policy options and restrictions) for 15 minutes.</span></span>  <span data-ttu-id="4bffb-125">Pokud vytvoříte ContentKeyAuthorizationPolicy a nastavení, aby používal "Token" omezení, pak otestovat ji a potom aktualizovat zásady "Otevřené" omezení, bude trvat přibližně 15 minut, než zásady přepne do "Otevřené" verze zásad.</span><span class="sxs-lookup"><span data-stu-id="4bffb-125">If you create a ContentKeyAuthorizationPolicy and specify to use a “Token” restriction, then test it, and then update the policy to “Open” restriction, it will take roughly 15 minutes before the policy switches to the “Open” version of the policy.</span></span>

## <a name="how-to-configure-the-key-authorization-policy"></a><span data-ttu-id="4bffb-126">Postupy: Konfigurace zásad autorizace pro klíč</span><span class="sxs-lookup"><span data-stu-id="4bffb-126">How to: configure the key authorization policy</span></span>
<span data-ttu-id="4bffb-127">Konfigurace zásad autorizace pro klíč, vyberte **ochrana obsahu** stránky.</span><span class="sxs-lookup"><span data-stu-id="4bffb-127">To configure the key authorization policy, select the **CONTENT PROTECTION** page.</span></span>

<span data-ttu-id="4bffb-128">Služba Media Services podporuje více způsobů ověřování uživatelů, kteří žádají o klíč.</span><span class="sxs-lookup"><span data-stu-id="4bffb-128">Media Services supports multiple ways of authenticating users who make key requests.</span></span> <span data-ttu-id="4bffb-129">Zásady autorizace klíče obsahu může mít **otevřete**, **tokenu**, nebo **IP** autorizace omezení (**IP** se dá nakonfigurovat s REST nebo .NET SDK).</span><span class="sxs-lookup"><span data-stu-id="4bffb-129">The content key authorization policy can have **open**, **token**, or **IP** authorization restrictions (**IP** can be configured with REST or .NET SDK).</span></span>

### <a name="open-restriction"></a><span data-ttu-id="4bffb-130">Otevřete omezení</span><span class="sxs-lookup"><span data-stu-id="4bffb-130">Open restriction</span></span>
<span data-ttu-id="4bffb-131">**Otevřete** omezení znamená systému dodá klíč všem uživatelům, kteří vytváří klíče požadavek.</span><span class="sxs-lookup"><span data-stu-id="4bffb-131">The **open** restriction means the system will deliver the key to anyone who makes a key request.</span></span> <span data-ttu-id="4bffb-132">Toto omezení může být užitečná pro účely testování.</span><span class="sxs-lookup"><span data-stu-id="4bffb-132">This restriction might be useful for testing purposes.</span></span>

![Funkce OpenPolicy][open_policy]

### <a name="token-restriction"></a><span data-ttu-id="4bffb-134">Omezení s tokenem</span><span class="sxs-lookup"><span data-stu-id="4bffb-134">Token restriction</span></span>
<span data-ttu-id="4bffb-135">Chcete-li vybrat zásady omezení tokenem, stiskněte **TOKENU** tlačítko.</span><span class="sxs-lookup"><span data-stu-id="4bffb-135">To choose the token restricted policy, press the **TOKEN** button.</span></span>

<span data-ttu-id="4bffb-136">**Tokenu** zásady omezení musí být doplněny tokenem vydaným podle **služby tokenů zabezpečení** (STS).</span><span class="sxs-lookup"><span data-stu-id="4bffb-136">The **token** restricted policy must be accompanied by a token issued by a **Secure Token Service** (STS).</span></span> <span data-ttu-id="4bffb-137">Služba Media Services podporuje tokeny ve **jednoduchých webových tokenů** ([SWT](https://msdn.microsoft.com/library/gg185950.aspx#BKMK_2)) formátu a **webových tokenů JSON** formátu (JWT).</span><span class="sxs-lookup"><span data-stu-id="4bffb-137">Media Services supports tokens in the **Simple Web Tokens** ([SWT](https://msdn.microsoft.com/library/gg185950.aspx#BKMK_2)) format and **JSON Web Token** (JWT) format.</span></span> <span data-ttu-id="4bffb-138">Informace najdete v tématu [ověření pomocí tokenu JWT](http://www.gtrifonov.com/2015/01/03/jwt-token-authentication-in-azure-media-services-and-dynamic-encryption/).</span><span class="sxs-lookup"><span data-stu-id="4bffb-138">For information, see [JWT token authentication](http://www.gtrifonov.com/2015/01/03/jwt-token-authentication-in-azure-media-services-and-dynamic-encryption/).</span></span>

<span data-ttu-id="4bffb-139">Služba Media Services neposkytuje **zabezpečení tokenu služby**.</span><span class="sxs-lookup"><span data-stu-id="4bffb-139">Media Services does not provide **Secure Token Services**.</span></span> <span data-ttu-id="4bffb-140">Můžete vytvořit vlastní službu tokenů zabezpečení nebo využívat Microsoft Azure ACS problém tokeny.</span><span class="sxs-lookup"><span data-stu-id="4bffb-140">You can create a custom STS or leverage Microsoft Azure ACS to issue tokens.</span></span> <span data-ttu-id="4bffb-141">Služba tokenů zabezpečení musí být nakonfigurované vytvořit token podepsané zadaný klíč a vystavování deklarací identity, které jste zadali v nastavení omezení s tokenem.</span><span class="sxs-lookup"><span data-stu-id="4bffb-141">The STS must be configured to create a token signed with the specified key and issue claims that you specified in the token restriction configuration.</span></span> <span data-ttu-id="4bffb-142">Doručení klíče služby Media Services bude vrácena klientovi šifrovací klíč, pokud token je platný a deklarace identity v tokenu shodují s těmi, nakonfigurované pro klíč k obsahu.</span><span class="sxs-lookup"><span data-stu-id="4bffb-142">The Media Services key delivery service will return the encryption key to the client if the token is valid and the claims in the token match those configured for the content key.</span></span> <span data-ttu-id="4bffb-143">Další informace najdete v tématu [použití Azure ACS problém tokeny](http://mingfeiy.com/acs-with-key-services).</span><span class="sxs-lookup"><span data-stu-id="4bffb-143">For more information, see [Use Azure ACS to issue tokens](http://mingfeiy.com/acs-with-key-services).</span></span>

<span data-ttu-id="4bffb-144">Při konfiguraci **TOKENU** zásady omezení, musíte nastavit hodnoty pro **ověřovací klíč**, **vystavitele** a **cílovou skupinu**.</span><span class="sxs-lookup"><span data-stu-id="4bffb-144">When configuring the **TOKEN** restricted policy, you must set values for **verification key**, **issuer** and **audience**.</span></span> <span data-ttu-id="4bffb-145">Ověření primární klíč obsahuje klíč, který byl podepsaný token, Vystavitel je zabezpečený tokenu služba, která vydá token.</span><span class="sxs-lookup"><span data-stu-id="4bffb-145">The primary verification key contains the key that the token was signed with, issuer is the secure token service that issues the token.</span></span> <span data-ttu-id="4bffb-146">Cílová skupina (někdy nazývané oboru) popisuje záměr tokenu nebo prostředek token povolí přístup k.</span><span class="sxs-lookup"><span data-stu-id="4bffb-146">The audience (sometimes called scope) describes the intent of the token or the resource the token authorizes access to.</span></span> <span data-ttu-id="4bffb-147">Služba Media Services doručení klíče ověří, jestli tyto hodnoty v tokenu shodují s hodnotami v šabloně.</span><span class="sxs-lookup"><span data-stu-id="4bffb-147">The Media Services key delivery service validates that these values in the token match the values in the template.</span></span>

### <a name="playready"></a><span data-ttu-id="4bffb-148">PlayReady</span><span class="sxs-lookup"><span data-stu-id="4bffb-148">PlayReady</span></span>
<span data-ttu-id="4bffb-149">Při ochraně svůj obsah pomocí **PlayReady**, jednou z věcí, je třeba zadat ve vaší zásady autorizace je řetězec XML, který definuje šablona licence PlayReady.</span><span class="sxs-lookup"><span data-stu-id="4bffb-149">When protecting your content with **PlayReady**, one of the things you need to specify in your authorization policy is an XML string that defines the PlayReady license template.</span></span> <span data-ttu-id="4bffb-150">Ve výchozím nastavení je nastavit tyto zásady:</span><span class="sxs-lookup"><span data-stu-id="4bffb-150">By default, the following policy is set:</span></span>

<span data-ttu-id="4bffb-151"><PlayReadyLicenseResponseTemplate xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/Azure/MediaServices/KeyDelivery/PlayReadyTemplate/v1"><LicenseTemplates> <PlayReadyLicenseTemplate> <AllowTestDevices>true</AllowTestDevices> <ContentKey i:type="ContentEncryptionKeyFromHeader" /> <LicenseType>Nonpersistent</LicenseType> <PlayRight> <AllowPassingVideoContentToUnknownOutput>povolené</AllowPassingVideoContentToUnknownOutput> </PlayRight> </PlayReadyLicenseTemplate> </LicenseTemplates></PlayReadyLicenseResponseTemplate></span><span class="sxs-lookup"><span data-stu-id="4bffb-151"><PlayReadyLicenseResponseTemplate xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/Azure/MediaServices/KeyDelivery/PlayReadyTemplate/v1"> <LicenseTemplates> <PlayReadyLicenseTemplate><AllowTestDevices>true</AllowTestDevices> <ContentKey i:type="ContentEncryptionKeyFromHeader" /> <LicenseType>Nonpersistent</LicenseType> <PlayRight> <AllowPassingVideoContentToUnknownOutput>Allowed</AllowPassingVideoContentToUnknownOutput> </PlayRight> </PlayReadyLicenseTemplate> </LicenseTemplates> </PlayReadyLicenseResponseTemplate></span></span>

<span data-ttu-id="4bffb-152">Můžete kliknout na **importovat zásady xml** tlačítko a zadejte jiný jazyk XML, který vyhovuje na XML schéma definované [zde](media-services-playready-license-template-overview.md).</span><span class="sxs-lookup"><span data-stu-id="4bffb-152">You can click the **import policy xml** button and provide a different XML which conforms to the  XML Schema defined [here](media-services-playready-license-template-overview.md).</span></span>

## <a name="next-step"></a><span data-ttu-id="4bffb-153">Další krok</span><span class="sxs-lookup"><span data-stu-id="4bffb-153">Next step</span></span>
<span data-ttu-id="4bffb-154">Prohlédněte si mapy kurzů k Media Services.</span><span class="sxs-lookup"><span data-stu-id="4bffb-154">Review Media Services learning paths.</span></span>

[!INCLUDE [media-services-learning-paths-include](../../includes/media-services-learning-paths-include.md)]

## <a name="provide-feedback"></a><span data-ttu-id="4bffb-155">Poskytnutí zpětné vazby</span><span class="sxs-lookup"><span data-stu-id="4bffb-155">Provide feedback</span></span>
[!INCLUDE [media-services-user-voice-include](../../includes/media-services-user-voice-include.md)]

[open_policy]: ./media/media-services-portal-configure-content-key-auth-policy/media-services-protect-content-with-open-restriction.png
[token_policy]: ./media/media-services-key-authorization-policy/media-services-protect-content-with-token-restriction.png

