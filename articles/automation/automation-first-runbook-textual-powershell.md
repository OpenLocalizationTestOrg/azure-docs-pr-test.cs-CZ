---
title: "Můj první powershellový runbook v Azure Automation | Dokumentace Microsoftu"
description: "Kurz vás provede vytvořením, otestováním a publikováním jednoduchého powershellového runbooku."
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: 
keywords: "azure powershell, kurz k powershellovému scriptu, automatizace powershellu"
ms.assetid: a43b395a-e740-41a3-ae62-40eac9d0ec00
ms.service: automation
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 03/26/2017
ms.author: magoedte;sngun
ms.openlocfilehash: 4b32011b72acc647d4af44bb5ccbcaab408fb4d6
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 07/11/2017
---
# <a name="my-first-powershell-runbook"></a><span data-ttu-id="b3411-104">Můj první powershellový runbook</span><span class="sxs-lookup"><span data-stu-id="b3411-104">My first PowerShell runbook</span></span>

> [!div class="op_single_selector"]
> * [<span data-ttu-id="b3411-105">Grafický</span><span class="sxs-lookup"><span data-stu-id="b3411-105">Graphical</span></span>](automation-first-runbook-graphical.md)
> * [<span data-ttu-id="b3411-106">PowerShell</span><span class="sxs-lookup"><span data-stu-id="b3411-106">PowerShell</span></span>](automation-first-runbook-textual-powershell.md)
> * [<span data-ttu-id="b3411-107">Pracovní postup PowerShellu</span><span class="sxs-lookup"><span data-stu-id="b3411-107">PowerShell Workflow</span></span>](automation-first-runbook-textual.md)
> 
> 

<span data-ttu-id="b3411-108">V tomto kurzu se seznámíte s vytvořením [powershellového runbooku](automation-runbook-types.md#powershell-runbooks) ve službě Azure Automation.</span><span class="sxs-lookup"><span data-stu-id="b3411-108">This tutorial walks you through the creation of a [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) in Azure Automation.</span></span> <span data-ttu-id="b3411-109">Začneme s jednoduchým runbookem, který společně otestujeme a publikujeme a současně vám vysvětlíme, jak sledovat stav úlohy runbooku.</span><span class="sxs-lookup"><span data-stu-id="b3411-109">We start with a simple runbook that we test and publish while we explain how to track the status of the runbook job.</span></span> <span data-ttu-id="b3411-110">Potom runbook upravíme, aby skutečně spravoval prostředky Azure, v tomto případě virtuální počítač Azure.</span><span class="sxs-lookup"><span data-stu-id="b3411-110">Then we modify the runbook to actually manage Azure resources, in this case starting an Azure virtual machine.</span></span> <span data-ttu-id="b3411-111">Nakonec runbook uděláme robustnější přidáním parametrů.</span><span class="sxs-lookup"><span data-stu-id="b3411-111">Lastly, we make the runbook more robust by adding runbook parameters.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="b3411-112">Požadavky</span><span class="sxs-lookup"><span data-stu-id="b3411-112">Prerequisites</span></span>
<span data-ttu-id="b3411-113">Pro absolvování tohoto kurzu potřebujete:</span><span class="sxs-lookup"><span data-stu-id="b3411-113">To complete this tutorial, you need the following:</span></span>

* <span data-ttu-id="b3411-114">Předplatné Azure.</span><span class="sxs-lookup"><span data-stu-id="b3411-114">Azure subscription.</span></span> <span data-ttu-id="b3411-115">Pokud nemáte účet, můžete si [aktivovat výhody pro předplatitele MSDN](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) nebo <a href="/pricing/free-account/" target="_blank">[si zaregistrovat bezplatný účet](https://azure.microsoft.com/free/).</span><span class="sxs-lookup"><span data-stu-id="b3411-115">If you don't have one yet, you can [activate your MSDN subscriber benefits](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) or <a href="/pricing/free-account/" target="_blank">[sign up for a free account](https://azure.microsoft.com/free/).</span></span>
* <span data-ttu-id="b3411-116">[Účet Automation](automation-sec-configure-azure-runas-account.md), abyste si mohli runbook podržet a mohli ověřovat prostředky Azure.</span><span class="sxs-lookup"><span data-stu-id="b3411-116">[Automation account](automation-sec-configure-azure-runas-account.md) to hold the runbook and authenticate to Azure resources.</span></span>  <span data-ttu-id="b3411-117">Tento účet musí mít oprávnění ke spuštění a zastavení virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="b3411-117">This account must have permission to start and stop the virtual machine.</span></span>
* <span data-ttu-id="b3411-118">Virtuální počítač Azure.</span><span class="sxs-lookup"><span data-stu-id="b3411-118">An Azure virtual machine.</span></span> <span data-ttu-id="b3411-119">Počítač zastavíme a spustíme, proto to nesmí být produkční virtuální počítač.</span><span class="sxs-lookup"><span data-stu-id="b3411-119">We stop and start this machine so it should not be a production VM.</span></span>

## <a name="step-1---create-new-runbook"></a><span data-ttu-id="b3411-120">Krok 1 – vytvoření nového runbooku</span><span class="sxs-lookup"><span data-stu-id="b3411-120">Step 1 - Create new runbook</span></span>
<span data-ttu-id="b3411-121">Začneme vytvořením jednoduchého runbooku, který zobrazí text *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="b3411-121">We'll start by creating a simple runbook that outputs the text *Hello World*.</span></span>

1. <span data-ttu-id="b3411-122">Na webu Azure Portal otevřete účet Automation.</span><span class="sxs-lookup"><span data-stu-id="b3411-122">In the Azure portal, open your Automation account.</span></span>  
   <span data-ttu-id="b3411-123">Stránka účtu Automation nabízí rychlý přehled prostředků v tomto účtu.</span><span class="sxs-lookup"><span data-stu-id="b3411-123">The Automation account page gives you a quick view of the resources in this account.</span></span> <span data-ttu-id="b3411-124">Už byste tam měli mít nějaké prostředky.</span><span class="sxs-lookup"><span data-stu-id="b3411-124">You should already have some assets.</span></span> <span data-ttu-id="b3411-125">Většina z nich jsou moduly, které jsou automaticky obsažené v novém účtu Automation.</span><span class="sxs-lookup"><span data-stu-id="b3411-125">Most of those are the modules that are automatically included in a new Automation account.</span></span> <span data-ttu-id="b3411-126">Také potřebujete asset přihlašovacích údajů, který je uvedený v [požadavcích](#prerequisites).</span><span class="sxs-lookup"><span data-stu-id="b3411-126">You should also have the Credential asset that's mentioned in the [prerequisites](#prerequisites).</span></span>
2. <span data-ttu-id="b3411-127">Kliknutím na dlaždici **Runbooky** otevřete seznam runbooků.</span><span class="sxs-lookup"><span data-stu-id="b3411-127">Click the **Runbooks** tile to open the list of runbooks.</span></span><br><br> <span data-ttu-id="b3411-128">![RunbooksControl](media/automation-first-runbook-textual-powershell/runbooks-control-tiles.png)</span><span class="sxs-lookup"><span data-stu-id="b3411-128">![RunbooksControl](media/automation-first-runbook-textual-powershell/runbooks-control-tiles.png)</span></span>  
3. <span data-ttu-id="b3411-129">Kliknutím na tlačítko **Přidat runbook** a potom na **Vytvořit nový runbook** vytvořte nový runbook.</span><span class="sxs-lookup"><span data-stu-id="b3411-129">Create a new runbook by clicking the **Add a runbook** button and then **Create a new runbook**.</span></span>
4. <span data-ttu-id="b3411-130">Dejte runbooku název *MyFirstRunbook-PowerShell*.</span><span class="sxs-lookup"><span data-stu-id="b3411-130">Give the runbook the name *MyFirstRunbook-PowerShell*.</span></span>
5. <span data-ttu-id="b3411-131">V tomto případě vytvoříme [powershellový runbook](automation-runbook-types.md#powershell-runbooks), proto jako **Typ runbooku** vyberte **PowerShell**.</span><span class="sxs-lookup"><span data-stu-id="b3411-131">In this case, we're going to create a [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) so select **Powershell** for **Runbook type**.</span></span><br><br> <span data-ttu-id="b3411-132">![Typ runbooku](media/automation-first-runbook-textual-powershell/automation-runbook-type.png)</span><span class="sxs-lookup"><span data-stu-id="b3411-132">![Runbook Type](media/automation-first-runbook-textual-powershell/automation-runbook-type.png)</span></span>  
6. <span data-ttu-id="b3411-133">Kliknutím na **Vytvořit** vytvoříte runbook a otevřete textový editor.</span><span class="sxs-lookup"><span data-stu-id="b3411-133">Click **Create** to create the runbook and open the textual editor.</span></span>

## <a name="step-2---add-code-to-the-runbook"></a><span data-ttu-id="b3411-134">Krok 2 – přidání kódu do runbooku</span><span class="sxs-lookup"><span data-stu-id="b3411-134">Step 2 - Add code to the runbook</span></span>
<span data-ttu-id="b3411-135">Kód můžete buď zadat přímo do runbooku, nebo můžete vybrat rutiny, runbooky a assety z ovládacího prvku Knihovna a přidat je do runbooku spolu se všemi souvisejícími parametry.</span><span class="sxs-lookup"><span data-stu-id="b3411-135">You can either type code directly into the runbook, or you can select cmdlets, runbooks, and assets from the Library control and have them added to the runbook with any related parameters.</span></span> <span data-ttu-id="b3411-136">V tomto návodu budeme zapisovat přímo do runbooku.</span><span class="sxs-lookup"><span data-stu-id="b3411-136">For this walkthrough, we type directly in the runbook.</span></span>

1. <span data-ttu-id="b3411-137">Náš runbook je aktuálně prázdný, zadejte text *Write-Output "Hello World"*.</span><span class="sxs-lookup"><span data-stu-id="b3411-137">Our runbook is currently empty, type *Write-Output "Hello World."*.</span></span><br><br> <span data-ttu-id="b3411-138">![Hello World](media/automation-first-runbook-textual-powershell/automation-helloworld.png)</span><span class="sxs-lookup"><span data-stu-id="b3411-138">![Hello World](media/automation-first-runbook-textual-powershell/automation-helloworld.png)</span></span>  
2. <span data-ttu-id="b3411-139">Kliknutím na **Uložit** runbook uložte.</span><span class="sxs-lookup"><span data-stu-id="b3411-139">Save the runbook by clicking **Save**.</span></span><br><br> <span data-ttu-id="b3411-140">![Tlačítko Uložit](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-save.png)</span><span class="sxs-lookup"><span data-stu-id="b3411-140">![Save Button](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-save.png)</span></span>  

## <a name="step-3---test-the-runbook"></a><span data-ttu-id="b3411-141">Krok 3 – otestování runbooku</span><span class="sxs-lookup"><span data-stu-id="b3411-141">Step 3 - Test the runbook</span></span>
<span data-ttu-id="b3411-142">Před publikováním runbooku, které ho zpřístupní v produkčním prostředí, chceme runbook otestovat a ujistit se, že bude fungovat správně.</span><span class="sxs-lookup"><span data-stu-id="b3411-142">Before we publish the runbook to make it available in production, we want to test it to make sure that it works properly.</span></span> <span data-ttu-id="b3411-143">Když runbook testujete, spustíte jeho  verzi **Koncept** a interaktivně zobrazíte jeho výsledek.</span><span class="sxs-lookup"><span data-stu-id="b3411-143">When you test a runbook, you run its **Draft** version and view its output interactively.</span></span>

1. <span data-ttu-id="b3411-144">Kliknutím na **Testovací podokno** otevřete testovací podokno.</span><span class="sxs-lookup"><span data-stu-id="b3411-144">Click **Test pane** to open the Test pane.</span></span><br><br> <span data-ttu-id="b3411-145">![Testovací podokno](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-test.png)</span><span class="sxs-lookup"><span data-stu-id="b3411-145">![Test Pane](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-test.png)</span></span>  
2. <span data-ttu-id="b3411-146">Kliknutím na **Spustit** spustíte test.</span><span class="sxs-lookup"><span data-stu-id="b3411-146">Click **Start** to start the test.</span></span> <span data-ttu-id="b3411-147">Měla by to být jediná povolená možnost.</span><span class="sxs-lookup"><span data-stu-id="b3411-147">This should be the only enabled option.</span></span>
3. <span data-ttu-id="b3411-148">Vytvoří se [úloha runbooku](automation-runbook-execution.md) a její stav se zobrazí.</span><span class="sxs-lookup"><span data-stu-id="b3411-148">A [runbook job](automation-runbook-execution.md) is created and its status displayed.</span></span>  
   <span data-ttu-id="b3411-149">Počáteční stav úlohy bude *Zařazeno ve frontě*. To označuje, že čekáte na zpřístupnění pracovního procesu runbooku v cloudu.</span><span class="sxs-lookup"><span data-stu-id="b3411-149">The job status starts as *Queued* indicating that it is waiting for a runbook worker in the cloud to come available.</span></span> <span data-ttu-id="b3411-150">Když pracovní proces úlohu přijme, změní se stav na *Spouštění*, a když se runbook skutečně spustí, změní se na *Spuštěno*.</span><span class="sxs-lookup"><span data-stu-id="b3411-150">It will then move to *Starting* when a worker claims the job, and then *Running* when the runbook actually starts running.</span></span>  
4. <span data-ttu-id="b3411-151">Po dokončení úlohy runbooku se zobrazí jeho výstup.</span><span class="sxs-lookup"><span data-stu-id="b3411-151">When the runbook job completes, its output is displayed.</span></span> <span data-ttu-id="b3411-152">V našem případě bychom měli vidět text *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="b3411-152">In our case, we should see *Hello World*.</span></span><br><br> <span data-ttu-id="b3411-153">![Výstup testovacího podokna](media/automation-first-runbook-textual-powershell/automation-testpane-output.png)</span><span class="sxs-lookup"><span data-stu-id="b3411-153">![Test Pane Output](media/automation-first-runbook-textual-powershell/automation-testpane-output.png)</span></span>  
5. <span data-ttu-id="b3411-154">Zavřete testovací podokno a vraťte se na plátno.</span><span class="sxs-lookup"><span data-stu-id="b3411-154">Close the Test pane to return to the canvas.</span></span>

## <a name="step-4---publish-and-start-the-runbook"></a><span data-ttu-id="b3411-155">Krok 4 – publikování a spuštění runbooku</span><span class="sxs-lookup"><span data-stu-id="b3411-155">Step 4 - Publish and start the runbook</span></span>
<span data-ttu-id="b3411-156">Vytvořený runbook je stále v režimu konceptu.</span><span class="sxs-lookup"><span data-stu-id="b3411-156">The runbook that we created is still in Draft mode.</span></span> <span data-ttu-id="b3411-157">Před jeho spuštěním v produkčním prostředí ho musíme publikovat.</span><span class="sxs-lookup"><span data-stu-id="b3411-157">We need to publish it before we can run it in production.</span></span>  <span data-ttu-id="b3411-158">Když runbook publikujete, přepíšete vydanou verzi verzí v režimu konceptu.</span><span class="sxs-lookup"><span data-stu-id="b3411-158">When you publish a runbook, you overwrite the existing Published version with the Draft version.</span></span>  <span data-ttu-id="b3411-159">V našem případě zatím ještě publikovanou verzi nemáme, protože jsme runbook teprve vytvořili.</span><span class="sxs-lookup"><span data-stu-id="b3411-159">In our case, we don't have a Published version yet because we just created the runbook.</span></span>

1. <span data-ttu-id="b3411-160">Kliknutím na **Publikovat** runbook publikujte a po zobrazení výzvy klikněte na **Ano**.</span><span class="sxs-lookup"><span data-stu-id="b3411-160">Click **Publish** to publish the runbook and then **Yes** when prompted.</span></span><br><br> <span data-ttu-id="b3411-161">![Tlačítko Publikovat](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-publish.png)</span><span class="sxs-lookup"><span data-stu-id="b3411-161">![Publish button](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-publish.png)</span></span>  
2. <span data-ttu-id="b3411-162">Pokud se posunete doleva, abyste runbook viděli v podokně **Runbooky**, zobrazí se **Stav vytváření**, který má hodnotu **Publikováno**.</span><span class="sxs-lookup"><span data-stu-id="b3411-162">If you scroll left to view the runbook in the **Runbooks** pane now, it will show an **Authoring Status** of **Published**.</span></span>
3. <span data-ttu-id="b3411-163">Posuňte se zpět doprava, abyste viděli podokno **MyFirstRunbook-PowerShell**.</span><span class="sxs-lookup"><span data-stu-id="b3411-163">Scroll back to the right to view the pane for **MyFirstRunbook-PowerShell**.</span></span>  
   <span data-ttu-id="b3411-164">Možnosti v horní části nám umožňují spuštění runbooku, zobrazení runbooku, naplánování jeho spuštění někdy v budoucnu nebo vytvoření [webhooku](automation-webhooks.md), který umožní spuštění prostřednictvím volání protokolu HTTP.</span><span class="sxs-lookup"><span data-stu-id="b3411-164">The options across the top allow us to start the runbook, view the runbook, schedule it to start at some time in the future, or create a [webhook](automation-webhooks.md) so it can be started through an HTTP call.</span></span>
4. <span data-ttu-id="b3411-165">My chceme runbook spustit, proto klikněte na **Spustit** a po otevření okna Spuštění runbooku klikněte na **OK**.</span><span class="sxs-lookup"><span data-stu-id="b3411-165">We want to start the runbook, so click **Start** and then click **Ok** when the Start Runbook blade opens.</span></span><br><br> <span data-ttu-id="b3411-166">![Tlačítko Spustit](media/automation-first-runbook-textual-powershell/automation-runbook-controls-start.png)</span><span class="sxs-lookup"><span data-stu-id="b3411-166">![Start button](media/automation-first-runbook-textual-powershell/automation-runbook-controls-start.png)</span></span><br>    
5. <span data-ttu-id="b3411-167">Podokno úlohy runbooku, který jsme vytvořili, je otevřené.</span><span class="sxs-lookup"><span data-stu-id="b3411-167">A job pane is opened for the runbook job that we created.</span></span> <span data-ttu-id="b3411-168">Toto podokno můžeme zavřít, ale v tomto případě ho necháme otevřené, abychom mohli sledovat průběh úlohy.</span><span class="sxs-lookup"><span data-stu-id="b3411-168">We can close this pane, but in this case we leave it open so we can watch the job's progress.</span></span>
6. <span data-ttu-id="b3411-169">Stav úlohy se zobrazuje v **souhrnu úlohy** a odpovídá stavům, které jsme viděli při testování runbooku.</span><span class="sxs-lookup"><span data-stu-id="b3411-169">The job status is shown in **Job Summary** and matches the statuses that we saw when we tested the runbook.</span></span><br><br> <span data-ttu-id="b3411-170">![Souhrn úlohy](media/automation-first-runbook-textual-powershell/job-pane-status-blade-jobsummary.png)</span><span class="sxs-lookup"><span data-stu-id="b3411-170">![Job Summary](media/automation-first-runbook-textual-powershell/job-pane-status-blade-jobsummary.png)</span></span><br>  
7. <span data-ttu-id="b3411-171">Když se jako stav runbooku zobrazí *Dokončeno*, klikněte na **Výstup**.</span><span class="sxs-lookup"><span data-stu-id="b3411-171">Once the runbook status shows *Completed*, click **Output**.</span></span> <span data-ttu-id="b3411-172">Otevře se podokno Výstup a my uvidíme text *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="b3411-172">The Output pane is opened, and we can see our *Hello World*.</span></span><br><br> <span data-ttu-id="b3411-173">![Výstup úlohy](media/automation-first-runbook-textual-powershell/job-pane-status-blade-outputtile.png)</span><span class="sxs-lookup"><span data-stu-id="b3411-173">![Job Output](media/automation-first-runbook-textual-powershell/job-pane-status-blade-outputtile.png)</span></span><br> 
8. <span data-ttu-id="b3411-174">Zavřete podokno Výstup.</span><span class="sxs-lookup"><span data-stu-id="b3411-174">Close the Output pane.</span></span>
9. <span data-ttu-id="b3411-175">Klikněte na **Všechny protokoly** a otevřete podokno Datové proudy, které patří k úloze runbooku.</span><span class="sxs-lookup"><span data-stu-id="b3411-175">Click **All Logs** to open the Streams pane for the runbook job.</span></span> <span data-ttu-id="b3411-176">Ve výstupu datového proudu byste měli vidět jenom text *Hello World*, ale můžou se zobrazit i jiné datové proudy z úlohy runbooku, například Podrobný nebo Chyba, pokud do nich runbook zapisuje.</span><span class="sxs-lookup"><span data-stu-id="b3411-176">We should only see *Hello World* in the output stream, but this can show other streams for a runbook job such as Verbose and Error if the runbook writes to them.</span></span><br><br> <span data-ttu-id="b3411-177">![Všechny protokoly](media/automation-first-runbook-textual-powershell/job-pane-status-blade-alllogstile.png)</span><span class="sxs-lookup"><span data-stu-id="b3411-177">![All Logs](media/automation-first-runbook-textual-powershell/job-pane-status-blade-alllogstile.png)</span></span><br>   
10. <span data-ttu-id="b3411-178">Zavřete podokno Datové proudy a podokno Úloha a vraťte se do podokna MyFirstRunbook-PowerShell.</span><span class="sxs-lookup"><span data-stu-id="b3411-178">Close the Streams pane and the Job pane to return to the MyFirstRunbook-PowerShell pane.</span></span>
11. <span data-ttu-id="b3411-179">Kliknutím na **Úlohy** otevřete podokno Úlohy, které patří k tomuto runbooku.</span><span class="sxs-lookup"><span data-stu-id="b3411-179">Click **Jobs** to open the Jobs pane for this runbook.</span></span> <span data-ttu-id="b3411-180">Vypíšou se všechny úlohy, které tento runbook vytvořil.</span><span class="sxs-lookup"><span data-stu-id="b3411-180">This lists all of the jobs created by this runbook.</span></span> <span data-ttu-id="b3411-181">Tady bychom měli vidět jenom jednu úlohu, protože jsme ji spustili jenom jednou.</span><span class="sxs-lookup"><span data-stu-id="b3411-181">We should only see one job listed since we only ran the job once.</span></span><br><br> <span data-ttu-id="b3411-182">![Seznam úloh](media/automation-first-runbook-textual-powershell/runbook-control-job-tile.png)</span><span class="sxs-lookup"><span data-stu-id="b3411-182">![Job List](media/automation-first-runbook-textual-powershell/runbook-control-job-tile.png)</span></span>  
12. <span data-ttu-id="b3411-183">Na tuto úlohu můžete kliknout a otevřít podokno Úloha, které jsme zobrazili při spuštění runbooku.</span><span class="sxs-lookup"><span data-stu-id="b3411-183">You can click this job to open the same Job pane that we viewed when we started the runbook.</span></span> <span data-ttu-id="b3411-184">Pomocí této možnosti se můžete vrátit v čase a zobrazit si podrobnosti libovolné úlohy, která byla pro konkrétní runbook vytvořena.</span><span class="sxs-lookup"><span data-stu-id="b3411-184">This allows you to go back in time and view the details of any job that was created for a particular runbook.</span></span>

## <a name="step-5---add-authentication-to-manage-azure-resources"></a><span data-ttu-id="b3411-185">Krok 5 – přidání ověřování ke správě prostředků Azure</span><span class="sxs-lookup"><span data-stu-id="b3411-185">Step 5 - Add authentication to manage Azure resources</span></span>
<span data-ttu-id="b3411-186">Runbook jsme otestovali a publikovali, ale zatím nedělá nic užitečného.</span><span class="sxs-lookup"><span data-stu-id="b3411-186">We've tested and published our runbook, but so far it doesn't do anything useful.</span></span> <span data-ttu-id="b3411-187">Chceme po něm, aby spravoval prostředky Azure.</span><span class="sxs-lookup"><span data-stu-id="b3411-187">We want to have it manage Azure resources.</span></span> <span data-ttu-id="b3411-188">To nebude umět, pokud mu neumožníme ověřování pomocí přihlašovacích údajů, které jsou uvedené v [požadavcích](#prerequisites).</span><span class="sxs-lookup"><span data-stu-id="b3411-188">It won't be able to do that though unless we have it authenticate using the credentials that are referred to in the [prerequisites](#prerequisites).</span></span> <span data-ttu-id="b3411-189">Provedeme to pomocí rutiny **Add-AzureRmAccount**.</span><span class="sxs-lookup"><span data-stu-id="b3411-189">We do that with the **Add-AzureRmAccount** cmdlet.</span></span>

1. <span data-ttu-id="b3411-190">Kliknutím na **Upravit** v podokně MyFirstRunbook-PowerShell otevřete textový editor.</span><span class="sxs-lookup"><span data-stu-id="b3411-190">Open the textual editor by clicking **Edit** on the MyFirstRunbook-PowerShell pane.</span></span><br><br> <span data-ttu-id="b3411-191">![Úprava runbooku](media/automation-first-runbook-textual-powershell/automation-runbook-controls-edit.png)</span><span class="sxs-lookup"><span data-stu-id="b3411-191">![Edit Runbook](media/automation-first-runbook-textual-powershell/automation-runbook-controls-edit.png)</span></span><br>   
2. <span data-ttu-id="b3411-192">Řádek **Write-Output** už nepotřebujeme, takže ho teď můžete odstranit.</span><span class="sxs-lookup"><span data-stu-id="b3411-192">We don't need the **Write-Output** line anymore, so go ahead and delete it.</span></span>
3. <span data-ttu-id="b3411-193">Zadejte nebo zkopírujte a vložte následující kód, který bude zpracovávat ověřování pomocí vašeho účtu Automation Spustit jako:</span><span class="sxs-lookup"><span data-stu-id="b3411-193">Type or copy and paste the following code that handles the authentication with your Automation Run As account:</span></span>
   
   ```
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID `
   -ApplicationId $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   ```
   <br>
4. <span data-ttu-id="b3411-194">Klikněte na **testovací podokno**, abychom mohli runbook otestovat.</span><span class="sxs-lookup"><span data-stu-id="b3411-194">Click **Test pane** so that we can test the runbook.</span></span>
5. <span data-ttu-id="b3411-195">Kliknutím na **Spustit** spustíte test.</span><span class="sxs-lookup"><span data-stu-id="b3411-195">Click **Start** to start the test.</span></span> <span data-ttu-id="b3411-196">Po dokončení byste měli obdržet výstup podobný následujícímu se základními informacemi z vašeho účtu.</span><span class="sxs-lookup"><span data-stu-id="b3411-196">Once it completes, you should receive output similar to the following, displaying basic information from your account.</span></span> <span data-ttu-id="b3411-197">Tím se potvrdí platnost přihlašovacích údajů.</span><span class="sxs-lookup"><span data-stu-id="b3411-197">This confirms that the credential is valid.</span></span><br><br> <span data-ttu-id="b3411-198">![Ověření](media/automation-first-runbook-textual-powershell/runbook-auth-output.png)</span><span class="sxs-lookup"><span data-stu-id="b3411-198">![Authenticate](media/automation-first-runbook-textual-powershell/runbook-auth-output.png)</span></span>

## <a name="step-6---add-code-to-start-a-virtual-machine"></a><span data-ttu-id="b3411-199">Krok 6 – přidání kódu pro spuštění virtuálního počítače</span><span class="sxs-lookup"><span data-stu-id="b3411-199">Step 6 - Add code to start a virtual machine</span></span>
<span data-ttu-id="b3411-200">Teď, když runbook umí ověřit naše předplatné Azure, můžeme začít spravovat prostředky.</span><span class="sxs-lookup"><span data-stu-id="b3411-200">Now that our runbook is authenticating to our Azure subscription, we can manage resources.</span></span> <span data-ttu-id="b3411-201">Přidáme příkaz ke spuštění virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="b3411-201">We add a command to start a virtual machine.</span></span> <span data-ttu-id="b3411-202">V rámci vašeho předplatného Azure můžete vybrat jakýkoli virtuální počítač, ale prozatím jeho název v runbooku pevně zakódujeme.</span><span class="sxs-lookup"><span data-stu-id="b3411-202">You can pick any virtual machine in your Azure subscription, and for now we will hardcode that name in the runbook.</span></span>

1. <span data-ttu-id="b3411-203">Po *Add-AzureRmAccount* zadejte *Start-AzureRmVM -Name 'VMName' -ResourceGroupName 'NameofResourceGroup'* a nezapomeňte zadat název a název skupiny prostředků virtuálního počítače, který chcete spustit.</span><span class="sxs-lookup"><span data-stu-id="b3411-203">After *Add-AzureRmAccount*, type *Start-AzureRmVM -Name 'VMName' -ResourceGroupName 'NameofResourceGroup'* providing the name and Resource Group name of the virtual machine to start.</span></span>  
   
   ```
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID `
   -ApplicationID $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   Start-AzureRmVM -Name 'VMName' -ResourceGroupName 'ResourceGroupName'
   ```
   <br>
2. <span data-ttu-id="b3411-204">Uložte runbook a klikněte na **testovací podokno**, abychom mohli runbook otestovat.</span><span class="sxs-lookup"><span data-stu-id="b3411-204">Save the runbook and then click **Test pane** so that we can test it.</span></span>
3. <span data-ttu-id="b3411-205">Kliknutím na **Spustit** spustíte test.</span><span class="sxs-lookup"><span data-stu-id="b3411-205">Click **Start** to start the test.</span></span> <span data-ttu-id="b3411-206">Po jeho dokončení zkontrolujte, jestli se virtuální počítač spustil.</span><span class="sxs-lookup"><span data-stu-id="b3411-206">Once it completes, check that the virtual machine was started.</span></span>

## <a name="step-7---add-an-input-parameter-to-the-runbook"></a><span data-ttu-id="b3411-207">Krok 7 – přidání vstupního parametru do runbooku</span><span class="sxs-lookup"><span data-stu-id="b3411-207">Step 7 - Add an input parameter to the runbook</span></span>
<span data-ttu-id="b3411-208">Náš runbook aktuálně spouští virtuální počítač, který jsme do něj pevně zakódovali, ale bylo by užitečnější, pokud bychom virtuální počítač zadali při spuštění runbooku.</span><span class="sxs-lookup"><span data-stu-id="b3411-208">Our runbook currently starts the virtual machine that we hardcoded in the runbook, but it would be more useful if we specify the virtual machine when the runbook is started.</span></span> <span data-ttu-id="b3411-209">Teď do runbooku přidáme vstupní parametry, které tuto funkci zajistí.</span><span class="sxs-lookup"><span data-stu-id="b3411-209">We will now add input parameters to the runbook to provide that functionality.</span></span>

1. <span data-ttu-id="b3411-210">Přidejte do runbooku parametry pro *VMName* a *ResourceGroupName* a použijte tyto proměnné s rutinou **Start-AzureRmVM**, jak vidíte na níže uvedeném příkladu.</span><span class="sxs-lookup"><span data-stu-id="b3411-210">Add parameters for *VMName* and *ResourceGroupName* to the runbook and use these variables with the **Start-AzureRmVM** cmdlet as in the example below.</span></span>  
   
   ```
   Param(
    [string]$VMName,
    [string]$ResourceGroupName
   )
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID `
   -ApplicationID $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   Start-AzureRmVM -Name $VMName -ResourceGroupName $ResourceGroupName
   ```
   <br>
2. <span data-ttu-id="b3411-211">Uložte runbook a otevřete testovací podokno.</span><span class="sxs-lookup"><span data-stu-id="b3411-211">Save the runbook and open the Test pane.</span></span> <span data-ttu-id="b3411-212">Teď můžete zadat hodnoty dvou vstupních proměnných, které budete v testu používat.</span><span class="sxs-lookup"><span data-stu-id="b3411-212">You can now provide values for the two input variables that are used in the test.</span></span>
3. <span data-ttu-id="b3411-213">Zavřete testovací podokno.</span><span class="sxs-lookup"><span data-stu-id="b3411-213">Close the Test pane.</span></span>
4. <span data-ttu-id="b3411-214">Kliknutím na **Publikovat** publikujte novou verzi runbooku.</span><span class="sxs-lookup"><span data-stu-id="b3411-214">Click **Publish** to publish the new version of the runbook.</span></span>
5. <span data-ttu-id="b3411-215">Zastavte virtuální počítač, který jste v předchozím kroku spustili.</span><span class="sxs-lookup"><span data-stu-id="b3411-215">Stop the virtual machine that you started in the previous step.</span></span>
6. <span data-ttu-id="b3411-216">Kliknutím na **Spustit** spustíte runbook.</span><span class="sxs-lookup"><span data-stu-id="b3411-216">Click **Start** to start the runbook.</span></span> <span data-ttu-id="b3411-217">Zadejte **VMName** a **ResourceGroupName** pro virtuální počítač, který chcete spustit.</span><span class="sxs-lookup"><span data-stu-id="b3411-217">Type in the **VMName** and **ResourceGroupName** for the virtual machine that you're going to start.</span></span><br><br> <span data-ttu-id="b3411-218">![Předání parametru](media/automation-first-runbook-textual-powershell/automation-pass-params.png)</span><span class="sxs-lookup"><span data-stu-id="b3411-218">![Pass Parameter](media/automation-first-runbook-textual-powershell/automation-pass-params.png)</span></span><br>  
7. <span data-ttu-id="b3411-219">Po dokončení runbooku zkontrolujte, jestli se virtuální počítač spustil.</span><span class="sxs-lookup"><span data-stu-id="b3411-219">When the runbook completes, check that the virtual machine was started.</span></span>

## <a name="differences-from-powershell-workflow"></a><span data-ttu-id="b3411-220">Odlišnosti od runbooků pracovních postupů PowerShellu</span><span class="sxs-lookup"><span data-stu-id="b3411-220">Differences from PowerShell Workflow</span></span>
<span data-ttu-id="b3411-221">Powershellové runbooky mají stejný životní cyklus, možnosti a správu jako runbooky pracovních postupů PowerShellu, ale existují tady určité rozdíly a omezení:</span><span class="sxs-lookup"><span data-stu-id="b3411-221">PowerShell runbooks have the same lifecycle, capabilities, and management as PowerShell Workflow runbooks but there are some differences and limitations:</span></span>

1. <span data-ttu-id="b3411-222">Powershellové runbooky běží rychleji než runbooky pracovních postupů PowerShellu, protože neobsahují kompilační krok.</span><span class="sxs-lookup"><span data-stu-id="b3411-222">PowerShell runbooks run fast compared to PowerShell Workflow runbooks as they don’t have compilation step.</span></span>
2. <span data-ttu-id="b3411-223">Runbooky pracovních postupů PowerShellu podporují kontrolní body. Pomocí kontrolních bodů můžou runbooky pracovních postupů PowerShellu pokračovat z libovolného bodu v runbooku, zatímco powershellové runbooky můžou pokračovat jenom od začátku.</span><span class="sxs-lookup"><span data-stu-id="b3411-223">PowerShell Workflow runbooks support checkpoints, using checkpoints, PowerShell Workflow runbooks can resume from any point in the runbook whereas PowerShell runbooks can only resume from the beginning.</span></span>
3. <span data-ttu-id="b3411-224">Runbooky pracovních postupů PowerShellu podporují paralelní a sériové provádění, zatímco powershellové runbooky můžou příkazy provádět jenom sériově.</span><span class="sxs-lookup"><span data-stu-id="b3411-224">PowerShell Workflow runbooks support parallel and serial execution whereas PowerShell runbooks can only execute commands serially.</span></span>
4. <span data-ttu-id="b3411-225">V runboocích pracovních postupů PowerShellu může mít aktivita, příkaz nebo blok skriptu svoje vlastní prostředí runspace, zatímco v powershellovém runbooku běží všechno ve skriptu v jednom prostředí runspace.</span><span class="sxs-lookup"><span data-stu-id="b3411-225">In a PowerShell Workflow runbook, an activity, a command, or a script block can have its own runspace whereas in a PowerShell runbook, everything in a script runs in a single runspace.</span></span> <span data-ttu-id="b3411-226">Existují také určité [syntaktické rozdíly](https://technet.microsoft.com/magazine/dn151046.aspx) mezi nativním powershellovým runbookem a runbookem pracovního postupu PowerShellu.</span><span class="sxs-lookup"><span data-stu-id="b3411-226">There are also some [syntactic differences](https://technet.microsoft.com/magazine/dn151046.aspx) between a native PowerShell runbook and a PowerShell Workflow runbook.</span></span>

## <a name="next-steps"></a><span data-ttu-id="b3411-227">Další kroky</span><span class="sxs-lookup"><span data-stu-id="b3411-227">Next steps</span></span>
* <span data-ttu-id="b3411-228">První kroky s grafickými runbooky najdete v článku [Můj první grafický runbook](automation-first-runbook-graphical.md).</span><span class="sxs-lookup"><span data-stu-id="b3411-228">To get started with Graphical runbooks, see [My first graphical runbook](automation-first-runbook-graphical.md)</span></span>
* <span data-ttu-id="b3411-229">První kroky s runbooky pracovních postupů PowerShellu najdete v článku [Můj první runbook pracovního postupu PowerShellu](automation-first-runbook-textual.md).</span><span class="sxs-lookup"><span data-stu-id="b3411-229">To get started with PowerShell workflow runbooks, see [My first PowerShell workflow runbook](automation-first-runbook-textual.md)</span></span>
* <span data-ttu-id="b3411-230">Další informace o typech runbooků, jejich výhodách a omezeních najdete v článku [Typy runbooků ve službě Azure Automation](automation-runbook-types.md).</span><span class="sxs-lookup"><span data-stu-id="b3411-230">To know more about runbook types, their advantages and limitations, see [Azure Automation runbook types](automation-runbook-types.md)</span></span>
* <span data-ttu-id="b3411-231">Další informace o funkci podpory powershellových skriptů najdete v článku [Nativní podpora powershellových skriptů ve službě Azure Automation](https://azure.microsoft.com/blog/announcing-powershell-script-support-azure-automation-2/)</span><span class="sxs-lookup"><span data-stu-id="b3411-231">For more information on PowerShell script support feature, see [Native PowerShell script support in Azure Automation](https://azure.microsoft.com/blog/announcing-powershell-script-support-azure-automation-2/)</span></span>

