---
title: "Podřízené runbooky ve službě Azure Automation | Microsoft Docs"
description: "Popisuje různé metody pro spuštění sady runbook ve službě Azure Automation z jiného runbooku a sdílení informací mezi nimi."
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: tysonn
ms.assetid: 919887b9-43e2-4c16-883c-f81807fe37db
ms.service: automation
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 02/02/2017
ms.author: magoedte;bwren
ms.openlocfilehash: a605d278dbbda9613b91007ea6a7042403a7a6ff
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 07/11/2017
---
# <a name="child-runbooks-in-azure-automation"></a><span data-ttu-id="4e385-103">Podřízené runbooky ve službě Azure Automation</span><span class="sxs-lookup"><span data-stu-id="4e385-103">Child runbooks in Azure Automation</span></span>
<span data-ttu-id="4e385-104">Je osvědčeným postupem ve službě Azure Automation zapisovat opakovaně použitelné modulární runbooky se samostatnou funkcí, které můžete používat ostatní runbooky.</span><span class="sxs-lookup"><span data-stu-id="4e385-104">It is a best practice in Azure Automation to write reusable, modular runbooks with a discrete function that can be used by other runbooks.</span></span> <span data-ttu-id="4e385-105">Nadřazená sada runbook bude často volat podřízené runbooky provést požadovanou funkci.</span><span class="sxs-lookup"><span data-stu-id="4e385-105">A parent runbook will often call one or more child runbooks to perform required functionality.</span></span> <span data-ttu-id="4e385-106">Existují dva způsoby, jak volat podřízené runbooky, a každá z nich má významné rozdíly, kterým byste měli porozumět, aby mohla určit, která bude vhodné pro různé scénáře.</span><span class="sxs-lookup"><span data-stu-id="4e385-106">There are two ways to call a child runbook, and each has distinct differences that you should understand so that you can determine which will be best for your different scenarios.</span></span>

## <a name="invoking-a-child-runbook-using-inline-execution"></a><span data-ttu-id="4e385-107">Vyvolání podřízeného runbooku pomocí vložené spouštění</span><span class="sxs-lookup"><span data-stu-id="4e385-107">Invoking a child runbook using inline execution</span></span>
<span data-ttu-id="4e385-108">Chcete-li vyvolání runbooku přiřazeného z jiného runbooku, musíte použít název sady runbook a zadejte hodnoty jeho parametrů stejně, jako byste používali aktivitu nebo rutinu.</span><span class="sxs-lookup"><span data-stu-id="4e385-108">To invoke a runbook inline from another runbook, you use the name of the runbook and provide values for its parameters exactly like you would use an activity or cmdlet.</span></span>  <span data-ttu-id="4e385-109">Všechny runbooky ve stejném účtu Automation jsou k dispozici pro všechny ostatní pro použití tímto způsobem.</span><span class="sxs-lookup"><span data-stu-id="4e385-109">All runbooks in the same Automation account are available to all others to be used in this manner.</span></span> <span data-ttu-id="4e385-110">Nadřazená sada runbook bude čekat podřízené sady runbook až po dokončení Přesun na další řádek a jakýkoliv výstup se vrátí přímo do nadřazeného.</span><span class="sxs-lookup"><span data-stu-id="4e385-110">The parent runbook will wait for the child runbook to complete before moving to the next line, and any output is returned directly to the parent.</span></span>

<span data-ttu-id="4e385-111">Když vyvoláte přiřazený runbook běží ve stejné úloze jako nadřazený runbook.</span><span class="sxs-lookup"><span data-stu-id="4e385-111">When you invoke a runbook inline, it runs in the same job as the parent runbook.</span></span> <span data-ttu-id="4e385-112">Budou existovat žádná informace do historie úlohy podřízeného runbooku, který byl spuštěn.</span><span class="sxs-lookup"><span data-stu-id="4e385-112">There will be no indication in the job history of the child runbook that it ran.</span></span> <span data-ttu-id="4e385-113">Jakékoli výjimky a všechny výstupní datový proud z podřízeného runbooku budou přidružené k nadřazenému.</span><span class="sxs-lookup"><span data-stu-id="4e385-113">Any exceptions and any stream output from the child runbook will be associated with the parent.</span></span> <span data-ttu-id="4e385-114">To má za následek méně úloh a jejich jednodušší sledování a řešení problémů, protože jakékoli výjimky vyvolané podřízeným runbookem a jakýkoli jejich výstup datového proudu jsou přidružené nadřazené úloze.</span><span class="sxs-lookup"><span data-stu-id="4e385-114">This results in fewer jobs and makes them easier to track and to troubleshoot since any exceptions thrown by the child runbook and any of its stream output are associated with the parent job.</span></span>

<span data-ttu-id="4e385-115">Při publikování runbooku musí být všechny podřízené runbooky, které volá již publikován.</span><span class="sxs-lookup"><span data-stu-id="4e385-115">When a runbook is published, any child runbooks that it calls must already be published.</span></span> <span data-ttu-id="4e385-116">Je to proto, že Azure Automation vytvoří přidružení se všemi podřízenými runbooky při runbooku.</span><span class="sxs-lookup"><span data-stu-id="4e385-116">This is because Azure Automation builds an association with any child runbooks when a runbook is compiled.</span></span> <span data-ttu-id="4e385-117">Pokud nejsou, nadřazená sada runbook se objeví správně publikuje, ale vygeneruje výjimku, když je spuštěno.</span><span class="sxs-lookup"><span data-stu-id="4e385-117">If they aren’t, the parent runbook will appear to publish properly, but will generate an exception when it’s started.</span></span> <span data-ttu-id="4e385-118">V takovém případě můžete nadřazený runbook znovu publikovat aby správně odkazoval na podřízené runbooky.</span><span class="sxs-lookup"><span data-stu-id="4e385-118">If this happens, you can republish the parent runbook in order to properly reference the child runbooks.</span></span> <span data-ttu-id="4e385-119">Nemusíte znovu publikovat nadřízený runbook, pokud některý z podřízených runbooků se změnit, protože přidružení se již byly vytvořeny.</span><span class="sxs-lookup"><span data-stu-id="4e385-119">You do not need to republish the parent runbook if any of the child runbooks are changed because the association will have already been created.</span></span>

<span data-ttu-id="4e385-120">Parametry podřízeného runbooku s přiřazeným voláním můžou být jakéhokoli datového typu včetně složitých objektů a neexistuje žádný [serializace JSON](automation-starting-a-runbook.md#runbook-parameters) není při spuštění runbooku pomocí portálu pro správu Azure nebo pomocí Rutina Start-AzureRmAutomationRunbook.</span><span class="sxs-lookup"><span data-stu-id="4e385-120">The parameters of a child runbook called inline can be any data type including complex objects, and there is no [JSON serialization](automation-starting-a-runbook.md#runbook-parameters) as there is when you start the runbook using the Azure Management Portal or with the Start-AzureRmAutomationRunbook cmdlet.</span></span>

### <a name="runbook-types"></a><span data-ttu-id="4e385-121">Typy runbooků</span><span class="sxs-lookup"><span data-stu-id="4e385-121">Runbook types</span></span>
<span data-ttu-id="4e385-122">Typy, které můžete volat vzájemně:</span><span class="sxs-lookup"><span data-stu-id="4e385-122">Which types can call each other:</span></span>

* <span data-ttu-id="4e385-123">A [Powershellový runbook](automation-runbook-types.md#powershell-runbooks) a [grafické runbooky](automation-runbook-types.md#graphical-runbooks) můžete volat každý další vložené (obě jsou na základě prostředí PowerShell).</span><span class="sxs-lookup"><span data-stu-id="4e385-123">A [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) and [Graphical runbooks](automation-runbook-types.md#graphical-runbooks) can call each other inline (both are PowerShell based).</span></span>
* <span data-ttu-id="4e385-124">A [runbook pracovního postupu Powershellu](automation-runbook-types.md#powershell-workflow-runbooks) a runbooky pracovních postupů grafické prostředí PowerShell můžete volat každý další vložené (obě jsou na základě pracovního postupu Powershellu)</span><span class="sxs-lookup"><span data-stu-id="4e385-124">A [PowerShell Workflow runbook](automation-runbook-types.md#powershell-workflow-runbooks) and Graphical PowerShell Workflow runbooks can call each other inline (both are PowerShell Workflow based)</span></span>
* <span data-ttu-id="4e385-125">Prostředí PowerShell typy a typy pracovního postupu Powershellu nelze volat navzájem vložené a musí používat Start AzureRmAutomationRunbook.</span><span class="sxs-lookup"><span data-stu-id="4e385-125">The PowerShell types and the PowerShell Workflow types can’t call each other inline, and must use Start-AzureRmAutomationRunbook.</span></span>

<span data-ttu-id="4e385-126">Při publikování pořadí věci:</span><span class="sxs-lookup"><span data-stu-id="4e385-126">When does publish order matter:</span></span>

* <span data-ttu-id="4e385-127">Pro sady runbook PowerShell Workflow a grafické prostředí PowerShell Workflow pouze záleží na pořadí publikování sad runbook.</span><span class="sxs-lookup"><span data-stu-id="4e385-127">The publish order of runbooks only matters for PowerShell Workflow and Graphical PowerShell Workflow runbooks.</span></span>

<span data-ttu-id="4e385-128">Při volání pomocí vložené spouštění podřízeného runbooku grafický nebo pracovního postupu Powershellu se právě používá název sady runbook.</span><span class="sxs-lookup"><span data-stu-id="4e385-128">When you call a Graphical or PowerShell Workflow child runbook using inline execution, you just use the name of the runbook.</span></span>  <span data-ttu-id="4e385-129">Při volání podřízeného runbooku prostředí PowerShell, musí před jeho název s *.\\*  k určení, že se skript nachází v místním adresáři.</span><span class="sxs-lookup"><span data-stu-id="4e385-129">When you call a PowerShell child runbook, you must preceded its name with *.\\* to specify that the script is located in the local directory.</span></span> 

### <a name="example"></a><span data-ttu-id="4e385-130">Příklad</span><span class="sxs-lookup"><span data-stu-id="4e385-130">Example</span></span>
<span data-ttu-id="4e385-131">Následující příklad popisuje vyvolání podřízeného testovacího runbooku, který přijímá tři parametry, komplexní objekt, celé číslo a logickou hodnotu.</span><span class="sxs-lookup"><span data-stu-id="4e385-131">The following example invokes a test child runbook that accepts three parameters, a complex object, an integer, and a boolean.</span></span> <span data-ttu-id="4e385-132">Výstup podřízeného runbooku je přiřazený k proměnné.</span><span class="sxs-lookup"><span data-stu-id="4e385-132">The output of the child runbook is assigned to a variable.</span></span>  <span data-ttu-id="4e385-133">V takovém případě podřízené sady runbook je runbook pracovního postupu Powershellu</span><span class="sxs-lookup"><span data-stu-id="4e385-133">In this case, the child runbook is a PowerShell Workflow runbook</span></span>

    $vm = Get-AzureRmVM –ResourceGroupName "LabRG" –Name "MyVM"
    $output = PSWF-ChildRunbook –VM $vm –RepeatCount 2 –Restart $true

<span data-ttu-id="4e385-134">Následuje příkladě pomocí prostředí PowerShell runbook jako podřízený objekt.</span><span class="sxs-lookup"><span data-stu-id="4e385-134">Following is the same example using a PowerShell runbook as the child.</span></span>

    $vm = Get-AzureRmVM –ResourceGroupName "LabRG" –Name "MyVM"
    $output = .\PS-ChildRunbook.ps1 –VM $vm –RepeatCount 2 –Restart $true


## <a name="starting-a-child-runbook-using-cmdlet"></a><span data-ttu-id="4e385-135">Spouštění podřízeného runbooku pomocí rutiny</span><span class="sxs-lookup"><span data-stu-id="4e385-135">Starting a child runbook using cmdlet</span></span>
<span data-ttu-id="4e385-136">Můžete použít [Start-AzureRmAutomationRunbook](https://msdn.microsoft.com/library/mt603661.aspx) rutiny spuštění sady runbook, jak je popsáno v [spuštění runbooku pomocí prostředí Windows PowerShell](automation-starting-a-runbook.md#starting-a-runbook-with-windows-powershell).</span><span class="sxs-lookup"><span data-stu-id="4e385-136">You can use the [Start-AzureRmAutomationRunbook](https://msdn.microsoft.com/library/mt603661.aspx) cmdlet to start a runbook as described in [To start a runbook with Windows PowerShell](automation-starting-a-runbook.md#starting-a-runbook-with-windows-powershell).</span></span> <span data-ttu-id="4e385-137">Existují dva režimy použití pro tuto rutinu.</span><span class="sxs-lookup"><span data-stu-id="4e385-137">There are two modes of use for this cmdlet.</span></span>  <span data-ttu-id="4e385-138">V jednom režimu rutina vrátí id úlohy při vytvoření podřízené úlohy pro podřízený runbook.</span><span class="sxs-lookup"><span data-stu-id="4e385-138">In one mode, the cmdlet returns the job id as soon as the child job is created for the child runbook.</span></span>  <span data-ttu-id="4e385-139">V jiných režimu, který povolíte zadáním **-počkejte** parametr rutiny bude odložena podřízené úlohy dokončení a vrátí výstup z podřízené sady runbook.</span><span class="sxs-lookup"><span data-stu-id="4e385-139">In the other mode, which you enable by specifying the **-wait** parameter, the cmdlet will wait until the child job finishes and will return the output from the child runbook.</span></span>

<span data-ttu-id="4e385-140">Úloha z podřízeného runbooku spuštěná pomocí rutiny poběží v samostatné úloze nezávisle na nadřízeném runbooku.</span><span class="sxs-lookup"><span data-stu-id="4e385-140">The job from a child runbook started with a cmdlet will run in a separate job from the parent runbook.</span></span> <span data-ttu-id="4e385-141">To má za následek víc úloh než při vyvolání přiřazený runbook a dává je obtížné sledovat.</span><span class="sxs-lookup"><span data-stu-id="4e385-141">This results in more jobs than invoking the runbook inline and makes them more difficult to track.</span></span> <span data-ttu-id="4e385-142">Nadřazený může asynchronně spustit víc podřízených runbooků bez čekání na dokončení každého.</span><span class="sxs-lookup"><span data-stu-id="4e385-142">The parent can start multiple child runbooks asynchronously without waiting for each to complete.</span></span> <span data-ttu-id="4e385-143">Pro stejný druh paralelního provedení by volání přiřazených runbooků, bude třeba použít nadřazená sada runbook [paralelní klíčové slovo](automation-powershell-workflow.md#parallel-processing).</span><span class="sxs-lookup"><span data-stu-id="4e385-143">For that same kind of parallel execution calling the child runbooks inline, the parent runbook would need to use the [parallel keyword](automation-powershell-workflow.md#parallel-processing).</span></span>

<span data-ttu-id="4e385-144">Parametry pro podřízený runbook spuštěný pomocí rutiny jsou uvedeny jako zatřiďovací tabulky, jak je popsáno v [parametry Runbooku](automation-starting-a-runbook.md#runbook-parameters).</span><span class="sxs-lookup"><span data-stu-id="4e385-144">Parameters for a child runbook started with a cmdlet are provided as a hashtable as described in [Runbook Parameters](automation-starting-a-runbook.md#runbook-parameters).</span></span> <span data-ttu-id="4e385-145">Můžete použít jenom jednoduché datové typy.</span><span class="sxs-lookup"><span data-stu-id="4e385-145">Only simple data types can be used.</span></span> <span data-ttu-id="4e385-146">Pokud má runbook parametr komplexního datového typu, pak se musí být volaný jako přiřazený.</span><span class="sxs-lookup"><span data-stu-id="4e385-146">If the runbook has a parameter with a complex data type, then it must be called inline.</span></span>

### <a name="example"></a><span data-ttu-id="4e385-147">Příklad</span><span class="sxs-lookup"><span data-stu-id="4e385-147">Example</span></span>
<span data-ttu-id="4e385-148">Následující příklad spouští podřízený runbook s parametry a potom počká, než na její dokončení pomocí Start-AzureRmAutomationRunbook-počkejte parametr.</span><span class="sxs-lookup"><span data-stu-id="4e385-148">The following example starts a child runbook with parameters and then waits for it to complete using the Start-AzureRmAutomationRunbook -wait parameter.</span></span> <span data-ttu-id="4e385-149">Po dokončení její výstup se shromažďují z podřízené sady runbook.</span><span class="sxs-lookup"><span data-stu-id="4e385-149">Once completed, its output is collected from the child runbook.</span></span>

    $params = @{"VMName"="MyVM";"RepeatCount"=2;"Restart"=$true} 
    $joboutput = Start-AzureRmAutomationRunbook –AutomationAccountName "MyAutomationAccount" –Name "Test-ChildRunbook" -ResourceGroupName "LabRG" –Parameters $params –wait


## <a name="comparison-of-methods-for-calling-a-child-runbook"></a><span data-ttu-id="4e385-150">Porovnání metod pro volání podřízeného runbooku</span><span class="sxs-lookup"><span data-stu-id="4e385-150">Comparison of methods for calling a child runbook</span></span>
<span data-ttu-id="4e385-151">Následující tabulka shrnuje rozdíly mezi tyto dvě metody pro volání sady runbook z jiné sady runbook.</span><span class="sxs-lookup"><span data-stu-id="4e385-151">The following table summarizes the differences between the two methods for calling a runbook from another runbook.</span></span>

|  | <span data-ttu-id="4e385-152">Vložené</span><span class="sxs-lookup"><span data-stu-id="4e385-152">Inline</span></span> | <span data-ttu-id="4e385-153">Rutina</span><span class="sxs-lookup"><span data-stu-id="4e385-153">Cmdlet</span></span> |
|:--- |:--- |:--- |
| <span data-ttu-id="4e385-154">Úloha</span><span class="sxs-lookup"><span data-stu-id="4e385-154">Job</span></span> |<span data-ttu-id="4e385-155">Podřízené runbooky spuštěné ve stejné úloze jako nadřazený.</span><span class="sxs-lookup"><span data-stu-id="4e385-155">Child runbooks run in the same job as the parent.</span></span> |<span data-ttu-id="4e385-156">Pro podřízený runbook se vytvoří samostatná úloha.</span><span class="sxs-lookup"><span data-stu-id="4e385-156">A separate job is created for the child runbook.</span></span> |
| <span data-ttu-id="4e385-157">Provádění</span><span class="sxs-lookup"><span data-stu-id="4e385-157">Execution</span></span> |<span data-ttu-id="4e385-158">Nadřízený runbook čeká na dokončení podřízeného runbooku než budete pokračovat.</span><span class="sxs-lookup"><span data-stu-id="4e385-158">Parent runbook waits for the child runbook to complete before continuing.</span></span> |<span data-ttu-id="4e385-159">Nadřízený runbook pokračuje hned po spuštění podřízeného runbooku *nebo* nadřízený runbook čeká na dokončení úlohy podřízené.</span><span class="sxs-lookup"><span data-stu-id="4e385-159">Parent runbook continues immediately after child runbook is started *or* parent runbook waits for the child job to finish.</span></span> |
| <span data-ttu-id="4e385-160">Výstup</span><span class="sxs-lookup"><span data-stu-id="4e385-160">Output</span></span> |<span data-ttu-id="4e385-161">Nadřízený runbook může získat výstup přímo z podřízeného runbooku.</span><span class="sxs-lookup"><span data-stu-id="4e385-161">Parent runbook can directly get output from child runbook.</span></span> |<span data-ttu-id="4e385-162">Nadřízený runbook musí načíst výstup z úlohy podřízeného runbooku *nebo* nadřízený runbook může získat výstup přímo z podřízeného runbooku.</span><span class="sxs-lookup"><span data-stu-id="4e385-162">Parent runbook must retrieve output from child runbook job *or* parent runbook can directly get output from child runbook.</span></span> |
| <span data-ttu-id="4e385-163">Parametry</span><span class="sxs-lookup"><span data-stu-id="4e385-163">Parameters</span></span> |<span data-ttu-id="4e385-164">Hodnoty pro parametry podřízeného runbooku se zadávají samostatně a můžete použít jakéhokoli datového typu.</span><span class="sxs-lookup"><span data-stu-id="4e385-164">Values for the child runbook parameters are specified separately and can use any data type.</span></span> |<span data-ttu-id="4e385-165">Hodnoty pro parametry podřízeného runbooku musí zkombinovat do jedné zatřiďovací tabulky a můžou zahrnovat jenom jednoduché, pole a objektu datové typy, které využívají serializaci JSON.</span><span class="sxs-lookup"><span data-stu-id="4e385-165">Values for the child runbook parameters must be combined into a single hashtable and can only include simple, array, and object data types that leverage JSON serialization.</span></span> |
| <span data-ttu-id="4e385-166">Účet Automation</span><span class="sxs-lookup"><span data-stu-id="4e385-166">Automation Account</span></span> |<span data-ttu-id="4e385-167">Nadřízený runbook lze použít pouze podřízené sady runbook ve stejném účtu automation.</span><span class="sxs-lookup"><span data-stu-id="4e385-167">Parent runbook can only use child runbook in the same automation account.</span></span> |<span data-ttu-id="4e385-168">Pokud máte připojení k němu, můžete použít nadřazená sada runbook podřízeného runbooku z jakékoli účet automation ze stejného předplatného Azure a i jiné předplatné.</span><span class="sxs-lookup"><span data-stu-id="4e385-168">Parent runbook can use child runbook from any automation account from the same Azure subscription and even a different subscription if you have a connection to it.</span></span> |
| <span data-ttu-id="4e385-169">Publikování</span><span class="sxs-lookup"><span data-stu-id="4e385-169">Publishing</span></span> |<span data-ttu-id="4e385-170">Podřízené sady runbook musí publikovat před publikováním nadřazené sady runbook.</span><span class="sxs-lookup"><span data-stu-id="4e385-170">Child runbook must be published before parent runbook is published.</span></span> |<span data-ttu-id="4e385-171">Podřízené sady runbook musí být publikovaný kdykoli před nadřízeného runbooku.</span><span class="sxs-lookup"><span data-stu-id="4e385-171">Child runbook must be published any time before parent runbook is started.</span></span> |

## <a name="next-steps"></a><span data-ttu-id="4e385-172">Další kroky</span><span class="sxs-lookup"><span data-stu-id="4e385-172">Next steps</span></span>
* [<span data-ttu-id="4e385-173">Spuštění sady runbook ve službě Azure Automation</span><span class="sxs-lookup"><span data-stu-id="4e385-173">Starting a runbook in Azure Automation</span></span>](automation-starting-a-runbook.md)
* [<span data-ttu-id="4e385-174">Výstup a zprávy ve službě Azure Automation Runbooku</span><span class="sxs-lookup"><span data-stu-id="4e385-174">Runbook output and messages in Azure Automation</span></span>](automation-runbook-output-and-messages.md)

