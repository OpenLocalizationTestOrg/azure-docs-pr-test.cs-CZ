---
title: "aaaProfiling za provozu webové aplikace v Azure s Application Insights | Microsoft Docs"
description: "Identifikujte hello aktivní trase v kódu webového serveru s nízkými nároky profileru."
services: application-insights
documentationcenter: 
author: CFreemanwa
manager: carmonm
ms.service: application-insights
ms.workload: tbd
ms.tgt_pltfrm: ibiza
ms.devlang: na
ms.topic: article
ms.date: 05/04/2017
ms.author: bwren
ms.openlocfilehash: 3c7f21076f19335e0f006327932e13623ec9526b
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/06/2017
---
# <a name="profiling-live-azure-web-apps-with-application-insights"></a><span data-ttu-id="7d133-103">Profilace za provozu Azure web apps s Application Insights</span><span class="sxs-lookup"><span data-stu-id="7d133-103">Profiling live Azure web apps with Application Insights</span></span>

<span data-ttu-id="7d133-104">*Tato funkce Application Insights je GA pro aplikační služby a ve verzi preview pro výpočet.*</span><span class="sxs-lookup"><span data-stu-id="7d133-104">*This feature of Application Insights is GA for App Services and in preview for Compute.*</span></span>

<span data-ttu-id="7d133-105">Zjistěte, jak dlouho je strávil v jednotlivých metod v za provozu webové aplikace pomocí hello profilace nástroje [Azure Application Insights](app-insights-overview.md).</span><span class="sxs-lookup"><span data-stu-id="7d133-105">Find out how much time is spent in each method in your live web application by using hello profiling tool of [Azure Application Insights](app-insights-overview.md).</span></span> <span data-ttu-id="7d133-106">Ukazuje podrobné profily živé požadavky, které se spouští vaše aplikace a zvýrazňuje hello 'aktivní cesta', která používá hello většinu času.</span><span class="sxs-lookup"><span data-stu-id="7d133-106">It shows you detailed profiles of live requests that were served by your app, and highlights hello 'hot path' that is using hello most time.</span></span> <span data-ttu-id="7d133-107">Automaticky vybere příklady, které mají různé doby odezvy.</span><span class="sxs-lookup"><span data-stu-id="7d133-107">It automatically selects examples that have different response times.</span></span> <span data-ttu-id="7d133-108">profileru Hello používá toominimize režijní náklady na různé techniky.</span><span class="sxs-lookup"><span data-stu-id="7d133-108">hello profiler uses various techniques toominimize overhead.</span></span>

<span data-ttu-id="7d133-109">Hello profileru aktuálně funguje pro technologii ASP.NET webové aplikace běžící v Azure App Services, v nejméně hello Basic cenová úroveň.</span><span class="sxs-lookup"><span data-stu-id="7d133-109">hello profiler currently works for ASP.NET web apps running on Azure App Services, in at least hello Basic pricing tier.</span></span> 

<a id="installation"></a>
## <a name="enable-hello-profiler"></a><span data-ttu-id="7d133-110">Povolit hello profileru</span><span class="sxs-lookup"><span data-stu-id="7d133-110">Enable hello profiler</span></span>

<span data-ttu-id="7d133-111">[Nainstalujte službu Application Insights](app-insights-asp-net.md) ve vašem kódu.</span><span class="sxs-lookup"><span data-stu-id="7d133-111">[Install Application Insights](app-insights-asp-net.md) in your code.</span></span> <span data-ttu-id="7d133-112">Pokud je již nainstalována, ujistěte se, že máte nejnovější verzi hello.</span><span class="sxs-lookup"><span data-stu-id="7d133-112">If it's already installed, make sure you have hello latest version.</span></span> <span data-ttu-id="7d133-113">(toodo, klikněte pravým tlačítkem na projekt v Průzkumníku řešení a zvolte spravovat balíčky NuGet balíčky.</span><span class="sxs-lookup"><span data-stu-id="7d133-113">(toodo this, right-click your project in Solution Explorer, and choose Manage NuGet packages.</span></span> <span data-ttu-id="7d133-114">Vyberte aktualizaci a aktualizovat všechny balíčky.) Znovu nasazení vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="7d133-114">Select Updates and update all packages.) Re-deploy your app.</span></span>

<span data-ttu-id="7d133-115">*Pomocí ASP.NET Core? [Zkontrolujte, zde](#aspnetcore).*</span><span class="sxs-lookup"><span data-stu-id="7d133-115">*Using ASP.NET Core? [Check here](#aspnetcore).*</span></span>

<span data-ttu-id="7d133-116">V [https://portal.azure.com](https://portal.azure.com), otevřete hello prostředek Application Insights pro webové aplikace.</span><span class="sxs-lookup"><span data-stu-id="7d133-116">In [https://portal.azure.com](https://portal.azure.com), open hello Application Insights resource for your web app.</span></span> <span data-ttu-id="7d133-117">Otevřete **výkonu** a klikněte na tlačítko **povolit Application Insights profileru...** .</span><span class="sxs-lookup"><span data-stu-id="7d133-117">Open **Performance** and click **Enable Application Insights Profiler...**.</span></span>

![Klikněte na možnost na hello povolit banner profileru][enable-profiler-banner]

<span data-ttu-id="7d133-119">Alternativně můžete vždy kliknout na **konfigurace** tooview stav, povolit nebo zakázat hello profileru.</span><span class="sxs-lookup"><span data-stu-id="7d133-119">Alternatively, you can always click **Configure** tooview status, enable, or disable hello Profiler.</span></span>

![V okně hello výkonu kliknutím na tlačítko Konfigurovat][performance-blade]

<span data-ttu-id="7d133-121">V okně konfigurace jsou uvedeny webových aplikací, které jsou nakonfigurovány s Application Insights.</span><span class="sxs-lookup"><span data-stu-id="7d133-121">Web apps that are configured with Application Insights are listed on Configure blade.</span></span> <span data-ttu-id="7d133-122">Postupujte podle pokynů tooinstall hello profileru agenta v případě potřeby.</span><span class="sxs-lookup"><span data-stu-id="7d133-122">Follow instructions tooinstall hello Profiler agent if needed.</span></span> <span data-ttu-id="7d133-123">Pokud žádná webová aplikace je nakonfigurovaný s Application Insights ještě, klikněte na tlačítko *přidat propojené aplikace*.</span><span class="sxs-lookup"><span data-stu-id="7d133-123">If no web app is configured with Application Insights yet, click *Add Linked Apps*.</span></span>

<span data-ttu-id="7d133-124">Použití hello *povolit profileru* nebo *zakázat profileru* tlačítka v hello konfigurovat okno toocontrol hello profileru na všechny propojené webové aplikace.</span><span class="sxs-lookup"><span data-stu-id="7d133-124">Use hello *Enable Profiler* or *Disable Profiler* buttons in hello Configure blade toocontrol hello Profiler on all your linked web apps.</span></span>



![Konfigurace okna][linked app services]

<span data-ttu-id="7d133-126">toostop nebo restartování hello profileru pro jednotlivé instance služby App Service, naleznete je **v hello prostředek služby App Service**v **webové úlohy**.</span><span class="sxs-lookup"><span data-stu-id="7d133-126">toostop or restart hello profiler for an individual App Service instance, you'll find it **in hello App Service resource**, in **Web Jobs**.</span></span> <span data-ttu-id="7d133-127">toodelete ho, naleznete v části **rozšíření**.</span><span class="sxs-lookup"><span data-stu-id="7d133-127">toodelete it, look under **Extensions**.</span></span>

![Zakázat profilovací nástroj pro webové úlohy][disable-profiler-webjob]

<span data-ttu-id="7d133-129">Doporučujeme, abyste měli hello profileru na toodiscover o všechny vaše aplikace webové co nejdříve problémů s výkonem, všechny povolené.</span><span class="sxs-lookup"><span data-stu-id="7d133-129">We recommend that you have hello Profiler enabled on all your web apps toodiscover any performance issues as soon as possible.</span></span>

<span data-ttu-id="7d133-130">Pokud používáte WebDeploy toodeploy změny tooyour webové aplikace, ujistěte se, abyste vyloučili hello **App_Data** složku před odstraněním během nasazení.</span><span class="sxs-lookup"><span data-stu-id="7d133-130">If you use WebDeploy toodeploy changes tooyour web application, ensure that you exclude hello **App_Data** folder from being deleted during deployment.</span></span> <span data-ttu-id="7d133-131">Jinak, hello profileru rozšíření soubory se odstraní při další nasazení hello webové aplikace tooAzure.</span><span class="sxs-lookup"><span data-stu-id="7d133-131">Otherwise, hello profiler extension's files will be deleted when you next deploy hello web application tooAzure.</span></span>

### <a name="using-profiler-with-azure-vms-and-compute-resources-preview"></a><span data-ttu-id="7d133-132">Pomocí profileru s virtuálními počítači Azure a výpočetní prostředky (preview)</span><span class="sxs-lookup"><span data-stu-id="7d133-132">Using profiler with Azure VMs and Compute resources (preview)</span></span>

<span data-ttu-id="7d133-133">Pokud jste [povolit Application Insights pro aplikace Azure services v době běhu](app-insights-azure-web-apps.md#run-time-instrumentation-with-application-insights), profileru je automaticky dostupný.</span><span class="sxs-lookup"><span data-stu-id="7d133-133">When you [enable Application Insights for Azure app services at run time](app-insights-azure-web-apps.md#run-time-instrumentation-with-application-insights), Profiler is automatically available.</span></span> <span data-ttu-id="7d133-134">(Pokud už jste povolili Application Insights pro hello prostředků, je třeba tooupdate toohello lates verzi prostřednictvím hello **konfigurace** průvodce.)</span><span class="sxs-lookup"><span data-stu-id="7d133-134">(If you already enabled Application Insights for hello resource, you might need tooupdate toohello lates version through hello **Configure** wizard.)</span></span>

<span data-ttu-id="7d133-135">Je [verze preview hello profileru pro Azure výpočetní prostředky](https://go.microsoft.com/fwlink/?linkid=848155).</span><span class="sxs-lookup"><span data-stu-id="7d133-135">There is a [preview version of hello Profiler for Azure Compute resources](https://go.microsoft.com/fwlink/?linkid=848155).</span></span>


## <a name="limits"></a><span data-ttu-id="7d133-136">Omezení</span><span class="sxs-lookup"><span data-stu-id="7d133-136">Limits</span></span>

<span data-ttu-id="7d133-137">uchovávání dat výchozí Hello je 5 dní.</span><span class="sxs-lookup"><span data-stu-id="7d133-137">hello default data retention is 5 days.</span></span> <span data-ttu-id="7d133-138">Maximální 10 GB požity za den.</span><span class="sxs-lookup"><span data-stu-id="7d133-138">Maximum 10 GB ingested per day.</span></span>

<span data-ttu-id="7d133-139">Není nijak zpoplatněn služby profileru hello.</span><span class="sxs-lookup"><span data-stu-id="7d133-139">There is no charge for hello profiler service.</span></span> <span data-ttu-id="7d133-140">Webové aplikace musí být uloženy ve alespoň hello základní úroveň aplikační služby.</span><span class="sxs-lookup"><span data-stu-id="7d133-140">Your web app must be hosted in at least hello Basic tier of App Services.</span></span>

## <a name="viewing-profiler-data"></a><span data-ttu-id="7d133-141">Zobrazení dat profileru</span><span class="sxs-lookup"><span data-stu-id="7d133-141">Viewing profiler data</span></span>

<span data-ttu-id="7d133-142">Otevřete okno výkon hello a projděte dolů seznam operací toohello.</span><span class="sxs-lookup"><span data-stu-id="7d133-142">Open hello Performance blade and scroll down toohello operation list.</span></span>




![Okna Statistika výkonu aplikací příklady sloupce][performance-blade-examples]

<span data-ttu-id="7d133-144">Hello sloupců v tabulce hello jsou:</span><span class="sxs-lookup"><span data-stu-id="7d133-144">hello columns in hello table are:</span></span>

* <span data-ttu-id="7d133-145">**Počet** -hello počet tyto požadavky v hello časové rozmezí hello okna.</span><span class="sxs-lookup"><span data-stu-id="7d133-145">**Count** - hello number of these requests in hello time range of hello blade.</span></span>
* <span data-ttu-id="7d133-146">**Medián** -hello Typická doba toorespond tooa požadavek trvá vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="7d133-146">**Median** - hello typical time your app takes toorespond tooa request.</span></span> <span data-ttu-id="7d133-147">Polovinu všechny odpovědi byly rychlejší než to.</span><span class="sxs-lookup"><span data-stu-id="7d133-147">Half of all responses were faster than this.</span></span>
* <span data-ttu-id="7d133-148">**95. percentil** 95 % odpovědí byly rychlejší než to.</span><span class="sxs-lookup"><span data-stu-id="7d133-148">**95th percentile** 95% of responses were faster than this.</span></span> <span data-ttu-id="7d133-149">Pokud na tomto obrázku je příliš neliší od hello medián, může být občasný problém s vaší aplikací.</span><span class="sxs-lookup"><span data-stu-id="7d133-149">If this figure is very different from hello median, there might be an intermittent problem with your app.</span></span> <span data-ttu-id="7d133-150">(Nebo může být vysvětlené návrh funkce jako je například ukládání do mezipaměti.)</span><span class="sxs-lookup"><span data-stu-id="7d133-150">(Or it might be explained by a design feature such as caching.)</span></span>
* <span data-ttu-id="7d133-151">**Příklady** – ikona označuje, že hello profileru má zaznamenat trasování zásobníku pro tuto operaci.</span><span class="sxs-lookup"><span data-stu-id="7d133-151">**Examples** - an icon indicates that hello profiler has captured stack traces for this operation.</span></span>

<span data-ttu-id="7d133-152">Kliknutím na hello příklady ikonu tooopen hello trasování Průzkumníka.</span><span class="sxs-lookup"><span data-stu-id="7d133-152">Click hello Examples icon tooopen hello trace explorer.</span></span> <span data-ttu-id="7d133-153">Zobrazuje Průzkumníka Hello má několik vzorků, které hello profileru zachycení klasifikovány podle doby odezvy.</span><span class="sxs-lookup"><span data-stu-id="7d133-153">hello explorer shows several samples that hello profiler has captured, classified by response time.</span></span>

<span data-ttu-id="7d133-154">Vyberte tooshow ukázkový kód úrovni rozpis čas strávený provádění požadavku hello.</span><span class="sxs-lookup"><span data-stu-id="7d133-154">Select a sample tooshow a code-level breakdown of time spent executing hello request.</span></span>

![Application Insights trasování Explorer][trace-explorer]

<span data-ttu-id="7d133-156">**Zobrazit aktivní trase** otevře hello největších uzel typu list nebo alespoň něco zavřete.</span><span class="sxs-lookup"><span data-stu-id="7d133-156">**Show hot path** opens hello biggest leaf node, or at least something close.</span></span> <span data-ttu-id="7d133-157">Ve většině případů bude tento uzel přiléhající tooa přetížení.</span><span class="sxs-lookup"><span data-stu-id="7d133-157">In most cases this node will be adjacent tooa performance bottleneck.</span></span>



* <span data-ttu-id="7d133-158">**Popisek**: název hello hello funkce nebo událostí.</span><span class="sxs-lookup"><span data-stu-id="7d133-158">**Label**: hello name of hello function or event.</span></span> <span data-ttu-id="7d133-159">Hello Strom zobrazuje směs kód a události, které došlo k chybě (například události SQL a http).</span><span class="sxs-lookup"><span data-stu-id="7d133-159">hello tree shows a mix of code and events that occurred (such as SQL and http events).</span></span> <span data-ttu-id="7d133-160">horní událostí Hello představuje celkový hello požadavku doba trvání.</span><span class="sxs-lookup"><span data-stu-id="7d133-160">hello top event represents hello overall request duration.</span></span>
* <span data-ttu-id="7d133-161">**Uplynulý čas**: hello časový interval mezi počátečním hello hello operace a hello end.</span><span class="sxs-lookup"><span data-stu-id="7d133-161">**Elapsed**: hello time interval between hello start of hello operation and hello end.</span></span>
* <span data-ttu-id="7d133-162">**Když**: zobrazí, pokud byl spuštěn hello funkce nebo události v vztah tooother funkce.</span><span class="sxs-lookup"><span data-stu-id="7d133-162">**When**: Shows when hello function/event was running in relation tooother functions.</span></span>

## <a name="how-tooread-performance-data"></a><span data-ttu-id="7d133-163">Jak tooread údaje o výkonu</span><span class="sxs-lookup"><span data-stu-id="7d133-163">How tooread performance data</span></span>

<span data-ttu-id="7d133-164">Microsoft služba profileru používá kombinaci vzorkování metoda a instrumentace tooanalyze hello výkon aplikace.</span><span class="sxs-lookup"><span data-stu-id="7d133-164">Microsoft service profiler uses a combination of sampling method and instrumentation tooanalyze hello performance of your application.</span></span>
<span data-ttu-id="7d133-165">Když probíhá podrobné kolekce, ukázky profileru služby hello ukazatel instrukce každého z procesoru počítače hello v každé milisekundu.</span><span class="sxs-lookup"><span data-stu-id="7d133-165">When detailed collection is in progress, service profiler samples hello instruction pointer of each of hello machine's CPU in every millisecond.</span></span>
<span data-ttu-id="7d133-166">Každá ukázka zaznamená zásobníku dokončení volání hello hello vlákno aktuálně provádění, udělíte podrobnější a užitečné informace o tom, co vlákno se to, že na úrovni i maximální a minimální úrovně abstrakce.</span><span class="sxs-lookup"><span data-stu-id="7d133-166">Each sample captures hello complete call stack of hello thread currently executing, giving detailed and useful information about what that thread was doing at both high and low levels of abstraction.</span></span> <span data-ttu-id="7d133-167">Služba profileru shromažďuje také další události, jako je například přepínání události kontextu, TPL události a korelace aktivity tootrack události fondu vláken a příčiny.</span><span class="sxs-lookup"><span data-stu-id="7d133-167">Service profiler also collects other events such as context switching events, TPL events, and thread-pool events tootrack activity correlation and causality.</span></span>

<span data-ttu-id="7d133-168">Zásobník volání Hello vidět v zobrazení časové osy hello je hello výsledek hello nad vzorkování a instrumentace.</span><span class="sxs-lookup"><span data-stu-id="7d133-168">hello call stack shown in hello timeline view is hello result of hello above sampling and instrumentation.</span></span> <span data-ttu-id="7d133-169">Protože každá ukázka zaznamená zásobníku dokončení volání hello hello přístup z více vláken, obsahuje kód z hello rozhraní .NET framework, stejně jako ostatní platformy, na něž odkazuje.</span><span class="sxs-lookup"><span data-stu-id="7d133-169">Because each sample captures hello complete call stack of hello thread, it includes code from hello .NET framework, as well as other frameworks you reference.</span></span>

### <span data-ttu-id="7d133-170"><a id="jitnewobj"></a>Objekt přidělení (`clr!JIT\_New or clr!JIT\_Newarr1`)</span><span class="sxs-lookup"><span data-stu-id="7d133-170"><a id="jitnewobj"></a>Object Allocation (`clr!JIT\_New or clr!JIT\_Newarr1`)</span></span>
<span data-ttu-id="7d133-171">`clr!JIT\_New and clr!JIT\_Newarr1`jsou pomocné funkce v rozhraní .NET framework, která se přidělí paměť z spravovaná halda.</span><span class="sxs-lookup"><span data-stu-id="7d133-171">`clr!JIT\_New and clr!JIT\_Newarr1` are helper functions inside .NET framework that allocates memory from managed heap.</span></span> <span data-ttu-id="7d133-172">`clr!JIT\_New`je voláno, když je přidělen objektu.</span><span class="sxs-lookup"><span data-stu-id="7d133-172">`clr!JIT\_New` is invoked when an object is allocated.</span></span> <span data-ttu-id="7d133-173">`clr!JIT\_Newarr1`je voláno, když je přidělen pole objektu.</span><span class="sxs-lookup"><span data-stu-id="7d133-173">`clr!JIT\_Newarr1` is invoked when an object array is allocated.</span></span> <span data-ttu-id="7d133-174">Tyto dvě funkce jsou obvykle velmi rychlé a provést relativně malé množství času.</span><span class="sxs-lookup"><span data-stu-id="7d133-174">These two functions are typically very fast and should take relatively small amount of time.</span></span> <span data-ttu-id="7d133-175">Pokud se zobrazí `clr!JIT\_New` nebo `clr!JIT\_Newarr1` trvat významné množství času na časové ose, je to znamenat, že hello kód může být přidělování mnoho objektů a spotřebovávat značné množství paměti.</span><span class="sxs-lookup"><span data-stu-id="7d133-175">If you see `clr!JIT\_New` or `clr!JIT\_Newarr1` take a substantial amount of time in your timeline, it's an indication that hello code may be allocating many objects and consuming significant amount of memory.</span></span>

### <span data-ttu-id="7d133-176"><a id="theprestub"></a>Načítání kódu (`clr!ThePreStub`)</span><span class="sxs-lookup"><span data-stu-id="7d133-176"><a id="theprestub"></a>Loading Code (`clr!ThePreStub`)</span></span>
<span data-ttu-id="7d133-177">`clr!ThePreStub`je pomocné funkce v rozhraní .NET framework, který připraví hello kód tooexecute hello poprvé.</span><span class="sxs-lookup"><span data-stu-id="7d133-177">`clr!ThePreStub` is a helper function inside .NET framework that prepares hello code tooexecute for hello first time.</span></span> <span data-ttu-id="7d133-178">To obvykle zahrnuje, ale bez omezení (pouze v době) JIT – kompilace.</span><span class="sxs-lookup"><span data-stu-id="7d133-178">This typically includes, but not limited to, JIT (Just In Time) compilation.</span></span> <span data-ttu-id="7d133-179">Pro každou C# metodu `clr!ThePreStub` by měla být volána alespoň jednou během doby života hello procesu.</span><span class="sxs-lookup"><span data-stu-id="7d133-179">For each C# method, `clr!ThePreStub` should be invoked at most once during hello lifetime of a process.</span></span>

<span data-ttu-id="7d133-180">Pokud se zobrazí `clr!ThePreStub` trvá značné množství času požadavku, označuje tento požadavek je hello první, kterou provádí tento metoda a hello času pro rozhraní .NET framework runtime tooload, že metoda je důležité.</span><span class="sxs-lookup"><span data-stu-id="7d133-180">If you see `clr!ThePreStub` takes significant amount of time for a request, it indicates that request is hello first one that executes that method, and hello time for .NET framework runtime tooload that method is significant.</span></span> <span data-ttu-id="7d133-181">Můžete zvážit warm-up proces, který provede část kódu hello před vaši uživatelé k němu přístup nebo zvažte spuštění NGen vaše sestavení.</span><span class="sxs-lookup"><span data-stu-id="7d133-181">You can consider a warm-up process that executes that portion of hello code before your users access it, or consider running NGen on your assemblies.</span></span>

### <span data-ttu-id="7d133-182"><a id="lockcontention"></a>Zamknout kolizí (`clr!JITutil\_MonContention` nebo `clr!JITutil\_MonEnterWorker`)</span><span class="sxs-lookup"><span data-stu-id="7d133-182"><a id="lockcontention"></a>Lock Contention (`clr!JITutil\_MonContention` or `clr!JITutil\_MonEnterWorker`)</span></span>
<span data-ttu-id="7d133-183">`clr!JITutil\_MonContention`nebo `clr!JITutil\_MonEnterWorker` znamenat hello aktuální vlákno čeká zámek toobe vydání.</span><span class="sxs-lookup"><span data-stu-id="7d133-183">`clr!JITutil\_MonContention` or `clr!JITutil\_MonEnterWorker` indicate hello current thread is waiting for a lock toobe released.</span></span> <span data-ttu-id="7d133-184">To obvykle objeví při provádění jazyka C# zámku výpis, volání metody Monitor.Enter nebo volání metody s atributem MethodImplOptions.Synchronized.</span><span class="sxs-lookup"><span data-stu-id="7d133-184">This typically shows up when executing a C# lock statement, invoking Monitor.Enter method, or invoking a method with MethodImplOptions.Synchronized attribute.</span></span> <span data-ttu-id="7d133-185">Spory uzamčení obvykle dojde, když vláken A získá zámek a vlákno B pokusí tooacquire hello stejné zamknout před přístup z více vláken A uvolněním.</span><span class="sxs-lookup"><span data-stu-id="7d133-185">Lock contention typically happens when thread A acquires a lock, and thread B tries tooacquire hello same lock before thread A releases it.</span></span>

### <span data-ttu-id="7d133-186"><a id="ngencold"></a>Načítání kódu (`[COLD]`)</span><span class="sxs-lookup"><span data-stu-id="7d133-186"><a id="ngencold"></a>Loading code (`[COLD]`)</span></span>
<span data-ttu-id="7d133-187">Pokud obsahuje název metody hello `[COLD]`, jako například `mscorlib.ni![COLD]System.Reflection.CustomAttribute.IsDefined`, znamená to, že runtime rozhraní .NET framework hello provádí kód, který není optimalizována podle <a href="https://msdn.microsoft.com/library/e7k32f4k.aspx">optimalizace na základě profilu</a> pro hello poprvé.</span><span class="sxs-lookup"><span data-stu-id="7d133-187">If hello method name contains `[COLD]`, such as `mscorlib.ni![COLD]System.Reflection.CustomAttribute.IsDefined`, it means that hello .NET framework runtime is executing code that is not optimized by <a href="https://msdn.microsoft.com/library/e7k32f4k.aspx">profile-guided optimization</a> for hello first time.</span></span> <span data-ttu-id="7d133-188">Pro každou metodu měl by se zobrazit maximálně jednou během doby života hello hello procesu.</span><span class="sxs-lookup"><span data-stu-id="7d133-188">For each method, it should show up at most once during hello lifetime of hello process.</span></span>

<span data-ttu-id="7d133-189">Pokud významné množství času pro žádost o načtení kód používá, znamená to, této žádosti je hello první jeden tooexecute hello neoptimalizované část metoda hello.</span><span class="sxs-lookup"><span data-stu-id="7d133-189">If loading code takes significant amount of time for a request, it indicates that request is hello first one tooexecute hello unoptimized portion of hello method.</span></span> <span data-ttu-id="7d133-190">Můžete zvážit záložním až proces, který provede část kódu hello potom vaši uživatelé přístup.</span><span class="sxs-lookup"><span data-stu-id="7d133-190">You can consider a warm up process that executes that portion of hello code before your users access it.</span></span>

### <span data-ttu-id="7d133-191"><a id="httpclientsend"></a>Odeslání požadavku HTTP</span><span class="sxs-lookup"><span data-stu-id="7d133-191"><a id="httpclientsend"></a>Send HTTP Request</span></span>
<span data-ttu-id="7d133-192">Metody, jako `HttpClient.Send` znamenat hello kód čeká toocomplete požadavku HTTP.</span><span class="sxs-lookup"><span data-stu-id="7d133-192">Methods such as `HttpClient.Send` indicate hello code is waiting for a HTTP request toocomplete.</span></span>

### <span data-ttu-id="7d133-193"><a id="sqlcommand"></a>Operace databáze</span><span class="sxs-lookup"><span data-stu-id="7d133-193"><a id="sqlcommand"></a>Database Operation</span></span>
<span data-ttu-id="7d133-194">Metoda například SqlCommand.Execute označuje, že kód hello čeká toocomplete operace databáze.</span><span class="sxs-lookup"><span data-stu-id="7d133-194">Method such as SqlCommand.Execute indicates hello code is waiting for a database operation toocomplete.</span></span>

### <span data-ttu-id="7d133-195"><a id="await"></a>Čeká se na (`AWAIT\_TIME`)</span><span class="sxs-lookup"><span data-stu-id="7d133-195"><a id="await"></a>Waiting (`AWAIT\_TIME`)</span></span>
<span data-ttu-id="7d133-196">`AWAIT\_TIME`Označuje, že kód hello čeká na jiné toocomplete úloh.</span><span class="sxs-lookup"><span data-stu-id="7d133-196">`AWAIT\_TIME` indicates hello code is waiting for another task toocomplete.</span></span> <span data-ttu-id="7d133-197">K tomu obvykle dochází, pomocí C#, await, příkaz.</span><span class="sxs-lookup"><span data-stu-id="7d133-197">This typically happens with C# 'await' statement.</span></span> <span data-ttu-id="7d133-198">Pokud nemá hello kódu C#, await, hello přístup z více vláken unwinds a vrátí ovládací prvek toohello-fondu vláken a neexistuje žádné vlákno, které se zablokuje čekáním na toofinish "await" hello.</span><span class="sxs-lookup"><span data-stu-id="7d133-198">When hello code does a C# 'await', hello thread unwinds and returns control toohello thread-pool, and there is no thread that is blocked waiting for hello 'await' toofinish.</span></span> <span data-ttu-id="7d133-199">Však logicky hello přístup z více vláken, nebyla hello await 'blokováno.' čekání toocomplete operaci hello.</span><span class="sxs-lookup"><span data-stu-id="7d133-199">However, logically hello thread that did hello await is 'blocked' waiting for hello operation toocomplete.</span></span> <span data-ttu-id="7d133-200">`AWAIT\_TIME` Označuje hello blokované dobu čekání toocomplete úloh hello.</span><span class="sxs-lookup"><span data-stu-id="7d133-200">The `AWAIT\_TIME` indicates hello blocked time waiting for hello task toocomplete.</span></span>

### <span data-ttu-id="7d133-201"><a id="block"></a>Blokované čas</span><span class="sxs-lookup"><span data-stu-id="7d133-201"><a id="block"></a>Blocked Time</span></span>
<span data-ttu-id="7d133-202">`BLOCKED_TIME`Označuje, že kód hello čeká na jiné toobe prostředek k dispozici, například čekání na synchronizační objekt čekání na vlákno toobe k dispozici nebo čekání toofinish požadavku.</span><span class="sxs-lookup"><span data-stu-id="7d133-202">`BLOCKED_TIME` indicates hello code is waiting for another resource toobe available, such as waiting for a synchronization object, waiting for a thread toobe available, or waiting for a request toofinish.</span></span>

### <span data-ttu-id="7d133-203"><a id="cpu"></a>Čas procesoru</span><span class="sxs-lookup"><span data-stu-id="7d133-203"><a id="cpu"></a>CPU Time</span></span>
<span data-ttu-id="7d133-204">Hello procesoru je zaneprázdněný prováděna hello pokyny.</span><span class="sxs-lookup"><span data-stu-id="7d133-204">hello CPU is busy executing hello instructions.</span></span>

### <span data-ttu-id="7d133-205"><a id="disk"></a>Doba disku</span><span class="sxs-lookup"><span data-stu-id="7d133-205"><a id="disk"></a>Disk Time</span></span>
<span data-ttu-id="7d133-206">aplikace Hello provádí operace disku.</span><span class="sxs-lookup"><span data-stu-id="7d133-206">hello application is performing disk operations.</span></span>

### <span data-ttu-id="7d133-207"><a id="network"></a>Čas sítě</span><span class="sxs-lookup"><span data-stu-id="7d133-207"><a id="network"></a>Network Time</span></span>
<span data-ttu-id="7d133-208">aplikace Hello je provádění síťových operací.</span><span class="sxs-lookup"><span data-stu-id="7d133-208">hello application is performing network operations.</span></span>

### <span data-ttu-id="7d133-209"><a id="when"></a>Pokud sloupec</span><span class="sxs-lookup"><span data-stu-id="7d133-209"><a id="when"></a>When column</span></span>
<span data-ttu-id="7d133-210">Toto je vizualizaci jak hello včetně ukázky shromážděné pro uzel lišit v průběhu času.</span><span class="sxs-lookup"><span data-stu-id="7d133-210">This is a visualization of how hello INCLUSIVE samples collected for a node vary over time.</span></span> <span data-ttu-id="7d133-211">Celkový rozsah Hello hello požadavku je rozdělené do 32 kbelíků čas a hello včetně ukázky pro tento uzel počítají do těchto 32 intervalů.</span><span class="sxs-lookup"><span data-stu-id="7d133-211">hello total range of hello request is divided into 32 time buckets and hello inclusive samples for that node are accumulated into those 32 buckets.</span></span> <span data-ttu-id="7d133-212">Každý blok je pak reprezentován jako panel, jehož výška reprezentuje hodnotu škálovat.</span><span class="sxs-lookup"><span data-stu-id="7d133-212">Each bucket is then represented as a bar whose height represents a scaled value.</span></span> <span data-ttu-id="7d133-213">Pro uzly označena `CPU_TIME` nebo `BLOCKED_TIME`, nebo tam, kde je zřejmé vztah o využívání prostředků (procesor, disk, vlákno), hello panelu představuje jeden z těchto prostředků využívání hello dobu z této sady.</span><span class="sxs-lookup"><span data-stu-id="7d133-213">For nodes marked `CPU_TIME` or `BLOCKED_TIME`, or where there is an obvious relationship of consuming a resource (cpu, disk, thread), hello bar represents consuming one of those resources for hello period of time of that bucket.</span></span> <span data-ttu-id="7d133-214">Pro tyto metriky můžete získat větší než 100 % podle spotřebovávat více prostředků.</span><span class="sxs-lookup"><span data-stu-id="7d133-214">For these metrics you can get greater than 100% by consuming multiple resources.</span></span> <span data-ttu-id="7d133-215">Například pokud se v průměru v intervalu, použijte dva procesory, můžete získat 200 %.</span><span class="sxs-lookup"><span data-stu-id="7d133-215">For example, if on average you use two CPUs over an interval then you get 200%.</span></span>


## <span data-ttu-id="7d133-216"><a id="troubleshooting"></a>Řešení potíží</span><span class="sxs-lookup"><span data-stu-id="7d133-216"><a id="troubleshooting"></a>Troubleshooting</span></span>

### <a name="how-can-i-know-whether-application-insights-profiler-is-running"></a><span data-ttu-id="7d133-217">Jak poznám, jestli je spuštěný profileru Application Insights?</span><span class="sxs-lookup"><span data-stu-id="7d133-217">How can I know whether Application Insights profiler is running?</span></span>

<span data-ttu-id="7d133-218">Hello profileru spouští jako nepřetržité webové úlohy ve webové aplikaci.</span><span class="sxs-lookup"><span data-stu-id="7d133-218">hello profiler runs as a continuous web job in Web App.</span></span> <span data-ttu-id="7d133-219">Můžete otevřít prostředek hello webové aplikace v https://portal.azure.com a zkontrolujte stav "ApplicationInsightsProfiler" v okně webové úlohy hello.</span><span class="sxs-lookup"><span data-stu-id="7d133-219">You can open hello Web App resource in https://portal.azure.com and check "ApplicationInsightsProfiler" status in hello WebJobs blade.</span></span> <span data-ttu-id="7d133-220">Pokud není spuštěna, otevřete **protokoly** toofind Další.</span><span class="sxs-lookup"><span data-stu-id="7d133-220">If it isn't running, open **Logs** toofind out more.</span></span>

### <a name="why-cant-i-find-any-stack-examples-even-though-hello-profiler-is-running"></a><span data-ttu-id="7d133-221">Proč nelze najít žádné příklady zásobníku, i když je spuštěna hello profileru?</span><span class="sxs-lookup"><span data-stu-id="7d133-221">Why can't I find any stack examples even though hello profiler is running?</span></span>

<span data-ttu-id="7d133-222">Tady jsou můžete zkontrolovat pár věcí.</span><span class="sxs-lookup"><span data-stu-id="7d133-222">Here are a few things you can check.</span></span>

1. <span data-ttu-id="7d133-223">Zkontrolujte, že váš Web plán služby App Service je úroveň Basic a vyšší.</span><span class="sxs-lookup"><span data-stu-id="7d133-223">Make sure your Web App Service Plan is Basic tier and above.</span></span>
2. <span data-ttu-id="7d133-224">Zajistěte, aby vaše webová aplikace má Application Insights SDK 2.2 Beta a vyšší než povolené.</span><span class="sxs-lookup"><span data-stu-id="7d133-224">Make sure your Web App has Application Insights SDK 2.2 Beta and above enabled.</span></span>
3. <span data-ttu-id="7d133-225">Ujistěte se, že vaše webová aplikace má nastavení APPINSIGHTS_INSTRUMENTATIONKEY hello s hello používá stejný klíč instrumentace Application Insights SDK.</span><span class="sxs-lookup"><span data-stu-id="7d133-225">Make sure your Web App has hello APPINSIGHTS_INSTRUMENTATIONKEY setting with hello same instrumentation key used by Application Insights SDK.</span></span>
4. <span data-ttu-id="7d133-226">Zajistěte, aby vaše webová aplikace běží na rozhraní .net Framework 4.6.</span><span class="sxs-lookup"><span data-stu-id="7d133-226">Make sure your Web App is running on .Net Framework 4.6.</span></span>
5. <span data-ttu-id="7d133-227">Pokud je aplikace ASP.NET Core, zkontrolujte také, zda [hello požadované závislosti](#aspnetcore).</span><span class="sxs-lookup"><span data-stu-id="7d133-227">If it's an ASP.NET Core application, please also check [hello required dependencies](#aspnetcore).</span></span>

<span data-ttu-id="7d133-228">Po spuštění profileru hello není krátké warm-up období, kdy hello profileru aktivně shromažďuje několik trasování výkonu.</span><span class="sxs-lookup"><span data-stu-id="7d133-228">After hello profiler is started, there is a short warm-up period when hello profiler actively collects several performance traces.</span></span> <span data-ttu-id="7d133-229">Potom hello profileru shromažďuje trasování výkonu pro dvou minut za každou hodinu.</span><span class="sxs-lookup"><span data-stu-id="7d133-229">After that, hello profiler collects performance traces for two minutes in every hour.</span></span>  

### <a name="i-was-using-azure-service-profiler-what-happened-tooit"></a><span data-ttu-id="7d133-230">Použití profileru služby Azure.</span><span class="sxs-lookup"><span data-stu-id="7d133-230">I was using Azure Service Profiler.</span></span> <span data-ttu-id="7d133-231">Jaké happened tooit?</span><span class="sxs-lookup"><span data-stu-id="7d133-231">What happened tooit?</span></span>  

<span data-ttu-id="7d133-232">Když povolíte profileru Application Insights, profileru služby Azure agenta je zakázána.</span><span class="sxs-lookup"><span data-stu-id="7d133-232">When you enable Application Insights Profiler, Azure Service Profiler agent is disabled.</span></span>

### <span data-ttu-id="7d133-233"><a id="double-counting"></a>Dvojitý počítání v paralelních vláken</span><span class="sxs-lookup"><span data-stu-id="7d133-233"><a id="double-counting"></a>Double counting in parallel threads</span></span>

<span data-ttu-id="7d133-234">V některých případech hello metrika celkový čas v prohlížeči zásobníku hello je větší než skutečná doba trvání hello hello požadavku.</span><span class="sxs-lookup"><span data-stu-id="7d133-234">In some cases hello total time metric in hello stack viewer is more than hello actual duration of hello request.</span></span>

<span data-ttu-id="7d133-235">Tomu může dojít, pokud jsou dostupné dvě nebo více vláken, které jsou přidružené k požadavku operační paralelně.</span><span class="sxs-lookup"><span data-stu-id="7d133-235">This can happen when there are two or more threads associated with a request, operating in parallel.</span></span> <span data-ttu-id="7d133-236">Celkový počet vláken čas Hello je pak více než hello uplynulý čas.</span><span class="sxs-lookup"><span data-stu-id="7d133-236">hello total thread time is then more than hello elapsed time.</span></span> <span data-ttu-id="7d133-237">V mnoha případech může být jedno vlákno čekání na hello jiných toocomplete.</span><span class="sxs-lookup"><span data-stu-id="7d133-237">In many cases one thread may be waiting on hello other toocomplete.</span></span> <span data-ttu-id="7d133-238">Hello prohlížeč pokusů toodetect to a vynechejte hello nezajímavá čekání, ale chybuje na straně hello zobrazující příliš mnoho místo vynechání co může být důležitých informací.</span><span class="sxs-lookup"><span data-stu-id="7d133-238">hello viewer tries toodetect this and omit hello uninteresting wait, but errs on hello side of showing too much rather than omitting what may be critical information.</span></span>  

<span data-ttu-id="7d133-239">Pokud uvidíte paralelních vláken ve vašem trasování, je potřeba toodetermine, který vláken čekají, můžete určit hello kritické cesty pro požadavek hello.</span><span class="sxs-lookup"><span data-stu-id="7d133-239">When you see parallel threads in your traces, you need toodetermine which threads are waiting so you can determine hello critical path for hello request.</span></span> <span data-ttu-id="7d133-240">Ve většině případů hello hello vlákno, které rychle přejde do stavu čekání jednoduše čekání na další vlákna.</span><span class="sxs-lookup"><span data-stu-id="7d133-240">In most cases, hello thread that quickly goes into a wait state is simply waiting on hello other threads.</span></span> <span data-ttu-id="7d133-241">Soustředit se jenom na jiné hello a ignorovat hello čas v hello čekajících vláken.</span><span class="sxs-lookup"><span data-stu-id="7d133-241">Concentrate on hello others and ignore hello time in hello waiting threads.</span></span>

### <span data-ttu-id="7d133-242"><a id="issue-loading-trace-in-viewer"></a>Žádná data profilování</span><span class="sxs-lookup"><span data-stu-id="7d133-242"><a id="issue-loading-trace-in-viewer"></a>No profiling data</span></span>

1. <span data-ttu-id="7d133-243">Pokud hello data zkoušíte tooview je starší než několik týdnů, pokuste se omezit váš filtr času a akci opakujte.</span><span class="sxs-lookup"><span data-stu-id="7d133-243">If hello data you are trying tooview is older than a couple of weeks, try limiting your time filter and try again.</span></span>

2. <span data-ttu-id="7d133-244">Zkontrolujte, že proxy nebo brány firewall nejsou blokované toohttps://gateway.azureserviceprofiler.net přístup.</span><span class="sxs-lookup"><span data-stu-id="7d133-244">Check that proxies or a firewall have not blocked access toohttps://gateway.azureserviceprofiler.net.</span></span>

3. <span data-ttu-id="7d133-245">Zkontrolujte, že hello Application Insights je klíč instrumentace, který používáte ve vaší aplikaci hello stejné jako hello prostředek Application Insights, které jste povolili profilace s.</span><span class="sxs-lookup"><span data-stu-id="7d133-245">Check that hello Application Insights instrumentation key you are using in your app is hello same as hello Application Insights resource you've enabled profiling with.</span></span> <span data-ttu-id="7d133-246">klíč Hello je obvykle v souboru ApplicationInsights.config, ale můžete také najít v souboru web.config nebo app.config.</span><span class="sxs-lookup"><span data-stu-id="7d133-246">hello key is usually in ApplicationInsights.config but can also be found in web.config or app.config.</span></span>

### <a name="error-report-in-hello-profiling-viewer"></a><span data-ttu-id="7d133-247">Chyba sestavy v hello profilace prohlížeč</span><span class="sxs-lookup"><span data-stu-id="7d133-247">Error report in hello profiling viewer</span></span>

<span data-ttu-id="7d133-248">Soubor lístek podpory z portálu hello.</span><span class="sxs-lookup"><span data-stu-id="7d133-248">File a support ticket from hello portal.</span></span> <span data-ttu-id="7d133-249">Uveďte ID korelace hello z hello chybová zpráva.</span><span class="sxs-lookup"><span data-stu-id="7d133-249">Please include hello correlation ID from hello error message.</span></span>

## <a name="manual-installation"></a><span data-ttu-id="7d133-250">Ruční instalace</span><span class="sxs-lookup"><span data-stu-id="7d133-250">Manual installation</span></span>

<span data-ttu-id="7d133-251">Při konfiguraci hello profileru hello následující aktualizace jsou vytvářeny nastavení toohello webové aplikace.</span><span class="sxs-lookup"><span data-stu-id="7d133-251">When you configure hello profiler, hello following updates are made toohello Web App's settings.</span></span> <span data-ttu-id="7d133-252">Můžete je provést sami ručně, pokud vaše prostředí vyžadovat, například pokud vaše aplikace běží v Azure App Service prostředí (App Service Environment):</span><span class="sxs-lookup"><span data-stu-id="7d133-252">You can do them yourself manually if your environment requires, for example, if your application runs in Azure App Service Environment (ASE):</span></span>

1. <span data-ttu-id="7d133-253">V okně Ovládací prvek webové aplikace hello otevřete nastavení.</span><span class="sxs-lookup"><span data-stu-id="7d133-253">In hello web app control blade, open Settings.</span></span>
2. <span data-ttu-id="7d133-254">Nastavit "rozhraní .net Framework, verze" toov4.6.</span><span class="sxs-lookup"><span data-stu-id="7d133-254">Set ".Net Framework version" toov4.6.</span></span>
3. <span data-ttu-id="7d133-255">Nastavit tooOn "Always On".</span><span class="sxs-lookup"><span data-stu-id="7d133-255">Set "Always On" tooOn.</span></span>
4. <span data-ttu-id="7d133-256">Přidání nastavení aplikace "__APPINSIGHTS_INSTRUMENTATIONKEY__" a sadu hello hodnota toohello používá stejný klíč instrumentace hello SDK.</span><span class="sxs-lookup"><span data-stu-id="7d133-256">Add app setting "__APPINSIGHTS_INSTRUMENTATIONKEY__" and set hello value toohello same instrumentation key used by hello SDK.</span></span>
5. <span data-ttu-id="7d133-257">Otevřete pokročilé nástroje.</span><span class="sxs-lookup"><span data-stu-id="7d133-257">Open Advanced Tools.</span></span>
6. <span data-ttu-id="7d133-258">Klikněte na tlačítko "Jít" tooopen hello Kudu webu.</span><span class="sxs-lookup"><span data-stu-id="7d133-258">Click "Go" tooopen hello Kudu website.</span></span>
7. <span data-ttu-id="7d133-259">Hello Kudu webu vyberte "Rozšíření lokality".</span><span class="sxs-lookup"><span data-stu-id="7d133-259">In hello Kudu website, select "Site extensions".</span></span>
8. <span data-ttu-id="7d133-260">Nainstalujte "__Application Insights__" z galerie.</span><span class="sxs-lookup"><span data-stu-id="7d133-260">Install "__Application Insights__" from Gallery.</span></span>
9. <span data-ttu-id="7d133-261">Restartujte hello webové aplikace.</span><span class="sxs-lookup"><span data-stu-id="7d133-261">Restart hello web app.</span></span>

## <span data-ttu-id="7d133-262"><a id="aspnetcore"></a>Podpora jádra ASP.NET</span><span class="sxs-lookup"><span data-stu-id="7d133-262"><a id="aspnetcore"></a>ASP.NET Core Support</span></span>

<span data-ttu-id="7d133-263">Aplikace ASP.NET Core musí tooinstall 2.1.0-beta6 balíček Microsoft.ApplicationInsights.AspNetCore Nuget nebo vyšší toowork s hello profileru.</span><span class="sxs-lookup"><span data-stu-id="7d133-263">ASP.NET Core application needs tooinstall Microsoft.ApplicationInsights.AspNetCore Nuget package 2.1.0-beta6 or higher toowork with hello Profiler.</span></span> <span data-ttu-id="7d133-264">Po 27/6/2017 už podporujeme hello nižší verze.</span><span class="sxs-lookup"><span data-stu-id="7d133-264">We no longer support hello lower versions after 6/27/2017.</span></span>

## <a name="next-steps"></a><span data-ttu-id="7d133-265">Další kroky</span><span class="sxs-lookup"><span data-stu-id="7d133-265">Next steps</span></span>

* [<span data-ttu-id="7d133-266">Práce s Application Insights v sadě Visual Studio</span><span class="sxs-lookup"><span data-stu-id="7d133-266">Working with Application Insights in Visual Studio</span></span>](https://docs.microsoft.com/azure/application-insights/app-insights-visual-studio)

[performance-blade]: ./media/app-insights-profiler/performance-blade.png
[performance-blade-examples]: ./media/app-insights-profiler/performance-blade-examples.png
[trace-explorer]: ./media/app-insights-profiler/trace-explorer.png
[trace-explorer-toolbar]: ./media/app-insights-profiler/trace-explorer-toolbar.png
[trace-explorer-hint-tip]: ./media/app-insights-profiler/trace-explorer-hint-tip.png
[trace-explorer-hot-path]: ./media/app-insights-profiler/trace-explorer-hot-path.png
[enable-profiler-banner]: ./media/app-insights-profiler/enable-profiler-banner.png
[disable-profiler-webjob]: ./media/app-insights-profiler/disable-profiler-webjob.png
[linked app services]: ./media/app-insights-profiler/linked-app-services.png
