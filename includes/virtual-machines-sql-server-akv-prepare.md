## <a name="prepare-for-akv-integration"></a><span data-ttu-id="df692-101">Příprava pro integrace se službou AZURE</span><span class="sxs-lookup"><span data-stu-id="df692-101">Prepare for AKV Integration</span></span>
<span data-ttu-id="df692-102">Azure Key Vault integrace tooconfigure toouse váš virtuální počítač SQL Server existuje několik předpokladů:</span><span class="sxs-lookup"><span data-stu-id="df692-102">toouse Azure Key Vault Integration tooconfigure your SQL Server VM, there are several prerequisites:</span></span> 

1. [<span data-ttu-id="df692-103">Instalace prostředí Azure Powershell</span><span class="sxs-lookup"><span data-stu-id="df692-103">Install Azure Powershell</span></span>](#install-azure-powershell)
2. [<span data-ttu-id="df692-104">Vytvoření služby Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="df692-104">Create an Azure Active Directory</span></span>](#create-an-azure-active-directory)
3. [<span data-ttu-id="df692-105">Vytvoření trezoru klíčů</span><span class="sxs-lookup"><span data-stu-id="df692-105">Create a key vault</span></span>](#create-a-key-vault)

<span data-ttu-id="df692-106">Hello následující části popisují tyto požadavky a hello informace, které potřebujete rutiny prostředí PowerShell hello toocollect toolater spustit.</span><span class="sxs-lookup"><span data-stu-id="df692-106">hello following sections describe these prerequisites and hello information you need toocollect toolater run hello PowerShell cmdlets.</span></span>

### <a name="install-azure-powershell"></a><span data-ttu-id="df692-107">Instalace prostředí Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="df692-107">Install Azure PowerShell</span></span>
<span data-ttu-id="df692-108">Ujistěte se, že máte nainstalovanou hello nejnovější sadu Azure PowerShell SDK.</span><span class="sxs-lookup"><span data-stu-id="df692-108">Make sure you have installed hello latest Azure PowerShell SDK.</span></span> <span data-ttu-id="df692-109">Další informace najdete v tématu [jak tooinstall a konfigurace prostředí Azure PowerShell](/powershell/azureps-cmdlets-docs).</span><span class="sxs-lookup"><span data-stu-id="df692-109">For more information, see [How tooinstall and configure Azure PowerShell](/powershell/azureps-cmdlets-docs).</span></span>

### <a name="create-an-azure-active-directory"></a><span data-ttu-id="df692-110">Vytvoření služby Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="df692-110">Create an Azure Active Directory</span></span>
<span data-ttu-id="df692-111">Nejprve je třeba toohave [Azure Active Directory](https://azure.microsoft.com/trial/get-started-active-directory/) (AAD) v rámci vašeho předplatného.</span><span class="sxs-lookup"><span data-stu-id="df692-111">First, you need toohave an [Azure Active Directory](https://azure.microsoft.com/trial/get-started-active-directory/) (AAD) in your subscription.</span></span> <span data-ttu-id="df692-112">Mezi řadu výhod můžete toogrant oprávnění tooyour trezor klíčů pro některé uživatele a aplikace.</span><span class="sxs-lookup"><span data-stu-id="df692-112">Among many benefits, this allows you toogrant permission tooyour key vault for certain users and applications.</span></span>

<span data-ttu-id="df692-113">V dalším kroku zaregistrujte aplikaci v AAD.</span><span class="sxs-lookup"><span data-stu-id="df692-113">Next, register an application with AAD.</span></span> <span data-ttu-id="df692-114">Tím získáte účet instanční objekt, který má přístup tooyour trezoru klíčů který potřebovat virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="df692-114">This will give you a Service Principal account that has access tooyour key vault which your VM will need.</span></span> <span data-ttu-id="df692-115">V článku hello Azure Key Vault, můžete najít tyto kroky v hello [zaregistrovat aplikaci s Azure Active Directory](../articles/key-vault/key-vault-get-started.md#register) oddílu, nebo můžete zobrazit kroky hello se snímky obrazovky v hello **získat identity pro aplikace hello část** z [tomto příspěvku na blogu](http://blogs.technet.com/b/kv/archive/2015/01/09/azure-key-vault-step-by-step.aspx).</span><span class="sxs-lookup"><span data-stu-id="df692-115">In hello Azure Key Vault article, you can find these steps in hello [Register an application with Azure Active Directory](../articles/key-vault/key-vault-get-started.md#register) section, or you can see hello steps with screen shots in hello **Get an identity for hello application section** of [this blog post](http://blogs.technet.com/b/kv/archive/2015/01/09/azure-key-vault-step-by-step.aspx).</span></span> <span data-ttu-id="df692-116">Před dokončením těchto kroků, mějte na paměti, je nutné, aby toocollect hello následující informace během této registrace, který je potřeba později, když povolíte na virtuální počítač SQL Azure Key Vault integrace.</span><span class="sxs-lookup"><span data-stu-id="df692-116">Before completing these steps, note that you need toocollect hello following information during this registration that is needed later when you enable Azure Key Vault Integration on your SQL VM.</span></span>

* <span data-ttu-id="df692-117">Po přidání aplikace hello najde hello **ID klienta** na hello **konfigurace** kartě.   ![ID klienta Azure Active Directory](./media/virtual-machines-sql-server-akv-prepare/aad-client-id.png)</span><span class="sxs-lookup"><span data-stu-id="df692-117">After hello application is added, find hello **CLIENT ID**  on hello **CONFIGURE** tab.   ![Azure Active Directory Client ID](./media/virtual-machines-sql-server-akv-prepare/aad-client-id.png)</span></span>
  
    <span data-ttu-id="df692-118">ID klienta Hello je přiřazen novější toohello **$spName** parametr (Service Principal name) ve tooenable skript prostředí PowerShell hello Azure Key Vault integrace.</span><span class="sxs-lookup"><span data-stu-id="df692-118">hello client ID is assigned later toohello **$spName** (Service Principal name) parameter in hello PowerShell script tooenable Azure Key Vault Integration.</span></span> 
* <span data-ttu-id="df692-119">Navíc při provádění těchto kroků při vytváření klíče zkopírujte hello tajný klíč pro klíč znázorněné v hello následující snímek obrazovky.</span><span class="sxs-lookup"><span data-stu-id="df692-119">Also, during these steps when you create your key, copy hello secret for your key as is shown in hello following screenshot.</span></span> <span data-ttu-id="df692-120">Tento klíč tajný klíč je přiřazen novější toohello **$spSecret** parametr (Service Principal tajný klíč) ve skriptu PowerShell hello.</span><span class="sxs-lookup"><span data-stu-id="df692-120">This key secret is assigned later toohello **$spSecret** (Service Principal secret) parameter in hello PowerShell script.</span></span>  
    <span data-ttu-id="df692-121">![Tajný klíč služby Azure Active Directory](./media/virtual-machines-sql-server-akv-prepare/aad-sp-secret.png)</span><span class="sxs-lookup"><span data-stu-id="df692-121">![Azure Active Directory Secret](./media/virtual-machines-sql-server-akv-prepare/aad-sp-secret.png)</span></span>
* <span data-ttu-id="df692-122">Je nutné autorizovat tento nový klient ID toohave hello následující oprávnění k přístupu: **šifrování**, **dešifrovat**, **wrapKey**, **unwrapKey**, **přihlašovací**, a **ověřte**.</span><span class="sxs-lookup"><span data-stu-id="df692-122">You must authorize this new client ID toohave hello following access permissions: **encrypt**, **decrypt**, **wrapKey**, **unwrapKey**, **sign**, and **verify**.</span></span> <span data-ttu-id="df692-123">To lze provést pomocí hello [Set-AzureRmKeyVaultAccessPolicy](https://msdn.microsoft.com/library/azure/mt603625.aspx) rutiny.</span><span class="sxs-lookup"><span data-stu-id="df692-123">This is done with hello [Set-AzureRmKeyVaultAccessPolicy](https://msdn.microsoft.com/library/azure/mt603625.aspx) cmdlet.</span></span> <span data-ttu-id="df692-124">Další informace najdete v části [autorizovat hello aplikace toouse hello klíče nebo tajného klíče](../articles/key-vault/key-vault-get-started.md#authorize).</span><span class="sxs-lookup"><span data-stu-id="df692-124">For more information see [Authorize hello application toouse hello key or secret](../articles/key-vault/key-vault-get-started.md#authorize).</span></span>

### <a name="create-a-key-vault"></a><span data-ttu-id="df692-125">Vytvořte trezor klíčů</span><span class="sxs-lookup"><span data-stu-id="df692-125">Create a key vault</span></span>
<span data-ttu-id="df692-126">Pořadí toouse Azure Key Vault toostore hello klíče, které budete používat pro šifrování v virtuálního počítače je nutné trezoru klíčů tooa přístup.</span><span class="sxs-lookup"><span data-stu-id="df692-126">In order toouse Azure Key Vault toostore hello keys you will use for encryption in your VM, you need access tooa key vault.</span></span> <span data-ttu-id="df692-127">Pokud již jste nenastavili trezoru klíčů, vytvořte ho pomocí následujících kroků hello v hello [Začínáme s Azure Key Vault](../articles/key-vault/key-vault-get-started.md) tématu.</span><span class="sxs-lookup"><span data-stu-id="df692-127">If you have not already set up your key vault, create one by following hello steps in hello [Getting Started with Azure Key Vault](../articles/key-vault/key-vault-get-started.md) topic.</span></span> <span data-ttu-id="df692-128">Před dokončením těchto kroků, Všimněte si, že některé informace, které budete potřebovat toocollect během toto nastavení, je potřeba později když povolíte na virtuální počítač SQL Azure Key Vault integrace.</span><span class="sxs-lookup"><span data-stu-id="df692-128">Before completing these steps, note that there is some information you need toocollect during this set up that is needed later when you enable Azure Key Vault Integration on your SQL VM.</span></span>

<span data-ttu-id="df692-129">Když získáte toohello vytvořit krok trezoru klíčů, vrátí Poznámka hello **vaultUri** vlastnost, která je adresa URL trezoru klíčů hello.</span><span class="sxs-lookup"><span data-stu-id="df692-129">When you get toohello Create a key vault step, note hello returned **vaultUri** property, which is hello key vault URL.</span></span> <span data-ttu-id="df692-130">V zadané v tomto kroku níže uvedeném příkladu hello název trezoru klíčů hello je ContosoKeyVault, proto hello URL trezoru klíčů by https://contosokeyvault.vault.azure.net/.</span><span class="sxs-lookup"><span data-stu-id="df692-130">In hello example provided in that step, shown below, hello key vault name is ContosoKeyVault, therefore hello key vault URL would be https://contosokeyvault.vault.azure.net/.</span></span>

    New-AzureRmKeyVault -VaultName 'ContosoKeyVault' -ResourceGroupName 'ContosoResourceGroup' -Location 'East Asia'

<span data-ttu-id="df692-131">Adresa URL trezoru klíčů Hello je přiřazen novější toohello **$akvURL** parametr v tooenable skript prostředí PowerShell hello Azure Key Vault integrace.</span><span class="sxs-lookup"><span data-stu-id="df692-131">hello key vault URL is assigned later toohello **$akvURL** parameter in hello PowerShell script tooenable Azure Key Vault Integration.</span></span>

