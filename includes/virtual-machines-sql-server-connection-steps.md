### <a name="open-tcp-ports-in-the-windows-firewall-for-the-default-instance-of-the-database-engine"></a><span data-ttu-id="afade-101">Otevření portů TCP v bráně Windows Firewall pro výchozí instanci databázového stroje</span><span class="sxs-lookup"><span data-stu-id="afade-101">Open TCP ports in the Windows firewall for the default instance of the Database Engine</span></span>
1. <span data-ttu-id="afade-102">Pomocí Vzdálené plochy se připojte k virtuálnímu počítači.</span><span class="sxs-lookup"><span data-stu-id="afade-102">Connect to the virtual machine with Remote Desktop.</span></span> <span data-ttu-id="afade-103">Podrobné pokyny pro připojení k virtuálnímu počítači najdete v tématu věnovaném [otevření virtuálního počítače SQL pomocí Vzdálené plochy](../articles/virtual-machines/windows/sql/virtual-machines-windows-portal-sql-server-provision.md#open-the-vm-with-remote-desktop).</span><span class="sxs-lookup"><span data-stu-id="afade-103">For detailed instructions on connecting to the VM, see [Open a SQL VM with Remote Desktop](../articles/virtual-machines/windows/sql/virtual-machines-windows-portal-sql-server-provision.md#open-the-vm-with-remote-desktop).</span></span>
2. <span data-ttu-id="afade-104">Po přihlášení na úvodní obrazovce zadejte **WF.msc** a potom stiskněte ENTER.</span><span class="sxs-lookup"><span data-stu-id="afade-104">Once logged in, at the Start screen, type **WF.msc**, and then hit ENTER.</span></span>
   
    ![Spuštění programu brány firewall](./media/virtual-machines-sql-server-connection-steps/12Open-WF.png)
3. <span data-ttu-id="afade-106">V levém panelu okna **Brána Windows Firewall s pokročilým zabezpečením** klikněte pravým tlačítkem na **Příchozí pravidla** a potom v podokně akcí klikněte na **Nové pravidlo**.</span><span class="sxs-lookup"><span data-stu-id="afade-106">In the **Windows Firewall with Advanced Security**, in the left pane, right-click **Inbound Rules**, and then click **New Rule** in the action pane.</span></span>
   
    ![Nové pravidlo](./media/virtual-machines-sql-server-connection-steps/13New-FW-Rule.png)
4. <span data-ttu-id="afade-108">V dialogovém okně **Průvodce vytvořením nového příchozího pravidla** v části **Typ pravidla** vyberte **Port** a potom klikněte na **Další**.</span><span class="sxs-lookup"><span data-stu-id="afade-108">In the **New Inbound Rule Wizard** dialog box, under **Rule Type**, select **Port**, and then click **Next**.</span></span>
5. <span data-ttu-id="afade-109">V dialogovém okně **Protokol a porty** použijte výchozí nastavení **TCP**.</span><span class="sxs-lookup"><span data-stu-id="afade-109">In the **Protocol and Ports** dialog, use the default **TCP**.</span></span> <span data-ttu-id="afade-110">Do pole **Konkrétní místní porty** potom zadejte číslo portu instance databázového stroje (**1433** pro výchozí instanci, nebo vaši volbu pro privátní port vybranou v kroku pro koncový bod).</span><span class="sxs-lookup"><span data-stu-id="afade-110">In the **Specific local ports** box, then type the port number of the instance of the Database Engine (**1433** for the default instance or your choice for the private port in the endpoint step).</span></span>
   
    ![Port 1433 protokolu TCP](./media/virtual-machines-sql-server-connection-steps/14Port-1433.png)
6. <span data-ttu-id="afade-112">Klikněte na **Další**.</span><span class="sxs-lookup"><span data-stu-id="afade-112">Click **Next**.</span></span>
7. <span data-ttu-id="afade-113">V dialogovém okně **Akce** vyberte **Povolit připojení** a potom klikněte na **Další**.</span><span class="sxs-lookup"><span data-stu-id="afade-113">In the **Action** dialog box, select **Allow the connection**, and then click **Next**.</span></span>
   
    <span data-ttu-id="afade-114">**Poznámka k zabezpečení:** Výběr nastavení **Povolit připojení, je-li zabezpečené** může zvýšit úroveň zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="afade-114">**Security Note:** Selecting **Allow the connection if it is secure** can provide additional security.</span></span> <span data-ttu-id="afade-115">Tuto možnost vyberte, pokud chcete konfigurovat další možnosti zabezpečení ve vašem prostředí.</span><span class="sxs-lookup"><span data-stu-id="afade-115">Select this option if you want to configure additional security options in your environment.</span></span>
   
    ![Povolení připojení](./media/virtual-machines-sql-server-connection-steps/15Allow-Connection.png)
8. <span data-ttu-id="afade-117">V dialogovém okně **Profil** vyberte **Veřejný**, **Privátní** a **Doména**.</span><span class="sxs-lookup"><span data-stu-id="afade-117">In the **Profile** dialog box, select **Public**, **Private**, and **Domain**.</span></span> <span data-ttu-id="afade-118">Pak klikněte na tlačítko **Další**.</span><span class="sxs-lookup"><span data-stu-id="afade-118">Then click **Next**.</span></span>
   
    <span data-ttu-id="afade-119">**Poznámka k zabezpečení:** Výběr možnosti **Veřejný** umožní přístup přes internet.</span><span class="sxs-lookup"><span data-stu-id="afade-119">**Security Note:**  Selecting **Public** allows access over the internet.</span></span> <span data-ttu-id="afade-120">Pokud je to možné, vybírejte vždy restriktivnější profil.</span><span class="sxs-lookup"><span data-stu-id="afade-120">Whenever possible, select a more restrictive profile.</span></span>
   
    ![Veřejný profil](./media/virtual-machines-sql-server-connection-steps/16Public-Private-Domain-Profile.png)
9. <span data-ttu-id="afade-122">V dialogovém okně **Název** zadejte název a popis pro toto pravidlo a potom klikněte na **Dokončit**.</span><span class="sxs-lookup"><span data-stu-id="afade-122">In the **Name** dialog box, type a name and description for this rule, and then click **Finish**.</span></span>
   
    ![Název pravidla](./media/virtual-machines-sql-server-connection-steps/17Rule-Name.png)

<span data-ttu-id="afade-124">Podle potřeby otevřete další porty pro ostatní komponenty.</span><span class="sxs-lookup"><span data-stu-id="afade-124">Open additional ports for other components as needed.</span></span> <span data-ttu-id="afade-125">Další informace najdete v tématu věnovaném [konfiguraci brány Windows Firewall pro povolení přístupu k SQL Serveru](http://msdn.microsoft.com/library/cc646023.aspx).</span><span class="sxs-lookup"><span data-stu-id="afade-125">For more information, see [Configuring the Windows Firewall to Allow SQL Server Access](http://msdn.microsoft.com/library/cc646023.aspx).</span></span>

### <a name="configure-sql-server-to-listen-on-the-tcp-protocol"></a><span data-ttu-id="afade-126">Konfigurace naslouchání SQL Serveru pro protokol TCP</span><span class="sxs-lookup"><span data-stu-id="afade-126">Configure SQL Server to listen on the TCP protocol</span></span>

[!INCLUDE [Enable TCP](virtual-machines-sql-server-connection-tcp-protocol.md)]

### <a name="configure-sql-server-for-mixed-mode-authentication"></a><span data-ttu-id="afade-127">Konfigurace SQL Serveru pro kombinovaný režim ověřování</span><span class="sxs-lookup"><span data-stu-id="afade-127">Configure SQL Server for mixed mode authentication</span></span>
<span data-ttu-id="afade-128">Databázový stroj SQL Serveru nemůže používat ověřování systému Windows bez doménového prostředí.</span><span class="sxs-lookup"><span data-stu-id="afade-128">The SQL Server Database Engine cannot use Windows Authentication without domain environment.</span></span> <span data-ttu-id="afade-129">Pokud se chcete připojit k databázovému stroji z jiného počítače, nakonfigurujte SQL Server ověřování ve smíšeném režimu.</span><span class="sxs-lookup"><span data-stu-id="afade-129">To connect to the Database Engine from another computer, configure SQL Server for mixed mode authentication.</span></span> <span data-ttu-id="afade-130">Smíšený režim ověřování umožňuje ověřování systému SQL Server i ověřování systému Windows.</span><span class="sxs-lookup"><span data-stu-id="afade-130">Mixed mode authentication allows both SQL Server Authentication and Windows Authentication.</span></span>

> [!NOTE]
> <span data-ttu-id="afade-131">Konfigurace ověřování ve smíšeném režimu nemusí být nutná v případě, že jste nakonfigurovali Azure Virtual Network s nakonfigurovaným doménovým prostředím.</span><span class="sxs-lookup"><span data-stu-id="afade-131">Configuring mixed mode authentication might not be necessary if you have configured an Azure Virtual Network with a configured domain environment.</span></span>
> 
> 

1. <span data-ttu-id="afade-132">Zůstaňte připojeni k virtuálnímu počítači a na úvodní stránce zadejte **SQL Server Management Studio** a klikněte na vybranou ikonu.</span><span class="sxs-lookup"><span data-stu-id="afade-132">While connected to the virtual machine, on the Start page, type **SQL Server Management Studio** and click the selected icon.</span></span>
   
    <span data-ttu-id="afade-133">Při prvním otevření sady Management Studio se musí vytvořit uživatelské prostředí sady Management Studio.</span><span class="sxs-lookup"><span data-stu-id="afade-133">The first time you open Management Studio it must create the users Management Studio environment.</span></span> <span data-ttu-id="afade-134">Tato operace může chvíli trvat.</span><span class="sxs-lookup"><span data-stu-id="afade-134">This may take a few moments.</span></span>
2. <span data-ttu-id="afade-135">Management Studio zobrazí dialogové okno **Připojit k serveru**.</span><span class="sxs-lookup"><span data-stu-id="afade-135">Management Studio presents the **Connect to Server** dialog box.</span></span> <span data-ttu-id="afade-136">Do pole **Název serveru** zadejte název virtuálního počítače, který se má připojit k databázovému stroji s využitím Průzkumníka objektů. (Místo názvu virtuálního počítače můžete také jako **název serveru** použít text **(local)** nebo jednu tečku).</span><span class="sxs-lookup"><span data-stu-id="afade-136">In the **Server name** box, type the name of the virtual machine to connect to the Database Engine  with the Object Explorer (Instead of the virtual machine name you can also use **(local)** or a single period as the **Server name**).</span></span> <span data-ttu-id="afade-137">Vyberte **Ověřování systému Windows**, a v poli **Uživatelské jméno** ponechejte ***název_virtuálního_počítače*\místní_správce**.</span><span class="sxs-lookup"><span data-stu-id="afade-137">Select **Windows Authentication**, and leave ***your_VM_name*\your_local_administrator** in the **User name** box.</span></span> <span data-ttu-id="afade-138">Klikněte na **Připojit**.</span><span class="sxs-lookup"><span data-stu-id="afade-138">Click **Connect**.</span></span>
   
    ![Připojení k serveru](./media/virtual-machines-sql-server-connection-steps/19Connect-to-Server.png)
3. <span data-ttu-id="afade-140">V Průzkumníku objektů systému SQL Server klikněte pravým tlačítkem na název instance SQL Serveru (název virtuálního počítače) a potom klikněte na **Vlastnosti**.</span><span class="sxs-lookup"><span data-stu-id="afade-140">In SQL Server Management Studio Object Explorer, right-click the name of the instance of SQL Server (the virtual machine name), and then click **Properties**.</span></span>
   
    ![Vlastnosti serveru](./media/virtual-machines-sql-server-connection-steps/20Server-Properties.png)
4. <span data-ttu-id="afade-142">Na stránce **Zabezpečení** v části **Ověření serveru** vyberte **SQL Server and Windows Authentication mode** (SQL Server a režim ověřování systému Windows) a potom klikněte na **OK**.</span><span class="sxs-lookup"><span data-stu-id="afade-142">On the **Security** page, under **Server authentication**, select **SQL Server and Windows Authentication mode**, and then click **OK**.</span></span>
   
    ![Výběr režimu ověřování](./media/virtual-machines-sql-server-connection-steps/21Mixed-Mode.png)
5. <span data-ttu-id="afade-144">Kliknutím na **OK** v dialogovém okně SQL Server Management Studio potvrďte požadavek na restartování SQL Serveru.</span><span class="sxs-lookup"><span data-stu-id="afade-144">In the SQL Server Management Studio dialog box, click **OK** to acknowledge the requirement to restart SQL Server.</span></span>
6. <span data-ttu-id="afade-145">V Průzkumníku objektů klikněte pravým tlačítkem na server a potom klikněte na **Restartovat**.</span><span class="sxs-lookup"><span data-stu-id="afade-145">In Object Explorer, right-click your server, and then click **Restart**.</span></span> <span data-ttu-id="afade-146">(Pokud je spuštěný agent systému SQL Server, musí se také restartovat.)</span><span class="sxs-lookup"><span data-stu-id="afade-146">(If SQL Server Agent is running, it must also be restarted.)</span></span>
   
    ![Restartování](./media/virtual-machines-sql-server-connection-steps/22Restart2.png)
7. <span data-ttu-id="afade-148">Kliknutím na **Ano** v dialogovém okně SQL Server Management Studio vyjádříte souhlas s restartováním SQL Serveru.</span><span class="sxs-lookup"><span data-stu-id="afade-148">In the SQL Server Management Studio dialog box, click **Yes** to agree that you want to restart SQL Server.</span></span>

### <a name="create-sql-server-authentication-logins"></a><span data-ttu-id="afade-149">Vytvoření účtů ověřování serveru SQL</span><span class="sxs-lookup"><span data-stu-id="afade-149">Create SQL Server authentication logins</span></span>
<span data-ttu-id="afade-150">Pokud se chcete připojit k databázovému stroji z jiného počítače, musíte vytvořit nejméně jeden účet ověřování SQL Serveru.</span><span class="sxs-lookup"><span data-stu-id="afade-150">To connect to the Database Engine from another computer, you must create at least one SQL Server authentication login.</span></span>

1. <span data-ttu-id="afade-151">V Průzkumníku objektů systému SQL Server rozbalte složku instance serveru, ve které chcete vytvořit nové přihlášení.</span><span class="sxs-lookup"><span data-stu-id="afade-151">In SQL Server Management Studio Object Explorer, expand the folder of the server instance in which you want to create the new login.</span></span>
2. <span data-ttu-id="afade-152">Klikněte pravým tlačítkem na **Zabezpečení**, přejděte na **Nové** a vyberte **Přihlášení...**.</span><span class="sxs-lookup"><span data-stu-id="afade-152">Right-click the **Security** folder, point to **New**, and select **Login...**.</span></span>
   
    ![Nové přihlášení](./media/virtual-machines-sql-server-connection-steps/23New-Login.png)
3. <span data-ttu-id="afade-154">V dialogovém okně **Přihlášení – nové** na stránce **Obecné** zadejte jméno nového uživatele do pole **Přihlašovací jméno**.</span><span class="sxs-lookup"><span data-stu-id="afade-154">In the **Login - New** dialog box, on the **General** page, enter the name of the new user in the **Login name** box.</span></span>
4. <span data-ttu-id="afade-155">Vyberte **Ověřování SQL Serveru**.</span><span class="sxs-lookup"><span data-stu-id="afade-155">Select **SQL Server authentication**.</span></span>
5. <span data-ttu-id="afade-156">Do pole **Heslo** zadejte heslo pro nového uživatele.</span><span class="sxs-lookup"><span data-stu-id="afade-156">In the **Password** box, enter a password for the new user.</span></span> <span data-ttu-id="afade-157">Do pole **Potvrdit heslo** zadejte toto heslo ještě jednou.</span><span class="sxs-lookup"><span data-stu-id="afade-157">Enter that password again into the **Confirm Password** box.</span></span>
6. <span data-ttu-id="afade-158">Vyberte požadované možnosti pro vynucení hesla (**Enforce password policy** (Vynutit zásady hesla), **Enforce password expiration** (vynutit vypršení platnosti hesla) a **User must change password at next login** (Uživatel musí změnit heslo při příštím přihlášení)).</span><span class="sxs-lookup"><span data-stu-id="afade-158">Select the password enforcement options required (**Enforce password policy**, **Enforce password expiration**, and **User must change password at next login**).</span></span> <span data-ttu-id="afade-159">Pokud toto přihlášení používáte pro sebe, nemusíte vyžadovat změnu hesla při příštím přihlášení.</span><span class="sxs-lookup"><span data-stu-id="afade-159">If you are using this login for yourself, you do not need to require a password change at the next login.</span></span>
7. <span data-ttu-id="afade-160">V seznamu **Výchozí databáze** vyberte výchozí databázi pro toto přihlášení.</span><span class="sxs-lookup"><span data-stu-id="afade-160">From the **Default database** list, select a default database for the login.</span></span> <span data-ttu-id="afade-161">Pro tuto možnost je výchozí nastavení **hlavní**.</span><span class="sxs-lookup"><span data-stu-id="afade-161">**master** is the default for this option.</span></span> <span data-ttu-id="afade-162">Pokud jste ještě nevytvořili uživatelská databázi, nastavení **hlavní** ponechejte.</span><span class="sxs-lookup"><span data-stu-id="afade-162">If you have not yet created a user database, leave this set to **master**.</span></span>
   
    ![Vlastnosti přihlášení](./media/virtual-machines-sql-server-connection-steps/24Test-Login.png)
8. <span data-ttu-id="afade-164">Pokud toto je první přihlášení, které vytváříte, budete ho pravděpodobně chtít nastavit jako správce SQL Serveru.</span><span class="sxs-lookup"><span data-stu-id="afade-164">If this is the first login you are creating, you may want to designate this login as a SQL Server administrator.</span></span> <span data-ttu-id="afade-165">Pokud tomu tak je, na stránce **Role serveru** zaškrtněte **správce systému**.</span><span class="sxs-lookup"><span data-stu-id="afade-165">If so, on the **Server Roles** page, check **sysadmin**.</span></span>
   
   > [!NOTE]
   > <span data-ttu-id="afade-166">Členové pevné role správce serveru mají naprostou kontrolu nad databázovým strojem.</span><span class="sxs-lookup"><span data-stu-id="afade-166">Members of the sysadmin fixed server role have complete control of the Database Engine.</span></span> <span data-ttu-id="afade-167">Členství v této roli byste měli pečlivě omezit.</span><span class="sxs-lookup"><span data-stu-id="afade-167">You should carefully restrict membership in this role.</span></span>
   > 
   > 
   
   ![Správce systému](./media/virtual-machines-sql-server-connection-steps/25sysadmin.png)
9. <span data-ttu-id="afade-169">Klikněte na tlačítko OK.</span><span class="sxs-lookup"><span data-stu-id="afade-169">Click OK.</span></span>

<span data-ttu-id="afade-170">Další informace o přihlášeních SQL Serveru najdete v tématu věnovaném [vytvoření přihlášení](http://msdn.microsoft.com/library/aa337562.aspx).</span><span class="sxs-lookup"><span data-stu-id="afade-170">For more information about SQL Server logins, see [Create a Login](http://msdn.microsoft.com/library/aa337562.aspx).</span></span>

