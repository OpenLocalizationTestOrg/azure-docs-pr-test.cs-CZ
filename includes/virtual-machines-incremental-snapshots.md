# <a name="back-up-azure-unmanaged-vm-disks-with-incremental-snapshots"></a><span data-ttu-id="afb97-101">Zálohování Azure nespravované disky virtuálních počítačů s přírůstkové snímky</span><span class="sxs-lookup"><span data-stu-id="afb97-101">Back up Azure unmanaged VM disks with incremental snapshots</span></span>
## <a name="overview"></a><span data-ttu-id="afb97-102">Přehled</span><span class="sxs-lookup"><span data-stu-id="afb97-102">Overview</span></span>
<span data-ttu-id="afb97-103">Úložiště Azure poskytuje možnost hello tootake snímky objektů BLOB.</span><span class="sxs-lookup"><span data-stu-id="afb97-103">Azure Storage provides hello capability tootake snapshots of blobs.</span></span> <span data-ttu-id="afb97-104">Snímky zaznamenat stav hello objektů blob v tomto bodě v čase.</span><span class="sxs-lookup"><span data-stu-id="afb97-104">Snapshots capture hello blob state at that point in time.</span></span> <span data-ttu-id="afb97-105">V tomto článku jsme popisují scénáře, ve kterém můžete spravovat zálohy disků virtuálních počítačů pomocí snímků.</span><span class="sxs-lookup"><span data-stu-id="afb97-105">In this article, we describe a scenario in which you can maintain backups of virtual machine disks using snapshots.</span></span> <span data-ttu-id="afb97-106">Můžete použít tuto metodu, když zvolíte není toouse Azure zálohování a obnovení služby a chcete toocreate vlastní strategii zálohování pro disky virtuálního počítače.</span><span class="sxs-lookup"><span data-stu-id="afb97-106">You can use this methodology when you choose not toouse Azure Backup and Recovery Service, and wish toocreate a custom backup strategy for your virtual machine disks.</span></span>

<span data-ttu-id="afb97-107">Disky virtuálních počítačů Azure jsou uloženy jako objekty BLOB stránky ve službě Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="afb97-107">Azure virtual machine disks are stored as page blobs in Azure Storage.</span></span> <span data-ttu-id="afb97-108">Vzhledem k tomu, že jsme se s popisem strategie zálohování pro disky virtuálního počítače v tomto článku, označujeme toosnapshots v kontextu hello objekty BLOB stránky.</span><span class="sxs-lookup"><span data-stu-id="afb97-108">Since we are describing a backup strategy for virtual machine disks in this article, we refer toosnapshots in hello context of page blobs.</span></span> <span data-ttu-id="afb97-109">toolearn Další informace o snímky odkazovat příliš[vytvoření snímku objektu Blob](https://docs.microsoft.com/rest/api/storageservices/Creating-a-Snapshot-of-a-Blob).</span><span class="sxs-lookup"><span data-stu-id="afb97-109">toolearn more about snapshots, refer too[Creating a Snapshot of a Blob](https://docs.microsoft.com/rest/api/storageservices/Creating-a-Snapshot-of-a-Blob).</span></span>

## <a name="what-is-a-snapshot"></a><span data-ttu-id="afb97-110">Co je snímek?</span><span class="sxs-lookup"><span data-stu-id="afb97-110">What is a snapshot?</span></span>
<span data-ttu-id="afb97-111">Objekt blob snímek je jen pro čtení verze objektu blob zachycenou v bodě v čase.</span><span class="sxs-lookup"><span data-stu-id="afb97-111">A blob snapshot is a read-only version of a blob that is captured at a point in time.</span></span> <span data-ttu-id="afb97-112">Po vytvoření snímku, ho můžete číst, kopírovat, nebo odstranit, ale nedojde ke změně.</span><span class="sxs-lookup"><span data-stu-id="afb97-112">Once a snapshot has been created, it can be read, copied, or deleted, but not modified.</span></span> <span data-ttu-id="afb97-113">Snímky zadejte tooback způsob, jak se objekt blob, jak se objevuje v časovém okamžiku.</span><span class="sxs-lookup"><span data-stu-id="afb97-113">Snapshots provide a way tooback up a blob as it appears at a moment in time.</span></span> <span data-ttu-id="afb97-114">Dokud REST verze 2015-04-05 bylo hello možnost toocopy úplné snímky.</span><span class="sxs-lookup"><span data-stu-id="afb97-114">Until REST version 2015-04-05, you had hello ability toocopy full snapshots.</span></span> <span data-ttu-id="afb97-115">S hello REST verze 2015-07-08 a vyšší, můžete také můžete zkopírovat přírůstkové snímky.</span><span class="sxs-lookup"><span data-stu-id="afb97-115">With hello REST version 2015-07-08 and above, you can also copy incremental snapshots.</span></span>

## <a name="full-snapshot-copy"></a><span data-ttu-id="afb97-116">Kopírování úplné snímku</span><span class="sxs-lookup"><span data-stu-id="afb97-116">Full snapshot copy</span></span>
<span data-ttu-id="afb97-117">Snímky lze zkopírovat tooanother účtu úložiště jako objektů blob zálohy tookeep hello základní objekt blob.</span><span class="sxs-lookup"><span data-stu-id="afb97-117">Snapshots can be copied tooanother storage account as a blob tookeep backups of hello base blob.</span></span> <span data-ttu-id="afb97-118">Můžete také zkopírovat snímek přes jeho základní objekt blob, které je třeba obnovení hello blob tooan starší verze.</span><span class="sxs-lookup"><span data-stu-id="afb97-118">You can also copy a snapshot over its base blob, which is like restoring hello blob tooan earlier version.</span></span> <span data-ttu-id="afb97-119">Po zkopírování snímek z jednoho tooanother účet úložiště bude zabírat hello stejné místo jako objekt blob hello základní stránky.</span><span class="sxs-lookup"><span data-stu-id="afb97-119">When a snapshot is copied from one storage account tooanother, it occupies hello same space as hello base page blob.</span></span> <span data-ttu-id="afb97-120">Proto kopírování celou snímky z jednoho tooanother účet úložiště je pomalé a spotřebuje, kolik místa v hello cílový účet úložiště.</span><span class="sxs-lookup"><span data-stu-id="afb97-120">Therefore, copying whole snapshots from one storage account tooanother is slow and consumes much space in hello target storage account.</span></span>

> [!NOTE]
> <span data-ttu-id="afb97-121">Pokud zkopírujete cílové tooanother hello základní objekt blob, hello snímky objektu hello blob nezkopírují spolu s ním.</span><span class="sxs-lookup"><span data-stu-id="afb97-121">If you copy hello base blob tooanother destination, hello snapshots of hello blob are not copied along with it.</span></span> <span data-ttu-id="afb97-122">Podobně přepíšete základní objekt blob se kopie, neovlivní snímky přidružené hello základní objekt blob a zůstanou beze změn v části název základního objektu blob hello.</span><span class="sxs-lookup"><span data-stu-id="afb97-122">Similarly, if you overwrite a base blob with a copy, snapshots associated with hello base blob are not affected and stay intact under hello base blob name.</span></span>
> 
> 

### <a name="back-up-disks-using-snapshots"></a><span data-ttu-id="afb97-123">Zálohovat disky pomocí snímků</span><span class="sxs-lookup"><span data-stu-id="afb97-123">Back up disks using snapshots</span></span>
<span data-ttu-id="afb97-124">Jako strategie zálohování pro disky virtuálního počítače, můžete pořizovat pravidelné snímky hello disku nebo stránky objektu blob a zkopírujte je tooanother účtu úložiště pomocí nástroje, například [kopírovat objekt Blob](https://docs.microsoft.com/rest/api/storageservices/Copy-Blob) operaci nebo [AzCopy](../articles/storage/common/storage-use-azcopy.md).</span><span class="sxs-lookup"><span data-stu-id="afb97-124">As a backup strategy for your virtual machine disks, you can take periodic snapshots of hello disk or page blob, and copy them tooanother storage account using tools like [Copy Blob](https://docs.microsoft.com/rest/api/storageservices/Copy-Blob) operation or [AzCopy](../articles/storage/common/storage-use-azcopy.md).</span></span> <span data-ttu-id="afb97-125">Můžete zkopírovat snímku tooa cílový objekt blob stránky s jiným názvem.</span><span class="sxs-lookup"><span data-stu-id="afb97-125">You can copy a snapshot tooa destination page blob with a different name.</span></span> <span data-ttu-id="afb97-126">Hello výsledný objekt blob stránky cílové je objekt blob stránky lze zapisovat a není snímek.</span><span class="sxs-lookup"><span data-stu-id="afb97-126">hello resulting destination page blob is a writeable page blob and not a snapshot.</span></span> <span data-ttu-id="afb97-127">Později v tomto článku jsme popisují kroky tootake zálohy disků virtuálních počítačů pomocí snímků.</span><span class="sxs-lookup"><span data-stu-id="afb97-127">Later in this article, we describe steps tootake backups of virtual machine disks using snapshots.</span></span>

### <a name="restore-disks-using-snapshots"></a><span data-ttu-id="afb97-128">Obnovení disků pomocí snímků</span><span class="sxs-lookup"><span data-stu-id="afb97-128">Restore disks using snapshots</span></span>
<span data-ttu-id="afb97-129">Pokud nastane čas toorestore vašeho disku tooa ustájení verzi, která byla dříve zaznamenána v jednom z hello snímků zálohy, můžete zkopírovat snímek přes hello základní stránky objektu blob.</span><span class="sxs-lookup"><span data-stu-id="afb97-129">When it is time toorestore your disk tooa stable version that was previously captured in one of hello backup snapshots, you can copy a snapshot over hello base page blob.</span></span> <span data-ttu-id="afb97-130">Objekt blob základní stránky propagovaných toohello po hello snímku hello snímku zůstane, ale dojde k přepsání zdrojem kopie, kterou může být číst a zapisovat.</span><span class="sxs-lookup"><span data-stu-id="afb97-130">After hello snapshot is promoted toohello base page blob, hello snapshot remains, but its source is overwritten with a copy that can be both read and written.</span></span> <span data-ttu-id="afb97-131">Později v tomto článku jsme popisují kroky toorestore předchozí verze disku z jeho snímků.</span><span class="sxs-lookup"><span data-stu-id="afb97-131">Later in this article we describe steps toorestore a previous version of your disk from its snapshot.</span></span>

### <a name="implementing-full-snapshot-copy"></a><span data-ttu-id="afb97-132">Implementace kopie úplné snímku</span><span class="sxs-lookup"><span data-stu-id="afb97-132">Implementing full snapshot copy</span></span>
<span data-ttu-id="afb97-133">Můžete implementovat kopii úplné snímku provedením následujících hello</span><span class="sxs-lookup"><span data-stu-id="afb97-133">You can implement a full snapshot copy by doing hello following,</span></span>

* <span data-ttu-id="afb97-134">Nejprve vytvořte snímek hello základní objekt blob pomocí hello [snímku Blob](https://docs.microsoft.com/rest/api/storageservices/Snapshot-Blob) operaci.</span><span class="sxs-lookup"><span data-stu-id="afb97-134">First, take a snapshot of hello base blob using hello [Snapshot Blob](https://docs.microsoft.com/rest/api/storageservices/Snapshot-Blob) operation.</span></span>
* <span data-ttu-id="afb97-135">Potom kopie hello snímku tooa cílové úložiště účtu pomocí [kopírovat objekt Blob](https://docs.microsoft.com/rest/api/storageservices/Copy-Blob).</span><span class="sxs-lookup"><span data-stu-id="afb97-135">Then, copy hello snapshot tooa target storage account using [Copy Blob](https://docs.microsoft.com/rest/api/storageservices/Copy-Blob).</span></span>
* <span data-ttu-id="afb97-136">Opakujte tento proces toomaintain záložní kopie vaše základní objekt blob.</span><span class="sxs-lookup"><span data-stu-id="afb97-136">Repeat this process toomaintain backup copies of your base blob.</span></span>

## <a name="incremental-snapshot-copy"></a><span data-ttu-id="afb97-137">Kopírování přírůstkový snímek</span><span class="sxs-lookup"><span data-stu-id="afb97-137">Incremental snapshot copy</span></span>
<span data-ttu-id="afb97-138">Hello nová funkce v hello [GetPageRanges](https://docs.microsoft.com/rest/api/storageservices/Get-Page-Ranges) rozhraní API poskytuje mnohem lepší způsob tooback až hello snímky objekty BLOB stránky nebo disků.</span><span class="sxs-lookup"><span data-stu-id="afb97-138">hello new feature in hello [GetPageRanges](https://docs.microsoft.com/rest/api/storageservices/Get-Page-Ranges) API provides a much better way tooback up hello snapshots of your page blobs or disks.</span></span> <span data-ttu-id="afb97-139">Hello rozhraní API vrátí hello seznam změn mezi hello základní objekt blob a hello snímky, což snižuje množství hello na účet záloh hello využitého prostoru úložiště.</span><span class="sxs-lookup"><span data-stu-id="afb97-139">hello API returns hello list of changes between hello base blob and hello snapshots, which reduces hello amount of storage space used on hello backup account.</span></span> <span data-ttu-id="afb97-140">Hello rozhraní API podporuje objekty BLOB stránky na Storage úrovně Premium, jakož i úložiště Standard Storage.</span><span class="sxs-lookup"><span data-stu-id="afb97-140">hello API supports page blobs on Premium Storage as well as Standard Storage.</span></span> <span data-ttu-id="afb97-141">Toto rozhraní API používáte, můžete vytvořit rychlejší a efektivnější řešení zálohování pro virtuální počítače Azure.</span><span class="sxs-lookup"><span data-stu-id="afb97-141">Using this API, you can build faster and more efficient backup solutions for Azure VMs.</span></span> <span data-ttu-id="afb97-142">Toto rozhraní API bude k dispozici hello REST verze 2015-07-08 a vyšší.</span><span class="sxs-lookup"><span data-stu-id="afb97-142">This API will be available with hello REST version 2015-07-08 and higher.</span></span>

<span data-ttu-id="afb97-143">Přírůstkové kopie snímků vám umožní toocopy z jednoho úložiště účet tooanother hello rozdíl mezi,</span><span class="sxs-lookup"><span data-stu-id="afb97-143">Incremental Snapshot Copy allows you toocopy from one storage account tooanother hello difference between,</span></span>

* <span data-ttu-id="afb97-144">Základní objekt blob a jeho snímek nebo</span><span class="sxs-lookup"><span data-stu-id="afb97-144">Base blob and its Snapshot OR</span></span>
* <span data-ttu-id="afb97-145">Všechny dva snímky základní objekt blob hello</span><span class="sxs-lookup"><span data-stu-id="afb97-145">Any two snapshots of hello base blob</span></span>

<span data-ttu-id="afb97-146">Pokud jsou splněny následující podmínky hello,</span><span class="sxs-lookup"><span data-stu-id="afb97-146">Provided hello following conditions are met,</span></span>

* <span data-ttu-id="afb97-147">Objekt blob Hello byl vytvořen ledna-1-2016 nebo novější.</span><span class="sxs-lookup"><span data-stu-id="afb97-147">hello blob was created on Jan-1-2016 or later.</span></span>
* <span data-ttu-id="afb97-148">nebyl k přepsání objektů blob Hello [PutPage](https://docs.microsoft.com/rest/api/storageservices/Put-Page) nebo [kopírovat objekt Blob](https://docs.microsoft.com/rest/api/storageservices/Copy-Blob) mezi dvěma snímky.</span><span class="sxs-lookup"><span data-stu-id="afb97-148">hello blob was not overwritten with [PutPage](https://docs.microsoft.com/rest/api/storageservices/Put-Page) or [Copy Blob](https://docs.microsoft.com/rest/api/storageservices/Copy-Blob) between two snapshots.</span></span>

<span data-ttu-id="afb97-149">**Poznámka:**: Tato funkce je dostupná pro Premium a Standard objekty BLOB stránky Azure.</span><span class="sxs-lookup"><span data-stu-id="afb97-149">**Note**: This feature is available for Premium and Standard Azure Page Blobs.</span></span>

<span data-ttu-id="afb97-150">Až budete mít vlastní strategii zálohování pomocí snímků, kopírování hello snímky z jednoho tooanother účet úložiště může být pomalé a spotřebovat velké úložiště.</span><span class="sxs-lookup"><span data-stu-id="afb97-150">When you have a custom backup strategy using snapshots, copying hello snapshots from one storage account tooanother can be slow and can consume much storage space.</span></span> <span data-ttu-id="afb97-151">Namísto kopírování hello celý snímek tooa úložiště záloh účet, můžete napsat hello rozdíl mezi po sobě jdoucí snímky tooa zálohování stránky objektu blob.</span><span class="sxs-lookup"><span data-stu-id="afb97-151">Instead of copying hello entire snapshot tooa backup storage account, you can write hello difference between consecutive snapshots tooa backup page blob.</span></span> <span data-ttu-id="afb97-152">Tímto způsobem hello čas toocopy a hello místo toostore zálohování je podstatně snížit.</span><span class="sxs-lookup"><span data-stu-id="afb97-152">This way, hello time toocopy and hello space toostore backups is substantially reduced.</span></span>

### <a name="implementing-incremental-snapshot-copy"></a><span data-ttu-id="afb97-153">Implementace přírůstkový snímek kopie</span><span class="sxs-lookup"><span data-stu-id="afb97-153">Implementing Incremental Snapshot Copy</span></span>
<span data-ttu-id="afb97-154">Kopírování přírůstkový snímek můžete implementovat pomocí tohoto postupu následující hello</span><span class="sxs-lookup"><span data-stu-id="afb97-154">You can implement incremental snapshot copy by doing hello following,</span></span>

* <span data-ttu-id="afb97-155">Pořízení snímku hello základní objekt blob pomocí [snímku Blob](https://docs.microsoft.com/rest/api/storageservices/Snapshot-Blob).</span><span class="sxs-lookup"><span data-stu-id="afb97-155">Take a snapshot of hello base blob using [Snapshot Blob](https://docs.microsoft.com/rest/api/storageservices/Snapshot-Blob).</span></span>
* <span data-ttu-id="afb97-156">Kopírování hello snímku toohello cílového úložiště pro zálohy účtu pomocí [kopírovat objekt Blob](https://docs.microsoft.com/rest/api/storageservices/Copy-Blob).</span><span class="sxs-lookup"><span data-stu-id="afb97-156">Copy hello snapshot toohello target backup storage account using [Copy Blob](https://docs.microsoft.com/rest/api/storageservices/Copy-Blob).</span></span> <span data-ttu-id="afb97-157">Toto je objekt blob hello zálohování stránky.</span><span class="sxs-lookup"><span data-stu-id="afb97-157">This is hello backup page blob.</span></span> <span data-ttu-id="afb97-158">Pořízení snímku objektů blob zálohy stránky hello a uloží jej v hello zálohování účtu.</span><span class="sxs-lookup"><span data-stu-id="afb97-158">Take a snapshot of hello backup page blob and store it in hello backup account.</span></span>
* <span data-ttu-id="afb97-159">Vytvořte nový snímek objektu blob základní hello pomocí snímku objektů Blob.</span><span class="sxs-lookup"><span data-stu-id="afb97-159">Take another snapshot of hello base blob using Snapshot Blob.</span></span>
* <span data-ttu-id="afb97-160">Získat hello rozdíl mezi hello první a druhý snímky hello základní objekt blob pomocí [GetPageRanges](https://docs.microsoft.com/rest/api/storageservices/Get-Page-Ranges).</span><span class="sxs-lookup"><span data-stu-id="afb97-160">Get hello difference between hello first and second snapshots of hello base blob using [GetPageRanges](https://docs.microsoft.com/rest/api/storageservices/Get-Page-Ranges).</span></span> <span data-ttu-id="afb97-161">Použít nový parametr hello **prevsnapshot**, toospecify hello hello snímek, který se má tooget hello rozdíl oproti hodnotu DateTime.</span><span class="sxs-lookup"><span data-stu-id="afb97-161">Use hello new parameter **prevsnapshot**, toospecify hello DateTime value of hello snapshot you want tooget hello difference with.</span></span> <span data-ttu-id="afb97-162">Pokud tento parametr, hello REST odpovědi obsahuje pouze hello stránky, které byly změněny mezi cíl snímku a předchozího snímku, včetně zrušte stránky.</span><span class="sxs-lookup"><span data-stu-id="afb97-162">When this parameter is present, hello REST response includes only hello pages that were changed between target snapshot and previous snapshot including clear pages.</span></span>
* <span data-ttu-id="afb97-163">Použití [PutPage](https://docs.microsoft.com/rest/api/storageservices/Put-Page) tooapply objekt blob se tyto změny toohello zálohování stránky.</span><span class="sxs-lookup"><span data-stu-id="afb97-163">Use [PutPage](https://docs.microsoft.com/rest/api/storageservices/Put-Page) tooapply these changes toohello backup page blob.</span></span>
* <span data-ttu-id="afb97-164">Nakonec pořízení snímku objektů blob zálohy stránky hello a uloží jej v účtu úložiště pro zálohy hello.</span><span class="sxs-lookup"><span data-stu-id="afb97-164">Finally, take a snapshot of hello backup page blob and store it in hello backup storage account.</span></span>

<span data-ttu-id="afb97-165">V další části hello jsme se podrobněji popisují jak můžete spravovat zálohy disků pomocí přírůstkové kopie snímků</span><span class="sxs-lookup"><span data-stu-id="afb97-165">In hello next section, we will describe in more detail how you can maintain backups of disks using Incremental Snapshot Copy</span></span>

## <a name="scenario"></a><span data-ttu-id="afb97-166">Scénář</span><span class="sxs-lookup"><span data-stu-id="afb97-166">Scenario</span></span>
<span data-ttu-id="afb97-167">V této části popisují jsme scénář, který zahrnuje vlastní strategii zálohování pro disky virtuálního počítače pomocí snímků.</span><span class="sxs-lookup"><span data-stu-id="afb97-167">In this section, we describe a scenario that involves a custom backup strategy for virtual machine disks using snapshots.</span></span>

<span data-ttu-id="afb97-168">Zvažte DS-series virtuální počítač Azure s připojený disk P30 úložiště premium.</span><span class="sxs-lookup"><span data-stu-id="afb97-168">Consider a DS-series Azure VM with a premium storage P30 disk attached.</span></span> <span data-ttu-id="afb97-169">Hello P30 disku s názvem *mypremiumdisk* je uložený v účtu úložiště premium názvem *mypremiumaccount*.</span><span class="sxs-lookup"><span data-stu-id="afb97-169">hello P30 disk called *mypremiumdisk* is stored in a premium storage account called *mypremiumaccount*.</span></span> <span data-ttu-id="afb97-170">Účet standardního úložiště s názvem *mybackupstdaccount* se použije k uložení zálohování hello *mypremiumdisk*.</span><span class="sxs-lookup"><span data-stu-id="afb97-170">A standard storage account called *mybackupstdaccount* is used for storing hello backup of *mypremiumdisk*.</span></span> <span data-ttu-id="afb97-171">Rádi bychom znali tookeep snímek z *mypremiumdisk* každých 12 hodin.</span><span class="sxs-lookup"><span data-stu-id="afb97-171">We would like tookeep a snapshot of *mypremiumdisk* every 12 hours.</span></span>

<span data-ttu-id="afb97-172">toolearn o vytvoření účtu úložiště a disky, najdete v příliš[účty Azure storage](../articles/storage/storage-create-storage-account.md).</span><span class="sxs-lookup"><span data-stu-id="afb97-172">toolearn about creating storage account and disks, refer too[About Azure storage accounts](../articles/storage/storage-create-storage-account.md).</span></span>

<span data-ttu-id="afb97-173">toolearn o zálohování virtuálních počítačů Azure, najdete v příliš[zálohování virtuálního počítače Azure plánování](../articles/backup/backup-azure-vms-introduction.md).</span><span class="sxs-lookup"><span data-stu-id="afb97-173">toolearn about backing up Azure VMs, refer too[Plan Azure VM backups](../articles/backup/backup-azure-vms-introduction.md).</span></span>

## <a name="steps-toomaintain-backups-of-a-disk-using-incremental-snapshots"></a><span data-ttu-id="afb97-174">Kroky toomaintain zálohy disku pomocí přírůstkové snímků</span><span class="sxs-lookup"><span data-stu-id="afb97-174">Steps toomaintain backups of a disk using incremental snapshots</span></span>
<span data-ttu-id="afb97-175">Hello následující kroky popisují, jak snímky tootake *mypremiumdisk* a udržovat hello záloh v *mybackupstdaccount*.</span><span class="sxs-lookup"><span data-stu-id="afb97-175">hello following steps describe how tootake snapshots of *mypremiumdisk* and maintain hello backups in *mybackupstdaccount*.</span></span> <span data-ttu-id="afb97-176">Hello zálohování je objekt blob standardní stránky názvem *mybackupstdpageblob*.</span><span class="sxs-lookup"><span data-stu-id="afb97-176">hello backup is a standard page blob called *mybackupstdpageblob*.</span></span> <span data-ttu-id="afb97-177">Hello objekt blob stránky zálohování vždy odráží hello stejné stavu jako poslední snímek hello *mypremiumdisk*.</span><span class="sxs-lookup"><span data-stu-id="afb97-177">hello backup page blob always reflects hello same state as hello last snapshot of *mypremiumdisk*.</span></span>

1. <span data-ttu-id="afb97-178">Vytvořte objekt blob hello zálohování stránky pro disk úložiště premium, tak, že pořízení snímku *mypremiumdisk* názvem *mypremiumdisk_ss1*.</span><span class="sxs-lookup"><span data-stu-id="afb97-178">Create hello backup page blob for your premium storage disk, by taking a snapshot of *mypremiumdisk* called *mypremiumdisk_ss1*.</span></span>
2. <span data-ttu-id="afb97-179">Zkopírujte tento snímek toomybackupstdaccount jako objekt blob stránky názvem *mybackupstdpageblob*.</span><span class="sxs-lookup"><span data-stu-id="afb97-179">Copy this snapshot toomybackupstdaccount as a page blob called *mybackupstdpageblob*.</span></span>
3. <span data-ttu-id="afb97-180">Pořízení snímku *mybackupstdpageblob* názvem *mybackupstdpageblob_ss1*pomocí [snímku Blob](https://docs.microsoft.com/rest/api/storageservices/Snapshot-Blob) a uloží jej v *mybackupstdaccount*.</span><span class="sxs-lookup"><span data-stu-id="afb97-180">Take a snapshot of *mybackupstdpageblob* called *mybackupstdpageblob_ss1*, using [Snapshot Blob](https://docs.microsoft.com/rest/api/storageservices/Snapshot-Blob) and store it in *mybackupstdaccount*.</span></span>
4. <span data-ttu-id="afb97-181">Během intervalu zálohování hello vytvořit snímek jiného *mypremiumdisk*, například *mypremiumdisk_ss2*a ukládá je v *mypremiumaccount*.</span><span class="sxs-lookup"><span data-stu-id="afb97-181">During hello backup window, create another snapshot of *mypremiumdisk*, say *mypremiumdisk_ss2*, and store it in *mypremiumaccount*.</span></span>
5. <span data-ttu-id="afb97-182">Získat hello přírůstkové změny mezi hello dva snímky *mypremiumdisk_ss2* a *mypremiumdisk_ss1*pomocí [GetPageRanges](https://docs.microsoft.com/rest/api/storageservices/Get-Page-Ranges) na  *mypremiumdisk_ss2* s hello **prevsnapshot** parametr nastavit časové razítko toohello *mypremiumdisk_ss1*.</span><span class="sxs-lookup"><span data-stu-id="afb97-182">Get hello incremental changes between hello two snapshots, *mypremiumdisk_ss2* and *mypremiumdisk_ss1*, using [GetPageRanges](https://docs.microsoft.com/rest/api/storageservices/Get-Page-Ranges) on *mypremiumdisk_ss2* with hello **prevsnapshot** parameter set toohello timestamp of *mypremiumdisk_ss1*.</span></span> <span data-ttu-id="afb97-183">Zápis objektů blob zálohy stránky tyto přírůstkové změny toohello *mybackupstdpageblob* v *mybackupstdaccount*.</span><span class="sxs-lookup"><span data-stu-id="afb97-183">Write these incremental changes toohello backup page blob *mybackupstdpageblob* in *mybackupstdaccount*.</span></span> <span data-ttu-id="afb97-184">Pokud jsou v přírůstkové změny hello odstraněné rozsahy, je potřeba smazat z objektu blob zálohování stránku hello.</span><span class="sxs-lookup"><span data-stu-id="afb97-184">If there are deleted ranges in hello incremental changes, they must be cleared from hello backup page blob.</span></span> <span data-ttu-id="afb97-185">Použití [PutPage](https://docs.microsoft.com/rest/api/storageservices/Put-Page) toowrite objektů blob zálohy stránky toohello přírůstkové změny.</span><span class="sxs-lookup"><span data-stu-id="afb97-185">Use [PutPage](https://docs.microsoft.com/rest/api/storageservices/Put-Page) toowrite incremental changes toohello backup page blob.</span></span>
6. <span data-ttu-id="afb97-186">Pořízení snímku objektů blob zálohy stránky hello *mybackupstdpageblob*, volané *mybackupstdpageblob_ss2*.</span><span class="sxs-lookup"><span data-stu-id="afb97-186">Take a snapshot of hello backup page blob *mybackupstdpageblob*, called *mybackupstdpageblob_ss2*.</span></span> <span data-ttu-id="afb97-187">Odstranit předchozí snímek hello *mypremiumdisk_ss1* z prémiový účet úložiště.</span><span class="sxs-lookup"><span data-stu-id="afb97-187">Delete hello previous snapshot *mypremiumdisk_ss1* from premium storage account.</span></span>
7. <span data-ttu-id="afb97-188">Opakujte kroky 4 až 6 každých intervalu zálohování.</span><span class="sxs-lookup"><span data-stu-id="afb97-188">Repeat steps 4-6 every backup window.</span></span> <span data-ttu-id="afb97-189">Tímto způsobem můžete udržovat zálohy *mypremiumdisk* v standardní účet úložiště.</span><span class="sxs-lookup"><span data-stu-id="afb97-189">In this way, you can maintain backups of *mypremiumdisk* in a standard storage account.</span></span>

![Zálohování pomocí přírůstkové snímků disku](../articles/virtual-machines/windows/media/incremental-snapshots/storage-incremental-snapshots-1.png)

## <a name="steps-toorestore-a-disk-from-snapshots"></a><span data-ttu-id="afb97-191">Kroky toorestore disk ze snímků</span><span class="sxs-lookup"><span data-stu-id="afb97-191">Steps toorestore a disk from snapshots</span></span>
<span data-ttu-id="afb97-192">Hello následující kroky, které popisují, jak toorestore hello premium disku *mypremiumdisk* tooan dříve snímek z účtu úložiště pro zálohy hello *mybackupstdaccount*.</span><span class="sxs-lookup"><span data-stu-id="afb97-192">hello following steps, describe how toorestore hello premium disk, *mypremiumdisk* tooan earlier snapshot from hello backup storage account *mybackupstdaccount*.</span></span>

1. <span data-ttu-id="afb97-193">Identifikaci hello bodu v čase, u nějž chcete toorestore hello premium disk.</span><span class="sxs-lookup"><span data-stu-id="afb97-193">Identify hello point in time that you wish toorestore hello premium disk to.</span></span> <span data-ttu-id="afb97-194">Řekněme, že je snímek *mybackupstdpageblob_ss2*, který je uložený v účtu úložiště pro zálohy hello *mybackupstdaccount*.</span><span class="sxs-lookup"><span data-stu-id="afb97-194">Let's say that it is snapshot *mybackupstdpageblob_ss2*, which is stored in hello backup storage account *mybackupstdaccount*.</span></span>
2. <span data-ttu-id="afb97-195">V mybackupstdaccount, zvýšení úrovně hello snímku *mybackupstdpageblob_ss2* jako nový blob zálohování základní stránku hello *mybackupstdpageblobrestored*.</span><span class="sxs-lookup"><span data-stu-id="afb97-195">In mybackupstdaccount, promote hello snapshot *mybackupstdpageblob_ss2* as hello new backup base page blob *mybackupstdpageblobrestored*.</span></span>
3. <span data-ttu-id="afb97-196">Pořízení snímku tento objekt blob stránky obnovené zálohy, nazývá *mybackupstdpageblobrestored_ss1*.</span><span class="sxs-lookup"><span data-stu-id="afb97-196">Take a snapshot of this restored backup page blob, called *mybackupstdpageblobrestored_ss1*.</span></span>
4. <span data-ttu-id="afb97-197">Kopírovat objekt blob stránky hello obnovit *mybackupstdpageblobrestored* z *mybackupstdaccount* příliš*mypremiumaccount* jako nový disk premium hello  *mypremiumdiskrestored*.</span><span class="sxs-lookup"><span data-stu-id="afb97-197">Copy hello restored page blob *mybackupstdpageblobrestored* from *mybackupstdaccount* too*mypremiumaccount* as hello new premium disk *mypremiumdiskrestored*.</span></span>
5. <span data-ttu-id="afb97-198">Pořízení snímku *mypremiumdiskrestored*, volané *mypremiumdiskrestored_ss1* pro provedení budoucí přírůstkové zálohování.</span><span class="sxs-lookup"><span data-stu-id="afb97-198">Take a snapshot of *mypremiumdiskrestored*, called *mypremiumdiskrestored_ss1* for making future incremental backups.</span></span>
6. <span data-ttu-id="afb97-199">Bodu řady hello DS disku toohello obnovit virtuální počítač *mypremiumdiskrestored* a odpojit hello staré *mypremiumdisk* z hello virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="afb97-199">Point hello DS series VM toohello restored disk *mypremiumdiskrestored* and detach hello old *mypremiumdisk* from hello VM.</span></span>
7. <span data-ttu-id="afb97-200">Spusťte proces zálohování hello popsané v předchozí části pro disk hello obnovit *mypremiumdiskrestored*, pomocí hello *mybackupstdpageblobrestored* jako objekt blob hello zálohování stránky.</span><span class="sxs-lookup"><span data-stu-id="afb97-200">Begin hello Backup process described in previous section for hello restored disk *mypremiumdiskrestored*, using hello *mybackupstdpageblobrestored* as hello backup page blob.</span></span>

![Obnovení disku ze snímků](../articles/virtual-machines/windows/media/incremental-snapshots/storage-incremental-snapshots-2.png)

## <a name="next-steps"></a><span data-ttu-id="afb97-202">Další kroky</span><span class="sxs-lookup"><span data-stu-id="afb97-202">Next Steps</span></span>
<span data-ttu-id="afb97-203">Použití hello následující odkazy toolearn Další informace o vytváření snímků objektu blob a plánování infrastruktury zálohování virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="afb97-203">Use hello following links toolearn more about creating snapshots of a blob and planning your VM backup infrastructure.</span></span>

* [<span data-ttu-id="afb97-204">Vytvoření snímku objektu Blob</span><span class="sxs-lookup"><span data-stu-id="afb97-204">Creating a Snapshot of a Blob</span></span>](https://docs.microsoft.com/rest/api/storageservices/Creating-a-Snapshot-of-a-Blob)
* [<span data-ttu-id="afb97-205">Plánování vaší infrastruktury zálohování virtuálních počítačů</span><span class="sxs-lookup"><span data-stu-id="afb97-205">Plan your VM Backup Infrastructure</span></span>](../articles/backup/backup-azure-vms-introduction.md)

